(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-61d4fdda"],{4086:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("5a89");class o extends r["hb"]{constructor(e){super(e)}load(e,t,n,o){const i=this,s=""===this.path?r["ib"].extractUrlBase(e):this.path,a=new r["N"](this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(function(n){try{t(i.parse(n,s))}catch(r){o?o(r):console.error(r),i.manager.itemError(e)}}),n,o)}setMaterialOptions(e){return this.materialOptions=e,this}parse(e,t){const n=e.split("\n");let r={};const o=/\s+/,s={};for(let i=0;i<n.length;i++){let e=n[i];if(e=e.trim(),0===e.length||"#"===e.charAt(0))continue;const t=e.indexOf(" ");let a=t>=0?e.substring(0,t):e;a=a.toLowerCase();let c=t>=0?e.substring(t+1):"";if(c=c.trim(),"newmtl"===a)r={name:c},s[c]=r;else if("ka"===a||"kd"===a||"ks"===a||"ke"===a){const e=c.split(o,3);r[a]=[parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2])]}else r[a]=c}const a=new i(this.resourcePath||t,this.materialOptions);return a.setCrossOrigin(this.crossOrigin),a.setManager(this.manager),a.setMaterials(s),a}}class i{constructor(e="",t={}){this.baseUrl=e,this.options=t,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=void 0!==this.options.side?this.options.side:r["Q"],this.wrap=void 0!==this.options.wrap?this.options.wrap:r["Yb"]}setCrossOrigin(e){return this.crossOrigin=e,this}setManager(e){this.manager=e}setMaterials(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(e){if(!this.options)return e;const t={};for(const n in e){const r=e[n],o={};t[n]=o;for(const e in r){let t=!0,n=r[e];const i=e.toLowerCase();switch(i){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(n=[n[0]/255,n[1]/255,n[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===n[0]&&0===n[1]&&0===n[2]&&(t=!1);break;default:break}t&&(o[i]=n)}}return t}preload(){for(const e in this.materialsInfo)this.create(e)}getIndex(e){return this.nameLookup[e]}getAsArray(){let e=0;for(const t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray}create(e){return void 0===this.materials[e]&&this.createMaterial_(e),this.materials[e]}createMaterial_(e){const t=this,n=this.materialsInfo[e],o={name:e,side:this.side};function i(e,t){return"string"!==typeof t||""===t?"":/^https?:\/\//i.test(t)?t:e+t}function s(e,n){if(o[e])return;const r=t.getTextureParams(n,o),s=t.loadTexture(i(t.baseUrl,r.url));s.repeat.copy(r.scale),s.offset.copy(r.offset),s.wrapS=t.wrap,s.wrapT=t.wrap,o[e]=s}for(const a in n){const e=n[a];let t;if(""!==e)switch(a.toLowerCase()){case"kd":o.color=(new r["u"]).fromArray(e);break;case"ks":o.specular=(new r["u"]).fromArray(e);break;case"ke":o.emissive=(new r["u"]).fromArray(e);break;case"map_kd":s("map",e);break;case"map_ks":s("specularMap",e);break;case"map_ke":s("emissiveMap",e);break;case"norm":s("normalMap",e);break;case"map_bump":case"bump":s("bumpMap",e);break;case"map_d":s("alphaMap",e),o.transparent=!0;break;case"ns":o.shininess=parseFloat(e);break;case"d":t=parseFloat(e),t<1&&(o.opacity=t,o.transparent=!0);break;case"tr":t=parseFloat(e),this.options&&this.options.invertTrProperty&&(t=1-t),t>0&&(o.opacity=1-t,o.transparent=!0);break;default:break}}return this.materials[e]=new r["tb"](o),this.materials[e]}getTextureParams(e,t){const n={scale:new r["Cc"](1,1),offset:new r["Cc"](0,0)},o=e.split(/\s+/);let i;return i=o.indexOf("-bm"),i>=0&&(t.bumpScale=parseFloat(o[i+1]),o.splice(i,2)),i=o.indexOf("-s"),i>=0&&(n.scale.set(parseFloat(o[i+1]),parseFloat(o[i+2])),o.splice(i,4)),i=o.indexOf("-o"),i>=0&&(n.offset.set(parseFloat(o[i+1]),parseFloat(o[i+2])),o.splice(i,4)),n.url=o.join(" ").trim(),n}loadTexture(e,t,n,o,i){const s=void 0!==this.manager?this.manager:r["E"];let a=s.getHandler(e);null===a&&(a=new r["sc"](s)),a.setCrossOrigin&&a.setCrossOrigin(this.crossOrigin);const c=a.load(e,n,o,i);return void 0!==t&&(c.mapping=t),c}}},4721:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("5a89");const o={type:"change"},i={type:"start"},s={type:"end"};class a extends r["L"]{constructor(e,t){super(),void 0===t&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new r["Dc"],this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:r["kb"].ROTATE,MIDDLE:r["kb"].DOLLY,RIGHT:r["kb"].PAN},this.touches={ONE:r["pc"].ROTATE,TWO:r["pc"].DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return u.phi},this.getAzimuthalAngle=function(){return u.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(e){e.addEventListener("keydown",se),this._domElementKeyEvents=e},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(o),n.update(),c=a.NONE},this.update=function(){const t=new r["Dc"],i=(new r["Lb"]).setFromUnitVectors(e.up,new r["Dc"](0,1,0)),s=i.clone().invert(),m=new r["Dc"],g=new r["Lb"],v=2*Math.PI;return function(){const e=n.object.position;t.copy(e).sub(n.target),t.applyQuaternion(i),u.setFromVector3(t),n.autoRotate&&c===a.NONE&&L(A()),n.enableDamping?(u.theta+=h.theta*n.dampingFactor,u.phi+=h.phi*n.dampingFactor):(u.theta+=h.theta,u.phi+=h.phi);let r=n.minAzimuthAngle,b=n.maxAzimuthAngle;return isFinite(r)&&isFinite(b)&&(r<-Math.PI?r+=v:r>Math.PI&&(r-=v),b<-Math.PI?b+=v:b>Math.PI&&(b-=v),u.theta=r<=b?Math.max(r,Math.min(b,u.theta)):u.theta>(r+b)/2?Math.max(r,u.theta):Math.min(b,u.theta)),u.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,u.phi)),u.makeSafe(),u.radius*=p,u.radius=Math.max(n.minDistance,Math.min(n.maxDistance,u.radius)),!0===n.enableDamping?n.target.addScaledVector(f,n.dampingFactor):n.target.add(f),t.setFromSpherical(u),t.applyQuaternion(s),e.copy(n.target).add(t),n.object.lookAt(n.target),!0===n.enableDamping?(h.theta*=1-n.dampingFactor,h.phi*=1-n.dampingFactor,f.multiplyScalar(1-n.dampingFactor)):(h.set(0,0,0),f.set(0,0,0)),p=1,!!(d||m.distanceToSquared(n.object.position)>l||8*(1-g.dot(n.object.quaternion))>l)&&(n.dispatchEvent(o),m.copy(n.object.position),g.copy(n.object.quaternion),d=!1,!0)}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",le),n.domElement.removeEventListener("pointerdown",Q),n.domElement.removeEventListener("pointercancel",ne),n.domElement.removeEventListener("wheel",ie),n.domElement.removeEventListener("pointermove",ee),n.domElement.removeEventListener("pointerup",te),null!==n._domElementKeyEvents&&n._domElementKeyEvents.removeEventListener("keydown",se)};const n=this,a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let c=a.NONE;const l=1e-6,u=new r["kc"],h=new r["kc"];let p=1;const f=new r["Dc"];let d=!1;const m=new r["Cc"],g=new r["Cc"],v=new r["Cc"],b=new r["Cc"],y=new r["Cc"],w=new r["Cc"],x=new r["Cc"],I=new r["Cc"],E=new r["Cc"],T=[],k={};function A(){return 2*Math.PI/60/60*n.autoRotateSpeed}function O(){return Math.pow(.95,n.zoomSpeed)}function L(e){h.theta-=e}function P(e){h.phi-=e}const D=function(){const e=new r["Dc"];return function(t,n){e.setFromMatrixColumn(n,0),e.multiplyScalar(-t),f.add(e)}}(),C=function(){const e=new r["Dc"];return function(t,r){!0===n.screenSpacePanning?e.setFromMatrixColumn(r,1):(e.setFromMatrixColumn(r,0),e.crossVectors(n.object.up,e)),e.multiplyScalar(t),f.add(e)}}(),M=function(){const e=new r["Dc"];return function(t,r){const o=n.domElement;if(n.object.isPerspectiveCamera){const i=n.object.position;e.copy(i).sub(n.target);let s=e.length();s*=Math.tan(n.object.fov/2*Math.PI/180),D(2*t*s/o.clientHeight,n.object.matrix),C(2*r*s/o.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(D(t*(n.object.right-n.object.left)/n.object.zoom/o.clientWidth,n.object.matrix),C(r*(n.object.top-n.object.bottom)/n.object.zoom/o.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}}();function N(e){n.object.isPerspectiveCamera?p/=e:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*e)),n.object.updateProjectionMatrix(),d=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function F(e){n.object.isPerspectiveCamera?p*=e:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/e)),n.object.updateProjectionMatrix(),d=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function S(e){m.set(e.clientX,e.clientY)}function R(e){x.set(e.clientX,e.clientY)}function j(e){b.set(e.clientX,e.clientY)}function z(e){g.set(e.clientX,e.clientY),v.subVectors(g,m).multiplyScalar(n.rotateSpeed);const t=n.domElement;L(2*Math.PI*v.x/t.clientHeight),P(2*Math.PI*v.y/t.clientHeight),m.copy(g),n.update()}function U(e){I.set(e.clientX,e.clientY),E.subVectors(I,x),E.y>0?N(O()):E.y<0&&F(O()),x.copy(I),n.update()}function V(e){y.set(e.clientX,e.clientY),w.subVectors(y,b).multiplyScalar(n.panSpeed),M(w.x,w.y),b.copy(y),n.update()}function B(e){e.deltaY<0?F(O()):e.deltaY>0&&N(O()),n.update()}function H(e){let t=!1;switch(e.code){case n.keys.UP:M(0,n.keyPanSpeed),t=!0;break;case n.keys.BOTTOM:M(0,-n.keyPanSpeed),t=!0;break;case n.keys.LEFT:M(n.keyPanSpeed,0),t=!0;break;case n.keys.RIGHT:M(-n.keyPanSpeed,0),t=!0;break}t&&(e.preventDefault(),n.update())}function X(){if(1===T.length)m.set(T[0].pageX,T[0].pageY);else{const e=.5*(T[0].pageX+T[1].pageX),t=.5*(T[0].pageY+T[1].pageY);m.set(e,t)}}function _(){if(1===T.length)b.set(T[0].pageX,T[0].pageY);else{const e=.5*(T[0].pageX+T[1].pageX),t=.5*(T[0].pageY+T[1].pageY);b.set(e,t)}}function G(){const e=T[0].pageX-T[1].pageX,t=T[0].pageY-T[1].pageY,n=Math.sqrt(e*e+t*t);x.set(0,n)}function Y(){n.enableZoom&&G(),n.enablePan&&_()}function W(){n.enableZoom&&G(),n.enableRotate&&X()}function Z(e){if(1==T.length)g.set(e.pageX,e.pageY);else{const t=fe(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);g.set(n,r)}v.subVectors(g,m).multiplyScalar(n.rotateSpeed);const t=n.domElement;L(2*Math.PI*v.x/t.clientHeight),P(2*Math.PI*v.y/t.clientHeight),m.copy(g)}function K(e){if(1===T.length)y.set(e.pageX,e.pageY);else{const t=fe(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);y.set(n,r)}w.subVectors(y,b).multiplyScalar(n.panSpeed),M(w.x,w.y),b.copy(y)}function q(e){const t=fe(e),r=e.pageX-t.x,o=e.pageY-t.y,i=Math.sqrt(r*r+o*o);I.set(0,i),E.set(0,Math.pow(I.y/x.y,n.zoomSpeed)),N(E.y),x.copy(I)}function $(e){n.enableZoom&&q(e),n.enablePan&&K(e)}function J(e){n.enableZoom&&q(e),n.enableRotate&&Z(e)}function Q(e){!1!==n.enabled&&(0===T.length&&(n.domElement.setPointerCapture(e.pointerId),n.domElement.addEventListener("pointermove",ee),n.domElement.addEventListener("pointerup",te)),ue(e),"touch"===e.pointerType?ae(e):re(e))}function ee(e){!1!==n.enabled&&("touch"===e.pointerType?ce(e):oe(e))}function te(e){he(e),0===T.length&&(n.domElement.releasePointerCapture(e.pointerId),n.domElement.removeEventListener("pointermove",ee),n.domElement.removeEventListener("pointerup",te)),n.dispatchEvent(s),c=a.NONE}function ne(e){he(e)}function re(e){let t;switch(e.button){case 0:t=n.mouseButtons.LEFT;break;case 1:t=n.mouseButtons.MIDDLE;break;case 2:t=n.mouseButtons.RIGHT;break;default:t=-1}switch(t){case r["kb"].DOLLY:if(!1===n.enableZoom)return;R(e),c=a.DOLLY;break;case r["kb"].ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enablePan)return;j(e),c=a.PAN}else{if(!1===n.enableRotate)return;S(e),c=a.ROTATE}break;case r["kb"].PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enableRotate)return;S(e),c=a.ROTATE}else{if(!1===n.enablePan)return;j(e),c=a.PAN}break;default:c=a.NONE}c!==a.NONE&&n.dispatchEvent(i)}function oe(e){if(!1!==n.enabled)switch(c){case a.ROTATE:if(!1===n.enableRotate)return;z(e);break;case a.DOLLY:if(!1===n.enableZoom)return;U(e);break;case a.PAN:if(!1===n.enablePan)return;V(e);break}}function ie(e){!1!==n.enabled&&!1!==n.enableZoom&&c===a.NONE&&(e.preventDefault(),n.dispatchEvent(i),B(e),n.dispatchEvent(s))}function se(e){!1!==n.enabled&&!1!==n.enablePan&&H(e)}function ae(e){switch(pe(e),T.length){case 1:switch(n.touches.ONE){case r["pc"].ROTATE:if(!1===n.enableRotate)return;X(),c=a.TOUCH_ROTATE;break;case r["pc"].PAN:if(!1===n.enablePan)return;_(),c=a.TOUCH_PAN;break;default:c=a.NONE}break;case 2:switch(n.touches.TWO){case r["pc"].DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;Y(),c=a.TOUCH_DOLLY_PAN;break;case r["pc"].DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;W(),c=a.TOUCH_DOLLY_ROTATE;break;default:c=a.NONE}break;default:c=a.NONE}c!==a.NONE&&n.dispatchEvent(i)}function ce(e){switch(pe(e),c){case a.TOUCH_ROTATE:if(!1===n.enableRotate)return;Z(e),n.update();break;case a.TOUCH_PAN:if(!1===n.enablePan)return;K(e),n.update();break;case a.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;$(e),n.update();break;case a.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;J(e),n.update();break;default:c=a.NONE}}function le(e){!1!==n.enabled&&e.preventDefault()}function ue(e){T.push(e)}function he(e){delete k[e.pointerId];for(let t=0;t<T.length;t++)if(T[t].pointerId==e.pointerId)return void T.splice(t,1)}function pe(e){let t=k[e.pointerId];void 0===t&&(t=new r["Cc"],k[e.pointerId]=t),t.set(e.pageX,e.pageY)}function fe(e){const t=e.pointerId===T[0].pointerId?T[1]:T[0];return k[t.pointerId]}n.domElement.addEventListener("contextmenu",le),n.domElement.addEventListener("pointerdown",Q),n.domElement.addEventListener("pointercancel",ne),n.domElement.addEventListener("wheel",ie,{passive:!1}),this.update()}}},8710:function(e,t,n){"use strict";n.d(t,"a",(function(){return Vt}));var r={};n.r(r),n.d(r,"Deflate",(function(){return Ae})),n.d(r,"AsyncDeflate",(function(){return Oe})),n.d(r,"deflate",(function(){return Le})),n.d(r,"deflateSync",(function(){return Pe})),n.d(r,"Inflate",(function(){return De})),n.d(r,"AsyncInflate",(function(){return Ce})),n.d(r,"inflate",(function(){return Me})),n.d(r,"inflateSync",(function(){return Ne})),n.d(r,"Gzip",(function(){return Fe})),n.d(r,"AsyncGzip",(function(){return Se})),n.d(r,"gzip",(function(){return Re})),n.d(r,"gzipSync",(function(){return je})),n.d(r,"Gunzip",(function(){return ze})),n.d(r,"AsyncGunzip",(function(){return Ue})),n.d(r,"gunzip",(function(){return Ve})),n.d(r,"gunzipSync",(function(){return Be})),n.d(r,"Zlib",(function(){return He})),n.d(r,"AsyncZlib",(function(){return Xe})),n.d(r,"zlib",(function(){return _e})),n.d(r,"zlibSync",(function(){return Ge})),n.d(r,"Unzlib",(function(){return Ye})),n.d(r,"AsyncUnzlib",(function(){return We})),n.d(r,"unzlib",(function(){return Ze})),n.d(r,"unzlibSync",(function(){return Ke})),n.d(r,"compress",(function(){return Re})),n.d(r,"AsyncCompress",(function(){return Se})),n.d(r,"compressSync",(function(){return je})),n.d(r,"Compress",(function(){return Fe})),n.d(r,"Decompress",(function(){return qe})),n.d(r,"AsyncDecompress",(function(){return $e})),n.d(r,"decompress",(function(){return Je})),n.d(r,"decompressSync",(function(){return Qe})),n.d(r,"DecodeUTF8",(function(){return it})),n.d(r,"EncodeUTF8",(function(){return st})),n.d(r,"strToU8",(function(){return at})),n.d(r,"strFromU8",(function(){return ct})),n.d(r,"ZipPassThrough",(function(){return gt})),n.d(r,"ZipDeflate",(function(){return vt})),n.d(r,"AsyncZipDeflate",(function(){return bt})),n.d(r,"Zip",(function(){return yt})),n.d(r,"zip",(function(){return wt})),n.d(r,"zipSync",(function(){return xt})),n.d(r,"UnzipPassThrough",(function(){return It})),n.d(r,"UnzipInflate",(function(){return Et})),n.d(r,"AsyncUnzipInflate",(function(){return Tt})),n.d(r,"Unzip",(function(){return kt})),n.d(r,"unzip",(function(){return At})),n.d(r,"unzipSync",(function(){return Ot}));var o=n("5a89"),i={},s=function(e){return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},a=function(e){return new Worker(e)};
/*!
fflate - fast JavaScript compression/decompression
<https://101arrowz.github.io/fflate>
Licensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE
version 0.6.9
*/try{URL.revokeObjectURL(s(""))}catch(un){s=function(e){return"data:application/javascript;charset=UTF-8,"+encodeURI(e)},a=function(e){return new Worker(e,{type:"module"})}}var c=function(e,t,n,r,o){var c=a(i[t]||(i[t]=s(e)));return c.onerror=function(e){return o(e.error,null)},c.onmessage=function(e){return o(null,e.data)},c.postMessage(n,r),c},l=Uint8Array,u=Uint16Array,h=Uint32Array,p=new l([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),f=new l([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),d=new l([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),m=function(e,t){for(var n=new u(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];var o=new h(n[30]);for(r=1;r<30;++r)for(var i=n[r];i<n[r+1];++i)o[i]=i-n[r]<<5|r;return[n,o]},g=m(p,2),v=g[0],b=g[1];v[28]=258,b[258]=28;for(var y=m(f,0),w=y[0],x=y[1],I=new u(32768),E=0;E<32768;++E){var T=(43690&E)>>>1|(21845&E)<<1;T=(52428&T)>>>2|(13107&T)<<2,T=(61680&T)>>>4|(3855&T)<<4,I[E]=((65280&T)>>>8|(255&T)<<8)>>>1}var k=function(e,t,n){for(var r=e.length,o=0,i=new u(t);o<r;++o)++i[e[o]-1];var s,a=new u(t);for(o=0;o<t;++o)a[o]=a[o-1]+i[o-1]<<1;if(n){s=new u(1<<t);var c=15-t;for(o=0;o<r;++o)if(e[o])for(var l=o<<4|e[o],h=t-e[o],p=a[e[o]-1]++<<h,f=p|(1<<h)-1;p<=f;++p)s[I[p]>>>c]=l}else for(s=new u(r),o=0;o<r;++o)e[o]&&(s[o]=I[a[e[o]-1]++]>>>15-e[o]);return s},A=new l(288);for(E=0;E<144;++E)A[E]=8;for(E=144;E<256;++E)A[E]=9;for(E=256;E<280;++E)A[E]=7;for(E=280;E<288;++E)A[E]=8;var O=new l(32);for(E=0;E<32;++E)O[E]=5;var L=k(A,9,0),P=k(A,9,1),D=k(O,5,0),C=k(O,5,1),M=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},N=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(7&t)&n},F=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(7&t)},S=function(e){return(e/8|0)+(7&e&&1)},R=function(e,t,n){(null==t||t<0)&&(t=0),(null==n||n>e.length)&&(n=e.length);var r=new(e instanceof u?u:e instanceof h?h:l)(n-t);return r.set(e.subarray(t,n)),r},j=function(e,t,n){var r=e.length;if(!r||n&&!n.l&&r<5)return t||new l(0);var o=!t||n,i=!n||n.i;n||(n={}),t||(t=new l(3*r));var s=function(e){var n=t.length;if(e>n){var r=new l(Math.max(2*n,e));r.set(t),t=r}},a=n.f||0,c=n.p||0,u=n.b||0,h=n.l,m=n.d,g=n.m,b=n.n,y=8*r;do{if(!h){n.f=a=N(e,c,1);var x=N(e,c+1,3);if(c+=3,!x){var I=S(c)+4,E=e[I-4]|e[I-3]<<8,T=I+E;if(T>r){if(i)throw"unexpected EOF";break}o&&s(u+E),t.set(e.subarray(I,T),u),n.b=u+=E,n.p=c=8*T;continue}if(1==x)h=P,m=C,g=9,b=5;else{if(2!=x)throw"invalid block type";var A=N(e,c,31)+257,O=N(e,c+10,15)+4,L=A+N(e,c+5,31)+1;c+=14;for(var D=new l(L),j=new l(19),z=0;z<O;++z)j[d[z]]=N(e,c+3*z,7);c+=3*O;var U=M(j),V=(1<<U)-1,B=k(j,U,1);for(z=0;z<L;){var H=B[N(e,c,V)];c+=15&H;I=H>>>4;if(I<16)D[z++]=I;else{var X=0,_=0;16==I?(_=3+N(e,c,3),c+=2,X=D[z-1]):17==I?(_=3+N(e,c,7),c+=3):18==I&&(_=11+N(e,c,127),c+=7);while(_--)D[z++]=X}}var G=D.subarray(0,A),Y=D.subarray(A);g=M(G),b=M(Y),h=k(G,g,1),m=k(Y,b,1)}if(c>y){if(i)throw"unexpected EOF";break}}o&&s(u+131072);for(var W=(1<<g)-1,Z=(1<<b)-1,K=c;;K=c){X=h[F(e,c)&W];var q=X>>>4;if(c+=15&X,c>y){if(i)throw"unexpected EOF";break}if(!X)throw"invalid length/literal";if(q<256)t[u++]=q;else{if(256==q){K=c,h=null;break}var $=q-254;if(q>264){z=q-257;var J=p[z];$=N(e,c,(1<<J)-1)+v[z],c+=J}var Q=m[F(e,c)&Z],ee=Q>>>4;if(!Q)throw"invalid distance";c+=15&Q;Y=w[ee];if(ee>3){J=f[ee];Y+=F(e,c)&(1<<J)-1,c+=J}if(c>y){if(i)throw"unexpected EOF";break}o&&s(u+131072);for(var te=u+$;u<te;u+=4)t[u]=t[u-Y],t[u+1]=t[u+1-Y],t[u+2]=t[u+2-Y],t[u+3]=t[u+3-Y];u=te}}n.l=h,n.p=K,n.b=u,h&&(a=1,n.m=g,n.d=m,n.n=b)}while(!a);return u==t.length?t:R(t,0,u)},z=function(e,t,n){n<<=7&t;var r=t/8|0;e[r]|=n,e[r+1]|=n>>>8},U=function(e,t,n){n<<=7&t;var r=t/8|0;e[r]|=n,e[r+1]|=n>>>8,e[r+2]|=n>>>16},V=function(e,t){for(var n=[],r=0;r<e.length;++r)e[r]&&n.push({s:r,f:e[r]});var o=n.length,i=n.slice();if(!o)return[W,0];if(1==o){var s=new l(n[0].s+1);return s[n[0].s]=1,[s,1]}n.sort((function(e,t){return e.f-t.f})),n.push({s:-1,f:25001});var a=n[0],c=n[1],h=0,p=1,f=2;n[0]={s:-1,f:a.f+c.f,l:a,r:c};while(p!=o-1)a=n[n[h].f<n[f].f?h++:f++],c=n[h!=p&&n[h].f<n[f].f?h++:f++],n[p++]={s:-1,f:a.f+c.f,l:a,r:c};var d=i[0].s;for(r=1;r<o;++r)i[r].s>d&&(d=i[r].s);var m=new u(d+1),g=B(n[p-1],m,0);if(g>t){r=0;var v=0,b=g-t,y=1<<b;for(i.sort((function(e,t){return m[t.s]-m[e.s]||e.f-t.f}));r<o;++r){var w=i[r].s;if(!(m[w]>t))break;v+=y-(1<<g-m[w]),m[w]=t}v>>>=b;while(v>0){var x=i[r].s;m[x]<t?v-=1<<t-m[x]++-1:++r}for(;r>=0&&v;--r){var I=i[r].s;m[I]==t&&(--m[I],++v)}g=t}return[new l(m),g]},B=function(e,t,n){return-1==e.s?Math.max(B(e.l,t,n+1),B(e.r,t,n+1)):t[e.s]=n},H=function(e){var t=e.length;while(t&&!e[--t]);for(var n=new u(++t),r=0,o=e[0],i=1,s=function(e){n[r++]=e},a=1;a<=t;++a)if(e[a]==o&&a!=t)++i;else{if(!o&&i>2){for(;i>138;i-=138)s(32754);i>2&&(s(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(s(o),--i;i>6;i-=6)s(8304);i>2&&(s(i-3<<5|8208),i=0)}while(i--)s(o);i=1,o=e[a]}return[n.subarray(0,r),t]},X=function(e,t){for(var n=0,r=0;r<t.length;++r)n+=e[r]*t[r];return n},_=function(e,t,n){var r=n.length,o=S(t+2);e[o]=255&r,e[o+1]=r>>>8,e[o+2]=255^e[o],e[o+3]=255^e[o+1];for(var i=0;i<r;++i)e[o+i+4]=n[i];return 8*(o+4+r)},G=function(e,t,n,r,o,i,s,a,c,l,h){z(t,h++,n),++o[256];for(var m=V(o,15),g=m[0],v=m[1],b=V(i,15),y=b[0],w=b[1],x=H(g),I=x[0],E=x[1],T=H(y),P=T[0],C=T[1],M=new u(19),N=0;N<I.length;++N)M[31&I[N]]++;for(N=0;N<P.length;++N)M[31&P[N]]++;for(var F=V(M,7),S=F[0],R=F[1],j=19;j>4&&!S[d[j-1]];--j);var B,G,Y,W,Z=l+5<<3,K=X(o,A)+X(i,O)+s,q=X(o,g)+X(i,y)+s+14+3*j+X(M,S)+(2*M[16]+3*M[17]+7*M[18]);if(Z<=K&&Z<=q)return _(t,h,e.subarray(c,c+l));if(z(t,h,1+(q<K)),h+=2,q<K){B=k(g,v,0),G=g,Y=k(y,w,0),W=y;var $=k(S,R,0);z(t,h,E-257),z(t,h+5,C-1),z(t,h+10,j-4),h+=14;for(N=0;N<j;++N)z(t,h+3*N,S[d[N]]);h+=3*j;for(var J=[I,P],Q=0;Q<2;++Q){var ee=J[Q];for(N=0;N<ee.length;++N){var te=31&ee[N];z(t,h,$[te]),h+=S[te],te>15&&(z(t,h,ee[N]>>>5&127),h+=ee[N]>>>12)}}}else B=L,G=A,Y=D,W=O;for(N=0;N<a;++N)if(r[N]>255){te=r[N]>>>18&31;U(t,h,B[te+257]),h+=G[te+257],te>7&&(z(t,h,r[N]>>>23&31),h+=p[te]);var ne=31&r[N];U(t,h,Y[ne]),h+=W[ne],ne>3&&(U(t,h,r[N]>>>5&8191),h+=f[ne])}else U(t,h,B[r[N]]),h+=G[r[N]];return U(t,h,B[256]),h+G[256]},Y=new h([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),W=new l(0),Z=function(e,t,n,r,o,i){var s=e.length,a=new l(r+s+5*(1+Math.ceil(s/7e3))+o),c=a.subarray(r,a.length-o),d=0;if(!t||s<8)for(var m=0;m<=s;m+=65535){var g=m+65535;g<s?d=_(c,d,e.subarray(m,g)):(c[m]=i,d=_(c,d,e.subarray(m,s)))}else{for(var v=Y[t-1],y=v>>>13,w=8191&v,I=(1<<n)-1,E=new u(32768),T=new u(I+1),k=Math.ceil(n/3),A=2*k,O=function(t){return(e[t]^e[t+1]<<k^e[t+2]<<A)&I},L=new h(25e3),P=new u(288),D=new u(32),C=0,M=0,N=(m=0,0),F=0,j=0;m<s;++m){var z=O(m),U=32767&m,V=T[z];if(E[U]=V,T[z]=U,F<=m){var B=s-m;if((C>7e3||N>24576)&&B>423){d=G(e,c,0,L,P,D,M,N,j,m-j,d),N=C=M=0,j=m;for(var H=0;H<286;++H)P[H]=0;for(H=0;H<30;++H)D[H]=0}var X=2,Z=0,K=w,q=U-V&32767;if(B>2&&z==O(m-q)){var $=Math.min(y,B)-1,J=Math.min(32767,m),Q=Math.min(258,B);while(q<=J&&--K&&U!=V){if(e[m+X]==e[m+X-q]){for(var ee=0;ee<Q&&e[m+ee]==e[m+ee-q];++ee);if(ee>X){if(X=ee,Z=q,ee>$)break;var te=Math.min(q,ee-2),ne=0;for(H=0;H<te;++H){var re=m-q+H+32768&32767,oe=E[re],ie=re-oe+32768&32767;ie>ne&&(ne=ie,V=re)}}}U=V,V=E[U],q+=U-V+32768&32767}}if(Z){L[N++]=268435456|b[X]<<18|x[Z];var se=31&b[X],ae=31&x[Z];M+=p[se]+f[ae],++P[257+se],++D[ae],F=m+X,++C}else L[N++]=e[m],++P[e[m]]}}d=G(e,c,i,L,P,D,M,N,j,m-j,d),!i&&7&d&&(d=_(c,d+1,W))}return R(a,0,r+S(d)+o)},K=function(){for(var e=new h(256),t=0;t<256;++t){var n=t,r=9;while(--r)n=(1&n&&3988292384)^n>>>1;e[t]=n}return e}(),q=function(){var e=-1;return{p:function(t){for(var n=e,r=0;r<t.length;++r)n=K[255&n^t[r]]^n>>>8;e=n},d:function(){return~e}}},$=function(){var e=1,t=0;return{p:function(n){for(var r=e,o=t,i=n.length,s=0;s!=i;){for(var a=Math.min(s+2655,i);s<a;++s)o+=r+=n[s];r=(65535&r)+15*(r>>16),o=(65535&o)+15*(o>>16)}e=r,t=o},d:function(){return e%=65521,t%=65521,(255&e)<<24|e>>>8<<16|(255&t)<<8|t>>>8}}},J=function(e,t,n,r,o){return Z(e,null==t.level?6:t.level,null==t.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):12+t.mem,n,r,!o)},Q=function(e,t){var n={};for(var r in e)n[r]=e[r];for(var r in t)n[r]=t[r];return n},ee=function(e,t,n){for(var r=e(),o=e.toString(),i=o.slice(o.indexOf("[")+1,o.lastIndexOf("]")).replace(/ /g,"").split(","),s=0;s<r.length;++s){var a=r[s],c=i[s];if("function"==typeof a){t+=";"+c+"=";var l=a.toString();if(a.prototype)if(-1!=l.indexOf("[native code]")){var u=l.indexOf(" ",8)+1;t+=l.slice(u,l.indexOf("(",u))}else for(var h in t+=l,a.prototype)t+=";"+c+".prototype."+h+"="+a.prototype[h].toString();else t+=l}else n[c]=a}return[t,n]},te=[],ne=function(e){var t=[];for(var n in e)(e[n]instanceof l||e[n]instanceof u||e[n]instanceof h)&&t.push((e[n]=new e[n].constructor(e[n])).buffer);return t},re=function(e,t,n,r){var o;if(!te[n]){for(var i="",s={},a=e.length-1,l=0;l<a;++l)o=ee(e[l],i,s),i=o[0],s=o[1];te[n]=ee(e[a],i,s)}var u=Q({},te[n][1]);return c(te[n][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",n,u,ne(u),r)},oe=function(){return[l,u,h,p,f,d,v,w,P,C,I,k,M,N,F,S,R,j,Ne,ue,he]},ie=function(){return[l,u,h,p,f,d,b,x,L,A,D,O,I,Y,W,k,z,U,V,B,H,X,_,G,S,R,Z,J,Pe,ue]},se=function(){return[ye,Ie,be,q,K]},ae=function(){return[we,xe]},ce=function(){return[Ee,be,$]},le=function(){return[Te]},ue=function(e){return postMessage(e,[e.buffer])},he=function(e){return e&&e.size&&new l(e.size)},pe=function(e,t,n,r,o,i){var s=re(n,r,o,(function(e,t){s.terminate(),i(e,t)}));return s.postMessage([e,t],t.consume?[e.buffer]:[]),function(){s.terminate()}},fe=function(e){return e.ondata=function(e,t){return postMessage([e,t],[e.buffer])},function(t){return e.push(t.data[0],t.data[1])}},de=function(e,t,n,r,o){var i,s=re(e,r,o,(function(e,n){e?(s.terminate(),t.ondata.call(t,e)):(n[1]&&s.terminate(),t.ondata.call(t,e,n[0],n[1]))}));s.postMessage(n),t.push=function(e,n){if(i)throw"stream finished";if(!t.ondata)throw"no stream handler";s.postMessage([e,i=n],[e.buffer])},t.terminate=function(){s.terminate()}},me=function(e,t){return e[t]|e[t+1]<<8},ge=function(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0},ve=function(e,t){return ge(e,t)+4294967296*ge(e,t+4)},be=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8},ye=function(e,t){var n=t.filename;if(e[0]=31,e[1]=139,e[2]=8,e[8]=t.level<2?4:9==t.level?2:0,e[9]=3,0!=t.mtime&&be(e,4,Math.floor(new Date(t.mtime||Date.now())/1e3)),n){e[3]=8;for(var r=0;r<=n.length;++r)e[r+10]=n.charCodeAt(r)}},we=function(e){if(31!=e[0]||139!=e[1]||8!=e[2])throw"invalid gzip data";var t=e[3],n=10;4&t&&(n+=e[10]|2+(e[11]<<8));for(var r=(t>>3&1)+(t>>4&1);r>0;r-=!e[n++]);return n+(2&t)},xe=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0},Ie=function(e){return 10+(e.filename&&e.filename.length+1||0)},Ee=function(e,t){var n=t.level,r=0==n?0:n<6?1:9==n?3:2;e[0]=120,e[1]=r<<6|(r?32-2*r:1)},Te=function(e){if(8!=(15&e[0])||e[0]>>>4>7||(e[0]<<8|e[1])%31)throw"invalid zlib data";if(32&e[1])throw"invalid zlib data: preset dictionaries not supported"};function ke(e,t){return t||"function"!=typeof e||(t=e,e={}),this.ondata=t,e}var Ae=function(){function e(e,t){t||"function"!=typeof e||(t=e,e={}),this.ondata=t,this.o=e||{}}return e.prototype.p=function(e,t){this.ondata(J(e,this.o,0,0,!t),t)},e.prototype.push=function(e,t){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";this.d=t,this.p(e,t||!1)},e}(),Oe=function(){function e(e,t){de([ie,function(){return[fe,Ae]}],this,ke.call(this,e,t),(function(e){var t=new Ae(e.data);onmessage=fe(t)}),6)}return e}();function Le(e,t,n){if(n||(n=t,t={}),"function"!=typeof n)throw"no callback";return pe(e,t,[ie],(function(e){return ue(Pe(e.data[0],e.data[1]))}),0,n)}function Pe(e,t){return J(e,t||{},0,0)}var De=function(){function e(e){this.s={},this.p=new l(0),this.ondata=e}return e.prototype.e=function(e){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";var t=this.p.length,n=new l(t+e.length);n.set(this.p),n.set(e,t),this.p=n},e.prototype.c=function(e){this.d=this.s.i=e||!1;var t=this.s.b,n=j(this.p,this.o,this.s);this.ondata(R(n,t,this.s.b),this.d),this.o=R(n,this.s.b-32768),this.s.b=this.o.length,this.p=R(this.p,this.s.p/8|0),this.s.p&=7},e.prototype.push=function(e,t){this.e(e),this.c(t)},e}(),Ce=function(){function e(e){this.ondata=e,de([oe,function(){return[fe,De]}],this,0,(function(){var e=new De;onmessage=fe(e)}),7)}return e}();function Me(e,t,n){if(n||(n=t,t={}),"function"!=typeof n)throw"no callback";return pe(e,t,[oe],(function(e){return ue(Ne(e.data[0],he(e.data[1])))}),1,n)}function Ne(e,t){return j(e,t)}var Fe=function(){function e(e,t){this.c=q(),this.l=0,this.v=1,Ae.call(this,e,t)}return e.prototype.push=function(e,t){Ae.prototype.push.call(this,e,t)},e.prototype.p=function(e,t){this.c.p(e),this.l+=e.length;var n=J(e,this.o,this.v&&Ie(this.o),t&&8,!t);this.v&&(ye(n,this.o),this.v=0),t&&(be(n,n.length-8,this.c.d()),be(n,n.length-4,this.l)),this.ondata(n,t)},e}(),Se=function(){function e(e,t){de([ie,se,function(){return[fe,Ae,Fe]}],this,ke.call(this,e,t),(function(e){var t=new Fe(e.data);onmessage=fe(t)}),8)}return e}();function Re(e,t,n){if(n||(n=t,t={}),"function"!=typeof n)throw"no callback";return pe(e,t,[ie,se,function(){return[je]}],(function(e){return ue(je(e.data[0],e.data[1]))}),2,n)}function je(e,t){t||(t={});var n=q(),r=e.length;n.p(e);var o=J(e,t,Ie(t),8),i=o.length;return ye(o,t),be(o,i-8,n.d()),be(o,i-4,r),o}var ze=function(){function e(e){this.v=1,De.call(this,e)}return e.prototype.push=function(e,t){if(De.prototype.e.call(this,e),this.v){var n=this.p.length>3?we(this.p):4;if(n>=this.p.length&&!t)return;this.p=this.p.subarray(n),this.v=0}if(t){if(this.p.length<8)throw"invalid gzip stream";this.p=this.p.subarray(0,-8)}De.prototype.c.call(this,t)},e}(),Ue=function(){function e(e){this.ondata=e,de([oe,ae,function(){return[fe,De,ze]}],this,0,(function(){var e=new ze;onmessage=fe(e)}),9)}return e}();function Ve(e,t,n){if(n||(n=t,t={}),"function"!=typeof n)throw"no callback";return pe(e,t,[oe,ae,function(){return[Be]}],(function(e){return ue(Be(e.data[0]))}),3,n)}function Be(e,t){return j(e.subarray(we(e),-8),t||new l(xe(e)))}var He=function(){function e(e,t){this.c=$(),this.v=1,Ae.call(this,e,t)}return e.prototype.push=function(e,t){Ae.prototype.push.call(this,e,t)},e.prototype.p=function(e,t){this.c.p(e);var n=J(e,this.o,this.v&&2,t&&4,!t);this.v&&(Ee(n,this.o),this.v=0),t&&be(n,n.length-4,this.c.d()),this.ondata(n,t)},e}(),Xe=function(){function e(e,t){de([ie,ce,function(){return[fe,Ae,He]}],this,ke.call(this,e,t),(function(e){var t=new He(e.data);onmessage=fe(t)}),10)}return e}();function _e(e,t,n){if(n||(n=t,t={}),"function"!=typeof n)throw"no callback";return pe(e,t,[ie,ce,function(){return[Ge]}],(function(e){return ue(Ge(e.data[0],e.data[1]))}),4,n)}function Ge(e,t){t||(t={});var n=$();n.p(e);var r=J(e,t,2,4);return Ee(r,t),be(r,r.length-4,n.d()),r}var Ye=function(){function e(e){this.v=1,De.call(this,e)}return e.prototype.push=function(e,t){if(De.prototype.e.call(this,e),this.v){if(this.p.length<2&&!t)return;this.p=this.p.subarray(2),this.v=0}if(t){if(this.p.length<4)throw"invalid zlib stream";this.p=this.p.subarray(0,-4)}De.prototype.c.call(this,t)},e}(),We=function(){function e(e){this.ondata=e,de([oe,le,function(){return[fe,De,Ye]}],this,0,(function(){var e=new Ye;onmessage=fe(e)}),11)}return e}();function Ze(e,t,n){if(n||(n=t,t={}),"function"!=typeof n)throw"no callback";return pe(e,t,[oe,le,function(){return[Ke]}],(function(e){return ue(Ke(e.data[0],he(e.data[1])))}),5,n)}function Ke(e,t){return j((Te(e),e.subarray(2,-4)),t)}var qe=function(){function e(e){this.G=ze,this.I=De,this.Z=Ye,this.ondata=e}return e.prototype.push=function(e,t){if(!this.ondata)throw"no stream handler";if(this.s)this.s.push(e,t);else{if(this.p&&this.p.length){var n=new l(this.p.length+e.length);n.set(this.p),n.set(e,this.p.length)}else this.p=e;if(this.p.length>2){var r=this,o=function(){r.ondata.apply(r,arguments)};this.s=31==this.p[0]&&139==this.p[1]&&8==this.p[2]?new this.G(o):8!=(15&this.p[0])||this.p[0]>>4>7||(this.p[0]<<8|this.p[1])%31?new this.I(o):new this.Z(o),this.s.push(this.p,t),this.p=null}}},e}(),$e=function(){function e(e){this.G=Ue,this.I=Ce,this.Z=We,this.ondata=e}return e.prototype.push=function(e,t){qe.prototype.push.call(this,e,t)},e}();function Je(e,t,n){if(n||(n=t,t={}),"function"!=typeof n)throw"no callback";return 31==e[0]&&139==e[1]&&8==e[2]?Ve(e,t,n):8!=(15&e[0])||e[0]>>4>7||(e[0]<<8|e[1])%31?Me(e,t,n):Ze(e,t,n)}function Qe(e,t){return 31==e[0]&&139==e[1]&&8==e[2]?Be(e,t):8!=(15&e[0])||e[0]>>4>7||(e[0]<<8|e[1])%31?Ne(e,t):Ke(e,t)}var et=function(e,t,n,r){for(var o in e){var i=e[o],s=t+o;i instanceof l?n[s]=[i,r]:Array.isArray(i)?n[s]=[i[0],Q(r,i[1])]:et(i,s+"/",n,r)}},tt="undefined"!=typeof TextEncoder&&new TextEncoder,nt="undefined"!=typeof TextDecoder&&new TextDecoder,rt=0;try{nt.decode(W,{stream:!0}),rt=1}catch(un){}var ot=function(e){for(var t="",n=0;;){var r=e[n++],o=(r>127)+(r>223)+(r>239);if(n+o>e.length)return[t,R(e,n-1)];o?3==o?(r=((15&r)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536,t+=String.fromCharCode(55296|r>>10,56320|1023&r)):t+=1&o?String.fromCharCode((31&r)<<6|63&e[n++]):String.fromCharCode((15&r)<<12|(63&e[n++])<<6|63&e[n++]):t+=String.fromCharCode(r)}},it=function(){function e(e){this.ondata=e,rt?this.t=new TextDecoder:this.p=W}return e.prototype.push=function(e,t){if(!this.ondata)throw"no callback";if(t=!!t,this.t){if(this.ondata(this.t.decode(e,{stream:!0}),t),t){if(this.t.decode().length)throw"invalid utf-8 data";this.t=null}}else{if(!this.p)throw"stream finished";var n=new l(this.p.length+e.length);n.set(this.p),n.set(e,this.p.length);var r=ot(n),o=r[0],i=r[1];if(t){if(i.length)throw"invalid utf-8 data";this.p=null}else this.p=i;this.ondata(o,t)}},e}(),st=function(){function e(e){this.ondata=e}return e.prototype.push=function(e,t){if(!this.ondata)throw"no callback";if(this.d)throw"stream finished";this.ondata(at(e),this.d=t||!1)},e}();function at(e,t){if(t){for(var n=new l(e.length),r=0;r<e.length;++r)n[r]=e.charCodeAt(r);return n}if(tt)return tt.encode(e);var o=e.length,i=new l(e.length+(e.length>>1)),s=0,a=function(e){i[s++]=e};for(r=0;r<o;++r){if(s+5>i.length){var c=new l(s+8+(o-r<<1));c.set(i),i=c}var u=e.charCodeAt(r);u<128||t?a(u):u<2048?(a(192|u>>6),a(128|63&u)):u>55295&&u<57344?(u=65536+(1047552&u)|1023&e.charCodeAt(++r),a(240|u>>18),a(128|u>>12&63),a(128|u>>6&63),a(128|63&u)):(a(224|u>>12),a(128|u>>6&63),a(128|63&u))}return R(i,0,s)}function ct(e,t){if(t){for(var n="",r=0;r<e.length;r+=16384)n+=String.fromCharCode.apply(null,e.subarray(r,r+16384));return n}if(nt)return nt.decode(e);var o=ot(e),i=o[0],s=o[1];if(s.length)throw"invalid utf-8 data";return i}var lt=function(e){return 1==e?3:e<6?2:9==e?1:0},ut=function(e,t){return t+30+me(e,t+26)+me(e,t+28)},ht=function(e,t,n){var r=me(e,t+28),o=ct(e.subarray(t+46,t+46+r),!(2048&me(e,t+8))),i=t+46+r,s=ge(e,t+20),a=n&&4294967295==s?pt(e,i):[s,ge(e,t+24),ge(e,t+42)],c=a[0],l=a[1],u=a[2];return[me(e,t+10),c,l,o,i+me(e,t+30)+me(e,t+32),u]},pt=function(e,t){for(;1!=me(e,t);t+=4+me(e,t+2));return[ve(e,t+12),ve(e,t+4),ve(e,t+20)]},ft=function(e){var t=0;if(e)for(var n in e){var r=e[n].length;if(r>65535)throw"extra field too long";t+=r+4}return t},dt=function(e,t,n,r,o,i,s,a){var c=r.length,l=n.extra,u=a&&a.length,h=ft(l);be(e,t,null!=s?33639248:67324752),t+=4,null!=s&&(e[t++]=20,e[t++]=n.os),e[t]=20,t+=2,e[t++]=n.flag<<1|(null==i&&8),e[t++]=o&&8,e[t++]=255&n.compression,e[t++]=n.compression>>8;var p=new Date(null==n.mtime?Date.now():n.mtime),f=p.getFullYear()-1980;if(f<0||f>119)throw"date not in range 1980-2099";if(be(e,t,f<<25|p.getMonth()+1<<21|p.getDate()<<16|p.getHours()<<11|p.getMinutes()<<5|p.getSeconds()>>>1),t+=4,null!=i&&(be(e,t,n.crc),be(e,t+4,i),be(e,t+8,n.size)),be(e,t+12,c),be(e,t+14,h),t+=16,null!=s&&(be(e,t,u),be(e,t+6,n.attrs),be(e,t+10,s),t+=14),e.set(r,t),t+=c,h)for(var d in l){var m=l[d],g=m.length;be(e,t,+d),be(e,t+2,g),e.set(m,t+4),t+=4+g}return u&&(e.set(a,t),t+=u),t},mt=function(e,t,n,r,o){be(e,t,101010256),be(e,t+8,n),be(e,t+10,n),be(e,t+12,r),be(e,t+16,o)},gt=function(){function e(e){this.filename=e,this.c=q(),this.size=0,this.compression=0}return e.prototype.process=function(e,t){this.ondata(null,e,t)},e.prototype.push=function(e,t){if(!this.ondata)throw"no callback - add to ZIP archive before pushing";this.c.p(e),this.size+=e.length,t&&(this.crc=this.c.d()),this.process(e,t||!1)},e}(),vt=function(){function e(e,t){var n=this;t||(t={}),gt.call(this,e),this.d=new Ae(t,(function(e,t){n.ondata(null,e,t)})),this.compression=8,this.flag=lt(t.level)}return e.prototype.process=function(e,t){try{this.d.push(e,t)}catch(un){this.ondata(un,null,t)}},e.prototype.push=function(e,t){gt.prototype.push.call(this,e,t)},e}(),bt=function(){function e(e,t){var n=this;t||(t={}),gt.call(this,e),this.d=new Oe(t,(function(e,t,r){n.ondata(e,t,r)})),this.compression=8,this.flag=lt(t.level),this.terminate=this.d.terminate}return e.prototype.process=function(e,t){this.d.push(e,t)},e.prototype.push=function(e,t){gt.prototype.push.call(this,e,t)},e}(),yt=function(){function e(e){this.ondata=e,this.u=[],this.d=1}return e.prototype.add=function(e){var t=this;if(2&this.d)throw"stream finished";var n=at(e.filename),r=n.length,o=e.comment,i=o&&at(o),s=r!=e.filename.length||i&&o.length!=i.length,a=r+ft(e.extra)+30;if(r>65535)throw"filename too long";var c=new l(a);dt(c,0,e,n,s);var u=[c],h=function(){for(var e=0,n=u;e<n.length;e++){var r=n[e];t.ondata(null,r,!1)}u=[]},p=this.d;this.d=0;var f=this.u.length,d=Q(e,{f:n,u:s,o:i,t:function(){e.terminate&&e.terminate()},r:function(){if(h(),p){var e=t.u[f+1];e?e.r():t.d=1}p=1}}),m=0;e.ondata=function(n,r,o){if(n)t.ondata(n,r,o),t.terminate();else if(m+=r.length,u.push(r),o){var i=new l(16);be(i,0,134695760),be(i,4,e.crc),be(i,8,m),be(i,12,e.size),u.push(i),d.c=m,d.b=a+m+16,d.crc=e.crc,d.size=e.size,p&&d.r(),p=1}else p&&h()},this.u.push(d)},e.prototype.end=function(){var e=this;if(2&this.d){if(1&this.d)throw"stream finishing";throw"stream finished"}this.d?this.e():this.u.push({r:function(){1&e.d&&(e.u.splice(-1,1),e.e())},t:function(){}}),this.d=3},e.prototype.e=function(){for(var e=0,t=0,n=0,r=0,o=this.u;r<o.length;r++){var i=o[r];n+=46+i.f.length+ft(i.extra)+(i.o?i.o.length:0)}for(var s=new l(n+22),a=0,c=this.u;a<c.length;a++){i=c[a];dt(s,e,i,i.f,i.u,i.c,t,i.o),e+=46+i.f.length+ft(i.extra)+(i.o?i.o.length:0),t+=i.b}mt(s,e,this.u.length,n,t),this.ondata(null,s,!0),this.d=2},e.prototype.terminate=function(){for(var e=0,t=this.u;e<t.length;e++){var n=t[e];n.t()}this.d=2},e}();function wt(e,t,n){if(n||(n=t,t={}),"function"!=typeof n)throw"no callback";var r={};et(e,"",r,t);var o=Object.keys(r),i=o.length,s=0,a=0,c=i,u=new Array(i),h=[],p=function(){for(var e=0;e<h.length;++e)h[e]()},f=function(){var e=new l(a+22),t=s,r=a-s;a=0;for(var o=0;o<c;++o){var i=u[o];try{var h=i.c.length;dt(e,a,i,i.f,i.u,h);var p=30+i.f.length+ft(i.extra),f=a+p;e.set(i.c,f),dt(e,s,i,i.f,i.u,h,a,i.m),s+=16+p+(i.m?i.m.length:0),a=f+h}catch(un){return n(un,null)}}mt(e,s,u.length,r,t),n(null,e)};i||f();for(var d=function(e){var t=o[e],c=r[t],l=c[0],d=c[1],m=q(),g=l.length;m.p(l);var v=at(t),b=v.length,y=d.comment,w=y&&at(y),x=w&&w.length,I=ft(d.extra),E=0==d.level?0:8,T=function(r,o){if(r)p(),n(r,null);else{var c=o.length;u[e]=Q(d,{size:g,crc:m.d(),c:o,f:v,m:w,u:b!=t.length||w&&y.length!=x,compression:E}),s+=30+b+I+c,a+=76+2*(b+I)+(x||0)+c,--i||f()}};if(b>65535&&T("filename too long",null),E)if(g<16e4)try{T(null,Pe(l,d))}catch(un){T(un,null)}else h.push(Le(l,d,T));else T(null,l)},m=0;m<c;++m)d(m);return p}function xt(e,t){t||(t={});var n={},r=[];et(e,"",n,t);var o=0,i=0;for(var s in n){var a=n[s],c=a[0],u=a[1],h=0==u.level?0:8,p=at(s),f=p.length,d=u.comment,m=d&&at(d),g=m&&m.length,v=ft(u.extra);if(f>65535)throw"filename too long";var b=h?Pe(c,u):c,y=b.length,w=q();w.p(c),r.push(Q(u,{size:c.length,crc:w.d(),c:b,f:p,m:m,u:f!=s.length||m&&d.length!=g,o:o,compression:h})),o+=30+f+v+y,i+=76+2*(f+v)+(g||0)+y}for(var x=new l(i+22),I=o,E=i-o,T=0;T<r.length;++T){p=r[T];dt(x,p.o,p,p.f,p.u,p.c.length);var k=30+p.f.length+ft(p.extra);x.set(p.c,p.o+k),dt(x,o,p,p.f,p.u,p.c.length,p.o,p.m),o+=16+k+(p.m?p.m.length:0)}return mt(x,o,r.length,E,I),x}var It=function(){function e(){}return e.prototype.push=function(e,t){this.ondata(null,e,t)},e.compression=0,e}(),Et=function(){function e(){var e=this;this.i=new De((function(t,n){e.ondata(null,t,n)}))}return e.prototype.push=function(e,t){try{this.i.push(e,t)}catch(un){this.ondata(un,e,t)}},e.compression=8,e}(),Tt=function(){function e(e,t){var n=this;t<32e4?this.i=new De((function(e,t){n.ondata(null,e,t)})):(this.i=new Ce((function(e,t,r){n.ondata(e,t,r)})),this.terminate=this.i.terminate)}return e.prototype.push=function(e,t){this.i.terminate&&(e=R(e,0)),this.i.push(e,t)},e.compression=8,e}(),kt=function(){function e(e){this.onfile=e,this.k=[],this.o={0:It},this.p=W}return e.prototype.push=function(e,t){var n=this;if(!this.onfile)throw"no callback";if(!this.p)throw"stream finished";if(this.c>0){var r=Math.min(this.c,e.length),o=e.subarray(0,r);if(this.c-=r,this.d?this.d.push(o,!this.c):this.k[0].push(o),e=e.subarray(r),e.length)return this.push(e,t)}else{var i=0,s=0,a=void 0,c=void 0;this.p.length?e.length?(c=new l(this.p.length+e.length),c.set(this.p),c.set(e,this.p.length)):c=this.p:c=e;for(var u=c.length,h=this.c,p=h&&this.d,f=function(){var e,t=ge(c,s);if(67324752==t){i=1,a=s,d.d=null,d.c=0;var r=me(c,s+6),o=me(c,s+8),l=2048&r,p=8&r,f=me(c,s+26),m=me(c,s+28);if(u>s+30+f+m){var g=[];d.k.unshift(g),i=2;var v,b=ge(c,s+18),y=ge(c,s+22),w=ct(c.subarray(s+30,s+=30+f),!l);4294967295==b?(e=p?[-2]:pt(c,s),b=e[0],y=e[1]):p&&(b=-1),s+=m,d.c=b;var x={name:w,compression:o,start:function(){if(!x.ondata)throw"no callback";if(b){var e=n.o[o];if(!e)throw"unknown compression type "+o;v=b<0?new e(w):new e(w,b,y),v.ondata=function(e,t,n){x.ondata(e,t,n)};for(var t=0,r=g;t<r.length;t++){var i=r[t];v.push(i,!1)}n.k[0]==g&&n.c?n.d=v:v.push(W,!0)}else x.ondata(null,W,!0)},terminate:function(){v&&v.terminate&&v.terminate()}};b>=0&&(x.size=b,x.originalSize=y),d.onfile(x)}return"break"}if(h){if(134695760==t)return a=s+=12+(-2==h&&8),i=3,d.c=0,"break";if(33639248==t)return a=s-=4,i=3,d.c=0,"break"}},d=this;s<u-4;++s){var m=f();if("break"===m)break}if(this.p=W,h<0){var g=i?c.subarray(0,a-12-(-2==h&&8)-(134695760==ge(c,a-16)&&4)):c.subarray(0,s);p?p.push(g,!!i):this.k[+(2==i)].push(g)}if(2&i)return this.push(c.subarray(s),t);this.p=c.subarray(s)}if(t){if(this.c)throw"invalid zip file";this.p=null}},e.prototype.register=function(e){this.o[e.compression]=e},e}();function At(e,t){if("function"!=typeof t)throw"no callback";for(var n=[],r=function(){for(var e=0;e<n.length;++e)n[e]()},o={},i=e.length-22;101010256!=ge(e,i);--i)if(!i||e.length-i>65558)return void t("invalid zip file",null);var s=me(e,i+8);s||t(null,{});var a=s,c=ge(e,i+16),u=4294967295==c;if(u){if(i=ge(e,i-12),101075792!=ge(e,i))return void t("invalid zip file",null);a=s=ge(e,i+32),c=ge(e,i+48)}for(var h=function(a){var h=ht(e,c,u),p=h[0],f=h[1],d=h[2],m=h[3],g=h[4],v=h[5],b=ut(e,v);c=g;var y=function(e,n){e?(r(),t(e,null)):(o[m]=n,--s||t(null,o))};if(p)if(8==p){var w=e.subarray(b,b+f);if(f<32e4)try{y(null,Ne(w,new l(d)))}catch(i){y(i,null)}else n.push(Me(w,{size:d},y))}else y("unknown compression type "+p,null);else y(null,R(e,b,b+f))},p=0;p<a;++p)h(p);return r}function Ot(e){for(var t={},n=e.length-22;101010256!=ge(e,n);--n)if(!n||e.length-n>65558)throw"invalid zip file";var r=me(e,n+8);if(!r)return{};var o=ge(e,n+16),i=4294967295==o;if(i){if(n=ge(e,n-12),101075792!=ge(e,n))throw"invalid zip file";r=ge(e,n+32),o=ge(e,n+48)}for(var s=0;s<r;++s){var a=ht(e,o,i),c=a[0],u=a[1],h=a[2],p=a[3],f=a[4],d=a[5],m=ut(e,d);if(o=f,c){if(8!=c)throw"unknown compression type "+c;t[p]=Ne(e.subarray(m,m+u),new l(h))}else t[p]=R(e,m,m+u)}return t}function Lt(e,t,n){const r=n.length-e-1;if(t>=n[r])return r-1;if(t<=n[e])return e;let o=e,i=r,s=Math.floor((o+i)/2);while(t<n[s]||t>=n[s+1])t<n[s]?i=s:o=s,s=Math.floor((o+i)/2);return s}function Pt(e,t,n,r){const o=[],i=[],s=[];o[0]=1;for(let a=1;a<=n;++a){i[a]=t-r[e+1-a],s[a]=r[e+a]-t;let n=0;for(let e=0;e<a;++e){const t=s[e+1],r=i[a-e],c=o[e]/(t+r);o[e]=n+t*c,n=r*c}o[a]=n}return o}function Dt(e,t,n,r){const i=Lt(e,r,t),s=Pt(i,r,e,t),a=new o["Ec"](0,0,0,0);for(let o=0;o<=e;++o){const t=n[i-e+o],r=s[o],c=t.w*r;a.x+=t.x*c,a.y+=t.y*c,a.z+=t.z*c,a.w+=t.w*r}return a}function Ct(e,t,n,r,o){const i=[];for(let h=0;h<=n;++h)i[h]=0;const s=[];for(let h=0;h<=r;++h)s[h]=i.slice(0);const a=[];for(let h=0;h<=n;++h)a[h]=i.slice(0);a[0][0]=1;const c=i.slice(0),l=i.slice(0);for(let h=1;h<=n;++h){c[h]=t-o[e+1-h],l[h]=o[e+h]-t;let n=0;for(let e=0;e<h;++e){const t=l[e+1],r=c[h-e];a[h][e]=t+r;const o=a[e][h-1]/a[h][e];a[e][h]=n+t*o,n=r*o}a[h][h]=n}for(let h=0;h<=n;++h)s[0][h]=a[h][n];for(let h=0;h<=n;++h){let e=0,t=1;const o=[];for(let r=0;r<=n;++r)o[r]=i.slice(0);o[0][0]=1;for(let i=1;i<=r;++i){let r=0;const c=h-i,l=n-i;h>=i&&(o[t][0]=o[e][0]/a[l+1][c],r=o[t][0]*a[c][l]);const u=c>=-1?1:-c,p=h-1<=l?i-1:n-h;for(let n=u;n<=p;++n)o[t][n]=(o[e][n]-o[e][n-1])/a[l+1][c+n],r+=o[t][n]*a[c+n][l];h<=l&&(o[t][i]=-o[e][i-1]/a[l+1][h],r+=o[t][i]*a[h][l]),s[i][h]=r;const f=e;e=t,t=f}}let u=n;for(let h=1;h<=r;++h){for(let e=0;e<=n;++e)s[h][e]*=u;u*=n-h}return s}function Mt(e,t,n,r,i){const s=i<e?i:e,a=[],c=Lt(e,r,t),l=Ct(c,r,e,s,t),u=[];for(let o=0;o<n.length;++o){const e=n[o].clone(),t=e.w;e.x*=t,e.y*=t,e.z*=t,u[o]=e}for(let o=0;o<=s;++o){const t=u[c-e].clone().multiplyScalar(l[o][0]);for(let n=1;n<=e;++n)t.add(u[c-e+n].clone().multiplyScalar(l[o][n]));a[o]=t}for(let h=s+1;h<=i+1;++h)a[h]=new o["Ec"](0,0,0);return a}function Nt(e,t){let n=1;for(let o=2;o<=e;++o)n*=o;let r=1;for(let o=2;o<=t;++o)r*=o;for(let o=2;o<=e-t;++o)r*=o;return n/r}function Ft(e){const t=e.length,n=[],r=[];for(let s=0;s<t;++s){const t=e[s];n[s]=new o["Dc"](t.x,t.y,t.z),r[s]=t.w}const i=[];for(let o=0;o<t;++o){const e=n[o].clone();for(let t=1;t<=o;++t)e.sub(i[o-t].clone().multiplyScalar(Nt(o,t)*r[t]));i[o]=e.divideScalar(r[0])}return i}function St(e,t,n,r,o){const i=Mt(e,t,n,r,o);return Ft(i)}class Rt extends o["y"]{constructor(e,t,n,r,i){super(),this.degree=e,this.knots=t,this.controlPoints=[],this.startKnot=r||0,this.endKnot=i||this.knots.length-1;for(let s=0;s<n.length;++s){const e=n[s];this.controlPoints[s]=new o["Ec"](e.x,e.y,e.z,e.w)}}getPoint(e,t=new o["Dc"]){const n=t,r=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),i=Dt(this.degree,this.knots,this.controlPoints,r);return 1!==i.w&&i.divideScalar(i.w),n.set(i.x,i.y,i.z)}getTangent(e,t=new o["Dc"]){const n=t,r=this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),i=St(this.degree,this.knots,this.controlPoints,r,1);return n.copy(i[1]).normalize(),n}}let jt,zt,Ut;class Vt extends o["hb"]{constructor(e){super(e)}load(e,t,n,r){const i=this,s=""===i.path?o["ib"].extractUrlBase(e):i.path,a=new o["N"](this.manager);a.setPath(i.path),a.setResponseType("arraybuffer"),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,(function(n){try{t(i.parse(n,s))}catch(un){r?r(un):console.error(un),i.manager.itemError(e)}}),n,r)}parse(e,t){if(Zt(e))jt=(new Gt).parse(e);else{const t=sn(e);if(!Kt(t))throw new Error("THREE.FBXLoader: Unknown format.");if(qt(t)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+qt(t));jt=(new _t).parse(t)}const n=new o["sc"](this.manager).setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);return new Bt(n,this.manager).parse(jt)}}class Bt{constructor(e,t){this.textureLoader=e,this.manager=t}parse(){zt=this.parseConnections();const e=this.parseImages(),t=this.parseTextures(e),n=this.parseMaterials(t),r=this.parseDeformers(),o=(new Ht).parse(r);return this.parseScene(r,o,n),Ut}parseConnections(){const e=new Map;if("Connections"in jt){const t=jt.Connections.connections;t.forEach((function(t){const n=t[0],r=t[1],o=t[2];e.has(n)||e.set(n,{parents:[],children:[]});const i={ID:r,relationship:o};e.get(n).parents.push(i),e.has(r)||e.set(r,{parents:[],children:[]});const s={ID:n,relationship:o};e.get(r).children.push(s)}))}return e}parseImages(){const e={},t={};if("Video"in jt.Objects){const n=jt.Objects.Video;for(const r in n){const o=n[r],i=parseInt(r);if(e[i]=o.RelativeFilename||o.Filename,"Content"in o){const e=o.Content instanceof ArrayBuffer&&o.Content.byteLength>0,i="string"===typeof o.Content&&""!==o.Content;if(e||i){const e=this.parseImage(n[r]);t[o.RelativeFilename||o.Filename]=e}}}}for(const n in e){const r=e[n];void 0!==t[r]?e[n]=t[r]:e[n]=e[n].split("\\").pop()}return e}parseImage(e){const t=e.Content,n=e.RelativeFilename||e.Filename,r=n.slice(n.lastIndexOf(".")+1).toLowerCase();let o;switch(r){case"bmp":o="image/bmp";break;case"jpg":case"jpeg":o="image/jpeg";break;case"png":o="image/png";break;case"tif":o="image/tiff";break;case"tga":null===this.manager.getHandler(".tga")&&console.warn("FBXLoader: TGA loader not found, skipping ",n),o="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+r+'" is not supported.')}if("string"===typeof t)return"data:"+o+";base64,"+t;{const e=new Uint8Array(t);return window.URL.createObjectURL(new Blob([e],{type:o}))}}parseTextures(e){const t=new Map;if("Texture"in jt.Objects){const n=jt.Objects.Texture;for(const r in n){const o=this.parseTexture(n[r],e);t.set(parseInt(r),o)}}return t}parseTexture(e,t){const n=this.loadTexture(e,t);n.ID=e.id,n.name=e.attrName;const r=e.WrapModeU,i=e.WrapModeV,s=void 0!==r?r.value:0,a=void 0!==i?i.value:0;if(n.wrapS=0===s?o["Yb"]:o["s"],n.wrapT=0===a?o["Yb"]:o["s"],"Scaling"in e){const t=e.Scaling.value;n.repeat.x=t[0],n.repeat.y=t[1]}return n}loadTexture(e,t){let n;const r=this.textureLoader.path,i=zt.get(e.id).children;let s;void 0!==i&&i.length>0&&void 0!==t[i[0].ID]&&(n=t[i[0].ID],0!==n.indexOf("blob:")&&0!==n.indexOf("data:")||this.textureLoader.setPath(void 0));const a=e.FileName.slice(-3).toLowerCase();if("tga"===a){const t=this.manager.getHandler(".tga");null===t?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",e.RelativeFilename),s=new o["rc"]):(t.setPath(this.textureLoader.path),s=t.load(n))}else"psd"===a?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",e.RelativeFilename),s=new o["rc"]):s=this.textureLoader.load(n);return this.textureLoader.setPath(r),s}parseMaterials(e){const t=new Map;if("Material"in jt.Objects){const n=jt.Objects.Material;for(const r in n){const o=this.parseMaterial(n[r],e);null!==o&&t.set(parseInt(r),o)}}return t}parseMaterial(e,t){const n=e.id,r=e.attrName;let i=e.ShadingModel;if("object"===typeof i&&(i=i.value),!zt.has(n))return null;const s=this.parseParameters(e,t,n);let a;switch(i.toLowerCase()){case"phong":a=new o["tb"];break;case"lambert":a=new o["sb"];break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',i),a=new o["tb"];break}return a.setValues(s),a.name=r,a}parseParameters(e,t,n){const r={};e.BumpFactor&&(r.bumpScale=e.BumpFactor.value),e.Diffuse?r.color=(new o["u"]).fromArray(e.Diffuse.value):!e.DiffuseColor||"Color"!==e.DiffuseColor.type&&"ColorRGB"!==e.DiffuseColor.type||(r.color=(new o["u"]).fromArray(e.DiffuseColor.value)),e.DisplacementFactor&&(r.displacementScale=e.DisplacementFactor.value),e.Emissive?r.emissive=(new o["u"]).fromArray(e.Emissive.value):!e.EmissiveColor||"Color"!==e.EmissiveColor.type&&"ColorRGB"!==e.EmissiveColor.type||(r.emissive=(new o["u"]).fromArray(e.EmissiveColor.value)),e.EmissiveFactor&&(r.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(r.opacity=parseFloat(e.Opacity.value)),r.opacity<1&&(r.transparent=!0),e.ReflectionFactor&&(r.reflectivity=e.ReflectionFactor.value),e.Shininess&&(r.shininess=e.Shininess.value),e.Specular?r.specular=(new o["u"]).fromArray(e.Specular.value):e.SpecularColor&&"Color"===e.SpecularColor.type&&(r.specular=(new o["u"]).fromArray(e.SpecularColor.value));const i=this;return zt.get(n).children.forEach((function(e){const n=e.relationship;switch(n){case"Bump":r.bumpMap=i.getTexture(t,e.ID);break;case"Maya|TEX_ao_map":r.aoMap=i.getTexture(t,e.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":r.map=i.getTexture(t,e.ID),void 0!==r.map&&(r.map.encoding=o["Mc"]);break;case"DisplacementColor":r.displacementMap=i.getTexture(t,e.ID);break;case"EmissiveColor":r.emissiveMap=i.getTexture(t,e.ID),void 0!==r.emissiveMap&&(r.emissiveMap.encoding=o["Mc"]);break;case"NormalMap":case"Maya|TEX_normal_map":r.normalMap=i.getTexture(t,e.ID);break;case"ReflectionColor":r.envMap=i.getTexture(t,e.ID),void 0!==r.envMap&&(r.envMap.mapping=o["J"],r.envMap.encoding=o["Mc"]);break;case"SpecularColor":r.specularMap=i.getTexture(t,e.ID),void 0!==r.specularMap&&(r.specularMap.encoding=o["Mc"]);break;case"TransparentColor":case"TransparencyFactor":r.alphaMap=i.getTexture(t,e.ID),r.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",n);break}})),r}getTexture(e,t){return"LayeredTexture"in jt.Objects&&t in jt.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),t=zt.get(t).children[0].ID),e.get(t)}parseDeformers(){const e={},t={};if("Deformer"in jt.Objects){const n=jt.Objects.Deformer;for(const r in n){const o=n[r],i=zt.get(parseInt(r));if("Skin"===o.attrType){const t=this.parseSkeleton(i,n);t.ID=r,i.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),t.geometryID=i.parents[0].ID,e[r]=t}else if("BlendShape"===o.attrType){const e={id:r};e.rawTargets=this.parseMorphTargets(i,n),e.id=r,i.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),t[r]=e}}}return{skeletons:e,morphTargets:t}}parseSkeleton(e,t){const n=[];return e.children.forEach((function(e){const r=t[e.ID];if("Cluster"!==r.attrType)return;const i={ID:e.ID,indices:[],weights:[],transformLink:(new o["ob"]).fromArray(r.TransformLink.a)};"Indexes"in r&&(i.indices=r.Indexes.a,i.weights=r.Weights.a),n.push(i)})),{rawBones:n,bones:[]}}parseMorphTargets(e,t){const n=[];for(let r=0;r<e.children.length;r++){const o=e.children[r],i=t[o.ID],s={name:i.attrName,initialWeight:i.DeformPercent,id:i.id,fullWeights:i.FullWeights.a};if("BlendShapeChannel"!==i.attrType)return;s.geoID=zt.get(parseInt(o.ID)).children.filter((function(e){return void 0===e.relationship}))[0].ID,n.push(s)}return n}parseScene(e,t,n){Ut=new o["S"];const r=this.parseModels(e.skeletons,t,n),i=jt.Objects.Model,s=this;r.forEach((function(e){const t=i[e.ID];s.setLookAtProperties(e,t);const n=zt.get(e.ID).parents;n.forEach((function(t){const n=r.get(t.ID);void 0!==n&&n.add(e)})),null===e.parent&&Ut.add(e)})),this.bindSkeleton(e.skeletons,t,r),this.createAmbientLight(),Ut.traverse((function(e){if(e.userData.transformData){e.parent&&(e.userData.transformData.parentMatrix=e.parent.matrix,e.userData.transformData.parentMatrixWorld=e.parent.matrixWorld);const t=nn(e.userData.transformData);e.applyMatrix4(t),e.updateWorldMatrix()}}));const a=(new Xt).parse();1===Ut.children.length&&Ut.children[0].isGroup&&(Ut.children[0].animations=a,Ut=Ut.children[0]),Ut.animations=a}parseModels(e,t,n){const r=new Map,i=jt.Objects.Model;for(const s in i){const a=parseInt(s),c=i[s],l=zt.get(a);let u=this.buildSkeleton(l,e,a,c.attrName);if(!u){switch(c.attrType){case"Camera":u=this.createCamera(l);break;case"Light":u=this.createLight(l);break;case"Mesh":u=this.createMesh(l,t,n);break;case"NurbsCurve":u=this.createCurve(l,t);break;case"LimbNode":case"Root":u=new o["i"];break;case"Null":default:u=new o["S"];break}u.name=c.attrName?o["Kb"].sanitizeNodeName(c.attrName):"",u.ID=a}this.getTransformData(u,c),r.set(a,u)}return r}buildSkeleton(e,t,n,r){let i=null;return e.parents.forEach((function(e){for(const s in t){const a=t[s];a.rawBones.forEach((function(t,s){if(t.ID===e.ID){const e=i;i=new o["i"],i.matrixWorld.copy(t.transformLink),i.name=r?o["Kb"].sanitizeNodeName(r):"",i.ID=n,a.bones[s]=i,null!==e&&i.add(e)}}))}})),i}createCamera(e){let t,n;if(e.children.forEach((function(e){const t=jt.Objects.NodeAttribute[e.ID];void 0!==t&&(n=t)})),void 0===n)t=new o["zb"];else{let e=0;void 0!==n.CameraProjectionType&&1===n.CameraProjectionType.value&&(e=1);let r=1;void 0!==n.NearPlane&&(r=n.NearPlane.value/1e3);let i=1e3;void 0!==n.FarPlane&&(i=n.FarPlane.value/1e3);let s=window.innerWidth,a=window.innerHeight;void 0!==n.AspectWidth&&void 0!==n.AspectHeight&&(s=n.AspectWidth.value,a=n.AspectHeight.value);const c=s/a;let l=45;void 0!==n.FieldOfView&&(l=n.FieldOfView.value);const u=n.FocalLength?n.FocalLength.value:null;switch(e){case 0:t=new o["Eb"](l,c,r,i),null!==u&&t.setFocalLength(u);break;case 1:t=new o["Cb"](-s/2,s/2,a/2,-a/2,r,i);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+e+"."),t=new o["zb"];break}}return t}createLight(e){let t,n;if(e.children.forEach((function(e){const t=jt.Objects.NodeAttribute[e.ID];void 0!==t&&(n=t)})),void 0===n)t=new o["zb"];else{let e;e=void 0===n.LightType?0:n.LightType.value;let r=16777215;void 0!==n.Color&&(r=(new o["u"]).fromArray(n.Color.value));let i=void 0===n.Intensity?1:n.Intensity.value/100;void 0!==n.CastLightOnObject&&0===n.CastLightOnObject.value&&(i=0);let s=0;void 0!==n.FarAttenuationEnd&&(s=void 0!==n.EnableFarAttenuation&&0===n.EnableFarAttenuation.value?0:n.FarAttenuationEnd.value);const a=1;switch(e){case 0:t=new o["Gb"](r,i,s,a);break;case 1:t=new o["F"](r,i);break;case 2:let e=Math.PI/3;void 0!==n.InnerAngle&&(e=o["mb"].degToRad(n.InnerAngle.value));let c=0;void 0!==n.OuterAngle&&(c=o["mb"].degToRad(n.OuterAngle.value),c=Math.max(c,1)),t=new o["lc"](r,i,s,e,c,a);break;default:console.warn("THREE.FBXLoader: Unknown light type "+n.LightType.value+", defaulting to a PointLight."),t=new o["Gb"](r,i);break}void 0!==n.CastShadows&&1===n.CastShadows.value&&(t.castShadow=!0)}return t}createMesh(e,t,n){let r,i=null,s=null;const a=[];return e.children.forEach((function(e){t.has(e.ID)&&(i=t.get(e.ID)),n.has(e.ID)&&a.push(n.get(e.ID))})),a.length>1?s=a:a.length>0?s=a[0]:(s=new o["tb"]({color:13421772}),a.push(s)),"color"in i.attributes&&a.forEach((function(e){e.vertexColors=!0})),i.FBX_Deformer?(r=new o["hc"](i,s),r.normalizeSkinWeights()):r=new o["pb"](i,s),r}createCurve(e,t){const n=e.children.reduce((function(e,n){return t.has(n.ID)&&(e=t.get(n.ID)),e}),null),r=new o["bb"]({color:3342591,linewidth:1});return new o["ab"](n,r)}getTransformData(e,t){const n={};"InheritType"in t&&(n.inheritType=parseInt(t.InheritType.value)),n.eulerOrder="RotationOrder"in t?rn(t.RotationOrder.value):"ZYX","Lcl_Translation"in t&&(n.translation=t.Lcl_Translation.value),"PreRotation"in t&&(n.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(n.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(n.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(n.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(n.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(n.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(n.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(n.rotationPivot=t.RotationPivot.value),e.userData.transformData=n}setLookAtProperties(e,t){if("LookAtProperty"in t){const t=zt.get(e.ID).children;t.forEach((function(t){if("LookAtProperty"===t.relationship){const n=jt.Objects.Model[t.ID];if("Lcl_Translation"in n){const t=n.Lcl_Translation.value;void 0!==e.target?(e.target.position.fromArray(t),Ut.add(e.target)):e.lookAt((new o["Dc"]).fromArray(t))}}}))}}bindSkeleton(e,t,n){const r=this.parsePoseNodes();for(const i in e){const s=e[i],a=zt.get(parseInt(s.ID)).parents;a.forEach((function(e){if(t.has(e.ID)){const t=e.ID,i=zt.get(t);i.parents.forEach((function(e){if(n.has(e.ID)){const t=n.get(e.ID);t.bind(new o["gc"](s.bones),r[e.ID])}}))}}))}}parsePoseNodes(){const e={};if("Pose"in jt.Objects){const t=jt.Objects.Pose;for(const n in t)if("BindPose"===t[n].attrType&&t[n].NbPoseNodes>0){const r=t[n].PoseNode;Array.isArray(r)?r.forEach((function(t){e[t.Node]=(new o["ob"]).fromArray(t.Matrix.a)})):e[r.Node]=(new o["ob"]).fromArray(r.Matrix.a)}}return e}createAmbientLight(){if("GlobalSettings"in jt&&"AmbientColor"in jt.GlobalSettings){const e=jt.GlobalSettings.AmbientColor.value,t=e[0],n=e[1],r=e[2];if(0!==t||0!==n||0!==r){const e=new o["u"](t,n,r);Ut.add(new o["c"](e,1))}}}}class Ht{parse(e){const t=new Map;if("Geometry"in jt.Objects){const n=jt.Objects.Geometry;for(const r in n){const o=zt.get(parseInt(r)),i=this.parseGeometry(o,n[r],e);t.set(parseInt(r),i)}}return t}parseGeometry(e,t,n){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,n);case"NurbsCurve":return this.parseNurbsGeometry(t)}}parseMeshGeometry(e,t,n){const r=n.skeletons,o=[],i=e.parents.map((function(e){return jt.Objects.Model[e.ID]}));if(0===i.length)return;const s=e.children.reduce((function(e,t){return void 0!==r[t.ID]&&(e=r[t.ID]),e}),null);e.children.forEach((function(e){void 0!==n.morphTargets[e.ID]&&o.push(n.morphTargets[e.ID])}));const a=i[0],c={};"RotationOrder"in a&&(c.eulerOrder=rn(a.RotationOrder.value)),"InheritType"in a&&(c.inheritType=parseInt(a.InheritType.value)),"GeometricTranslation"in a&&(c.translation=a.GeometricTranslation.value),"GeometricRotation"in a&&(c.rotation=a.GeometricRotation.value),"GeometricScaling"in a&&(c.scale=a.GeometricScaling.value);const l=nn(c);return this.genGeometry(t,s,o,l)}genGeometry(e,t,n,r){const i=new o["n"];e.attrName&&(i.name=e.attrName);const s=this.parseGeoNode(e,t),a=this.genBuffers(s),c=new o["O"](a.vertex,3);if(c.applyMatrix4(r),i.setAttribute("position",c),a.colors.length>0&&i.setAttribute("color",new o["O"](a.colors,3)),t&&(i.setAttribute("skinIndex",new o["yc"](a.weightsIndices,4)),i.setAttribute("skinWeight",new o["O"](a.vertexWeights,4)),i.FBX_Deformer=t),a.normal.length>0){const e=(new o["nb"]).getNormalMatrix(r),t=new o["O"](a.normal,3);t.applyNormalMatrix(e),i.setAttribute("normal",t)}if(a.uvs.forEach((function(e,t){let n="uv"+(t+1).toString();0===t&&(n="uv"),i.setAttribute(n,new o["O"](a.uvs[t],2))})),s.material&&"AllSame"!==s.material.mappingType){let e=a.materialIndex[0],t=0;if(a.materialIndex.forEach((function(n,r){n!==e&&(i.addGroup(t,r-t,e),e=n,t=r)})),i.groups.length>0){const t=i.groups[i.groups.length-1],n=t.start+t.count;n!==a.materialIndex.length&&i.addGroup(n,a.materialIndex.length-n,e)}0===i.groups.length&&i.addGroup(0,a.materialIndex.length,a.materialIndex[0])}return this.addMorphTargets(i,e,n,r),i}parseGeoNode(e,t){const n={};if(n.vertexPositions=void 0!==e.Vertices?e.Vertices.a:[],n.vertexIndices=void 0!==e.PolygonVertexIndex?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(n.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(n.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(n.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){n.uv=[];let t=0;while(e.LayerElementUV[t])e.LayerElementUV[t].UV&&n.uv.push(this.parseUVs(e.LayerElementUV[t])),t++}return n.weightTable={},null!==t&&(n.skeleton=t,t.rawBones.forEach((function(e,t){e.indices.forEach((function(r,o){void 0===n.weightTable[r]&&(n.weightTable[r]=[]),n.weightTable[r].push({id:t,weight:e.weights[o]})}))}))),n}genBuffers(e){const t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let n=0,r=0,o=!1,i=[],s=[],a=[],c=[],l=[],u=[];const h=this;return e.vertexIndices.forEach((function(p,f){let d,m=!1;p<0&&(p^=-1,m=!0);let g=[],v=[];if(i.push(3*p,3*p+1,3*p+2),e.color){const t=Qt(f,n,p,e.color);a.push(t[0],t[1],t[2])}if(e.skeleton){if(void 0!==e.weightTable[p]&&e.weightTable[p].forEach((function(e){v.push(e.weight),g.push(e.id)})),v.length>4){o||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),o=!0);const e=[0,0,0,0],t=[0,0,0,0];v.forEach((function(n,r){let o=n,i=g[r];t.forEach((function(t,n,r){if(o>t){r[n]=o,o=t;const s=e[n];e[n]=i,i=s}}))})),g=e,v=t}while(v.length<4)v.push(0),g.push(0);for(let e=0;e<4;++e)l.push(v[e]),u.push(g[e])}if(e.normal){const t=Qt(f,n,p,e.normal);s.push(t[0],t[1],t[2])}e.material&&"AllSame"!==e.material.mappingType&&(d=Qt(f,n,p,e.material)[0]),e.uv&&e.uv.forEach((function(e,t){const r=Qt(f,n,p,e);void 0===c[t]&&(c[t]=[]),c[t].push(r[0]),c[t].push(r[1])})),r++,m&&(h.genFace(t,e,i,d,s,a,c,l,u,r),n++,r=0,i=[],s=[],a=[],c=[],l=[],u=[])})),t}genFace(e,t,n,r,o,i,s,a,c,l){for(let u=2;u<l;u++)e.vertex.push(t.vertexPositions[n[0]]),e.vertex.push(t.vertexPositions[n[1]]),e.vertex.push(t.vertexPositions[n[2]]),e.vertex.push(t.vertexPositions[n[3*(u-1)]]),e.vertex.push(t.vertexPositions[n[3*(u-1)+1]]),e.vertex.push(t.vertexPositions[n[3*(u-1)+2]]),e.vertex.push(t.vertexPositions[n[3*u]]),e.vertex.push(t.vertexPositions[n[3*u+1]]),e.vertex.push(t.vertexPositions[n[3*u+2]]),t.skeleton&&(e.vertexWeights.push(a[0]),e.vertexWeights.push(a[1]),e.vertexWeights.push(a[2]),e.vertexWeights.push(a[3]),e.vertexWeights.push(a[4*(u-1)]),e.vertexWeights.push(a[4*(u-1)+1]),e.vertexWeights.push(a[4*(u-1)+2]),e.vertexWeights.push(a[4*(u-1)+3]),e.vertexWeights.push(a[4*u]),e.vertexWeights.push(a[4*u+1]),e.vertexWeights.push(a[4*u+2]),e.vertexWeights.push(a[4*u+3]),e.weightsIndices.push(c[0]),e.weightsIndices.push(c[1]),e.weightsIndices.push(c[2]),e.weightsIndices.push(c[3]),e.weightsIndices.push(c[4*(u-1)]),e.weightsIndices.push(c[4*(u-1)+1]),e.weightsIndices.push(c[4*(u-1)+2]),e.weightsIndices.push(c[4*(u-1)+3]),e.weightsIndices.push(c[4*u]),e.weightsIndices.push(c[4*u+1]),e.weightsIndices.push(c[4*u+2]),e.weightsIndices.push(c[4*u+3])),t.color&&(e.colors.push(i[0]),e.colors.push(i[1]),e.colors.push(i[2]),e.colors.push(i[3*(u-1)]),e.colors.push(i[3*(u-1)+1]),e.colors.push(i[3*(u-1)+2]),e.colors.push(i[3*u]),e.colors.push(i[3*u+1]),e.colors.push(i[3*u+2])),t.material&&"AllSame"!==t.material.mappingType&&(e.materialIndex.push(r),e.materialIndex.push(r),e.materialIndex.push(r)),t.normal&&(e.normal.push(o[0]),e.normal.push(o[1]),e.normal.push(o[2]),e.normal.push(o[3*(u-1)]),e.normal.push(o[3*(u-1)+1]),e.normal.push(o[3*(u-1)+2]),e.normal.push(o[3*u]),e.normal.push(o[3*u+1]),e.normal.push(o[3*u+2])),t.uv&&t.uv.forEach((function(t,n){void 0===e.uvs[n]&&(e.uvs[n]=[]),e.uvs[n].push(s[n][0]),e.uvs[n].push(s[n][1]),e.uvs[n].push(s[n][2*(u-1)]),e.uvs[n].push(s[n][2*(u-1)+1]),e.uvs[n].push(s[n][2*u]),e.uvs[n].push(s[n][2*u+1])}))}addMorphTargets(e,t,n,r){if(0===n.length)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];const o=this;n.forEach((function(n){n.rawTargets.forEach((function(n){const i=jt.Objects.Geometry[n.geoID];void 0!==i&&o.genMorphGeometry(e,t,i,r,n.name)}))}))}genMorphGeometry(e,t,n,r,i){const s=void 0!==t.PolygonVertexIndex?t.PolygonVertexIndex.a:[],a=void 0!==n.Vertices?n.Vertices.a:[],c=void 0!==n.Indexes?n.Indexes.a:[],l=3*e.attributes.position.count,u=new Float32Array(l);for(let o=0;o<c.length;o++){const e=3*c[o];u[e]=a[3*o],u[e+1]=a[3*o+1],u[e+2]=a[3*o+2]}const h={vertexIndices:s,vertexPositions:u},p=this.genBuffers(h),f=new o["O"](p.vertex,3);f.name=i||n.attrName,f.applyMatrix4(r),e.morphAttributes.position.push(f)}parseNormals(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.Normals.a;let o=[];return"IndexToDirect"===n&&("NormalIndex"in e?o=e.NormalIndex.a:"NormalsIndex"in e&&(o=e.NormalsIndex.a)),{dataSize:3,buffer:r,indices:o,mappingType:t,referenceType:n}}parseUVs(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.UV.a;let o=[];return"IndexToDirect"===n&&(o=e.UVIndex.a),{dataSize:2,buffer:r,indices:o,mappingType:t,referenceType:n}}parseVertexColors(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.Colors.a;let o=[];return"IndexToDirect"===n&&(o=e.ColorIndex.a),{dataSize:4,buffer:r,indices:o,mappingType:t,referenceType:n}}parseMaterialIndices(e){const t=e.MappingInformationType,n=e.ReferenceInformationType;if("NoMappingInformation"===t)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:n};const r=e.Materials.a,o=[];for(let i=0;i<r.length;++i)o.push(i);return{dataSize:1,buffer:r,indices:o,mappingType:t,referenceType:n}}parseNurbsGeometry(e){if(void 0===Rt)return console.error("THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new o["n"];const t=parseInt(e.Order);if(isNaN(t))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new o["n"];const n=t-1,r=e.KnotVector.a,i=[],s=e.Points.a;for(let h=0,p=s.length;h<p;h+=4)i.push((new o["Ec"]).fromArray(s,h));let a,c;if("Closed"===e.Form)i.push(i[0]);else if("Periodic"===e.Form){a=n,c=r.length-1-a;for(let e=0;e<n;++e)i.push(i[e])}const l=new Rt(n,r,i,a,c),u=l.getPoints(12*i.length);return(new o["n"]).setFromPoints(u)}}class Xt{parse(){const e=[],t=this.parseClips();if(void 0!==t)for(const n in t){const r=t[n],o=this.addClip(r);e.push(o)}return e}parseClips(){if(void 0===jt.Objects.AnimationCurve)return;const e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);const t=this.parseAnimationLayers(e),n=this.parseAnimStacks(t);return n}parseAnimationCurveNodes(){const e=jt.Objects.AnimationCurveNode,t=new Map;for(const n in e){const r=e[n];if(null!==r.attrName.match(/S|R|T|DeformPercent/)){const e={id:r.id,attr:r.attrName,curves:{}};t.set(e.id,e)}}return t}parseAnimationCurves(e){const t=jt.Objects.AnimationCurve;for(const n in t){const r={id:t[n].id,times:t[n].KeyTime.a.map($t),values:t[n].KeyValueFloat.a},o=zt.get(r.id);if(void 0!==o){const t=o.parents[0].ID,n=o.parents[0].relationship;n.match(/X/)?e.get(t).curves["x"]=r:n.match(/Y/)?e.get(t).curves["y"]=r:n.match(/Z/)?e.get(t).curves["z"]=r:n.match(/d|DeformPercent/)&&e.has(t)&&(e.get(t).curves["morph"]=r)}}}parseAnimationLayers(e){const t=jt.Objects.AnimationLayer,n=new Map;for(const r in t){const t=[],i=zt.get(parseInt(r));if(void 0!==i){const s=i.children;s.forEach((function(n,r){if(e.has(n.ID)){const i=e.get(n.ID);if(void 0!==i.curves.x||void 0!==i.curves.y||void 0!==i.curves.z){if(void 0===t[r]){const e=zt.get(n.ID).parents.filter((function(e){return void 0!==e.relationship}))[0].ID;if(void 0!==e){const i=jt.Objects.Model[e.toString()];if(void 0===i)return void console.warn("THREE.FBXLoader: Encountered a unused curve.",n);const s={modelName:i.attrName?o["Kb"].sanitizeNodeName(i.attrName):"",ID:i.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};Ut.traverse((function(e){e.ID===i.id&&(s.transform=e.matrix,e.userData.transformData&&(s.eulerOrder=e.userData.transformData.eulerOrder))})),s.transform||(s.transform=new o["ob"]),"PreRotation"in i&&(s.preRotation=i.PreRotation.value),"PostRotation"in i&&(s.postRotation=i.PostRotation.value),t[r]=s}}t[r]&&(t[r][i.attr]=i)}else if(void 0!==i.curves.morph){if(void 0===t[r]){const e=zt.get(n.ID).parents.filter((function(e){return void 0!==e.relationship}))[0].ID,i=zt.get(e).parents[0].ID,s=zt.get(i).parents[0].ID,a=zt.get(s).parents[0].ID,c=jt.Objects.Model[a],l={modelName:c.attrName?o["Kb"].sanitizeNodeName(c.attrName):"",morphName:jt.Objects.Deformer[e].attrName};t[r]=l}t[r][i.attr]=i}}})),n.set(parseInt(r),t)}}return n}parseAnimStacks(e){const t=jt.Objects.AnimationStack,n={};for(const r in t){const o=zt.get(parseInt(r)).children;o.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const i=e.get(o[0].ID);n[r]={name:t[r].attrName,layer:i}}return n}addClip(e){let t=[];const n=this;return e.layer.forEach((function(e){t=t.concat(n.generateTracks(e))})),new o["d"](e.name,-1,t)}generateTracks(e){const t=[];let n=new o["Dc"],r=new o["Lb"],i=new o["Dc"];if(e.transform&&e.transform.decompose(n,r,i),n=n.toArray(),r=(new o["K"]).setFromQuaternion(r,e.eulerOrder).toArray(),i=i.toArray(),void 0!==e.T&&Object.keys(e.T.curves).length>0){const r=this.generateVectorTrack(e.modelName,e.T.curves,n,"position");void 0!==r&&t.push(r)}if(void 0!==e.R&&Object.keys(e.R.curves).length>0){const n=this.generateRotationTrack(e.modelName,e.R.curves,r,e.preRotation,e.postRotation,e.eulerOrder);void 0!==n&&t.push(n)}if(void 0!==e.S&&Object.keys(e.S.curves).length>0){const n=this.generateVectorTrack(e.modelName,e.S.curves,i,"scale");void 0!==n&&t.push(n)}if(void 0!==e.DeformPercent){const n=this.generateMorphTrack(e);void 0!==n&&t.push(n)}return t}generateVectorTrack(e,t,n,r){const i=this.getTimesForAllAxes(t),s=this.getKeyframeTrackValues(i,t,n);return new o["Fc"](e+"."+r,i,s)}generateRotationTrack(e,t,n,r,i,s){void 0!==t.x&&(this.interpolateRotations(t.x),t.x.values=t.x.values.map(o["mb"].degToRad)),void 0!==t.y&&(this.interpolateRotations(t.y),t.y.values=t.y.values.map(o["mb"].degToRad)),void 0!==t.z&&(this.interpolateRotations(t.z),t.z.values=t.z.values.map(o["mb"].degToRad));const a=this.getTimesForAllAxes(t),c=this.getKeyframeTrackValues(a,t,n);void 0!==r&&(r=r.map(o["mb"].degToRad),r.push(s),r=(new o["K"]).fromArray(r),r=(new o["Lb"]).setFromEuler(r)),void 0!==i&&(i=i.map(o["mb"].degToRad),i.push(s),i=(new o["K"]).fromArray(i),i=(new o["Lb"]).setFromEuler(i).invert());const l=new o["Lb"],u=new o["K"],h=[];for(let o=0;o<c.length;o+=3)u.set(c[o],c[o+1],c[o+2],s),l.setFromEuler(u),void 0!==r&&l.premultiply(r),void 0!==i&&l.multiply(i),l.toArray(h,o/3*4);return new o["Mb"](e+".quaternion",a,h)}generateMorphTrack(e){const t=e.DeformPercent.curves.morph,n=t.values.map((function(e){return e/100})),r=Ut.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new o["yb"](e.modelName+".morphTargetInfluences["+r+"]",t.times,n)}getTimesForAllAxes(e){let t=[];if(void 0!==e.x&&(t=t.concat(e.x.times)),void 0!==e.y&&(t=t.concat(e.y.times)),void 0!==e.z&&(t=t.concat(e.z.times)),t=t.sort((function(e,t){return e-t})),t.length>1){let e=1,n=t[0];for(let r=1;r<t.length;r++){const o=t[r];o!==n&&(t[e]=o,n=o,e++)}t=t.slice(0,e)}return t}getKeyframeTrackValues(e,t,n){const r=n,o=[];let i=-1,s=-1,a=-1;return e.forEach((function(e){if(t.x&&(i=t.x.times.indexOf(e)),t.y&&(s=t.y.times.indexOf(e)),t.z&&(a=t.z.times.indexOf(e)),-1!==i){const e=t.x.values[i];o.push(e),r[0]=e}else o.push(r[0]);if(-1!==s){const e=t.y.values[s];o.push(e),r[1]=e}else o.push(r[1]);if(-1!==a){const e=t.z.values[a];o.push(e),r[2]=e}else o.push(r[2])})),o}interpolateRotations(e){for(let t=1;t<e.values.length;t++){const n=e.values[t-1],r=e.values[t]-n,o=Math.abs(r);if(o>=180){const i=o/180,s=r/i;let a=n+s;const c=e.times[t-1],l=e.times[t]-c,u=l/i;let h=c+u;const p=[],f=[];while(h<e.times[t])p.push(h),h+=u,f.push(a),a+=s;e.times=ln(e.times,t,p),e.values=ln(e.values,t,f)}}}}class _t{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,t){this.currentProp=e,this.currentPropName=t}parse(e){this.currentIndent=0,this.allNodes=new Wt,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const t=this,n=e.split(/[\r\n]+/);return n.forEach((function(e,r){const o=e.match(/^[\s\t]*;/),i=e.match(/^[\s\t]*$/);if(o||i)return;const s=e.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),a=e.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),c=e.match("^\\t{"+(t.currentIndent-1)+"}}");s?t.parseNodeBegin(e,s):a?t.parseNodeProperty(e,a,n[++r]):c?t.popStack():e.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(e)})),this.allNodes}parseNodeBegin(e,t){const n=t[1].trim().replace(/^"/,"").replace(/"$/,""),r=t[2].split(",").map((function(e){return e.trim().replace(/^"/,"").replace(/"$/,"")})),o={name:n},i=this.parseNodeAttr(r),s=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(n,o):n in s?("PoseNode"===n?s.PoseNode.push(o):void 0!==s[n].id&&(s[n]={},s[n][s[n].id]=s[n]),""!==i.id&&(s[n][i.id]=o)):"number"===typeof i.id?(s[n]={},s[n][i.id]=o):"Properties70"!==n&&(s[n]="PoseNode"===n?[o]:o),"number"===typeof i.id&&(o.id=i.id),""!==i.name&&(o.attrName=i.name),""!==i.type&&(o.attrType=i.type),this.pushStack(o)}parseNodeAttr(e){let t=e[0];""!==e[0]&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));let n="",r="";return e.length>1&&(n=e[1].replace(/^(\w+)::/,""),r=e[2]),{id:t,name:n,type:r}}parseNodeProperty(e,t,n){let r=t[1].replace(/^"/,"").replace(/"$/,"").trim(),o=t[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===r&&","===o&&(o=n.replace(/"/g,"").replace(/,$/,"").trim());const i=this.getCurrentNode(),s=i.name;if("Properties70"!==s){if("C"===r){const e=o.split(",").slice(1),t=parseInt(e[0]),n=parseInt(e[1]);let s=o.split(",").slice(3);s=s.map((function(e){return e.trim().replace(/^"/,"")})),r="connections",o=[t,n],an(o,s),void 0===i[r]&&(i[r]=[])}"Node"===r&&(i.id=o),r in i&&Array.isArray(i[r])?i[r].push(o):"a"!==r?i[r]=o:i.a=o,this.setCurrentProp(i,r),"a"===r&&","!==o.slice(-1)&&(i.a=on(o))}else this.parseNodeSpecialProperty(e,r,o)}parseNodePropertyContinued(e){const t=this.getCurrentNode();t.a+=e,","!==e.slice(-1)&&(t.a=on(t.a))}parseNodeSpecialProperty(e,t,n){const r=n.split('",').map((function(e){return e.trim().replace(/^\"/,"").replace(/\s/,"_")})),o=r[0],i=r[1],s=r[2],a=r[3];let c=r[4];switch(i){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":c=parseFloat(c);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":c=on(c);break}this.getPrevNode()[o]={type:i,type2:s,flag:a,value:c},this.setCurrentProp(this.getPrevNode(),o)}}class Gt{parse(e){const t=new Yt(e);t.skip(23);const n=t.getUint32();if(n<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+n);const r=new Wt;while(!this.endOfContent(t)){const e=this.parseNode(t,n);null!==e&&r.add(e.name,e)}return r}endOfContent(e){return e.size()%16===0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,t){const n={},r=t>=7500?e.getUint64():e.getUint32(),o=t>=7500?e.getUint64():e.getUint32();t>=7500?e.getUint64():e.getUint32();const i=e.getUint8(),s=e.getString(i);if(0===r)return null;const a=[];for(let h=0;h<o;h++)a.push(this.parseProperty(e));const c=a.length>0?a[0]:"",l=a.length>1?a[1]:"",u=a.length>2?a[2]:"";n.singleProperty=1===o&&e.getOffset()===r;while(r>e.getOffset()){const r=this.parseNode(e,t);null!==r&&this.parseSubNode(s,n,r)}return n.propertyList=a,"number"===typeof c&&(n.id=c),""!==l&&(n.attrName=l),""!==u&&(n.attrType=u),""!==s&&(n.name=s),n}parseSubNode(e,t,n){if(!0===n.singleProperty){const e=n.propertyList[0];Array.isArray(e)?(t[n.name]=n,n.a=e):t[n.name]=e}else if("Connections"===e&&"C"===n.name){const e=[];n.propertyList.forEach((function(t,n){0!==n&&e.push(t)})),void 0===t.connections&&(t.connections=[]),t.connections.push(e)}else if("Properties70"===n.name){const e=Object.keys(n);e.forEach((function(e){t[e]=n[e]}))}else if("Properties70"===e&&"P"===n.name){let e=n.propertyList[0],r=n.propertyList[1];const o=n.propertyList[2],i=n.propertyList[3];let s;0===e.indexOf("Lcl ")&&(e=e.replace("Lcl ","Lcl_")),0===r.indexOf("Lcl ")&&(r=r.replace("Lcl ","Lcl_")),s="Color"===r||"ColorRGB"===r||"Vector"===r||"Vector3D"===r||0===r.indexOf("Lcl_")?[n.propertyList[4],n.propertyList[5],n.propertyList[6]]:n.propertyList[4],t[e]={type:r,type2:o,flag:i,value:s}}else void 0===t[n.name]?"number"===typeof n.id?(t[n.name]={},t[n.name][n.id]=n):t[n.name]=n:"PoseNode"===n.name?(Array.isArray(t[n.name])||(t[n.name]=[t[n.name]]),t[n.name].push(n)):void 0===t[n.name][n.id]&&(t[n.name][n.id]=n)}parseProperty(e){const t=e.getString(1);let n;switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return n=e.getUint32(),e.getArrayBuffer(n);case"S":return n=e.getUint32(),e.getString(n);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const o=e.getUint32(),i=e.getUint32(),s=e.getUint32();if(0===i)switch(t){case"b":case"c":return e.getBooleanArray(o);case"d":return e.getFloat64Array(o);case"f":return e.getFloat32Array(o);case"i":return e.getInt32Array(o);case"l":return e.getInt64Array(o)}"undefined"===typeof r&&console.error("THREE.FBXLoader: External library fflate.min.js required.");const a=Ke(new Uint8Array(e.getArrayBuffer(s))),c=new Yt(a.buffer);switch(t){case"b":case"c":return c.getBooleanArray(o);case"d":return c.getFloat64Array(o);case"f":return c.getFloat32Array(o);case"i":return c.getInt32Array(o);case"l":return c.getInt64Array(o)}default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}}class Yt{constructor(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=void 0===t||t}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return 1===(1&this.getUint8())}getBooleanArray(e){const t=[];for(let n=0;n<e;n++)t.push(this.getBoolean());return t}getUint8(){const e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){const e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){const e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getInt32());return t}getUint32(){const e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),2147483648&t?(t=4294967295&~t,e=4294967295&~e,4294967295===e&&(t=t+1&4294967295),e=e+1&4294967295,-(4294967296*t+e)):4294967296*t+e}getInt64Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getInt64());return t}getUint64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),4294967296*t+e}getFloat32(){const e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getFloat32());return t}getFloat64(){const e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getFloat64());return t}getArrayBuffer(e){const t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}getString(e){let t=[];for(let r=0;r<e;r++)t[r]=this.getUint8();const n=t.indexOf(0);return n>=0&&(t=t.slice(0,n)),o["ib"].decodeText(new Uint8Array(t))}}class Wt{add(e,t){this[e]=t}}function Zt(e){const t="Kaydara FBX Binary  \0";return e.byteLength>=t.length&&t===sn(e,0,t.length)}function Kt(e){const t=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let n=0;function r(t){const r=e[t-1];return e=e.slice(n+t),n++,r}for(let o=0;o<t.length;++o){const e=r(1);if(e===t[o])return!1}return!0}function qt(e){const t=/FBXVersion: (\d+)/,n=e.match(t);if(n){const e=parseInt(n[1]);return e}throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function $t(e){return e/46186158e3}const Jt=[];function Qt(e,t,n,r){let o;switch(r.mappingType){case"ByPolygonVertex":o=e;break;case"ByPolygon":o=t;break;case"ByVertice":o=n;break;case"AllSame":o=r.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+r.mappingType)}"IndexToDirect"===r.referenceType&&(o=r.indices[o]);const i=o*r.dataSize,s=i+r.dataSize;return cn(Jt,r.buffer,i,s)}const en=new o["K"],tn=new o["Dc"];function nn(e){const t=new o["ob"],n=new o["ob"],r=new o["ob"],i=new o["ob"],s=new o["ob"],a=new o["ob"],c=new o["ob"],l=new o["ob"],u=new o["ob"],h=new o["ob"],p=new o["ob"],f=new o["ob"],d=e.inheritType?e.inheritType:0;if(e.translation&&t.setPosition(tn.fromArray(e.translation)),e.preRotation){const t=e.preRotation.map(o["mb"].degToRad);t.push(e.eulerOrder),n.makeRotationFromEuler(en.fromArray(t))}if(e.rotation){const t=e.rotation.map(o["mb"].degToRad);t.push(e.eulerOrder),r.makeRotationFromEuler(en.fromArray(t))}if(e.postRotation){const t=e.postRotation.map(o["mb"].degToRad);t.push(e.eulerOrder),i.makeRotationFromEuler(en.fromArray(t)),i.invert()}e.scale&&s.scale(tn.fromArray(e.scale)),e.scalingOffset&&c.setPosition(tn.fromArray(e.scalingOffset)),e.scalingPivot&&a.setPosition(tn.fromArray(e.scalingPivot)),e.rotationOffset&&l.setPosition(tn.fromArray(e.rotationOffset)),e.rotationPivot&&u.setPosition(tn.fromArray(e.rotationPivot)),e.parentMatrixWorld&&(p.copy(e.parentMatrix),h.copy(e.parentMatrixWorld));const m=n.clone().multiply(r).multiply(i),g=new o["ob"];g.extractRotation(h);const v=new o["ob"];v.copyPosition(h);const b=v.clone().invert().multiply(h),y=g.clone().invert().multiply(b),w=s,x=new o["ob"];if(0===d)x.copy(g).multiply(m).multiply(y).multiply(w);else if(1===d)x.copy(g).multiply(y).multiply(m).multiply(w);else{const e=(new o["ob"]).scale((new o["Dc"]).setFromMatrixScale(p)),t=e.clone().invert(),n=y.clone().multiply(t);x.copy(g).multiply(m).multiply(n).multiply(w)}const I=u.clone().invert(),E=a.clone().invert();let T=t.clone().multiply(l).multiply(u).multiply(n).multiply(r).multiply(i).multiply(I).multiply(c).multiply(a).multiply(s).multiply(E);const k=(new o["ob"]).copyPosition(T),A=h.clone().multiply(k);return f.copyPosition(A),T=f.clone().multiply(x),T.premultiply(h.invert()),T}function rn(e){e=e||0;const t=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return 6===e?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),t[0]):t[e]}function on(e){const t=e.split(",").map((function(e){return parseFloat(e)}));return t}function sn(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=e.byteLength),o["ib"].decodeText(new Uint8Array(e,t,n))}function an(e,t){for(let n=0,r=e.length,o=t.length;n<o;n++,r++)e[r]=t[n]}function cn(e,t,n,r){for(let o=n,i=0;o<r;o++,i++)e[i]=t[o];return e}function ln(e,t,n){return e.slice(0,t).concat(n).concat(e.slice(t))}},e642:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("5a89");const o=/^[og]\s*(.+)?/,i=/^mtllib /,s=/^usemtl /,a=/^usemap /,c=new r["Dc"],l=new r["Dc"],u=new r["Dc"],h=new r["Dc"],p=new r["Dc"];function f(){const e={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);const n=this.object&&"function"===typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"===typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(e,t){const n=this._finalize(!1);n&&(n.inherited||n.groupCount<=0)&&this.materials.splice(n.index,1);const r={index:this.materials.length,name:e||"",mtllib:Array.isArray(t)&&t.length>0?t[t.length-1]:"",smooth:void 0!==n?n.smooth:this.smooth,groupStart:void 0!==n?n.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(e){const t={index:"number"===typeof e?e:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return t.clone=this.clone.bind(t),t}};return this.materials.push(r),r},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(e){const t=this.currentMaterial();if(t&&-1===t.groupEnd&&(t.groupEnd=this.geometry.vertices.length/3,t.groupCount=t.groupEnd-t.groupStart,t.inherited=!1),e&&this.materials.length>1)for(let n=this.materials.length-1;n>=0;n--)this.materials[n].groupCount<=0&&this.materials.splice(n,1);return e&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),t}},n&&n.name&&"function"===typeof n.clone){const e=n.clone(0);e.inherited=!0,this.object.materials.push(e)}this.objects.push(this.object)},finalize:function(){this.object&&"function"===typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){const n=parseInt(e,10);return 3*(n>=0?n-1:n+t/3)},parseNormalIndex:function(e,t){const n=parseInt(e,10);return 3*(n>=0?n-1:n+t/3)},parseUVIndex:function(e,t){const n=parseInt(e,10);return 2*(n>=0?n-1:n+t/2)},addVertex:function(e,t,n){const r=this.vertices,o=this.object.geometry.vertices;o.push(r[e+0],r[e+1],r[e+2]),o.push(r[t+0],r[t+1],r[t+2]),o.push(r[n+0],r[n+1],r[n+2])},addVertexPoint:function(e){const t=this.vertices,n=this.object.geometry.vertices;n.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){const t=this.vertices,n=this.object.geometry.vertices;n.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,n){const r=this.normals,o=this.object.geometry.normals;o.push(r[e+0],r[e+1],r[e+2]),o.push(r[t+0],r[t+1],r[t+2]),o.push(r[n+0],r[n+1],r[n+2])},addFaceNormal:function(e,t,n){const r=this.vertices,o=this.object.geometry.normals;c.fromArray(r,e),l.fromArray(r,t),u.fromArray(r,n),p.subVectors(u,l),h.subVectors(c,l),p.cross(h),p.normalize(),o.push(p.x,p.y,p.z),o.push(p.x,p.y,p.z),o.push(p.x,p.y,p.z)},addColor:function(e,t,n){const r=this.colors,o=this.object.geometry.colors;void 0!==r[e]&&o.push(r[e+0],r[e+1],r[e+2]),void 0!==r[t]&&o.push(r[t+0],r[t+1],r[t+2]),void 0!==r[n]&&o.push(r[n+0],r[n+1],r[n+2])},addUV:function(e,t,n){const r=this.uvs,o=this.object.geometry.uvs;o.push(r[e+0],r[e+1]),o.push(r[t+0],r[t+1]),o.push(r[n+0],r[n+1])},addDefaultUV:function(){const e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){const t=this.uvs,n=this.object.geometry.uvs;n.push(t[e+0],t[e+1])},addFace:function(e,t,n,r,o,i,s,a,c){const l=this.vertices.length;let u=this.parseVertexIndex(e,l),h=this.parseVertexIndex(t,l),p=this.parseVertexIndex(n,l);if(this.addVertex(u,h,p),this.addColor(u,h,p),void 0!==s&&""!==s){const e=this.normals.length;u=this.parseNormalIndex(s,e),h=this.parseNormalIndex(a,e),p=this.parseNormalIndex(c,e),this.addNormal(u,h,p)}else this.addFaceNormal(u,h,p);if(void 0!==r&&""!==r){const e=this.uvs.length;u=this.parseUVIndex(r,e),h=this.parseUVIndex(o,e),p=this.parseUVIndex(i,e),this.addUV(u,h,p),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";const t=this.vertices.length;for(let n=0,r=e.length;n<r;n++){const r=this.parseVertexIndex(e[n],t);this.addVertexPoint(r),this.addColor(r)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";const n=this.vertices.length,r=this.uvs.length;for(let o=0,i=e.length;o<i;o++)this.addVertexLine(this.parseVertexIndex(e[o],n));for(let o=0,i=t.length;o<i;o++)this.addUVLine(this.parseUVIndex(t[o],r))}};return e.startObject("",!1),e}class d extends r["hb"]{constructor(e){super(e),this.materials=null}load(e,t,n,o){const i=this,s=new r["N"](this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,(function(n){try{t(i.parse(n))}catch(r){o?o(r):console.error(r),i.manager.itemError(e)}}),n,o)}setMaterials(e){return this.materials=e,this}parse(e){const t=new f;-1!==e.indexOf("\r\n")&&(e=e.replace(/\r\n/g,"\n")),-1!==e.indexOf("\\\n")&&(e=e.replace(/\\\n/g,""));const n=e.split("\n");let c="",l="",u=0,h=[];const p="function"===typeof"".trimLeft;for(let r=0,f=n.length;r<f;r++)if(c=n[r],c=p?c.trimLeft():c.trim(),u=c.length,0!==u&&(l=c.charAt(0),"#"!==l))if("v"===l){const e=c.split(/\s+/);switch(e[0]){case"v":t.vertices.push(parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])),e.length>=7?t.colors.push(parseFloat(e[4]),parseFloat(e[5]),parseFloat(e[6])):t.colors.push(void 0,void 0,void 0);break;case"vn":t.normals.push(parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]));break;case"vt":t.uvs.push(parseFloat(e[1]),parseFloat(e[2]));break}}else if("f"===l){const e=c.substr(1).trim(),n=e.split(/\s+/),r=[];for(let t=0,i=n.length;t<i;t++){const e=n[t];if(e.length>0){const t=e.split("/");r.push(t)}}const o=r[0];for(let i=1,s=r.length-1;i<s;i++){const e=r[i],n=r[i+1];t.addFace(o[0],e[0],n[0],o[1],e[1],n[1],o[2],e[2],n[2])}}else if("l"===l){const e=c.substring(1).trim().split(" ");let n=[];const r=[];if(-1===c.indexOf("/"))n=e;else for(let t=0,o=e.length;t<o;t++){const o=e[t].split("/");""!==o[0]&&n.push(o[0]),""!==o[1]&&r.push(o[1])}t.addLineGeometry(n,r)}else if("p"===l){const e=c.substr(1).trim(),n=e.split(" ");t.addPointGeometry(n)}else if(null!==(h=o.exec(c))){const e=(" "+h[0].substr(1).trim()).substr(1);t.startObject(e)}else if(s.test(c))t.object.startMaterial(c.substring(7).trim(),t.materialLibraries);else if(i.test(c))t.materialLibraries.push(c.substring(7).trim());else if(a.test(c))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if("s"===l){if(h=c.split(" "),h.length>1){const e=h[1].trim().toLowerCase();t.object.smooth="0"!==e&&"off"!==e}else t.object.smooth=!0;const e=t.object.currentMaterial();e&&(e.smooth=t.object.smooth)}else{if("\0"===c)continue;console.warn('THREE.OBJLoader: Unexpected line: "'+c+'"')}t.finalize();const d=new r["S"];d.materialLibraries=[].concat(t.materialLibraries);const m=!(1===t.objects.length&&0===t.objects[0].geometry.vertices.length);if(!0===m)for(let o=0,i=t.objects.length;o<i;o++){const e=t.objects[o],n=e.geometry,i=e.materials,s="Line"===n.type,a="Points"===n.type;let c=!1;if(0===n.vertices.length)continue;const l=new r["n"];l.setAttribute("position",new r["O"](n.vertices,3)),n.normals.length>0&&l.setAttribute("normal",new r["O"](n.normals,3)),n.colors.length>0&&(c=!0,l.setAttribute("color",new r["O"](n.colors,3))),!0===n.hasUVIndices&&l.setAttribute("uv",new r["O"](n.uvs,2));const u=[];for(let o=0,p=i.length;o<p;o++){const e=i[o],n=e.name+"_"+e.smooth+"_"+c;let l=t.materials[n];if(null!==this.materials)if(l=this.materials.create(e.name),!s||!l||l instanceof r["bb"]){if(a&&l&&!(l instanceof r["Ib"])){const e=new r["Ib"]({size:10,sizeAttenuation:!1});r["lb"].prototype.copy.call(e,l),e.color.copy(l.color),e.map=l.map,l=e}}else{const e=new r["bb"];r["lb"].prototype.copy.call(e,l),e.color.copy(l.color),l=e}void 0===l&&(l=s?new r["bb"]:a?new r["Ib"]({size:1,sizeAttenuation:!1}):new r["tb"],l.name=e.name,l.flatShading=!e.smooth,l.vertexColors=c,t.materials[n]=l),u.push(l)}let h;if(u.length>1){for(let e=0,t=i.length;e<t;e++){const t=i[e];l.addGroup(t.groupStart,t.groupCount,e)}h=s?new r["eb"](l,u):a?new r["Hb"](l,u):new r["pb"](l,u)}else h=s?new r["eb"](l,u[0]):a?new r["Hb"](l,u[0]):new r["pb"](l,u[0]);h.name=e.name,d.add(h)}else if(t.vertices.length>0){const e=new r["Ib"]({size:1,sizeAttenuation:!1}),n=new r["n"];n.setAttribute("position",new r["O"](t.vertices,3)),t.colors.length>0&&void 0!==t.colors[0]&&(n.setAttribute("color",new r["O"](t.colors,3)),e.vertexColors=!0);const o=new r["Hb"](n,e);d.add(o)}return d}}}}]);
//# sourceMappingURL=chunk-61d4fdda.ab3ce67c.js.map