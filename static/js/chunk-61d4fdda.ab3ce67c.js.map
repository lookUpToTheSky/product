{"version":3,"sources":["webpack:///./node_modules/three/examples/jsm/loaders/MTLLoader.js","webpack:///./node_modules/three/examples/jsm/controls/OrbitControls.js","webpack:///./node_modules/three/examples/jsm/libs/fflate.module.js","webpack:///./node_modules/three/examples/jsm/curves/NURBSUtils.js","webpack:///./node_modules/three/examples/jsm/curves/NURBSCurve.js","webpack:///./node_modules/three/examples/jsm/loaders/FBXLoader.js","webpack:///./node_modules/three/examples/jsm/loaders/OBJLoader.js"],"names":["MTLLoader","manager","super","url","onLoad","onProgress","onError","scope","this","path","extractUrlBase","loader","setPath","setRequestHeader","requestHeader","setWithCredentials","withCredentials","load","text","parse","e","console","error","itemError","value","materialOptions","lines","split","info","delimiter_pattern","materialsInfo","i","length","line","trim","charAt","pos","indexOf","key","substring","toLowerCase","name","ss","parseFloat","materialCreator","MaterialCreator","resourcePath","setCrossOrigin","crossOrigin","setManager","setMaterials","baseUrl","options","materials","materialsArray","nameLookup","side","undefined","wrap","convert","converted","mn","mat","covmat","prop","save","lprop","normalizeRGB","ignoreZeroRGBs","create","materialName","index","createMaterial_","params","resolveURL","test","setMapForType","mapType","texParams","getTextureParams","map","loadTexture","repeat","copy","scale","offset","wrapS","wrapT","n","color","fromArray","specular","emissive","transparent","shininess","opacity","invertTrProperty","matParams","items","bumpScale","splice","set","join","mapping","getHandler","texture","_changeEvent","type","_startEvent","_endEvent","OrbitControls","object","domElement","warn","document","style","touchAction","enabled","target","minDistance","maxDistance","Infinity","minZoom","maxZoom","minPolarAngle","maxPolarAngle","Math","PI","minAzimuthAngle","maxAzimuthAngle","enableDamping","dampingFactor","enableZoom","zoomSpeed","enableRotate","rotateSpeed","enablePan","panSpeed","screenSpacePanning","keyPanSpeed","autoRotate","autoRotateSpeed","keys","LEFT","UP","RIGHT","BOTTOM","mouseButtons","ROTATE","MIDDLE","DOLLY","PAN","touches","ONE","TWO","DOLLY_PAN","target0","clone","position0","position","zoom0","zoom","_domElementKeyEvents","getPolarAngle","spherical","phi","getAzimuthalAngle","theta","getDistance","distanceTo","listenToKeyEvents","addEventListener","onKeyDown","saveState","reset","updateProjectionMatrix","dispatchEvent","update","state","STATE","NONE","quat","setFromUnitVectors","up","quatInverse","invert","lastPosition","lastQuaternion","twoPI","sub","applyQuaternion","setFromVector3","rotateLeft","getAutoRotationAngle","sphericalDelta","min","max","isFinite","makeSafe","radius","addScaledVector","panOffset","add","setFromSpherical","lookAt","multiplyScalar","zoomChanged","distanceToSquared","EPS","dot","quaternion","dispose","removeEventListener","onContextMenu","onPointerDown","onPointerCancel","onMouseWheel","onPointerMove","onPointerUp","TOUCH_ROTATE","TOUCH_PAN","TOUCH_DOLLY_PAN","TOUCH_DOLLY_ROTATE","rotateStart","rotateEnd","rotateDelta","panStart","panEnd","panDelta","dollyStart","dollyEnd","dollyDelta","pointers","pointerPositions","getZoomScale","pow","angle","rotateUp","panLeft","v","distance","objectMatrix","setFromMatrixColumn","panUp","crossVectors","pan","deltaX","deltaY","element","isPerspectiveCamera","targetDistance","tan","fov","clientHeight","matrix","isOrthographicCamera","right","left","clientWidth","top","bottom","dollyOut","dollyScale","dollyIn","handleMouseDownRotate","event","clientX","clientY","handleMouseDownDolly","handleMouseDownPan","handleMouseMoveRotate","subVectors","x","y","handleMouseMoveDolly","handleMouseMovePan","handleMouseWheel","handleKeyDown","needsUpdate","code","preventDefault","handleTouchStartRotate","pageX","pageY","handleTouchStartPan","handleTouchStartDolly","dx","dy","sqrt","handleTouchStartDollyPan","handleTouchStartDollyRotate","handleTouchMoveRotate","getSecondPointerPosition","handleTouchMovePan","handleTouchMoveDolly","handleTouchMoveDollyPan","handleTouchMoveDollyRotate","setPointerCapture","pointerId","addPointer","pointerType","onTouchStart","onMouseDown","onTouchMove","onMouseMove","removePointer","releasePointerCapture","mouseAction","button","ctrlKey","metaKey","shiftKey","trackPointer","DOLLY_ROTATE","push","pointer","passive","ch2","durl","c","URL","createObjectURL","Blob","cwk","u","Worker","revokeObjectURL","encodeURI","wk","id","msg","transfer","cb","w","onerror","onmessage","data","postMessage","u8","Uint8Array","u16","Uint16Array","u32","Uint32Array","fleb","fdeb","clim","freb","eb","start","b","r","j","_a","fl","revfl","_b","fd","revfd","rev","hMap","cd","mb","s","l","co","le","rvb","sv","r_1","m","flt","fdt","flm","flrm","fdm","fdrm","a","bits","d","p","o","bits16","shft","slc","subarray","inflt","dat","buf","st","sl","noBuf","noSt","cbuf","bl","nbuf","final","f","bt","lm","dm","lbt","dbt","tbts","t","hLit","hcLen","tl","ldt","clt","clb","clbmsk","clm","lt","dt","lms","dms","lpos","sym","dsym","end","wbits","wbits16","hTree","t2","slice","et","sort","i0","i1","i2","maxSym","tr","mbt","ln","lft","cst","i2_1","i2_2","i2_3","lc","cl","cli","cln","cls","clen","cf","wfblk","out","wblk","syms","lf","df","li","bs","dlt","mlb","ddt","mdb","_c","lclt","nlc","_d","lcdt","ndc","lcfreq","_e","lct","mlcb","nlcc","ll","dl","flen","ftlen","dtlen","llm","lcts","it","clct","len","dst","deo","dflt","lvl","plvl","pre","post","lst","ceil","opt","msk_1","prev","head","bs1_1","bs2_1","hsh","lc_1","wi","hv","imod","pimod","rem","ch_1","dif","maxn","maxd","ml","nl","mmd","md","ti","pti","lin","din","crct","k","crc","cr","adler","dopt","level","mem","log","mrg","wcln","fn","fnStr","td","toString","ks","lastIndexOf","replace","st_1","prototype","spInd","ch","cbfs","constructor","buffer","wrkr","fns","init","td_1","bInflt","inflateSync","pbf","gu8","bDflt","deflateSync","gze","gzh","gzhl","wbytes","guze","gzs","gzl","zle","zlh","zule","zlv","size","cbify","opts","err","terminate","consume","astrm","strm","ondata","ev","astrmify","call","b2","b4","b8","filename","mtime","floor","Date","now","charCodeAt","flg","zs","lv","AsyncCmpStrm","Deflate","chunk","AsyncDeflate","deflate","Inflate","bts","AsyncInflate","inflate","Gzip","raw","AsyncGzip","gzip","gzipSync","Gunzip","AsyncGunzip","gunzip","gunzipSync","Zlib","AsyncZlib","zlib","zlibSync","Unzlib","AsyncUnzlib","unzlib","unzlibSync","Decompress","G","I","Z","_this_1","apply","arguments","AsyncDecompress","decompress","decompressSync","fltn","val","Array","isArray","te","TextEncoder","TextDecoder","tds","decode","stream","dutf8","String","fromCharCode","DecodeUTF8","np","EncodeUTF8","strToU8","str","latin1","ar_1","encode","ar","ai","strFromU8","ext","dbf","slzh","zh","z","fnl","es","z64e","sc","su","off","exfl","ex","wzh","ce","extra","col","exl","os","flag","compression","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","attrs","exf","wzf","ZipPassThrough","process","ZipDeflate","AsyncZipDeflate","Zip","file","com","comment","hl","header","chks","pAll","_i","chks_1","chk","ind","uf","nxt","dd","zip","Object","tot","slft","files","term","tAll","cbf","oe","cdl","badd","loc","_loop_1","ms","cbl","zipSync","UnzipPassThrough","UnzipInflate","AsyncUnzipInflate","_","sz","Unzip","onfile","0","toAdd","is","oc","_loop_2","sig","this_1","bf","cmp_1","chks_2","unshift","d_1","sc_1","su_1","fn_1","file_1","ctr","chks_3","originalSize","state_1","register","decoder","unzip","_loop_3","c_1","no","infl","unzipSync","c_2","findSpan","U","low","high","mid","calcBasisFunctions","span","N","saved","rv","temp","calcBSplinePoint","P","C","point","Nj","wNj","calcBasisFunctionDerivatives","zeroArr","ders","ndu","s1","s2","rk","pk","j1","j2","calcBSplineDerivatives","nd","du","CK","nders","Pw","calcKoverI","nom","denom","calcRationalCurveDerivatives","Pders","Aders","wders","divideScalar","calcNURBSDerivatives","degree","knots","controlPoints","startKnot","endKnot","optionalTarget","hpoint","tangent","normalize","fbxTree","connections","sceneGraph","setResponseType","FBXBuffer","isFbxFormatBinary","FBXText","convertArrayBufferToString","isFbxFormatASCII","Error","getFbxVersion","TextParser","textureLoader","parseConnections","images","parseImages","textures","parseTextures","parseMaterials","deformers","parseDeformers","geometryMap","parseScene","connectionMap","Map","rawConnections","Connections","forEach","rawConnection","fromID","toID","relationship","has","parents","children","parentRelationship","ID","get","childRelationship","blobs","Objects","videoNodes","Video","nodeID","videoNode","parseInt","RelativeFilename","Filename","arrayBufferContent","Content","ArrayBuffer","byteLength","base64Content","image","parseImage","pop","content","fileName","extension","array","window","textureMap","textureNodes","Texture","parseTexture","textureNode","attrName","wrapModeU","WrapModeU","wrapModeV","WrapModeV","valueU","valueV","values","Scaling","currentPath","FileName","materialMap","materialNodes","Material","material","parseMaterial","materialNode","ShadingModel","parameters","parseParameters","setValues","BumpFactor","Diffuse","DiffuseColor","DisplacementFactor","displacementScale","Emissive","EmissiveColor","EmissiveFactor","emissiveIntensity","Opacity","ReflectionFactor","reflectivity","Shininess","Specular","SpecularColor","child","bumpMap","getTexture","aoMap","encoding","displacementMap","emissiveMap","normalMap","envMap","specularMap","alphaMap","LayeredTexture","skeletons","morphTargets","DeformerNodes","Deformer","deformerNode","relationships","attrType","skeleton","parseSkeleton","geometryID","morphTarget","rawTargets","parseMorphTargets","deformerNodes","rawBones","boneNode","rawBone","indices","weights","transformLink","TransformLink","Indexes","Weights","bones","rawMorphTargets","morphTargetNode","rawMorphTarget","initialWeight","DeformPercent","fullWeights","FullWeights","geoID","filter","modelMap","parseModels","modelNodes","Model","model","modelNode","setLookAtProperties","parentConnections","connection","parent","bindSkeleton","createAmbientLight","traverse","node","userData","transformData","parentMatrix","parentMatrixWorld","matrixWorld","transform","generateTransform","applyMatrix4","updateWorldMatrix","animations","isGroup","buildSkeleton","createCamera","createLight","createMesh","createCurve","sanitizeNodeName","getTransformData","bone","subBone","cameraAttribute","attr","NodeAttribute","CameraProjectionType","nearClippingPlane","NearPlane","farClippingPlane","FarPlane","width","innerWidth","height","innerHeight","AspectWidth","AspectHeight","aspect","FieldOfView","focalLength","FocalLength","setFocalLength","lightAttribute","LightType","Color","intensity","Intensity","CastLightOnObject","FarAttenuationEnd","EnableFarAttenuation","decay","InnerAngle","degToRad","penumbra","OuterAngle","CastShadows","castShadow","geometry","attributes","vertexColors","FBX_Deformer","normalizeSkinWeights","reduce","geo","linewidth","inheritType","InheritType","eulerOrder","getEulerOrder","RotationOrder","translation","Lcl_Translation","preRotation","PreRotation","rotation","Lcl_Rotation","postRotation","PostRotation","Lcl_Scaling","scalingOffset","ScalingOffset","scalingPivot","ScalingPivot","rotationOffset","RotationOffset","rotationPivot","RotationPivot","lookAtTarget","bindMatrices","parsePoseNodes","geoRelationships","geoConnParent","bind","BindPoseNode","Pose","NbPoseNodes","poseNodes","PoseNode","poseNode","Node","Matrix","GlobalSettings","ambientColor","AmbientColor","g","geoNodes","Geometry","parseGeometry","geoNode","parseMeshGeometry","parseNurbsGeometry","GeometricTranslation","GeometricRotation","GeometricScaling","genGeometry","preTransform","geoInfo","parseGeoNode","buffers","genBuffers","positionAttribute","vertex","setAttribute","colors","weightsIndices","vertexWeights","normal","normalMatrix","getNormalMatrix","normalAttribute","applyNormalMatrix","uvs","uvBuffer","mappingType","prevMaterialIndex","materialIndex","startIndex","currentIndex","addGroup","groups","lastGroup","lastIndex","count","addMorphTargets","vertexPositions","Vertices","vertexIndices","PolygonVertexIndex","LayerElementColor","parseVertexColors","LayerElementMaterial","parseMaterialIndices","LayerElementNormal","parseNormals","LayerElementUV","uv","UV","parseUVs","weightTable","weight","polygonIndex","faceLength","displayedWeightsWarning","facePositionIndexes","faceNormals","faceColors","faceUVs","faceWeights","faceWeightIndices","vertexIndex","polygonVertexIndex","endOfFace","weightIndices","getData","wt","wIndex","Weight","weightIndex","currentWeight","comparedWeight","comparedWeightIndex","comparedWeightArray","tmp","genFace","parentGeo","parentGeoNode","morphTargetsRelative","morphAttributes","rawTarget","morphGeoNode","genMorphGeometry","morphPositionsSparse","morphPositions","Float32Array","morphIndex","morphGeoInfo","morphBuffers","NormalNode","MappingInformationType","referenceType","ReferenceInformationType","Normals","indexBuffer","NormalIndex","NormalsIndex","dataSize","UVNode","UVIndex","ColorNode","Colors","ColorIndex","MaterialNode","materialIndexBuffer","Materials","materialIndices","order","Order","isNaN","KnotVector","pointsValues","Points","Form","curve","points","getPoints","setFromPoints","animationClips","rawClips","parseClips","rawClip","clip","addClip","AnimationCurve","curveNodesMap","parseAnimationCurveNodes","parseAnimationCurves","layersMap","parseAnimationLayers","parseAnimStacks","rawCurveNodes","AnimationCurveNode","rawCurveNode","match","curveNode","curves","rawCurves","animationCurve","times","KeyTime","convertFBXTimeToSeconds","KeyValueFloat","animationCurveID","animationCurveRelationship","rawLayers","AnimationLayer","layerCurveNodes","modelID","rawModel","modelName","initialPosition","initialRotation","initialScale","morph","deformerID","morpherID","morphName","rawStacks","AnimationStack","layer","tracks","rawTracks","concat","generateTracks","decompose","toArray","setFromQuaternion","T","positionTrack","generateVectorTrack","R","rotationTrack","generateRotationTrack","S","scaleTrack","morphTrack","generateMorphTrack","initialValue","getTimesForAllAxes","getKeyframeTrackValues","interpolateRotations","setFromEuler","euler","quaternionValues","premultiply","multiply","morphNum","getObjectByName","morphTargetDictionary","targetIndex","lastValue","currentValue","prevValue","xIndex","yIndex","zIndex","time","xValue","yValue","zValue","valuesSpan","absoluteSpan","abs","numSubIntervals","step","nextValue","initialTime","timeSpan","interval","nextTime","interpolatedTimes","interpolatedValues","inject","nodeStack","currentIndent","currentProp","currentPropName","allNodes","FBXTree","matchComment","matchEmpty","matchBeginning","matchProperty","matchEnd","parseNodeBegin","parseNodeProperty","popStack","parseNodePropertyContinued","property","nodeName","nodeAttrs","parseNodeAttr","currentNode","getCurrentNode","pushStack","contentLine","propName","propValue","parentName","connProps","from","to","rest","elem","append","setCurrentProp","parseNumberArray","parseNodeSpecialProperty","props","innerPropName","innerPropType1","innerPropType2","innerPropFlag","innerPropValue","getPrevNode","reader","skip","version","getUint32","endOfContent","parseNode","getOffset","endOffset","getUint64","numProperties","nameLen","getUint8","getString","propertyList","parseProperty","singleProperty","subNode","parseSubNode","getBoolean","getFloat64","getFloat32","getInt32","getInt64","getArrayBuffer","getInt16","arrayLength","compressedLength","getBooleanArray","getFloat64Array","getFloat32Array","getInt32Array","getInt64Array","reader2","littleEndian","dv","DataView","nullByte","decodeText","CORRECT","cursor","read","result","num","versionRegExp","dataArray","infoObject","tempEuler","tempVec","lTranslationM","lPreRotationM","lRotationM","lPostRotationM","lScalingM","lScalingPivotM","lScalingOffsetM","lRotationOffsetM","lRotationPivotM","lParentGX","lParentLX","lGlobalT","setPosition","makeRotationFromEuler","lLRM","lParentGRM","extractRotation","lParentTM","copyPosition","lParentGRSM","lParentGSM","lLSM","lGlobalRS","lParentLSM","setFromMatrixScale","lParentLSM_inv","lParentGSM_noLocal","lRotationPivotM_inv","lScalingPivotM_inv","lTransform","lLocalTWithAllPivotAndOffsetInfo","lGlobalTranslation","enums","a1","a2","_object_pattern","_material_library_pattern","_material_use_pattern","_map_use_pattern","_vA","_vB","_vC","_ab","_cb","ParserState","objects","vertices","normals","materialLibraries","startObject","fromDeclaration","previousMaterial","currentMaterial","_finalize","hasUVIndices","smooth","startMaterial","libraries","previous","inherited","groupCount","mtllib","groupStart","groupEnd","cloned","lastMultiMaterial","mi","declared","finalize","parseVertexIndex","parseNormalIndex","parseUVIndex","addVertex","src","addVertexPoint","addVertexLine","addNormal","addFaceNormal","cross","addColor","addUV","addDefaultUV","addUVLine","addFace","ua","ub","uc","na","nb","nc","vLen","ia","ib","ic","nLen","uvLen","addPointGeometry","vi","addLineGeometry","uvi","OBJLoader","lineFirstChar","lineLength","trimLeft","lineData","substr","vertexData","faceVertices","jl","vertexParts","v1","v2","v3","lineParts","lineVertices","lineUVs","llen","parts","pointData","exec","container","hasPrimitives","isLine","isPoints","hasVertexColors","buffergeometry","createdMaterials","miLen","sourceMaterial","materialHash","materialPoints","sizeAttenuation","materialLine","flatShading","mesh"],"mappings":"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","file":"static/js/chunk-61d4fdda.ab3ce67c.js","sourcesContent":["import {\n\tColor,\n\tDefaultLoadingManager,\n\tFileLoader,\n\tFrontSide,\n\tLoader,\n\tLoaderUtils,\n\tMeshPhongMaterial,\n\tRepeatWrapping,\n\tTextureLoader,\n\tVector2\n} from 'three';\n\n/**\n * Loads a Wavefront .mtl file specifying materials\n */\n\nclass MTLLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\t/**\n\t * Loads and parses a MTL asset from a URL.\n\t *\n\t * @param {String} url - URL to the MTL file.\n\t * @param {Function} [onLoad] - Callback invoked with the loaded object.\n\t * @param {Function} [onProgress] - Callback for download progress.\n\t * @param {Function} [onError] - Callback for download errors.\n\t *\n\t * @see setPath setResourcePath\n\t *\n\t * @note In order for relative texture references to resolve correctly\n\t * you must call setResourcePath() explicitly prior to load.\n\t */\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst path = ( this.path === '' ) ? LoaderUtils.extractUrlBase( url ) : this.path;\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( this.path );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\t\tloader.load( url, function ( text ) {\n\n\t\t\ttry {\n\n\t\t\t\tonLoad( scope.parse( text, path ) );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tsetMaterialOptions( value ) {\n\n\t\tthis.materialOptions = value;\n\t\treturn this;\n\n\t}\n\n\t/**\n\t * Parses a MTL file.\n\t *\n\t * @param {String} text - Content of MTL file\n\t * @return {MaterialCreator}\n\t *\n\t * @see setPath setResourcePath\n\t *\n\t * @note In order for relative texture references to resolve correctly\n\t * you must call setResourcePath() explicitly prior to parse.\n\t */\n\tparse( text, path ) {\n\n\t\tconst lines = text.split( '\\n' );\n\t\tlet info = {};\n\t\tconst delimiter_pattern = /\\s+/;\n\t\tconst materialsInfo = {};\n\n\t\tfor ( let i = 0; i < lines.length; i ++ ) {\n\n\t\t\tlet line = lines[ i ];\n\t\t\tline = line.trim();\n\n\t\t\tif ( line.length === 0 || line.charAt( 0 ) === '#' ) {\n\n\t\t\t\t// Blank line or comment ignore\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\tconst pos = line.indexOf( ' ' );\n\n\t\t\tlet key = ( pos >= 0 ) ? line.substring( 0, pos ) : line;\n\t\t\tkey = key.toLowerCase();\n\n\t\t\tlet value = ( pos >= 0 ) ? line.substring( pos + 1 ) : '';\n\t\t\tvalue = value.trim();\n\n\t\t\tif ( key === 'newmtl' ) {\n\n\t\t\t\t// New material\n\n\t\t\t\tinfo = { name: value };\n\t\t\t\tmaterialsInfo[ value ] = info;\n\n\t\t\t} else {\n\n\t\t\t\tif ( key === 'ka' || key === 'kd' || key === 'ks' || key === 'ke' ) {\n\n\t\t\t\t\tconst ss = value.split( delimiter_pattern, 3 );\n\t\t\t\t\tinfo[ key ] = [ parseFloat( ss[ 0 ] ), parseFloat( ss[ 1 ] ), parseFloat( ss[ 2 ] ) ];\n\n\t\t\t\t} else {\n\n\t\t\t\t\tinfo[ key ] = value;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst materialCreator = new MaterialCreator( this.resourcePath || path, this.materialOptions );\n\t\tmaterialCreator.setCrossOrigin( this.crossOrigin );\n\t\tmaterialCreator.setManager( this.manager );\n\t\tmaterialCreator.setMaterials( materialsInfo );\n\t\treturn materialCreator;\n\n\t}\n\n}\n\n/**\n * Create a new MTLLoader.MaterialCreator\n * @param baseUrl - Url relative to which textures are loaded\n * @param options - Set of options on how to construct the materials\n *                  side: Which side to apply the material\n *                        FrontSide (default), THREE.BackSide, THREE.DoubleSide\n *                  wrap: What type of wrapping to apply for textures\n *                        RepeatWrapping (default), THREE.ClampToEdgeWrapping, THREE.MirroredRepeatWrapping\n *                  normalizeRGB: RGBs need to be normalized to 0-1 from 0-255\n *                                Default: false, assumed to be already normalized\n *                  ignoreZeroRGBs: Ignore values of RGBs (Ka,Kd,Ks) that are all 0's\n *                                  Default: false\n * @constructor\n */\n\nclass MaterialCreator {\n\n\tconstructor( baseUrl = '', options = {} ) {\n\n\t\tthis.baseUrl = baseUrl;\n\t\tthis.options = options;\n\t\tthis.materialsInfo = {};\n\t\tthis.materials = {};\n\t\tthis.materialsArray = [];\n\t\tthis.nameLookup = {};\n\n\t\tthis.crossOrigin = 'anonymous';\n\n\t\tthis.side = ( this.options.side !== undefined ) ? this.options.side : FrontSide;\n\t\tthis.wrap = ( this.options.wrap !== undefined ) ? this.options.wrap : RepeatWrapping;\n\n\t}\n\n\tsetCrossOrigin( value ) {\n\n\t\tthis.crossOrigin = value;\n\t\treturn this;\n\n\t}\n\n\tsetManager( value ) {\n\n\t\tthis.manager = value;\n\n\t}\n\n\tsetMaterials( materialsInfo ) {\n\n\t\tthis.materialsInfo = this.convert( materialsInfo );\n\t\tthis.materials = {};\n\t\tthis.materialsArray = [];\n\t\tthis.nameLookup = {};\n\n\t}\n\n\tconvert( materialsInfo ) {\n\n\t\tif ( ! this.options ) return materialsInfo;\n\n\t\tconst converted = {};\n\n\t\tfor ( const mn in materialsInfo ) {\n\n\t\t\t// Convert materials info into normalized form based on options\n\n\t\t\tconst mat = materialsInfo[ mn ];\n\n\t\t\tconst covmat = {};\n\n\t\t\tconverted[ mn ] = covmat;\n\n\t\t\tfor ( const prop in mat ) {\n\n\t\t\t\tlet save = true;\n\t\t\t\tlet value = mat[ prop ];\n\t\t\t\tconst lprop = prop.toLowerCase();\n\n\t\t\t\tswitch ( lprop ) {\n\n\t\t\t\t\tcase 'kd':\n\t\t\t\t\tcase 'ka':\n\t\t\t\t\tcase 'ks':\n\n\t\t\t\t\t\t// Diffuse color (color under white light) using RGB values\n\n\t\t\t\t\t\tif ( this.options && this.options.normalizeRGB ) {\n\n\t\t\t\t\t\t\tvalue = [ value[ 0 ] / 255, value[ 1 ] / 255, value[ 2 ] / 255 ];\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( this.options && this.options.ignoreZeroRGBs ) {\n\n\t\t\t\t\t\t\tif ( value[ 0 ] === 0 && value[ 1 ] === 0 && value[ 2 ] === 0 ) {\n\n\t\t\t\t\t\t\t\t// ignore\n\n\t\t\t\t\t\t\t\tsave = false;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tif ( save ) {\n\n\t\t\t\t\tcovmat[ lprop ] = value;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn converted;\n\n\t}\n\n\tpreload() {\n\n\t\tfor ( const mn in this.materialsInfo ) {\n\n\t\t\tthis.create( mn );\n\n\t\t}\n\n\t}\n\n\tgetIndex( materialName ) {\n\n\t\treturn this.nameLookup[ materialName ];\n\n\t}\n\n\tgetAsArray() {\n\n\t\tlet index = 0;\n\n\t\tfor ( const mn in this.materialsInfo ) {\n\n\t\t\tthis.materialsArray[ index ] = this.create( mn );\n\t\t\tthis.nameLookup[ mn ] = index;\n\t\t\tindex ++;\n\n\t\t}\n\n\t\treturn this.materialsArray;\n\n\t}\n\n\tcreate( materialName ) {\n\n\t\tif ( this.materials[ materialName ] === undefined ) {\n\n\t\t\tthis.createMaterial_( materialName );\n\n\t\t}\n\n\t\treturn this.materials[ materialName ];\n\n\t}\n\n\tcreateMaterial_( materialName ) {\n\n\t\t// Create material\n\n\t\tconst scope = this;\n\t\tconst mat = this.materialsInfo[ materialName ];\n\t\tconst params = {\n\n\t\t\tname: materialName,\n\t\t\tside: this.side\n\n\t\t};\n\n\t\tfunction resolveURL( baseUrl, url ) {\n\n\t\t\tif ( typeof url !== 'string' || url === '' )\n\t\t\t\treturn '';\n\n\t\t\t// Absolute URL\n\t\t\tif ( /^https?:\\/\\//i.test( url ) ) return url;\n\n\t\t\treturn baseUrl + url;\n\n\t\t}\n\n\t\tfunction setMapForType( mapType, value ) {\n\n\t\t\tif ( params[ mapType ] ) return; // Keep the first encountered texture\n\n\t\t\tconst texParams = scope.getTextureParams( value, params );\n\t\t\tconst map = scope.loadTexture( resolveURL( scope.baseUrl, texParams.url ) );\n\n\t\t\tmap.repeat.copy( texParams.scale );\n\t\t\tmap.offset.copy( texParams.offset );\n\n\t\t\tmap.wrapS = scope.wrap;\n\t\t\tmap.wrapT = scope.wrap;\n\n\t\t\tparams[ mapType ] = map;\n\n\t\t}\n\n\t\tfor ( const prop in mat ) {\n\n\t\t\tconst value = mat[ prop ];\n\t\t\tlet n;\n\n\t\t\tif ( value === '' ) continue;\n\n\t\t\tswitch ( prop.toLowerCase() ) {\n\n\t\t\t\t// Ns is material specular exponent\n\n\t\t\t\tcase 'kd':\n\n\t\t\t\t\t// Diffuse color (color under white light) using RGB values\n\n\t\t\t\t\tparams.color = new Color().fromArray( value );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'ks':\n\n\t\t\t\t\t// Specular color (color when light is reflected from shiny surface) using RGB values\n\t\t\t\t\tparams.specular = new Color().fromArray( value );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'ke':\n\n\t\t\t\t\t// Emissive using RGB values\n\t\t\t\t\tparams.emissive = new Color().fromArray( value );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'map_kd':\n\n\t\t\t\t\t// Diffuse texture map\n\n\t\t\t\t\tsetMapForType( 'map', value );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'map_ks':\n\n\t\t\t\t\t// Specular map\n\n\t\t\t\t\tsetMapForType( 'specularMap', value );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'map_ke':\n\n\t\t\t\t\t// Emissive map\n\n\t\t\t\t\tsetMapForType( 'emissiveMap', value );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'norm':\n\n\t\t\t\t\tsetMapForType( 'normalMap', value );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'map_bump':\n\t\t\t\tcase 'bump':\n\n\t\t\t\t\t// Bump texture map\n\n\t\t\t\t\tsetMapForType( 'bumpMap', value );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'map_d':\n\n\t\t\t\t\t// Alpha map\n\n\t\t\t\t\tsetMapForType( 'alphaMap', value );\n\t\t\t\t\tparams.transparent = true;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'ns':\n\n\t\t\t\t\t// The specular exponent (defines the focus of the specular highlight)\n\t\t\t\t\t// A high exponent results in a tight, concentrated highlight. Ns values normally range from 0 to 1000.\n\n\t\t\t\t\tparams.shininess = parseFloat( value );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'd':\n\t\t\t\t\tn = parseFloat( value );\n\n\t\t\t\t\tif ( n < 1 ) {\n\n\t\t\t\t\t\tparams.opacity = n;\n\t\t\t\t\t\tparams.transparent = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'tr':\n\t\t\t\t\tn = parseFloat( value );\n\n\t\t\t\t\tif ( this.options && this.options.invertTrProperty ) n = 1 - n;\n\n\t\t\t\t\tif ( n > 0 ) {\n\n\t\t\t\t\t\tparams.opacity = 1 - n;\n\t\t\t\t\t\tparams.transparent = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.materials[ materialName ] = new MeshPhongMaterial( params );\n\t\treturn this.materials[ materialName ];\n\n\t}\n\n\tgetTextureParams( value, matParams ) {\n\n\t\tconst texParams = {\n\n\t\t\tscale: new Vector2( 1, 1 ),\n\t\t\toffset: new Vector2( 0, 0 )\n\n\t\t };\n\n\t\tconst items = value.split( /\\s+/ );\n\t\tlet pos;\n\n\t\tpos = items.indexOf( '-bm' );\n\n\t\tif ( pos >= 0 ) {\n\n\t\t\tmatParams.bumpScale = parseFloat( items[ pos + 1 ] );\n\t\t\titems.splice( pos, 2 );\n\n\t\t}\n\n\t\tpos = items.indexOf( '-s' );\n\n\t\tif ( pos >= 0 ) {\n\n\t\t\ttexParams.scale.set( parseFloat( items[ pos + 1 ] ), parseFloat( items[ pos + 2 ] ) );\n\t\t\titems.splice( pos, 4 ); // we expect 3 parameters here!\n\n\t\t}\n\n\t\tpos = items.indexOf( '-o' );\n\n\t\tif ( pos >= 0 ) {\n\n\t\t\ttexParams.offset.set( parseFloat( items[ pos + 1 ] ), parseFloat( items[ pos + 2 ] ) );\n\t\t\titems.splice( pos, 4 ); // we expect 3 parameters here!\n\n\t\t}\n\n\t\ttexParams.url = items.join( ' ' ).trim();\n\t\treturn texParams;\n\n\t}\n\n\tloadTexture( url, mapping, onLoad, onProgress, onError ) {\n\n\t\tconst manager = ( this.manager !== undefined ) ? this.manager : DefaultLoadingManager;\n\t\tlet loader = manager.getHandler( url );\n\n\t\tif ( loader === null ) {\n\n\t\t\tloader = new TextureLoader( manager );\n\n\t\t}\n\n\t\tif ( loader.setCrossOrigin ) loader.setCrossOrigin( this.crossOrigin );\n\n\t\tconst texture = loader.load( url, onLoad, onProgress, onError );\n\n\t\tif ( mapping !== undefined ) texture.mapping = mapping;\n\n\t\treturn texture;\n\n\t}\n\n}\n\nexport { MTLLoader };\n","import {\n\tEventDispatcher,\n\tMOUSE,\n\tQuaternion,\n\tSpherical,\n\tTOUCH,\n\tVector2,\n\tVector3\n} from 'three';\n\n// This set of controls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n//\n//    Orbit - left mouse / touch: one-finger move\n//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\n//    Pan - right mouse, or left mouse + ctrl/meta/shiftKey, or arrow keys / touch: two-finger move\n\nconst _changeEvent = { type: 'change' };\nconst _startEvent = { type: 'start' };\nconst _endEvent = { type: 'end' };\n\nclass OrbitControls extends EventDispatcher {\n\n\tconstructor( object, domElement ) {\n\n\t\tsuper();\n\n\t\tif ( domElement === undefined ) console.warn( 'THREE.OrbitControls: The second parameter \"domElement\" is now mandatory.' );\n\t\tif ( domElement === document ) console.error( 'THREE.OrbitControls: \"document\" should not be used as the target \"domElement\". Please use \"renderer.domElement\" instead.' );\n\n\t\tthis.object = object;\n\t\tthis.domElement = domElement;\n\t\tthis.domElement.style.touchAction = 'none'; // disable touch scroll\n\n\t\t// Set to false to disable this control\n\t\tthis.enabled = true;\n\n\t\t// \"target\" sets the location of focus, where the object orbits around\n\t\tthis.target = new Vector3();\n\n\t\t// How far you can dolly in and out ( PerspectiveCamera only )\n\t\tthis.minDistance = 0;\n\t\tthis.maxDistance = Infinity;\n\n\t\t// How far you can zoom in and out ( OrthographicCamera only )\n\t\tthis.minZoom = 0;\n\t\tthis.maxZoom = Infinity;\n\n\t\t// How far you can orbit vertically, upper and lower limits.\n\t\t// Range is 0 to Math.PI radians.\n\t\tthis.minPolarAngle = 0; // radians\n\t\tthis.maxPolarAngle = Math.PI; // radians\n\n\t\t// How far you can orbit horizontally, upper and lower limits.\n\t\t// If set, the interval [ min, max ] must be a sub-interval of [ - 2 PI, 2 PI ], with ( max - min < 2 PI )\n\t\tthis.minAzimuthAngle = - Infinity; // radians\n\t\tthis.maxAzimuthAngle = Infinity; // radians\n\n\t\t// Set to true to enable damping (inertia)\n\t\t// If damping is enabled, you must call controls.update() in your animation loop\n\t\tthis.enableDamping = false;\n\t\tthis.dampingFactor = 0.05;\n\n\t\t// This option actually enables dollying in and out; left as \"zoom\" for backwards compatibility.\n\t\t// Set to false to disable zooming\n\t\tthis.enableZoom = true;\n\t\tthis.zoomSpeed = 1.0;\n\n\t\t// Set to false to disable rotating\n\t\tthis.enableRotate = true;\n\t\tthis.rotateSpeed = 1.0;\n\n\t\t// Set to false to disable panning\n\t\tthis.enablePan = true;\n\t\tthis.panSpeed = 1.0;\n\t\tthis.screenSpacePanning = true; // if false, pan orthogonal to world-space direction camera.up\n\t\tthis.keyPanSpeed = 7.0;\t// pixels moved per arrow key push\n\n\t\t// Set to true to automatically rotate around the target\n\t\t// If auto-rotate is enabled, you must call controls.update() in your animation loop\n\t\tthis.autoRotate = false;\n\t\tthis.autoRotateSpeed = 2.0; // 30 seconds per orbit when fps is 60\n\n\t\t// The four arrow keys\n\t\tthis.keys = { LEFT: 'ArrowLeft', UP: 'ArrowUp', RIGHT: 'ArrowRight', BOTTOM: 'ArrowDown' };\n\n\t\t// Mouse buttons\n\t\tthis.mouseButtons = { LEFT: MOUSE.ROTATE, MIDDLE: MOUSE.DOLLY, RIGHT: MOUSE.PAN };\n\n\t\t// Touch fingers\n\t\tthis.touches = { ONE: TOUCH.ROTATE, TWO: TOUCH.DOLLY_PAN };\n\n\t\t// for reset\n\t\tthis.target0 = this.target.clone();\n\t\tthis.position0 = this.object.position.clone();\n\t\tthis.zoom0 = this.object.zoom;\n\n\t\t// the target DOM element for key events\n\t\tthis._domElementKeyEvents = null;\n\n\t\t//\n\t\t// public methods\n\t\t//\n\n\t\tthis.getPolarAngle = function () {\n\n\t\t\treturn spherical.phi;\n\n\t\t};\n\n\t\tthis.getAzimuthalAngle = function () {\n\n\t\t\treturn spherical.theta;\n\n\t\t};\n\n\t\tthis.getDistance = function () {\n\n\t\t\treturn this.object.position.distanceTo( this.target );\n\n\t\t};\n\n\t\tthis.listenToKeyEvents = function ( domElement ) {\n\n\t\t\tdomElement.addEventListener( 'keydown', onKeyDown );\n\t\t\tthis._domElementKeyEvents = domElement;\n\n\t\t};\n\n\t\tthis.saveState = function () {\n\n\t\t\tscope.target0.copy( scope.target );\n\t\t\tscope.position0.copy( scope.object.position );\n\t\t\tscope.zoom0 = scope.object.zoom;\n\n\t\t};\n\n\t\tthis.reset = function () {\n\n\t\t\tscope.target.copy( scope.target0 );\n\t\t\tscope.object.position.copy( scope.position0 );\n\t\t\tscope.object.zoom = scope.zoom0;\n\n\t\t\tscope.object.updateProjectionMatrix();\n\t\t\tscope.dispatchEvent( _changeEvent );\n\n\t\t\tscope.update();\n\n\t\t\tstate = STATE.NONE;\n\n\t\t};\n\n\t\t// this method is exposed, but perhaps it would be better if we can make it private...\n\t\tthis.update = function () {\n\n\t\t\tconst offset = new Vector3();\n\n\t\t\t// so camera.up is the orbit axis\n\t\t\tconst quat = new Quaternion().setFromUnitVectors( object.up, new Vector3( 0, 1, 0 ) );\n\t\t\tconst quatInverse = quat.clone().invert();\n\n\t\t\tconst lastPosition = new Vector3();\n\t\t\tconst lastQuaternion = new Quaternion();\n\n\t\t\tconst twoPI = 2 * Math.PI;\n\n\t\t\treturn function update() {\n\n\t\t\t\tconst position = scope.object.position;\n\n\t\t\t\toffset.copy( position ).sub( scope.target );\n\n\t\t\t\t// rotate offset to \"y-axis-is-up\" space\n\t\t\t\toffset.applyQuaternion( quat );\n\n\t\t\t\t// angle from z-axis around y-axis\n\t\t\t\tspherical.setFromVector3( offset );\n\n\t\t\t\tif ( scope.autoRotate && state === STATE.NONE ) {\n\n\t\t\t\t\trotateLeft( getAutoRotationAngle() );\n\n\t\t\t\t}\n\n\t\t\t\tif ( scope.enableDamping ) {\n\n\t\t\t\t\tspherical.theta += sphericalDelta.theta * scope.dampingFactor;\n\t\t\t\t\tspherical.phi += sphericalDelta.phi * scope.dampingFactor;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tspherical.theta += sphericalDelta.theta;\n\t\t\t\t\tspherical.phi += sphericalDelta.phi;\n\n\t\t\t\t}\n\n\t\t\t\t// restrict theta to be between desired limits\n\n\t\t\t\tlet min = scope.minAzimuthAngle;\n\t\t\t\tlet max = scope.maxAzimuthAngle;\n\n\t\t\t\tif ( isFinite( min ) && isFinite( max ) ) {\n\n\t\t\t\t\tif ( min < - Math.PI ) min += twoPI; else if ( min > Math.PI ) min -= twoPI;\n\n\t\t\t\t\tif ( max < - Math.PI ) max += twoPI; else if ( max > Math.PI ) max -= twoPI;\n\n\t\t\t\t\tif ( min <= max ) {\n\n\t\t\t\t\t\tspherical.theta = Math.max( min, Math.min( max, spherical.theta ) );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tspherical.theta = ( spherical.theta > ( min + max ) / 2 ) ?\n\t\t\t\t\t\t\tMath.max( min, spherical.theta ) :\n\t\t\t\t\t\t\tMath.min( max, spherical.theta );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// restrict phi to be between desired limits\n\t\t\t\tspherical.phi = Math.max( scope.minPolarAngle, Math.min( scope.maxPolarAngle, spherical.phi ) );\n\n\t\t\t\tspherical.makeSafe();\n\n\n\t\t\t\tspherical.radius *= scale;\n\n\t\t\t\t// restrict radius to be between desired limits\n\t\t\t\tspherical.radius = Math.max( scope.minDistance, Math.min( scope.maxDistance, spherical.radius ) );\n\n\t\t\t\t// move target to panned location\n\n\t\t\t\tif ( scope.enableDamping === true ) {\n\n\t\t\t\t\tscope.target.addScaledVector( panOffset, scope.dampingFactor );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tscope.target.add( panOffset );\n\n\t\t\t\t}\n\n\t\t\t\toffset.setFromSpherical( spherical );\n\n\t\t\t\t// rotate offset back to \"camera-up-vector-is-up\" space\n\t\t\t\toffset.applyQuaternion( quatInverse );\n\n\t\t\t\tposition.copy( scope.target ).add( offset );\n\n\t\t\t\tscope.object.lookAt( scope.target );\n\n\t\t\t\tif ( scope.enableDamping === true ) {\n\n\t\t\t\t\tsphericalDelta.theta *= ( 1 - scope.dampingFactor );\n\t\t\t\t\tsphericalDelta.phi *= ( 1 - scope.dampingFactor );\n\n\t\t\t\t\tpanOffset.multiplyScalar( 1 - scope.dampingFactor );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tsphericalDelta.set( 0, 0, 0 );\n\n\t\t\t\t\tpanOffset.set( 0, 0, 0 );\n\n\t\t\t\t}\n\n\t\t\t\tscale = 1;\n\n\t\t\t\t// update condition is:\n\t\t\t\t// min(camera displacement, camera rotation in radians)^2 > EPS\n\t\t\t\t// using small-angle approximation cos(x/2) = 1 - x^2 / 8\n\n\t\t\t\tif ( zoomChanged ||\n\t\t\t\t\tlastPosition.distanceToSquared( scope.object.position ) > EPS ||\n\t\t\t\t\t8 * ( 1 - lastQuaternion.dot( scope.object.quaternion ) ) > EPS ) {\n\n\t\t\t\t\tscope.dispatchEvent( _changeEvent );\n\n\t\t\t\t\tlastPosition.copy( scope.object.position );\n\t\t\t\t\tlastQuaternion.copy( scope.object.quaternion );\n\t\t\t\t\tzoomChanged = false;\n\n\t\t\t\t\treturn true;\n\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\n\t\t\t};\n\n\t\t}();\n\n\t\tthis.dispose = function () {\n\n\t\t\tscope.domElement.removeEventListener( 'contextmenu', onContextMenu );\n\n\t\t\tscope.domElement.removeEventListener( 'pointerdown', onPointerDown );\n\t\t\tscope.domElement.removeEventListener( 'pointercancel', onPointerCancel );\n\t\t\tscope.domElement.removeEventListener( 'wheel', onMouseWheel );\n\n\t\t\tscope.domElement.removeEventListener( 'pointermove', onPointerMove );\n\t\t\tscope.domElement.removeEventListener( 'pointerup', onPointerUp );\n\n\n\t\t\tif ( scope._domElementKeyEvents !== null ) {\n\n\t\t\t\tscope._domElementKeyEvents.removeEventListener( 'keydown', onKeyDown );\n\n\t\t\t}\n\n\t\t\t//scope.dispatchEvent( { type: 'dispose' } ); // should this be added here?\n\n\t\t};\n\n\t\t//\n\t\t// internals\n\t\t//\n\n\t\tconst scope = this;\n\n\t\tconst STATE = {\n\t\t\tNONE: - 1,\n\t\t\tROTATE: 0,\n\t\t\tDOLLY: 1,\n\t\t\tPAN: 2,\n\t\t\tTOUCH_ROTATE: 3,\n\t\t\tTOUCH_PAN: 4,\n\t\t\tTOUCH_DOLLY_PAN: 5,\n\t\t\tTOUCH_DOLLY_ROTATE: 6\n\t\t};\n\n\t\tlet state = STATE.NONE;\n\n\t\tconst EPS = 0.000001;\n\n\t\t// current position in spherical coordinates\n\t\tconst spherical = new Spherical();\n\t\tconst sphericalDelta = new Spherical();\n\n\t\tlet scale = 1;\n\t\tconst panOffset = new Vector3();\n\t\tlet zoomChanged = false;\n\n\t\tconst rotateStart = new Vector2();\n\t\tconst rotateEnd = new Vector2();\n\t\tconst rotateDelta = new Vector2();\n\n\t\tconst panStart = new Vector2();\n\t\tconst panEnd = new Vector2();\n\t\tconst panDelta = new Vector2();\n\n\t\tconst dollyStart = new Vector2();\n\t\tconst dollyEnd = new Vector2();\n\t\tconst dollyDelta = new Vector2();\n\n\t\tconst pointers = [];\n\t\tconst pointerPositions = {};\n\n\t\tfunction getAutoRotationAngle() {\n\n\t\t\treturn 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\n\n\t\t}\n\n\t\tfunction getZoomScale() {\n\n\t\t\treturn Math.pow( 0.95, scope.zoomSpeed );\n\n\t\t}\n\n\t\tfunction rotateLeft( angle ) {\n\n\t\t\tsphericalDelta.theta -= angle;\n\n\t\t}\n\n\t\tfunction rotateUp( angle ) {\n\n\t\t\tsphericalDelta.phi -= angle;\n\n\t\t}\n\n\t\tconst panLeft = function () {\n\n\t\t\tconst v = new Vector3();\n\n\t\t\treturn function panLeft( distance, objectMatrix ) {\n\n\t\t\t\tv.setFromMatrixColumn( objectMatrix, 0 ); // get X column of objectMatrix\n\t\t\t\tv.multiplyScalar( - distance );\n\n\t\t\t\tpanOffset.add( v );\n\n\t\t\t};\n\n\t\t}();\n\n\t\tconst panUp = function () {\n\n\t\t\tconst v = new Vector3();\n\n\t\t\treturn function panUp( distance, objectMatrix ) {\n\n\t\t\t\tif ( scope.screenSpacePanning === true ) {\n\n\t\t\t\t\tv.setFromMatrixColumn( objectMatrix, 1 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tv.setFromMatrixColumn( objectMatrix, 0 );\n\t\t\t\t\tv.crossVectors( scope.object.up, v );\n\n\t\t\t\t}\n\n\t\t\t\tv.multiplyScalar( distance );\n\n\t\t\t\tpanOffset.add( v );\n\n\t\t\t};\n\n\t\t}();\n\n\t\t// deltaX and deltaY are in pixels; right and down are positive\n\t\tconst pan = function () {\n\n\t\t\tconst offset = new Vector3();\n\n\t\t\treturn function pan( deltaX, deltaY ) {\n\n\t\t\t\tconst element = scope.domElement;\n\n\t\t\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\t\t\t// perspective\n\t\t\t\t\tconst position = scope.object.position;\n\t\t\t\t\toffset.copy( position ).sub( scope.target );\n\t\t\t\t\tlet targetDistance = offset.length();\n\n\t\t\t\t\t// half of the fov is center to top of screen\n\t\t\t\t\ttargetDistance *= Math.tan( ( scope.object.fov / 2 ) * Math.PI / 180.0 );\n\n\t\t\t\t\t// we use only clientHeight here so aspect ratio does not distort speed\n\t\t\t\t\tpanLeft( 2 * deltaX * targetDistance / element.clientHeight, scope.object.matrix );\n\t\t\t\t\tpanUp( 2 * deltaY * targetDistance / element.clientHeight, scope.object.matrix );\n\n\t\t\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\t\t\t// orthographic\n\t\t\t\t\tpanLeft( deltaX * ( scope.object.right - scope.object.left ) / scope.object.zoom / element.clientWidth, scope.object.matrix );\n\t\t\t\t\tpanUp( deltaY * ( scope.object.top - scope.object.bottom ) / scope.object.zoom / element.clientHeight, scope.object.matrix );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// camera neither orthographic nor perspective\n\t\t\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.' );\n\t\t\t\t\tscope.enablePan = false;\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t}();\n\n\t\tfunction dollyOut( dollyScale ) {\n\n\t\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\t\tscale /= dollyScale;\n\n\t\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom * dollyScale ) );\n\t\t\t\tscope.object.updateProjectionMatrix();\n\t\t\t\tzoomChanged = true;\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\t\tscope.enableZoom = false;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction dollyIn( dollyScale ) {\n\n\t\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\t\tscale *= dollyScale;\n\n\t\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom / dollyScale ) );\n\t\t\t\tscope.object.updateProjectionMatrix();\n\t\t\t\tzoomChanged = true;\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\t\tscope.enableZoom = false;\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\t\t// event callbacks - update the object state\n\t\t//\n\n\t\tfunction handleMouseDownRotate( event ) {\n\n\t\t\trotateStart.set( event.clientX, event.clientY );\n\n\t\t}\n\n\t\tfunction handleMouseDownDolly( event ) {\n\n\t\t\tdollyStart.set( event.clientX, event.clientY );\n\n\t\t}\n\n\t\tfunction handleMouseDownPan( event ) {\n\n\t\t\tpanStart.set( event.clientX, event.clientY );\n\n\t\t}\n\n\t\tfunction handleMouseMoveRotate( event ) {\n\n\t\t\trotateEnd.set( event.clientX, event.clientY );\n\n\t\t\trotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );\n\n\t\t\tconst element = scope.domElement;\n\n\t\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight ); // yes, height\n\n\t\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );\n\n\t\t\trotateStart.copy( rotateEnd );\n\n\t\t\tscope.update();\n\n\t\t}\n\n\t\tfunction handleMouseMoveDolly( event ) {\n\n\t\t\tdollyEnd.set( event.clientX, event.clientY );\n\n\t\t\tdollyDelta.subVectors( dollyEnd, dollyStart );\n\n\t\t\tif ( dollyDelta.y > 0 ) {\n\n\t\t\t\tdollyOut( getZoomScale() );\n\n\t\t\t} else if ( dollyDelta.y < 0 ) {\n\n\t\t\t\tdollyIn( getZoomScale() );\n\n\t\t\t}\n\n\t\t\tdollyStart.copy( dollyEnd );\n\n\t\t\tscope.update();\n\n\t\t}\n\n\t\tfunction handleMouseMovePan( event ) {\n\n\t\t\tpanEnd.set( event.clientX, event.clientY );\n\n\t\t\tpanDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );\n\n\t\t\tpan( panDelta.x, panDelta.y );\n\n\t\t\tpanStart.copy( panEnd );\n\n\t\t\tscope.update();\n\n\t\t}\n\n\t\tfunction handleMouseWheel( event ) {\n\n\t\t\tif ( event.deltaY < 0 ) {\n\n\t\t\t\tdollyIn( getZoomScale() );\n\n\t\t\t} else if ( event.deltaY > 0 ) {\n\n\t\t\t\tdollyOut( getZoomScale() );\n\n\t\t\t}\n\n\t\t\tscope.update();\n\n\t\t}\n\n\t\tfunction handleKeyDown( event ) {\n\n\t\t\tlet needsUpdate = false;\n\n\t\t\tswitch ( event.code ) {\n\n\t\t\t\tcase scope.keys.UP:\n\t\t\t\t\tpan( 0, scope.keyPanSpeed );\n\t\t\t\t\tneedsUpdate = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase scope.keys.BOTTOM:\n\t\t\t\t\tpan( 0, - scope.keyPanSpeed );\n\t\t\t\t\tneedsUpdate = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase scope.keys.LEFT:\n\t\t\t\t\tpan( scope.keyPanSpeed, 0 );\n\t\t\t\t\tneedsUpdate = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase scope.keys.RIGHT:\n\t\t\t\t\tpan( - scope.keyPanSpeed, 0 );\n\t\t\t\t\tneedsUpdate = true;\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tif ( needsUpdate ) {\n\n\t\t\t\t// prevent the browser from scrolling on cursor keys\n\t\t\t\tevent.preventDefault();\n\n\t\t\t\tscope.update();\n\n\t\t\t}\n\n\n\t\t}\n\n\t\tfunction handleTouchStartRotate() {\n\n\t\t\tif ( pointers.length === 1 ) {\n\n\t\t\t\trotateStart.set( pointers[ 0 ].pageX, pointers[ 0 ].pageY );\n\n\t\t\t} else {\n\n\t\t\t\tconst x = 0.5 * ( pointers[ 0 ].pageX + pointers[ 1 ].pageX );\n\t\t\t\tconst y = 0.5 * ( pointers[ 0 ].pageY + pointers[ 1 ].pageY );\n\n\t\t\t\trotateStart.set( x, y );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction handleTouchStartPan() {\n\n\t\t\tif ( pointers.length === 1 ) {\n\n\t\t\t\tpanStart.set( pointers[ 0 ].pageX, pointers[ 0 ].pageY );\n\n\t\t\t} else {\n\n\t\t\t\tconst x = 0.5 * ( pointers[ 0 ].pageX + pointers[ 1 ].pageX );\n\t\t\t\tconst y = 0.5 * ( pointers[ 0 ].pageY + pointers[ 1 ].pageY );\n\n\t\t\t\tpanStart.set( x, y );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction handleTouchStartDolly() {\n\n\t\t\tconst dx = pointers[ 0 ].pageX - pointers[ 1 ].pageX;\n\t\t\tconst dy = pointers[ 0 ].pageY - pointers[ 1 ].pageY;\n\n\t\t\tconst distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\t\tdollyStart.set( 0, distance );\n\n\t\t}\n\n\t\tfunction handleTouchStartDollyPan() {\n\n\t\t\tif ( scope.enableZoom ) handleTouchStartDolly();\n\n\t\t\tif ( scope.enablePan ) handleTouchStartPan();\n\n\t\t}\n\n\t\tfunction handleTouchStartDollyRotate() {\n\n\t\t\tif ( scope.enableZoom ) handleTouchStartDolly();\n\n\t\t\tif ( scope.enableRotate ) handleTouchStartRotate();\n\n\t\t}\n\n\t\tfunction handleTouchMoveRotate( event ) {\n\n\t\t\tif ( pointers.length == 1 ) {\n\n\t\t\t\trotateEnd.set( event.pageX, event.pageY );\n\n\t\t\t} else {\n\n\t\t\t\tconst position = getSecondPointerPosition( event );\n\n\t\t\t\tconst x = 0.5 * ( event.pageX + position.x );\n\t\t\t\tconst y = 0.5 * ( event.pageY + position.y );\n\n\t\t\t\trotateEnd.set( x, y );\n\n\t\t\t}\n\n\t\t\trotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );\n\n\t\t\tconst element = scope.domElement;\n\n\t\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight ); // yes, height\n\n\t\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );\n\n\t\t\trotateStart.copy( rotateEnd );\n\n\t\t}\n\n\t\tfunction handleTouchMovePan( event ) {\n\n\t\t\tif ( pointers.length === 1 ) {\n\n\t\t\t\tpanEnd.set( event.pageX, event.pageY );\n\n\t\t\t} else {\n\n\t\t\t\tconst position = getSecondPointerPosition( event );\n\n\t\t\t\tconst x = 0.5 * ( event.pageX + position.x );\n\t\t\t\tconst y = 0.5 * ( event.pageY + position.y );\n\n\t\t\t\tpanEnd.set( x, y );\n\n\t\t\t}\n\n\t\t\tpanDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );\n\n\t\t\tpan( panDelta.x, panDelta.y );\n\n\t\t\tpanStart.copy( panEnd );\n\n\t\t}\n\n\t\tfunction handleTouchMoveDolly( event ) {\n\n\t\t\tconst position = getSecondPointerPosition( event );\n\n\t\t\tconst dx = event.pageX - position.x;\n\t\t\tconst dy = event.pageY - position.y;\n\n\t\t\tconst distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\t\tdollyEnd.set( 0, distance );\n\n\t\t\tdollyDelta.set( 0, Math.pow( dollyEnd.y / dollyStart.y, scope.zoomSpeed ) );\n\n\t\t\tdollyOut( dollyDelta.y );\n\n\t\t\tdollyStart.copy( dollyEnd );\n\n\t\t}\n\n\t\tfunction handleTouchMoveDollyPan( event ) {\n\n\t\t\tif ( scope.enableZoom ) handleTouchMoveDolly( event );\n\n\t\t\tif ( scope.enablePan ) handleTouchMovePan( event );\n\n\t\t}\n\n\t\tfunction handleTouchMoveDollyRotate( event ) {\n\n\t\t\tif ( scope.enableZoom ) handleTouchMoveDolly( event );\n\n\t\t\tif ( scope.enableRotate ) handleTouchMoveRotate( event );\n\n\t\t}\n\n\t\t//\n\t\t// event handlers - FSM: listen for events and reset state\n\t\t//\n\n\t\tfunction onPointerDown( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tif ( pointers.length === 0 ) {\n\n\t\t\t\tscope.domElement.setPointerCapture( event.pointerId );\n\n\t\t\t\tscope.domElement.addEventListener( 'pointermove', onPointerMove );\n\t\t\t\tscope.domElement.addEventListener( 'pointerup', onPointerUp );\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\taddPointer( event );\n\n\t\t\tif ( event.pointerType === 'touch' ) {\n\n\t\t\t\tonTouchStart( event );\n\n\t\t\t} else {\n\n\t\t\t\tonMouseDown( event );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onPointerMove( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tif ( event.pointerType === 'touch' ) {\n\n\t\t\t\tonTouchMove( event );\n\n\t\t\t} else {\n\n\t\t\t\tonMouseMove( event );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onPointerUp( event ) {\n\n\t\t    removePointer( event );\n\n\t\t    if ( pointers.length === 0 ) {\n\n\t\t        scope.domElement.releasePointerCapture( event.pointerId );\n\n\t\t        scope.domElement.removeEventListener( 'pointermove', onPointerMove );\n\t\t        scope.domElement.removeEventListener( 'pointerup', onPointerUp );\n\n\t\t    }\n\n\t\t    scope.dispatchEvent( _endEvent );\n\n\t\t    state = STATE.NONE;\n\n\t\t}\n\n\t\tfunction onPointerCancel( event ) {\n\n\t\t\tremovePointer( event );\n\n\t\t}\n\n\t\tfunction onMouseDown( event ) {\n\n\t\t\tlet mouseAction;\n\n\t\t\tswitch ( event.button ) {\n\n\t\t\t\tcase 0:\n\n\t\t\t\t\tmouseAction = scope.mouseButtons.LEFT;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 1:\n\n\t\t\t\t\tmouseAction = scope.mouseButtons.MIDDLE;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 2:\n\n\t\t\t\t\tmouseAction = scope.mouseButtons.RIGHT;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tmouseAction = - 1;\n\n\t\t\t}\n\n\t\t\tswitch ( mouseAction ) {\n\n\t\t\t\tcase MOUSE.DOLLY:\n\n\t\t\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\t\t\thandleMouseDownDolly( event );\n\n\t\t\t\t\tstate = STATE.DOLLY;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MOUSE.ROTATE:\n\n\t\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\t\thandleMouseDownPan( event );\n\n\t\t\t\t\t\tstate = STATE.PAN;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\t\thandleMouseDownRotate( event );\n\n\t\t\t\t\t\tstate = STATE.ROTATE;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MOUSE.PAN:\n\n\t\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\t\thandleMouseDownRotate( event );\n\n\t\t\t\t\t\tstate = STATE.ROTATE;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\t\thandleMouseDownPan( event );\n\n\t\t\t\t\t\tstate = STATE.PAN;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t}\n\n\t\t\tif ( state !== STATE.NONE ) {\n\n\t\t\t\tscope.dispatchEvent( _startEvent );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onMouseMove( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tswitch ( state ) {\n\n\t\t\t\tcase STATE.ROTATE:\n\n\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\thandleMouseMoveRotate( event );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase STATE.DOLLY:\n\n\t\t\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\t\t\thandleMouseMoveDolly( event );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase STATE.PAN:\n\n\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\thandleMouseMovePan( event );\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onMouseWheel( event ) {\n\n\t\t\tif ( scope.enabled === false || scope.enableZoom === false || state !== STATE.NONE ) return;\n\n\t\t\tevent.preventDefault();\n\n\t\t\tscope.dispatchEvent( _startEvent );\n\n\t\t\thandleMouseWheel( event );\n\n\t\t\tscope.dispatchEvent( _endEvent );\n\n\t\t}\n\n\t\tfunction onKeyDown( event ) {\n\n\t\t\tif ( scope.enabled === false || scope.enablePan === false ) return;\n\n\t\t\thandleKeyDown( event );\n\n\t\t}\n\n\t\tfunction onTouchStart( event ) {\n\n\t\t\ttrackPointer( event );\n\n\t\t\tswitch ( pointers.length ) {\n\n\t\t\t\tcase 1:\n\n\t\t\t\t\tswitch ( scope.touches.ONE ) {\n\n\t\t\t\t\t\tcase TOUCH.ROTATE:\n\n\t\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\t\t\thandleTouchStartRotate();\n\n\t\t\t\t\t\t\tstate = STATE.TOUCH_ROTATE;\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase TOUCH.PAN:\n\n\t\t\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\t\t\thandleTouchStartPan();\n\n\t\t\t\t\t\t\tstate = STATE.TOUCH_PAN;\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\n\t\t\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 2:\n\n\t\t\t\t\tswitch ( scope.touches.TWO ) {\n\n\t\t\t\t\t\tcase TOUCH.DOLLY_PAN:\n\n\t\t\t\t\t\t\tif ( scope.enableZoom === false && scope.enablePan === false ) return;\n\n\t\t\t\t\t\t\thandleTouchStartDollyPan();\n\n\t\t\t\t\t\t\tstate = STATE.TOUCH_DOLLY_PAN;\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase TOUCH.DOLLY_ROTATE:\n\n\t\t\t\t\t\t\tif ( scope.enableZoom === false && scope.enableRotate === false ) return;\n\n\t\t\t\t\t\t\thandleTouchStartDollyRotate();\n\n\t\t\t\t\t\t\tstate = STATE.TOUCH_DOLLY_ROTATE;\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\n\t\t\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t}\n\n\t\t\tif ( state !== STATE.NONE ) {\n\n\t\t\t\tscope.dispatchEvent( _startEvent );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onTouchMove( event ) {\n\n\t\t\ttrackPointer( event );\n\n\t\t\tswitch ( state ) {\n\n\t\t\t\tcase STATE.TOUCH_ROTATE:\n\n\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\thandleTouchMoveRotate( event );\n\n\t\t\t\t\tscope.update();\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase STATE.TOUCH_PAN:\n\n\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\thandleTouchMovePan( event );\n\n\t\t\t\t\tscope.update();\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase STATE.TOUCH_DOLLY_PAN:\n\n\t\t\t\t\tif ( scope.enableZoom === false && scope.enablePan === false ) return;\n\n\t\t\t\t\thandleTouchMoveDollyPan( event );\n\n\t\t\t\t\tscope.update();\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase STATE.TOUCH_DOLLY_ROTATE:\n\n\t\t\t\t\tif ( scope.enableZoom === false && scope.enableRotate === false ) return;\n\n\t\t\t\t\thandleTouchMoveDollyRotate( event );\n\n\t\t\t\t\tscope.update();\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onContextMenu( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tevent.preventDefault();\n\n\t\t}\n\n\t\tfunction addPointer( event ) {\n\n\t\t\tpointers.push( event );\n\n\t\t}\n\n\t\tfunction removePointer( event ) {\n\n\t\t\tdelete pointerPositions[ event.pointerId ];\n\n\t\t\tfor ( let i = 0; i < pointers.length; i ++ ) {\n\n\t\t\t\tif ( pointers[ i ].pointerId == event.pointerId ) {\n\n\t\t\t\t\tpointers.splice( i, 1 );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction trackPointer( event ) {\n\n\t\t\tlet position = pointerPositions[ event.pointerId ];\n\n\t\t\tif ( position === undefined ) {\n\n\t\t\t\tposition = new Vector2();\n\t\t\t\tpointerPositions[ event.pointerId ] = position;\n\n\t\t\t}\n\n\t\t\tposition.set( event.pageX, event.pageY );\n\n\t\t}\n\n\t\tfunction getSecondPointerPosition( event ) {\n\n\t\t\tconst pointer = ( event.pointerId === pointers[ 0 ].pointerId ) ? pointers[ 1 ] : pointers[ 0 ];\n\n\t\t\treturn pointerPositions[ pointer.pointerId ];\n\n\t\t}\n\n\t\t//\n\n\t\tscope.domElement.addEventListener( 'contextmenu', onContextMenu );\n\n\t\tscope.domElement.addEventListener( 'pointerdown', onPointerDown );\n\t\tscope.domElement.addEventListener( 'pointercancel', onPointerCancel );\n\t\tscope.domElement.addEventListener( 'wheel', onMouseWheel, { passive: false } );\n\n\t\t// force an update at start\n\n\t\tthis.update();\n\n\t}\n\n}\n\n\n// This set of controls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n// This is very similar to OrbitControls, another set of touch behavior\n//\n//    Orbit - right mouse, or left mouse + ctrl/meta/shiftKey / touch: two-finger rotate\n//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\n//    Pan - left mouse, or arrow keys / touch: one-finger move\n\nclass MapControls extends OrbitControls {\n\n\tconstructor( object, domElement ) {\n\n\t\tsuper( object, domElement );\n\n\t\tthis.screenSpacePanning = false; // pan orthogonal to world-space direction camera.up\n\n\t\tthis.mouseButtons.LEFT = MOUSE.PAN;\n\t\tthis.mouseButtons.RIGHT = MOUSE.ROTATE;\n\n\t\tthis.touches.ONE = TOUCH.PAN;\n\t\tthis.touches.TWO = TOUCH.DOLLY_ROTATE;\n\n\t}\n\n}\n\nexport { OrbitControls, MapControls };\n","/*!\nfflate - fast JavaScript compression/decompression\n<https://101arrowz.github.io/fflate>\nLicensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE\nversion 0.6.9\n*/\n\n// DEFLATE is a complex format; to read this code, you should probably check the RFC first:\n// https://tools.ietf.org/html/rfc1951\n// You may also wish to take a look at the guide I made about this program:\n// https://gist.github.com/101arrowz/253f31eb5abc3d9275ab943003ffecad\n// Some of the following code is similar to that of UZIP.js:\n// https://github.com/photopea/UZIP.js\n// However, the vast majority of the codebase has diverged from UZIP.js to increase performance and reduce bundle size.\n// Sometimes 0 will appear where -1 would be more appropriate. This is because using a uint\n// is better for memory in most engines (I *think*).\nvar ch2 = {};\nvar durl = function (c) { return URL.createObjectURL(new Blob([c], { type: 'text/javascript' })); };\nvar cwk = function (u) { return new Worker(u); };\ntry {\n    URL.revokeObjectURL(durl(''));\n}\ncatch (e) {\n    // We're in Deno or a very old browser\n    durl = function (c) { return 'data:application/javascript;charset=UTF-8,' + encodeURI(c); };\n    // If Deno, this is necessary; if not, this changes nothing\n    cwk = function (u) { return new Worker(u, { type: 'module' }); };\n}\nvar wk = (function (c, id, msg, transfer, cb) {\n    var w = cwk(ch2[id] || (ch2[id] = durl(c)));\n    w.onerror = function (e) { return cb(e.error, null); };\n    w.onmessage = function (e) { return cb(null, e.data); };\n    w.postMessage(msg, transfer);\n    return w;\n});\n\n// aliases for shorter compressed code (most minifers don't do this)\nvar u8 = Uint8Array, u16 = Uint16Array, u32 = Uint32Array;\n// fixed length extra bits\nvar fleb = new u8([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, /* unused */ 0, 0, /* impossible */ 0]);\n// fixed distance extra bits\n// see fleb note\nvar fdeb = new u8([0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, /* unused */ 0, 0]);\n// code length index map\nvar clim = new u8([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);\n// get base, reverse index map from extra bits\nvar freb = function (eb, start) {\n    var b = new u16(31);\n    for (var i = 0; i < 31; ++i) {\n        b[i] = start += 1 << eb[i - 1];\n    }\n    // numbers here are at max 18 bits\n    var r = new u32(b[30]);\n    for (var i = 1; i < 30; ++i) {\n        for (var j = b[i]; j < b[i + 1]; ++j) {\n            r[j] = ((j - b[i]) << 5) | i;\n        }\n    }\n    return [b, r];\n};\nvar _a = freb(fleb, 2), fl = _a[0], revfl = _a[1];\n// we can ignore the fact that the other numbers are wrong; they never happen anyway\nfl[28] = 258, revfl[258] = 28;\nvar _b = freb(fdeb, 0), fd = _b[0], revfd = _b[1];\n// map of value to reverse (assuming 16 bits)\nvar rev = new u16(32768);\nfor (var i = 0; i < 32768; ++i) {\n    // reverse table algorithm from SO\n    var x = ((i & 0xAAAA) >>> 1) | ((i & 0x5555) << 1);\n    x = ((x & 0xCCCC) >>> 2) | ((x & 0x3333) << 2);\n    x = ((x & 0xF0F0) >>> 4) | ((x & 0x0F0F) << 4);\n    rev[i] = (((x & 0xFF00) >>> 8) | ((x & 0x00FF) << 8)) >>> 1;\n}\n// create huffman tree from u8 \"map\": index -> code length for code index\n// mb (max bits) must be at most 15\n// TODO: optimize/split up?\nvar hMap = (function (cd, mb, r) {\n    var s = cd.length;\n    // index\n    var i = 0;\n    // u16 \"map\": index -> # of codes with bit length = index\n    var l = new u16(mb);\n    // length of cd must be 288 (total # of codes)\n    for (; i < s; ++i)\n        ++l[cd[i] - 1];\n    // u16 \"map\": index -> minimum code for bit length = index\n    var le = new u16(mb);\n    for (i = 0; i < mb; ++i) {\n        le[i] = (le[i - 1] + l[i - 1]) << 1;\n    }\n    var co;\n    if (r) {\n        // u16 \"map\": index -> number of actual bits, symbol for code\n        co = new u16(1 << mb);\n        // bits to remove for reverser\n        var rvb = 15 - mb;\n        for (i = 0; i < s; ++i) {\n            // ignore 0 lengths\n            if (cd[i]) {\n                // num encoding both symbol and bits read\n                var sv = (i << 4) | cd[i];\n                // free bits\n                var r_1 = mb - cd[i];\n                // start value\n                var v = le[cd[i] - 1]++ << r_1;\n                // m is end value\n                for (var m = v | ((1 << r_1) - 1); v <= m; ++v) {\n                    // every 16 bit value starting with the code yields the same result\n                    co[rev[v] >>> rvb] = sv;\n                }\n            }\n        }\n    }\n    else {\n        co = new u16(s);\n        for (i = 0; i < s; ++i) {\n            if (cd[i]) {\n                co[i] = rev[le[cd[i] - 1]++] >>> (15 - cd[i]);\n            }\n        }\n    }\n    return co;\n});\n// fixed length tree\nvar flt = new u8(288);\nfor (var i = 0; i < 144; ++i)\n    flt[i] = 8;\nfor (var i = 144; i < 256; ++i)\n    flt[i] = 9;\nfor (var i = 256; i < 280; ++i)\n    flt[i] = 7;\nfor (var i = 280; i < 288; ++i)\n    flt[i] = 8;\n// fixed distance tree\nvar fdt = new u8(32);\nfor (var i = 0; i < 32; ++i)\n    fdt[i] = 5;\n// fixed length map\nvar flm = /*#__PURE__*/ hMap(flt, 9, 0), flrm = /*#__PURE__*/ hMap(flt, 9, 1);\n// fixed distance map\nvar fdm = /*#__PURE__*/ hMap(fdt, 5, 0), fdrm = /*#__PURE__*/ hMap(fdt, 5, 1);\n// find max of array\nvar max = function (a) {\n    var m = a[0];\n    for (var i = 1; i < a.length; ++i) {\n        if (a[i] > m)\n            m = a[i];\n    }\n    return m;\n};\n// read d, starting at bit p and mask with m\nvar bits = function (d, p, m) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8)) >> (p & 7)) & m;\n};\n// read d, starting at bit p continuing for at least 16 bits\nvar bits16 = function (d, p) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8) | (d[o + 2] << 16)) >> (p & 7));\n};\n// get end of byte\nvar shft = function (p) { return ((p / 8) | 0) + (p & 7 && 1); };\n// typed array slice - allows garbage collector to free original reference,\n// while being more compatible than .slice\nvar slc = function (v, s, e) {\n    if (s == null || s < 0)\n        s = 0;\n    if (e == null || e > v.length)\n        e = v.length;\n    // can't use .constructor in case user-supplied\n    var n = new (v instanceof u16 ? u16 : v instanceof u32 ? u32 : u8)(e - s);\n    n.set(v.subarray(s, e));\n    return n;\n};\n// expands raw DEFLATE data\nvar inflt = function (dat, buf, st) {\n    // source length\n    var sl = dat.length;\n    if (!sl || (st && !st.l && sl < 5))\n        return buf || new u8(0);\n    // have to estimate size\n    var noBuf = !buf || st;\n    // no state\n    var noSt = !st || st.i;\n    if (!st)\n        st = {};\n    // Assumes roughly 33% compression ratio average\n    if (!buf)\n        buf = new u8(sl * 3);\n    // ensure buffer can fit at least l elements\n    var cbuf = function (l) {\n        var bl = buf.length;\n        // need to increase size to fit\n        if (l > bl) {\n            // Double or set to necessary, whichever is greater\n            var nbuf = new u8(Math.max(bl * 2, l));\n            nbuf.set(buf);\n            buf = nbuf;\n        }\n    };\n    //  last chunk         bitpos           bytes\n    var final = st.f || 0, pos = st.p || 0, bt = st.b || 0, lm = st.l, dm = st.d, lbt = st.m, dbt = st.n;\n    // total bits\n    var tbts = sl * 8;\n    do {\n        if (!lm) {\n            // BFINAL - this is only 1 when last chunk is next\n            st.f = final = bits(dat, pos, 1);\n            // type: 0 = no compression, 1 = fixed huffman, 2 = dynamic huffman\n            var type = bits(dat, pos + 1, 3);\n            pos += 3;\n            if (!type) {\n                // go to end of byte boundary\n                var s = shft(pos) + 4, l = dat[s - 4] | (dat[s - 3] << 8), t = s + l;\n                if (t > sl) {\n                    if (noSt)\n                        throw 'unexpected EOF';\n                    break;\n                }\n                // ensure size\n                if (noBuf)\n                    cbuf(bt + l);\n                // Copy over uncompressed data\n                buf.set(dat.subarray(s, t), bt);\n                // Get new bitpos, update byte count\n                st.b = bt += l, st.p = pos = t * 8;\n                continue;\n            }\n            else if (type == 1)\n                lm = flrm, dm = fdrm, lbt = 9, dbt = 5;\n            else if (type == 2) {\n                //  literal                            lengths\n                var hLit = bits(dat, pos, 31) + 257, hcLen = bits(dat, pos + 10, 15) + 4;\n                var tl = hLit + bits(dat, pos + 5, 31) + 1;\n                pos += 14;\n                // length+distance tree\n                var ldt = new u8(tl);\n                // code length tree\n                var clt = new u8(19);\n                for (var i = 0; i < hcLen; ++i) {\n                    // use index map to get real code\n                    clt[clim[i]] = bits(dat, pos + i * 3, 7);\n                }\n                pos += hcLen * 3;\n                // code lengths bits\n                var clb = max(clt), clbmsk = (1 << clb) - 1;\n                // code lengths map\n                var clm = hMap(clt, clb, 1);\n                for (var i = 0; i < tl;) {\n                    var r = clm[bits(dat, pos, clbmsk)];\n                    // bits read\n                    pos += r & 15;\n                    // symbol\n                    var s = r >>> 4;\n                    // code length to copy\n                    if (s < 16) {\n                        ldt[i++] = s;\n                    }\n                    else {\n                        //  copy   count\n                        var c = 0, n = 0;\n                        if (s == 16)\n                            n = 3 + bits(dat, pos, 3), pos += 2, c = ldt[i - 1];\n                        else if (s == 17)\n                            n = 3 + bits(dat, pos, 7), pos += 3;\n                        else if (s == 18)\n                            n = 11 + bits(dat, pos, 127), pos += 7;\n                        while (n--)\n                            ldt[i++] = c;\n                    }\n                }\n                //    length tree                 distance tree\n                var lt = ldt.subarray(0, hLit), dt = ldt.subarray(hLit);\n                // max length bits\n                lbt = max(lt);\n                // max dist bits\n                dbt = max(dt);\n                lm = hMap(lt, lbt, 1);\n                dm = hMap(dt, dbt, 1);\n            }\n            else\n                throw 'invalid block type';\n            if (pos > tbts) {\n                if (noSt)\n                    throw 'unexpected EOF';\n                break;\n            }\n        }\n        // Make sure the buffer can hold this + the largest possible addition\n        // Maximum chunk size (practically, theoretically infinite) is 2^17;\n        if (noBuf)\n            cbuf(bt + 131072);\n        var lms = (1 << lbt) - 1, dms = (1 << dbt) - 1;\n        var lpos = pos;\n        for (;; lpos = pos) {\n            // bits read, code\n            var c = lm[bits16(dat, pos) & lms], sym = c >>> 4;\n            pos += c & 15;\n            if (pos > tbts) {\n                if (noSt)\n                    throw 'unexpected EOF';\n                break;\n            }\n            if (!c)\n                throw 'invalid length/literal';\n            if (sym < 256)\n                buf[bt++] = sym;\n            else if (sym == 256) {\n                lpos = pos, lm = null;\n                break;\n            }\n            else {\n                var add = sym - 254;\n                // no extra bits needed if less\n                if (sym > 264) {\n                    // index\n                    var i = sym - 257, b = fleb[i];\n                    add = bits(dat, pos, (1 << b) - 1) + fl[i];\n                    pos += b;\n                }\n                // dist\n                var d = dm[bits16(dat, pos) & dms], dsym = d >>> 4;\n                if (!d)\n                    throw 'invalid distance';\n                pos += d & 15;\n                var dt = fd[dsym];\n                if (dsym > 3) {\n                    var b = fdeb[dsym];\n                    dt += bits16(dat, pos) & ((1 << b) - 1), pos += b;\n                }\n                if (pos > tbts) {\n                    if (noSt)\n                        throw 'unexpected EOF';\n                    break;\n                }\n                if (noBuf)\n                    cbuf(bt + 131072);\n                var end = bt + add;\n                for (; bt < end; bt += 4) {\n                    buf[bt] = buf[bt - dt];\n                    buf[bt + 1] = buf[bt + 1 - dt];\n                    buf[bt + 2] = buf[bt + 2 - dt];\n                    buf[bt + 3] = buf[bt + 3 - dt];\n                }\n                bt = end;\n            }\n        }\n        st.l = lm, st.p = lpos, st.b = bt;\n        if (lm)\n            final = 1, st.m = lbt, st.d = dm, st.n = dbt;\n    } while (!final);\n    return bt == buf.length ? buf : slc(buf, 0, bt);\n};\n// starting at p, write the minimum number of bits that can hold v to d\nvar wbits = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >>> 8;\n};\n// starting at p, write the minimum number of bits (>8) that can hold v to d\nvar wbits16 = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >>> 8;\n    d[o + 2] |= v >>> 16;\n};\n// creates code lengths from a frequency table\nvar hTree = function (d, mb) {\n    // Need extra info to make a tree\n    var t = [];\n    for (var i = 0; i < d.length; ++i) {\n        if (d[i])\n            t.push({ s: i, f: d[i] });\n    }\n    var s = t.length;\n    var t2 = t.slice();\n    if (!s)\n        return [et, 0];\n    if (s == 1) {\n        var v = new u8(t[0].s + 1);\n        v[t[0].s] = 1;\n        return [v, 1];\n    }\n    t.sort(function (a, b) { return a.f - b.f; });\n    // after i2 reaches last ind, will be stopped\n    // freq must be greater than largest possible number of symbols\n    t.push({ s: -1, f: 25001 });\n    var l = t[0], r = t[1], i0 = 0, i1 = 1, i2 = 2;\n    t[0] = { s: -1, f: l.f + r.f, l: l, r: r };\n    // efficient algorithm from UZIP.js\n    // i0 is lookbehind, i2 is lookahead - after processing two low-freq\n    // symbols that combined have high freq, will start processing i2 (high-freq,\n    // non-composite) symbols instead\n    // see https://reddit.com/r/photopea/comments/ikekht/uzipjs_questions/\n    while (i1 != s - 1) {\n        l = t[t[i0].f < t[i2].f ? i0++ : i2++];\n        r = t[i0 != i1 && t[i0].f < t[i2].f ? i0++ : i2++];\n        t[i1++] = { s: -1, f: l.f + r.f, l: l, r: r };\n    }\n    var maxSym = t2[0].s;\n    for (var i = 1; i < s; ++i) {\n        if (t2[i].s > maxSym)\n            maxSym = t2[i].s;\n    }\n    // code lengths\n    var tr = new u16(maxSym + 1);\n    // max bits in tree\n    var mbt = ln(t[i1 - 1], tr, 0);\n    if (mbt > mb) {\n        // more algorithms from UZIP.js\n        // TODO: find out how this code works (debt)\n        //  ind    debt\n        var i = 0, dt = 0;\n        //    left            cost\n        var lft = mbt - mb, cst = 1 << lft;\n        t2.sort(function (a, b) { return tr[b.s] - tr[a.s] || a.f - b.f; });\n        for (; i < s; ++i) {\n            var i2_1 = t2[i].s;\n            if (tr[i2_1] > mb) {\n                dt += cst - (1 << (mbt - tr[i2_1]));\n                tr[i2_1] = mb;\n            }\n            else\n                break;\n        }\n        dt >>>= lft;\n        while (dt > 0) {\n            var i2_2 = t2[i].s;\n            if (tr[i2_2] < mb)\n                dt -= 1 << (mb - tr[i2_2]++ - 1);\n            else\n                ++i;\n        }\n        for (; i >= 0 && dt; --i) {\n            var i2_3 = t2[i].s;\n            if (tr[i2_3] == mb) {\n                --tr[i2_3];\n                ++dt;\n            }\n        }\n        mbt = mb;\n    }\n    return [new u8(tr), mbt];\n};\n// get the max length and assign length codes\nvar ln = function (n, l, d) {\n    return n.s == -1\n        ? Math.max(ln(n.l, l, d + 1), ln(n.r, l, d + 1))\n        : (l[n.s] = d);\n};\n// length codes generation\nvar lc = function (c) {\n    var s = c.length;\n    // Note that the semicolon was intentional\n    while (s && !c[--s])\n        ;\n    var cl = new u16(++s);\n    //  ind      num         streak\n    var cli = 0, cln = c[0], cls = 1;\n    var w = function (v) { cl[cli++] = v; };\n    for (var i = 1; i <= s; ++i) {\n        if (c[i] == cln && i != s)\n            ++cls;\n        else {\n            if (!cln && cls > 2) {\n                for (; cls > 138; cls -= 138)\n                    w(32754);\n                if (cls > 2) {\n                    w(cls > 10 ? ((cls - 11) << 5) | 28690 : ((cls - 3) << 5) | 12305);\n                    cls = 0;\n                }\n            }\n            else if (cls > 3) {\n                w(cln), --cls;\n                for (; cls > 6; cls -= 6)\n                    w(8304);\n                if (cls > 2)\n                    w(((cls - 3) << 5) | 8208), cls = 0;\n            }\n            while (cls--)\n                w(cln);\n            cls = 1;\n            cln = c[i];\n        }\n    }\n    return [cl.subarray(0, cli), s];\n};\n// calculate the length of output from tree, code lengths\nvar clen = function (cf, cl) {\n    var l = 0;\n    for (var i = 0; i < cl.length; ++i)\n        l += cf[i] * cl[i];\n    return l;\n};\n// writes a fixed block\n// returns the new bit pos\nvar wfblk = function (out, pos, dat) {\n    // no need to write 00 as type: TypedArray defaults to 0\n    var s = dat.length;\n    var o = shft(pos + 2);\n    out[o] = s & 255;\n    out[o + 1] = s >>> 8;\n    out[o + 2] = out[o] ^ 255;\n    out[o + 3] = out[o + 1] ^ 255;\n    for (var i = 0; i < s; ++i)\n        out[o + i + 4] = dat[i];\n    return (o + 4 + s) * 8;\n};\n// writes a block\nvar wblk = function (dat, out, final, syms, lf, df, eb, li, bs, bl, p) {\n    wbits(out, p++, final);\n    ++lf[256];\n    var _a = hTree(lf, 15), dlt = _a[0], mlb = _a[1];\n    var _b = hTree(df, 15), ddt = _b[0], mdb = _b[1];\n    var _c = lc(dlt), lclt = _c[0], nlc = _c[1];\n    var _d = lc(ddt), lcdt = _d[0], ndc = _d[1];\n    var lcfreq = new u16(19);\n    for (var i = 0; i < lclt.length; ++i)\n        lcfreq[lclt[i] & 31]++;\n    for (var i = 0; i < lcdt.length; ++i)\n        lcfreq[lcdt[i] & 31]++;\n    var _e = hTree(lcfreq, 7), lct = _e[0], mlcb = _e[1];\n    var nlcc = 19;\n    for (; nlcc > 4 && !lct[clim[nlcc - 1]]; --nlcc)\n        ;\n    var flen = (bl + 5) << 3;\n    var ftlen = clen(lf, flt) + clen(df, fdt) + eb;\n    var dtlen = clen(lf, dlt) + clen(df, ddt) + eb + 14 + 3 * nlcc + clen(lcfreq, lct) + (2 * lcfreq[16] + 3 * lcfreq[17] + 7 * lcfreq[18]);\n    if (flen <= ftlen && flen <= dtlen)\n        return wfblk(out, p, dat.subarray(bs, bs + bl));\n    var lm, ll, dm, dl;\n    wbits(out, p, 1 + (dtlen < ftlen)), p += 2;\n    if (dtlen < ftlen) {\n        lm = hMap(dlt, mlb, 0), ll = dlt, dm = hMap(ddt, mdb, 0), dl = ddt;\n        var llm = hMap(lct, mlcb, 0);\n        wbits(out, p, nlc - 257);\n        wbits(out, p + 5, ndc - 1);\n        wbits(out, p + 10, nlcc - 4);\n        p += 14;\n        for (var i = 0; i < nlcc; ++i)\n            wbits(out, p + 3 * i, lct[clim[i]]);\n        p += 3 * nlcc;\n        var lcts = [lclt, lcdt];\n        for (var it = 0; it < 2; ++it) {\n            var clct = lcts[it];\n            for (var i = 0; i < clct.length; ++i) {\n                var len = clct[i] & 31;\n                wbits(out, p, llm[len]), p += lct[len];\n                if (len > 15)\n                    wbits(out, p, (clct[i] >>> 5) & 127), p += clct[i] >>> 12;\n            }\n        }\n    }\n    else {\n        lm = flm, ll = flt, dm = fdm, dl = fdt;\n    }\n    for (var i = 0; i < li; ++i) {\n        if (syms[i] > 255) {\n            var len = (syms[i] >>> 18) & 31;\n            wbits16(out, p, lm[len + 257]), p += ll[len + 257];\n            if (len > 7)\n                wbits(out, p, (syms[i] >>> 23) & 31), p += fleb[len];\n            var dst = syms[i] & 31;\n            wbits16(out, p, dm[dst]), p += dl[dst];\n            if (dst > 3)\n                wbits16(out, p, (syms[i] >>> 5) & 8191), p += fdeb[dst];\n        }\n        else {\n            wbits16(out, p, lm[syms[i]]), p += ll[syms[i]];\n        }\n    }\n    wbits16(out, p, lm[256]);\n    return p + ll[256];\n};\n// deflate options (nice << 13) | chain\nvar deo = /*#__PURE__*/ new u32([65540, 131080, 131088, 131104, 262176, 1048704, 1048832, 2114560, 2117632]);\n// empty\nvar et = /*#__PURE__*/ new u8(0);\n// compresses data into a raw DEFLATE buffer\nvar dflt = function (dat, lvl, plvl, pre, post, lst) {\n    var s = dat.length;\n    var o = new u8(pre + s + 5 * (1 + Math.ceil(s / 7000)) + post);\n    // writing to this writes to the output buffer\n    var w = o.subarray(pre, o.length - post);\n    var pos = 0;\n    if (!lvl || s < 8) {\n        for (var i = 0; i <= s; i += 65535) {\n            // end\n            var e = i + 65535;\n            if (e < s) {\n                // write full block\n                pos = wfblk(w, pos, dat.subarray(i, e));\n            }\n            else {\n                // write final block\n                w[i] = lst;\n                pos = wfblk(w, pos, dat.subarray(i, s));\n            }\n        }\n    }\n    else {\n        var opt = deo[lvl - 1];\n        var n = opt >>> 13, c = opt & 8191;\n        var msk_1 = (1 << plvl) - 1;\n        //    prev 2-byte val map    curr 2-byte val map\n        var prev = new u16(32768), head = new u16(msk_1 + 1);\n        var bs1_1 = Math.ceil(plvl / 3), bs2_1 = 2 * bs1_1;\n        var hsh = function (i) { return (dat[i] ^ (dat[i + 1] << bs1_1) ^ (dat[i + 2] << bs2_1)) & msk_1; };\n        // 24576 is an arbitrary number of maximum symbols per block\n        // 424 buffer for last block\n        var syms = new u32(25000);\n        // length/literal freq   distance freq\n        var lf = new u16(288), df = new u16(32);\n        //  l/lcnt  exbits  index  l/lind  waitdx  bitpos\n        var lc_1 = 0, eb = 0, i = 0, li = 0, wi = 0, bs = 0;\n        for (; i < s; ++i) {\n            // hash value\n            // deopt when i > s - 3 - at end, deopt acceptable\n            var hv = hsh(i);\n            // index mod 32768    previous index mod\n            var imod = i & 32767, pimod = head[hv];\n            prev[imod] = pimod;\n            head[hv] = imod;\n            // We always should modify head and prev, but only add symbols if\n            // this data is not yet processed (\"wait\" for wait index)\n            if (wi <= i) {\n                // bytes remaining\n                var rem = s - i;\n                if ((lc_1 > 7000 || li > 24576) && rem > 423) {\n                    pos = wblk(dat, w, 0, syms, lf, df, eb, li, bs, i - bs, pos);\n                    li = lc_1 = eb = 0, bs = i;\n                    for (var j = 0; j < 286; ++j)\n                        lf[j] = 0;\n                    for (var j = 0; j < 30; ++j)\n                        df[j] = 0;\n                }\n                //  len    dist   chain\n                var l = 2, d = 0, ch_1 = c, dif = (imod - pimod) & 32767;\n                if (rem > 2 && hv == hsh(i - dif)) {\n                    var maxn = Math.min(n, rem) - 1;\n                    var maxd = Math.min(32767, i);\n                    // max possible length\n                    // not capped at dif because decompressors implement \"rolling\" index population\n                    var ml = Math.min(258, rem);\n                    while (dif <= maxd && --ch_1 && imod != pimod) {\n                        if (dat[i + l] == dat[i + l - dif]) {\n                            var nl = 0;\n                            for (; nl < ml && dat[i + nl] == dat[i + nl - dif]; ++nl)\n                                ;\n                            if (nl > l) {\n                                l = nl, d = dif;\n                                // break out early when we reach \"nice\" (we are satisfied enough)\n                                if (nl > maxn)\n                                    break;\n                                // now, find the rarest 2-byte sequence within this\n                                // length of literals and search for that instead.\n                                // Much faster than just using the start\n                                var mmd = Math.min(dif, nl - 2);\n                                var md = 0;\n                                for (var j = 0; j < mmd; ++j) {\n                                    var ti = (i - dif + j + 32768) & 32767;\n                                    var pti = prev[ti];\n                                    var cd = (ti - pti + 32768) & 32767;\n                                    if (cd > md)\n                                        md = cd, pimod = ti;\n                                }\n                            }\n                        }\n                        // check the previous match\n                        imod = pimod, pimod = prev[imod];\n                        dif += (imod - pimod + 32768) & 32767;\n                    }\n                }\n                // d will be nonzero only when a match was found\n                if (d) {\n                    // store both dist and len data in one Uint32\n                    // Make sure this is recognized as a len/dist with 28th bit (2^28)\n                    syms[li++] = 268435456 | (revfl[l] << 18) | revfd[d];\n                    var lin = revfl[l] & 31, din = revfd[d] & 31;\n                    eb += fleb[lin] + fdeb[din];\n                    ++lf[257 + lin];\n                    ++df[din];\n                    wi = i + l;\n                    ++lc_1;\n                }\n                else {\n                    syms[li++] = dat[i];\n                    ++lf[dat[i]];\n                }\n            }\n        }\n        pos = wblk(dat, w, lst, syms, lf, df, eb, li, bs, i - bs, pos);\n        // this is the easiest way to avoid needing to maintain state\n        if (!lst && pos & 7)\n            pos = wfblk(w, pos + 1, et);\n    }\n    return slc(o, 0, pre + shft(pos) + post);\n};\n// CRC32 table\nvar crct = /*#__PURE__*/ (function () {\n    var t = new u32(256);\n    for (var i = 0; i < 256; ++i) {\n        var c = i, k = 9;\n        while (--k)\n            c = ((c & 1) && 0xEDB88320) ^ (c >>> 1);\n        t[i] = c;\n    }\n    return t;\n})();\n// CRC32\nvar crc = function () {\n    var c = -1;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var cr = c;\n            for (var i = 0; i < d.length; ++i)\n                cr = crct[(cr & 255) ^ d[i]] ^ (cr >>> 8);\n            c = cr;\n        },\n        d: function () { return ~c; }\n    };\n};\n// Alder32\nvar adler = function () {\n    var a = 1, b = 0;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var n = a, m = b;\n            var l = d.length;\n            for (var i = 0; i != l;) {\n                var e = Math.min(i + 2655, l);\n                for (; i < e; ++i)\n                    m += n += d[i];\n                n = (n & 65535) + 15 * (n >> 16), m = (m & 65535) + 15 * (m >> 16);\n            }\n            a = n, b = m;\n        },\n        d: function () {\n            a %= 65521, b %= 65521;\n            return (a & 255) << 24 | (a >>> 8) << 16 | (b & 255) << 8 | (b >>> 8);\n        }\n    };\n};\n;\n// deflate with opts\nvar dopt = function (dat, opt, pre, post, st) {\n    return dflt(dat, opt.level == null ? 6 : opt.level, opt.mem == null ? Math.ceil(Math.max(8, Math.min(13, Math.log(dat.length))) * 1.5) : (12 + opt.mem), pre, post, !st);\n};\n// Walmart object spread\nvar mrg = function (a, b) {\n    var o = {};\n    for (var k in a)\n        o[k] = a[k];\n    for (var k in b)\n        o[k] = b[k];\n    return o;\n};\n// worker clone\n// This is possibly the craziest part of the entire codebase, despite how simple it may seem.\n// The only parameter to this function is a closure that returns an array of variables outside of the function scope.\n// We're going to try to figure out the variable names used in the closure as strings because that is crucial for workerization.\n// We will return an object mapping of true variable name to value (basically, the current scope as a JS object).\n// The reason we can't just use the original variable names is minifiers mangling the toplevel scope.\n// This took me three weeks to figure out how to do.\nvar wcln = function (fn, fnStr, td) {\n    var dt = fn();\n    var st = fn.toString();\n    var ks = st.slice(st.indexOf('[') + 1, st.lastIndexOf(']')).replace(/ /g, '').split(',');\n    for (var i = 0; i < dt.length; ++i) {\n        var v = dt[i], k = ks[i];\n        if (typeof v == 'function') {\n            fnStr += ';' + k + '=';\n            var st_1 = v.toString();\n            if (v.prototype) {\n                // for global objects\n                if (st_1.indexOf('[native code]') != -1) {\n                    var spInd = st_1.indexOf(' ', 8) + 1;\n                    fnStr += st_1.slice(spInd, st_1.indexOf('(', spInd));\n                }\n                else {\n                    fnStr += st_1;\n                    for (var t in v.prototype)\n                        fnStr += ';' + k + '.prototype.' + t + '=' + v.prototype[t].toString();\n                }\n            }\n            else\n                fnStr += st_1;\n        }\n        else\n            td[k] = v;\n    }\n    return [fnStr, td];\n};\nvar ch = [];\n// clone bufs\nvar cbfs = function (v) {\n    var tl = [];\n    for (var k in v) {\n        if (v[k] instanceof u8 || v[k] instanceof u16 || v[k] instanceof u32)\n            tl.push((v[k] = new v[k].constructor(v[k])).buffer);\n    }\n    return tl;\n};\n// use a worker to execute code\nvar wrkr = function (fns, init, id, cb) {\n    var _a;\n    if (!ch[id]) {\n        var fnStr = '', td_1 = {}, m = fns.length - 1;\n        for (var i = 0; i < m; ++i)\n            _a = wcln(fns[i], fnStr, td_1), fnStr = _a[0], td_1 = _a[1];\n        ch[id] = wcln(fns[m], fnStr, td_1);\n    }\n    var td = mrg({}, ch[id][1]);\n    return wk(ch[id][0] + ';onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage=' + init.toString() + '}', id, td, cbfs(td), cb);\n};\n// base async inflate fn\nvar bInflt = function () { return [u8, u16, u32, fleb, fdeb, clim, fl, fd, flrm, fdrm, rev, hMap, max, bits, bits16, shft, slc, inflt, inflateSync, pbf, gu8]; };\nvar bDflt = function () { return [u8, u16, u32, fleb, fdeb, clim, revfl, revfd, flm, flt, fdm, fdt, rev, deo, et, hMap, wbits, wbits16, hTree, ln, lc, clen, wfblk, wblk, shft, slc, dflt, dopt, deflateSync, pbf]; };\n// gzip extra\nvar gze = function () { return [gzh, gzhl, wbytes, crc, crct]; };\n// gunzip extra\nvar guze = function () { return [gzs, gzl]; };\n// zlib extra\nvar zle = function () { return [zlh, wbytes, adler]; };\n// unzlib extra\nvar zule = function () { return [zlv]; };\n// post buf\nvar pbf = function (msg) { return postMessage(msg, [msg.buffer]); };\n// get u8\nvar gu8 = function (o) { return o && o.size && new u8(o.size); };\n// async helper\nvar cbify = function (dat, opts, fns, init, id, cb) {\n    var w = wrkr(fns, init, id, function (err, dat) {\n        w.terminate();\n        cb(err, dat);\n    });\n    w.postMessage([dat, opts], opts.consume ? [dat.buffer] : []);\n    return function () { w.terminate(); };\n};\n// auto stream\nvar astrm = function (strm) {\n    strm.ondata = function (dat, final) { return postMessage([dat, final], [dat.buffer]); };\n    return function (ev) { return strm.push(ev.data[0], ev.data[1]); };\n};\n// async stream attach\nvar astrmify = function (fns, strm, opts, init, id) {\n    var t;\n    var w = wrkr(fns, init, id, function (err, dat) {\n        if (err)\n            w.terminate(), strm.ondata.call(strm, err);\n        else {\n            if (dat[1])\n                w.terminate();\n            strm.ondata.call(strm, err, dat[0], dat[1]);\n        }\n    });\n    w.postMessage(opts);\n    strm.push = function (d, f) {\n        if (t)\n            throw 'stream finished';\n        if (!strm.ondata)\n            throw 'no stream handler';\n        w.postMessage([d, t = f], [d.buffer]);\n    };\n    strm.terminate = function () { w.terminate(); };\n};\n// read 2 bytes\nvar b2 = function (d, b) { return d[b] | (d[b + 1] << 8); };\n// read 4 bytes\nvar b4 = function (d, b) { return (d[b] | (d[b + 1] << 8) | (d[b + 2] << 16) | (d[b + 3] << 24)) >>> 0; };\nvar b8 = function (d, b) { return b4(d, b) + (b4(d, b + 4) * 4294967296); };\n// write bytes\nvar wbytes = function (d, b, v) {\n    for (; v; ++b)\n        d[b] = v, v >>>= 8;\n};\n// gzip header\nvar gzh = function (c, o) {\n    var fn = o.filename;\n    c[0] = 31, c[1] = 139, c[2] = 8, c[8] = o.level < 2 ? 4 : o.level == 9 ? 2 : 0, c[9] = 3; // assume Unix\n    if (o.mtime != 0)\n        wbytes(c, 4, Math.floor(new Date(o.mtime || Date.now()) / 1000));\n    if (fn) {\n        c[3] = 8;\n        for (var i = 0; i <= fn.length; ++i)\n            c[i + 10] = fn.charCodeAt(i);\n    }\n};\n// gzip footer: -8 to -4 = CRC, -4 to -0 is length\n// gzip start\nvar gzs = function (d) {\n    if (d[0] != 31 || d[1] != 139 || d[2] != 8)\n        throw 'invalid gzip data';\n    var flg = d[3];\n    var st = 10;\n    if (flg & 4)\n        st += d[10] | (d[11] << 8) + 2;\n    for (var zs = (flg >> 3 & 1) + (flg >> 4 & 1); zs > 0; zs -= !d[st++])\n        ;\n    return st + (flg & 2);\n};\n// gzip length\nvar gzl = function (d) {\n    var l = d.length;\n    return ((d[l - 4] | d[l - 3] << 8 | d[l - 2] << 16) | (d[l - 1] << 24)) >>> 0;\n};\n// gzip header length\nvar gzhl = function (o) { return 10 + ((o.filename && (o.filename.length + 1)) || 0); };\n// zlib header\nvar zlh = function (c, o) {\n    var lv = o.level, fl = lv == 0 ? 0 : lv < 6 ? 1 : lv == 9 ? 3 : 2;\n    c[0] = 120, c[1] = (fl << 6) | (fl ? (32 - 2 * fl) : 1);\n};\n// zlib valid\nvar zlv = function (d) {\n    if ((d[0] & 15) != 8 || (d[0] >>> 4) > 7 || ((d[0] << 8 | d[1]) % 31))\n        throw 'invalid zlib data';\n    if (d[1] & 32)\n        throw 'invalid zlib data: preset dictionaries not supported';\n};\nfunction AsyncCmpStrm(opts, cb) {\n    if (!cb && typeof opts == 'function')\n        cb = opts, opts = {};\n    this.ondata = cb;\n    return opts;\n}\n// zlib footer: -4 to -0 is Adler32\n/**\n * Streaming DEFLATE compression\n */\nvar Deflate = /*#__PURE__*/ (function () {\n    function Deflate(opts, cb) {\n        if (!cb && typeof opts == 'function')\n            cb = opts, opts = {};\n        this.ondata = cb;\n        this.o = opts || {};\n    }\n    Deflate.prototype.p = function (c, f) {\n        this.ondata(dopt(c, this.o, 0, 0, !f), f);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Deflate.prototype.push = function (chunk, final) {\n        if (this.d)\n            throw 'stream finished';\n        if (!this.ondata)\n            throw 'no stream handler';\n        this.d = final;\n        this.p(chunk, final || false);\n    };\n    return Deflate;\n}());\nexport { Deflate };\n/**\n * Asynchronous streaming DEFLATE compression\n */\nvar AsyncDeflate = /*#__PURE__*/ (function () {\n    function AsyncDeflate(opts, cb) {\n        astrmify([\n            bDflt,\n            function () { return [astrm, Deflate]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Deflate(ev.data);\n            onmessage = astrm(strm);\n        }, 6);\n    }\n    return AsyncDeflate;\n}());\nexport { AsyncDeflate };\nexport function deflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bDflt,\n    ], function (ev) { return pbf(deflateSync(ev.data[0], ev.data[1])); }, 0, cb);\n}\n/**\n * Compresses data with DEFLATE without any wrapper\n * @param data The data to compress\n * @param opts The compression options\n * @returns The deflated version of the data\n */\nexport function deflateSync(data, opts) {\n    return dopt(data, opts || {}, 0, 0);\n}\n/**\n * Streaming DEFLATE decompression\n */\nvar Inflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an inflation stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Inflate(cb) {\n        this.s = {};\n        this.p = new u8(0);\n        this.ondata = cb;\n    }\n    Inflate.prototype.e = function (c) {\n        if (this.d)\n            throw 'stream finished';\n        if (!this.ondata)\n            throw 'no stream handler';\n        var l = this.p.length;\n        var n = new u8(l + c.length);\n        n.set(this.p), n.set(c, l), this.p = n;\n    };\n    Inflate.prototype.c = function (final) {\n        this.d = this.s.i = final || false;\n        var bts = this.s.b;\n        var dt = inflt(this.p, this.o, this.s);\n        this.ondata(slc(dt, bts, this.s.b), this.d);\n        this.o = slc(dt, this.s.b - 32768), this.s.b = this.o.length;\n        this.p = slc(this.p, (this.s.p / 8) | 0), this.s.p &= 7;\n    };\n    /**\n     * Pushes a chunk to be inflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the final chunk\n     */\n    Inflate.prototype.push = function (chunk, final) {\n        this.e(chunk), this.c(final);\n    };\n    return Inflate;\n}());\nexport { Inflate };\n/**\n * Asynchronous streaming DEFLATE decompression\n */\nvar AsyncInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous inflation stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncInflate(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            function () { return [astrm, Inflate]; }\n        ], this, 0, function () {\n            var strm = new Inflate();\n            onmessage = astrm(strm);\n        }, 7);\n    }\n    return AsyncInflate;\n}());\nexport { AsyncInflate };\nexport function inflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bInflt\n    ], function (ev) { return pbf(inflateSync(ev.data[0], gu8(ev.data[1]))); }, 1, cb);\n}\n/**\n * Expands DEFLATE data with no wrapper\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function inflateSync(data, out) {\n    return inflt(data, out);\n}\n// before you yell at me for not just using extends, my reason is that TS inheritance is hard to workerize.\n/**\n * Streaming GZIP compression\n */\nvar Gzip = /*#__PURE__*/ (function () {\n    function Gzip(opts, cb) {\n        this.c = crc();\n        this.l = 0;\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be GZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gzip.prototype.push = function (chunk, final) {\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Gzip.prototype.p = function (c, f) {\n        this.c.p(c);\n        this.l += c.length;\n        var raw = dopt(c, this.o, this.v && gzhl(this.o), f && 8, !f);\n        if (this.v)\n            gzh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 8, this.c.d()), wbytes(raw, raw.length - 4, this.l);\n        this.ondata(raw, f);\n    };\n    return Gzip;\n}());\nexport { Gzip };\n/**\n * Asynchronous streaming GZIP compression\n */\nvar AsyncGzip = /*#__PURE__*/ (function () {\n    function AsyncGzip(opts, cb) {\n        astrmify([\n            bDflt,\n            gze,\n            function () { return [astrm, Deflate, Gzip]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Gzip(ev.data);\n            onmessage = astrm(strm);\n        }, 8);\n    }\n    return AsyncGzip;\n}());\nexport { AsyncGzip };\nexport function gzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bDflt,\n        gze,\n        function () { return [gzipSync]; }\n    ], function (ev) { return pbf(gzipSync(ev.data[0], ev.data[1])); }, 2, cb);\n}\n/**\n * Compresses data with GZIP\n * @param data The data to compress\n * @param opts The compression options\n * @returns The gzipped version of the data\n */\nexport function gzipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var c = crc(), l = data.length;\n    c.p(data);\n    var d = dopt(data, opts, gzhl(opts), 8), s = d.length;\n    return gzh(d, opts), wbytes(d, s - 8, c.d()), wbytes(d, s - 4, l), d;\n}\n/**\n * Streaming GZIP decompression\n */\nvar Gunzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates a GUNZIP stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Gunzip(cb) {\n        this.v = 1;\n        Inflate.call(this, cb);\n    }\n    /**\n     * Pushes a chunk to be GUNZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gunzip.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            var s = this.p.length > 3 ? gzs(this.p) : 4;\n            if (s >= this.p.length && !final)\n                return;\n            this.p = this.p.subarray(s), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 8)\n                throw 'invalid gzip stream';\n            this.p = this.p.subarray(0, -8);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Gunzip;\n}());\nexport { Gunzip };\n/**\n * Asynchronous streaming GZIP decompression\n */\nvar AsyncGunzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous GUNZIP stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncGunzip(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            guze,\n            function () { return [astrm, Inflate, Gunzip]; }\n        ], this, 0, function () {\n            var strm = new Gunzip();\n            onmessage = astrm(strm);\n        }, 9);\n    }\n    return AsyncGunzip;\n}());\nexport { AsyncGunzip };\nexport function gunzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bInflt,\n        guze,\n        function () { return [gunzipSync]; }\n    ], function (ev) { return pbf(gunzipSync(ev.data[0])); }, 3, cb);\n}\n/**\n * Expands GZIP data\n * @param data The data to decompress\n * @param out Where to write the data. GZIP already encodes the output size, so providing this doesn't save memory.\n * @returns The decompressed version of the data\n */\nexport function gunzipSync(data, out) {\n    return inflt(data.subarray(gzs(data), -8), out || new u8(gzl(data)));\n}\n/**\n * Streaming Zlib compression\n */\nvar Zlib = /*#__PURE__*/ (function () {\n    function Zlib(opts, cb) {\n        this.c = adler();\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be zlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Zlib.prototype.push = function (chunk, final) {\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Zlib.prototype.p = function (c, f) {\n        this.c.p(c);\n        var raw = dopt(c, this.o, this.v && 2, f && 4, !f);\n        if (this.v)\n            zlh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 4, this.c.d());\n        this.ondata(raw, f);\n    };\n    return Zlib;\n}());\nexport { Zlib };\n/**\n * Asynchronous streaming Zlib compression\n */\nvar AsyncZlib = /*#__PURE__*/ (function () {\n    function AsyncZlib(opts, cb) {\n        astrmify([\n            bDflt,\n            zle,\n            function () { return [astrm, Deflate, Zlib]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Zlib(ev.data);\n            onmessage = astrm(strm);\n        }, 10);\n    }\n    return AsyncZlib;\n}());\nexport { AsyncZlib };\nexport function zlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bDflt,\n        zle,\n        function () { return [zlibSync]; }\n    ], function (ev) { return pbf(zlibSync(ev.data[0], ev.data[1])); }, 4, cb);\n}\n/**\n * Compress data with Zlib\n * @param data The data to compress\n * @param opts The compression options\n * @returns The zlib-compressed version of the data\n */\nexport function zlibSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var a = adler();\n    a.p(data);\n    var d = dopt(data, opts, 2, 4);\n    return zlh(d, opts), wbytes(d, d.length - 4, a.d()), d;\n}\n/**\n * Streaming Zlib decompression\n */\nvar Unzlib = /*#__PURE__*/ (function () {\n    /**\n     * Creates a Zlib decompression stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Unzlib(cb) {\n        this.v = 1;\n        Inflate.call(this, cb);\n    }\n    /**\n     * Pushes a chunk to be unzlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzlib.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            if (this.p.length < 2 && !final)\n                return;\n            this.p = this.p.subarray(2), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 4)\n                throw 'invalid zlib stream';\n            this.p = this.p.subarray(0, -4);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Unzlib;\n}());\nexport { Unzlib };\n/**\n * Asynchronous streaming Zlib decompression\n */\nvar AsyncUnzlib = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous Zlib decompression stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncUnzlib(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            zule,\n            function () { return [astrm, Inflate, Unzlib]; }\n        ], this, 0, function () {\n            var strm = new Unzlib();\n            onmessage = astrm(strm);\n        }, 11);\n    }\n    return AsyncUnzlib;\n}());\nexport { AsyncUnzlib };\nexport function unzlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bInflt,\n        zule,\n        function () { return [unzlibSync]; }\n    ], function (ev) { return pbf(unzlibSync(ev.data[0], gu8(ev.data[1]))); }, 5, cb);\n}\n/**\n * Expands Zlib data\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function unzlibSync(data, out) {\n    return inflt((zlv(data), data.subarray(2, -4)), out);\n}\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzip as compress, AsyncGzip as AsyncCompress };\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzipSync as compressSync, Gzip as Compress };\n/**\n * Streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar Decompress = /*#__PURE__*/ (function () {\n    /**\n     * Creates a decompression stream\n     * @param cb The callback to call whenever data is decompressed\n     */\n    function Decompress(cb) {\n        this.G = Gunzip;\n        this.I = Inflate;\n        this.Z = Unzlib;\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Decompress.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            throw 'no stream handler';\n        if (!this.s) {\n            if (this.p && this.p.length) {\n                var n = new u8(this.p.length + chunk.length);\n                n.set(this.p), n.set(chunk, this.p.length);\n            }\n            else\n                this.p = chunk;\n            if (this.p.length > 2) {\n                var _this_1 = this;\n                var cb = function () { _this_1.ondata.apply(_this_1, arguments); };\n                this.s = (this.p[0] == 31 && this.p[1] == 139 && this.p[2] == 8)\n                    ? new this.G(cb)\n                    : ((this.p[0] & 15) != 8 || (this.p[0] >> 4) > 7 || ((this.p[0] << 8 | this.p[1]) % 31))\n                        ? new this.I(cb)\n                        : new this.Z(cb);\n                this.s.push(this.p, final);\n                this.p = null;\n            }\n        }\n        else\n            this.s.push(chunk, final);\n    };\n    return Decompress;\n}());\nexport { Decompress };\n/**\n * Asynchronous streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar AsyncDecompress = /*#__PURE__*/ (function () {\n    /**\n   * Creates an asynchronous decompression stream\n   * @param cb The callback to call whenever data is decompressed\n   */\n    function AsyncDecompress(cb) {\n        this.G = AsyncGunzip;\n        this.I = AsyncInflate;\n        this.Z = AsyncUnzlib;\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncDecompress.prototype.push = function (chunk, final) {\n        Decompress.prototype.push.call(this, chunk, final);\n    };\n    return AsyncDecompress;\n}());\nexport { AsyncDecompress };\nexport function decompress(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzip(data, opts, cb)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflate(data, opts, cb)\n            : unzlib(data, opts, cb);\n}\n/**\n * Expands compressed GZIP, Zlib, or raw DEFLATE data, automatically detecting the format\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function decompressSync(data, out) {\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzipSync(data, out)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflateSync(data, out)\n            : unzlibSync(data, out);\n}\n// flatten a directory structure\nvar fltn = function (d, p, t, o) {\n    for (var k in d) {\n        var val = d[k], n = p + k;\n        if (val instanceof u8)\n            t[n] = [val, o];\n        else if (Array.isArray(val))\n            t[n] = [val[0], mrg(o, val[1])];\n        else\n            fltn(val, n + '/', t, o);\n    }\n};\n// text encoder\nvar te = typeof TextEncoder != 'undefined' && /*#__PURE__*/ new TextEncoder();\n// text decoder\nvar td = typeof TextDecoder != 'undefined' && /*#__PURE__*/ new TextDecoder();\n// text decoder stream\nvar tds = 0;\ntry {\n    td.decode(et, { stream: true });\n    tds = 1;\n}\ncatch (e) { }\n// decode UTF8\nvar dutf8 = function (d) {\n    for (var r = '', i = 0;;) {\n        var c = d[i++];\n        var eb = (c > 127) + (c > 223) + (c > 239);\n        if (i + eb > d.length)\n            return [r, slc(d, i - 1)];\n        if (!eb)\n            r += String.fromCharCode(c);\n        else if (eb == 3) {\n            c = ((c & 15) << 18 | (d[i++] & 63) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63)) - 65536,\n                r += String.fromCharCode(55296 | (c >> 10), 56320 | (c & 1023));\n        }\n        else if (eb & 1)\n            r += String.fromCharCode((c & 31) << 6 | (d[i++] & 63));\n        else\n            r += String.fromCharCode((c & 15) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63));\n    }\n};\n/**\n * Streaming UTF-8 decoding\n */\nvar DecodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is decoded\n     */\n    function DecodeUTF8(cb) {\n        this.ondata = cb;\n        if (tds)\n            this.t = new TextDecoder();\n        else\n            this.p = et;\n    }\n    /**\n     * Pushes a chunk to be decoded from UTF-8 binary\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    DecodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            throw 'no callback';\n        final = !!final;\n        if (this.t) {\n            this.ondata(this.t.decode(chunk, { stream: true }), final);\n            if (final) {\n                if (this.t.decode().length)\n                    throw 'invalid utf-8 data';\n                this.t = null;\n            }\n            return;\n        }\n        if (!this.p)\n            throw 'stream finished';\n        var dat = new u8(this.p.length + chunk.length);\n        dat.set(this.p);\n        dat.set(chunk, this.p.length);\n        var _a = dutf8(dat), ch = _a[0], np = _a[1];\n        if (final) {\n            if (np.length)\n                throw 'invalid utf-8 data';\n            this.p = null;\n        }\n        else\n            this.p = np;\n        this.ondata(ch, final);\n    };\n    return DecodeUTF8;\n}());\nexport { DecodeUTF8 };\n/**\n * Streaming UTF-8 encoding\n */\nvar EncodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is encoded\n     */\n    function EncodeUTF8(cb) {\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be encoded to UTF-8\n     * @param chunk The string data to push\n     * @param final Whether this is the last chunk\n     */\n    EncodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            throw 'no callback';\n        if (this.d)\n            throw 'stream finished';\n        this.ondata(strToU8(chunk), this.d = final || false);\n    };\n    return EncodeUTF8;\n}());\nexport { EncodeUTF8 };\n/**\n * Converts a string into a Uint8Array for use with compression/decompression methods\n * @param str The string to encode\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless decoding a binary string.\n * @returns The string encoded in UTF-8/Latin-1 binary\n */\nexport function strToU8(str, latin1) {\n    if (latin1) {\n        var ar_1 = new u8(str.length);\n        for (var i = 0; i < str.length; ++i)\n            ar_1[i] = str.charCodeAt(i);\n        return ar_1;\n    }\n    if (te)\n        return te.encode(str);\n    var l = str.length;\n    var ar = new u8(str.length + (str.length >> 1));\n    var ai = 0;\n    var w = function (v) { ar[ai++] = v; };\n    for (var i = 0; i < l; ++i) {\n        if (ai + 5 > ar.length) {\n            var n = new u8(ai + 8 + ((l - i) << 1));\n            n.set(ar);\n            ar = n;\n        }\n        var c = str.charCodeAt(i);\n        if (c < 128 || latin1)\n            w(c);\n        else if (c < 2048)\n            w(192 | (c >> 6)), w(128 | (c & 63));\n        else if (c > 55295 && c < 57344)\n            c = 65536 + (c & 1023 << 10) | (str.charCodeAt(++i) & 1023),\n                w(240 | (c >> 18)), w(128 | ((c >> 12) & 63)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n        else\n            w(224 | (c >> 12)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n    }\n    return slc(ar, 0, ai);\n}\n/**\n * Converts a Uint8Array to a string\n * @param dat The data to decode to string\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless encoding to binary string.\n * @returns The original UTF-8/Latin-1 string\n */\nexport function strFromU8(dat, latin1) {\n    if (latin1) {\n        var r = '';\n        for (var i = 0; i < dat.length; i += 16384)\n            r += String.fromCharCode.apply(null, dat.subarray(i, i + 16384));\n        return r;\n    }\n    else if (td)\n        return td.decode(dat);\n    else {\n        var _a = dutf8(dat), out = _a[0], ext = _a[1];\n        if (ext.length)\n            throw 'invalid utf-8 data';\n        return out;\n    }\n}\n;\n// deflate bit flag\nvar dbf = function (l) { return l == 1 ? 3 : l < 6 ? 2 : l == 9 ? 1 : 0; };\n// skip local zip header\nvar slzh = function (d, b) { return b + 30 + b2(d, b + 26) + b2(d, b + 28); };\n// read zip header\nvar zh = function (d, b, z) {\n    var fnl = b2(d, b + 28), fn = strFromU8(d.subarray(b + 46, b + 46 + fnl), !(b2(d, b + 8) & 2048)), es = b + 46 + fnl, bs = b4(d, b + 20);\n    var _a = z && bs == 4294967295 ? z64e(d, es) : [bs, b4(d, b + 24), b4(d, b + 42)], sc = _a[0], su = _a[1], off = _a[2];\n    return [b2(d, b + 10), sc, su, fn, es + b2(d, b + 30) + b2(d, b + 32), off];\n};\n// read zip64 extra field\nvar z64e = function (d, b) {\n    for (; b2(d, b) != 1; b += 4 + b2(d, b + 2))\n        ;\n    return [b8(d, b + 12), b8(d, b + 4), b8(d, b + 20)];\n};\n// extra field length\nvar exfl = function (ex) {\n    var le = 0;\n    if (ex) {\n        for (var k in ex) {\n            var l = ex[k].length;\n            if (l > 65535)\n                throw 'extra field too long';\n            le += l + 4;\n        }\n    }\n    return le;\n};\n// write zip header\nvar wzh = function (d, b, f, fn, u, c, ce, co) {\n    var fl = fn.length, ex = f.extra, col = co && co.length;\n    var exl = exfl(ex);\n    wbytes(d, b, ce != null ? 0x2014B50 : 0x4034B50), b += 4;\n    if (ce != null)\n        d[b++] = 20, d[b++] = f.os;\n    d[b] = 20, b += 2; // spec compliance? what's that?\n    d[b++] = (f.flag << 1) | (c == null && 8), d[b++] = u && 8;\n    d[b++] = f.compression & 255, d[b++] = f.compression >> 8;\n    var dt = new Date(f.mtime == null ? Date.now() : f.mtime), y = dt.getFullYear() - 1980;\n    if (y < 0 || y > 119)\n        throw 'date not in range 1980-2099';\n    wbytes(d, b, (y << 25) | ((dt.getMonth() + 1) << 21) | (dt.getDate() << 16) | (dt.getHours() << 11) | (dt.getMinutes() << 5) | (dt.getSeconds() >>> 1)), b += 4;\n    if (c != null) {\n        wbytes(d, b, f.crc);\n        wbytes(d, b + 4, c);\n        wbytes(d, b + 8, f.size);\n    }\n    wbytes(d, b + 12, fl);\n    wbytes(d, b + 14, exl), b += 16;\n    if (ce != null) {\n        wbytes(d, b, col);\n        wbytes(d, b + 6, f.attrs);\n        wbytes(d, b + 10, ce), b += 14;\n    }\n    d.set(fn, b);\n    b += fl;\n    if (exl) {\n        for (var k in ex) {\n            var exf = ex[k], l = exf.length;\n            wbytes(d, b, +k);\n            wbytes(d, b + 2, l);\n            d.set(exf, b + 4), b += 4 + l;\n        }\n    }\n    if (col)\n        d.set(co, b), b += col;\n    return b;\n};\n// write zip footer (end of central directory)\nvar wzf = function (o, b, c, d, e) {\n    wbytes(o, b, 0x6054B50); // skip disk\n    wbytes(o, b + 8, c);\n    wbytes(o, b + 10, c);\n    wbytes(o, b + 12, d);\n    wbytes(o, b + 16, e);\n};\n/**\n * A pass-through stream to keep data uncompressed in a ZIP archive.\n */\nvar ZipPassThrough = /*#__PURE__*/ (function () {\n    /**\n     * Creates a pass-through stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     */\n    function ZipPassThrough(filename) {\n        this.filename = filename;\n        this.c = crc();\n        this.size = 0;\n        this.compression = 0;\n    }\n    /**\n     * Processes a chunk and pushes to the output stream. You can override this\n     * method in a subclass for custom behavior, but by default this passes\n     * the data through. You must call this.ondata(err, chunk, final) at some\n     * point in this method.\n     * @param chunk The chunk to process\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.process = function (chunk, final) {\n        this.ondata(null, chunk, final);\n    };\n    /**\n     * Pushes a chunk to be added. If you are subclassing this with a custom\n     * compression algorithm, note that you must push data from the source\n     * file only, pre-compression.\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            throw 'no callback - add to ZIP archive before pushing';\n        this.c.p(chunk);\n        this.size += chunk.length;\n        if (final)\n            this.crc = this.c.d();\n        this.process(chunk, final || false);\n    };\n    return ZipPassThrough;\n}());\nexport { ZipPassThrough };\n// I don't extend because TypeScript extension adds 1kB of runtime bloat\n/**\n * Streaming DEFLATE compression for ZIP archives. Prefer using AsyncZipDeflate\n * for better performance\n */\nvar ZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function ZipDeflate(filename, opts) {\n        var _this_1 = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new Deflate(opts, function (dat, final) {\n            _this_1.ondata(null, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n    }\n    ZipDeflate.prototype.process = function (chunk, final) {\n        try {\n            this.d.push(chunk, final);\n        }\n        catch (e) {\n            this.ondata(e, null, final);\n        }\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return ZipDeflate;\n}());\nexport { ZipDeflate };\n/**\n * Asynchronous streaming DEFLATE compression for ZIP archives\n */\nvar AsyncZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function AsyncZipDeflate(filename, opts) {\n        var _this_1 = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new AsyncDeflate(opts, function (err, dat, final) {\n            _this_1.ondata(err, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n        this.terminate = this.d.terminate;\n    }\n    AsyncZipDeflate.prototype.process = function (chunk, final) {\n        this.d.push(chunk, final);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return AsyncZipDeflate;\n}());\nexport { AsyncZipDeflate };\n// TODO: Better tree shaking\n/**\n * A zippable archive to which files can incrementally be added\n */\nvar Zip = /*#__PURE__*/ (function () {\n    /**\n     * Creates an empty ZIP archive to which files can be added\n     * @param cb The callback to call whenever data for the generated ZIP archive\n     *           is available\n     */\n    function Zip(cb) {\n        this.ondata = cb;\n        this.u = [];\n        this.d = 1;\n    }\n    /**\n     * Adds a file to the ZIP archive\n     * @param file The file stream to add\n     */\n    Zip.prototype.add = function (file) {\n        var _this_1 = this;\n        if (this.d & 2)\n            throw 'stream finished';\n        var f = strToU8(file.filename), fl = f.length;\n        var com = file.comment, o = com && strToU8(com);\n        var u = fl != file.filename.length || (o && (com.length != o.length));\n        var hl = fl + exfl(file.extra) + 30;\n        if (fl > 65535)\n            throw 'filename too long';\n        var header = new u8(hl);\n        wzh(header, 0, file, f, u);\n        var chks = [header];\n        var pAll = function () {\n            for (var _i = 0, chks_1 = chks; _i < chks_1.length; _i++) {\n                var chk = chks_1[_i];\n                _this_1.ondata(null, chk, false);\n            }\n            chks = [];\n        };\n        var tr = this.d;\n        this.d = 0;\n        var ind = this.u.length;\n        var uf = mrg(file, {\n            f: f,\n            u: u,\n            o: o,\n            t: function () {\n                if (file.terminate)\n                    file.terminate();\n            },\n            r: function () {\n                pAll();\n                if (tr) {\n                    var nxt = _this_1.u[ind + 1];\n                    if (nxt)\n                        nxt.r();\n                    else\n                        _this_1.d = 1;\n                }\n                tr = 1;\n            }\n        });\n        var cl = 0;\n        file.ondata = function (err, dat, final) {\n            if (err) {\n                _this_1.ondata(err, dat, final);\n                _this_1.terminate();\n            }\n            else {\n                cl += dat.length;\n                chks.push(dat);\n                if (final) {\n                    var dd = new u8(16);\n                    wbytes(dd, 0, 0x8074B50);\n                    wbytes(dd, 4, file.crc);\n                    wbytes(dd, 8, cl);\n                    wbytes(dd, 12, file.size);\n                    chks.push(dd);\n                    uf.c = cl, uf.b = hl + cl + 16, uf.crc = file.crc, uf.size = file.size;\n                    if (tr)\n                        uf.r();\n                    tr = 1;\n                }\n                else if (tr)\n                    pAll();\n            }\n        };\n        this.u.push(uf);\n    };\n    /**\n     * Ends the process of adding files and prepares to emit the final chunks.\n     * This *must* be called after adding all desired files for the resulting\n     * ZIP file to work properly.\n     */\n    Zip.prototype.end = function () {\n        var _this_1 = this;\n        if (this.d & 2) {\n            if (this.d & 1)\n                throw 'stream finishing';\n            throw 'stream finished';\n        }\n        if (this.d)\n            this.e();\n        else\n            this.u.push({\n                r: function () {\n                    if (!(_this_1.d & 1))\n                        return;\n                    _this_1.u.splice(-1, 1);\n                    _this_1.e();\n                },\n                t: function () { }\n            });\n        this.d = 3;\n    };\n    Zip.prototype.e = function () {\n        var bt = 0, l = 0, tl = 0;\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            tl += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0);\n        }\n        var out = new u8(tl + 22);\n        for (var _b = 0, _c = this.u; _b < _c.length; _b++) {\n            var f = _c[_b];\n            wzh(out, bt, f, f.f, f.u, f.c, l, f.o);\n            bt += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0), l += f.b;\n        }\n        wzf(out, bt, this.u.length, tl, l);\n        this.ondata(null, out, true);\n        this.d = 2;\n    };\n    /**\n     * A method to terminate any internal workers used by the stream. Subsequent\n     * calls to add() will fail.\n     */\n    Zip.prototype.terminate = function () {\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            f.t();\n        }\n        this.d = 2;\n    };\n    return Zip;\n}());\nexport { Zip };\nexport function zip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    var r = {};\n    fltn(data, '', r, opts);\n    var k = Object.keys(r);\n    var lft = k.length, o = 0, tot = 0;\n    var slft = lft, files = new Array(lft);\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var cbf = function () {\n        var out = new u8(tot + 22), oe = o, cdl = tot - o;\n        tot = 0;\n        for (var i = 0; i < slft; ++i) {\n            var f = files[i];\n            try {\n                var l = f.c.length;\n                wzh(out, tot, f, f.f, f.u, l);\n                var badd = 30 + f.f.length + exfl(f.extra);\n                var loc = tot + badd;\n                out.set(f.c, loc);\n                wzh(out, o, f, f.f, f.u, l, tot, f.m), o += 16 + badd + (f.m ? f.m.length : 0), tot = loc + l;\n            }\n            catch (e) {\n                return cb(e, null);\n            }\n        }\n        wzf(out, o, files.length, cdl, oe);\n        cb(null, out);\n    };\n    if (!lft)\n        cbf();\n    var _loop_1 = function (i) {\n        var fn = k[i];\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var c = crc(), size = file.length;\n        c.p(file);\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        var compression = p.level == 0 ? 0 : 8;\n        var cbl = function (e, d) {\n            if (e) {\n                tAll();\n                cb(e, null);\n            }\n            else {\n                var l = d.length;\n                files[i] = mrg(p, {\n                    size: size,\n                    crc: c.d(),\n                    c: d,\n                    f: f,\n                    m: m,\n                    u: s != fn.length || (m && (com.length != ms)),\n                    compression: compression\n                });\n                o += 30 + s + exl + l;\n                tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n                if (!--lft)\n                    cbf();\n            }\n        };\n        if (s > 65535)\n            cbl('filename too long', null);\n        if (!compression)\n            cbl(null, file);\n        else if (size < 160000) {\n            try {\n                cbl(null, deflateSync(file, p));\n            }\n            catch (e) {\n                cbl(e, null);\n            }\n        }\n        else\n            term.push(deflate(file, p, cbl));\n    };\n    // Cannot use lft because it can decrease\n    for (var i = 0; i < slft; ++i) {\n        _loop_1(i);\n    }\n    return tAll;\n}\n/**\n * Synchronously creates a ZIP file. Prefer using `zip` for better performance\n * with more than one file.\n * @param data The directory structure for the ZIP archive\n * @param opts The main options, merged with per-file options\n * @returns The generated ZIP archive\n */\nexport function zipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var r = {};\n    var files = [];\n    fltn(data, '', r, opts);\n    var o = 0;\n    var tot = 0;\n    for (var fn in r) {\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var compression = p.level == 0 ? 0 : 8;\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        if (s > 65535)\n            throw 'filename too long';\n        var d = compression ? deflateSync(file, p) : file, l = d.length;\n        var c = crc();\n        c.p(file);\n        files.push(mrg(p, {\n            size: file.length,\n            crc: c.d(),\n            c: d,\n            f: f,\n            m: m,\n            u: s != fn.length || (m && (com.length != ms)),\n            o: o,\n            compression: compression\n        }));\n        o += 30 + s + exl + l;\n        tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n    }\n    var out = new u8(tot + 22), oe = o, cdl = tot - o;\n    for (var i = 0; i < files.length; ++i) {\n        var f = files[i];\n        wzh(out, f.o, f, f.f, f.u, f.c.length);\n        var badd = 30 + f.f.length + exfl(f.extra);\n        out.set(f.c, f.o + badd);\n        wzh(out, o, f, f.f, f.u, f.c.length, f.o, f.m), o += 16 + badd + (f.m ? f.m.length : 0);\n    }\n    wzf(out, o, files.length, cdl, oe);\n    return out;\n}\n/**\n * Streaming pass-through decompression for ZIP archives\n */\nvar UnzipPassThrough = /*#__PURE__*/ (function () {\n    function UnzipPassThrough() {\n    }\n    UnzipPassThrough.prototype.push = function (data, final) {\n        this.ondata(null, data, final);\n    };\n    UnzipPassThrough.compression = 0;\n    return UnzipPassThrough;\n}());\nexport { UnzipPassThrough };\n/**\n * Streaming DEFLATE decompression for ZIP archives. Prefer AsyncZipInflate for\n * better performance.\n */\nvar UnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function UnzipInflate() {\n        var _this_1 = this;\n        this.i = new Inflate(function (dat, final) {\n            _this_1.ondata(null, dat, final);\n        });\n    }\n    UnzipInflate.prototype.push = function (data, final) {\n        try {\n            this.i.push(data, final);\n        }\n        catch (e) {\n            this.ondata(e, data, final);\n        }\n    };\n    UnzipInflate.compression = 8;\n    return UnzipInflate;\n}());\nexport { UnzipInflate };\n/**\n * Asynchronous streaming DEFLATE decompression for ZIP archives\n */\nvar AsyncUnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function AsyncUnzipInflate(_, sz) {\n        var _this_1 = this;\n        if (sz < 320000) {\n            this.i = new Inflate(function (dat, final) {\n                _this_1.ondata(null, dat, final);\n            });\n        }\n        else {\n            this.i = new AsyncInflate(function (err, dat, final) {\n                _this_1.ondata(err, dat, final);\n            });\n            this.terminate = this.i.terminate;\n        }\n    }\n    AsyncUnzipInflate.prototype.push = function (data, final) {\n        if (this.i.terminate)\n            data = slc(data, 0);\n        this.i.push(data, final);\n    };\n    AsyncUnzipInflate.compression = 8;\n    return AsyncUnzipInflate;\n}());\nexport { AsyncUnzipInflate };\n/**\n * A ZIP archive decompression stream that emits files as they are discovered\n */\nvar Unzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates a ZIP decompression stream\n     * @param cb The callback to call whenever a file in the ZIP archive is found\n     */\n    function Unzip(cb) {\n        this.onfile = cb;\n        this.k = [];\n        this.o = {\n            0: UnzipPassThrough\n        };\n        this.p = et;\n    }\n    /**\n     * Pushes a chunk to be unzipped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzip.prototype.push = function (chunk, final) {\n        var _this_1 = this;\n        if (!this.onfile)\n            throw 'no callback';\n        if (!this.p)\n            throw 'stream finished';\n        if (this.c > 0) {\n            var len = Math.min(this.c, chunk.length);\n            var toAdd = chunk.subarray(0, len);\n            this.c -= len;\n            if (this.d)\n                this.d.push(toAdd, !this.c);\n            else\n                this.k[0].push(toAdd);\n            chunk = chunk.subarray(len);\n            if (chunk.length)\n                return this.push(chunk, final);\n        }\n        else {\n            var f = 0, i = 0, is = void 0, buf = void 0;\n            if (!this.p.length)\n                buf = chunk;\n            else if (!chunk.length)\n                buf = this.p;\n            else {\n                buf = new u8(this.p.length + chunk.length);\n                buf.set(this.p), buf.set(chunk, this.p.length);\n            }\n            var l = buf.length, oc = this.c, add = oc && this.d;\n            var _loop_2 = function () {\n                var _a;\n                var sig = b4(buf, i);\n                if (sig == 0x4034B50) {\n                    f = 1, is = i;\n                    this_1.d = null;\n                    this_1.c = 0;\n                    var bf = b2(buf, i + 6), cmp_1 = b2(buf, i + 8), u = bf & 2048, dd = bf & 8, fnl = b2(buf, i + 26), es = b2(buf, i + 28);\n                    if (l > i + 30 + fnl + es) {\n                        var chks_2 = [];\n                        this_1.k.unshift(chks_2);\n                        f = 2;\n                        var sc_1 = b4(buf, i + 18), su_1 = b4(buf, i + 22);\n                        var fn_1 = strFromU8(buf.subarray(i + 30, i += 30 + fnl), !u);\n                        if (sc_1 == 4294967295) {\n                            _a = dd ? [-2] : z64e(buf, i), sc_1 = _a[0], su_1 = _a[1];\n                        }\n                        else if (dd)\n                            sc_1 = -1;\n                        i += es;\n                        this_1.c = sc_1;\n                        var d_1;\n                        var file_1 = {\n                            name: fn_1,\n                            compression: cmp_1,\n                            start: function () {\n                                if (!file_1.ondata)\n                                    throw 'no callback';\n                                if (!sc_1)\n                                    file_1.ondata(null, et, true);\n                                else {\n                                    var ctr = _this_1.o[cmp_1];\n                                    if (!ctr)\n                                        throw 'unknown compression type ' + cmp_1;\n                                    d_1 = sc_1 < 0 ? new ctr(fn_1) : new ctr(fn_1, sc_1, su_1);\n                                    d_1.ondata = function (err, dat, final) { file_1.ondata(err, dat, final); };\n                                    for (var _i = 0, chks_3 = chks_2; _i < chks_3.length; _i++) {\n                                        var dat = chks_3[_i];\n                                        d_1.push(dat, false);\n                                    }\n                                    if (_this_1.k[0] == chks_2 && _this_1.c)\n                                        _this_1.d = d_1;\n                                    else\n                                        d_1.push(et, true);\n                                }\n                            },\n                            terminate: function () {\n                                if (d_1 && d_1.terminate)\n                                    d_1.terminate();\n                            }\n                        };\n                        if (sc_1 >= 0)\n                            file_1.size = sc_1, file_1.originalSize = su_1;\n                        this_1.onfile(file_1);\n                    }\n                    return \"break\";\n                }\n                else if (oc) {\n                    if (sig == 0x8074B50) {\n                        is = i += 12 + (oc == -2 && 8), f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                    else if (sig == 0x2014B50) {\n                        is = i -= 4, f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                }\n            };\n            var this_1 = this;\n            for (; i < l - 4; ++i) {\n                var state_1 = _loop_2();\n                if (state_1 === \"break\")\n                    break;\n            }\n            this.p = et;\n            if (oc < 0) {\n                var dat = f ? buf.subarray(0, is - 12 - (oc == -2 && 8) - (b4(buf, is - 16) == 0x8074B50 && 4)) : buf.subarray(0, i);\n                if (add)\n                    add.push(dat, !!f);\n                else\n                    this.k[+(f == 2)].push(dat);\n            }\n            if (f & 2)\n                return this.push(buf.subarray(i), final);\n            this.p = buf.subarray(i);\n        }\n        if (final) {\n            if (this.c)\n                throw 'invalid zip file';\n            this.p = null;\n        }\n    };\n    /**\n     * Registers a decoder with the stream, allowing for files compressed with\n     * the compression type provided to be expanded correctly\n     * @param decoder The decoder constructor\n     */\n    Unzip.prototype.register = function (decoder) {\n        this.o[decoder.compression] = decoder;\n    };\n    return Unzip;\n}());\nexport { Unzip };\n/**\n * Asynchronously decompresses a ZIP archive\n * @param data The raw compressed ZIP file\n * @param cb The callback to call with the decompressed files\n * @returns A function that can be used to immediately terminate the unzipping\n */\nexport function unzip(data, cb) {\n    if (typeof cb != 'function')\n        throw 'no callback';\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var files = {};\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558) {\n            cb('invalid zip file', null);\n            return;\n        }\n    }\n    ;\n    var lft = b2(data, e + 8);\n    if (!lft)\n        cb(null, {});\n    var c = lft;\n    var o = b4(data, e + 16);\n    var z = o == 4294967295;\n    if (z) {\n        e = b4(data, e - 12);\n        if (b4(data, e) != 0x6064B50) {\n            cb('invalid zip file', null);\n            return;\n        }\n        c = lft = b4(data, e + 32);\n        o = b4(data, e + 48);\n    }\n    var _loop_3 = function (i) {\n        var _a = zh(data, o, z), c_1 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n        o = no;\n        var cbl = function (e, d) {\n            if (e) {\n                tAll();\n                cb(e, null);\n            }\n            else {\n                files[fn] = d;\n                if (!--lft)\n                    cb(null, files);\n            }\n        };\n        if (!c_1)\n            cbl(null, slc(data, b, b + sc));\n        else if (c_1 == 8) {\n            var infl = data.subarray(b, b + sc);\n            if (sc < 320000) {\n                try {\n                    cbl(null, inflateSync(infl, new u8(su)));\n                }\n                catch (e) {\n                    cbl(e, null);\n                }\n            }\n            else\n                term.push(inflate(infl, { size: su }, cbl));\n        }\n        else\n            cbl('unknown compression type ' + c_1, null);\n    };\n    for (var i = 0; i < c; ++i) {\n        _loop_3(i);\n    }\n    return tAll;\n}\n/**\n * Synchronously decompresses a ZIP archive. Prefer using `unzip` for better\n * performance with more than one file.\n * @param data The raw compressed ZIP file\n * @returns The decompressed files\n */\nexport function unzipSync(data) {\n    var files = {};\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558)\n            throw 'invalid zip file';\n    }\n    ;\n    var c = b2(data, e + 8);\n    if (!c)\n        return {};\n    var o = b4(data, e + 16);\n    var z = o == 4294967295;\n    if (z) {\n        e = b4(data, e - 12);\n        if (b4(data, e) != 0x6064B50)\n            throw 'invalid zip file';\n        c = b4(data, e + 32);\n        o = b4(data, e + 48);\n    }\n    for (var i = 0; i < c; ++i) {\n        var _a = zh(data, o, z), c_2 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n        o = no;\n        if (!c_2)\n            files[fn] = slc(data, b, b + sc);\n        else if (c_2 == 8)\n            files[fn] = inflateSync(data.subarray(b, b + sc), new u8(su));\n        else\n            throw 'unknown compression type ' + c_2;\n    }\n    return files;\n}\n","import {\n\tVector3,\n\tVector4\n} from 'three';\n\n/**\n * NURBS utils\n *\n * See NURBSCurve and NURBSSurface.\n **/\n\n\n/**************************************************************\n *\tNURBS Utils\n **************************************************************/\n\n/*\nFinds knot vector span.\n\np : degree\nu : parametric value\nU : knot vector\n\nreturns the span\n*/\nfunction findSpan( p, u, U ) {\n\n\tconst n = U.length - p - 1;\n\n\tif ( u >= U[ n ] ) {\n\n\t\treturn n - 1;\n\n\t}\n\n\tif ( u <= U[ p ] ) {\n\n\t\treturn p;\n\n\t}\n\n\tlet low = p;\n\tlet high = n;\n\tlet mid = Math.floor( ( low + high ) / 2 );\n\n\twhile ( u < U[ mid ] || u >= U[ mid + 1 ] ) {\n\n\t\tif ( u < U[ mid ] ) {\n\n\t\t\thigh = mid;\n\n\t\t} else {\n\n\t\t\tlow = mid;\n\n\t\t}\n\n\t\tmid = Math.floor( ( low + high ) / 2 );\n\n\t}\n\n\treturn mid;\n\n}\n\n\n/*\nCalculate basis functions. See The NURBS Book, page 70, algorithm A2.2\n\nspan : span in which u lies\nu    : parametric point\np    : degree\nU    : knot vector\n\nreturns array[p+1] with basis functions values.\n*/\nfunction calcBasisFunctions( span, u, p, U ) {\n\n\tconst N = [];\n\tconst left = [];\n\tconst right = [];\n\tN[ 0 ] = 1.0;\n\n\tfor ( let j = 1; j <= p; ++ j ) {\n\n\t\tleft[ j ] = u - U[ span + 1 - j ];\n\t\tright[ j ] = U[ span + j ] - u;\n\n\t\tlet saved = 0.0;\n\n\t\tfor ( let r = 0; r < j; ++ r ) {\n\n\t\t\tconst rv = right[ r + 1 ];\n\t\t\tconst lv = left[ j - r ];\n\t\t\tconst temp = N[ r ] / ( rv + lv );\n\t\t\tN[ r ] = saved + rv * temp;\n\t\t\tsaved = lv * temp;\n\n\t\t}\n\n\t\tN[ j ] = saved;\n\n\t}\n\n\treturn N;\n\n}\n\n\n/*\nCalculate B-Spline curve points. See The NURBS Book, page 82, algorithm A3.1.\n\np : degree of B-Spline\nU : knot vector\nP : control points (x, y, z, w)\nu : parametric point\n\nreturns point for given u\n*/\nfunction calcBSplinePoint( p, U, P, u ) {\n\n\tconst span = findSpan( p, u, U );\n\tconst N = calcBasisFunctions( span, u, p, U );\n\tconst C = new Vector4( 0, 0, 0, 0 );\n\n\tfor ( let j = 0; j <= p; ++ j ) {\n\n\t\tconst point = P[ span - p + j ];\n\t\tconst Nj = N[ j ];\n\t\tconst wNj = point.w * Nj;\n\t\tC.x += point.x * wNj;\n\t\tC.y += point.y * wNj;\n\t\tC.z += point.z * wNj;\n\t\tC.w += point.w * Nj;\n\n\t}\n\n\treturn C;\n\n}\n\n\n/*\nCalculate basis functions derivatives. See The NURBS Book, page 72, algorithm A2.3.\n\nspan : span in which u lies\nu    : parametric point\np    : degree\nn    : number of derivatives to calculate\nU    : knot vector\n\nreturns array[n+1][p+1] with basis functions derivatives\n*/\nfunction calcBasisFunctionDerivatives( span, u, p, n, U ) {\n\n\tconst zeroArr = [];\n\tfor ( let i = 0; i <= p; ++ i )\n\t\tzeroArr[ i ] = 0.0;\n\n\tconst ders = [];\n\n\tfor ( let i = 0; i <= n; ++ i )\n\t\tders[ i ] = zeroArr.slice( 0 );\n\n\tconst ndu = [];\n\n\tfor ( let i = 0; i <= p; ++ i )\n\t\tndu[ i ] = zeroArr.slice( 0 );\n\n\tndu[ 0 ][ 0 ] = 1.0;\n\n\tconst left = zeroArr.slice( 0 );\n\tconst right = zeroArr.slice( 0 );\n\n\tfor ( let j = 1; j <= p; ++ j ) {\n\n\t\tleft[ j ] = u - U[ span + 1 - j ];\n\t\tright[ j ] = U[ span + j ] - u;\n\n\t\tlet saved = 0.0;\n\n\t\tfor ( let r = 0; r < j; ++ r ) {\n\n\t\t\tconst rv = right[ r + 1 ];\n\t\t\tconst lv = left[ j - r ];\n\t\t\tndu[ j ][ r ] = rv + lv;\n\n\t\t\tconst temp = ndu[ r ][ j - 1 ] / ndu[ j ][ r ];\n\t\t\tndu[ r ][ j ] = saved + rv * temp;\n\t\t\tsaved = lv * temp;\n\n\t\t}\n\n\t\tndu[ j ][ j ] = saved;\n\n\t}\n\n\tfor ( let j = 0; j <= p; ++ j ) {\n\n\t\tders[ 0 ][ j ] = ndu[ j ][ p ];\n\n\t}\n\n\tfor ( let r = 0; r <= p; ++ r ) {\n\n\t\tlet s1 = 0;\n\t\tlet s2 = 1;\n\n\t\tconst a = [];\n\t\tfor ( let i = 0; i <= p; ++ i ) {\n\n\t\t\ta[ i ] = zeroArr.slice( 0 );\n\n\t\t}\n\n\t\ta[ 0 ][ 0 ] = 1.0;\n\n\t\tfor ( let k = 1; k <= n; ++ k ) {\n\n\t\t\tlet d = 0.0;\n\t\t\tconst rk = r - k;\n\t\t\tconst pk = p - k;\n\n\t\t\tif ( r >= k ) {\n\n\t\t\t\ta[ s2 ][ 0 ] = a[ s1 ][ 0 ] / ndu[ pk + 1 ][ rk ];\n\t\t\t\td = a[ s2 ][ 0 ] * ndu[ rk ][ pk ];\n\n\t\t\t}\n\n\t\t\tconst j1 = ( rk >= - 1 ) ? 1 : - rk;\n\t\t\tconst j2 = ( r - 1 <= pk ) ? k - 1 : p - r;\n\n\t\t\tfor ( let j = j1; j <= j2; ++ j ) {\n\n\t\t\t\ta[ s2 ][ j ] = ( a[ s1 ][ j ] - a[ s1 ][ j - 1 ] ) / ndu[ pk + 1 ][ rk + j ];\n\t\t\t\td += a[ s2 ][ j ] * ndu[ rk + j ][ pk ];\n\n\t\t\t}\n\n\t\t\tif ( r <= pk ) {\n\n\t\t\t\ta[ s2 ][ k ] = - a[ s1 ][ k - 1 ] / ndu[ pk + 1 ][ r ];\n\t\t\t\td += a[ s2 ][ k ] * ndu[ r ][ pk ];\n\n\t\t\t}\n\n\t\t\tders[ k ][ r ] = d;\n\n\t\t\tconst j = s1;\n\t\t\ts1 = s2;\n\t\t\ts2 = j;\n\n\t\t}\n\n\t}\n\n\tlet r = p;\n\n\tfor ( let k = 1; k <= n; ++ k ) {\n\n\t\tfor ( let j = 0; j <= p; ++ j ) {\n\n\t\t\tders[ k ][ j ] *= r;\n\n\t\t}\n\n\t\tr *= p - k;\n\n\t}\n\n\treturn ders;\n\n}\n\n\n/*\n\tCalculate derivatives of a B-Spline. See The NURBS Book, page 93, algorithm A3.2.\n\n\tp  : degree\n\tU  : knot vector\n\tP  : control points\n\tu  : Parametric points\n\tnd : number of derivatives\n\n\treturns array[d+1] with derivatives\n\t*/\nfunction calcBSplineDerivatives( p, U, P, u, nd ) {\n\n\tconst du = nd < p ? nd : p;\n\tconst CK = [];\n\tconst span = findSpan( p, u, U );\n\tconst nders = calcBasisFunctionDerivatives( span, u, p, du, U );\n\tconst Pw = [];\n\n\tfor ( let i = 0; i < P.length; ++ i ) {\n\n\t\tconst point = P[ i ].clone();\n\t\tconst w = point.w;\n\n\t\tpoint.x *= w;\n\t\tpoint.y *= w;\n\t\tpoint.z *= w;\n\n\t\tPw[ i ] = point;\n\n\t}\n\n\tfor ( let k = 0; k <= du; ++ k ) {\n\n\t\tconst point = Pw[ span - p ].clone().multiplyScalar( nders[ k ][ 0 ] );\n\n\t\tfor ( let j = 1; j <= p; ++ j ) {\n\n\t\t\tpoint.add( Pw[ span - p + j ].clone().multiplyScalar( nders[ k ][ j ] ) );\n\n\t\t}\n\n\t\tCK[ k ] = point;\n\n\t}\n\n\tfor ( let k = du + 1; k <= nd + 1; ++ k ) {\n\n\t\tCK[ k ] = new Vector4( 0, 0, 0 );\n\n\t}\n\n\treturn CK;\n\n}\n\n\n/*\nCalculate \"K over I\"\n\nreturns k!/(i!(k-i)!)\n*/\nfunction calcKoverI( k, i ) {\n\n\tlet nom = 1;\n\n\tfor ( let j = 2; j <= k; ++ j ) {\n\n\t\tnom *= j;\n\n\t}\n\n\tlet denom = 1;\n\n\tfor ( let j = 2; j <= i; ++ j ) {\n\n\t\tdenom *= j;\n\n\t}\n\n\tfor ( let j = 2; j <= k - i; ++ j ) {\n\n\t\tdenom *= j;\n\n\t}\n\n\treturn nom / denom;\n\n}\n\n\n/*\nCalculate derivatives (0-nd) of rational curve. See The NURBS Book, page 127, algorithm A4.2.\n\nPders : result of function calcBSplineDerivatives\n\nreturns array with derivatives for rational curve.\n*/\nfunction calcRationalCurveDerivatives( Pders ) {\n\n\tconst nd = Pders.length;\n\tconst Aders = [];\n\tconst wders = [];\n\n\tfor ( let i = 0; i < nd; ++ i ) {\n\n\t\tconst point = Pders[ i ];\n\t\tAders[ i ] = new Vector3( point.x, point.y, point.z );\n\t\twders[ i ] = point.w;\n\n\t}\n\n\tconst CK = [];\n\n\tfor ( let k = 0; k < nd; ++ k ) {\n\n\t\tconst v = Aders[ k ].clone();\n\n\t\tfor ( let i = 1; i <= k; ++ i ) {\n\n\t\t\tv.sub( CK[ k - i ].clone().multiplyScalar( calcKoverI( k, i ) * wders[ i ] ) );\n\n\t\t}\n\n\t\tCK[ k ] = v.divideScalar( wders[ 0 ] );\n\n\t}\n\n\treturn CK;\n\n}\n\n\n/*\nCalculate NURBS curve derivatives. See The NURBS Book, page 127, algorithm A4.2.\n\np  : degree\nU  : knot vector\nP  : control points in homogeneous space\nu  : parametric points\nnd : number of derivatives\n\nreturns array with derivatives.\n*/\nfunction calcNURBSDerivatives( p, U, P, u, nd ) {\n\n\tconst Pders = calcBSplineDerivatives( p, U, P, u, nd );\n\treturn calcRationalCurveDerivatives( Pders );\n\n}\n\n\n/*\nCalculate rational B-Spline surface point. See The NURBS Book, page 134, algorithm A4.3.\n\np1, p2 : degrees of B-Spline surface\nU1, U2 : knot vectors\nP      : control points (x, y, z, w)\nu, v   : parametric values\n\nreturns point for given (u, v)\n*/\nfunction calcSurfacePoint( p, q, U, V, P, u, v, target ) {\n\n\tconst uspan = findSpan( p, u, U );\n\tconst vspan = findSpan( q, v, V );\n\tconst Nu = calcBasisFunctions( uspan, u, p, U );\n\tconst Nv = calcBasisFunctions( vspan, v, q, V );\n\tconst temp = [];\n\n\tfor ( let l = 0; l <= q; ++ l ) {\n\n\t\ttemp[ l ] = new Vector4( 0, 0, 0, 0 );\n\t\tfor ( let k = 0; k <= p; ++ k ) {\n\n\t\t\tconst point = P[ uspan - p + k ][ vspan - q + l ].clone();\n\t\t\tconst w = point.w;\n\t\t\tpoint.x *= w;\n\t\t\tpoint.y *= w;\n\t\t\tpoint.z *= w;\n\t\t\ttemp[ l ].add( point.multiplyScalar( Nu[ k ] ) );\n\n\t\t}\n\n\t}\n\n\tconst Sw = new Vector4( 0, 0, 0, 0 );\n\tfor ( let l = 0; l <= q; ++ l ) {\n\n\t\tSw.add( temp[ l ].multiplyScalar( Nv[ l ] ) );\n\n\t}\n\n\tSw.divideScalar( Sw.w );\n\ttarget.set( Sw.x, Sw.y, Sw.z );\n\n}\n\n\n\nexport {\n\tfindSpan,\n\tcalcBasisFunctions,\n\tcalcBSplinePoint,\n\tcalcBasisFunctionDerivatives,\n\tcalcBSplineDerivatives,\n\tcalcKoverI,\n\tcalcRationalCurveDerivatives,\n\tcalcNURBSDerivatives,\n\tcalcSurfacePoint,\n};\n","import {\n\tCurve,\n\tVector3,\n\tVector4\n} from 'three';\nimport * as NURBSUtils from '../curves/NURBSUtils.js';\n\n/**\n * NURBS curve object\n *\n * Derives from Curve, overriding getPoint and getTangent.\n *\n * Implementation is based on (x, y [, z=0 [, w=1]]) control points with w=weight.\n *\n **/\n\nclass NURBSCurve extends Curve {\n\n\tconstructor(\n\t\tdegree,\n\t\tknots /* array of reals */,\n\t\tcontrolPoints /* array of Vector(2|3|4) */,\n\t\tstartKnot /* index in knots */,\n\t\tendKnot /* index in knots */\n\t) {\n\n\t\tsuper();\n\n\t\tthis.degree = degree;\n\t\tthis.knots = knots;\n\t\tthis.controlPoints = [];\n\t\t// Used by periodic NURBS to remove hidden spans\n\t\tthis.startKnot = startKnot || 0;\n\t\tthis.endKnot = endKnot || ( this.knots.length - 1 );\n\n\t\tfor ( let i = 0; i < controlPoints.length; ++ i ) {\n\n\t\t\t// ensure Vector4 for control points\n\t\t\tconst point = controlPoints[ i ];\n\t\t\tthis.controlPoints[ i ] = new Vector4( point.x, point.y, point.z, point.w );\n\n\t\t}\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector3() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst u = this.knots[ this.startKnot ] + t * ( this.knots[ this.endKnot ] - this.knots[ this.startKnot ] ); // linear mapping t->u\n\n\t\t// following results in (wx, wy, wz, w) homogeneous point\n\t\tconst hpoint = NURBSUtils.calcBSplinePoint( this.degree, this.knots, this.controlPoints, u );\n\n\t\tif ( hpoint.w !== 1.0 ) {\n\n\t\t\t// project to 3D space: (wx, wy, wz, w) -> (x, y, z, 1)\n\t\t\thpoint.divideScalar( hpoint.w );\n\n\t\t}\n\n\t\treturn point.set( hpoint.x, hpoint.y, hpoint.z );\n\n\t}\n\n\tgetTangent( t, optionalTarget = new Vector3() ) {\n\n\t\tconst tangent = optionalTarget;\n\n\t\tconst u = this.knots[ 0 ] + t * ( this.knots[ this.knots.length - 1 ] - this.knots[ 0 ] );\n\t\tconst ders = NURBSUtils.calcNURBSDerivatives( this.degree, this.knots, this.controlPoints, u, 1 );\n\t\ttangent.copy( ders[ 1 ] ).normalize();\n\n\t\treturn tangent;\n\n\t}\n\n}\n\nexport { NURBSCurve };\n","import {\n\tAmbientLight,\n\tAnimationClip,\n\tBone,\n\tBufferGeometry,\n\tClampToEdgeWrapping,\n\tColor,\n\tDirectionalLight,\n\tEquirectangularReflectionMapping,\n\tEuler,\n\tFileLoader,\n\tFloat32BufferAttribute,\n\tGroup,\n\tLine,\n\tLineBasicMaterial,\n\tLoader,\n\tLoaderUtils,\n\tMathUtils,\n\tMatrix3,\n\tMatrix4,\n\tMesh,\n\tMeshLambertMaterial,\n\tMeshPhongMaterial,\n\tNumberKeyframeTrack,\n\tObject3D,\n\tOrthographicCamera,\n\tPerspectiveCamera,\n\tPointLight,\n\tPropertyBinding,\n\tQuaternion,\n\tQuaternionKeyframeTrack,\n\tRepeatWrapping,\n\tSkeleton,\n\tSkinnedMesh,\n\tSpotLight,\n\tTexture,\n\tTextureLoader,\n\tUint16BufferAttribute,\n\tVector3,\n\tVector4,\n\tVectorKeyframeTrack,\n\tsRGBEncoding\n} from 'three';\nimport * as fflate from '../libs/fflate.module.js';\nimport { NURBSCurve } from '../curves/NURBSCurve.js';\n\n/**\n * Loader loads FBX file and generates Group representing FBX scene.\n * Requires FBX file to be >= 7.0 and in ASCII or >= 6400 in Binary format\n * Versions lower than this may load but will probably have errors\n *\n * Needs Support:\n *  Morph normals / blend shape normals\n *\n * FBX format references:\n * \thttps://help.autodesk.com/view/FBX/2017/ENU/?guid=__cpp_ref_index_html (C++ SDK reference)\n *\n * Binary format specification:\n *\thttps://code.blender.org/2013/08/fbx-binary-file-format-specification/\n */\n\n\nlet fbxTree;\nlet connections;\nlet sceneGraph;\n\nclass FBXLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst path = ( scope.path === '' ) ? LoaderUtils.extractUrlBase( url ) : scope.path;\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( scope.path );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setRequestHeader( scope.requestHeader );\n\t\tloader.setWithCredentials( scope.withCredentials );\n\n\t\tloader.load( url, function ( buffer ) {\n\n\t\t\ttry {\n\n\t\t\t\tonLoad( scope.parse( buffer, path ) );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tparse( FBXBuffer, path ) {\n\n\t\tif ( isFbxFormatBinary( FBXBuffer ) ) {\n\n\t\t\tfbxTree = new BinaryParser().parse( FBXBuffer );\n\n\t\t} else {\n\n\t\t\tconst FBXText = convertArrayBufferToString( FBXBuffer );\n\n\t\t\tif ( ! isFbxFormatASCII( FBXText ) ) {\n\n\t\t\t\tthrow new Error( 'THREE.FBXLoader: Unknown format.' );\n\n\t\t\t}\n\n\t\t\tif ( getFbxVersion( FBXText ) < 7000 ) {\n\n\t\t\t\tthrow new Error( 'THREE.FBXLoader: FBX version not supported, FileVersion: ' + getFbxVersion( FBXText ) );\n\n\t\t\t}\n\n\t\t\tfbxTree = new TextParser().parse( FBXText );\n\n\t\t}\n\n\t\t// console.log( fbxTree );\n\n\t\tconst textureLoader = new TextureLoader( this.manager ).setPath( this.resourcePath || path ).setCrossOrigin( this.crossOrigin );\n\n\t\treturn new FBXTreeParser( textureLoader, this.manager ).parse( fbxTree );\n\n\t}\n\n}\n\n// Parse the FBXTree object returned by the BinaryParser or TextParser and return a Group\nclass FBXTreeParser {\n\n\tconstructor( textureLoader, manager ) {\n\n\t\tthis.textureLoader = textureLoader;\n\t\tthis.manager = manager;\n\n\t}\n\n\tparse() {\n\n\t\tconnections = this.parseConnections();\n\n\t\tconst images = this.parseImages();\n\t\tconst textures = this.parseTextures( images );\n\t\tconst materials = this.parseMaterials( textures );\n\t\tconst deformers = this.parseDeformers();\n\t\tconst geometryMap = new GeometryParser().parse( deformers );\n\n\t\tthis.parseScene( deformers, geometryMap, materials );\n\n\t\treturn sceneGraph;\n\n\t}\n\n\t// Parses FBXTree.Connections which holds parent-child connections between objects (e.g. material -> texture, model->geometry )\n\t// and details the connection type\n\tparseConnections() {\n\n\t\tconst connectionMap = new Map();\n\n\t\tif ( 'Connections' in fbxTree ) {\n\n\t\t\tconst rawConnections = fbxTree.Connections.connections;\n\n\t\t\trawConnections.forEach( function ( rawConnection ) {\n\n\t\t\t\tconst fromID = rawConnection[ 0 ];\n\t\t\t\tconst toID = rawConnection[ 1 ];\n\t\t\t\tconst relationship = rawConnection[ 2 ];\n\n\t\t\t\tif ( ! connectionMap.has( fromID ) ) {\n\n\t\t\t\t\tconnectionMap.set( fromID, {\n\t\t\t\t\t\tparents: [],\n\t\t\t\t\t\tchildren: []\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t\tconst parentRelationship = { ID: toID, relationship: relationship };\n\t\t\t\tconnectionMap.get( fromID ).parents.push( parentRelationship );\n\n\t\t\t\tif ( ! connectionMap.has( toID ) ) {\n\n\t\t\t\t\tconnectionMap.set( toID, {\n\t\t\t\t\t\tparents: [],\n\t\t\t\t\t\tchildren: []\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t\tconst childRelationship = { ID: fromID, relationship: relationship };\n\t\t\t\tconnectionMap.get( toID ).children.push( childRelationship );\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn connectionMap;\n\n\t}\n\n\t// Parse FBXTree.Objects.Video for embedded image data\n\t// These images are connected to textures in FBXTree.Objects.Textures\n\t// via FBXTree.Connections.\n\tparseImages() {\n\n\t\tconst images = {};\n\t\tconst blobs = {};\n\n\t\tif ( 'Video' in fbxTree.Objects ) {\n\n\t\t\tconst videoNodes = fbxTree.Objects.Video;\n\n\t\t\tfor ( const nodeID in videoNodes ) {\n\n\t\t\t\tconst videoNode = videoNodes[ nodeID ];\n\n\t\t\t\tconst id = parseInt( nodeID );\n\n\t\t\t\timages[ id ] = videoNode.RelativeFilename || videoNode.Filename;\n\n\t\t\t\t// raw image data is in videoNode.Content\n\t\t\t\tif ( 'Content' in videoNode ) {\n\n\t\t\t\t\tconst arrayBufferContent = ( videoNode.Content instanceof ArrayBuffer ) && ( videoNode.Content.byteLength > 0 );\n\t\t\t\t\tconst base64Content = ( typeof videoNode.Content === 'string' ) && ( videoNode.Content !== '' );\n\n\t\t\t\t\tif ( arrayBufferContent || base64Content ) {\n\n\t\t\t\t\t\tconst image = this.parseImage( videoNodes[ nodeID ] );\n\n\t\t\t\t\t\tblobs[ videoNode.RelativeFilename || videoNode.Filename ] = image;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( const id in images ) {\n\n\t\t\tconst filename = images[ id ];\n\n\t\t\tif ( blobs[ filename ] !== undefined ) images[ id ] = blobs[ filename ];\n\t\t\telse images[ id ] = images[ id ].split( '\\\\' ).pop();\n\n\t\t}\n\n\t\treturn images;\n\n\t}\n\n\t// Parse embedded image data in FBXTree.Video.Content\n\tparseImage( videoNode ) {\n\n\t\tconst content = videoNode.Content;\n\t\tconst fileName = videoNode.RelativeFilename || videoNode.Filename;\n\t\tconst extension = fileName.slice( fileName.lastIndexOf( '.' ) + 1 ).toLowerCase();\n\n\t\tlet type;\n\n\t\tswitch ( extension ) {\n\n\t\t\tcase 'bmp':\n\n\t\t\t\ttype = 'image/bmp';\n\t\t\t\tbreak;\n\n\t\t\tcase 'jpg':\n\t\t\tcase 'jpeg':\n\n\t\t\t\ttype = 'image/jpeg';\n\t\t\t\tbreak;\n\n\t\t\tcase 'png':\n\n\t\t\t\ttype = 'image/png';\n\t\t\t\tbreak;\n\n\t\t\tcase 'tif':\n\n\t\t\t\ttype = 'image/tiff';\n\t\t\t\tbreak;\n\n\t\t\tcase 'tga':\n\n\t\t\t\tif ( this.manager.getHandler( '.tga' ) === null ) {\n\n\t\t\t\t\tconsole.warn( 'FBXLoader: TGA loader not found, skipping ', fileName );\n\n\t\t\t\t}\n\n\t\t\t\ttype = 'image/tga';\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tconsole.warn( 'FBXLoader: Image type \"' + extension + '\" is not supported.' );\n\t\t\t\treturn;\n\n\t\t}\n\n\t\tif ( typeof content === 'string' ) { // ASCII format\n\n\t\t\treturn 'data:' + type + ';base64,' + content;\n\n\t\t} else { // Binary Format\n\n\t\t\tconst array = new Uint8Array( content );\n\t\t\treturn window.URL.createObjectURL( new Blob( [ array ], { type: type } ) );\n\n\t\t}\n\n\t}\n\n\t// Parse nodes in FBXTree.Objects.Texture\n\t// These contain details such as UV scaling, cropping, rotation etc and are connected\n\t// to images in FBXTree.Objects.Video\n\tparseTextures( images ) {\n\n\t\tconst textureMap = new Map();\n\n\t\tif ( 'Texture' in fbxTree.Objects ) {\n\n\t\t\tconst textureNodes = fbxTree.Objects.Texture;\n\t\t\tfor ( const nodeID in textureNodes ) {\n\n\t\t\t\tconst texture = this.parseTexture( textureNodes[ nodeID ], images );\n\t\t\t\ttextureMap.set( parseInt( nodeID ), texture );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn textureMap;\n\n\t}\n\n\t// Parse individual node in FBXTree.Objects.Texture\n\tparseTexture( textureNode, images ) {\n\n\t\tconst texture = this.loadTexture( textureNode, images );\n\n\t\ttexture.ID = textureNode.id;\n\n\t\ttexture.name = textureNode.attrName;\n\n\t\tconst wrapModeU = textureNode.WrapModeU;\n\t\tconst wrapModeV = textureNode.WrapModeV;\n\n\t\tconst valueU = wrapModeU !== undefined ? wrapModeU.value : 0;\n\t\tconst valueV = wrapModeV !== undefined ? wrapModeV.value : 0;\n\n\t\t// http://download.autodesk.com/us/fbx/SDKdocs/FBX_SDK_Help/files/fbxsdkref/class_k_fbx_texture.html#889640e63e2e681259ea81061b85143a\n\t\t// 0: repeat(default), 1: clamp\n\n\t\ttexture.wrapS = valueU === 0 ? RepeatWrapping : ClampToEdgeWrapping;\n\t\ttexture.wrapT = valueV === 0 ? RepeatWrapping : ClampToEdgeWrapping;\n\n\t\tif ( 'Scaling' in textureNode ) {\n\n\t\t\tconst values = textureNode.Scaling.value;\n\n\t\t\ttexture.repeat.x = values[ 0 ];\n\t\t\ttexture.repeat.y = values[ 1 ];\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n\t// load a texture specified as a blob or data URI, or via an external URL using TextureLoader\n\tloadTexture( textureNode, images ) {\n\n\t\tlet fileName;\n\n\t\tconst currentPath = this.textureLoader.path;\n\n\t\tconst children = connections.get( textureNode.id ).children;\n\n\t\tif ( children !== undefined && children.length > 0 && images[ children[ 0 ].ID ] !== undefined ) {\n\n\t\t\tfileName = images[ children[ 0 ].ID ];\n\n\t\t\tif ( fileName.indexOf( 'blob:' ) === 0 || fileName.indexOf( 'data:' ) === 0 ) {\n\n\t\t\t\tthis.textureLoader.setPath( undefined );\n\n\t\t\t}\n\n\t\t}\n\n\t\tlet texture;\n\n\t\tconst extension = textureNode.FileName.slice( - 3 ).toLowerCase();\n\n\t\tif ( extension === 'tga' ) {\n\n\t\t\tconst loader = this.manager.getHandler( '.tga' );\n\n\t\t\tif ( loader === null ) {\n\n\t\t\t\tconsole.warn( 'FBXLoader: TGA loader not found, creating placeholder texture for', textureNode.RelativeFilename );\n\t\t\t\ttexture = new Texture();\n\n\t\t\t} else {\n\n\t\t\t\tloader.setPath( this.textureLoader.path );\n\t\t\t\ttexture = loader.load( fileName );\n\n\t\t\t}\n\n\t\t} else if ( extension === 'psd' ) {\n\n\t\t\tconsole.warn( 'FBXLoader: PSD textures are not supported, creating placeholder texture for', textureNode.RelativeFilename );\n\t\t\ttexture = new Texture();\n\n\t\t} else {\n\n\t\t\ttexture = this.textureLoader.load( fileName );\n\n\t\t}\n\n\t\tthis.textureLoader.setPath( currentPath );\n\n\t\treturn texture;\n\n\t}\n\n\t// Parse nodes in FBXTree.Objects.Material\n\tparseMaterials( textureMap ) {\n\n\t\tconst materialMap = new Map();\n\n\t\tif ( 'Material' in fbxTree.Objects ) {\n\n\t\t\tconst materialNodes = fbxTree.Objects.Material;\n\n\t\t\tfor ( const nodeID in materialNodes ) {\n\n\t\t\t\tconst material = this.parseMaterial( materialNodes[ nodeID ], textureMap );\n\n\t\t\t\tif ( material !== null ) materialMap.set( parseInt( nodeID ), material );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn materialMap;\n\n\t}\n\n\t// Parse single node in FBXTree.Objects.Material\n\t// Materials are connected to texture maps in FBXTree.Objects.Textures\n\t// FBX format currently only supports Lambert and Phong shading models\n\tparseMaterial( materialNode, textureMap ) {\n\n\t\tconst ID = materialNode.id;\n\t\tconst name = materialNode.attrName;\n\t\tlet type = materialNode.ShadingModel;\n\n\t\t// Case where FBX wraps shading model in property object.\n\t\tif ( typeof type === 'object' ) {\n\n\t\t\ttype = type.value;\n\n\t\t}\n\n\t\t// Ignore unused materials which don't have any connections.\n\t\tif ( ! connections.has( ID ) ) return null;\n\n\t\tconst parameters = this.parseParameters( materialNode, textureMap, ID );\n\n\t\tlet material;\n\n\t\tswitch ( type.toLowerCase() ) {\n\n\t\t\tcase 'phong':\n\t\t\t\tmaterial = new MeshPhongMaterial();\n\t\t\t\tbreak;\n\t\t\tcase 'lambert':\n\t\t\t\tmaterial = new MeshLambertMaterial();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tconsole.warn( 'THREE.FBXLoader: unknown material type \"%s\". Defaulting to MeshPhongMaterial.', type );\n\t\t\t\tmaterial = new MeshPhongMaterial();\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tmaterial.setValues( parameters );\n\t\tmaterial.name = name;\n\n\t\treturn material;\n\n\t}\n\n\t// Parse FBX material and return parameters suitable for a three.js material\n\t// Also parse the texture map and return any textures associated with the material\n\tparseParameters( materialNode, textureMap, ID ) {\n\n\t\tconst parameters = {};\n\n\t\tif ( materialNode.BumpFactor ) {\n\n\t\t\tparameters.bumpScale = materialNode.BumpFactor.value;\n\n\t\t}\n\n\t\tif ( materialNode.Diffuse ) {\n\n\t\t\tparameters.color = new Color().fromArray( materialNode.Diffuse.value );\n\n\t\t} else if ( materialNode.DiffuseColor && ( materialNode.DiffuseColor.type === 'Color' || materialNode.DiffuseColor.type === 'ColorRGB' ) ) {\n\n\t\t\t// The blender exporter exports diffuse here instead of in materialNode.Diffuse\n\t\t\tparameters.color = new Color().fromArray( materialNode.DiffuseColor.value );\n\n\t\t}\n\n\t\tif ( materialNode.DisplacementFactor ) {\n\n\t\t\tparameters.displacementScale = materialNode.DisplacementFactor.value;\n\n\t\t}\n\n\t\tif ( materialNode.Emissive ) {\n\n\t\t\tparameters.emissive = new Color().fromArray( materialNode.Emissive.value );\n\n\t\t} else if ( materialNode.EmissiveColor && ( materialNode.EmissiveColor.type === 'Color' || materialNode.EmissiveColor.type === 'ColorRGB' ) ) {\n\n\t\t\t// The blender exporter exports emissive color here instead of in materialNode.Emissive\n\t\t\tparameters.emissive = new Color().fromArray( materialNode.EmissiveColor.value );\n\n\t\t}\n\n\t\tif ( materialNode.EmissiveFactor ) {\n\n\t\t\tparameters.emissiveIntensity = parseFloat( materialNode.EmissiveFactor.value );\n\n\t\t}\n\n\t\tif ( materialNode.Opacity ) {\n\n\t\t\tparameters.opacity = parseFloat( materialNode.Opacity.value );\n\n\t\t}\n\n\t\tif ( parameters.opacity < 1.0 ) {\n\n\t\t\tparameters.transparent = true;\n\n\t\t}\n\n\t\tif ( materialNode.ReflectionFactor ) {\n\n\t\t\tparameters.reflectivity = materialNode.ReflectionFactor.value;\n\n\t\t}\n\n\t\tif ( materialNode.Shininess ) {\n\n\t\t\tparameters.shininess = materialNode.Shininess.value;\n\n\t\t}\n\n\t\tif ( materialNode.Specular ) {\n\n\t\t\tparameters.specular = new Color().fromArray( materialNode.Specular.value );\n\n\t\t} else if ( materialNode.SpecularColor && materialNode.SpecularColor.type === 'Color' ) {\n\n\t\t\t// The blender exporter exports specular color here instead of in materialNode.Specular\n\t\t\tparameters.specular = new Color().fromArray( materialNode.SpecularColor.value );\n\n\t\t}\n\n\t\tconst scope = this;\n\t\tconnections.get( ID ).children.forEach( function ( child ) {\n\n\t\t\tconst type = child.relationship;\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 'Bump':\n\t\t\t\t\tparameters.bumpMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'Maya|TEX_ao_map':\n\t\t\t\t\tparameters.aoMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'DiffuseColor':\n\t\t\t\tcase 'Maya|TEX_color_map':\n\t\t\t\t\tparameters.map = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tif ( parameters.map !== undefined ) {\n\n\t\t\t\t\t\tparameters.map.encoding = sRGBEncoding;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'DisplacementColor':\n\t\t\t\t\tparameters.displacementMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'EmissiveColor':\n\t\t\t\t\tparameters.emissiveMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tif ( parameters.emissiveMap !== undefined ) {\n\n\t\t\t\t\t\tparameters.emissiveMap.encoding = sRGBEncoding;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'NormalMap':\n\t\t\t\tcase 'Maya|TEX_normal_map':\n\t\t\t\t\tparameters.normalMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'ReflectionColor':\n\t\t\t\t\tparameters.envMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tif ( parameters.envMap !== undefined ) {\n\n\t\t\t\t\t\tparameters.envMap.mapping = EquirectangularReflectionMapping;\n\t\t\t\t\t\tparameters.envMap.encoding = sRGBEncoding;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'SpecularColor':\n\t\t\t\t\tparameters.specularMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tif ( parameters.specularMap !== undefined ) {\n\n\t\t\t\t\t\tparameters.specularMap.encoding = sRGBEncoding;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'TransparentColor':\n\t\t\t\tcase 'TransparencyFactor':\n\t\t\t\t\tparameters.alphaMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tparameters.transparent = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'AmbientColor':\n\t\t\t\tcase 'ShininessExponent': // AKA glossiness map\n\t\t\t\tcase 'SpecularFactor': // AKA specularLevel\n\t\t\t\tcase 'VectorDisplacementColor': // NOTE: Seems to be a copy of DisplacementColor\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: %s map is not supported in three.js, skipping texture.', type );\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn parameters;\n\n\t}\n\n\t// get a texture from the textureMap for use by a material.\n\tgetTexture( textureMap, id ) {\n\n\t\t// if the texture is a layered texture, just use the first layer and issue a warning\n\t\tif ( 'LayeredTexture' in fbxTree.Objects && id in fbxTree.Objects.LayeredTexture ) {\n\n\t\t\tconsole.warn( 'THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer.' );\n\t\t\tid = connections.get( id ).children[ 0 ].ID;\n\n\t\t}\n\n\t\treturn textureMap.get( id );\n\n\t}\n\n\t// Parse nodes in FBXTree.Objects.Deformer\n\t// Deformer node can contain skinning or Vertex Cache animation data, however only skinning is supported here\n\t// Generates map of Skeleton-like objects for use later when generating and binding skeletons.\n\tparseDeformers() {\n\n\t\tconst skeletons = {};\n\t\tconst morphTargets = {};\n\n\t\tif ( 'Deformer' in fbxTree.Objects ) {\n\n\t\t\tconst DeformerNodes = fbxTree.Objects.Deformer;\n\n\t\t\tfor ( const nodeID in DeformerNodes ) {\n\n\t\t\t\tconst deformerNode = DeformerNodes[ nodeID ];\n\n\t\t\t\tconst relationships = connections.get( parseInt( nodeID ) );\n\n\t\t\t\tif ( deformerNode.attrType === 'Skin' ) {\n\n\t\t\t\t\tconst skeleton = this.parseSkeleton( relationships, DeformerNodes );\n\t\t\t\t\tskeleton.ID = nodeID;\n\n\t\t\t\t\tif ( relationships.parents.length > 1 ) console.warn( 'THREE.FBXLoader: skeleton attached to more than one geometry is not supported.' );\n\t\t\t\t\tskeleton.geometryID = relationships.parents[ 0 ].ID;\n\n\t\t\t\t\tskeletons[ nodeID ] = skeleton;\n\n\t\t\t\t} else if ( deformerNode.attrType === 'BlendShape' ) {\n\n\t\t\t\t\tconst morphTarget = {\n\t\t\t\t\t\tid: nodeID,\n\t\t\t\t\t};\n\n\t\t\t\t\tmorphTarget.rawTargets = this.parseMorphTargets( relationships, DeformerNodes );\n\t\t\t\t\tmorphTarget.id = nodeID;\n\n\t\t\t\t\tif ( relationships.parents.length > 1 ) console.warn( 'THREE.FBXLoader: morph target attached to more than one geometry is not supported.' );\n\n\t\t\t\t\tmorphTargets[ nodeID ] = morphTarget;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn {\n\n\t\t\tskeletons: skeletons,\n\t\t\tmorphTargets: morphTargets,\n\n\t\t};\n\n\t}\n\n\t// Parse single nodes in FBXTree.Objects.Deformer\n\t// The top level skeleton node has type 'Skin' and sub nodes have type 'Cluster'\n\t// Each skin node represents a skeleton and each cluster node represents a bone\n\tparseSkeleton( relationships, deformerNodes ) {\n\n\t\tconst rawBones = [];\n\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tconst boneNode = deformerNodes[ child.ID ];\n\n\t\t\tif ( boneNode.attrType !== 'Cluster' ) return;\n\n\t\t\tconst rawBone = {\n\n\t\t\t\tID: child.ID,\n\t\t\t\tindices: [],\n\t\t\t\tweights: [],\n\t\t\t\ttransformLink: new Matrix4().fromArray( boneNode.TransformLink.a ),\n\t\t\t\t// transform: new Matrix4().fromArray( boneNode.Transform.a ),\n\t\t\t\t// linkMode: boneNode.Mode,\n\n\t\t\t};\n\n\t\t\tif ( 'Indexes' in boneNode ) {\n\n\t\t\t\trawBone.indices = boneNode.Indexes.a;\n\t\t\t\trawBone.weights = boneNode.Weights.a;\n\n\t\t\t}\n\n\t\t\trawBones.push( rawBone );\n\n\t\t} );\n\n\t\treturn {\n\n\t\t\trawBones: rawBones,\n\t\t\tbones: []\n\n\t\t};\n\n\t}\n\n\t// The top level morph deformer node has type \"BlendShape\" and sub nodes have type \"BlendShapeChannel\"\n\tparseMorphTargets( relationships, deformerNodes ) {\n\n\t\tconst rawMorphTargets = [];\n\n\t\tfor ( let i = 0; i < relationships.children.length; i ++ ) {\n\n\t\t\tconst child = relationships.children[ i ];\n\n\t\t\tconst morphTargetNode = deformerNodes[ child.ID ];\n\n\t\t\tconst rawMorphTarget = {\n\n\t\t\t\tname: morphTargetNode.attrName,\n\t\t\t\tinitialWeight: morphTargetNode.DeformPercent,\n\t\t\t\tid: morphTargetNode.id,\n\t\t\t\tfullWeights: morphTargetNode.FullWeights.a\n\n\t\t\t};\n\n\t\t\tif ( morphTargetNode.attrType !== 'BlendShapeChannel' ) return;\n\n\t\t\trawMorphTarget.geoID = connections.get( parseInt( child.ID ) ).children.filter( function ( child ) {\n\n\t\t\t\treturn child.relationship === undefined;\n\n\t\t\t} )[ 0 ].ID;\n\n\t\t\trawMorphTargets.push( rawMorphTarget );\n\n\t\t}\n\n\t\treturn rawMorphTargets;\n\n\t}\n\n\t// create the main Group() to be returned by the loader\n\tparseScene( deformers, geometryMap, materialMap ) {\n\n\t\tsceneGraph = new Group();\n\n\t\tconst modelMap = this.parseModels( deformers.skeletons, geometryMap, materialMap );\n\n\t\tconst modelNodes = fbxTree.Objects.Model;\n\n\t\tconst scope = this;\n\t\tmodelMap.forEach( function ( model ) {\n\n\t\t\tconst modelNode = modelNodes[ model.ID ];\n\t\t\tscope.setLookAtProperties( model, modelNode );\n\n\t\t\tconst parentConnections = connections.get( model.ID ).parents;\n\n\t\t\tparentConnections.forEach( function ( connection ) {\n\n\t\t\t\tconst parent = modelMap.get( connection.ID );\n\t\t\t\tif ( parent !== undefined ) parent.add( model );\n\n\t\t\t} );\n\n\t\t\tif ( model.parent === null ) {\n\n\t\t\t\tsceneGraph.add( model );\n\n\t\t\t}\n\n\n\t\t} );\n\n\t\tthis.bindSkeleton( deformers.skeletons, geometryMap, modelMap );\n\n\t\tthis.createAmbientLight();\n\n\t\tsceneGraph.traverse( function ( node ) {\n\n\t\t\tif ( node.userData.transformData ) {\n\n\t\t\t\tif ( node.parent ) {\n\n\t\t\t\t\tnode.userData.transformData.parentMatrix = node.parent.matrix;\n\t\t\t\t\tnode.userData.transformData.parentMatrixWorld = node.parent.matrixWorld;\n\n\t\t\t\t}\n\n\t\t\t\tconst transform = generateTransform( node.userData.transformData );\n\n\t\t\t\tnode.applyMatrix4( transform );\n\t\t\t\tnode.updateWorldMatrix();\n\n\t\t\t}\n\n\t\t} );\n\n\t\tconst animations = new AnimationParser().parse();\n\n\t\t// if all the models where already combined in a single group, just return that\n\t\tif ( sceneGraph.children.length === 1 && sceneGraph.children[ 0 ].isGroup ) {\n\n\t\t\tsceneGraph.children[ 0 ].animations = animations;\n\t\t\tsceneGraph = sceneGraph.children[ 0 ];\n\n\t\t}\n\n\t\tsceneGraph.animations = animations;\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.Model\n\tparseModels( skeletons, geometryMap, materialMap ) {\n\n\t\tconst modelMap = new Map();\n\t\tconst modelNodes = fbxTree.Objects.Model;\n\n\t\tfor ( const nodeID in modelNodes ) {\n\n\t\t\tconst id = parseInt( nodeID );\n\t\t\tconst node = modelNodes[ nodeID ];\n\t\t\tconst relationships = connections.get( id );\n\n\t\t\tlet model = this.buildSkeleton( relationships, skeletons, id, node.attrName );\n\n\t\t\tif ( ! model ) {\n\n\t\t\t\tswitch ( node.attrType ) {\n\n\t\t\t\t\tcase 'Camera':\n\t\t\t\t\t\tmodel = this.createCamera( relationships );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Light':\n\t\t\t\t\t\tmodel = this.createLight( relationships );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Mesh':\n\t\t\t\t\t\tmodel = this.createMesh( relationships, geometryMap, materialMap );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'NurbsCurve':\n\t\t\t\t\t\tmodel = this.createCurve( relationships, geometryMap );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'LimbNode':\n\t\t\t\t\tcase 'Root':\n\t\t\t\t\t\tmodel = new Bone();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Null':\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tmodel = new Group();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tmodel.name = node.attrName ? PropertyBinding.sanitizeNodeName( node.attrName ) : '';\n\n\t\t\t\tmodel.ID = id;\n\n\t\t\t}\n\n\t\t\tthis.getTransformData( model, node );\n\t\t\tmodelMap.set( id, model );\n\n\t\t}\n\n\t\treturn modelMap;\n\n\t}\n\n\tbuildSkeleton( relationships, skeletons, id, name ) {\n\n\t\tlet bone = null;\n\n\t\trelationships.parents.forEach( function ( parent ) {\n\n\t\t\tfor ( const ID in skeletons ) {\n\n\t\t\t\tconst skeleton = skeletons[ ID ];\n\n\t\t\t\tskeleton.rawBones.forEach( function ( rawBone, i ) {\n\n\t\t\t\t\tif ( rawBone.ID === parent.ID ) {\n\n\t\t\t\t\t\tconst subBone = bone;\n\t\t\t\t\t\tbone = new Bone();\n\n\t\t\t\t\t\tbone.matrixWorld.copy( rawBone.transformLink );\n\n\t\t\t\t\t\t// set name and id here - otherwise in cases where \"subBone\" is created it will not have a name / id\n\n\t\t\t\t\t\tbone.name = name ? PropertyBinding.sanitizeNodeName( name ) : '';\n\t\t\t\t\t\tbone.ID = id;\n\n\t\t\t\t\t\tskeleton.bones[ i ] = bone;\n\n\t\t\t\t\t\t// In cases where a bone is shared between multiple meshes\n\t\t\t\t\t\t// duplicate the bone here and and it as a child of the first bone\n\t\t\t\t\t\tif ( subBone !== null ) {\n\n\t\t\t\t\t\t\tbone.add( subBone );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn bone;\n\n\t}\n\n\t// create a PerspectiveCamera or OrthographicCamera\n\tcreateCamera( relationships ) {\n\n\t\tlet model;\n\t\tlet cameraAttribute;\n\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tconst attr = fbxTree.Objects.NodeAttribute[ child.ID ];\n\n\t\t\tif ( attr !== undefined ) {\n\n\t\t\t\tcameraAttribute = attr;\n\n\t\t\t}\n\n\t\t} );\n\n\t\tif ( cameraAttribute === undefined ) {\n\n\t\t\tmodel = new Object3D();\n\n\t\t} else {\n\n\t\t\tlet type = 0;\n\t\t\tif ( cameraAttribute.CameraProjectionType !== undefined && cameraAttribute.CameraProjectionType.value === 1 ) {\n\n\t\t\t\ttype = 1;\n\n\t\t\t}\n\n\t\t\tlet nearClippingPlane = 1;\n\t\t\tif ( cameraAttribute.NearPlane !== undefined ) {\n\n\t\t\t\tnearClippingPlane = cameraAttribute.NearPlane.value / 1000;\n\n\t\t\t}\n\n\t\t\tlet farClippingPlane = 1000;\n\t\t\tif ( cameraAttribute.FarPlane !== undefined ) {\n\n\t\t\t\tfarClippingPlane = cameraAttribute.FarPlane.value / 1000;\n\n\t\t\t}\n\n\n\t\t\tlet width = window.innerWidth;\n\t\t\tlet height = window.innerHeight;\n\n\t\t\tif ( cameraAttribute.AspectWidth !== undefined && cameraAttribute.AspectHeight !== undefined ) {\n\n\t\t\t\twidth = cameraAttribute.AspectWidth.value;\n\t\t\t\theight = cameraAttribute.AspectHeight.value;\n\n\t\t\t}\n\n\t\t\tconst aspect = width / height;\n\n\t\t\tlet fov = 45;\n\t\t\tif ( cameraAttribute.FieldOfView !== undefined ) {\n\n\t\t\t\tfov = cameraAttribute.FieldOfView.value;\n\n\t\t\t}\n\n\t\t\tconst focalLength = cameraAttribute.FocalLength ? cameraAttribute.FocalLength.value : null;\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 0: // Perspective\n\t\t\t\t\tmodel = new PerspectiveCamera( fov, aspect, nearClippingPlane, farClippingPlane );\n\t\t\t\t\tif ( focalLength !== null ) model.setFocalLength( focalLength );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 1: // Orthographic\n\t\t\t\t\tmodel = new OrthographicCamera( - width / 2, width / 2, height / 2, - height / 2, nearClippingPlane, farClippingPlane );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: Unknown camera type ' + type + '.' );\n\t\t\t\t\tmodel = new Object3D();\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn model;\n\n\t}\n\n\t// Create a DirectionalLight, PointLight or SpotLight\n\tcreateLight( relationships ) {\n\n\t\tlet model;\n\t\tlet lightAttribute;\n\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tconst attr = fbxTree.Objects.NodeAttribute[ child.ID ];\n\n\t\t\tif ( attr !== undefined ) {\n\n\t\t\t\tlightAttribute = attr;\n\n\t\t\t}\n\n\t\t} );\n\n\t\tif ( lightAttribute === undefined ) {\n\n\t\t\tmodel = new Object3D();\n\n\t\t} else {\n\n\t\t\tlet type;\n\n\t\t\t// LightType can be undefined for Point lights\n\t\t\tif ( lightAttribute.LightType === undefined ) {\n\n\t\t\t\ttype = 0;\n\n\t\t\t} else {\n\n\t\t\t\ttype = lightAttribute.LightType.value;\n\n\t\t\t}\n\n\t\t\tlet color = 0xffffff;\n\n\t\t\tif ( lightAttribute.Color !== undefined ) {\n\n\t\t\t\tcolor = new Color().fromArray( lightAttribute.Color.value );\n\n\t\t\t}\n\n\t\t\tlet intensity = ( lightAttribute.Intensity === undefined ) ? 1 : lightAttribute.Intensity.value / 100;\n\n\t\t\t// light disabled\n\t\t\tif ( lightAttribute.CastLightOnObject !== undefined && lightAttribute.CastLightOnObject.value === 0 ) {\n\n\t\t\t\tintensity = 0;\n\n\t\t\t}\n\n\t\t\tlet distance = 0;\n\t\t\tif ( lightAttribute.FarAttenuationEnd !== undefined ) {\n\n\t\t\t\tif ( lightAttribute.EnableFarAttenuation !== undefined && lightAttribute.EnableFarAttenuation.value === 0 ) {\n\n\t\t\t\t\tdistance = 0;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tdistance = lightAttribute.FarAttenuationEnd.value;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// TODO: could this be calculated linearly from FarAttenuationStart to FarAttenuationEnd?\n\t\t\tconst decay = 1;\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 0: // Point\n\t\t\t\t\tmodel = new PointLight( color, intensity, distance, decay );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 1: // Directional\n\t\t\t\t\tmodel = new DirectionalLight( color, intensity );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 2: // Spot\n\t\t\t\t\tlet angle = Math.PI / 3;\n\n\t\t\t\t\tif ( lightAttribute.InnerAngle !== undefined ) {\n\n\t\t\t\t\t\tangle = MathUtils.degToRad( lightAttribute.InnerAngle.value );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tlet penumbra = 0;\n\t\t\t\t\tif ( lightAttribute.OuterAngle !== undefined ) {\n\n\t\t\t\t\t\t// TODO: this is not correct - FBX calculates outer and inner angle in degrees\n\t\t\t\t\t\t// with OuterAngle > InnerAngle && OuterAngle <= Math.PI\n\t\t\t\t\t\t// while three.js uses a penumbra between (0, 1) to attenuate the inner angle\n\t\t\t\t\t\tpenumbra = MathUtils.degToRad( lightAttribute.OuterAngle.value );\n\t\t\t\t\t\tpenumbra = Math.max( penumbra, 1 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tmodel = new SpotLight( color, intensity, distance, angle, penumbra, decay );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: Unknown light type ' + lightAttribute.LightType.value + ', defaulting to a PointLight.' );\n\t\t\t\t\tmodel = new PointLight( color, intensity );\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tif ( lightAttribute.CastShadows !== undefined && lightAttribute.CastShadows.value === 1 ) {\n\n\t\t\t\tmodel.castShadow = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn model;\n\n\t}\n\n\tcreateMesh( relationships, geometryMap, materialMap ) {\n\n\t\tlet model;\n\t\tlet geometry = null;\n\t\tlet material = null;\n\t\tconst materials = [];\n\n\t\t// get geometry and materials(s) from connections\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tif ( geometryMap.has( child.ID ) ) {\n\n\t\t\t\tgeometry = geometryMap.get( child.ID );\n\n\t\t\t}\n\n\t\t\tif ( materialMap.has( child.ID ) ) {\n\n\t\t\t\tmaterials.push( materialMap.get( child.ID ) );\n\n\t\t\t}\n\n\t\t} );\n\n\t\tif ( materials.length > 1 ) {\n\n\t\t\tmaterial = materials;\n\n\t\t} else if ( materials.length > 0 ) {\n\n\t\t\tmaterial = materials[ 0 ];\n\n\t\t} else {\n\n\t\t\tmaterial = new MeshPhongMaterial( { color: 0xcccccc } );\n\t\t\tmaterials.push( material );\n\n\t\t}\n\n\t\tif ( 'color' in geometry.attributes ) {\n\n\t\t\tmaterials.forEach( function ( material ) {\n\n\t\t\t\tmaterial.vertexColors = true;\n\n\t\t\t} );\n\n\t\t}\n\n\t\tif ( geometry.FBX_Deformer ) {\n\n\t\t\tmodel = new SkinnedMesh( geometry, material );\n\t\t\tmodel.normalizeSkinWeights();\n\n\t\t} else {\n\n\t\t\tmodel = new Mesh( geometry, material );\n\n\t\t}\n\n\t\treturn model;\n\n\t}\n\n\tcreateCurve( relationships, geometryMap ) {\n\n\t\tconst geometry = relationships.children.reduce( function ( geo, child ) {\n\n\t\t\tif ( geometryMap.has( child.ID ) ) geo = geometryMap.get( child.ID );\n\n\t\t\treturn geo;\n\n\t\t}, null );\n\n\t\t// FBX does not list materials for Nurbs lines, so we'll just put our own in here.\n\t\tconst material = new LineBasicMaterial( { color: 0x3300ff, linewidth: 1 } );\n\t\treturn new Line( geometry, material );\n\n\t}\n\n\t// parse the model node for transform data\n\tgetTransformData( model, modelNode ) {\n\n\t\tconst transformData = {};\n\n\t\tif ( 'InheritType' in modelNode ) transformData.inheritType = parseInt( modelNode.InheritType.value );\n\n\t\tif ( 'RotationOrder' in modelNode ) transformData.eulerOrder = getEulerOrder( modelNode.RotationOrder.value );\n\t\telse transformData.eulerOrder = 'ZYX';\n\n\t\tif ( 'Lcl_Translation' in modelNode ) transformData.translation = modelNode.Lcl_Translation.value;\n\n\t\tif ( 'PreRotation' in modelNode ) transformData.preRotation = modelNode.PreRotation.value;\n\t\tif ( 'Lcl_Rotation' in modelNode ) transformData.rotation = modelNode.Lcl_Rotation.value;\n\t\tif ( 'PostRotation' in modelNode ) transformData.postRotation = modelNode.PostRotation.value;\n\n\t\tif ( 'Lcl_Scaling' in modelNode ) transformData.scale = modelNode.Lcl_Scaling.value;\n\n\t\tif ( 'ScalingOffset' in modelNode ) transformData.scalingOffset = modelNode.ScalingOffset.value;\n\t\tif ( 'ScalingPivot' in modelNode ) transformData.scalingPivot = modelNode.ScalingPivot.value;\n\n\t\tif ( 'RotationOffset' in modelNode ) transformData.rotationOffset = modelNode.RotationOffset.value;\n\t\tif ( 'RotationPivot' in modelNode ) transformData.rotationPivot = modelNode.RotationPivot.value;\n\n\t\tmodel.userData.transformData = transformData;\n\n\t}\n\n\tsetLookAtProperties( model, modelNode ) {\n\n\t\tif ( 'LookAtProperty' in modelNode ) {\n\n\t\t\tconst children = connections.get( model.ID ).children;\n\n\t\t\tchildren.forEach( function ( child ) {\n\n\t\t\t\tif ( child.relationship === 'LookAtProperty' ) {\n\n\t\t\t\t\tconst lookAtTarget = fbxTree.Objects.Model[ child.ID ];\n\n\t\t\t\t\tif ( 'Lcl_Translation' in lookAtTarget ) {\n\n\t\t\t\t\t\tconst pos = lookAtTarget.Lcl_Translation.value;\n\n\t\t\t\t\t\t// DirectionalLight, SpotLight\n\t\t\t\t\t\tif ( model.target !== undefined ) {\n\n\t\t\t\t\t\t\tmodel.target.position.fromArray( pos );\n\t\t\t\t\t\t\tsceneGraph.add( model.target );\n\n\t\t\t\t\t\t} else { // Cameras and other Object3Ds\n\n\t\t\t\t\t\t\tmodel.lookAt( new Vector3().fromArray( pos ) );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t}\n\n\t}\n\n\tbindSkeleton( skeletons, geometryMap, modelMap ) {\n\n\t\tconst bindMatrices = this.parsePoseNodes();\n\n\t\tfor ( const ID in skeletons ) {\n\n\t\t\tconst skeleton = skeletons[ ID ];\n\n\t\t\tconst parents = connections.get( parseInt( skeleton.ID ) ).parents;\n\n\t\t\tparents.forEach( function ( parent ) {\n\n\t\t\t\tif ( geometryMap.has( parent.ID ) ) {\n\n\t\t\t\t\tconst geoID = parent.ID;\n\t\t\t\t\tconst geoRelationships = connections.get( geoID );\n\n\t\t\t\t\tgeoRelationships.parents.forEach( function ( geoConnParent ) {\n\n\t\t\t\t\t\tif ( modelMap.has( geoConnParent.ID ) ) {\n\n\t\t\t\t\t\t\tconst model = modelMap.get( geoConnParent.ID );\n\n\t\t\t\t\t\t\tmodel.bind( new Skeleton( skeleton.bones ), bindMatrices[ geoConnParent.ID ] );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t}\n\n\t}\n\n\tparsePoseNodes() {\n\n\t\tconst bindMatrices = {};\n\n\t\tif ( 'Pose' in fbxTree.Objects ) {\n\n\t\t\tconst BindPoseNode = fbxTree.Objects.Pose;\n\n\t\t\tfor ( const nodeID in BindPoseNode ) {\n\n\t\t\t\tif ( BindPoseNode[ nodeID ].attrType === 'BindPose' && BindPoseNode[ nodeID ].NbPoseNodes > 0 ) {\n\n\t\t\t\t\tconst poseNodes = BindPoseNode[ nodeID ].PoseNode;\n\n\t\t\t\t\tif ( Array.isArray( poseNodes ) ) {\n\n\t\t\t\t\t\tposeNodes.forEach( function ( poseNode ) {\n\n\t\t\t\t\t\t\tbindMatrices[ poseNode.Node ] = new Matrix4().fromArray( poseNode.Matrix.a );\n\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tbindMatrices[ poseNodes.Node ] = new Matrix4().fromArray( poseNodes.Matrix.a );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn bindMatrices;\n\n\t}\n\n\t// Parse ambient color in FBXTree.GlobalSettings - if it's not set to black (default), create an ambient light\n\tcreateAmbientLight() {\n\n\t\tif ( 'GlobalSettings' in fbxTree && 'AmbientColor' in fbxTree.GlobalSettings ) {\n\n\t\t\tconst ambientColor = fbxTree.GlobalSettings.AmbientColor.value;\n\t\t\tconst r = ambientColor[ 0 ];\n\t\t\tconst g = ambientColor[ 1 ];\n\t\t\tconst b = ambientColor[ 2 ];\n\n\t\t\tif ( r !== 0 || g !== 0 || b !== 0 ) {\n\n\t\t\t\tconst color = new Color( r, g, b );\n\t\t\t\tsceneGraph.add( new AmbientLight( color, 1 ) );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\n// parse Geometry data from FBXTree and return map of BufferGeometries\nclass GeometryParser {\n\n\t// Parse nodes in FBXTree.Objects.Geometry\n\tparse( deformers ) {\n\n\t\tconst geometryMap = new Map();\n\n\t\tif ( 'Geometry' in fbxTree.Objects ) {\n\n\t\t\tconst geoNodes = fbxTree.Objects.Geometry;\n\n\t\t\tfor ( const nodeID in geoNodes ) {\n\n\t\t\t\tconst relationships = connections.get( parseInt( nodeID ) );\n\t\t\t\tconst geo = this.parseGeometry( relationships, geoNodes[ nodeID ], deformers );\n\n\t\t\t\tgeometryMap.set( parseInt( nodeID ), geo );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn geometryMap;\n\n\t}\n\n\t// Parse single node in FBXTree.Objects.Geometry\n\tparseGeometry( relationships, geoNode, deformers ) {\n\n\t\tswitch ( geoNode.attrType ) {\n\n\t\t\tcase 'Mesh':\n\t\t\t\treturn this.parseMeshGeometry( relationships, geoNode, deformers );\n\t\t\t\tbreak;\n\n\t\t\tcase 'NurbsCurve':\n\t\t\t\treturn this.parseNurbsGeometry( geoNode );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\t// Parse single node mesh geometry in FBXTree.Objects.Geometry\n\tparseMeshGeometry( relationships, geoNode, deformers ) {\n\n\t\tconst skeletons = deformers.skeletons;\n\t\tconst morphTargets = [];\n\n\t\tconst modelNodes = relationships.parents.map( function ( parent ) {\n\n\t\t\treturn fbxTree.Objects.Model[ parent.ID ];\n\n\t\t} );\n\n\t\t// don't create geometry if it is not associated with any models\n\t\tif ( modelNodes.length === 0 ) return;\n\n\t\tconst skeleton = relationships.children.reduce( function ( skeleton, child ) {\n\n\t\t\tif ( skeletons[ child.ID ] !== undefined ) skeleton = skeletons[ child.ID ];\n\n\t\t\treturn skeleton;\n\n\t\t}, null );\n\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tif ( deformers.morphTargets[ child.ID ] !== undefined ) {\n\n\t\t\t\tmorphTargets.push( deformers.morphTargets[ child.ID ] );\n\n\t\t\t}\n\n\t\t} );\n\n\t\t// Assume one model and get the preRotation from that\n\t\t// if there is more than one model associated with the geometry this may cause problems\n\t\tconst modelNode = modelNodes[ 0 ];\n\n\t\tconst transformData = {};\n\n\t\tif ( 'RotationOrder' in modelNode ) transformData.eulerOrder = getEulerOrder( modelNode.RotationOrder.value );\n\t\tif ( 'InheritType' in modelNode ) transformData.inheritType = parseInt( modelNode.InheritType.value );\n\n\t\tif ( 'GeometricTranslation' in modelNode ) transformData.translation = modelNode.GeometricTranslation.value;\n\t\tif ( 'GeometricRotation' in modelNode ) transformData.rotation = modelNode.GeometricRotation.value;\n\t\tif ( 'GeometricScaling' in modelNode ) transformData.scale = modelNode.GeometricScaling.value;\n\n\t\tconst transform = generateTransform( transformData );\n\n\t\treturn this.genGeometry( geoNode, skeleton, morphTargets, transform );\n\n\t}\n\n\t// Generate a BufferGeometry from a node in FBXTree.Objects.Geometry\n\tgenGeometry( geoNode, skeleton, morphTargets, preTransform ) {\n\n\t\tconst geo = new BufferGeometry();\n\t\tif ( geoNode.attrName ) geo.name = geoNode.attrName;\n\n\t\tconst geoInfo = this.parseGeoNode( geoNode, skeleton );\n\t\tconst buffers = this.genBuffers( geoInfo );\n\n\t\tconst positionAttribute = new Float32BufferAttribute( buffers.vertex, 3 );\n\n\t\tpositionAttribute.applyMatrix4( preTransform );\n\n\t\tgeo.setAttribute( 'position', positionAttribute );\n\n\t\tif ( buffers.colors.length > 0 ) {\n\n\t\t\tgeo.setAttribute( 'color', new Float32BufferAttribute( buffers.colors, 3 ) );\n\n\t\t}\n\n\t\tif ( skeleton ) {\n\n\t\t\tgeo.setAttribute( 'skinIndex', new Uint16BufferAttribute( buffers.weightsIndices, 4 ) );\n\n\t\t\tgeo.setAttribute( 'skinWeight', new Float32BufferAttribute( buffers.vertexWeights, 4 ) );\n\n\t\t\t// used later to bind the skeleton to the model\n\t\t\tgeo.FBX_Deformer = skeleton;\n\n\t\t}\n\n\t\tif ( buffers.normal.length > 0 ) {\n\n\t\t\tconst normalMatrix = new Matrix3().getNormalMatrix( preTransform );\n\n\t\t\tconst normalAttribute = new Float32BufferAttribute( buffers.normal, 3 );\n\t\t\tnormalAttribute.applyNormalMatrix( normalMatrix );\n\n\t\t\tgeo.setAttribute( 'normal', normalAttribute );\n\n\t\t}\n\n\t\tbuffers.uvs.forEach( function ( uvBuffer, i ) {\n\n\t\t\t// subsequent uv buffers are called 'uv1', 'uv2', ...\n\t\t\tlet name = 'uv' + ( i + 1 ).toString();\n\n\t\t\t// the first uv buffer is just called 'uv'\n\t\t\tif ( i === 0 ) {\n\n\t\t\t\tname = 'uv';\n\n\t\t\t}\n\n\t\t\tgeo.setAttribute( name, new Float32BufferAttribute( buffers.uvs[ i ], 2 ) );\n\n\t\t} );\n\n\t\tif ( geoInfo.material && geoInfo.material.mappingType !== 'AllSame' ) {\n\n\t\t\t// Convert the material indices of each vertex into rendering groups on the geometry.\n\t\t\tlet prevMaterialIndex = buffers.materialIndex[ 0 ];\n\t\t\tlet startIndex = 0;\n\n\t\t\tbuffers.materialIndex.forEach( function ( currentIndex, i ) {\n\n\t\t\t\tif ( currentIndex !== prevMaterialIndex ) {\n\n\t\t\t\t\tgeo.addGroup( startIndex, i - startIndex, prevMaterialIndex );\n\n\t\t\t\t\tprevMaterialIndex = currentIndex;\n\t\t\t\t\tstartIndex = i;\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\t// the loop above doesn't add the last group, do that here.\n\t\t\tif ( geo.groups.length > 0 ) {\n\n\t\t\t\tconst lastGroup = geo.groups[ geo.groups.length - 1 ];\n\t\t\t\tconst lastIndex = lastGroup.start + lastGroup.count;\n\n\t\t\t\tif ( lastIndex !== buffers.materialIndex.length ) {\n\n\t\t\t\t\tgeo.addGroup( lastIndex, buffers.materialIndex.length - lastIndex, prevMaterialIndex );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// case where there are multiple materials but the whole geometry is only\n\t\t\t// using one of them\n\t\t\tif ( geo.groups.length === 0 ) {\n\n\t\t\t\tgeo.addGroup( 0, buffers.materialIndex.length, buffers.materialIndex[ 0 ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.addMorphTargets( geo, geoNode, morphTargets, preTransform );\n\n\t\treturn geo;\n\n\t}\n\n\tparseGeoNode( geoNode, skeleton ) {\n\n\t\tconst geoInfo = {};\n\n\t\tgeoInfo.vertexPositions = ( geoNode.Vertices !== undefined ) ? geoNode.Vertices.a : [];\n\t\tgeoInfo.vertexIndices = ( geoNode.PolygonVertexIndex !== undefined ) ? geoNode.PolygonVertexIndex.a : [];\n\n\t\tif ( geoNode.LayerElementColor ) {\n\n\t\t\tgeoInfo.color = this.parseVertexColors( geoNode.LayerElementColor[ 0 ] );\n\n\t\t}\n\n\t\tif ( geoNode.LayerElementMaterial ) {\n\n\t\t\tgeoInfo.material = this.parseMaterialIndices( geoNode.LayerElementMaterial[ 0 ] );\n\n\t\t}\n\n\t\tif ( geoNode.LayerElementNormal ) {\n\n\t\t\tgeoInfo.normal = this.parseNormals( geoNode.LayerElementNormal[ 0 ] );\n\n\t\t}\n\n\t\tif ( geoNode.LayerElementUV ) {\n\n\t\t\tgeoInfo.uv = [];\n\n\t\t\tlet i = 0;\n\t\t\twhile ( geoNode.LayerElementUV[ i ] ) {\n\n\t\t\t\tif ( geoNode.LayerElementUV[ i ].UV ) {\n\n\t\t\t\t\tgeoInfo.uv.push( this.parseUVs( geoNode.LayerElementUV[ i ] ) );\n\n\t\t\t\t}\n\n\t\t\t\ti ++;\n\n\t\t\t}\n\n\t\t}\n\n\t\tgeoInfo.weightTable = {};\n\n\t\tif ( skeleton !== null ) {\n\n\t\t\tgeoInfo.skeleton = skeleton;\n\n\t\t\tskeleton.rawBones.forEach( function ( rawBone, i ) {\n\n\t\t\t\t// loop over the bone's vertex indices and weights\n\t\t\t\trawBone.indices.forEach( function ( index, j ) {\n\n\t\t\t\t\tif ( geoInfo.weightTable[ index ] === undefined ) geoInfo.weightTable[ index ] = [];\n\n\t\t\t\t\tgeoInfo.weightTable[ index ].push( {\n\n\t\t\t\t\t\tid: i,\n\t\t\t\t\t\tweight: rawBone.weights[ j ],\n\n\t\t\t\t\t} );\n\n\t\t\t\t} );\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn geoInfo;\n\n\t}\n\n\tgenBuffers( geoInfo ) {\n\n\t\tconst buffers = {\n\t\t\tvertex: [],\n\t\t\tnormal: [],\n\t\t\tcolors: [],\n\t\t\tuvs: [],\n\t\t\tmaterialIndex: [],\n\t\t\tvertexWeights: [],\n\t\t\tweightsIndices: [],\n\t\t};\n\n\t\tlet polygonIndex = 0;\n\t\tlet faceLength = 0;\n\t\tlet displayedWeightsWarning = false;\n\n\t\t// these will hold data for a single face\n\t\tlet facePositionIndexes = [];\n\t\tlet faceNormals = [];\n\t\tlet faceColors = [];\n\t\tlet faceUVs = [];\n\t\tlet faceWeights = [];\n\t\tlet faceWeightIndices = [];\n\n\t\tconst scope = this;\n\t\tgeoInfo.vertexIndices.forEach( function ( vertexIndex, polygonVertexIndex ) {\n\n\t\t\tlet materialIndex;\n\t\t\tlet endOfFace = false;\n\n\t\t\t// Face index and vertex index arrays are combined in a single array\n\t\t\t// A cube with quad faces looks like this:\n\t\t\t// PolygonVertexIndex: *24 {\n\t\t\t//  a: 0, 1, 3, -3, 2, 3, 5, -5, 4, 5, 7, -7, 6, 7, 1, -1, 1, 7, 5, -4, 6, 0, 2, -5\n\t\t\t//  }\n\t\t\t// Negative numbers mark the end of a face - first face here is 0, 1, 3, -3\n\t\t\t// to find index of last vertex bit shift the index: ^ - 1\n\t\t\tif ( vertexIndex < 0 ) {\n\n\t\t\t\tvertexIndex = vertexIndex ^ - 1; // equivalent to ( x * -1 ) - 1\n\t\t\t\tendOfFace = true;\n\n\t\t\t}\n\n\t\t\tlet weightIndices = [];\n\t\t\tlet weights = [];\n\n\t\t\tfacePositionIndexes.push( vertexIndex * 3, vertexIndex * 3 + 1, vertexIndex * 3 + 2 );\n\n\t\t\tif ( geoInfo.color ) {\n\n\t\t\t\tconst data = getData( polygonVertexIndex, polygonIndex, vertexIndex, geoInfo.color );\n\n\t\t\t\tfaceColors.push( data[ 0 ], data[ 1 ], data[ 2 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.skeleton ) {\n\n\t\t\t\tif ( geoInfo.weightTable[ vertexIndex ] !== undefined ) {\n\n\t\t\t\t\tgeoInfo.weightTable[ vertexIndex ].forEach( function ( wt ) {\n\n\t\t\t\t\t\tweights.push( wt.weight );\n\t\t\t\t\t\tweightIndices.push( wt.id );\n\n\t\t\t\t\t} );\n\n\n\t\t\t\t}\n\n\t\t\t\tif ( weights.length > 4 ) {\n\n\t\t\t\t\tif ( ! displayedWeightsWarning ) {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights.' );\n\t\t\t\t\t\tdisplayedWeightsWarning = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst wIndex = [ 0, 0, 0, 0 ];\n\t\t\t\t\tconst Weight = [ 0, 0, 0, 0 ];\n\n\t\t\t\t\tweights.forEach( function ( weight, weightIndex ) {\n\n\t\t\t\t\t\tlet currentWeight = weight;\n\t\t\t\t\t\tlet currentIndex = weightIndices[ weightIndex ];\n\n\t\t\t\t\t\tWeight.forEach( function ( comparedWeight, comparedWeightIndex, comparedWeightArray ) {\n\n\t\t\t\t\t\t\tif ( currentWeight > comparedWeight ) {\n\n\t\t\t\t\t\t\t\tcomparedWeightArray[ comparedWeightIndex ] = currentWeight;\n\t\t\t\t\t\t\t\tcurrentWeight = comparedWeight;\n\n\t\t\t\t\t\t\t\tconst tmp = wIndex[ comparedWeightIndex ];\n\t\t\t\t\t\t\t\twIndex[ comparedWeightIndex ] = currentIndex;\n\t\t\t\t\t\t\t\tcurrentIndex = tmp;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t} );\n\n\t\t\t\t\tweightIndices = wIndex;\n\t\t\t\t\tweights = Weight;\n\n\t\t\t\t}\n\n\t\t\t\t// if the weight array is shorter than 4 pad with 0s\n\t\t\t\twhile ( weights.length < 4 ) {\n\n\t\t\t\t\tweights.push( 0 );\n\t\t\t\t\tweightIndices.push( 0 );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( let i = 0; i < 4; ++ i ) {\n\n\t\t\t\t\tfaceWeights.push( weights[ i ] );\n\t\t\t\t\tfaceWeightIndices.push( weightIndices[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.normal ) {\n\n\t\t\t\tconst data = getData( polygonVertexIndex, polygonIndex, vertexIndex, geoInfo.normal );\n\n\t\t\t\tfaceNormals.push( data[ 0 ], data[ 1 ], data[ 2 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.material && geoInfo.material.mappingType !== 'AllSame' ) {\n\n\t\t\t\tmaterialIndex = getData( polygonVertexIndex, polygonIndex, vertexIndex, geoInfo.material )[ 0 ];\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.uv ) {\n\n\t\t\t\tgeoInfo.uv.forEach( function ( uv, i ) {\n\n\t\t\t\t\tconst data = getData( polygonVertexIndex, polygonIndex, vertexIndex, uv );\n\n\t\t\t\t\tif ( faceUVs[ i ] === undefined ) {\n\n\t\t\t\t\t\tfaceUVs[ i ] = [];\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfaceUVs[ i ].push( data[ 0 ] );\n\t\t\t\t\tfaceUVs[ i ].push( data[ 1 ] );\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tfaceLength ++;\n\n\t\t\tif ( endOfFace ) {\n\n\t\t\t\tscope.genFace( buffers, geoInfo, facePositionIndexes, materialIndex, faceNormals, faceColors, faceUVs, faceWeights, faceWeightIndices, faceLength );\n\n\t\t\t\tpolygonIndex ++;\n\t\t\t\tfaceLength = 0;\n\n\t\t\t\t// reset arrays for the next face\n\t\t\t\tfacePositionIndexes = [];\n\t\t\t\tfaceNormals = [];\n\t\t\t\tfaceColors = [];\n\t\t\t\tfaceUVs = [];\n\t\t\t\tfaceWeights = [];\n\t\t\t\tfaceWeightIndices = [];\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn buffers;\n\n\t}\n\n\t// Generate data for a single face in a geometry. If the face is a quad then split it into 2 tris\n\tgenFace( buffers, geoInfo, facePositionIndexes, materialIndex, faceNormals, faceColors, faceUVs, faceWeights, faceWeightIndices, faceLength ) {\n\n\t\tfor ( let i = 2; i < faceLength; i ++ ) {\n\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ 0 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ 1 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ 2 ] ] );\n\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ ( i - 1 ) * 3 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ ( i - 1 ) * 3 + 1 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ ( i - 1 ) * 3 + 2 ] ] );\n\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ i * 3 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ i * 3 + 1 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ i * 3 + 2 ] ] );\n\n\t\t\tif ( geoInfo.skeleton ) {\n\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ 0 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ 1 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ 2 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ 3 ] );\n\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ ( i - 1 ) * 4 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ ( i - 1 ) * 4 + 1 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ ( i - 1 ) * 4 + 2 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ ( i - 1 ) * 4 + 3 ] );\n\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i * 4 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i * 4 + 1 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i * 4 + 2 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i * 4 + 3 ] );\n\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ 0 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ 1 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ 2 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ 3 ] );\n\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ ( i - 1 ) * 4 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ ( i - 1 ) * 4 + 1 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ ( i - 1 ) * 4 + 2 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ ( i - 1 ) * 4 + 3 ] );\n\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i * 4 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i * 4 + 1 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i * 4 + 2 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i * 4 + 3 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.color ) {\n\n\t\t\t\tbuffers.colors.push( faceColors[ 0 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ 1 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ 2 ] );\n\n\t\t\t\tbuffers.colors.push( faceColors[ ( i - 1 ) * 3 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ ( i - 1 ) * 3 + 1 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ ( i - 1 ) * 3 + 2 ] );\n\n\t\t\t\tbuffers.colors.push( faceColors[ i * 3 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ i * 3 + 1 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ i * 3 + 2 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.material && geoInfo.material.mappingType !== 'AllSame' ) {\n\n\t\t\t\tbuffers.materialIndex.push( materialIndex );\n\t\t\t\tbuffers.materialIndex.push( materialIndex );\n\t\t\t\tbuffers.materialIndex.push( materialIndex );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.normal ) {\n\n\t\t\t\tbuffers.normal.push( faceNormals[ 0 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ 1 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ 2 ] );\n\n\t\t\t\tbuffers.normal.push( faceNormals[ ( i - 1 ) * 3 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ ( i - 1 ) * 3 + 1 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ ( i - 1 ) * 3 + 2 ] );\n\n\t\t\t\tbuffers.normal.push( faceNormals[ i * 3 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ i * 3 + 1 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ i * 3 + 2 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.uv ) {\n\n\t\t\t\tgeoInfo.uv.forEach( function ( uv, j ) {\n\n\t\t\t\t\tif ( buffers.uvs[ j ] === undefined ) buffers.uvs[ j ] = [];\n\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ 0 ] );\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ 1 ] );\n\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ ( i - 1 ) * 2 ] );\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ ( i - 1 ) * 2 + 1 ] );\n\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ i * 2 ] );\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ i * 2 + 1 ] );\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\taddMorphTargets( parentGeo, parentGeoNode, morphTargets, preTransform ) {\n\n\t\tif ( morphTargets.length === 0 ) return;\n\n\t\tparentGeo.morphTargetsRelative = true;\n\n\t\tparentGeo.morphAttributes.position = [];\n\t\t// parentGeo.morphAttributes.normal = []; // not implemented\n\n\t\tconst scope = this;\n\t\tmorphTargets.forEach( function ( morphTarget ) {\n\n\t\t\tmorphTarget.rawTargets.forEach( function ( rawTarget ) {\n\n\t\t\t\tconst morphGeoNode = fbxTree.Objects.Geometry[ rawTarget.geoID ];\n\n\t\t\t\tif ( morphGeoNode !== undefined ) {\n\n\t\t\t\t\tscope.genMorphGeometry( parentGeo, parentGeoNode, morphGeoNode, preTransform, rawTarget.name );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n\t// a morph geometry node is similar to a standard  node, and the node is also contained\n\t// in FBXTree.Objects.Geometry, however it can only have attributes for position, normal\n\t// and a special attribute Index defining which vertices of the original geometry are affected\n\t// Normal and position attributes only have data for the vertices that are affected by the morph\n\tgenMorphGeometry( parentGeo, parentGeoNode, morphGeoNode, preTransform, name ) {\n\n\t\tconst vertexIndices = ( parentGeoNode.PolygonVertexIndex !== undefined ) ? parentGeoNode.PolygonVertexIndex.a : [];\n\n\t\tconst morphPositionsSparse = ( morphGeoNode.Vertices !== undefined ) ? morphGeoNode.Vertices.a : [];\n\t\tconst indices = ( morphGeoNode.Indexes !== undefined ) ? morphGeoNode.Indexes.a : [];\n\n\t\tconst length = parentGeo.attributes.position.count * 3;\n\t\tconst morphPositions = new Float32Array( length );\n\n\t\tfor ( let i = 0; i < indices.length; i ++ ) {\n\n\t\t\tconst morphIndex = indices[ i ] * 3;\n\n\t\t\tmorphPositions[ morphIndex ] = morphPositionsSparse[ i * 3 ];\n\t\t\tmorphPositions[ morphIndex + 1 ] = morphPositionsSparse[ i * 3 + 1 ];\n\t\t\tmorphPositions[ morphIndex + 2 ] = morphPositionsSparse[ i * 3 + 2 ];\n\n\t\t}\n\n\t\t// TODO: add morph normal support\n\t\tconst morphGeoInfo = {\n\t\t\tvertexIndices: vertexIndices,\n\t\t\tvertexPositions: morphPositions,\n\n\t\t};\n\n\t\tconst morphBuffers = this.genBuffers( morphGeoInfo );\n\n\t\tconst positionAttribute = new Float32BufferAttribute( morphBuffers.vertex, 3 );\n\t\tpositionAttribute.name = name || morphGeoNode.attrName;\n\n\t\tpositionAttribute.applyMatrix4( preTransform );\n\n\t\tparentGeo.morphAttributes.position.push( positionAttribute );\n\n\t}\n\n\t// Parse normal from FBXTree.Objects.Geometry.LayerElementNormal if it exists\n\tparseNormals( NormalNode ) {\n\n\t\tconst mappingType = NormalNode.MappingInformationType;\n\t\tconst referenceType = NormalNode.ReferenceInformationType;\n\t\tconst buffer = NormalNode.Normals.a;\n\t\tlet indexBuffer = [];\n\t\tif ( referenceType === 'IndexToDirect' ) {\n\n\t\t\tif ( 'NormalIndex' in NormalNode ) {\n\n\t\t\t\tindexBuffer = NormalNode.NormalIndex.a;\n\n\t\t\t} else if ( 'NormalsIndex' in NormalNode ) {\n\n\t\t\t\tindexBuffer = NormalNode.NormalsIndex.a;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn {\n\t\t\tdataSize: 3,\n\t\t\tbuffer: buffer,\n\t\t\tindices: indexBuffer,\n\t\t\tmappingType: mappingType,\n\t\t\treferenceType: referenceType\n\t\t};\n\n\t}\n\n\t// Parse UVs from FBXTree.Objects.Geometry.LayerElementUV if it exists\n\tparseUVs( UVNode ) {\n\n\t\tconst mappingType = UVNode.MappingInformationType;\n\t\tconst referenceType = UVNode.ReferenceInformationType;\n\t\tconst buffer = UVNode.UV.a;\n\t\tlet indexBuffer = [];\n\t\tif ( referenceType === 'IndexToDirect' ) {\n\n\t\t\tindexBuffer = UVNode.UVIndex.a;\n\n\t\t}\n\n\t\treturn {\n\t\t\tdataSize: 2,\n\t\t\tbuffer: buffer,\n\t\t\tindices: indexBuffer,\n\t\t\tmappingType: mappingType,\n\t\t\treferenceType: referenceType\n\t\t};\n\n\t}\n\n\t// Parse Vertex Colors from FBXTree.Objects.Geometry.LayerElementColor if it exists\n\tparseVertexColors( ColorNode ) {\n\n\t\tconst mappingType = ColorNode.MappingInformationType;\n\t\tconst referenceType = ColorNode.ReferenceInformationType;\n\t\tconst buffer = ColorNode.Colors.a;\n\t\tlet indexBuffer = [];\n\t\tif ( referenceType === 'IndexToDirect' ) {\n\n\t\t\tindexBuffer = ColorNode.ColorIndex.a;\n\n\t\t}\n\n\t\treturn {\n\t\t\tdataSize: 4,\n\t\t\tbuffer: buffer,\n\t\t\tindices: indexBuffer,\n\t\t\tmappingType: mappingType,\n\t\t\treferenceType: referenceType\n\t\t};\n\n\t}\n\n\t// Parse mapping and material data in FBXTree.Objects.Geometry.LayerElementMaterial if it exists\n\tparseMaterialIndices( MaterialNode ) {\n\n\t\tconst mappingType = MaterialNode.MappingInformationType;\n\t\tconst referenceType = MaterialNode.ReferenceInformationType;\n\n\t\tif ( mappingType === 'NoMappingInformation' ) {\n\n\t\t\treturn {\n\t\t\t\tdataSize: 1,\n\t\t\t\tbuffer: [ 0 ],\n\t\t\t\tindices: [ 0 ],\n\t\t\t\tmappingType: 'AllSame',\n\t\t\t\treferenceType: referenceType\n\t\t\t};\n\n\t\t}\n\n\t\tconst materialIndexBuffer = MaterialNode.Materials.a;\n\n\t\t// Since materials are stored as indices, there's a bit of a mismatch between FBX and what\n\t\t// we expect.So we create an intermediate buffer that points to the index in the buffer,\n\t\t// for conforming with the other functions we've written for other data.\n\t\tconst materialIndices = [];\n\n\t\tfor ( let i = 0; i < materialIndexBuffer.length; ++ i ) {\n\n\t\t\tmaterialIndices.push( i );\n\n\t\t}\n\n\t\treturn {\n\t\t\tdataSize: 1,\n\t\t\tbuffer: materialIndexBuffer,\n\t\t\tindices: materialIndices,\n\t\t\tmappingType: mappingType,\n\t\t\treferenceType: referenceType\n\t\t};\n\n\t}\n\n\t// Generate a NurbGeometry from a node in FBXTree.Objects.Geometry\n\tparseNurbsGeometry( geoNode ) {\n\n\t\tif ( NURBSCurve === undefined ) {\n\n\t\t\tconsole.error( 'THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry.' );\n\t\t\treturn new BufferGeometry();\n\n\t\t}\n\n\t\tconst order = parseInt( geoNode.Order );\n\n\t\tif ( isNaN( order ) ) {\n\n\t\t\tconsole.error( 'THREE.FBXLoader: Invalid Order %s given for geometry ID: %s', geoNode.Order, geoNode.id );\n\t\t\treturn new BufferGeometry();\n\n\t\t}\n\n\t\tconst degree = order - 1;\n\n\t\tconst knots = geoNode.KnotVector.a;\n\t\tconst controlPoints = [];\n\t\tconst pointsValues = geoNode.Points.a;\n\n\t\tfor ( let i = 0, l = pointsValues.length; i < l; i += 4 ) {\n\n\t\t\tcontrolPoints.push( new Vector4().fromArray( pointsValues, i ) );\n\n\t\t}\n\n\t\tlet startKnot, endKnot;\n\n\t\tif ( geoNode.Form === 'Closed' ) {\n\n\t\t\tcontrolPoints.push( controlPoints[ 0 ] );\n\n\t\t} else if ( geoNode.Form === 'Periodic' ) {\n\n\t\t\tstartKnot = degree;\n\t\t\tendKnot = knots.length - 1 - startKnot;\n\n\t\t\tfor ( let i = 0; i < degree; ++ i ) {\n\n\t\t\t\tcontrolPoints.push( controlPoints[ i ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst curve = new NURBSCurve( degree, knots, controlPoints, startKnot, endKnot );\n\t\tconst points = curve.getPoints( controlPoints.length * 12 );\n\n\t\treturn new BufferGeometry().setFromPoints( points );\n\n\t}\n\n}\n\n// parse animation data from FBXTree\nclass AnimationParser {\n\n\t// take raw animation clips and turn them into three.js animation clips\n\tparse() {\n\n\t\tconst animationClips = [];\n\n\t\tconst rawClips = this.parseClips();\n\n\t\tif ( rawClips !== undefined ) {\n\n\t\t\tfor ( const key in rawClips ) {\n\n\t\t\t\tconst rawClip = rawClips[ key ];\n\n\t\t\t\tconst clip = this.addClip( rawClip );\n\n\t\t\t\tanimationClips.push( clip );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn animationClips;\n\n\t}\n\n\tparseClips() {\n\n\t\t// since the actual transformation data is stored in FBXTree.Objects.AnimationCurve,\n\t\t// if this is undefined we can safely assume there are no animations\n\t\tif ( fbxTree.Objects.AnimationCurve === undefined ) return undefined;\n\n\t\tconst curveNodesMap = this.parseAnimationCurveNodes();\n\n\t\tthis.parseAnimationCurves( curveNodesMap );\n\n\t\tconst layersMap = this.parseAnimationLayers( curveNodesMap );\n\t\tconst rawClips = this.parseAnimStacks( layersMap );\n\n\t\treturn rawClips;\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.AnimationCurveNode\n\t// each AnimationCurveNode holds data for an animation transform for a model (e.g. left arm rotation )\n\t// and is referenced by an AnimationLayer\n\tparseAnimationCurveNodes() {\n\n\t\tconst rawCurveNodes = fbxTree.Objects.AnimationCurveNode;\n\n\t\tconst curveNodesMap = new Map();\n\n\t\tfor ( const nodeID in rawCurveNodes ) {\n\n\t\t\tconst rawCurveNode = rawCurveNodes[ nodeID ];\n\n\t\t\tif ( rawCurveNode.attrName.match( /S|R|T|DeformPercent/ ) !== null ) {\n\n\t\t\t\tconst curveNode = {\n\n\t\t\t\t\tid: rawCurveNode.id,\n\t\t\t\t\tattr: rawCurveNode.attrName,\n\t\t\t\t\tcurves: {},\n\n\t\t\t\t};\n\n\t\t\t\tcurveNodesMap.set( curveNode.id, curveNode );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn curveNodesMap;\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.AnimationCurve and connect them up to\n\t// previously parsed AnimationCurveNodes. Each AnimationCurve holds data for a single animated\n\t// axis ( e.g. times and values of x rotation)\n\tparseAnimationCurves( curveNodesMap ) {\n\n\t\tconst rawCurves = fbxTree.Objects.AnimationCurve;\n\n\t\t// TODO: Many values are identical up to roundoff error, but won't be optimised\n\t\t// e.g. position times: [0, 0.4, 0. 8]\n\t\t// position values: [7.23538335023477e-7, 93.67518615722656, -0.9982695579528809, 7.23538335023477e-7, 93.67518615722656, -0.9982695579528809, 7.235384487103147e-7, 93.67520904541016, -0.9982695579528809]\n\t\t// clearly, this should be optimised to\n\t\t// times: [0], positions [7.23538335023477e-7, 93.67518615722656, -0.9982695579528809]\n\t\t// this shows up in nearly every FBX file, and generally time array is length > 100\n\n\t\tfor ( const nodeID in rawCurves ) {\n\n\t\t\tconst animationCurve = {\n\n\t\t\t\tid: rawCurves[ nodeID ].id,\n\t\t\t\ttimes: rawCurves[ nodeID ].KeyTime.a.map( convertFBXTimeToSeconds ),\n\t\t\t\tvalues: rawCurves[ nodeID ].KeyValueFloat.a,\n\n\t\t\t};\n\n\t\t\tconst relationships = connections.get( animationCurve.id );\n\n\t\t\tif ( relationships !== undefined ) {\n\n\t\t\t\tconst animationCurveID = relationships.parents[ 0 ].ID;\n\t\t\t\tconst animationCurveRelationship = relationships.parents[ 0 ].relationship;\n\n\t\t\t\tif ( animationCurveRelationship.match( /X/ ) ) {\n\n\t\t\t\t\tcurveNodesMap.get( animationCurveID ).curves[ 'x' ] = animationCurve;\n\n\t\t\t\t} else if ( animationCurveRelationship.match( /Y/ ) ) {\n\n\t\t\t\t\tcurveNodesMap.get( animationCurveID ).curves[ 'y' ] = animationCurve;\n\n\t\t\t\t} else if ( animationCurveRelationship.match( /Z/ ) ) {\n\n\t\t\t\t\tcurveNodesMap.get( animationCurveID ).curves[ 'z' ] = animationCurve;\n\n\t\t\t\t} else if ( animationCurveRelationship.match( /d|DeformPercent/ ) && curveNodesMap.has( animationCurveID ) ) {\n\n\t\t\t\t\tcurveNodesMap.get( animationCurveID ).curves[ 'morph' ] = animationCurve;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.AnimationLayer. Each layers holds references\n\t// to various AnimationCurveNodes and is referenced by an AnimationStack node\n\t// note: theoretically a stack can have multiple layers, however in practice there always seems to be one per stack\n\tparseAnimationLayers( curveNodesMap ) {\n\n\t\tconst rawLayers = fbxTree.Objects.AnimationLayer;\n\n\t\tconst layersMap = new Map();\n\n\t\tfor ( const nodeID in rawLayers ) {\n\n\t\t\tconst layerCurveNodes = [];\n\n\t\t\tconst connection = connections.get( parseInt( nodeID ) );\n\n\t\t\tif ( connection !== undefined ) {\n\n\t\t\t\t// all the animationCurveNodes used in the layer\n\t\t\t\tconst children = connection.children;\n\n\t\t\t\tchildren.forEach( function ( child, i ) {\n\n\t\t\t\t\tif ( curveNodesMap.has( child.ID ) ) {\n\n\t\t\t\t\t\tconst curveNode = curveNodesMap.get( child.ID );\n\n\t\t\t\t\t\t// check that the curves are defined for at least one axis, otherwise ignore the curveNode\n\t\t\t\t\t\tif ( curveNode.curves.x !== undefined || curveNode.curves.y !== undefined || curveNode.curves.z !== undefined ) {\n\n\t\t\t\t\t\t\tif ( layerCurveNodes[ i ] === undefined ) {\n\n\t\t\t\t\t\t\t\tconst modelID = connections.get( child.ID ).parents.filter( function ( parent ) {\n\n\t\t\t\t\t\t\t\t\treturn parent.relationship !== undefined;\n\n\t\t\t\t\t\t\t\t} )[ 0 ].ID;\n\n\t\t\t\t\t\t\t\tif ( modelID !== undefined ) {\n\n\t\t\t\t\t\t\t\t\tconst rawModel = fbxTree.Objects.Model[ modelID.toString() ];\n\n\t\t\t\t\t\t\t\t\tif ( rawModel === undefined ) {\n\n\t\t\t\t\t\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: Encountered a unused curve.', child );\n\t\t\t\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tconst node = {\n\n\t\t\t\t\t\t\t\t\t\tmodelName: rawModel.attrName ? PropertyBinding.sanitizeNodeName( rawModel.attrName ) : '',\n\t\t\t\t\t\t\t\t\t\tID: rawModel.id,\n\t\t\t\t\t\t\t\t\t\tinitialPosition: [ 0, 0, 0 ],\n\t\t\t\t\t\t\t\t\t\tinitialRotation: [ 0, 0, 0 ],\n\t\t\t\t\t\t\t\t\t\tinitialScale: [ 1, 1, 1 ],\n\n\t\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\t\tsceneGraph.traverse( function ( child ) {\n\n\t\t\t\t\t\t\t\t\t\tif ( child.ID === rawModel.id ) {\n\n\t\t\t\t\t\t\t\t\t\t\tnode.transform = child.matrix;\n\n\t\t\t\t\t\t\t\t\t\t\tif ( child.userData.transformData ) node.eulerOrder = child.userData.transformData.eulerOrder;\n\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\t\t\tif ( ! node.transform ) node.transform = new Matrix4();\n\n\t\t\t\t\t\t\t\t\t// if the animated model is pre rotated, we'll have to apply the pre rotations to every\n\t\t\t\t\t\t\t\t\t// animation value as well\n\t\t\t\t\t\t\t\t\tif ( 'PreRotation' in rawModel ) node.preRotation = rawModel.PreRotation.value;\n\t\t\t\t\t\t\t\t\tif ( 'PostRotation' in rawModel ) node.postRotation = rawModel.PostRotation.value;\n\n\t\t\t\t\t\t\t\t\tlayerCurveNodes[ i ] = node;\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( layerCurveNodes[ i ] ) layerCurveNodes[ i ][ curveNode.attr ] = curveNode;\n\n\t\t\t\t\t\t} else if ( curveNode.curves.morph !== undefined ) {\n\n\t\t\t\t\t\t\tif ( layerCurveNodes[ i ] === undefined ) {\n\n\t\t\t\t\t\t\t\tconst deformerID = connections.get( child.ID ).parents.filter( function ( parent ) {\n\n\t\t\t\t\t\t\t\t\treturn parent.relationship !== undefined;\n\n\t\t\t\t\t\t\t\t} )[ 0 ].ID;\n\n\t\t\t\t\t\t\t\tconst morpherID = connections.get( deformerID ).parents[ 0 ].ID;\n\t\t\t\t\t\t\t\tconst geoID = connections.get( morpherID ).parents[ 0 ].ID;\n\n\t\t\t\t\t\t\t\t// assuming geometry is not used in more than one model\n\t\t\t\t\t\t\t\tconst modelID = connections.get( geoID ).parents[ 0 ].ID;\n\n\t\t\t\t\t\t\t\tconst rawModel = fbxTree.Objects.Model[ modelID ];\n\n\t\t\t\t\t\t\t\tconst node = {\n\n\t\t\t\t\t\t\t\t\tmodelName: rawModel.attrName ? PropertyBinding.sanitizeNodeName( rawModel.attrName ) : '',\n\t\t\t\t\t\t\t\t\tmorphName: fbxTree.Objects.Deformer[ deformerID ].attrName,\n\n\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\tlayerCurveNodes[ i ] = node;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlayerCurveNodes[ i ][ curveNode.attr ] = curveNode;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t\tlayersMap.set( parseInt( nodeID ), layerCurveNodes );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn layersMap;\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.AnimationStack. These are the top level node in the animation\n\t// hierarchy. Each Stack node will be used to create a AnimationClip\n\tparseAnimStacks( layersMap ) {\n\n\t\tconst rawStacks = fbxTree.Objects.AnimationStack;\n\n\t\t// connect the stacks (clips) up to the layers\n\t\tconst rawClips = {};\n\n\t\tfor ( const nodeID in rawStacks ) {\n\n\t\t\tconst children = connections.get( parseInt( nodeID ) ).children;\n\n\t\t\tif ( children.length > 1 ) {\n\n\t\t\t\t// it seems like stacks will always be associated with a single layer. But just in case there are files\n\t\t\t\t// where there are multiple layers per stack, we'll display a warning\n\t\t\t\tconsole.warn( 'THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.' );\n\n\t\t\t}\n\n\t\t\tconst layer = layersMap.get( children[ 0 ].ID );\n\n\t\t\trawClips[ nodeID ] = {\n\n\t\t\t\tname: rawStacks[ nodeID ].attrName,\n\t\t\t\tlayer: layer,\n\n\t\t\t};\n\n\t\t}\n\n\t\treturn rawClips;\n\n\t}\n\n\taddClip( rawClip ) {\n\n\t\tlet tracks = [];\n\n\t\tconst scope = this;\n\t\trawClip.layer.forEach( function ( rawTracks ) {\n\n\t\t\ttracks = tracks.concat( scope.generateTracks( rawTracks ) );\n\n\t\t} );\n\n\t\treturn new AnimationClip( rawClip.name, - 1, tracks );\n\n\t}\n\n\tgenerateTracks( rawTracks ) {\n\n\t\tconst tracks = [];\n\n\t\tlet initialPosition = new Vector3();\n\t\tlet initialRotation = new Quaternion();\n\t\tlet initialScale = new Vector3();\n\n\t\tif ( rawTracks.transform ) rawTracks.transform.decompose( initialPosition, initialRotation, initialScale );\n\n\t\tinitialPosition = initialPosition.toArray();\n\t\tinitialRotation = new Euler().setFromQuaternion( initialRotation, rawTracks.eulerOrder ).toArray();\n\t\tinitialScale = initialScale.toArray();\n\n\t\tif ( rawTracks.T !== undefined && Object.keys( rawTracks.T.curves ).length > 0 ) {\n\n\t\t\tconst positionTrack = this.generateVectorTrack( rawTracks.modelName, rawTracks.T.curves, initialPosition, 'position' );\n\t\t\tif ( positionTrack !== undefined ) tracks.push( positionTrack );\n\n\t\t}\n\n\t\tif ( rawTracks.R !== undefined && Object.keys( rawTracks.R.curves ).length > 0 ) {\n\n\t\t\tconst rotationTrack = this.generateRotationTrack( rawTracks.modelName, rawTracks.R.curves, initialRotation, rawTracks.preRotation, rawTracks.postRotation, rawTracks.eulerOrder );\n\t\t\tif ( rotationTrack !== undefined ) tracks.push( rotationTrack );\n\n\t\t}\n\n\t\tif ( rawTracks.S !== undefined && Object.keys( rawTracks.S.curves ).length > 0 ) {\n\n\t\t\tconst scaleTrack = this.generateVectorTrack( rawTracks.modelName, rawTracks.S.curves, initialScale, 'scale' );\n\t\t\tif ( scaleTrack !== undefined ) tracks.push( scaleTrack );\n\n\t\t}\n\n\t\tif ( rawTracks.DeformPercent !== undefined ) {\n\n\t\t\tconst morphTrack = this.generateMorphTrack( rawTracks );\n\t\t\tif ( morphTrack !== undefined ) tracks.push( morphTrack );\n\n\t\t}\n\n\t\treturn tracks;\n\n\t}\n\n\tgenerateVectorTrack( modelName, curves, initialValue, type ) {\n\n\t\tconst times = this.getTimesForAllAxes( curves );\n\t\tconst values = this.getKeyframeTrackValues( times, curves, initialValue );\n\n\t\treturn new VectorKeyframeTrack( modelName + '.' + type, times, values );\n\n\t}\n\n\tgenerateRotationTrack( modelName, curves, initialValue, preRotation, postRotation, eulerOrder ) {\n\n\t\tif ( curves.x !== undefined ) {\n\n\t\t\tthis.interpolateRotations( curves.x );\n\t\t\tcurves.x.values = curves.x.values.map( MathUtils.degToRad );\n\n\t\t}\n\n\t\tif ( curves.y !== undefined ) {\n\n\t\t\tthis.interpolateRotations( curves.y );\n\t\t\tcurves.y.values = curves.y.values.map( MathUtils.degToRad );\n\n\t\t}\n\n\t\tif ( curves.z !== undefined ) {\n\n\t\t\tthis.interpolateRotations( curves.z );\n\t\t\tcurves.z.values = curves.z.values.map( MathUtils.degToRad );\n\n\t\t}\n\n\t\tconst times = this.getTimesForAllAxes( curves );\n\t\tconst values = this.getKeyframeTrackValues( times, curves, initialValue );\n\n\t\tif ( preRotation !== undefined ) {\n\n\t\t\tpreRotation = preRotation.map( MathUtils.degToRad );\n\t\t\tpreRotation.push( eulerOrder );\n\n\t\t\tpreRotation = new Euler().fromArray( preRotation );\n\t\t\tpreRotation = new Quaternion().setFromEuler( preRotation );\n\n\t\t}\n\n\t\tif ( postRotation !== undefined ) {\n\n\t\t\tpostRotation = postRotation.map( MathUtils.degToRad );\n\t\t\tpostRotation.push( eulerOrder );\n\n\t\t\tpostRotation = new Euler().fromArray( postRotation );\n\t\t\tpostRotation = new Quaternion().setFromEuler( postRotation ).invert();\n\n\t\t}\n\n\t\tconst quaternion = new Quaternion();\n\t\tconst euler = new Euler();\n\n\t\tconst quaternionValues = [];\n\n\t\tfor ( let i = 0; i < values.length; i += 3 ) {\n\n\t\t\teuler.set( values[ i ], values[ i + 1 ], values[ i + 2 ], eulerOrder );\n\n\t\t\tquaternion.setFromEuler( euler );\n\n\t\t\tif ( preRotation !== undefined ) quaternion.premultiply( preRotation );\n\t\t\tif ( postRotation !== undefined ) quaternion.multiply( postRotation );\n\n\t\t\tquaternion.toArray( quaternionValues, ( i / 3 ) * 4 );\n\n\t\t}\n\n\t\treturn new QuaternionKeyframeTrack( modelName + '.quaternion', times, quaternionValues );\n\n\t}\n\n\tgenerateMorphTrack( rawTracks ) {\n\n\t\tconst curves = rawTracks.DeformPercent.curves.morph;\n\t\tconst values = curves.values.map( function ( val ) {\n\n\t\t\treturn val / 100;\n\n\t\t} );\n\n\t\tconst morphNum = sceneGraph.getObjectByName( rawTracks.modelName ).morphTargetDictionary[ rawTracks.morphName ];\n\n\t\treturn new NumberKeyframeTrack( rawTracks.modelName + '.morphTargetInfluences[' + morphNum + ']', curves.times, values );\n\n\t}\n\n\t// For all animated objects, times are defined separately for each axis\n\t// Here we'll combine the times into one sorted array without duplicates\n\tgetTimesForAllAxes( curves ) {\n\n\t\tlet times = [];\n\n\t\t// first join together the times for each axis, if defined\n\t\tif ( curves.x !== undefined ) times = times.concat( curves.x.times );\n\t\tif ( curves.y !== undefined ) times = times.concat( curves.y.times );\n\t\tif ( curves.z !== undefined ) times = times.concat( curves.z.times );\n\n\t\t// then sort them\n\t\ttimes = times.sort( function ( a, b ) {\n\n\t\t\treturn a - b;\n\n\t\t} );\n\n\t\t// and remove duplicates\n\t\tif ( times.length > 1 ) {\n\n\t\t\tlet targetIndex = 1;\n\t\t\tlet lastValue = times[ 0 ];\n\t\t\tfor ( let i = 1; i < times.length; i ++ ) {\n\n\t\t\t\tconst currentValue = times[ i ];\n\t\t\t\tif ( currentValue !== lastValue ) {\n\n\t\t\t\t\ttimes[ targetIndex ] = currentValue;\n\t\t\t\t\tlastValue = currentValue;\n\t\t\t\t\ttargetIndex ++;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\ttimes = times.slice( 0, targetIndex );\n\n\t\t}\n\n\t\treturn times;\n\n\t}\n\n\tgetKeyframeTrackValues( times, curves, initialValue ) {\n\n\t\tconst prevValue = initialValue;\n\n\t\tconst values = [];\n\n\t\tlet xIndex = - 1;\n\t\tlet yIndex = - 1;\n\t\tlet zIndex = - 1;\n\n\t\ttimes.forEach( function ( time ) {\n\n\t\t\tif ( curves.x ) xIndex = curves.x.times.indexOf( time );\n\t\t\tif ( curves.y ) yIndex = curves.y.times.indexOf( time );\n\t\t\tif ( curves.z ) zIndex = curves.z.times.indexOf( time );\n\n\t\t\t// if there is an x value defined for this frame, use that\n\t\t\tif ( xIndex !== - 1 ) {\n\n\t\t\t\tconst xValue = curves.x.values[ xIndex ];\n\t\t\t\tvalues.push( xValue );\n\t\t\t\tprevValue[ 0 ] = xValue;\n\n\t\t\t} else {\n\n\t\t\t\t// otherwise use the x value from the previous frame\n\t\t\t\tvalues.push( prevValue[ 0 ] );\n\n\t\t\t}\n\n\t\t\tif ( yIndex !== - 1 ) {\n\n\t\t\t\tconst yValue = curves.y.values[ yIndex ];\n\t\t\t\tvalues.push( yValue );\n\t\t\t\tprevValue[ 1 ] = yValue;\n\n\t\t\t} else {\n\n\t\t\t\tvalues.push( prevValue[ 1 ] );\n\n\t\t\t}\n\n\t\t\tif ( zIndex !== - 1 ) {\n\n\t\t\t\tconst zValue = curves.z.values[ zIndex ];\n\t\t\t\tvalues.push( zValue );\n\t\t\t\tprevValue[ 2 ] = zValue;\n\n\t\t\t} else {\n\n\t\t\t\tvalues.push( prevValue[ 2 ] );\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn values;\n\n\t}\n\n\t// Rotations are defined as Euler angles which can have values  of any size\n\t// These will be converted to quaternions which don't support values greater than\n\t// PI, so we'll interpolate large rotations\n\tinterpolateRotations( curve ) {\n\n\t\tfor ( let i = 1; i < curve.values.length; i ++ ) {\n\n\t\t\tconst initialValue = curve.values[ i - 1 ];\n\t\t\tconst valuesSpan = curve.values[ i ] - initialValue;\n\n\t\t\tconst absoluteSpan = Math.abs( valuesSpan );\n\n\t\t\tif ( absoluteSpan >= 180 ) {\n\n\t\t\t\tconst numSubIntervals = absoluteSpan / 180;\n\n\t\t\t\tconst step = valuesSpan / numSubIntervals;\n\t\t\t\tlet nextValue = initialValue + step;\n\n\t\t\t\tconst initialTime = curve.times[ i - 1 ];\n\t\t\t\tconst timeSpan = curve.times[ i ] - initialTime;\n\t\t\t\tconst interval = timeSpan / numSubIntervals;\n\t\t\t\tlet nextTime = initialTime + interval;\n\n\t\t\t\tconst interpolatedTimes = [];\n\t\t\t\tconst interpolatedValues = [];\n\n\t\t\t\twhile ( nextTime < curve.times[ i ] ) {\n\n\t\t\t\t\tinterpolatedTimes.push( nextTime );\n\t\t\t\t\tnextTime += interval;\n\n\t\t\t\t\tinterpolatedValues.push( nextValue );\n\t\t\t\t\tnextValue += step;\n\n\t\t\t\t}\n\n\t\t\t\tcurve.times = inject( curve.times, i, interpolatedTimes );\n\t\t\t\tcurve.values = inject( curve.values, i, interpolatedValues );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\n// parse an FBX file in ASCII format\nclass TextParser {\n\n\tgetPrevNode() {\n\n\t\treturn this.nodeStack[ this.currentIndent - 2 ];\n\n\t}\n\n\tgetCurrentNode() {\n\n\t\treturn this.nodeStack[ this.currentIndent - 1 ];\n\n\t}\n\n\tgetCurrentProp() {\n\n\t\treturn this.currentProp;\n\n\t}\n\n\tpushStack( node ) {\n\n\t\tthis.nodeStack.push( node );\n\t\tthis.currentIndent += 1;\n\n\t}\n\n\tpopStack() {\n\n\t\tthis.nodeStack.pop();\n\t\tthis.currentIndent -= 1;\n\n\t}\n\n\tsetCurrentProp( val, name ) {\n\n\t\tthis.currentProp = val;\n\t\tthis.currentPropName = name;\n\n\t}\n\n\tparse( text ) {\n\n\t\tthis.currentIndent = 0;\n\n\t\tthis.allNodes = new FBXTree();\n\t\tthis.nodeStack = [];\n\t\tthis.currentProp = [];\n\t\tthis.currentPropName = '';\n\n\t\tconst scope = this;\n\n\t\tconst split = text.split( /[\\r\\n]+/ );\n\n\t\tsplit.forEach( function ( line, i ) {\n\n\t\t\tconst matchComment = line.match( /^[\\s\\t]*;/ );\n\t\t\tconst matchEmpty = line.match( /^[\\s\\t]*$/ );\n\n\t\t\tif ( matchComment || matchEmpty ) return;\n\n\t\t\tconst matchBeginning = line.match( '^\\\\t{' + scope.currentIndent + '}(\\\\w+):(.*){', '' );\n\t\t\tconst matchProperty = line.match( '^\\\\t{' + ( scope.currentIndent ) + '}(\\\\w+):[\\\\s\\\\t\\\\r\\\\n](.*)' );\n\t\t\tconst matchEnd = line.match( '^\\\\t{' + ( scope.currentIndent - 1 ) + '}}' );\n\n\t\t\tif ( matchBeginning ) {\n\n\t\t\t\tscope.parseNodeBegin( line, matchBeginning );\n\n\t\t\t} else if ( matchProperty ) {\n\n\t\t\t\tscope.parseNodeProperty( line, matchProperty, split[ ++ i ] );\n\n\t\t\t} else if ( matchEnd ) {\n\n\t\t\t\tscope.popStack();\n\n\t\t\t} else if ( line.match( /^[^\\s\\t}]/ ) ) {\n\n\t\t\t\t// large arrays are split over multiple lines terminated with a ',' character\n\t\t\t\t// if this is encountered the line needs to be joined to the previous line\n\t\t\t\tscope.parseNodePropertyContinued( line );\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn this.allNodes;\n\n\t}\n\n\tparseNodeBegin( line, property ) {\n\n\t\tconst nodeName = property[ 1 ].trim().replace( /^\"/, '' ).replace( /\"$/, '' );\n\n\t\tconst nodeAttrs = property[ 2 ].split( ',' ).map( function ( attr ) {\n\n\t\t\treturn attr.trim().replace( /^\"/, '' ).replace( /\"$/, '' );\n\n\t\t} );\n\n\t\tconst node = { name: nodeName };\n\t\tconst attrs = this.parseNodeAttr( nodeAttrs );\n\n\t\tconst currentNode = this.getCurrentNode();\n\n\t\t// a top node\n\t\tif ( this.currentIndent === 0 ) {\n\n\t\t\tthis.allNodes.add( nodeName, node );\n\n\t\t} else { // a subnode\n\n\t\t\t// if the subnode already exists, append it\n\t\t\tif ( nodeName in currentNode ) {\n\n\t\t\t\t// special case Pose needs PoseNodes as an array\n\t\t\t\tif ( nodeName === 'PoseNode' ) {\n\n\t\t\t\t\tcurrentNode.PoseNode.push( node );\n\n\t\t\t\t} else if ( currentNode[ nodeName ].id !== undefined ) {\n\n\t\t\t\t\tcurrentNode[ nodeName ] = {};\n\t\t\t\t\tcurrentNode[ nodeName ][ currentNode[ nodeName ].id ] = currentNode[ nodeName ];\n\n\t\t\t\t}\n\n\t\t\t\tif ( attrs.id !== '' ) currentNode[ nodeName ][ attrs.id ] = node;\n\n\t\t\t} else if ( typeof attrs.id === 'number' ) {\n\n\t\t\t\tcurrentNode[ nodeName ] = {};\n\t\t\t\tcurrentNode[ nodeName ][ attrs.id ] = node;\n\n\t\t\t} else if ( nodeName !== 'Properties70' ) {\n\n\t\t\t\tif ( nodeName === 'PoseNode' )\tcurrentNode[ nodeName ] = [ node ];\n\t\t\t\telse currentNode[ nodeName ] = node;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( typeof attrs.id === 'number' ) node.id = attrs.id;\n\t\tif ( attrs.name !== '' ) node.attrName = attrs.name;\n\t\tif ( attrs.type !== '' ) node.attrType = attrs.type;\n\n\t\tthis.pushStack( node );\n\n\t}\n\n\tparseNodeAttr( attrs ) {\n\n\t\tlet id = attrs[ 0 ];\n\n\t\tif ( attrs[ 0 ] !== '' ) {\n\n\t\t\tid = parseInt( attrs[ 0 ] );\n\n\t\t\tif ( isNaN( id ) ) {\n\n\t\t\t\tid = attrs[ 0 ];\n\n\t\t\t}\n\n\t\t}\n\n\t\tlet name = '', type = '';\n\n\t\tif ( attrs.length > 1 ) {\n\n\t\t\tname = attrs[ 1 ].replace( /^(\\w+)::/, '' );\n\t\t\ttype = attrs[ 2 ];\n\n\t\t}\n\n\t\treturn { id: id, name: name, type: type };\n\n\t}\n\n\tparseNodeProperty( line, property, contentLine ) {\n\n\t\tlet propName = property[ 1 ].replace( /^\"/, '' ).replace( /\"$/, '' ).trim();\n\t\tlet propValue = property[ 2 ].replace( /^\"/, '' ).replace( /\"$/, '' ).trim();\n\n\t\t// for special case: base64 image data follows \"Content: ,\" line\n\t\t//\tContent: ,\n\t\t//\t \"/9j/4RDaRXhpZgAATU0A...\"\n\t\tif ( propName === 'Content' && propValue === ',' ) {\n\n\t\t\tpropValue = contentLine.replace( /\"/g, '' ).replace( /,$/, '' ).trim();\n\n\t\t}\n\n\t\tconst currentNode = this.getCurrentNode();\n\t\tconst parentName = currentNode.name;\n\n\t\tif ( parentName === 'Properties70' ) {\n\n\t\t\tthis.parseNodeSpecialProperty( line, propName, propValue );\n\t\t\treturn;\n\n\t\t}\n\n\t\t// Connections\n\t\tif ( propName === 'C' ) {\n\n\t\t\tconst connProps = propValue.split( ',' ).slice( 1 );\n\t\t\tconst from = parseInt( connProps[ 0 ] );\n\t\t\tconst to = parseInt( connProps[ 1 ] );\n\n\t\t\tlet rest = propValue.split( ',' ).slice( 3 );\n\n\t\t\trest = rest.map( function ( elem ) {\n\n\t\t\t\treturn elem.trim().replace( /^\"/, '' );\n\n\t\t\t} );\n\n\t\t\tpropName = 'connections';\n\t\t\tpropValue = [ from, to ];\n\t\t\tappend( propValue, rest );\n\n\t\t\tif ( currentNode[ propName ] === undefined ) {\n\n\t\t\t\tcurrentNode[ propName ] = [];\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Node\n\t\tif ( propName === 'Node' ) currentNode.id = propValue;\n\n\t\t// connections\n\t\tif ( propName in currentNode && Array.isArray( currentNode[ propName ] ) ) {\n\n\t\t\tcurrentNode[ propName ].push( propValue );\n\n\t\t} else {\n\n\t\t\tif ( propName !== 'a' ) currentNode[ propName ] = propValue;\n\t\t\telse currentNode.a = propValue;\n\n\t\t}\n\n\t\tthis.setCurrentProp( currentNode, propName );\n\n\t\t// convert string to array, unless it ends in ',' in which case more will be added to it\n\t\tif ( propName === 'a' && propValue.slice( - 1 ) !== ',' ) {\n\n\t\t\tcurrentNode.a = parseNumberArray( propValue );\n\n\t\t}\n\n\t}\n\n\tparseNodePropertyContinued( line ) {\n\n\t\tconst currentNode = this.getCurrentNode();\n\n\t\tcurrentNode.a += line;\n\n\t\t// if the line doesn't end in ',' we have reached the end of the property value\n\t\t// so convert the string to an array\n\t\tif ( line.slice( - 1 ) !== ',' ) {\n\n\t\t\tcurrentNode.a = parseNumberArray( currentNode.a );\n\n\t\t}\n\n\t}\n\n\t// parse \"Property70\"\n\tparseNodeSpecialProperty( line, propName, propValue ) {\n\n\t\t// split this\n\t\t// P: \"Lcl Scaling\", \"Lcl Scaling\", \"\", \"A\",1,1,1\n\t\t// into array like below\n\t\t// [\"Lcl Scaling\", \"Lcl Scaling\", \"\", \"A\", \"1,1,1\" ]\n\t\tconst props = propValue.split( '\",' ).map( function ( prop ) {\n\n\t\t\treturn prop.trim().replace( /^\\\"/, '' ).replace( /\\s/, '_' );\n\n\t\t} );\n\n\t\tconst innerPropName = props[ 0 ];\n\t\tconst innerPropType1 = props[ 1 ];\n\t\tconst innerPropType2 = props[ 2 ];\n\t\tconst innerPropFlag = props[ 3 ];\n\t\tlet innerPropValue = props[ 4 ];\n\n\t\t// cast values where needed, otherwise leave as strings\n\t\tswitch ( innerPropType1 ) {\n\n\t\t\tcase 'int':\n\t\t\tcase 'enum':\n\t\t\tcase 'bool':\n\t\t\tcase 'ULongLong':\n\t\t\tcase 'double':\n\t\t\tcase 'Number':\n\t\t\tcase 'FieldOfView':\n\t\t\t\tinnerPropValue = parseFloat( innerPropValue );\n\t\t\t\tbreak;\n\n\t\t\tcase 'Color':\n\t\t\tcase 'ColorRGB':\n\t\t\tcase 'Vector3D':\n\t\t\tcase 'Lcl_Translation':\n\t\t\tcase 'Lcl_Rotation':\n\t\t\tcase 'Lcl_Scaling':\n\t\t\t\tinnerPropValue = parseNumberArray( innerPropValue );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\t// CAUTION: these props must append to parent's parent\n\t\tthis.getPrevNode()[ innerPropName ] = {\n\n\t\t\t'type': innerPropType1,\n\t\t\t'type2': innerPropType2,\n\t\t\t'flag': innerPropFlag,\n\t\t\t'value': innerPropValue\n\n\t\t};\n\n\t\tthis.setCurrentProp( this.getPrevNode(), innerPropName );\n\n\t}\n\n}\n\n// Parse an FBX file in Binary format\nclass BinaryParser {\n\n\tparse( buffer ) {\n\n\t\tconst reader = new BinaryReader( buffer );\n\t\treader.skip( 23 ); // skip magic 23 bytes\n\n\t\tconst version = reader.getUint32();\n\n\t\tif ( version < 6400 ) {\n\n\t\t\tthrow new Error( 'THREE.FBXLoader: FBX version not supported, FileVersion: ' + version );\n\n\t\t}\n\n\t\tconst allNodes = new FBXTree();\n\n\t\twhile ( ! this.endOfContent( reader ) ) {\n\n\t\t\tconst node = this.parseNode( reader, version );\n\t\t\tif ( node !== null ) allNodes.add( node.name, node );\n\n\t\t}\n\n\t\treturn allNodes;\n\n\t}\n\n\t// Check if reader has reached the end of content.\n\tendOfContent( reader ) {\n\n\t\t// footer size: 160bytes + 16-byte alignment padding\n\t\t// - 16bytes: magic\n\t\t// - padding til 16-byte alignment (at least 1byte?)\n\t\t//\t(seems like some exporters embed fixed 15 or 16bytes?)\n\t\t// - 4bytes: magic\n\t\t// - 4bytes: version\n\t\t// - 120bytes: zero\n\t\t// - 16bytes: magic\n\t\tif ( reader.size() % 16 === 0 ) {\n\n\t\t\treturn ( ( reader.getOffset() + 160 + 16 ) & ~ 0xf ) >= reader.size();\n\n\t\t} else {\n\n\t\t\treturn reader.getOffset() + 160 + 16 >= reader.size();\n\n\t\t}\n\n\t}\n\n\t// recursively parse nodes until the end of the file is reached\n\tparseNode( reader, version ) {\n\n\t\tconst node = {};\n\n\t\t// The first three data sizes depends on version.\n\t\tconst endOffset = ( version >= 7500 ) ? reader.getUint64() : reader.getUint32();\n\t\tconst numProperties = ( version >= 7500 ) ? reader.getUint64() : reader.getUint32();\n\n\t\t( version >= 7500 ) ? reader.getUint64() : reader.getUint32(); // the returned propertyListLen is not used\n\n\t\tconst nameLen = reader.getUint8();\n\t\tconst name = reader.getString( nameLen );\n\n\t\t// Regards this node as NULL-record if endOffset is zero\n\t\tif ( endOffset === 0 ) return null;\n\n\t\tconst propertyList = [];\n\n\t\tfor ( let i = 0; i < numProperties; i ++ ) {\n\n\t\t\tpropertyList.push( this.parseProperty( reader ) );\n\n\t\t}\n\n\t\t// Regards the first three elements in propertyList as id, attrName, and attrType\n\t\tconst id = propertyList.length > 0 ? propertyList[ 0 ] : '';\n\t\tconst attrName = propertyList.length > 1 ? propertyList[ 1 ] : '';\n\t\tconst attrType = propertyList.length > 2 ? propertyList[ 2 ] : '';\n\n\t\t// check if this node represents just a single property\n\t\t// like (name, 0) set or (name2, [0, 1, 2]) set of {name: 0, name2: [0, 1, 2]}\n\t\tnode.singleProperty = ( numProperties === 1 && reader.getOffset() === endOffset ) ? true : false;\n\n\t\twhile ( endOffset > reader.getOffset() ) {\n\n\t\t\tconst subNode = this.parseNode( reader, version );\n\n\t\t\tif ( subNode !== null ) this.parseSubNode( name, node, subNode );\n\n\t\t}\n\n\t\tnode.propertyList = propertyList; // raw property list used by parent\n\n\t\tif ( typeof id === 'number' ) node.id = id;\n\t\tif ( attrName !== '' ) node.attrName = attrName;\n\t\tif ( attrType !== '' ) node.attrType = attrType;\n\t\tif ( name !== '' ) node.name = name;\n\n\t\treturn node;\n\n\t}\n\n\tparseSubNode( name, node, subNode ) {\n\n\t\t// special case: child node is single property\n\t\tif ( subNode.singleProperty === true ) {\n\n\t\t\tconst value = subNode.propertyList[ 0 ];\n\n\t\t\tif ( Array.isArray( value ) ) {\n\n\t\t\t\tnode[ subNode.name ] = subNode;\n\n\t\t\t\tsubNode.a = value;\n\n\t\t\t} else {\n\n\t\t\t\tnode[ subNode.name ] = value;\n\n\t\t\t}\n\n\t\t} else if ( name === 'Connections' && subNode.name === 'C' ) {\n\n\t\t\tconst array = [];\n\n\t\t\tsubNode.propertyList.forEach( function ( property, i ) {\n\n\t\t\t\t// first Connection is FBX type (OO, OP, etc.). We'll discard these\n\t\t\t\tif ( i !== 0 ) array.push( property );\n\n\t\t\t} );\n\n\t\t\tif ( node.connections === undefined ) {\n\n\t\t\t\tnode.connections = [];\n\n\t\t\t}\n\n\t\t\tnode.connections.push( array );\n\n\t\t} else if ( subNode.name === 'Properties70' ) {\n\n\t\t\tconst keys = Object.keys( subNode );\n\n\t\t\tkeys.forEach( function ( key ) {\n\n\t\t\t\tnode[ key ] = subNode[ key ];\n\n\t\t\t} );\n\n\t\t} else if ( name === 'Properties70' && subNode.name === 'P' ) {\n\n\t\t\tlet innerPropName = subNode.propertyList[ 0 ];\n\t\t\tlet innerPropType1 = subNode.propertyList[ 1 ];\n\t\t\tconst innerPropType2 = subNode.propertyList[ 2 ];\n\t\t\tconst innerPropFlag = subNode.propertyList[ 3 ];\n\t\t\tlet innerPropValue;\n\n\t\t\tif ( innerPropName.indexOf( 'Lcl ' ) === 0 ) innerPropName = innerPropName.replace( 'Lcl ', 'Lcl_' );\n\t\t\tif ( innerPropType1.indexOf( 'Lcl ' ) === 0 ) innerPropType1 = innerPropType1.replace( 'Lcl ', 'Lcl_' );\n\n\t\t\tif ( innerPropType1 === 'Color' || innerPropType1 === 'ColorRGB' || innerPropType1 === 'Vector' || innerPropType1 === 'Vector3D' || innerPropType1.indexOf( 'Lcl_' ) === 0 ) {\n\n\t\t\t\tinnerPropValue = [\n\t\t\t\t\tsubNode.propertyList[ 4 ],\n\t\t\t\t\tsubNode.propertyList[ 5 ],\n\t\t\t\t\tsubNode.propertyList[ 6 ]\n\t\t\t\t];\n\n\t\t\t} else {\n\n\t\t\t\tinnerPropValue = subNode.propertyList[ 4 ];\n\n\t\t\t}\n\n\t\t\t// this will be copied to parent, see above\n\t\t\tnode[ innerPropName ] = {\n\n\t\t\t\t'type': innerPropType1,\n\t\t\t\t'type2': innerPropType2,\n\t\t\t\t'flag': innerPropFlag,\n\t\t\t\t'value': innerPropValue\n\n\t\t\t};\n\n\t\t} else if ( node[ subNode.name ] === undefined ) {\n\n\t\t\tif ( typeof subNode.id === 'number' ) {\n\n\t\t\t\tnode[ subNode.name ] = {};\n\t\t\t\tnode[ subNode.name ][ subNode.id ] = subNode;\n\n\t\t\t} else {\n\n\t\t\t\tnode[ subNode.name ] = subNode;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tif ( subNode.name === 'PoseNode' ) {\n\n\t\t\t\tif ( ! Array.isArray( node[ subNode.name ] ) ) {\n\n\t\t\t\t\tnode[ subNode.name ] = [ node[ subNode.name ] ];\n\n\t\t\t\t}\n\n\t\t\t\tnode[ subNode.name ].push( subNode );\n\n\t\t\t} else if ( node[ subNode.name ][ subNode.id ] === undefined ) {\n\n\t\t\t\tnode[ subNode.name ][ subNode.id ] = subNode;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tparseProperty( reader ) {\n\n\t\tconst type = reader.getString( 1 );\n\t\tlet length;\n\n\t\tswitch ( type ) {\n\n\t\t\tcase 'C':\n\t\t\t\treturn reader.getBoolean();\n\n\t\t\tcase 'D':\n\t\t\t\treturn reader.getFloat64();\n\n\t\t\tcase 'F':\n\t\t\t\treturn reader.getFloat32();\n\n\t\t\tcase 'I':\n\t\t\t\treturn reader.getInt32();\n\n\t\t\tcase 'L':\n\t\t\t\treturn reader.getInt64();\n\n\t\t\tcase 'R':\n\t\t\t\tlength = reader.getUint32();\n\t\t\t\treturn reader.getArrayBuffer( length );\n\n\t\t\tcase 'S':\n\t\t\t\tlength = reader.getUint32();\n\t\t\t\treturn reader.getString( length );\n\n\t\t\tcase 'Y':\n\t\t\t\treturn reader.getInt16();\n\n\t\t\tcase 'b':\n\t\t\tcase 'c':\n\t\t\tcase 'd':\n\t\t\tcase 'f':\n\t\t\tcase 'i':\n\t\t\tcase 'l':\n\n\t\t\t\tconst arrayLength = reader.getUint32();\n\t\t\t\tconst encoding = reader.getUint32(); // 0: non-compressed, 1: compressed\n\t\t\t\tconst compressedLength = reader.getUint32();\n\n\t\t\t\tif ( encoding === 0 ) {\n\n\t\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\t\tcase 'b':\n\t\t\t\t\t\tcase 'c':\n\t\t\t\t\t\t\treturn reader.getBooleanArray( arrayLength );\n\n\t\t\t\t\t\tcase 'd':\n\t\t\t\t\t\t\treturn reader.getFloat64Array( arrayLength );\n\n\t\t\t\t\t\tcase 'f':\n\t\t\t\t\t\t\treturn reader.getFloat32Array( arrayLength );\n\n\t\t\t\t\t\tcase 'i':\n\t\t\t\t\t\t\treturn reader.getInt32Array( arrayLength );\n\n\t\t\t\t\t\tcase 'l':\n\t\t\t\t\t\t\treturn reader.getInt64Array( arrayLength );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( typeof fflate === 'undefined' ) {\n\n\t\t\t\t\tconsole.error( 'THREE.FBXLoader: External library fflate.min.js required.' );\n\n\t\t\t\t}\n\n\t\t\t\tconst data = fflate.unzlibSync( new Uint8Array( reader.getArrayBuffer( compressedLength ) ) ); // eslint-disable-line no-undef\n\t\t\t\tconst reader2 = new BinaryReader( data.buffer );\n\n\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\tcase 'b':\n\t\t\t\t\tcase 'c':\n\t\t\t\t\t\treturn reader2.getBooleanArray( arrayLength );\n\n\t\t\t\t\tcase 'd':\n\t\t\t\t\t\treturn reader2.getFloat64Array( arrayLength );\n\n\t\t\t\t\tcase 'f':\n\t\t\t\t\t\treturn reader2.getFloat32Array( arrayLength );\n\n\t\t\t\t\tcase 'i':\n\t\t\t\t\t\treturn reader2.getInt32Array( arrayLength );\n\n\t\t\t\t\tcase 'l':\n\t\t\t\t\t\treturn reader2.getInt64Array( arrayLength );\n\n\t\t\t\t}\n\n\t\t\tdefault:\n\t\t\t\tthrow new Error( 'THREE.FBXLoader: Unknown property type ' + type );\n\n\t\t}\n\n\t}\n\n}\n\nclass BinaryReader {\n\n\tconstructor( buffer, littleEndian ) {\n\n\t\tthis.dv = new DataView( buffer );\n\t\tthis.offset = 0;\n\t\tthis.littleEndian = ( littleEndian !== undefined ) ? littleEndian : true;\n\n\t}\n\n\tgetOffset() {\n\n\t\treturn this.offset;\n\n\t}\n\n\tsize() {\n\n\t\treturn this.dv.buffer.byteLength;\n\n\t}\n\n\tskip( length ) {\n\n\t\tthis.offset += length;\n\n\t}\n\n\t// seems like true/false representation depends on exporter.\n\t// true: 1 or 'Y'(=0x59), false: 0 or 'T'(=0x54)\n\t// then sees LSB.\n\tgetBoolean() {\n\n\t\treturn ( this.getUint8() & 1 ) === 1;\n\n\t}\n\n\tgetBooleanArray( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getBoolean() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\tgetUint8() {\n\n\t\tconst value = this.dv.getUint8( this.offset );\n\t\tthis.offset += 1;\n\t\treturn value;\n\n\t}\n\n\tgetInt16() {\n\n\t\tconst value = this.dv.getInt16( this.offset, this.littleEndian );\n\t\tthis.offset += 2;\n\t\treturn value;\n\n\t}\n\n\tgetInt32() {\n\n\t\tconst value = this.dv.getInt32( this.offset, this.littleEndian );\n\t\tthis.offset += 4;\n\t\treturn value;\n\n\t}\n\n\tgetInt32Array( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getInt32() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\tgetUint32() {\n\n\t\tconst value = this.dv.getUint32( this.offset, this.littleEndian );\n\t\tthis.offset += 4;\n\t\treturn value;\n\n\t}\n\n\t// JavaScript doesn't support 64-bit integer so calculate this here\n\t// 1 << 32 will return 1 so using multiply operation instead here.\n\t// There's a possibility that this method returns wrong value if the value\n\t// is out of the range between Number.MAX_SAFE_INTEGER and Number.MIN_SAFE_INTEGER.\n\t// TODO: safely handle 64-bit integer\n\tgetInt64() {\n\n\t\tlet low, high;\n\n\t\tif ( this.littleEndian ) {\n\n\t\t\tlow = this.getUint32();\n\t\t\thigh = this.getUint32();\n\n\t\t} else {\n\n\t\t\thigh = this.getUint32();\n\t\t\tlow = this.getUint32();\n\n\t\t}\n\n\t\t// calculate negative value\n\t\tif ( high & 0x80000000 ) {\n\n\t\t\thigh = ~ high & 0xFFFFFFFF;\n\t\t\tlow = ~ low & 0xFFFFFFFF;\n\n\t\t\tif ( low === 0xFFFFFFFF ) high = ( high + 1 ) & 0xFFFFFFFF;\n\n\t\t\tlow = ( low + 1 ) & 0xFFFFFFFF;\n\n\t\t\treturn - ( high * 0x100000000 + low );\n\n\t\t}\n\n\t\treturn high * 0x100000000 + low;\n\n\t}\n\n\tgetInt64Array( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getInt64() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\t// Note: see getInt64() comment\n\tgetUint64() {\n\n\t\tlet low, high;\n\n\t\tif ( this.littleEndian ) {\n\n\t\t\tlow = this.getUint32();\n\t\t\thigh = this.getUint32();\n\n\t\t} else {\n\n\t\t\thigh = this.getUint32();\n\t\t\tlow = this.getUint32();\n\n\t\t}\n\n\t\treturn high * 0x100000000 + low;\n\n\t}\n\n\tgetFloat32() {\n\n\t\tconst value = this.dv.getFloat32( this.offset, this.littleEndian );\n\t\tthis.offset += 4;\n\t\treturn value;\n\n\t}\n\n\tgetFloat32Array( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getFloat32() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\tgetFloat64() {\n\n\t\tconst value = this.dv.getFloat64( this.offset, this.littleEndian );\n\t\tthis.offset += 8;\n\t\treturn value;\n\n\t}\n\n\tgetFloat64Array( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getFloat64() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\tgetArrayBuffer( size ) {\n\n\t\tconst value = this.dv.buffer.slice( this.offset, this.offset + size );\n\t\tthis.offset += size;\n\t\treturn value;\n\n\t}\n\n\tgetString( size ) {\n\n\t\t// note: safari 9 doesn't support Uint8Array.indexOf; create intermediate array instead\n\t\tlet a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta[ i ] = this.getUint8();\n\n\t\t}\n\n\t\tconst nullByte = a.indexOf( 0 );\n\t\tif ( nullByte >= 0 ) a = a.slice( 0, nullByte );\n\n\t\treturn LoaderUtils.decodeText( new Uint8Array( a ) );\n\n\t}\n\n}\n\n// FBXTree holds a representation of the FBX data, returned by the TextParser ( FBX ASCII format)\n// and BinaryParser( FBX Binary format)\nclass FBXTree {\n\n\tadd( key, val ) {\n\n\t\tthis[ key ] = val;\n\n\t}\n\n}\n\n// ************** UTILITY FUNCTIONS **************\n\nfunction isFbxFormatBinary( buffer ) {\n\n\tconst CORRECT = 'Kaydara\\u0020FBX\\u0020Binary\\u0020\\u0020\\0';\n\n\treturn buffer.byteLength >= CORRECT.length && CORRECT === convertArrayBufferToString( buffer, 0, CORRECT.length );\n\n}\n\nfunction isFbxFormatASCII( text ) {\n\n\tconst CORRECT = [ 'K', 'a', 'y', 'd', 'a', 'r', 'a', '\\\\', 'F', 'B', 'X', '\\\\', 'B', 'i', 'n', 'a', 'r', 'y', '\\\\', '\\\\' ];\n\n\tlet cursor = 0;\n\n\tfunction read( offset ) {\n\n\t\tconst result = text[ offset - 1 ];\n\t\ttext = text.slice( cursor + offset );\n\t\tcursor ++;\n\t\treturn result;\n\n\t}\n\n\tfor ( let i = 0; i < CORRECT.length; ++ i ) {\n\n\t\tconst num = read( 1 );\n\t\tif ( num === CORRECT[ i ] ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t}\n\n\treturn true;\n\n}\n\nfunction getFbxVersion( text ) {\n\n\tconst versionRegExp = /FBXVersion: (\\d+)/;\n\tconst match = text.match( versionRegExp );\n\n\tif ( match ) {\n\n\t\tconst version = parseInt( match[ 1 ] );\n\t\treturn version;\n\n\t}\n\n\tthrow new Error( 'THREE.FBXLoader: Cannot find the version number for the file given.' );\n\n}\n\n// Converts FBX ticks into real time seconds.\nfunction convertFBXTimeToSeconds( time ) {\n\n\treturn time / 46186158000;\n\n}\n\nconst dataArray = [];\n\n// extracts the data from the correct position in the FBX array based on indexing type\nfunction getData( polygonVertexIndex, polygonIndex, vertexIndex, infoObject ) {\n\n\tlet index;\n\n\tswitch ( infoObject.mappingType ) {\n\n\t\tcase 'ByPolygonVertex' :\n\t\t\tindex = polygonVertexIndex;\n\t\t\tbreak;\n\t\tcase 'ByPolygon' :\n\t\t\tindex = polygonIndex;\n\t\t\tbreak;\n\t\tcase 'ByVertice' :\n\t\t\tindex = vertexIndex;\n\t\t\tbreak;\n\t\tcase 'AllSame' :\n\t\t\tindex = infoObject.indices[ 0 ];\n\t\t\tbreak;\n\t\tdefault :\n\t\t\tconsole.warn( 'THREE.FBXLoader: unknown attribute mapping type ' + infoObject.mappingType );\n\n\t}\n\n\tif ( infoObject.referenceType === 'IndexToDirect' ) index = infoObject.indices[ index ];\n\n\tconst from = index * infoObject.dataSize;\n\tconst to = from + infoObject.dataSize;\n\n\treturn slice( dataArray, infoObject.buffer, from, to );\n\n}\n\nconst tempEuler = new Euler();\nconst tempVec = new Vector3();\n\n// generate transformation from FBX transform data\n// ref: https://help.autodesk.com/view/FBX/2017/ENU/?guid=__files_GUID_10CDD63C_79C1_4F2D_BB28_AD2BE65A02ED_htm\n// ref: http://docs.autodesk.com/FBX/2014/ENU/FBX-SDK-Documentation/index.html?url=cpp_ref/_transformations_2main_8cxx-example.html,topicNumber=cpp_ref__transformations_2main_8cxx_example_htmlfc10a1e1-b18d-4e72-9dc0-70d0f1959f5e\nfunction generateTransform( transformData ) {\n\n\tconst lTranslationM = new Matrix4();\n\tconst lPreRotationM = new Matrix4();\n\tconst lRotationM = new Matrix4();\n\tconst lPostRotationM = new Matrix4();\n\n\tconst lScalingM = new Matrix4();\n\tconst lScalingPivotM = new Matrix4();\n\tconst lScalingOffsetM = new Matrix4();\n\tconst lRotationOffsetM = new Matrix4();\n\tconst lRotationPivotM = new Matrix4();\n\n\tconst lParentGX = new Matrix4();\n\tconst lParentLX = new Matrix4();\n\tconst lGlobalT = new Matrix4();\n\n\tconst inheritType = ( transformData.inheritType ) ? transformData.inheritType : 0;\n\n\tif ( transformData.translation ) lTranslationM.setPosition( tempVec.fromArray( transformData.translation ) );\n\n\tif ( transformData.preRotation ) {\n\n\t\tconst array = transformData.preRotation.map( MathUtils.degToRad );\n\t\tarray.push( transformData.eulerOrder );\n\t\tlPreRotationM.makeRotationFromEuler( tempEuler.fromArray( array ) );\n\n\t}\n\n\tif ( transformData.rotation ) {\n\n\t\tconst array = transformData.rotation.map( MathUtils.degToRad );\n\t\tarray.push( transformData.eulerOrder );\n\t\tlRotationM.makeRotationFromEuler( tempEuler.fromArray( array ) );\n\n\t}\n\n\tif ( transformData.postRotation ) {\n\n\t\tconst array = transformData.postRotation.map( MathUtils.degToRad );\n\t\tarray.push( transformData.eulerOrder );\n\t\tlPostRotationM.makeRotationFromEuler( tempEuler.fromArray( array ) );\n\t\tlPostRotationM.invert();\n\n\t}\n\n\tif ( transformData.scale ) lScalingM.scale( tempVec.fromArray( transformData.scale ) );\n\n\t// Pivots and offsets\n\tif ( transformData.scalingOffset ) lScalingOffsetM.setPosition( tempVec.fromArray( transformData.scalingOffset ) );\n\tif ( transformData.scalingPivot ) lScalingPivotM.setPosition( tempVec.fromArray( transformData.scalingPivot ) );\n\tif ( transformData.rotationOffset ) lRotationOffsetM.setPosition( tempVec.fromArray( transformData.rotationOffset ) );\n\tif ( transformData.rotationPivot ) lRotationPivotM.setPosition( tempVec.fromArray( transformData.rotationPivot ) );\n\n\t// parent transform\n\tif ( transformData.parentMatrixWorld ) {\n\n\t\tlParentLX.copy( transformData.parentMatrix );\n\t\tlParentGX.copy( transformData.parentMatrixWorld );\n\n\t}\n\n\tconst lLRM = lPreRotationM.clone().multiply( lRotationM ).multiply( lPostRotationM );\n\t// Global Rotation\n\tconst lParentGRM = new Matrix4();\n\tlParentGRM.extractRotation( lParentGX );\n\n\t// Global Shear*Scaling\n\tconst lParentTM = new Matrix4();\n\tlParentTM.copyPosition( lParentGX );\n\n\tconst lParentGRSM = lParentTM.clone().invert().multiply( lParentGX );\n\tconst lParentGSM = lParentGRM.clone().invert().multiply( lParentGRSM );\n\tconst lLSM = lScalingM;\n\n\tconst lGlobalRS = new Matrix4();\n\n\tif ( inheritType === 0 ) {\n\n\t\tlGlobalRS.copy( lParentGRM ).multiply( lLRM ).multiply( lParentGSM ).multiply( lLSM );\n\n\t} else if ( inheritType === 1 ) {\n\n\t\tlGlobalRS.copy( lParentGRM ).multiply( lParentGSM ).multiply( lLRM ).multiply( lLSM );\n\n\t} else {\n\n\t\tconst lParentLSM = new Matrix4().scale( new Vector3().setFromMatrixScale( lParentLX ) );\n\t\tconst lParentLSM_inv = lParentLSM.clone().invert();\n\t\tconst lParentGSM_noLocal = lParentGSM.clone().multiply( lParentLSM_inv );\n\n\t\tlGlobalRS.copy( lParentGRM ).multiply( lLRM ).multiply( lParentGSM_noLocal ).multiply( lLSM );\n\n\t}\n\n\tconst lRotationPivotM_inv = lRotationPivotM.clone().invert();\n\tconst lScalingPivotM_inv = lScalingPivotM.clone().invert();\n\t// Calculate the local transform matrix\n\tlet lTransform = lTranslationM.clone().multiply( lRotationOffsetM ).multiply( lRotationPivotM ).multiply( lPreRotationM ).multiply( lRotationM ).multiply( lPostRotationM ).multiply( lRotationPivotM_inv ).multiply( lScalingOffsetM ).multiply( lScalingPivotM ).multiply( lScalingM ).multiply( lScalingPivotM_inv );\n\n\tconst lLocalTWithAllPivotAndOffsetInfo = new Matrix4().copyPosition( lTransform );\n\n\tconst lGlobalTranslation = lParentGX.clone().multiply( lLocalTWithAllPivotAndOffsetInfo );\n\tlGlobalT.copyPosition( lGlobalTranslation );\n\n\tlTransform = lGlobalT.clone().multiply( lGlobalRS );\n\n\t// from global to local\n\tlTransform.premultiply( lParentGX.invert() );\n\n\treturn lTransform;\n\n}\n\n// Returns the three.js intrinsic Euler order corresponding to FBX extrinsic Euler order\n// ref: http://help.autodesk.com/view/FBX/2017/ENU/?guid=__cpp_ref_class_fbx_euler_html\nfunction getEulerOrder( order ) {\n\n\torder = order || 0;\n\n\tconst enums = [\n\t\t'ZYX', // -> XYZ extrinsic\n\t\t'YZX', // -> XZY extrinsic\n\t\t'XZY', // -> YZX extrinsic\n\t\t'ZXY', // -> YXZ extrinsic\n\t\t'YXZ', // -> ZXY extrinsic\n\t\t'XYZ', // -> ZYX extrinsic\n\t\t//'SphericXYZ', // not possible to support\n\t];\n\n\tif ( order === 6 ) {\n\n\t\tconsole.warn( 'THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect.' );\n\t\treturn enums[ 0 ];\n\n\t}\n\n\treturn enums[ order ];\n\n}\n\n// Parses comma separated list of numbers and returns them an array.\n// Used internally by the TextParser\nfunction parseNumberArray( value ) {\n\n\tconst array = value.split( ',' ).map( function ( val ) {\n\n\t\treturn parseFloat( val );\n\n\t} );\n\n\treturn array;\n\n}\n\nfunction convertArrayBufferToString( buffer, from, to ) {\n\n\tif ( from === undefined ) from = 0;\n\tif ( to === undefined ) to = buffer.byteLength;\n\n\treturn LoaderUtils.decodeText( new Uint8Array( buffer, from, to ) );\n\n}\n\nfunction append( a, b ) {\n\n\tfor ( let i = 0, j = a.length, l = b.length; i < l; i ++, j ++ ) {\n\n\t\ta[ j ] = b[ i ];\n\n\t}\n\n}\n\nfunction slice( a, b, from, to ) {\n\n\tfor ( let i = from, j = 0; i < to; i ++, j ++ ) {\n\n\t\ta[ j ] = b[ i ];\n\n\t}\n\n\treturn a;\n\n}\n\n// inject array a2 into array a1 at index\nfunction inject( a1, index, a2 ) {\n\n\treturn a1.slice( 0, index ).concat( a2 ).concat( a1.slice( index ) );\n\n}\n\nexport { FBXLoader };\n","import {\n\tBufferGeometry,\n\tFileLoader,\n\tFloat32BufferAttribute,\n\tGroup,\n\tLineBasicMaterial,\n\tLineSegments,\n\tLoader,\n\tMaterial,\n\tMesh,\n\tMeshPhongMaterial,\n\tPoints,\n\tPointsMaterial,\n\tVector3\n} from 'three';\n\n// o object_name | g group_name\nconst _object_pattern = /^[og]\\s*(.+)?/;\n// mtllib file_reference\nconst _material_library_pattern = /^mtllib /;\n// usemtl material_name\nconst _material_use_pattern = /^usemtl /;\n// usemap map_name\nconst _map_use_pattern = /^usemap /;\n\nconst _vA = new Vector3();\nconst _vB = new Vector3();\nconst _vC = new Vector3();\n\nconst _ab = new Vector3();\nconst _cb = new Vector3();\n\nfunction ParserState() {\n\n\tconst state = {\n\t\tobjects: [],\n\t\tobject: {},\n\n\t\tvertices: [],\n\t\tnormals: [],\n\t\tcolors: [],\n\t\tuvs: [],\n\n\t\tmaterials: {},\n\t\tmaterialLibraries: [],\n\n\t\tstartObject: function ( name, fromDeclaration ) {\n\n\t\t\t// If the current object (initial from reset) is not from a g/o declaration in the parsed\n\t\t\t// file. We need to use it for the first parsed g/o to keep things in sync.\n\t\t\tif ( this.object && this.object.fromDeclaration === false ) {\n\n\t\t\t\tthis.object.name = name;\n\t\t\t\tthis.object.fromDeclaration = ( fromDeclaration !== false );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tconst previousMaterial = ( this.object && typeof this.object.currentMaterial === 'function' ? this.object.currentMaterial() : undefined );\n\n\t\t\tif ( this.object && typeof this.object._finalize === 'function' ) {\n\n\t\t\t\tthis.object._finalize( true );\n\n\t\t\t}\n\n\t\t\tthis.object = {\n\t\t\t\tname: name || '',\n\t\t\t\tfromDeclaration: ( fromDeclaration !== false ),\n\n\t\t\t\tgeometry: {\n\t\t\t\t\tvertices: [],\n\t\t\t\t\tnormals: [],\n\t\t\t\t\tcolors: [],\n\t\t\t\t\tuvs: [],\n\t\t\t\t\thasUVIndices: false\n\t\t\t\t},\n\t\t\t\tmaterials: [],\n\t\t\t\tsmooth: true,\n\n\t\t\t\tstartMaterial: function ( name, libraries ) {\n\n\t\t\t\t\tconst previous = this._finalize( false );\n\n\t\t\t\t\t// New usemtl declaration overwrites an inherited material, except if faces were declared\n\t\t\t\t\t// after the material, then it must be preserved for proper MultiMaterial continuation.\n\t\t\t\t\tif ( previous && ( previous.inherited || previous.groupCount <= 0 ) ) {\n\n\t\t\t\t\t\tthis.materials.splice( previous.index, 1 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst material = {\n\t\t\t\t\t\tindex: this.materials.length,\n\t\t\t\t\t\tname: name || '',\n\t\t\t\t\t\tmtllib: ( Array.isArray( libraries ) && libraries.length > 0 ? libraries[ libraries.length - 1 ] : '' ),\n\t\t\t\t\t\tsmooth: ( previous !== undefined ? previous.smooth : this.smooth ),\n\t\t\t\t\t\tgroupStart: ( previous !== undefined ? previous.groupEnd : 0 ),\n\t\t\t\t\t\tgroupEnd: - 1,\n\t\t\t\t\t\tgroupCount: - 1,\n\t\t\t\t\t\tinherited: false,\n\n\t\t\t\t\t\tclone: function ( index ) {\n\n\t\t\t\t\t\t\tconst cloned = {\n\t\t\t\t\t\t\t\tindex: ( typeof index === 'number' ? index : this.index ),\n\t\t\t\t\t\t\t\tname: this.name,\n\t\t\t\t\t\t\t\tmtllib: this.mtllib,\n\t\t\t\t\t\t\t\tsmooth: this.smooth,\n\t\t\t\t\t\t\t\tgroupStart: 0,\n\t\t\t\t\t\t\t\tgroupEnd: - 1,\n\t\t\t\t\t\t\t\tgroupCount: - 1,\n\t\t\t\t\t\t\t\tinherited: false\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tcloned.clone = this.clone.bind( cloned );\n\t\t\t\t\t\t\treturn cloned;\n\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\n\t\t\t\t\tthis.materials.push( material );\n\n\t\t\t\t\treturn material;\n\n\t\t\t\t},\n\n\t\t\t\tcurrentMaterial: function () {\n\n\t\t\t\t\tif ( this.materials.length > 0 ) {\n\n\t\t\t\t\t\treturn this.materials[ this.materials.length - 1 ];\n\n\t\t\t\t\t}\n\n\t\t\t\t\treturn undefined;\n\n\t\t\t\t},\n\n\t\t\t\t_finalize: function ( end ) {\n\n\t\t\t\t\tconst lastMultiMaterial = this.currentMaterial();\n\t\t\t\t\tif ( lastMultiMaterial && lastMultiMaterial.groupEnd === - 1 ) {\n\n\t\t\t\t\t\tlastMultiMaterial.groupEnd = this.geometry.vertices.length / 3;\n\t\t\t\t\t\tlastMultiMaterial.groupCount = lastMultiMaterial.groupEnd - lastMultiMaterial.groupStart;\n\t\t\t\t\t\tlastMultiMaterial.inherited = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Ignore objects tail materials if no face declarations followed them before a new o/g started.\n\t\t\t\t\tif ( end && this.materials.length > 1 ) {\n\n\t\t\t\t\t\tfor ( let mi = this.materials.length - 1; mi >= 0; mi -- ) {\n\n\t\t\t\t\t\t\tif ( this.materials[ mi ].groupCount <= 0 ) {\n\n\t\t\t\t\t\t\t\tthis.materials.splice( mi, 1 );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Guarantee at least one empty material, this makes the creation later more straight forward.\n\t\t\t\t\tif ( end && this.materials.length === 0 ) {\n\n\t\t\t\t\t\tthis.materials.push( {\n\t\t\t\t\t\t\tname: '',\n\t\t\t\t\t\t\tsmooth: this.smooth\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t}\n\n\t\t\t\t\treturn lastMultiMaterial;\n\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t// Inherit previous objects material.\n\t\t\t// Spec tells us that a declared material must be set to all objects until a new material is declared.\n\t\t\t// If a usemtl declaration is encountered while this new object is being parsed, it will\n\t\t\t// overwrite the inherited material. Exception being that there was already face declarations\n\t\t\t// to the inherited material, then it will be preserved for proper MultiMaterial continuation.\n\n\t\t\tif ( previousMaterial && previousMaterial.name && typeof previousMaterial.clone === 'function' ) {\n\n\t\t\t\tconst declared = previousMaterial.clone( 0 );\n\t\t\t\tdeclared.inherited = true;\n\t\t\t\tthis.object.materials.push( declared );\n\n\t\t\t}\n\n\t\t\tthis.objects.push( this.object );\n\n\t\t},\n\n\t\tfinalize: function () {\n\n\t\t\tif ( this.object && typeof this.object._finalize === 'function' ) {\n\n\t\t\t\tthis.object._finalize( true );\n\n\t\t\t}\n\n\t\t},\n\n\t\tparseVertexIndex: function ( value, len ) {\n\n\t\t\tconst index = parseInt( value, 10 );\n\t\t\treturn ( index >= 0 ? index - 1 : index + len / 3 ) * 3;\n\n\t\t},\n\n\t\tparseNormalIndex: function ( value, len ) {\n\n\t\t\tconst index = parseInt( value, 10 );\n\t\t\treturn ( index >= 0 ? index - 1 : index + len / 3 ) * 3;\n\n\t\t},\n\n\t\tparseUVIndex: function ( value, len ) {\n\n\t\t\tconst index = parseInt( value, 10 );\n\t\t\treturn ( index >= 0 ? index - 1 : index + len / 2 ) * 2;\n\n\t\t},\n\n\t\taddVertex: function ( a, b, c ) {\n\n\t\t\tconst src = this.vertices;\n\t\t\tconst dst = this.object.geometry.vertices;\n\n\t\t\tdst.push( src[ a + 0 ], src[ a + 1 ], src[ a + 2 ] );\n\t\t\tdst.push( src[ b + 0 ], src[ b + 1 ], src[ b + 2 ] );\n\t\t\tdst.push( src[ c + 0 ], src[ c + 1 ], src[ c + 2 ] );\n\n\t\t},\n\n\t\taddVertexPoint: function ( a ) {\n\n\t\t\tconst src = this.vertices;\n\t\t\tconst dst = this.object.geometry.vertices;\n\n\t\t\tdst.push( src[ a + 0 ], src[ a + 1 ], src[ a + 2 ] );\n\n\t\t},\n\n\t\taddVertexLine: function ( a ) {\n\n\t\t\tconst src = this.vertices;\n\t\t\tconst dst = this.object.geometry.vertices;\n\n\t\t\tdst.push( src[ a + 0 ], src[ a + 1 ], src[ a + 2 ] );\n\n\t\t},\n\n\t\taddNormal: function ( a, b, c ) {\n\n\t\t\tconst src = this.normals;\n\t\t\tconst dst = this.object.geometry.normals;\n\n\t\t\tdst.push( src[ a + 0 ], src[ a + 1 ], src[ a + 2 ] );\n\t\t\tdst.push( src[ b + 0 ], src[ b + 1 ], src[ b + 2 ] );\n\t\t\tdst.push( src[ c + 0 ], src[ c + 1 ], src[ c + 2 ] );\n\n\t\t},\n\n\t\taddFaceNormal: function ( a, b, c ) {\n\n\t\t\tconst src = this.vertices;\n\t\t\tconst dst = this.object.geometry.normals;\n\n\t\t\t_vA.fromArray( src, a );\n\t\t\t_vB.fromArray( src, b );\n\t\t\t_vC.fromArray( src, c );\n\n\t\t\t_cb.subVectors( _vC, _vB );\n\t\t\t_ab.subVectors( _vA, _vB );\n\t\t\t_cb.cross( _ab );\n\n\t\t\t_cb.normalize();\n\n\t\t\tdst.push( _cb.x, _cb.y, _cb.z );\n\t\t\tdst.push( _cb.x, _cb.y, _cb.z );\n\t\t\tdst.push( _cb.x, _cb.y, _cb.z );\n\n\t\t},\n\n\t\taddColor: function ( a, b, c ) {\n\n\t\t\tconst src = this.colors;\n\t\t\tconst dst = this.object.geometry.colors;\n\n\t\t\tif ( src[ a ] !== undefined ) dst.push( src[ a + 0 ], src[ a + 1 ], src[ a + 2 ] );\n\t\t\tif ( src[ b ] !== undefined ) dst.push( src[ b + 0 ], src[ b + 1 ], src[ b + 2 ] );\n\t\t\tif ( src[ c ] !== undefined ) dst.push( src[ c + 0 ], src[ c + 1 ], src[ c + 2 ] );\n\n\t\t},\n\n\t\taddUV: function ( a, b, c ) {\n\n\t\t\tconst src = this.uvs;\n\t\t\tconst dst = this.object.geometry.uvs;\n\n\t\t\tdst.push( src[ a + 0 ], src[ a + 1 ] );\n\t\t\tdst.push( src[ b + 0 ], src[ b + 1 ] );\n\t\t\tdst.push( src[ c + 0 ], src[ c + 1 ] );\n\n\t\t},\n\n\t\taddDefaultUV: function () {\n\n\t\t\tconst dst = this.object.geometry.uvs;\n\n\t\t\tdst.push( 0, 0 );\n\t\t\tdst.push( 0, 0 );\n\t\t\tdst.push( 0, 0 );\n\n\t\t},\n\n\t\taddUVLine: function ( a ) {\n\n\t\t\tconst src = this.uvs;\n\t\t\tconst dst = this.object.geometry.uvs;\n\n\t\t\tdst.push( src[ a + 0 ], src[ a + 1 ] );\n\n\t\t},\n\n\t\taddFace: function ( a, b, c, ua, ub, uc, na, nb, nc ) {\n\n\t\t\tconst vLen = this.vertices.length;\n\n\t\t\tlet ia = this.parseVertexIndex( a, vLen );\n\t\t\tlet ib = this.parseVertexIndex( b, vLen );\n\t\t\tlet ic = this.parseVertexIndex( c, vLen );\n\n\t\t\tthis.addVertex( ia, ib, ic );\n\t\t\tthis.addColor( ia, ib, ic );\n\n\t\t\t// normals\n\n\t\t\tif ( na !== undefined && na !== '' ) {\n\n\t\t\t\tconst nLen = this.normals.length;\n\n\t\t\t\tia = this.parseNormalIndex( na, nLen );\n\t\t\t\tib = this.parseNormalIndex( nb, nLen );\n\t\t\t\tic = this.parseNormalIndex( nc, nLen );\n\n\t\t\t\tthis.addNormal( ia, ib, ic );\n\n\t\t\t} else {\n\n\t\t\t\tthis.addFaceNormal( ia, ib, ic );\n\n\t\t\t}\n\n\t\t\t// uvs\n\n\t\t\tif ( ua !== undefined && ua !== '' ) {\n\n\t\t\t\tconst uvLen = this.uvs.length;\n\n\t\t\t\tia = this.parseUVIndex( ua, uvLen );\n\t\t\t\tib = this.parseUVIndex( ub, uvLen );\n\t\t\t\tic = this.parseUVIndex( uc, uvLen );\n\n\t\t\t\tthis.addUV( ia, ib, ic );\n\n\t\t\t\tthis.object.geometry.hasUVIndices = true;\n\n\t\t\t} else {\n\n\t\t\t\t// add placeholder values (for inconsistent face definitions)\n\n\t\t\t\tthis.addDefaultUV();\n\n\t\t\t}\n\n\t\t},\n\n\t\taddPointGeometry: function ( vertices ) {\n\n\t\t\tthis.object.geometry.type = 'Points';\n\n\t\t\tconst vLen = this.vertices.length;\n\n\t\t\tfor ( let vi = 0, l = vertices.length; vi < l; vi ++ ) {\n\n\t\t\t\tconst index = this.parseVertexIndex( vertices[ vi ], vLen );\n\n\t\t\t\tthis.addVertexPoint( index );\n\t\t\t\tthis.addColor( index );\n\n\t\t\t}\n\n\t\t},\n\n\t\taddLineGeometry: function ( vertices, uvs ) {\n\n\t\t\tthis.object.geometry.type = 'Line';\n\n\t\t\tconst vLen = this.vertices.length;\n\t\t\tconst uvLen = this.uvs.length;\n\n\t\t\tfor ( let vi = 0, l = vertices.length; vi < l; vi ++ ) {\n\n\t\t\t\tthis.addVertexLine( this.parseVertexIndex( vertices[ vi ], vLen ) );\n\n\t\t\t}\n\n\t\t\tfor ( let uvi = 0, l = uvs.length; uvi < l; uvi ++ ) {\n\n\t\t\t\tthis.addUVLine( this.parseUVIndex( uvs[ uvi ], uvLen ) );\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\tstate.startObject( '', false );\n\n\treturn state;\n\n}\n\n//\n\nclass OBJLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tthis.materials = null;\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( this.path );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\t\tloader.load( url, function ( text ) {\n\n\t\t\ttry {\n\n\t\t\t\tonLoad( scope.parse( text ) );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tsetMaterials( materials ) {\n\n\t\tthis.materials = materials;\n\n\t\treturn this;\n\n\t}\n\n\tparse( text ) {\n\n\t\tconst state = new ParserState();\n\n\t\tif ( text.indexOf( '\\r\\n' ) !== - 1 ) {\n\n\t\t\t// This is faster than String.split with regex that splits on both\n\t\t\ttext = text.replace( /\\r\\n/g, '\\n' );\n\n\t\t}\n\n\t\tif ( text.indexOf( '\\\\\\n' ) !== - 1 ) {\n\n\t\t\t// join lines separated by a line continuation character (\\)\n\t\t\ttext = text.replace( /\\\\\\n/g, '' );\n\n\t\t}\n\n\t\tconst lines = text.split( '\\n' );\n\t\tlet line = '', lineFirstChar = '';\n\t\tlet lineLength = 0;\n\t\tlet result = [];\n\n\t\t// Faster to just trim left side of the line. Use if available.\n\t\tconst trimLeft = ( typeof ''.trimLeft === 'function' );\n\n\t\tfor ( let i = 0, l = lines.length; i < l; i ++ ) {\n\n\t\t\tline = lines[ i ];\n\n\t\t\tline = trimLeft ? line.trimLeft() : line.trim();\n\n\t\t\tlineLength = line.length;\n\n\t\t\tif ( lineLength === 0 ) continue;\n\n\t\t\tlineFirstChar = line.charAt( 0 );\n\n\t\t\t// @todo invoke passed in handler if any\n\t\t\tif ( lineFirstChar === '#' ) continue;\n\n\t\t\tif ( lineFirstChar === 'v' ) {\n\n\t\t\t\tconst data = line.split( /\\s+/ );\n\n\t\t\t\tswitch ( data[ 0 ] ) {\n\n\t\t\t\t\tcase 'v':\n\t\t\t\t\t\tstate.vertices.push(\n\t\t\t\t\t\t\tparseFloat( data[ 1 ] ),\n\t\t\t\t\t\t\tparseFloat( data[ 2 ] ),\n\t\t\t\t\t\t\tparseFloat( data[ 3 ] )\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif ( data.length >= 7 ) {\n\n\t\t\t\t\t\t\tstate.colors.push(\n\t\t\t\t\t\t\t\tparseFloat( data[ 4 ] ),\n\t\t\t\t\t\t\t\tparseFloat( data[ 5 ] ),\n\t\t\t\t\t\t\t\tparseFloat( data[ 6 ] )\n\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t// if no colors are defined, add placeholders so color and vertex indices match\n\n\t\t\t\t\t\t\tstate.colors.push( undefined, undefined, undefined );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'vn':\n\t\t\t\t\t\tstate.normals.push(\n\t\t\t\t\t\t\tparseFloat( data[ 1 ] ),\n\t\t\t\t\t\t\tparseFloat( data[ 2 ] ),\n\t\t\t\t\t\t\tparseFloat( data[ 3 ] )\n\t\t\t\t\t\t);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'vt':\n\t\t\t\t\t\tstate.uvs.push(\n\t\t\t\t\t\t\tparseFloat( data[ 1 ] ),\n\t\t\t\t\t\t\tparseFloat( data[ 2 ] )\n\t\t\t\t\t\t);\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t} else if ( lineFirstChar === 'f' ) {\n\n\t\t\t\tconst lineData = line.substr( 1 ).trim();\n\t\t\t\tconst vertexData = lineData.split( /\\s+/ );\n\t\t\t\tconst faceVertices = [];\n\n\t\t\t\t// Parse the face vertex data into an easy to work with format\n\n\t\t\t\tfor ( let j = 0, jl = vertexData.length; j < jl; j ++ ) {\n\n\t\t\t\t\tconst vertex = vertexData[ j ];\n\n\t\t\t\t\tif ( vertex.length > 0 ) {\n\n\t\t\t\t\t\tconst vertexParts = vertex.split( '/' );\n\t\t\t\t\t\tfaceVertices.push( vertexParts );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// Draw an edge between the first vertex and all subsequent vertices to form an n-gon\n\n\t\t\t\tconst v1 = faceVertices[ 0 ];\n\n\t\t\t\tfor ( let j = 1, jl = faceVertices.length - 1; j < jl; j ++ ) {\n\n\t\t\t\t\tconst v2 = faceVertices[ j ];\n\t\t\t\t\tconst v3 = faceVertices[ j + 1 ];\n\n\t\t\t\t\tstate.addFace(\n\t\t\t\t\t\tv1[ 0 ], v2[ 0 ], v3[ 0 ],\n\t\t\t\t\t\tv1[ 1 ], v2[ 1 ], v3[ 1 ],\n\t\t\t\t\t\tv1[ 2 ], v2[ 2 ], v3[ 2 ]\n\t\t\t\t\t);\n\n\t\t\t\t}\n\n\t\t\t} else if ( lineFirstChar === 'l' ) {\n\n\t\t\t\tconst lineParts = line.substring( 1 ).trim().split( ' ' );\n\t\t\t\tlet lineVertices = [];\n\t\t\t\tconst lineUVs = [];\n\n\t\t\t\tif ( line.indexOf( '/' ) === - 1 ) {\n\n\t\t\t\t\tlineVertices = lineParts;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tfor ( let li = 0, llen = lineParts.length; li < llen; li ++ ) {\n\n\t\t\t\t\t\tconst parts = lineParts[ li ].split( '/' );\n\n\t\t\t\t\t\tif ( parts[ 0 ] !== '' ) lineVertices.push( parts[ 0 ] );\n\t\t\t\t\t\tif ( parts[ 1 ] !== '' ) lineUVs.push( parts[ 1 ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tstate.addLineGeometry( lineVertices, lineUVs );\n\n\t\t\t} else if ( lineFirstChar === 'p' ) {\n\n\t\t\t\tconst lineData = line.substr( 1 ).trim();\n\t\t\t\tconst pointData = lineData.split( ' ' );\n\n\t\t\t\tstate.addPointGeometry( pointData );\n\n\t\t\t} else if ( ( result = _object_pattern.exec( line ) ) !== null ) {\n\n\t\t\t\t// o object_name\n\t\t\t\t// or\n\t\t\t\t// g group_name\n\n\t\t\t\t// WORKAROUND: https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t// let name = result[ 0 ].substr( 1 ).trim();\n\t\t\t\tconst name = ( ' ' + result[ 0 ].substr( 1 ).trim() ).substr( 1 );\n\n\t\t\t\tstate.startObject( name );\n\n\t\t\t} else if ( _material_use_pattern.test( line ) ) {\n\n\t\t\t\t// material\n\n\t\t\t\tstate.object.startMaterial( line.substring( 7 ).trim(), state.materialLibraries );\n\n\t\t\t} else if ( _material_library_pattern.test( line ) ) {\n\n\t\t\t\t// mtl file\n\n\t\t\t\tstate.materialLibraries.push( line.substring( 7 ).trim() );\n\n\t\t\t} else if ( _map_use_pattern.test( line ) ) {\n\n\t\t\t\t// the line is parsed but ignored since the loader assumes textures are defined MTL files\n\t\t\t\t// (according to https://www.okino.com/conv/imp_wave.htm, 'usemap' is the old-style Wavefront texture reference method)\n\n\t\t\t\tconsole.warn( 'THREE.OBJLoader: Rendering identifier \"usemap\" not supported. Textures must be defined in MTL files.' );\n\n\t\t\t} else if ( lineFirstChar === 's' ) {\n\n\t\t\t\tresult = line.split( ' ' );\n\n\t\t\t\t// smooth shading\n\n\t\t\t\t// @todo Handle files that have varying smooth values for a set of faces inside one geometry,\n\t\t\t\t// but does not define a usemtl for each face set.\n\t\t\t\t// This should be detected and a dummy material created (later MultiMaterial and geometry groups).\n\t\t\t\t// This requires some care to not create extra material on each smooth value for \"normal\" obj files.\n\t\t\t\t// where explicit usemtl defines geometry groups.\n\t\t\t\t// Example asset: examples/models/obj/cerberus/Cerberus.obj\n\n\t\t\t\t/*\n\t\t\t\t\t * http://paulbourke.net/dataformats/obj/\n\t\t\t\t\t *\n\t\t\t\t\t * From chapter \"Grouping\" Syntax explanation \"s group_number\":\n\t\t\t\t\t * \"group_number is the smoothing group number. To turn off smoothing groups, use a value of 0 or off.\n\t\t\t\t\t * Polygonal elements use group numbers to put elements in different smoothing groups. For free-form\n\t\t\t\t\t * surfaces, smoothing groups are either turned on or off; there is no difference between values greater\n\t\t\t\t\t * than 0.\"\n\t\t\t\t\t */\n\t\t\t\tif ( result.length > 1 ) {\n\n\t\t\t\t\tconst value = result[ 1 ].trim().toLowerCase();\n\t\t\t\t\tstate.object.smooth = ( value !== '0' && value !== 'off' );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// ZBrush can produce \"s\" lines #11707\n\t\t\t\t\tstate.object.smooth = true;\n\n\t\t\t\t}\n\n\t\t\t\tconst material = state.object.currentMaterial();\n\t\t\t\tif ( material ) material.smooth = state.object.smooth;\n\n\t\t\t} else {\n\n\t\t\t\t// Handle null terminated files without exception\n\t\t\t\tif ( line === '\\0' ) continue;\n\n\t\t\t\tconsole.warn( 'THREE.OBJLoader: Unexpected line: \"' + line + '\"' );\n\n\t\t\t}\n\n\t\t}\n\n\t\tstate.finalize();\n\n\t\tconst container = new Group();\n\t\tcontainer.materialLibraries = [].concat( state.materialLibraries );\n\n\t\tconst hasPrimitives = ! ( state.objects.length === 1 && state.objects[ 0 ].geometry.vertices.length === 0 );\n\n\t\tif ( hasPrimitives === true ) {\n\n\t\t\tfor ( let i = 0, l = state.objects.length; i < l; i ++ ) {\n\n\t\t\t\tconst object = state.objects[ i ];\n\t\t\t\tconst geometry = object.geometry;\n\t\t\t\tconst materials = object.materials;\n\t\t\t\tconst isLine = ( geometry.type === 'Line' );\n\t\t\t\tconst isPoints = ( geometry.type === 'Points' );\n\t\t\t\tlet hasVertexColors = false;\n\n\t\t\t\t// Skip o/g line declarations that did not follow with any faces\n\t\t\t\tif ( geometry.vertices.length === 0 ) continue;\n\n\t\t\t\tconst buffergeometry = new BufferGeometry();\n\n\t\t\t\tbuffergeometry.setAttribute( 'position', new Float32BufferAttribute( geometry.vertices, 3 ) );\n\n\t\t\t\tif ( geometry.normals.length > 0 ) {\n\n\t\t\t\t\tbuffergeometry.setAttribute( 'normal', new Float32BufferAttribute( geometry.normals, 3 ) );\n\n\t\t\t\t}\n\n\t\t\t\tif ( geometry.colors.length > 0 ) {\n\n\t\t\t\t\thasVertexColors = true;\n\t\t\t\t\tbuffergeometry.setAttribute( 'color', new Float32BufferAttribute( geometry.colors, 3 ) );\n\n\t\t\t\t}\n\n\t\t\t\tif ( geometry.hasUVIndices === true ) {\n\n\t\t\t\t\tbuffergeometry.setAttribute( 'uv', new Float32BufferAttribute( geometry.uvs, 2 ) );\n\n\t\t\t\t}\n\n\t\t\t\t// Create materials\n\n\t\t\t\tconst createdMaterials = [];\n\n\t\t\t\tfor ( let mi = 0, miLen = materials.length; mi < miLen; mi ++ ) {\n\n\t\t\t\t\tconst sourceMaterial = materials[ mi ];\n\t\t\t\t\tconst materialHash = sourceMaterial.name + '_' + sourceMaterial.smooth + '_' + hasVertexColors;\n\t\t\t\t\tlet material = state.materials[ materialHash ];\n\n\t\t\t\t\tif ( this.materials !== null ) {\n\n\t\t\t\t\t\tmaterial = this.materials.create( sourceMaterial.name );\n\n\t\t\t\t\t\t// mtl etc. loaders probably can't create line materials correctly, copy properties to a line material.\n\t\t\t\t\t\tif ( isLine && material && ! ( material instanceof LineBasicMaterial ) ) {\n\n\t\t\t\t\t\t\tconst materialLine = new LineBasicMaterial();\n\t\t\t\t\t\t\tMaterial.prototype.copy.call( materialLine, material );\n\t\t\t\t\t\t\tmaterialLine.color.copy( material.color );\n\t\t\t\t\t\t\tmaterial = materialLine;\n\n\t\t\t\t\t\t} else if ( isPoints && material && ! ( material instanceof PointsMaterial ) ) {\n\n\t\t\t\t\t\t\tconst materialPoints = new PointsMaterial( { size: 10, sizeAttenuation: false } );\n\t\t\t\t\t\t\tMaterial.prototype.copy.call( materialPoints, material );\n\t\t\t\t\t\t\tmaterialPoints.color.copy( material.color );\n\t\t\t\t\t\t\tmaterialPoints.map = material.map;\n\t\t\t\t\t\t\tmaterial = materialPoints;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( material === undefined ) {\n\n\t\t\t\t\t\tif ( isLine ) {\n\n\t\t\t\t\t\t\tmaterial = new LineBasicMaterial();\n\n\t\t\t\t\t\t} else if ( isPoints ) {\n\n\t\t\t\t\t\t\tmaterial = new PointsMaterial( { size: 1, sizeAttenuation: false } );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tmaterial = new MeshPhongMaterial();\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tmaterial.name = sourceMaterial.name;\n\t\t\t\t\t\tmaterial.flatShading = sourceMaterial.smooth ? false : true;\n\t\t\t\t\t\tmaterial.vertexColors = hasVertexColors;\n\n\t\t\t\t\t\tstate.materials[ materialHash ] = material;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tcreatedMaterials.push( material );\n\n\t\t\t\t}\n\n\t\t\t\t// Create mesh\n\n\t\t\t\tlet mesh;\n\n\t\t\t\tif ( createdMaterials.length > 1 ) {\n\n\t\t\t\t\tfor ( let mi = 0, miLen = materials.length; mi < miLen; mi ++ ) {\n\n\t\t\t\t\t\tconst sourceMaterial = materials[ mi ];\n\t\t\t\t\t\tbuffergeometry.addGroup( sourceMaterial.groupStart, sourceMaterial.groupCount, mi );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( isLine ) {\n\n\t\t\t\t\t\tmesh = new LineSegments( buffergeometry, createdMaterials );\n\n\t\t\t\t\t} else if ( isPoints ) {\n\n\t\t\t\t\t\tmesh = new Points( buffergeometry, createdMaterials );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tmesh = new Mesh( buffergeometry, createdMaterials );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( isLine ) {\n\n\t\t\t\t\t\tmesh = new LineSegments( buffergeometry, createdMaterials[ 0 ] );\n\n\t\t\t\t\t} else if ( isPoints ) {\n\n\t\t\t\t\t\tmesh = new Points( buffergeometry, createdMaterials[ 0 ] );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tmesh = new Mesh( buffergeometry, createdMaterials[ 0 ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tmesh.name = object.name;\n\n\t\t\t\tcontainer.add( mesh );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// if there is only the default parser state object with no geometry data, interpret data as point cloud\n\n\t\t\tif ( state.vertices.length > 0 ) {\n\n\t\t\t\tconst material = new PointsMaterial( { size: 1, sizeAttenuation: false } );\n\n\t\t\t\tconst buffergeometry = new BufferGeometry();\n\n\t\t\t\tbuffergeometry.setAttribute( 'position', new Float32BufferAttribute( state.vertices, 3 ) );\n\n\t\t\t\tif ( state.colors.length > 0 && state.colors[ 0 ] !== undefined ) {\n\n\t\t\t\t\tbuffergeometry.setAttribute( 'color', new Float32BufferAttribute( state.colors, 3 ) );\n\t\t\t\t\tmaterial.vertexColors = true;\n\n\t\t\t\t}\n\n\t\t\t\tconst points = new Points( buffergeometry, material );\n\t\t\t\tcontainer.add( points );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn container;\n\n\t}\n\n}\n\nexport { OBJLoader };\n"],"sourceRoot":""}