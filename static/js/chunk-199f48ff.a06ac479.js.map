{"version":3,"sources":["webpack:///./node_modules/rbush/index.js","webpack:///./node_modules/core-js/internals/function-bind.js","webpack:///./node_modules/maptalks/dist/maptalks.es-bundler.js","webpack:///./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack:///./node_modules/@babel/runtime/helpers/esm/inherits.js","webpack:///./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js","webpack:///./node_modules/@babel/runtime/helpers/esm/isNativeReflectConstruct.js","webpack:///./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack:///./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js","webpack:///./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js","webpack:///./node_modules/@babel/runtime/helpers/esm/createSuper.js","webpack:///./node_modules/core-js/modules/es.object.get-prototype-of.js","webpack:///./node_modules/node-libs-browser/mock/process.js","webpack:///./node_modules/core-js/modules/es.reflect.construct.js","webpack:///./src/views/three-demo/city-shanghai.vue?ef0d","webpack:///./node_modules/simplify-js/simplify.js","webpack:///./node_modules/earcut/src/earcut.js","webpack:///./node_modules/maptalks.three/dist/util/ThreeAdaptUtil.js","webpack:///./node_modules/maptalks.three/dist/util/fatline/LineSegmentsGeometry.js","webpack:///./node_modules/maptalks.three/dist/util/fatline/LineMaterial.js","webpack:///./node_modules/maptalks.three/dist/util/fatline/LineSegments2.js","webpack:///./node_modules/maptalks.three/dist/util/fatline/LineGeometry.js","webpack:///./node_modules/maptalks.three/dist/util/fatline/Line2.js","webpack:///./node_modules/maptalks.three/dist/BaseObject.js","webpack:///./node_modules/maptalks.three/dist/util/MergeGeometryUtil.js","webpack:///./node_modules/maptalks.three/dist/util/BarUtil.js","webpack:///./node_modules/maptalks.three/dist/Bar.js","webpack:///./node_modules/maptalks.three/dist/util/GeoJSONUtil.js","webpack:///./node_modules/deyihu-geometry-extrude/src/simplify.js","webpack:///./node_modules/deyihu-geometry-extrude/src/math.js","webpack:///./node_modules/deyihu-geometry-extrude/src/main.js","webpack:///./node_modules/maptalks.three/dist/util/index.js","webpack:///./node_modules/maptalks.three/dist/util/ExtrudeUtil.js","webpack:///./node_modules/maptalks.three/dist/util/LineUtil.js","webpack:///./node_modules/maptalks.three/dist/worker/worker.js","webpack:///./node_modules/maptalks.three/dist/worker/MeshActor.js","webpack:///./node_modules/maptalks.three/dist/BaseObjectTaskManager.js","webpack:///./node_modules/maptalks.three/dist/Line.js","webpack:///./node_modules/maptalks.three/dist/ExtrudeLine.js","webpack:///./node_modules/maptalks.three/dist/ExtrudePolygon.js","webpack:///./node_modules/maptalks.three/dist/Model.js","webpack:///./node_modules/maptalks.three/dist/util/GeoUtil.js","webpack:///./node_modules/maptalks.three/dist/ExtrudeLineTrail.js","webpack:///./node_modules/maptalks.three/dist/MergedMixin.js","webpack:///./node_modules/maptalks.three/dist/ExtrudePolygons.js","webpack:///./node_modules/maptalks.three/dist/util/IdentifyUtil.js","webpack:///./node_modules/maptalks.three/dist/Point.js","webpack:///./node_modules/maptalks.three/dist/util/BBox.js","webpack:///./node_modules/maptalks.three/dist/Points.js","webpack:///./node_modules/maptalks.three/dist/Bars.js","webpack:///./node_modules/maptalks.three/dist/ExtrudeLines.js","webpack:///./node_modules/maptalks.three/dist/Lines.js","webpack:///./node_modules/maptalks.three/dist/queue/TileDataQueue.js","webpack:///./node_modules/maptalks.three/dist/util/CanvasUtil.js","webpack:///./node_modules/maptalks.three/dist/BaseVectorTileLayer.js","webpack:///./node_modules/maptalks.three/dist/ThreeVectorTileLayer.js","webpack:///./node_modules/maptalks.three/dist/util/GeometryUtil.js","webpack:///./node_modules/maptalks.three/dist/Terrain.js","webpack:///./node_modules/maptalks.three/dist/TerrainVectorTileLayer.js","webpack:///./node_modules/maptalks.three/dist/util/heatmap/Intensity.js","webpack:///./node_modules/maptalks.three/dist/util/heatmap/HeatMapUtil.js","webpack:///./node_modules/maptalks.three/dist/HeatMap.js","webpack:///./node_modules/maptalks.three/dist/GPUPick.js","webpack:///./node_modules/maptalks.three/dist/FatLine.js","webpack:///./node_modules/maptalks.three/dist/FatLines.js","webpack:///./node_modules/maptalks.three/dist/Box.js","webpack:///./node_modules/maptalks.three/dist/Boxs.js","webpack:///./node_modules/maptalks.three/dist/worker/getworker.js","webpack:///./node_modules/maptalks.three/dist/worker/fetchdataworker.js","webpack:///./node_modules/maptalks.three/dist/index.js","webpack:///./node_modules/quickselect/quickselect.js","webpack:///./src/utils/UnrealBloomPass.js","webpack:///./src/views/three-demo/city-shanghai.vue?6226","webpack:///./src/views/three-demo/city-shanghai.vue?56c1","webpack:///src/views/three-demo/city-shanghai.vue","webpack:///./src/views/three-demo/city-shanghai.vue?dc25","webpack:///./src/views/three-demo/city-shanghai.vue","webpack:///./node_modules/three/examples/jsm/shaders/LuminosityHighPassShader.js","webpack:///./node_modules/tween/tween.js","webpack:///./node_modules/path-browserify/index.js","webpack:///./node_modules/core-js/modules/es.reflect.to-string-tag.js","webpack:///./node_modules/frustum-intersects/src/index.js","webpack:///./node_modules/zousan/zousan-min.js"],"names":["module","exports","rbush","default","quickselect","maxEntries","format","this","_maxEntries","Math","max","_minEntries","ceil","_initFormat","clear","findItem","item","items","equalsFn","indexOf","i","length","calcBBox","node","toBBox","distBBox","children","k","p","destNode","createNode","minX","Infinity","minY","maxX","maxY","child","extend","leaf","a","b","min","compareNodeMinX","compareNodeMinY","bboxArea","bboxMargin","enlargedArea","intersectionArea","contains","intersects","height","multiSelect","arr","left","right","n","compare","mid","stack","pop","push","prototype","all","_all","data","search","bbox","result","len","childBBox","nodesToSearch","collides","load","insert","_build","slice","_splitRoot","tmpNode","_insert","remove","parent","index","goingUp","path","indexes","splice","_condense","compareMinX","compareMinY","toJSON","fromJSON","apply","N","M","log","pow","j","right2","right3","N2","N1","sqrt","_chooseSubtree","level","targetNode","area","enlargement","minArea","minEnlargement","isNode","insertPath","_split","_adjustParentBBoxes","m","_chooseSplitAxis","splitIndex","_chooseSplitIndex","newNode","bbox1","bbox2","overlap","minOverlap","xMargin","_allDistMargin","yMargin","sort","leftBBox","rightBBox","margin","siblings","compareArr","Function","join","global","uncurryThis","aCallable","isObject","hasOwn","arraySlice","NATIVE_BIND","concat","factories","construct","C","argsLength","args","list","bind","that","F","Prototype","partArgs","arguments","boundFunction","version","INTERNAL_LAYER_PREFIX","GEOMETRY_COLLECTION_TYPES","GEOJSON_TYPES","RESOURCE_PROPERTIES","RESOURCE_SIZE_PROPERTIES","NUMERICAL_PROPERTIES","COLOR_PROPERTIES","DEFAULT_TEXT_SIZE","now","Date","dest","src","isNil","obj","isNumber","val","isNaN","isInteger","isString","constructor","String","isFunction","hasOwnProperty","Object","key","call","seperator","Array","isEmpty","object","property","pi","PI","toRadian","d","toDegree","r","IS_NODE","toString","process","versions","Browser","maps","getDevicePixelRatio","window","devicePixelRatio","screen","deviceXDPI","logicalXDPI","ua","navigator","userAgent","toLowerCase","doc","document","documentElement","ie","webkit","phantomjs","android23","chrome","gecko","opera","mobile","orientation","msPointer","PointerEvent","MSPointerEvent","pointer","pointerEnabled","ie3d","style","webkit3d","WebKitCSSMatrix","gecko3d","opera12","any3d","imageBitMap","createImageBitmap","resizeObserver","ResizeObserver","btoa","chromeVersion","match","touch","DocumentTouch","webgl","decodeImageInWorker","offCanvas","OffscreenCanvas","getContext","err","supportsPassive","addEventListener","e","ielt9","edge","android","safari","mobileWebkit","mobileWebkit3d","mobileOpera","mobileGecko","retina","language","browserLanguage","ie9","documentMode","ie10","monitorDPRChange","removeDPRListening","map","id","checkDevicePixelRatio","_devicePixelRatio","changed","addDPRListening","matchMedia","dpi","toFixed","screen$1","addListener","tempDPI","defineProperty","get","set","value","mapId","options","checkSize","getRenderer","renderer","Browser$1","_inheritsLoose","subClass","superClass","create","__proto__","_assertThisInitialized","self","ReferenceError","requestAnimFrame","cancelAnimFrame","Position","x","y","isArray","_isNaN","Error","_proto","abs","_abs","_round","round","_ceil","distanceTo","point","mag","_floor","floor","copy","_add","add","nx","ny","_sub","_substract","sub","substract","multi","ratio","_multi","div","_div","equals","c","isZero","toArray","Point","_Position","closeTo","delta","unit","_unit","perp","_perp","angleWith","angleWithSep","atan2","_rotate","angle","cos","sin","rotate","isSVG","url","prefix","loadImage","img","imgDesc","fn","setTimeout","clearTimeout","requestFn","cancelFn","timeToCall","timeoutDefer","getPrefixed","name","uid","UID","GUID","parseJSON","str","JSON","parse","pushIn","ii","ll","removeFromArray","array","forEachCoord","context","pp","getValueOrDefault","v","undefined","sign","Number","log2","LOG2E","rounded","interpolate","t","wrap","w","clamp","isArrayHasData","urlPattern","isURL","test","cssUrlReWithQuote","cssUrlRe","isCssUrl","extractCssUrl","matches","exec","b64chrs","btoa$1","input","block","charCode","output","idx","charAt","charCodeAt","b64toBlob","b64Data","contentType","byteCharacters","atob","arraybuffer","ArrayBuffer","view","Uint8Array","blob","Blob","type","computeDegree","x0","y0","x1","y1","dx","dy","BITMAP_CTX","emptyImageUrl","equalMapView","obj1","obj2","approx","expected","flash","interval","count","cb","me","flashGeo","show","hide","_flashTimeout","_defaults$1","defaults","keys","getOwnPropertyNames","getOwnPropertyDescriptor","configurable","getPointsResultPts","points","ptKey","resultPoints","pt","canvas","createElement","width","getImageBitMap","imageData","createImageData","then","bitmap","getAbsoluteURL","href","CANVAS_SIZE_TEMP","cssWidth","cssHeight","calCanvasSize","size","createFunction","parameters","defaultType","fun","isFeatureConstant","isZoomConstant","isFunctionDefinition","innerFun","zoomAndFeatureDependent","stops","featureDependent","zoomDependent","evaluateExponentialFunction","evaluateIntervalFunction","evaluateCategoricalFunction","evaluateIdentityFunction","featureFunctions","featureFunctionStops","s","stop","zoom","z","feature","base","coalesce","interpolate$1","inputLower","inputUpper","outputLower","outputUpper","evaluatedLower","evaluatedUpper","interpolateArray","interpolateNumber","difference","progress","hasFunctionDefinition","interpolated","createFunction1","loadFunctionTypes","argFn","hit","loaded","multResult","props","buildFn","enumerable","_i","getFunctionTypeResources","res","l","stringify","_fn","types","createFilter","filter","compile","op","compileComparisonOp","compileLogicalOp","compileNegation","compileInOp","compileHasOp","compilePropertyReference","substring","checkType","expressions","values","expression","getFilterFeature","geometry","json","_toJSON","g","compileStyle","styles","compiled","extend$1","prop","loadGeoSymbol","symbol","geo","getMap","set$1","getZoom","getProperties","setProp","getBearing","getPitch","a0","a1","translateToSVGStyles","getMarkerPathBase64","svgStyles","_p","pathes","pathesToRender","svg","strPath","_p2","b64","getExternalResources","toAbsolute","symbols","resSizeProp","h","resources","convertResourceUrl","iii","_iii","_convertUrl","Size","toPoint","trim","replace","specialPattern","escapeSpecialChars","splitWords","chr","split","rulerCtx","stringWidth","text","font","measureText","stringLength","splitContent","content","wrapWidth","textWidth","chrWidth","minChrCount","testStr","prew","contentExpRe","replaceVariable","describeText","textContent","maxHeight","textDesc","splitTextToRow","getAlignPoint","horizontalAlignment","verticalAlignment","alignW","alignH","DEFAULT_FONT","getFont","lineSpacing","textHeight","wrapChar","textRows","actualWidth","texts","tWidth","contents","_contents","_w","rowNum","textSize","hashCode","hash","strlen","isGradient","getGradientStamp","getSymbolStamp","getSymbolHash","sortedKeys","sortedSymbol","reduce","accumulator","curValue","lowerSymbolOpacity","_symbol","_ratio","lower","extendSymbol","sources","parseStyleRootPath","root","iconset","replacer","convertStylePath","parseSymbolPath","URL_PATTERN","parseStops","defaultValue","isDashLine","symbolizers","symbolizer","_symbolizer$style","lineDasharray","lineWidth","index$1","freeze","_defaults","first","testProp","TRANSFORM","TRANSFORMORIGIN","TRANSITION","createEl","tagName","className","el","setClass","createElOn","container","setStyle","appendChild","removeDomNode","innerHTML","parentNode","removeChild","addDomEvent","typeArr","handler","eventHandler","event","listensDomEvent","removeDomEvent","callback","capture","passive","doRemove","removeEventListener","handlers","jlen","hitHandler","preventDefault","returnValue","stopPropagation","cancelBubble","preventSelection","dom","onselectstart","ondragstart","setAttribute","offsetDom","offset","setTransform","top","computeDomPosition","getComputedStyle","padding","parseInt","rect","getBoundingClientRect","offsetWidth","offsetHeight","scaleX","scaleY","__position","getEventContainerPoint","ev","domPos","clientX","clientLeft","clientY","clientTop","endsWith","suffix","strCss","cssText","hasClass","classList","getClass","RegExp","addClass","classes","baseVal","pos","isHTML","measureDom","parentTag","ruler","getDomRuler","clientWidth","clientHeight","tag","span","body","MapLRUCache","on","off","isMapSupported","Map","ArrayLRUCache","onRemove","reset","order","has","removedData","getAndRemove","setMaxSize","_proto2","_iterator","_isArray","Symbol","iterator","_ref","next","done","delete","shrink","_iterator2","_isArray2","_i2","_ref2","LRUCache","Ajax","jsonp","script","getElementsByTagName","client","_getClient","open","headers","setRequestHeader","withCredentials","credentials","responseType","send","post","postData","_t","_wrapCallback","readyState","status","response","byteLength","cacheControl","getResponseHeader","expires","responseText","statusText","XMLHttpRequest","ActiveXObject","onreadystatechange","getArrayBuffer","getImage","imgData","onerror","URL","webkitURL","onload","revokeObjectURL","createObjectURL","resp","DEFAULT_STROKE_COLOR","DEFAULT_FILL_COLOR","DEFAULT_TEXT_COLOR","hitTesting","TEMP_CANVAS","RADIAN","textOffsetY","Canvas","setHitTesting","testing","createCanvas","canvasClass","prepareCanvasFont","ctx","textBaseline","fill","fillStyle","getRgba","prepareCanvas","strokeWidth","strokePattern","strokeColor","strokeStyle","patternOffset","_setStrokePattern","_createGradient","normalizeColorToRGBA","lineJoin","lineCap","setLineDash","polygonPattern","fillImgUrl","extractImageUrl","fillTexture","Image","image","createPattern","console","warn","extent","gradient","places","getMin","getMax","getWidth","getHeight","getCenter","createRadialGradient","createLinearGradient","forEach","addColorStop","linePatternOffset","imageTexture","imgUrl","imageRes","patternCanvas","addResource","clearRect","x2","y2","_drawn","fillCanvas","fillOpacity","alpha","isPattern","_isPattern","globalAlpha","translate","color","opacity","drawImage","error","_text","_textOnMultiRow","splitTextSize","rowAlign","ptAlign","lineHeight","basePoint","_textOnLine","textHaloRadius","textHaloFill","textHaloAlpha","gco","drawHalo","shadowBlur","shadowOffsetX","shadowOffsetY","miterLimit","strokeText","globalCompositeOperation","fillText","rgba","_stroke","strokeOpacity","stroke","_path","lineDashArray","lineOpacity","ignoreStrokePattern","prePoint","nextPoint","isDashed","isPatternLine","lineTo","fillWithPattern","beginPath","moveTo","drawDashLine","p1","p2","degree","save","cosd","restore","_multiClip","polygon","smoothness","isMultiClip","fillFirst","savedCtx","copyProperties","_ring","paintSmoothLine","closePath","ring","ignorePattern","smoothValue","close","tailIdx","tailRatio","preCtrlPoints","x3","y3","ctrlPoints","getCubicControlPoints","bezierCurveTo","lastPoint","prevCtrlPoint","nextCtrlPoint","interpolate$$1","t0","t1","bx1","by1","bx2","by2","u0","u1","qxa","qxb","qxc","qxd","qya","qyb","qyc","qyd","xb","xc","xd","yb","yc","yd","xc1","yc1","xc2","yc2","xc3","yc3","len1","len2","len3","k1","k2","xm1","ym1","xm2","ym2","ctrl1X","ctrl1Y","ctrl2X","ctrl2Y","_arcBetween","dist","p1p2","asin","cp2","da","cx","cy","startAngle","endAngle","arc","_lineTo","bezierCurveAndFill","start","_bezierCurveTo","p3","ellipse","heightTop","heightBottom","bezierEllipse","b1","ox","oy","oy1","rectangle","sector","angles","rad","radius","sDeg","eDeg","drawCross","target","pixelRect","isStroke","strokeRect","fillRect","startPoint","endPoint","dashArray","fromX","fromY","toX","toY","pattern","lt","gt","capmin","capmax","checkX","thereYet","cap","checkY","ang","offsetX","offsetY","dash","promise","lineDashOffset","shadowColor","Promise","Promise$1","Eventable","Base","_Base","_class","eventsOn","_switch","_eventMap","evtType","handlerChain","eventTypes","once","_wrapOnceHandler","evetTypes","eventsOff","eventType","listeners","wrapKey","jl","listener","listens","getListeningEvents","copyEventListeners","eventMap","fire","_eventParent","_fire","called","onceHandler","to","eventKeys","_clearListeners","_clearAllListeners","_setEventParent","_setEventTarget","_eventTarget","param","bubble","passed","queue","Handler","enable","_enabled","addHooks","disable","removeHooks","enabled","Handler$1","Class","setOptions","callInitHooks","proto","getPrototypeOf","_visitInitHooks","config","conf","onConfig","_initHooksCalled","parentProto","hooks","_initHooks","addInitHook","_len","_key","init","include","mergeOptions","registeredTypes","JSONAble","registerJSONType","getJSONClass","getJSONType","_jsonType","clazz","CollisionIndex","_tree","box","insertBox","tree","bulkInsertBox","boxes","Handlerable","addHandler","handlerClass","_handlers","removeHandler","_clearHandlers","START_EVENTS","MOVE_EVENTS","mousedown","touchstart","pointerdown","MSPointerDown","END_EVENTS","DragHandler","_Handler","_this","_onMouseDown","onMouseDown","_offEvents","button","touches","setCapture","captureEvents","MOUSEMOVE","MOUSEUP","moved","actual","startPos","onMouseMove","onMouseUp","interupted","newPos","changedTouches","Coordinate","toNumberArrays","coordinates","coord","toCoordinates","CRS","properties","createProj4","proj","fromProjectionCode","code","toUpperCase","WGS84","EPSG4326","EPSG3857","IDENTITY","CGCS2000","EPSG4490","BD09LL","GCJ02","TEMP_EXTENT","TEMP_POINT0","TEMP_COORD0","TEMP_COORD1","TEMP_COORD2","TEMP_COORD3","TEMP_COORD4","TEMP_COORD5","TEMP_COORD6","TEMP_COORD7","MINMAX","TEMP_COMBINE","Extent","p4","_clazz","unproject","projection","_dirty","_initialize","xmin","xmax","ymin","ymax","_scale","out","isValid","ext2","_project","rxmin","rymin","rxmax","rymax","within","pxmin","pxmax","pymin","pymax","project","getSize","__combine","inited","_combine","ext","combine","intersection","expand","distance","_expand","convertTo","minmax","projectCoords","PointExtent","_Extent","Transformation","matrix","transform","scale","untransform","Common","isSphere","coords","wrapX","wrapY","current","circum","getCircum","getSphereExtent","sx","sy","pre","prj","unprojectCoords","projCoords","sphere","isOutSphere","pcoord","wrapCoord","wrapped","Common$1","measureLength","c1","c2","measureLenBetween","Identity","measureArea","locate","xDist","yDist","_locate","pivot","tmp","Sphere","f","ry","rx","initialAngle","rhumbBearing","finalAngle","calculateRhumbDestination","end","bear360","final","calculateRhumbBearing","bear180","from","phi1","phi2","deltaLambda","deltaPsi","tan","theta","origin","bearing","lambda1","DeltaPhi","DeltaPsi","q","DeltaLambda","lambda2","WGS84Sphere","BaiduSphere","DEFAULT","measurers","registerMeasurer","measure","Measurer","getInstance","mName","metersPerDegree","maxLatitude","lnglat","lng","lat","pLnglat","atan","exp","PROJ4326","Projection_EPSG4490","Projection_Baidu","convertLL2MC","convertMC2LL","EARTHRADIUS","MCBAND","LLBAND","MC2LL","LL2MC","cB","cE","cD","T","convertor","cC","getLoop","getRange","toRadians","toDegrees","Projection_IDENTITY","DEFAULT$1","projections","BAIDU","Renderable","registerRenderer","_rendererClasses","getRendererClass","adapters","registerWorkerAdapter","workerKey","adapter","header","footer","compileWorkerSource","source","getWorkerSourcePath","globalWorkerPool","hardwareConcurrency","workerCount","MessageBatch","limit","_limit","_messages","buffers","addMessage","msg","isFull","getMessage","messageType","messages","WorkerPool","active","MAPTALKS_WORKER_COUNT","_messageBuffers","acquire","workers","worker","Worker","release","terminate","workerId","batches","batch","commit","shift","postMessage","getGlobalWorkerPool","dedicatedWorker","EMPTY_BUFFERS","Actor","workerPool","currentActor","actorId","callbacks","callbackID","receiveFn","receive","isActive","broadcast","_this2","asyncAll","message","_this3","command","params","cbData","_this4","targetID","getDedicatedWorker","remaining","results","imageFetchWorkerKey","EMPTY_ARRAY","ResourceWorkerConnection","_Actor","fetchImage","CanvasRenderer","_Class","layer","_painted","_drawTime","_resWorkerConn","setToRedraw","render","framestamp","prepareRender","isVisible","ResourceCache","checkAndDraw","_tryToDraw","drawFn","_toRedraw","checkResources","_loadingResource","loadResources","testIfNeedRedraw","isInteracting","drawOnInteracting","needToRedraw","isViewChanged","isMoving","isZooming","isRotating","onSkipDrawOnInteracting","isLoadingResource","isRenderComplete","_renderComplete","mustRenderOnInteracting","setCanvasUpdated","_canvasUpdated","isCanvasUpdated","southWest","canvasExtent2D","_extent2D","onAdd","getCanvasImage","_renderZoom","isBlank","containerPoint","_pointToContainerPoint","clearCanvas","setZIndex","hitDetect","_errorThrown","getImageData","resourceUrls","promises","cache","isResourceLoaded","_promiseResource","_get2DExtent","_containerPointToPoint","_canvas","CanvasClass","onCanvasCreate","createContext","gl","dpr","resetCanvasTransform","resizeCanvas","canvasSize","_calCanvasSize","rScale","_maskExtent","mask","getMask","maskExtent2D","_getMaskPainter","get2DExtent","clipCanvas","old","getGeometries","masks","_mask","painter","paint","clip","getViewExtent","completeRender","getEvents","onZoomStart","onZooming","onZoomEnd","onResize","onMoveStart","onMoving","onMoveEnd","onDragRotateStart","onDragRotating","onDragRotateEnd","onSpatialReferenceChange","getDrawTime","_drawAndRecord","painted","draw","getId","crossOrigin","resolve","uri","_cacheResource","onabort","markErrorResource","_errors","_proto3","refCnt","imageBitmap","checkSVG","_getImgUrl","login","logout","merge","DEFAULT_MARKER_SYMBOLS","markerWidth","markerHeight","markerLineWidth","getVectorPadding","DXDY","getFixedExtent","rotation","alignPoint","dxdy","rotateExtent","SIZE","getVectorMarkerFixedExtent","calVectorMarkerSize","getVectorMarkerAnchor","getMarkerRotation","getDefaultHAlign","markerType","getDefaultVAlign","TEMP_SIZE","shadow","ROTATE_EXTENT","fixedExtent","getImageMarkerFixedExtent","getTextMarkerFixedExtent","FIXED_EXTENT","getMarkerFixedExtent","isTextSymbol","isImageSymbol","isVectorSymbol","isPathSymbol","_lastCode","DYNAMIC_SYMBOL_PROPS","SIZE_SYMBOL_PROPS","clipLine","bounds","noCut","segment","parts","clipSegment","useLastCode","codeOut","newCode","codeA","_getBitCode","codeB","_getEdgeIntersection","clipPolygon","clippedPoints","edges","_code","withInEllipse","center","southeast","tolerance","f1","f2","xfocus","Symbolizer","getPainter","isDynamicSize","testColor","CanvasSymbolizer","_Symbolizer","_prepareContext","_opacityFn","isHitTesting","_defineStyle","drawVectorMarker","gradientExtent","strokeAndFill","translateMarkerLineAndFill","vectorArray","getVectorMarkerPoints","getGraidentExtent","hLineWidth","_j","_j2","_lineCap","v0","v1","v2","v3","hh","hw","extWidth","testCanvas","TEMP_POINT0$1","TEMP_POINT1","TEMP_POINT2","TEMP_POINT3","PointSymbolizer","_CanvasSymbolizer","glRes","getGLRes","renderPoints","_getRenderPoints","_pointAtResToPoint","_rotateExtent","placement","isSpriting","getPlacement","getRenderPoints","_getRenderContainerPoints","ignoreAltitude","cpoints","getDxDy","_cPoint","containerOffset","_pointContainerPoints","flat","getRotation","_getRotationAt","rotations","p0","isTransforming","_pointAtResToContainerPoint","DebugSymbolizer","_PointSymbolizer","symbolize","getLayer","outline","getContainerExtent","cross","TEMP_SIZE$1","ImageMarkerSymbolizer","cookedPoints","_getImage","imgURL","removeCache","_url","_fixedExtent","TEMP_COORD0$1","TEMP_COORD1$1","StrokeAndFillSymbolizer","paintParams","_getPaintParams","isGradient$$1","isPath","isSplitted","_paintOn","_params","_getPrjExtent","_extMin","_extMax","_prjToPoint","_pxExtent","getPaintParams","lineColor","grad","TextMarkerSymbolizer","_dynamic","translateLineAndFill","_textDesc","getTextDesc","_index","MARKER_SIZE","VectorMarkerSymbolizer","_drawMarkers","_drawMarkersWithCache","_drawVectorMarker","stamp","_stampSymbol","_createMarkerImage","anchor","_getCacheImageAnchor","_stamp","_getGraidentExtent","isDynamic","ha","va","VectorPathMarkerSymbolizer","_ImageMarkerSymbolize","defaultSymbol","polygonFill","polygonOpacity","DrawAltitudeSymbolizer","_getStyle","groundPoints","_drawLineAltitude","groundPoint","_drawMarkerAltitude","_drawLine","registerSymbolizers","TEMP_POINT0$2","TEMP_PAINT_EXTENT","TEMP_FIXED_EXTENT","TEMP_CLIP_EXTENT0","TEMP_CLIP_EXTENT1","TEMP_CLIP_EXTENT2","PROJECTION","TEMP_BBOX","minx","miny","maxx","maxy","Painter","_createSymbolizers","_altAtGL","_getGeometryAltitude","geoSymbol","getSymbol","regSymbolizers","_hasPoint","getType","_debugSymbolizer","hasPoint","_verifyProjection","_renderPoints","disableClip","ptkey","resolution","pitch","glScale","containerExtent","_getRenderer","mapStateCache","_hitPoint","getResolution","getGLScale","pitched","rotated","_cachedParams","paintAsPath","_paintAsPath","_unsimpledParams","_res","_pitched","_redrawWhenPitch","_rotated","_redrawWhenRotate","_simplified","zoomScale","tr","mapExtent","cPoints","pointPlacement","_aboveCamera","roundPoint","needClip","clipBBoxBufferSize","pointsContainerPoints","viewPoints","alts","pts","_pointsAtResToContainerPoints","getShell","getHoles","clipPts","_points","clipPt","altitude","getAltitude","clipped","_geometry","_clip","inView","clipPoints","alt","altitudeIsNumber","_cring","altArray","cring","_containerBbox","hasAltitude","_2DExtent","glExtent","_get2DExtentAtRes","extent2D","cameraLookAt","cameraPosition","glExtent2D","_glScale","part","_i3","_interpolateSegAlt","clipSegs","orig","cc","segsWithAlt","interpolateAlt","cp","_getInternalSymbol","_isCheck","minAltitude","getMinAltitude","frustumAlt","getFrustumAltitude","_beforePaint","contexts","_prepareShadow","_afterPaint","getSprite","_spriting","_sprite","markerExtent","bak","hitTest","_eachSymbolizer","_isDynamicSize","_zoom","_computeExtent2D","_computeFixedExtent","_this$_fixedExtent","change","isCanvasRender","repaint","refreshSymbol","_removeSymbolizers","_paintParams","propAlt","_propAlt","getMaxAltitude","maxAltitude","MAX_VALUE","MIN_VALUE","_meterToPoint","distanceToPointAtRes","_getProjection","_projCode","w0","w1","TEMP_EXTENT$1","CollectionPainter","isMask","_eachPainter","geometries","_getPainter","MAX_ZOOM","DefaultSpatialReference","resolutions","SpatialReference","_initSpatialRef","getPreset","preset","getAllPresets","getProjectionInstance","prjName","sp1","sp2","fullExtent","bottom","r1","r2","_projection","defaultSpatialRef","isEPSG","_resolutions","_pyramid","_fullExtent","_transformation","getResolutions","getProjection","getFullExtent","getTransformation","getMinZoom","getMaxZoom","getZoomDirection","isPyramid","TEMP_POINT0$3","TEMP_EXTENT$2","Geometry","_JSONAble","opts","setSymbol","_genSizeSymbol","setProperties","setId","getFirstCoordinate","getCoordinates","getLastCoordinate","addTo","fitview","addGeometry","_layer","_id","oldId","_fireEvent","_getParent","_repaint","_symbolUpdated","_prepareSymbol","onSymbolChanged","_compiledSymbol","_symbolHash","updateSymbol","_getSymbol","_eventSymbolProperties","getTextContent","_sizeSymbol","_computeCenter","_getMeasurer","getExtent","prjExt","_computeExtent","extent2d","extent2","groundExtent","_getFixedExtent","_extent2d","_prjToPointAtRes","containsPoint","coordToContainerPoint","_containsPoint","_hitTestTolerance","onHide","getZIndex","zIndex","setZIndexSilently","bringToFront","getGeoMaxZIndex","topZ","bringToBack","getGeoMinZIndex","bottomZ","_silence","translated","setCoordinates","ret","_unbind","toGeoJSONGeometry","gJson","_exportGeoJSONGeometry","toGeoJSON","geoJSON","_exportProperties","other","_exportGraphicOptions","getLength","_computeGeodesicLength","getArea","_computeGeodesicArea","measurer","_getConnectPoints","_initOptions","_bindLayer","_clearCache","_bindInfoWindow","_bindMenu","cookedSymbols","_checkAndCopySymbol","_setExternSymbol","_externSymbol","_extent","_computePrjExtent","_animPlayer","finish","_unbindMenu","_unbindInfoWindow","isEditing","endEdit","_removePainter","onRemoveGeometry","_internalId","_getInternalId","_setInternalId","_clearProjection","_getExternalResources","_painter","getCollectionPainterClass","getPainterClass","_maskPainter","_paint","_dirtyCoords","_pcenter","_coordinates","closeMenu","closeInfoWindow","onShapeChanged","onPositionChanged","dynamicSize","_getSizeSymbol","symbolSize","lineDx","lineDy","_getCompiledSymbol","needRepaint","_setParent","_parent","eventName","_onGeometryEvent","_infoWinOptions","geoProperties","layerOpts","layerAltitude","_genMinMaxAlt","_minAlt","_maxAlt","options$1","Layer","setMask","onLoad","_initRenderer","_renderer","onLoadEnd","addLayer","_zIndex","_sortLayersByZIndex","minZoom","maxZoom","getOpacity","setOpacity","layers","_getLayerList","topLayer","bottomLayer","removeLayer","_isVectorMarker","removeMask","isLoaded","_loaded","getCollisionIndex","_collisionIndex","clearCollisionIndex","onRendererCreate","_bindMap","_switchEvents","_doRemove","emitter","_layers","_getMask2DExtent","_onLayerEvent","TEMP_COORD","options$2","Map$1","_Handlerable","baseLayer","VERSION","writable","_initContainer","_panels","_baseLayer","_zoomLevel","_center","setSpatialReference","_mapViewPoint","_updateMapSize","_getContainerDomSize","setBaseLayer","setMaxExtent","_Load","addOnLoadHook","_onLoadHooks","getContainer","_containerDOM","getSpatialReference","_spatialReference","ref","oldRef","_updateSpatialReference","_resetMapStatus","setCursor","cursor","_cursor","_trySetCursor","resetCursor","_prjCenter","setCenter","pcenter","_verifyExtent","_setPrjCenter","_parseEventFromCoord","visualHeight","maxVisualPitch","_getVisualHeight","visualPitch","fov","getFov","cameraToCenter","cameraCenterDistance","tanB","tanP","visualDistance","_pointToExtent","getProjExtent","_pointToPrj","getPrjExtent","getMaxExtent","maxExt","_prjMaxExtent","_getPrjCenter","_panTo","getZoomForScale","fromZoom","isFraction","_getResolution","targetRes","scaleZoom","getZoomFromRes","_getResolutions","minRes","maxRes","gap","setZoom","_zoomAnimation","getMaxNativeZoom","setMaxZoom","viewMaxZoom","setMinZoom","viewMinZoom","_glRes","zoomIn","zoomOut","_zooming","setCenterAndZoom","animation","getFitZoom","coordToPoint","getView","setView","setPitch","setBearing","getScale","fitExtent","zoomOffset","step","_animateTo","getBaseLayer","isChange","onbaseLayerload","removeBaseLayer","getLayers","_getLayers","_layerCache","mapLayers","removed","_removeLayer","setLayerCanvasUpdated","sortLayers","layersToOrder","minZ","_l","toDataURL","mimeType","file","dataURL","quality","dlLink","download","click","coordinate","coordinateToPoint","coordToPointAtRes","coordinateToPointAtRes","pointToCoord","pointToCoordinate","pointAtResToCoord","pointAtResToCoordinate","coordToViewPoint","coordinateToViewPoint","viewPointToCoord","viewPoint","viewPointToCoordinate","coordinateToContainerPoint","containerPointToCoord","containerPointToCoordinate","containerPointToViewPoint","getViewPoint","viewPointToContainerPoint","force","justStart","_initTime","watched","oldHeight","oldWidth","vh","nwCP","nwCoord","_containerPointToPrj","vhAfter","nwCPAfter","_setPrjCoordAtContainerPoint","_mapViewCoord","hided","_eventSilence","getMainPanel","getPanels","isRemoved","_removeDomEvents","childNodes","_moving","_mapAnimPlayer","_stopAnim","prjCenter","_originCenter","_parseEvent","_dragRotating","isDragRotating","isOffscreen","viewportPadding","screenRightBoundary","screenBottomBoundary","setDevicePixelRatio","getElementById","_priorityCursor","_setCursorToPanel","_setPriorityCursor","hasCursor","panel","layerList","_order","sortLayersByZIndex","_loadAllLayers","_callOnLoadHooks","loadLayer","_eachLayer","layerLists","_calcMatrices","resetContainer","containerDOM","_containerDomContentRect","mSize","updateMapSize","_offsetCenterByPixel","pixel","pCenter","offsetPlatform","_getViewPointFrameOffset","panelOffset","_resetMapViewPoint","_mapRes","pCoord","_prjsToPointsAtRes","pCoords","transformation","_pointToPrjAtRes","_pointToPoint","_pointToPointAtRes","COORD","prjCoord","_prjToViewPoint","_viewPointToPrj","coordinateToContainerPointAtRes","pCoordinate","_prjToContainerPointAtRes","coordinatesToContainerPoints","coordinatesToContainerPointsAtRes","prjOut","centerPoint","_toContainerPoint","containerToExtent","POINT0","POINT1","distanceToPixel","distanceToPoint","paramCenter","POINT","pixelToDistance","COORD0","COORD1","fullExt","pointToDistance","pointAtResToDistance","locateByPoint","px","py","cached","_mapExtent2D","_mapGlRes","_mapGlExtent2D","cExtent","_containerPointToPointAtRes","min2d","max2d","_prjToContainerPoint","_viewPointToPoint","_pointToViewPoint","MapDoubleClickZoomHandler","_onDoubleClick","oldZoom","MapDragHandler","mapWrapper","_dragHandler","_cancelOn","_onDragStart","_onDragging","_onDragEnd","domEvent","_ignore","_ignoreEvent","startDragTime","_mode","ctrlKey","_moveStart","_rotateStart","_isEventOutMap","_rotating","_moveEnd","_rotateEnd","startBearing","_start","preX","preY","startX","startY","_startPrjCenter","_getActualEvent","startPrjCoord","isTouch","mx","my","currentCenter","dxy","_clear","dscale","targetPrjCoord","targetCoord","panTo","_rotateMode","_db","prePitch","preBearing","db","_setBearing","_setPitch","_bearing","EVENTS","MapGeometryEventsHandler","allLayers","_identifyGeometryEvents","oneMoreEvent","isMousedown","_mouseDownTime","downTime","time","geometryCursorStyle","tops","getTopElements","topOnlyEvent","events","onEvent","identify","identifyOptions","eventToFire","_getEventTypeToFire","fireGeometryEvent","_queryIdentifyTimeout","callInNextFrame","identifyAtPoint","propagation","geoMap","iid","_onEvent","_prevOverGeos","geomap","oldTargets","geos","oldTarget","oldTargetId","wheelZoomDelta","defaultZoomRate","wheelZoomRate","maxScalePerFrame","MapScrollWheelZoomHandler","_thisScrollZoom","_scrollZoom","_wheelZoomRate","_defaultZoomRate","_delta","_onWheelScroll","evt","_checkZoomOrigin","_trackPadSuspect","_ensureTrackpad","_seamless","_interval","deltaMode","WheelEvent","DOM_DELTA_LINE","deltaY","shiftKey","_lastWheelEvent","_zoomOrigin","_active","zoomRate","targetZoom","_timeout","_requesting","levelValue","wheelDelta","detail","nextZoom","_checkZoom","_origin","_startZoom","duration","frame","state","playState","MapTouchZoomHandler","_onTouchStart","_startP1","_startP2","_startDist","_startVector","_startBearing","_onTouchMove","_onTouchEnd","d1","d2","vector","mode","_startTouching","_Origin","KEY","Easing","outExpo","outQuint","in","inAndOut","linear","upAndDown","Frame","Player","onFrame","_animation","_onFrame","ready","finished","Animation","speed","_resolveStyles","resolveChild","_styles","resolveVal","isChild","childStyles","framing","dStyles","startStyles","destStyles","easing","deltaStyles","_startStyles","_dStyles","elapsed","_requestAnimFrame","_frameQueue","_a","_animationFrameId","_frameFn","_run","running","animate","player","_prepare","_framer","play","currentTime","startTime","_playStartTime","pause","cancel","reverse","_frame","Animation$1","options$3","Path","_Geometry","animateShow","_showPlayer","_animIdx","_animLenSoFar","isPolygon","animCoords","prjAnimCoords","_prjAniShowCenter","_aniShowCenter","_distance","_tempCoord","_tempPrjCoord","currentCoord","_drawAnimShowFrame","_animTailRatio","prjCoords","targetLength","segLen","lastCoord","_setPrjCoordinates","_animCoords","_prjAnimCoords","_getCenterInExtent","clipFn","meExtent","sumx","sumy","counter","_getPath2DPoints","disableSimplify","isSimplify","_shouldSimplify","isMulti","glPointKey","prjPoints","_prjCoords","_getPrjCoordinates","_projectCoords","_updateCache","_unprojectCoords","shell","rings","hasHoles","_coords2Extent","_getPrjHoles","_get2DLength","vertexes","JSON_TYPE","Polygon","_Path","getOutline","_holes","_projectRings","_trimRing","holes","_copyAndCloseRing","getCenterInExtent","_prjHoles","_cleanRing","_checkRing","isClose","_getPrjShell","_prjShell","CenterMixin","_getCenter2DPoint","TEMP_EXTENT$3","options$4","Marker","_CenterMixin","_CenterMixin$prototyp","sizeSymbol","dynamic","_v","_canEdit","computeExtent","_getSprite","options$5","LineString","TEMP_EXTENT$4","GeometryCollection","setGeometries","_geometries","_checkGeometries","_bindGeometriesToLayer","selected","isFn","is","invalidGeoError","_checkGeo","sumX","sumY","computeExtent$1","anchors","startEdit","_originalSymbol","_draggbleBeforeEdit","_editing","MultiGeometry","_GeometryCollection","geoType","GeometryType","_initData","MultiPoint","_MultiGeometry","findClosest","MultiPath","MultiLineString","_MultiPath","MultiPolygon","types$1","GeoJSON","toGeometry","foreachFn","resultGeos","_convert","resultGeo","features","_result2","mGeos","_result","options$6","Circle","_radius","circle","getRadius","setRadius","numberOfPoints","vertex","se","_getMinMax","pminmax","leftx","rightx","topy","bottomy","options$7","Ellipse","setWidth","setHeight","deg","pps","longer","Rectangle","_Polygon","_width","_height","nw","fExt","_pnw","pnw","sphereExtent","_getSouthEast","prjs","rightPoint","bottomPoint","options$8","Sector","_Circle","getStartAngle","setStartAngle","getEndAngle","setEndAngle","pc","sAngle","eAngle","between","options$9","Curve","_LineString","_arc","ctrlPoint","_quadraticCurve","quadraticCurveTo","_bezierCurve","_getCurveArrowPoints","arrows","segments","arrowStyle","arrow","_getArrowShape","_arrow","options$a","ArcCurve","_Curve","_paintArrow","CubicBezierCurve","curve","_getArrowPoints","QuadBezierCurve","defaultSymbol$1","defaultBoxSymbol","TextMarker","_Marker","getContent","_content","setContent","_refresh","_refreshing","_parseSymbol","setTextStyle","getTextStyle","setTextSymbol","setBoxStyle","_style","getBoxStyle","setBoxSymbol","_getTextSize","_getDefaultTextSymbol","_getDefaultBoxSymbol","_getDefaultPadding","options$b","TextBox","_TextMarker","boxSymbol","textStyle","getBoxSymbol","textBox","maxWidth","hAlign","vAlign","options$c","textSymbol","Label","boxStyle","getTextSymbol","label","sizes","_getBoxSize","boxSize","textAlignPoint","Connectable","_hasConnectors","__connectors","_getConnectors","getConnectSource","_connSource","setConnectSource","_connTarget","getConnectTarget","setConnectTarget","_updateCoordinates","_registerEvents","srcPoints","targetPoints","minDist","oldCoordinates","computeLength","_showConnect","trigger","options$d","showOn","ConnectorLine","_Connectable","ArcConnectorLine","_Connectable2","options$e","OverlayLayer","_Layer","_maxZIndex","_minZIndex","_initCache","getGeometryById","_geoMap","_geoList","filtered","getFirstGeometry","getLastGeometry","getCount","copyOnWrite","fitView","last","_toSort","onGeometryAdd","animateTo","zoomAnimationDuration","_updateZIndex","geoId","internalId","onAddGeometry","_cookedStyles","_styleGeometry","removeGeometry","_clearing","onGeometryRemove","clearImageData","_findInList","getStyle","removeStyle","_sortGeometries","_compare","middle","low","high","_onGeometryIdChange","_onGeometryZIndexChange","_onGeometryPositionChange","_onGeometryShapeChange","_onGeometrySymbolChange","_onGeometryShow","_onGeometryHide","_onGeometryPropertiesChange","onGeometryZIndexChange","onGeometryPositionChange","onGeometryShapeChange","onGeometrySymbolChange","onGeometryShow","onGeometryHide","onGeometryPropertiesChange","TEMP_EXTENT$5","options$f","VectorLayer","_OverlayLayer","_hitGeos","hits","_getArrowStyle","profile","clipExtent","geoJSONs","geoExt","MapTool","_Eventable","_map","onEnable","onDisable","isEnabled","options$g","registeredMode","DrawTool","_MapTool","_checkMode","_events","_clickHandler","_mouseMoveHandler","_doubleClickHandler","_mouseDownHandler","_mouseUpHandler","registerMode","modeAction","getRegisterMode","getMode","setMode","_clearStage","_restoreMapCfg","_saveMapCfg","getCurrentGeometry","_drawToolLayer","_getDrawLayer","_loadResources","_mapAutoPanAtEdge","autoPanAtEdge","_geometryEvents","endDraw","undo","_getRegisterMode","action","_shouldRecordHistory","_historyPointer","_clickCoords","update","redo","actions","_mapDoubleClickZoom","dragging","_mapDraggable","_createGeometry","_prjCoord","drawTool","_addGeometryToStage","_getMouseContainerPoint","_isValidContainerPoint","clickCoords","drawLayer","_ending","mapSize","drawLayerId","drawToolLayer","MapBoxZoomHander","_boxZoom","PANOFFSET","MapAutoPanAtEdgeHandler","_onMouseMove","panBy","interpolate$2","currView","empty","_from","_to","_isInternalAnimation","_prevAnimPlayer","zoomOrigin","framer","_interupted","_endAnim","_startAnim","flyTo","z0","z1","startZoom","startPitch","rho","animMinZoom","wMax","rho2","sinh","cosh","tanh","r0","u","S","isFinite","newCenter","newZoom","newPitch","newBearing","_center2","isAnimating","_animRotating","endCoord","_endCoord","_resumePrev","prevPlayer","CLICK_TIME_THRESHOLD","isRotatingMap","_domMouseDownView","mouseDownView","perspective","fovy","aspect","near","far","nf","a00","a01","a02","a03","a10","a11","a12","a13","a20","a21","a22","a23","rotateX","rotateZ","multiply","a30","a31","a32","a33","b0","b2","b3","invert","b00","b01","b02","b03","b04","b05","b06","b07","b08","b09","b10","b11","det","identity","set$2","subtract","normalize","dot","scale$1","ax","ay","az","bx","by","bz","hypot","transformMat4","applyMatrix","matrixToQuaternion","te","m11","m12","m13","m21","m22","m23","m31","m32","m33","trace","quaternionToMatrix","z2","xx","xy","xz","yy","yz","zz","wx","wy","wz","setPosition","lookAt","eye","up","_registerDomEvents","_handleDOMEvent","isMouseDown","_domMouseDownTime","_fireDOMEvent","mimicEvent","mimicClick","_downTime","_time","_clickTime","control","preTarget","srcElement","actualEvent","eventPos","eventParam","isFullScreen","webkitIsFullScreen","mozFullScreen","msFullscreenElement","fullscreenElement","requestFullScreen","_requestFullScreen","cancelFullScreen","_cancelFullScreen","requestFullscreen","mozRequestFullScreen","webkitRequestFullScreen","msRequestFullScreen","availWidth","availHeight","newWin","location","opener","exitFullscreen","mozCancelFullScreen","webkitCancelFullScreen","_panAnimation","setInfoWindow","layerJSON","layerType","extraLayerOptions","layersJSON","exportOption","_opts","layerJSONs","coord1","coord2","computeGeometryLength","computeGeometryArea","_identify","reqLayers","layerHits","_frameZoom","startScale","_startZoomAnim","endScale","_startZoomVal","_startZoomCoord","frameZoom","_zoomTo","fromRes","originOffset","startZoomVal","RADIAN$1","DEFAULT_FOV","TEMP_COORD$1","createMat4","_fov","setFov","_renderLayers","_angle","_pitch","_frustumAltitude","_calcFrustumAltitude","cameraAlt","scale$$1","altitudes","_this$_get2DExtent","_this$getSize","dxPerPixel","dyPerPixel","altitudeIsArray","_pt","w2","h2","_projIfBehindCamera","cameraForward","projViewMatrix","vectorFromCam","position","cameraPos","camForward","camNormDot","coord0","projViewMatrixInverse","_x","_y","m1","worldMatrix","_getCameraWorldMatrix","farZ","_getCameraFar","cameraFar","cameraNear","projMatrix","viewMatrix","_calcCascadeMatrixes","domCssMatrix","_calcDomMatrix","tanFov","cal","curPitch","cascadePitch0","cascadePitch1","projViewMatrix0","cascadeFrustumMatrix0","projViewMatrix1","cascadeFrustumMatrix1","minusY","cameraToCenterDistance","_getFovZ","_getFovRatio","center2D","cz","cameraUp","cameraWorldMatrix","_onViewChange","_viewHistory","_viewHistoryPointer","_getCurrentView","_fireViewChange","zoomToPreviousView","hasPreviousView","_zoomToView","zoomToNextView","hasNextView","getViewHistory","createCollisionIndex","collisionFrameTime","options$h","DistanceTool","_DrawTool","_afterEnable","_afterDisable","_measureLayers","_lastMeasure","_lastVertex","getMeasureLayers","getLastMeasure","_vertexes","marker","_measureMarkerLayer","_measure","toMeasure","units","_registerMeasureEvents","_msOnDrawStart","_msOnDrawVertex","_msOnMouseMove","_msOnDrawEnd","layerId","markerLayerId","_measureLineLayer","startLabel","_addVertexMarker","ms","_msGetCoordsToMeasure","_tailMarker","_tailLabel","vertexLabel","_clearTailMarker","_clearMeasureLayers","_addClearMarker","dxSymbol","endMarker","measureLineLayer","measureMarkerLayer","options$i","AreaTool","_DistanceTool","sqmi","vertexMarker","endLabel","circleHooks","prjPath","nextCoord","ellipseHooks","rectangleHooks","_firstClick","firstClick","polygonHooks","line","pSymbol","lineStringHooks","arcConf","tileInfo","tileSize","lods","tileSystem","getProjectionCode","newcode","codeArray","strReplace","repArray","rep","template","getTransformValue","isArcgis","isGeoServer","isSuperMap","transformValue","getTileMatrixSet","TileMatrixSets","TileMatrixSetLink","TileMatrixSet","parseWMTSXML","requestUrl","parser","DOMParser","xmlDoc","parseFromString","querySelectorAll","nodeName","layerName","tileMatrixSetLinks","tileMatrixSetLink","tileMatrixSet","resourceURL","attributes","_parseTileMatrixSet","parseTileMatrixSet","levelStr","substr","lastIndexOf","urlTemplate","spatialReference","info","tset","TileMatrixs","supportedCRS","minLevel","TileMatrix","ScaleDenominator","TopLeftCorner","TileWidth","TileHeight","_TopLeftCorner$split$","parseFloat","loadArcgis","getJSON","spatialRef","loadWMTS","xml","options$j","UIComponent","owner","_owner","_coordinate","visible","_getUIContainer","_removePrevDOM","_mapEventsOn","_switchMapEvents","__uiDOM","buildOn","_observerDomSize","_measureSize","_singleton","_uiComponent","_uiDomKey","_setPosition","anim","_getAnimation","ok","fade","getTransformOrigin","_toCSSTranslate","_pos","isSupportZoomFilter","display","_autoPan","transition","getDOM","_domContentRect","_size","getOwner","_roundPoint","getPosition","_getViewPoint","getOffset","o","animations","trimed","mapWidth","mapHeight","containerPoint0","domWidth","domHeight","newContainerPoint","onDomRemove","eventsToStop","hideDom","_resizeObserver","disconnect","_getClassName","_getDefaultEvents","ownerEvents","_getOwnerEvents","positionchange","symbolchange","getOwnerEvents","_updatePosition","onDomSizeChange","entries","contentRect","observe","isSupport","options$k","domEvents","UIMarker","_markerCoord","_registerDOMEvents","_removeDOMEvents","isDragging","_onDomEvents","onZoomFilter","_this$options","EVENTS$1","UIMarkerDragHandler","_startDrag","_endDrag","_lastCoord","_lastPoint","_prepareDragHandler","_dragging","_isDragging","coordOffset","pointOffset","PROPERTY_PATTERN","options$l","EMPTY_SIZE","InfoWindow","_UIComponent","getInfoWindow","removeInfoWindow","_infoWindow","setTitle","title","getTitle","_dom","_replaceTemplate","_getWindowWidth","msgContent","querySelector","_onCloseBtnClick","closeBtn","html","markerSize","fixExtent","_onAutoOpen","_rectifyMouseCoordinte","mouseCoordinate","_rectifyLineStringMouseCoordinate","lineString","dis","mousePt","minDis","coordinateIndex","filterPts","xys","_this$getMap$getSize","pt1","pt2","minPtDis","ptIndex","_len2","_dis","defaultWidth","HIDEDOMEVENTS","options$m","ToolTip","onMouseOut","cssName","containerClass","onMouseOver","defaultOptions","Menu","_menu","removeMenu","setItems","getItems","_getMenuWidth","menuItems","_createMenuItemDom","ul","itemDOM","onMenuClick","_callback","itemTitle","Menuable","setMenu","_menuOptions","_defaultOpenMenu","getMenu","openMenu","setMenuItems","getMenuItems","index$4","Control","controlContainer","__ctrlContainer","_controlDom","_parse","getContainerPoint","positions","addControl","removeControl","options$n","layerEvents","Attribution","_Control","_attributionContainer","_update","attributions","attributionControl","options$o","LayerSwitcher","_show","_hide","_createPanel","toElement","relatedTarget","elm","baseLayers","li","_isExcluded","_renderLayer","_li","_ul","_label","excludeLayers","isBase","checked","onchange","layerSwitcherControl","options$p","Overview","mapContainer","_createOverview","_updateBaseLayer","_onButtonClick","_updateButtonText","_overview","_perspective","maxmize","minimize","getOverviewMap","_getOverviewZoom","_getPerspectiveCoords","showIndex","overviewControl","options$q","Panel","closeButton","onclick","panelContent","draggable","_startPos","_startPosition","startPosition","options$r","Scale","_scaleContainer","_addScales","css","_mScale","_iScale","maxMeters","_updateScales","_updateMetric","_updateImperial","meters","_getRoundNum","_updateScale","maxMiles","miles","feet","maxFeet","num","pow10","scaleControl","options$s","Toolbar","onButtonClick","childIndex","targetDom","_getItems","textAlign","itemSize","dropMenu","_createDropMenu","menuDom","menuUL","liWidth","options$t","UNIT","Zoom","levelDOM","_levelDOM","zoomDOM","zoomInButton","_zoomInButton","reading","_sliderBox","_sliderRuler","_sliderReading","_sliderDot","zoomOutButton","_zoomOutButton","_onZoomInClick","_onZoomOutClick","_onClickRuler","dotDragger","totalRange","zoomRange","_updateText","_onDotDragstart","_onDotDrag","zoomControl","TileSystem","getDefault","semiCircum","TileConfig","prepareTileInfo","_xScale","_yScale","_pointOrigin","_getTileNum","tileX","tileY","getTileIndex","repeatWorld","tileIndex","getNeighorTileIndex","idy","_getTileFullIndex","_tileFullIndex","nwIndex","seIndex","getTilePrjNW","getTilePointNW","getTilePrjSE","getTilePointSE","getTilePrjExtent","DEFAULT_MAXERROR","TEMP_POINT","MAX_ROOT_NODES","isSetAvailable","Set","TileHashset","_table","options$u","URL_PATTERN$1","TEMP_POINT0$4","TEMP_POINT1$1","TEMP_POINT2$1","TEMP_POINT3$1","TEMP_POINT4","TEMP_POINT6","TILE_BOX","TILE_MIN","TILE_MAX","ARR3","TileLayer","getTileSize","_tileSize","getTiles","parentLayer","_coordCache","sr","_disablePyramid","_hasOwnSR","_getPyramidTiles","_getCascadeTiles","_getTileFullExtent","_tileFullExtent","_getRootNodes","offset0","_rootNodes","_this$_rootNodes","_tiles","tiles","_error","_getRootError","tileConfig","_getTileConfig","_tileConfig$tileSyste","extent000","_getTileId","getTileUrl","aspectRatio","cameraZ","heightZ","widthZ","diagonalZ","fov0","_getTileZoom","projectionView","_getTileOffset","mapContainerExtent","mapExtent2D","_convertToExtent2d","rootNodes","visualHeight1","visualContainerExtent","_visitedTiles","tileGrid","_getTiles","offsets","0","_splitNode","tileGrids","gridExtent","parentRenderer","childScale","hasCurrentIn","childX","childY","childIdx","childIdy","tileId","isTileCachedOrLoading","nwx","nwy","swx","swy","childNode","_isTileVisible","_isTileInFrustum","maxError","_getScreenSpaceError","_node$extent2d","geometricError","_node$extent2d2","distanceToCamera","distanceToRect","distance$$1","tileZoom","_currentTiles","visualHeight0","extent0","currentTiles","cascadeTiles1","cascadeTiles2","cascadeHeight","cascadeLevels","extent1","domain","subdomains","length$$1","token","_sr","_srMinZoom","_srMaxZoom","res0","res1","dz","cascadeLevel","ignoreMinZoom","frustumMatrix","hasOffset","emptyGrid","tileOffsets","maskExtent","extentScale","pmin","pmax","centerTile","ltTile","rbTile","allCount","tilePoint","leftVisitEnd","rightVisitEnd","_tileInfo","_unproject","pse","tileExtent","_isTileInExtent","_splitTiles","point0","point1","tileIdx","yOrder","corner","tile","_checkAndAddTile","childExtent","_isSplittedTileInExtent","mapProjection","_initTileConfig","_defaultTileConfig","_tileConfig","_onSpatialReferenceChange","tileCenter","ndc","xyz","workerSource","registerWorkerSource","options$v","DEFAULT_TILESIZE","GroupTileLayer","_TileLayer","_checkChildren","layerMap","_groupChildren","childGrid","getChildLayer","_onLayerShowHide","ids","options$w","crs","uppercase","detectRetina","defaultWmsParams","service","request","transparent","WMSTileLayer","wmsParams","_wmsVersion","projectionKey","getParamString","existingUrl","encodeURIComponent","CanvasTileLayer","drawTile","createGLContext","names","compileShader","shader","createShader","shaderSource","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","deleteShader","createProgram","vert","frag","vertexShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","program","attachShader","linkProgram","enableVertexAttrib","FSIZE","Float32Array","BYTES_PER_ELEMENT","STRIDE","attr","getAttribLocation","vertexAttribPointer","enableVertexAttribArray","_attr","shaders","arr16","DEBUG_POINT","ImageGLRenderable","renderable","drawGLImage","debug","useProgram","loadTexture","uMatrix","uniformMatrix4fv","uniform1f","glBuffer","saveImageBuffer","bindBuffer","ARRAY_BUFFER","bufferTileData","drawArrays","TRIANGLE_STRIP","drawDebug","attrib","debugInfo","_debugBuffer","bufferData","DYNAMIC_DRAW","LINE_STRIP","_debugInfoCanvas","_ctx","texImage2D","TEXTURE_2D","RGBA","UNSIGNED_BYTE","set8","buffer","set8Int","loadImageBuffer","Int16Array","drawTinImage","vertices","texCoords","indices","posBuffer","texBuffer","ELEMENT_ARRAY_BUFFER","Uint16Array","drawElements","TRIANGLES","UNSIGNED_SHORT","createCanvas2","canvas2","clearColor","DEPTH_TEST","STENCIL_TEST","BLEND","blendFunc","ONE","ONE_MINUS_SRC_ALPHA","createBuffer","STATIC_DRAW","enableSampler","activeTexture","pixelStorei","UNPACK_PREMULTIPLY_ALPHA_WEBGL","resizeGLCanvas","viewport","clearGLCanvas","COLOR_BUFFER_BIT","STENCIL_BUFFER_BIT","disposeImage","texture","saveTexture","_createTexture","getTexture","createTexture","bindTexture","texParameteri","TEXTURE_MIN_FILTER","LINEAR","TEXTURE_MAG_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","generateMipmap","_textures","textures","getImageBuffer","_imageBuffers","imageBuffers","createImageBuffer","removeGLCanvas","deleteBuffer","_buffers","deleteTexture","deleteProgram","_createProgram2","numUniforms","getProgramParameter","activeUniforms","getActiveUniform","_initUniforms","sampler","texIdx","uSampler","_getUniform","uniform1i","uniforms","uniform","uniformName","getUniformLocation","a2","a3","a4","a5","a6","a7","options$x","TEMP_POINT$1","ImageLayer","images","_images","_prepareImages","setImages","getImages","_imageData","refreshImages","EMPTY_ARRAY$1","ImageLayerCanvasRenderer","_CanvasRenderer","isDrawable","_imageLoaded","urls","unloaded","retireImage","_drawImages","_drawImage","ImageLayerGLRenderer","_ImageGLRenderable","CanvasLayerRenderer","getPrepareParams","getDrawParams","prepareDrawContext","_drawLayer","_drawLayerOnInteracting","canvasImg","bufferContext","prevent","doubleBuffer","_drawContext","_predrawed","ensureParams","prepareToDraw","_prepareDrawParams","_key2","options$y","CanvasLayer","redraw","isPlaying","requestMapToRender","TEMP_POINT$2","options$z","ParticleLayer","_CanvasLayer","getParticles","_fillCanvas","_shouldClear","trail","_CanvasLayerRenderer","prevX","prevY","EditHandle","_fetchImage","getCursor","markerFile","_img","setContainerPoint","_point","_this$_point","removeTopElement","_dragger","addTopElement","onDragstart","dragHandler","onDragging","onDragend","activeMap","prevCoord","EditOutline","setPoints","allX","allY","EDIT_STAGE_LAYER_PREFIX","createHandleSymbol","options$A","GeometryEditor","prepare","_prepareEditStageLayer","shadowId","_shadowLayer","LayerType","editing","needShadow","_geometryDraggble","_shadow","_switchGeometryEvents","_createOrRefreshOutline","_onMarkerDragEnd","_createCenterHandle","createMarkerEditor","createCircleEditor","createEllipseOrRectEditor","createPolygonEditor","_history","_editOutline","_refreshHooks","_getGeometryEvents","_onGeoSymbolChange","_exeAndReset","oper","_addRefreshHook","cointainerPoint","handle","createHandle","onDown","onMove","onUp","_createHandleInstance","removeVertexOn","onHandleDragstart","_updating","onHandleDragging","_hideContext","onHandleDragEnd","onRefresh","refresh","_createResizeHandles","blackList","onHandleMove","onHandleUp","cursors","axis","isMarker","getResizeAnchors","_ext","resizeHandles","anchorIndexes","handleSymbol","fnLocateHandles","_loop","isBlack","some","ele","geometryToEdit","_recordHistory","getUpdates","verticalAnchor","horizontalAnchor","resizeAbilities","newCoordinates","_updateCoordFromShadow","mirrorHandle","mirror","viewCenter","wh","vr","hr","ability","updates","_this5","handleContainerPoint","wline","hline","_this6","isRect","mouseContainerPoint","pointSub","targetPoint","mirrorContainerPoint","absSub","geoCoord","mirrorCoordinate","mirrorCoord","_mirrorCoord","_mouseCoordinate","_wline","_hline","geoToEdit","verticeLimit","propertyOfVertexIndex","vertexHandles","newVertexHandles","getVertexCoordinates","ringIndex","getVertexPrjCoordinates","onVertexAddOrRemove","removeVertex","_ringIndex","prjCoordinates","nextIndex","isEnd","createNewVertexHandle","moveVertexHandle","handleConatainerPoint","vertice","nVertex","pVertex","hanldeDxdy","compiledSymbol","createVertexHandle","pauseRefresh","nextVertex","vertexCoordinates","vertexIndex","refreshVertex","_vertexCoordinates","_ringIndex2","_ringIndex3","_i4","method","_exeHistory","ignoreRecord","updating","_len3","lastOperation","record","history","TextEditable","startEditText","endEditText","_prepareEditor","_textEditor","innerText","_editUIMarker","onkeyup","isEditingText","getTextEditor","editContainer","_createEditor","_getEditorOffset","_setCursorToLast","labelSize","textColor","spacing","editor","contentEditable","keyCode","range","getSelection","focus","selectAllChildren","collapseToEnd","selection","createRange","moveToElementText","collapse","select","preTranslate","stylesToAnimate","_prepareAnimationStyles","isFocusing","_animationStarted","fnName","toTranslate","dSymbol","_fireAnimateEvent","symbolToAnimate","symbolInStyles","sp","_sp","DRAG_STAGE_LAYER_ID","EVENTS$2","GeometryDragHandler","_prepareDragStageLayer","shadows","_updateShadowSymbol","_prepareShadowConnectors","_dragStageLayer","shadowConnectors","connectors","targetConn","connOptions","connSymbol","conn","_shadowConnectors","_onTargetUpdated","enableAltitude","altitudeProperty","_correctCoord","_startParam","_moved","dragOnScreenAxis","_updateTargetAndRemoveShadow","_editor","redoEdit","undoEdit","cancelEdit","_getEventParams","openInfoWindow","TILE_POINT","TEMP_POINT$3","TEMP_POINT1$2","TEMP_POINT2$2","EMPTY_ARRAY$2","TileWorkerConnection","checkUrl","fetchOptions","BLANK_IMAGE","TileLayerCanvasRenderer","tilesInView","tilesLoading","_parentTiles","_childTiles","tileCache","deleteTile","_tileImageWorkerConn","getCurrentTileZoom","_tileZoom","mask2DExtent","acc","curr","loadingCount","loading","checkedTiles","parentTiles","parentKeys","childTiles","childKeys","placeholders","placeholderKeys","tileQueue","preLoadingCount","_markTiles","loadingLimit","_getLoadLimit","allTiles","placeholder","_generatePlaceHolder","tileLoading","_isLoadingTile","_getCachedTile","getTileOpacity","hitLimit","parentTile","_findParentTile","parentId","_findChildTiles","_drawTiles","loadTileQueue","_retireTiles","t2","onDrawTileStart","_drawTileAndCache","_drawTile","writeZoomStencil","started","resumeZoomStencilTest","startZoomStencilTest","pauseZoomStencilTest","endZoomStencilTest","onDrawTileEnd","_clipByPitch","tileImage","loadTile","loadTime","loadTileImage","onTileLoad","onTileError","referrer","accept","abortTileLoading","falseFn","_addTileToCache","onerrorTick","tileRetryCount","errorUrl","transformed","getDebugInfo","_getLayerOfTile","zoomDiff","_findChildTilesAt","childZoom","dmin","dmax","ex","ey","diff","_tilesLoading$tileId","_tilePlaceHolder","_tile","defaultPlaceholder","cw","ch","TILE_POINT$1","TileLayerGLRenderer","_gl","_bindGLBuffer","stencilFunc","ALWAYS","stencilOp","KEEP","REPLACE","EQUAL","_loadTile","tileCanvas","CanvasRenderer$1","_TileLayerCanvasRende","GLRenderer","_TileLayerGLRenderer","quadVertices","Int8Array","QuadStencil","stencilMask","depthMask","_save","_createBuffer","_createProgram","transformLoc","colorLoc","colorMask","_restore","uniform3fv","random","func","fail","zfail","zpass","resetFunc","_savedProgram","Uint8ClampedArray","OverlayLayerRenderer","_geosToCheck","_resourceChecked","_addGeoToCheckRes","TEMP_EXTENT$6","TEMP_VEC3","TEMP_FIXEDEXTENT","PLACEMENT_CENTER","VectorLayerRenderer","_OverlayLayerCanvasRe","_lastRenderTime","_this$context$canvas","drawGeos","_geosToDraw","_updateMapStateCache","_updateDisplayExtent","_drawnRes","_batchConversionMarkers","_onlyHasPoint","forEachGeo","checkGeo","_sortByDistanceToCamera","_displayExtent","_inCurrentView","inCurrentView","_constructorIsThis","markers","altitudeCache","extentCache","_geo","_pts$_i","symbolkey","meterScale","type0","type1","painter0","painter1","alt0","alt1","dist0","dist1","MapRenderer","_handlerQueue","executeFrameCallbacks","front","panels","hasFront","_frontCount","back","layerDOM","childElementCount","hasBack","_backCount","hasUI","_uiCount","uiDOM","domChanged","frontCount","backCount","uiCount","_frameLoop","MapCanvasRenderer","_MapRenderer","_containerIsCanvas","_thisVisibilitychange","_onVisibilitychange","_loopTime","initContainer","renderFrame","_updateDomPosition","_isViewChanged","updateMapDOM","_getAllLayerToRender","drawLayers","updated","drawLayerCanvas","drawTops","_drawCenterCross","_recordView","_mapview","_getMapView","_spatialRefChanged","_fireLayerLoadEvents","canvasIds","updatedIds","fps","timeLimit","layerLimit","isCanvas","needsRedraw","_checkLayerRedraw","transformMatrix","__zoomTransformMatrix","_drawCanvasLayerOnInteracting","_eventParam","_zoomMatrix","preCanvasIds","_canvasIds","preUpdatedIds","_updatedIds","isLayerCanvasUpdated","sep","isSpatialReferenceChanged","drawTime","inTime","_updateCanvasSize","baseLayerImage","interacting","layerImage","_getLayerImage","targetWidth","targetHeight","_drawLayerCanvasImage","_drawFog","_resizeInterval","clearInterval","_cancelFrameLoop","createContainer","enableSelect","POSITION0","mapAllLayers","backStatic","backLayer","canvasContainer","frontStatic","frontLayer","ui","previous","_frameTimestamp","_resizeCount","_animationFrame","canvasImage","imgOp","_drawContainerExtent","cascadePitches","h30","h60","fogThickness","landscape","topCtx","_checkPositionTime","dTime","_checkSize","_setCheckSizeInterval","_checkSizeInterval","setInterval","_onMapMouseMove","_hitDetectFrame","_getCanvasLayers","visibilityState","_tops","index$6","CanvasTileLayerCanvasRenderer","CanvasTileLayerGLRenderer","OverlayLayerCanvasRenderer","VectorLayerCanvasRenderer","CenterPointRenderer","PolyRenderer","_l2","_ii","_ll","_l3","_l4","_coords","_l5","curretPoint","TEMP_WITHIN","isWithinPixel","_painter$_containerBb","offsetx","offsety","_getRenderSize","prjExtent","arrowStyles","normal","prjVertexes","dasharray","_getArrowPlacement","_getArrows","prjHoles","holePoints","simplified","hole","_setPrototypeOf","setPrototypeOf","_inherits","TypeError","_getPrototypeOf","_isNativeReflectConstruct","Reflect","sham","Proxy","Boolean","valueOf","_typeof","_possibleConstructorReturn","assertThisInitialized","_createSuper","Derived","hasNativeReflectConstruct","isNativeReflectConstruct","Super","NewTarget","possibleConstructorReturn","$","fails","toObject","nativeGetPrototypeOf","CORRECT_PROTOTYPE_GETTER","FAILS_ON_PRIMITIVES","stat","forced","it","nextTick","platform","arch","execPath","pid","browser","env","argv","binding","cwd","chdir","dir","exit","kill","umask","dlopen","uptime","memoryUsage","uvCounters","getBuiltIn","aConstructor","anObject","nativeConstruct","ObjectPrototype","NEW_TARGET_BUG","ARGS_BUG","FORCED","Target","newTarget","$args","instance","getSqDist","getSqSegDist","simplifyRadialDist","sqTolerance","prevPoint","newPoints","simplifyDPStep","maxSqDist","sqDist","simplifyDouglasPeucker","simplify","highestQuality","earcut","holeIndices","dim","invSize","outerLen","outerNode","linkedList","triangles","prev","eliminateHoles","earcutLinked","clockwise","signedArea","insertNode","removeNode","filterPoints","again","steiner","ear","pass","indexCurve","isEarHashed","isEar","cureLocalIntersections","splitEarcut","pointInTriangle","minTX","minTY","maxTX","maxTY","zOrder","maxZ","prevZ","nextZ","locallyInside","isValidDiagonal","splitPolygon","getLeftmost","compareX","eliminateHole","bridge","findHoleBridge","bridgeReverse","filteredBridge","hx","hy","qx","tanMin","sectorContainsSector","sortLinked","tail","numMerges","pSize","qSize","inSize","leftmost","intersectsPolygon","middleInside","q1","q2","o1","o2","o3","o4","onSegment","inside","Node","an","bp","sum","deviation","polygonArea","trianglesArea","flatten","dimensions","holeIndex","REVISION","addAttribute","bufferGeomertry","setRaycasterLinePrecision","raycaster","linePrecision","Line","threshold","getVertexColors","super","isLineSegmentsGeometry","uvs","setIndex","instanceStart","instanceEnd","applyToBufferAttribute","needsUpdate","boundingBox","computeBoundingBox","boundingSphere","computeBoundingSphere","lineSegments","instanceBuffer","colors","instanceColorBuffer","setPositions","mesh","fromWireframeGeometry","isGeometry","isBufferGeometry","setFromBufferAttribute","union","maxRadiusSq","il","fromBufferAttribute","distanceToSquared","UniformsLib","ShaderLib","linewidth","dashScale","dashSize","gapSize","common","fog","clone","dashed","isLineMaterial","defineProperties","diffuse","setValues","material","isLineSegments2","lineDistances","instanceDistanceBuffer","isLineGeometry","isLine2","OPTIONS","interactive","asynchronous","isAdd","_mouseover","_visible","_zoomVisible","picked","isBaseObject","addMesh","removeMesh","object3d","assign","getOptions","distanceToVector3","getObject3d","pickObject3d","_baseObjects","heightEnable","supportHeight","vertexColors","infoWindow","removeToolTip","toolTip","_vt","onSelectMesh","_computeLineDistances","computeLineDistances","idx1","mergeBufferGeometries","uv","mergeBufferGeometriesAttribute","attributesLen","mergedGeometry","indexOffset","mergedIndex","Uint32Array","iIndex","mergedAttribute","mergeBufferAttributes","arrayLength","generateBufferGeometry","generatePickBufferGeometry","getAttribute","getIndex","defaultBufferGeometry","getDefaultBufferGeometry","barGeometryCache","defaultBoxGeometry","getDefaultCylinderBufferGeometry","radialSegments","getGeometry","initVertexColors","_topColor","mergeBarGeometry","colorLen","bufferGeometry","dispose","getDefaultBoxGeometry","topColor","bottomColor","_createMesh","coordinateToVector3","TYPES","getGeoJSONType","isGeoJSONPolygon","isGeoJSONLine","isGeoJSONPoint","isGeoJSONMulti","getGeoJSONCoordinates","getGeoJSONCenter","coordLen","spliteGeoJSONMulti","fType","v2Dot","v2Normalize","scaleAndAdd","v2Add","v3Sub","v3Normalize","v3Cross","rel","slerp","cosT","acos","lineIntersection","x4","y4","writeOffset","dx1","dx2","dy1","dy2","tmp1","tmp2","triangulate","innerOffsetPolygon","outStart","removeIntersections","checkMiterLimit","prevOffsetX","prevOffsetY","prevCursor","indicesMap","tmpIntersection","nextIdx","prevIdx","needCheckIntersection","cosA","sinA","miter","isCovex","halfA","innerOffsetPolyline","outOff","offsetPolygon","offsetVertices","exteriorSize","reversePoints","stride","convertToClockwise","polygonVertexCount","normalizeOpts","depth","bevelSize","bevelSegments","smoothBevel","smoothSide","smoothSideThreshold","boundingRect","fitRect","targetX","targetY","generateNormal","v3Set","v21","v32","normals","i1","i2","i3","quadToTriangle","ringDistance","firstX","firstY","addExtrudeSide","topVertices","splittedMap","ringVertexCount","splitBevel","vertexOffset","ringPerimeter","isDuplicateVertex","ringCount","vLen","uLen","rawIdx","prevX2","prevY2","prevZ2","sideStartRingN","addTopAndBottom","indicesLen","excludeBottom","vertexCount","splitVertices","isAutoSmooth","newVertices","newHoles","polysCount","angleCos","innerExtrudeTriangulatedPolygon","preparedData","indexCount","faceEnd","faceStart","sideRingVertexCount","convertPolylineToTriangulatedPolygon","polyline","polylineIdx","pointCount","insidePoints","outsidePoints","outsideIndicesMap","insideIndicesMap","polygonVertices","outsidePointCount","rawVertices","removeClosePointsOfPolygon","epsilon","newPolygon","simplifyPolygon","extrudePolygon","polygons","updateBoundingRect","transformdRect","simplifyTolerance","extrudePolyline","polylines","newPolyline","getCenterOfPoints","lnglats","setBottomHeight","bottomHeight","getGeometriesColorArray","geometriesAttributes","colorsLen","coordiantesToArrayBuffer","coordiantes","Float64Array","getExtrudeGeometry","getExtrudeGeometryParams","centerPt","altCache","datas","getPolygonPositions","shapes","middleZ","isArrayBuff","getSinglePolygonPositions","fs","outer","coordinatiesToGLFloatArray","positons2d","coordinatiesToGLArray","getPolygonArrayBuffer","getSinglePolygonArrayBuffer","isGeoJSON","COMMA","getLinePosition","hasVectorArray","positionsV","positions2d","cent","arrayBuffer","getChunkLinesPosition","chunkLines","positionMap","key1","getExtrudeLineParams","ps","LineStringSplit","lineStrings","getLineSegmentPosition","mergeLinePositions","positionsList","getLineArrayBuffer","defaultGeometry","getDefaultLineGeometry","workerName","getWorkerName","MeshActor","getActor","getDistance","gengerateExtrudePolygons","isMercator","transfer","_properties","gengerateExtrudeLines","lineStringList","multiLineString","gengerateLines","getDatas","queues","baseObject","queueMap","tempQueue","getCurrentTime","deQueueCount","resultQueue","deQueue","resultList","_workerLoad","actor","pushQueue","pushResult","loop","ExtrudePolygonTaskIns","ExtrudePolygonsTaskIns","ExtrudeLineTaskIns","ExtrudeLinesTaskIns","LineTaskIns","LinesTaskIns","FatLineTaskIns","FatLinesTaskIns","BaseObjectTaskManager","isRunning","initColors","cs","positionList","_createLineSegments","extrudeParams","attribute","extrudeH","model","_createGroup","MINLENGTH","formatLineArray","degreesToRadians","getPercentLngLat","percent","lineSlice","lineChunkLength","LEN","totalLen","floorlen","LNGLATSLEN","currentLngLat","currentLen","lines","lls","offsetLen","MAX_POINTS","setExtrudeLineGeometryAttribute","norls","chunkLength","chunkLine","inds","_init","defaultMaterial","MergedMixin","baseObjects","_proxyEvent","_showGeometry","selectMesh","getSelectMesh","indexs","_geometriesAttributes","bufferAttribute","_getHideGeometryIndex","_geometryCache","NaN","isHide","geometryAttributes","buffGeom","_updateAttribute","_getIndex","_datas","faceIndex","pick","getPick","_colorMap","cIndex","getColor","colorIndex","getHex","setPickObject3d","extrudePolygons","psIndex","normalIndex","uvIndex","faceLen","psCount","normalCount","uvCount","_initBaseObjectsEvent","_setPickObject3d","vector2Pixel","world_vector","camera","halfWidth","halfHeight","vs","_createPoints","getCamera","pointSize","ROW","COL","minlng","minlat","maxlng","maxlat","rec","grids","averageX","averageY","ROWS","COLS","roundFun","tempValue","initGrids","vectors","pointMeshes","maxSize","hasColor","hasSize","TEMP_VECTOR","row","col","gridIndex","_grids","_bindMapEvents","_updateGrids","updateBBoxPixel","bs","isRecCross","bars","parray","bar","centers","extrudeLines","le","MAX","waitingQueue","getQueues","currentQueue","vt","loopMessage","outQueue","deleteQueueItem","queArray","nextLoop","DEFAULT_IMAGE","generateImage","getMaterial","_baseObjectKeys","_loadTiles","_layerLaodTime","getTime","loadTiles","baseos","baseobjects","keysMap","_getCurentTileKeys","keys1","offsetTime","threeLayer","tilesInViewLen","loadTilesLen","needsRemoveBaseObjects","baseobject","_getXYZOfIndex","_diffCache","currentCount","needCount","formatBaseObjects","_cachetile","isAsynchronous","_diposeBaseObject","bos","bo","_faceMap","splitstr","_getTileExtent","geojson","_getMaterial","extrudepolygons","toExtrudePolygons","toLines","toPoints","getTileData","_layerOnLoad","getBaseObjects","intervalId","_isLoad","tileinfo","_generateBaseObjects","getPlaneGeometryAttribute","devideW","devideH","tempIndex","uIndex","uvx","uvy","indexArray","getPlaneGeometry","textureLoader","getRGBData","HTMLCanvasElement","imageWidth","imageHeight","vxmin","vymin","vxmax","vymax","rgbImg","imgdata","R","G","B","tileDivisor","_imgQueue","_getTileLngLatExtent","terrain","rgbImage","Intensity","0.25","0.55","0.85","1","minSize","initPalette","setMax","setMin","setMinSize","paletteCtx","lineGradient","getLegend","createCircle","offsetDistance","colorize","pixels","jMin","jMax","maxOpacity","minOpacity","drawGray","dataSet","circleHalfWidth","circleHalfHeight","dataOrderByAlpha","_data","withoutAlpha","strength","shadowCanvas","shadowContext","intensity","absolute","colored","putImageData","gridScale","CANVAS_MAX_SIZE","maxOffset","canvasWidth","canvasHeight","maxAlpha","blackps","alphas","rgb","filterIndex","object3ds","getThreeRenderer","pickingTexture","pickingScene","setHex","pw","ph","setSize","setRenderTarget","pixelBuffer","readRenderTargetPixels","_setMaterialRes","_createLine2","setColors","_colorIndex","newPosition","fetchDataWorkerKey","fetchDataWorkerCode","tasks","taskings","concurrentCount","loopTask","task","abort","fetchData","fetch","postResponse","catch","finally","initialize","onmessage","LINEPRECISIONS","KEY_FBO","_animationBaseObjectMap","_needsUpdate","_mousemoveTimeOut","_delayMeshes","scene","timeStamp","renderScene","coordinaties","array3d","toShape","shape","toExtrudeMesh","amount","geom","fromGeometry","coorindate","getMeshes","getScene","meshes","clearMesh","uuid","delayMeshes","loopRenderCount","_containerPoint","_zoomend","_raycaster","_mouse","_initRaycaster","mouse","setFromCamera","_getLinePrecision","hasidentifyChildren","intersectObjects","intersect","_recursionMesh","renderPickScene","resLevel","precision","geometryEvents","identifyCountOnEvent","outBaseObjects","isOut","baseO","closeToolTip","tooltip","getToolTip","openToolTip","zoomChange","_identifyBaseObjectEvents","_renderTime","_renderTarget","glOptions","antialias","stencil","preserveDrawingBuffer","_createGLContext","_initThreeRenderer","matrix4","autoClear","setClearColor","matrixAutoUpdate","_syncCamera","star","_callbackBaseObjectAnimation","renderTarget","fbo","scissor","depthBuffer","renderTargetProps","threeCreatedFBO","getFramebuffer","elements","projectionMatrix","projectionMatrixInverse","getInverse","getGLZoom","factory","quickselectStep","defaultCompare","sd","newLeft","newRight","swap","UnrealBloomPass","Vector2","Color","pars","minFilter","LinearFilter","magFilter","RGBAFormat","renderTargetsHorizontal","renderTargetsVertical","nMips","resx","resy","renderTargetBright","WebGLRenderTarget","generateMipmaps","renderTargetHorizonal","renderTargetVertical","LuminosityHighPassShader","highPassShader","highPassUniforms","UniformsUtils","materialHighPassFilter","ShaderMaterial","defines","separableBlurMaterials","kernelSizeArray","getSeperableBlurMaterial","compositeMaterial","getCompositeMaterial","bloomFactors","bloomTintColors","Vector3","CopyShader","copyShader","copyUniforms","materialCopy","blending","AdditiveBlending","depthTest","depthWrite","needsSwap","_oldClearColor","oldClearAlpha","basic","MeshBasicMaterial","fsQuad","FullScreenQuad","writeBuffer","readBuffer","deltaTime","maskActive","getClearColor","getClearAlpha","oldAutoClear","setTest","renderToScreen","inputRenderTarget","BlurDirectionX","BlurDirectionY","kernelRadius","Pass","_vm","_h","$createElement","_c","_self","staticClass","attrs","$event","$router","go","staticRenderFns","effectList","ruleForm","views","animateId","roadLine","lineList","methods","createGeometry","createEffect","effect","wireframe","circle1","tweenA","onComplete","Cylinder","createPointGeo","createText","createLineFly","addLines","flyLine","iTime","uRange","uTotal","uColor","uColor1","side","cityRoadLine","st","temp","textList","threeLine","loadMap","initScene","initComposer","composer","EffectComposer","renderPass","RenderPass","addPass","smaaPass","bloomPass","bloomEnable","exposure","getGeoJson","bySubway","replay","way","mounted","render1","destroyed","component","shaderID","TWEEN","_tweens","getAll","removeAll","tween","numTweens","Tween","_object","_valuesStart","_valuesEnd","_duration","_delayTime","_startTime","_easingFunction","Linear","None","_interpolationFunction","Interpolation","_chainedTweens","_onStartCallback","_onStartCallbackFired","_onUpdateCallback","_onCompleteCallback","delay","interpolation","chain","onStart","onUpdate","numChainedTweens","Quadratic","In","Out","InOut","Cubic","Quartic","Quintic","Sinusoidal","Exponential","Circular","Elastic","Back","Bounce","Utils","Bezier","bn","Bernstein","CatmullRom","fc","Factorial","t3","normalizeArray","allowAboveRoot","unshift","basename","matchedSlash","xs","resolvedPath","resolvedAbsolute","isAbsolute","trailingSlash","paths","relative","fromParts","toParts","samePartsLength","outputParts","delimiter","dirname","hasRoot","extname","startDot","startPart","preDotState","setToStringTag","planes","intersectsBox","setPlanes","plane","me0","me1","me2","me3","me4","me5","me6","me7","me8","me9","me10","me11","me12","me13","me14","me15","setComponents","normalLength","MutationObserver","setImmediate","reject","handled","suppressUncaughtRejectionError","timeout","define","amd","Zousan","soon"],"mappings":"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","file":"static/js/chunk-199f48ff.a06ac479.js","sourcesContent":["'use strict';\n\nmodule.exports = rbush;\nmodule.exports.default = rbush;\n\nvar quickselect = require('quickselect');\n\nfunction rbush(maxEntries, format) {\n    if (!(this instanceof rbush)) return new rbush(maxEntries, format);\n\n    // max entries in a node is 9 by default; min node fill is 40% for best performance\n    this._maxEntries = Math.max(4, maxEntries || 9);\n    this._minEntries = Math.max(2, Math.ceil(this._maxEntries * 0.4));\n\n    if (format) {\n        this._initFormat(format);\n    }\n\n    this.clear();\n}\n\nrbush.prototype = {\n\n    all: function () {\n        return this._all(this.data, []);\n    },\n\n    search: function (bbox) {\n\n        var node = this.data,\n            result = [],\n            toBBox = this.toBBox;\n\n        if (!intersects(bbox, node)) return result;\n\n        var nodesToSearch = [],\n            i, len, child, childBBox;\n\n        while (node) {\n            for (i = 0, len = node.children.length; i < len; i++) {\n\n                child = node.children[i];\n                childBBox = node.leaf ? toBBox(child) : child;\n\n                if (intersects(bbox, childBBox)) {\n                    if (node.leaf) result.push(child);\n                    else if (contains(bbox, childBBox)) this._all(child, result);\n                    else nodesToSearch.push(child);\n                }\n            }\n            node = nodesToSearch.pop();\n        }\n\n        return result;\n    },\n\n    collides: function (bbox) {\n\n        var node = this.data,\n            toBBox = this.toBBox;\n\n        if (!intersects(bbox, node)) return false;\n\n        var nodesToSearch = [],\n            i, len, child, childBBox;\n\n        while (node) {\n            for (i = 0, len = node.children.length; i < len; i++) {\n\n                child = node.children[i];\n                childBBox = node.leaf ? toBBox(child) : child;\n\n                if (intersects(bbox, childBBox)) {\n                    if (node.leaf || contains(bbox, childBBox)) return true;\n                    nodesToSearch.push(child);\n                }\n            }\n            node = nodesToSearch.pop();\n        }\n\n        return false;\n    },\n\n    load: function (data) {\n        if (!(data && data.length)) return this;\n\n        if (data.length < this._minEntries) {\n            for (var i = 0, len = data.length; i < len; i++) {\n                this.insert(data[i]);\n            }\n            return this;\n        }\n\n        // recursively build the tree with the given data from scratch using OMT algorithm\n        var node = this._build(data.slice(), 0, data.length - 1, 0);\n\n        if (!this.data.children.length) {\n            // save as is if tree is empty\n            this.data = node;\n\n        } else if (this.data.height === node.height) {\n            // split root if trees have the same height\n            this._splitRoot(this.data, node);\n\n        } else {\n            if (this.data.height < node.height) {\n                // swap trees if inserted one is bigger\n                var tmpNode = this.data;\n                this.data = node;\n                node = tmpNode;\n            }\n\n            // insert the small tree into the large tree at appropriate level\n            this._insert(node, this.data.height - node.height - 1, true);\n        }\n\n        return this;\n    },\n\n    insert: function (item) {\n        if (item) this._insert(item, this.data.height - 1);\n        return this;\n    },\n\n    clear: function () {\n        this.data = createNode([]);\n        return this;\n    },\n\n    remove: function (item, equalsFn) {\n        if (!item) return this;\n\n        var node = this.data,\n            bbox = this.toBBox(item),\n            path = [],\n            indexes = [],\n            i, parent, index, goingUp;\n\n        // depth-first iterative tree traversal\n        while (node || path.length) {\n\n            if (!node) { // go up\n                node = path.pop();\n                parent = path[path.length - 1];\n                i = indexes.pop();\n                goingUp = true;\n            }\n\n            if (node.leaf) { // check current node\n                index = findItem(item, node.children, equalsFn);\n\n                if (index !== -1) {\n                    // item found, remove the item and condense tree upwards\n                    node.children.splice(index, 1);\n                    path.push(node);\n                    this._condense(path);\n                    return this;\n                }\n            }\n\n            if (!goingUp && !node.leaf && contains(node, bbox)) { // go down\n                path.push(node);\n                indexes.push(i);\n                i = 0;\n                parent = node;\n                node = node.children[0];\n\n            } else if (parent) { // go right\n                i++;\n                node = parent.children[i];\n                goingUp = false;\n\n            } else node = null; // nothing found\n        }\n\n        return this;\n    },\n\n    toBBox: function (item) { return item; },\n\n    compareMinX: compareNodeMinX,\n    compareMinY: compareNodeMinY,\n\n    toJSON: function () { return this.data; },\n\n    fromJSON: function (data) {\n        this.data = data;\n        return this;\n    },\n\n    _all: function (node, result) {\n        var nodesToSearch = [];\n        while (node) {\n            if (node.leaf) result.push.apply(result, node.children);\n            else nodesToSearch.push.apply(nodesToSearch, node.children);\n\n            node = nodesToSearch.pop();\n        }\n        return result;\n    },\n\n    _build: function (items, left, right, height) {\n\n        var N = right - left + 1,\n            M = this._maxEntries,\n            node;\n\n        if (N <= M) {\n            // reached leaf level; return leaf\n            node = createNode(items.slice(left, right + 1));\n            calcBBox(node, this.toBBox);\n            return node;\n        }\n\n        if (!height) {\n            // target height of the bulk-loaded tree\n            height = Math.ceil(Math.log(N) / Math.log(M));\n\n            // target number of root entries to maximize storage utilization\n            M = Math.ceil(N / Math.pow(M, height - 1));\n        }\n\n        node = createNode([]);\n        node.leaf = false;\n        node.height = height;\n\n        // split the items into M mostly square tiles\n\n        var N2 = Math.ceil(N / M),\n            N1 = N2 * Math.ceil(Math.sqrt(M)),\n            i, j, right2, right3;\n\n        multiSelect(items, left, right, N1, this.compareMinX);\n\n        for (i = left; i <= right; i += N1) {\n\n            right2 = Math.min(i + N1 - 1, right);\n\n            multiSelect(items, i, right2, N2, this.compareMinY);\n\n            for (j = i; j <= right2; j += N2) {\n\n                right3 = Math.min(j + N2 - 1, right2);\n\n                // pack each entry recursively\n                node.children.push(this._build(items, j, right3, height - 1));\n            }\n        }\n\n        calcBBox(node, this.toBBox);\n\n        return node;\n    },\n\n    _chooseSubtree: function (bbox, node, level, path) {\n\n        var i, len, child, targetNode, area, enlargement, minArea, minEnlargement;\n\n        while (true) {\n            path.push(node);\n\n            if (node.leaf || path.length - 1 === level) break;\n\n            minArea = minEnlargement = Infinity;\n\n            for (i = 0, len = node.children.length; i < len; i++) {\n                child = node.children[i];\n                area = bboxArea(child);\n                enlargement = enlargedArea(bbox, child) - area;\n\n                // choose entry with the least area enlargement\n                if (enlargement < minEnlargement) {\n                    minEnlargement = enlargement;\n                    minArea = area < minArea ? area : minArea;\n                    targetNode = child;\n\n                } else if (enlargement === minEnlargement) {\n                    // otherwise choose one with the smallest area\n                    if (area < minArea) {\n                        minArea = area;\n                        targetNode = child;\n                    }\n                }\n            }\n\n            node = targetNode || node.children[0];\n        }\n\n        return node;\n    },\n\n    _insert: function (item, level, isNode) {\n\n        var toBBox = this.toBBox,\n            bbox = isNode ? item : toBBox(item),\n            insertPath = [];\n\n        // find the best node for accommodating the item, saving all nodes along the path too\n        var node = this._chooseSubtree(bbox, this.data, level, insertPath);\n\n        // put the item into the node\n        node.children.push(item);\n        extend(node, bbox);\n\n        // split on node overflow; propagate upwards if necessary\n        while (level >= 0) {\n            if (insertPath[level].children.length > this._maxEntries) {\n                this._split(insertPath, level);\n                level--;\n            } else break;\n        }\n\n        // adjust bboxes along the insertion path\n        this._adjustParentBBoxes(bbox, insertPath, level);\n    },\n\n    // split overflowed node into two\n    _split: function (insertPath, level) {\n\n        var node = insertPath[level],\n            M = node.children.length,\n            m = this._minEntries;\n\n        this._chooseSplitAxis(node, m, M);\n\n        var splitIndex = this._chooseSplitIndex(node, m, M);\n\n        var newNode = createNode(node.children.splice(splitIndex, node.children.length - splitIndex));\n        newNode.height = node.height;\n        newNode.leaf = node.leaf;\n\n        calcBBox(node, this.toBBox);\n        calcBBox(newNode, this.toBBox);\n\n        if (level) insertPath[level - 1].children.push(newNode);\n        else this._splitRoot(node, newNode);\n    },\n\n    _splitRoot: function (node, newNode) {\n        // split root node\n        this.data = createNode([node, newNode]);\n        this.data.height = node.height + 1;\n        this.data.leaf = false;\n        calcBBox(this.data, this.toBBox);\n    },\n\n    _chooseSplitIndex: function (node, m, M) {\n\n        var i, bbox1, bbox2, overlap, area, minOverlap, minArea, index;\n\n        minOverlap = minArea = Infinity;\n\n        for (i = m; i <= M - m; i++) {\n            bbox1 = distBBox(node, 0, i, this.toBBox);\n            bbox2 = distBBox(node, i, M, this.toBBox);\n\n            overlap = intersectionArea(bbox1, bbox2);\n            area = bboxArea(bbox1) + bboxArea(bbox2);\n\n            // choose distribution with minimum overlap\n            if (overlap < minOverlap) {\n                minOverlap = overlap;\n                index = i;\n\n                minArea = area < minArea ? area : minArea;\n\n            } else if (overlap === minOverlap) {\n                // otherwise choose distribution with minimum area\n                if (area < minArea) {\n                    minArea = area;\n                    index = i;\n                }\n            }\n        }\n\n        return index;\n    },\n\n    // sorts node children by the best axis for split\n    _chooseSplitAxis: function (node, m, M) {\n\n        var compareMinX = node.leaf ? this.compareMinX : compareNodeMinX,\n            compareMinY = node.leaf ? this.compareMinY : compareNodeMinY,\n            xMargin = this._allDistMargin(node, m, M, compareMinX),\n            yMargin = this._allDistMargin(node, m, M, compareMinY);\n\n        // if total distributions margin value is minimal for x, sort by minX,\n        // otherwise it's already sorted by minY\n        if (xMargin < yMargin) node.children.sort(compareMinX);\n    },\n\n    // total margin of all possible split distributions where each node is at least m full\n    _allDistMargin: function (node, m, M, compare) {\n\n        node.children.sort(compare);\n\n        var toBBox = this.toBBox,\n            leftBBox = distBBox(node, 0, m, toBBox),\n            rightBBox = distBBox(node, M - m, M, toBBox),\n            margin = bboxMargin(leftBBox) + bboxMargin(rightBBox),\n            i, child;\n\n        for (i = m; i < M - m; i++) {\n            child = node.children[i];\n            extend(leftBBox, node.leaf ? toBBox(child) : child);\n            margin += bboxMargin(leftBBox);\n        }\n\n        for (i = M - m - 1; i >= m; i--) {\n            child = node.children[i];\n            extend(rightBBox, node.leaf ? toBBox(child) : child);\n            margin += bboxMargin(rightBBox);\n        }\n\n        return margin;\n    },\n\n    _adjustParentBBoxes: function (bbox, path, level) {\n        // adjust bboxes along the given tree path\n        for (var i = level; i >= 0; i--) {\n            extend(path[i], bbox);\n        }\n    },\n\n    _condense: function (path) {\n        // go through the path, removing empty nodes and updating bboxes\n        for (var i = path.length - 1, siblings; i >= 0; i--) {\n            if (path[i].children.length === 0) {\n                if (i > 0) {\n                    siblings = path[i - 1].children;\n                    siblings.splice(siblings.indexOf(path[i]), 1);\n\n                } else this.clear();\n\n            } else calcBBox(path[i], this.toBBox);\n        }\n    },\n\n    _initFormat: function (format) {\n        // data format (minX, minY, maxX, maxY accessors)\n\n        // uses eval-type function compilation instead of just accepting a toBBox function\n        // because the algorithms are very sensitive to sorting functions performance,\n        // so they should be dead simple and without inner calls\n\n        var compareArr = ['return a', ' - b', ';'];\n\n        this.compareMinX = new Function('a', 'b', compareArr.join(format[0]));\n        this.compareMinY = new Function('a', 'b', compareArr.join(format[1]));\n\n        this.toBBox = new Function('a',\n            'return {minX: a' + format[0] +\n            ', minY: a' + format[1] +\n            ', maxX: a' + format[2] +\n            ', maxY: a' + format[3] + '};');\n    }\n};\n\nfunction findItem(item, items, equalsFn) {\n    if (!equalsFn) return items.indexOf(item);\n\n    for (var i = 0; i < items.length; i++) {\n        if (equalsFn(item, items[i])) return i;\n    }\n    return -1;\n}\n\n// calculate node's bbox from bboxes of its children\nfunction calcBBox(node, toBBox) {\n    distBBox(node, 0, node.children.length, toBBox, node);\n}\n\n// min bounding rectangle of node children from k to p-1\nfunction distBBox(node, k, p, toBBox, destNode) {\n    if (!destNode) destNode = createNode(null);\n    destNode.minX = Infinity;\n    destNode.minY = Infinity;\n    destNode.maxX = -Infinity;\n    destNode.maxY = -Infinity;\n\n    for (var i = k, child; i < p; i++) {\n        child = node.children[i];\n        extend(destNode, node.leaf ? toBBox(child) : child);\n    }\n\n    return destNode;\n}\n\nfunction extend(a, b) {\n    a.minX = Math.min(a.minX, b.minX);\n    a.minY = Math.min(a.minY, b.minY);\n    a.maxX = Math.max(a.maxX, b.maxX);\n    a.maxY = Math.max(a.maxY, b.maxY);\n    return a;\n}\n\nfunction compareNodeMinX(a, b) { return a.minX - b.minX; }\nfunction compareNodeMinY(a, b) { return a.minY - b.minY; }\n\nfunction bboxArea(a)   { return (a.maxX - a.minX) * (a.maxY - a.minY); }\nfunction bboxMargin(a) { return (a.maxX - a.minX) + (a.maxY - a.minY); }\n\nfunction enlargedArea(a, b) {\n    return (Math.max(b.maxX, a.maxX) - Math.min(b.minX, a.minX)) *\n           (Math.max(b.maxY, a.maxY) - Math.min(b.minY, a.minY));\n}\n\nfunction intersectionArea(a, b) {\n    var minX = Math.max(a.minX, b.minX),\n        minY = Math.max(a.minY, b.minY),\n        maxX = Math.min(a.maxX, b.maxX),\n        maxY = Math.min(a.maxY, b.maxY);\n\n    return Math.max(0, maxX - minX) *\n           Math.max(0, maxY - minY);\n}\n\nfunction contains(a, b) {\n    return a.minX <= b.minX &&\n           a.minY <= b.minY &&\n           b.maxX <= a.maxX &&\n           b.maxY <= a.maxY;\n}\n\nfunction intersects(a, b) {\n    return b.minX <= a.maxX &&\n           b.minY <= a.maxY &&\n           b.maxX >= a.minX &&\n           b.maxY >= a.minY;\n}\n\nfunction createNode(children) {\n    return {\n        children: children,\n        height: 1,\n        leaf: true,\n        minX: Infinity,\n        minY: Infinity,\n        maxX: -Infinity,\n        maxY: -Infinity\n    };\n}\n\n// sort an array so that items come in groups of n unsorted items, with groups sorted between each other;\n// combines selection algorithm with binary divide & conquer approach\n\nfunction multiSelect(arr, left, right, n, compare) {\n    var stack = [left, right],\n        mid;\n\n    while (stack.length) {\n        right = stack.pop();\n        left = stack.pop();\n\n        if (right - left <= n) continue;\n\n        mid = left + Math.ceil((right - left) / n / 2) * n;\n        quickselect(arr, mid, left, right, compare);\n\n        stack.push(left, mid, mid, right);\n    }\n}\n","'use strict';\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar aCallable = require('../internals/a-callable');\nvar isObject = require('../internals/is-object');\nvar hasOwn = require('../internals/has-own-property');\nvar arraySlice = require('../internals/array-slice');\nvar NATIVE_BIND = require('../internals/function-bind-native');\n\nvar Function = global.Function;\nvar concat = uncurryThis([].concat);\nvar join = uncurryThis([].join);\nvar factories = {};\n\nvar construct = function (C, argsLength, args) {\n  if (!hasOwn(factories, argsLength)) {\n    for (var list = [], i = 0; i < argsLength; i++) list[i] = 'a[' + i + ']';\n    factories[argsLength] = Function('C,a', 'return new C(' + join(list, ',') + ')');\n  } return factories[argsLength](C, args);\n};\n\n// `Function.prototype.bind` method implementation\n// https://tc39.es/ecma262/#sec-function.prototype.bind\nmodule.exports = NATIVE_BIND ? Function.bind : function bind(that /* , ...args */) {\n  var F = aCallable(this);\n  var Prototype = F.prototype;\n  var partArgs = arraySlice(arguments, 1);\n  var boundFunction = function bound(/* args... */) {\n    var args = concat(partArgs, arraySlice(arguments));\n    return this instanceof boundFunction ? construct(F, args.length, args) : F.apply(that, args);\n  };\n  if (isObject(Prototype)) boundFunction.prototype = Prototype;\n  return boundFunction;\n};\n","/*!\n * maptalks v1.0.0-rc.4\n * LICENSE : BSD-3-Clause\n * (c) 2016-2022 maptalks.org\n */\nimport Zousan from 'zousan';\nimport rbush from 'rbush';\nimport simplify from 'simplify-js';\nimport { intersectsBox } from 'frustum-intersects';\n\nvar version = \"1.0.0-rc.4\";\n\nvar INTERNAL_LAYER_PREFIX = '_maptalks__internal_layer_';\nvar GEOMETRY_COLLECTION_TYPES = ['MultiPoint', 'MultiLineString', 'MultiPolygon', 'GeometryCollection'];\nvar GEOJSON_TYPES = ['FeatureCollection', 'Feature', 'Point', 'LineString', 'Polygon'].concat(GEOMETRY_COLLECTION_TYPES);\nvar RESOURCE_PROPERTIES = ['markerFile', 'polygonPatternFile', 'linePatternFile', 'markerFillPatternFile', 'markerLinePatternFile'];\nvar RESOURCE_SIZE_PROPERTIES = [['markerWidth', 'markerHeight'], [], [null, 'lineWidth'], [], [null, 'markerLineWidth']];\nvar NUMERICAL_PROPERTIES = {\n  'lineWidth': 1,\n  'lineOpacity': 1,\n  'lineDx': 1,\n  'lineDy': 1,\n  'polygonOpacity': 1,\n  'markerWidth': 1,\n  'markerHeight': 1,\n  'markerDx': 1,\n  'markerDy': 1,\n  'markerOpacity': 1,\n  'markerFillOpacity': 1,\n  'markerLineWidth': 1,\n  'markerLineOpacity': 1,\n  'textSize': 1,\n  'textOpacity': 1,\n  'textHaloRadius': 1,\n  'textWrapWidth': 1,\n  'textLineSpacing': 1,\n  'textDx': 1,\n  'textDy': 1\n};\nvar COLOR_PROPERTIES = ['lineColor', 'polygonFill', 'markerFill', 'markerLineColor', 'textFill'];\nvar DEFAULT_TEXT_SIZE = 14;\n\nfunction now() {\n  return Date.now();\n}\nfunction extend(dest) {\n  for (var i = 1; i < arguments.length; i++) {\n    var src = arguments[i];\n\n    for (var k in src) {\n      dest[k] = src[k];\n    }\n  }\n\n  return dest;\n}\nfunction isNil(obj) {\n  return obj == null;\n}\nfunction isNumber(val) {\n  return typeof val === 'number' && !isNaN(val);\n}\nfunction isInteger(n) {\n  return (n | 0) === n;\n}\nfunction isObject(obj) {\n  return typeof obj === 'object' && !!obj;\n}\nfunction isString(obj) {\n  if (isNil(obj)) {\n    return false;\n  }\n\n  return typeof obj === 'string' || obj.constructor !== null && obj.constructor === String;\n}\nfunction isFunction(obj) {\n  if (isNil(obj)) {\n    return false;\n  }\n\n  return typeof obj === 'function' || obj.constructor !== null && obj.constructor === Function;\n}\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nfunction hasOwn(obj, key) {\n  return hasOwnProperty.call(obj, key);\n}\nfunction join(arr, seperator) {\n  if (arr.join) {\n    return arr.join(seperator || ',');\n  } else {\n    return Array.prototype.join.call(arr, seperator || ',');\n  }\n}\nfunction isEmpty(object) {\n  var property;\n\n  for (property in object) {\n    return false;\n  }\n\n  return !property;\n}\nvar pi = Math.PI / 180;\nfunction toRadian(d) {\n  return d * pi;\n}\nfunction toDegree(r) {\n  return r / pi;\n}\n\nvar IS_NODE = Object.prototype.toString.call(typeof process !== 'undefined' ? process : 0) === '[object process]' && !process.versions['electron'] && !process.versions['nw'] && !process.versions['node-webkit'];\n\nvar Browser = {};\nvar maps = {};\n\nfunction getDevicePixelRatio() {\n  return window.devicePixelRatio || window.screen.deviceXDPI / window.screen.logicalXDPI;\n}\n\nif (!IS_NODE) {\n  var ua = navigator.userAgent.toLowerCase(),\n      doc = document.documentElement,\n      ie = 'ActiveXObject' in window,\n      webkit = ua.indexOf('webkit') !== -1,\n      phantomjs = ua.indexOf('phantom') !== -1,\n      android23 = ua.search('android [23]') !== -1,\n      chrome = ua.indexOf('chrome') !== -1,\n      gecko = ua.indexOf('gecko') !== -1 && !webkit && !window.opera && !ie,\n      mobile = typeof orientation !== 'undefined' || ua.indexOf('mobile') !== -1,\n      msPointer = !window.PointerEvent && window.MSPointerEvent,\n      pointer = window.PointerEvent && navigator.pointerEnabled || msPointer,\n      ie3d = ie && 'transition' in doc.style,\n      webkit3d = 'WebKitCSSMatrix' in window && 'm11' in new window.WebKitCSSMatrix() && !android23,\n      gecko3d = 'MozPerspective' in doc.style,\n      opera12 = 'OTransition' in doc.style,\n      any3d = (ie3d || webkit3d || gecko3d) && !opera12 && !phantomjs,\n      imageBitMap = typeof window !== 'undefined' && isFunction(window.createImageBitmap),\n      resizeObserver = typeof window !== 'undefined' && isFunction(window.ResizeObserver),\n      btoa = typeof window !== 'undefined' && isFunction(window.btoa);\n  var chromeVersion = 0;\n\n  if (chrome) {\n    chromeVersion = ua.match(/chrome\\/([\\d.]+)/)[1];\n  }\n\n  var touch = !phantomjs && (pointer || 'ontouchstart' in window || window.DocumentTouch && document instanceof window.DocumentTouch);\n  var webgl = typeof window !== 'undefined' && 'WebGLRenderingContext' in window;\n  var devicePixelRatio = getDevicePixelRatio();\n  var decodeImageInWorker = false;\n\n  try {\n    var offCanvas = new OffscreenCanvas(2, 2);\n    offCanvas.getContext('2d');\n    decodeImageInWorker = true;\n  } catch (err) {\n    decodeImageInWorker = false;\n  }\n\n  var supportsPassive = false;\n\n  try {\n    window.addEventListener('testPassive', function () {}, {\n      get passive() {\n        supportsPassive = true;\n      }\n\n    });\n  } catch (e) {}\n\n  Browser = {\n    ie: ie,\n    ielt9: ie && !document.addEventListener,\n    edge: 'msLaunchUri' in navigator && !('documentMode' in document),\n    webkit: webkit,\n    gecko: gecko,\n    android: ua.indexOf('android') !== -1,\n    android23: android23,\n    chrome: chrome,\n    chromeVersion: chromeVersion,\n    safari: !chrome && ua.indexOf('safari') !== -1,\n    phantomjs: phantomjs,\n    ie3d: ie3d,\n    webkit3d: webkit3d,\n    gecko3d: gecko3d,\n    opera12: opera12,\n    any3d: any3d,\n    mobile: mobile,\n    mobileWebkit: mobile && webkit,\n    mobileWebkit3d: mobile && webkit3d,\n    mobileOpera: mobile && window.opera,\n    mobileGecko: mobile && gecko,\n    touch: !!touch,\n    msPointer: !!msPointer,\n    pointer: !!pointer,\n    retina: devicePixelRatio > 1,\n    devicePixelRatio: devicePixelRatio,\n    language: navigator.browserLanguage ? navigator.browserLanguage : navigator.language,\n    ie9: ie && document.documentMode === 9,\n    ie10: ie && document.documentMode === 10,\n    webgl: webgl,\n    imageBitMap: imageBitMap,\n    resizeObserver: resizeObserver,\n    btoa: btoa,\n    decodeImageInWorker: decodeImageInWorker,\n    monitorDPRChange: true,\n    supportsPassive: supportsPassive,\n    removeDPRListening: function removeDPRListening(map) {\n      if (map) {\n        delete maps[map.id];\n      }\n    },\n    checkDevicePixelRatio: function checkDevicePixelRatio() {\n      if (typeof window !== 'undefined' && Browser.monitorDPRChange) {\n        var _devicePixelRatio = getDevicePixelRatio();\n\n        var changed = _devicePixelRatio !== Browser.devicePixelRatio;\n\n        if (changed) {\n          Browser.devicePixelRatio = _devicePixelRatio;\n        }\n\n        return changed;\n      }\n\n      return false;\n    },\n    addDPRListening: function addDPRListening(map) {\n      if (map) {\n        maps[map.id] = map;\n      }\n    }\n  };\n\n  if (typeof window !== 'undefined' && window.matchMedia) {\n    for (var i = 1; i < 500; i++) {\n      var dpi = (i * 0.01).toFixed(2);\n      var screen$1 = window.matchMedia(\"screen and (resolution: \" + dpi + \"dppx)\");\n\n      if (screen$1) {\n        if (screen$1.addEventListener) {\n          screen$1.addEventListener('change', Browser.checkDevicePixelRatio);\n        } else if (screen$1.addListener) {\n          screen$1.addListener(Browser.checkDevicePixelRatio);\n        }\n      }\n    }\n  }\n\n  if (Browser.devicePixelRatio) {\n    var tempDPI = Browser.devicePixelRatio;\n    Object.defineProperty(Browser, 'devicePixelRatio', {\n      get: function get() {\n        return tempDPI;\n      },\n      set: function set(value) {\n        if (value === tempDPI) {\n          return;\n        }\n\n        tempDPI = value;\n\n        if (!Browser.monitorDPRChange) {\n          return;\n        }\n\n        for (var mapId in maps) {\n          var map = maps[mapId];\n\n          if (!map || !map.options || map.options['devicePixelRatio'] || !map.checkSize || !map.getRenderer) {\n            continue;\n          }\n\n          var renderer = map.getRenderer();\n\n          if (renderer) {\n            map.checkSize(true);\n          }\n        }\n      }\n    });\n  }\n}\n\nvar Browser$1 = Browser;\n\nfunction _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nvar Position = function () {\n  function Position(x, y) {\n    if (!isNil(x) && !isNil(y)) {\n      this.x = +x;\n      this.y = +y;\n    } else if (!isNil(x.x) && !isNil(x.y)) {\n      this.x = +x.x;\n      this.y = +x.y;\n    } else if (Array.isArray(x)) {\n      this.x = +x[0];\n      this.y = +x[1];\n    }\n\n    if (this._isNaN()) {\n      throw new Error('Position is NaN');\n    }\n  }\n\n  var _proto = Position.prototype;\n\n  _proto.set = function set(x, y) {\n    this.x = x;\n    this.y = y;\n    return this;\n  };\n\n  _proto.abs = function abs() {\n    return new this.constructor(Math.abs(this.x), Math.abs(this.y));\n  };\n\n  _proto._abs = function _abs() {\n    this.x = Math.abs(this.x);\n    this.y = Math.abs(this.y);\n    return this;\n  };\n\n  _proto._round = function _round() {\n    this.x = Math.round(this.x);\n    this.y = Math.round(this.y);\n    return this;\n  };\n\n  _proto.round = function round() {\n    return new this.constructor(Math.round(this.x), Math.round(this.y));\n  };\n\n  _proto._ceil = function _ceil() {\n    this.x = Math.ceil(this.x);\n    this.y = Math.ceil(this.y);\n    return this;\n  };\n\n  _proto.ceil = function ceil() {\n    return new this.constructor(Math.ceil(this.x), Math.ceil(this.y));\n  };\n\n  _proto.distanceTo = function distanceTo(point) {\n    var x = point.x - this.x,\n        y = point.y - this.y;\n    return Math.sqrt(x * x + y * y);\n  };\n\n  _proto.mag = function mag() {\n    return Math.sqrt(this.x * this.x + this.y * this.y);\n  };\n\n  _proto._floor = function _floor() {\n    this.x = Math.floor(this.x);\n    this.y = Math.floor(this.y);\n    return this;\n  };\n\n  _proto.floor = function floor() {\n    return new this.constructor(Math.floor(this.x), Math.floor(this.y));\n  };\n\n  _proto.copy = function copy() {\n    return new this.constructor(this.x, this.y);\n  };\n\n  _proto._add = function _add(x, y) {\n    if (!isNil(x.x)) {\n      this.x += x.x;\n      this.y += x.y;\n    } else if (!isNil(x[0])) {\n      this.x += x[0];\n      this.y += x[1];\n    } else {\n      this.x += x;\n      this.y += y;\n    }\n\n    return this;\n  };\n\n  _proto.add = function add(x, y) {\n    var nx, ny;\n\n    if (!isNil(x.x)) {\n      nx = this.x + x.x;\n      ny = this.y + x.y;\n    } else if (!isNil(x[0])) {\n      nx = this.x + x[0];\n      ny = this.y + x[1];\n    } else {\n      nx = this.x + x;\n      ny = this.y + y;\n    }\n\n    return new this.constructor(nx, ny);\n  };\n\n  _proto._sub = function _sub(x, y) {\n    if (!isNil(x.x)) {\n      this.x -= x.x;\n      this.y -= x.y;\n    } else if (!isNil(x[0])) {\n      this.x -= x[0];\n      this.y -= x[1];\n    } else {\n      this.x -= x;\n      this.y -= y;\n    }\n\n    return this;\n  };\n\n  _proto._substract = function _substract() {\n    return this._sub.apply(this, arguments);\n  };\n\n  _proto.sub = function sub(x, y) {\n    var nx, ny;\n\n    if (!isNil(x.x)) {\n      nx = this.x - x.x;\n      ny = this.y - x.y;\n    } else if (!isNil(x[0])) {\n      nx = this.x - x[0];\n      ny = this.y - x[1];\n    } else {\n      nx = this.x - x;\n      ny = this.y - y;\n    }\n\n    return new this.constructor(nx, ny);\n  };\n\n  _proto.substract = function substract() {\n    return this.sub.apply(this, arguments);\n  };\n\n  _proto.multi = function multi(ratio) {\n    return new this.constructor(this.x * ratio, this.y * ratio);\n  };\n\n  _proto._multi = function _multi(ratio) {\n    this.x *= ratio;\n    this.y *= ratio;\n    return this;\n  };\n\n  _proto.div = function div(n) {\n    return this.multi(1 / n);\n  };\n\n  _proto._div = function _div(n) {\n    return this._multi(1 / n);\n  };\n\n  _proto.equals = function equals(c) {\n    if (!(c instanceof this.constructor)) {\n      return false;\n    }\n\n    return this.x === c.x && this.y === c.y;\n  };\n\n  _proto._isNaN = function _isNaN() {\n    return isNaN(this.x) || isNaN(this.y);\n  };\n\n  _proto.isZero = function isZero() {\n    return this.x === 0 && this.y === 0;\n  };\n\n  _proto.toArray = function toArray() {\n    return [this.x, this.y];\n  };\n\n  _proto.toFixed = function toFixed(n) {\n    return new this.constructor(this.x.toFixed(n), this.y.toFixed(n));\n  };\n\n  _proto.toJSON = function toJSON() {\n    return {\n      x: this.x,\n      y: this.y\n    };\n  };\n\n  return Position;\n}();\n\nvar Point = function (_Position) {\n  _inheritsLoose(Point, _Position);\n\n  function Point() {\n    return _Position.apply(this, arguments) || this;\n  }\n\n  var _proto = Point.prototype;\n\n  _proto.closeTo = function closeTo(p, delta) {\n    if (!delta) {\n      delta = 0;\n    }\n\n    return this.x >= p.x - delta && this.x <= p.x + delta && this.y >= p.y - delta && this.y <= p.y + delta;\n  };\n\n  _proto.mag = function mag() {\n    return Math.sqrt(this.x * this.x + this.y * this.y);\n  };\n\n  _proto.unit = function unit() {\n    return this.copy()._unit();\n  };\n\n  _proto._unit = function _unit() {\n    this._div(this.mag());\n\n    return this;\n  };\n\n  _proto.perp = function perp() {\n    return this.copy()._perp();\n  };\n\n  _proto._perp = function _perp() {\n    var y = this.y;\n    this.y = this.x;\n    this.x = -y;\n    return this;\n  };\n\n  _proto.angleWith = function angleWith(b) {\n    return this.angleWithSep(b.x, b.y);\n  };\n\n  _proto.angleWithSep = function angleWithSep(x, y) {\n    return Math.atan2(this.x * y - this.y * x, this.x * x + this.y * y);\n  };\n\n  _proto._rotate = function _rotate(angle) {\n    var cos = Math.cos(angle),\n        sin = Math.sin(angle),\n        x = cos * this.x - sin * this.y,\n        y = sin * this.x + cos * this.y;\n    this.x = x;\n    this.y = y;\n    return this;\n  };\n\n  _proto.rotate = function rotate(a) {\n    return this.copy()._rotate(a);\n  };\n\n  return Point;\n}(Position);\n\nvar requestAnimFrame, cancelAnimFrame;\n\n(function () {\n  if (IS_NODE) {\n    requestAnimFrame = function requestAnimFrame(fn) {\n      return setTimeout(fn, 16);\n    };\n\n    cancelAnimFrame = clearTimeout;\n    return;\n  }\n\n  var requestFn, cancelFn;\n  var timeToCall = 1000 / 30;\n\n  function timeoutDefer(fn) {\n    return setTimeout(fn, timeToCall);\n  }\n\n  function getPrefixed(name) {\n    return window['webkit' + name] || window['moz' + name] || window['ms' + name];\n  }\n\n  if (typeof window != 'undefined') {\n    requestFn = window['requestAnimationFrame'] || getPrefixed('RequestAnimationFrame') || timeoutDefer;\n\n    cancelFn = window['cancelAnimationFrame'] || getPrefixed('CancelAnimationFrame') || getPrefixed('CancelRequestAnimationFrame') || function (id) {\n      window.clearTimeout(id);\n    };\n  } else {\n    requestFn = timeoutDefer;\n    cancelFn = clearTimeout;\n  }\n\n  requestAnimFrame = function requestAnimFrame(fn) {\n    return requestFn(fn);\n  };\n\n  cancelAnimFrame = function cancelAnimFrame(id) {\n    if (id) {\n      cancelFn(id);\n    }\n  };\n})();\nfunction isSVG(url) {\n  var prefix = 'data:image/svg+xml';\n\n  if (url.length > 4 && url.slice(-4) === '.svg') {\n    return 1;\n  } else if (url.slice(0, prefix.length) === prefix) {\n    return 2;\n  }\n\n  return 0;\n}\nfunction loadImage(img, imgDesc) {\n  if (IS_NODE && loadImage.node) {\n    loadImage.node(img, imgDesc);\n    return;\n  }\n\n  img.src = imgDesc[0];\n}\nvar uid = 0;\nfunction UID() {\n  return uid++;\n}\nvar GUID = UID;\nfunction parseJSON(str) {\n  if (!str || !isString(str)) {\n    return str;\n  }\n\n  return JSON.parse(str);\n}\nfunction pushIn(dest) {\n  for (var i = 1; i < arguments.length; i++) {\n    var src = arguments[i];\n\n    if (src) {\n      for (var ii = 0, ll = src.length; ii < ll; ii++) {\n        dest.push(src[ii]);\n      }\n    }\n  }\n\n  return dest.length;\n}\nfunction removeFromArray(obj, array) {\n  var i = array.indexOf(obj);\n\n  if (i > -1) {\n    array.splice(i, 1);\n  }\n}\nfunction forEachCoord(arr, fn, context) {\n  if (!Array.isArray(arr)) {\n    return context ? fn.call(context, arr) : fn(arr);\n  }\n\n  var result = [];\n  var p, pp;\n\n  for (var i = 0, len = arr.length; i < len; i++) {\n    p = arr[i];\n\n    if (isNil(p)) {\n      result.push(null);\n      continue;\n    }\n\n    if (Array.isArray(p)) {\n      result.push(forEachCoord(p, fn, context));\n    } else {\n      pp = context ? fn.call(context, p) : fn(p);\n      result.push(pp);\n    }\n  }\n\n  return result;\n}\nfunction getValueOrDefault(v, d) {\n  return v === undefined ? d : v;\n}\nfunction sign(x) {\n  if (Math.sign) {\n    return Math.sign(x);\n  }\n\n  x = +x;\n\n  if (x === 0 || isNaN(x)) {\n    return Number(x);\n  }\n\n  return x > 0 ? 1 : -1;\n}\nfunction log2(x) {\n  if (Math.log2) {\n    return Math.log2(x);\n  }\n\n  var v = Math.log(x) * Math.LOG2E;\n  var rounded = Math.round(v);\n\n  if (Math.abs(rounded - v) < 1E-14) {\n    return rounded;\n  } else {\n    return v;\n  }\n}\nfunction interpolate(a, b, t) {\n  return a * (1 - t) + b * t;\n}\nfunction wrap(n, min, max) {\n  if (n === max || n === min) {\n    return n;\n  }\n\n  var d = max - min;\n  var w = ((n - min) % d + d) % d + min;\n  return w;\n}\nfunction clamp(n, min, max) {\n  return Math.min(max, Math.max(min, n));\n}\nfunction isArrayHasData(obj) {\n  return Array.isArray(obj) && obj.length > 0;\n}\nvar urlPattern = /^([a-z][a-z\\d+\\-.]*:)?\\/\\//i;\nfunction isURL(url) {\n  return urlPattern.test(url);\n}\nvar cssUrlReWithQuote = /^url\\((['\"])(.+)\\1\\)$/i;\nvar cssUrlRe = /^url\\(([^'\"].*[^'\"])\\)$/i;\nfunction isCssUrl(str) {\n  if (!isString(str)) {\n    return 0;\n  }\n\n  if (cssUrlRe.test(str)) {\n    return 1;\n  }\n\n  if (cssUrlReWithQuote.test(str)) {\n    return 2;\n  }\n\n  return 3;\n}\nfunction extractCssUrl(str) {\n  var test = isCssUrl(str);\n  var matches;\n\n  if (test === 3) {\n    return str;\n  } else if (test === 1) {\n    matches = cssUrlRe.exec(str);\n    return matches[1];\n  } else if (test === 2) {\n    matches = cssUrlReWithQuote.exec(str);\n    return matches[2];\n  } else {\n    return str;\n  }\n}\nvar b64chrs = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\nfunction btoa$1(input) {\n  if (Browser$1.btoa) {\n    return window.btoa(input);\n  }\n\n  var str = String(input);\n  var output = '';\n\n  for (var block, charCode, idx = 0, map = b64chrs; str.charAt(idx | 0) || (map = '=', idx % 1); output += map.charAt(63 & block >> 8 - idx % 1 * 8)) {\n    charCode = str.charCodeAt(idx += 3 / 4);\n\n    if (charCode > 0xFF) {\n      throw new Error('\\'btoa\\' failed: The string to be encoded contains characters outside of the Latin1 range.');\n    }\n\n    block = block << 8 | charCode;\n  }\n\n  return output;\n}\nfunction b64toBlob(b64Data, contentType) {\n  var byteCharacters = atob(b64Data);\n  var arraybuffer = new ArrayBuffer(byteCharacters.length);\n  var view = new Uint8Array(arraybuffer);\n\n  for (var i = 0; i < byteCharacters.length; i++) {\n    view[i] = byteCharacters.charCodeAt(i) & 0xff;\n  }\n\n  var blob = new Blob([arraybuffer], {\n    type: contentType\n  });\n  return blob;\n}\nfunction computeDegree(x0, y0, x1, y1) {\n  var dx = x1 - x0;\n  var dy = y1 - y0;\n  return Math.atan2(dy, dx);\n}\nvar emptyImageUrl = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';\nfunction equalMapView(obj1, obj2) {\n  if (!obj1 && !obj2) {\n    return true;\n  } else if (!obj1 || !obj2) {\n    return false;\n  }\n\n  for (var p in obj1) {\n    if (p === 'center') {\n      if (!obj2[p] || !approx(obj1[p][0], obj2[p][0]) || !approx(obj1[p][1], obj2[p][1])) {\n        return false;\n      }\n    } else if (obj1[p] !== obj2[p]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction approx(val, expected, delta) {\n  if (delta == null) {\n    delta = 1e-6;\n  }\n\n  return val >= expected - delta && val <= expected + delta;\n}\n\nfunction flash(interval, count, cb, context) {\n  if (!interval) {\n    interval = 100;\n  }\n\n  if (!count) {\n    count = 4;\n  }\n\n  var me = this;\n  count *= 2;\n\n  if (this._flashTimeout) {\n    clearTimeout(this._flashTimeout);\n  }\n\n  function flashGeo() {\n    if (count === 0) {\n      me.show();\n\n      if (cb) {\n        if (context) {\n          cb.call(context);\n        } else {\n          cb();\n        }\n      }\n\n      return;\n    }\n\n    if (count % 2 === 0) {\n      me.hide();\n    } else {\n      me.show();\n    }\n\n    count--;\n    me._flashTimeout = setTimeout(flashGeo, interval);\n  }\n\n  this._flashTimeout = setTimeout(flashGeo, interval);\n  return this;\n}\nfunction _defaults$1(obj, defaults) {\n  var keys = Object.getOwnPropertyNames(defaults);\n\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    var value = Object.getOwnPropertyDescriptor(defaults, key);\n\n    if (value && value.configurable && obj[key] === undefined) {\n      Object.defineProperty(obj, key, value);\n    }\n  }\n\n  return obj;\n}\nfunction getPointsResultPts(points, ptKey) {\n  if (points === void 0) {\n    points = [];\n  }\n\n  if (ptKey === void 0) {\n    ptKey = '_pt';\n  }\n\n  var resultPoints = [];\n\n  for (var i = 0, len = points.length; i < len; i++) {\n    var point = points[i];\n\n    if (!point) {\n      resultPoints.push(null);\n      continue;\n    }\n\n    if (!point[ptKey]) {\n      point[ptKey] = new Point(0, 0);\n    }\n\n    var pt = point[ptKey];\n    pt.x = 0;\n    pt.y = 0;\n    resultPoints.push(pt);\n  }\n\n  return resultPoints;\n}\nvar BITMAP_CTX;\n\nif (Browser$1.decodeImageInWorker) {\n  var canvas = document.createElement('canvas');\n  canvas.width = 1;\n  canvas.height = 1;\n  BITMAP_CTX = canvas.getContext('2d');\n}\n\nfunction getImageBitMap(data, cb) {\n  var imageData = BITMAP_CTX.createImageData(data.width, data.height);\n  imageData.data.set(data.data);\n  createImageBitmap(imageData).then(function (bitmap) {\n    cb(bitmap);\n  });\n}\nfunction getAbsoluteURL(url) {\n  if (url && url.indexOf('http://') === 0 || url.indexOf('https://') === 0) {\n    return url;\n  }\n\n  var a = document.createElement('a');\n  a.href = url;\n  url = a.href;\n  a = null;\n  return url;\n}\nvar CANVAS_SIZE_TEMP = {\n  cssWidth: '1px',\n  cssHeight: '1px',\n  width: 1,\n  height: 1\n};\nfunction calCanvasSize(size, devicePixelRatio) {\n  if (devicePixelRatio === void 0) {\n    devicePixelRatio = 1;\n  }\n\n  var width = size.width,\n      height = size.height;\n  CANVAS_SIZE_TEMP.cssWidth = width + 'px';\n  CANVAS_SIZE_TEMP.cssHeight = height + 'px';\n  CANVAS_SIZE_TEMP.width = Math.round(width * devicePixelRatio);\n  CANVAS_SIZE_TEMP.height = Math.round(height * devicePixelRatio);\n  return CANVAS_SIZE_TEMP;\n}\n\nfunction createFunction(parameters, defaultType) {\n  var fun;\n  var isFeatureConstant, isZoomConstant;\n\n  if (!isFunctionDefinition(parameters)) {\n    fun = function fun() {\n      return parameters;\n    };\n\n    isFeatureConstant = true;\n    isZoomConstant = true;\n  } else {\n    var zoomAndFeatureDependent = parameters.stops && typeof parameters.stops[0][0] === 'object';\n    var featureDependent = zoomAndFeatureDependent || parameters.property !== undefined;\n    var zoomDependent = zoomAndFeatureDependent || !featureDependent;\n    var type = parameters.type || defaultType || 'exponential';\n    var innerFun;\n\n    if (type === 'exponential') {\n      innerFun = evaluateExponentialFunction;\n    } else if (type === 'interval') {\n      innerFun = evaluateIntervalFunction;\n    } else if (type === 'categorical') {\n      innerFun = evaluateCategoricalFunction;\n    } else if (type === 'identity') {\n      innerFun = evaluateIdentityFunction;\n    } else {\n      throw new Error('Unknown function type \"' + type + '\"');\n    }\n\n    if (zoomAndFeatureDependent) {\n      var featureFunctions = {};\n      var featureFunctionStops = [];\n\n      for (var s = 0; s < parameters.stops.length; s++) {\n        var stop = parameters.stops[s];\n\n        if (featureFunctions[stop[0].zoom] === undefined) {\n          featureFunctions[stop[0].zoom] = {\n            zoom: stop[0].zoom,\n            type: parameters.type,\n            property: parameters.property,\n            default: parameters.default,\n            stops: []\n          };\n        }\n\n        featureFunctions[stop[0].zoom].stops.push([stop[0].value, stop[1]]);\n      }\n\n      for (var z in featureFunctions) {\n        featureFunctionStops.push([featureFunctions[z].zoom, createFunction(featureFunctions[z])]);\n      }\n\n      fun = function fun(zoom, feature) {\n        var value = evaluateExponentialFunction({\n          stops: featureFunctionStops,\n          base: parameters.base\n        }, zoom)(zoom, feature);\n        return typeof value === 'function' ? value(zoom, feature) : value;\n      };\n\n      isFeatureConstant = false;\n      isZoomConstant = false;\n    } else if (zoomDependent) {\n      fun = function fun(zoom) {\n        var value = innerFun(parameters, zoom);\n        return typeof value === 'function' ? value(zoom) : value;\n      };\n\n      isFeatureConstant = true;\n      isZoomConstant = false;\n    } else {\n      fun = function fun(zoom, feature) {\n        var value = innerFun(parameters, feature ? feature[parameters.property] : null);\n        return typeof value === 'function' ? value(zoom, feature) : value;\n      };\n\n      isFeatureConstant = false;\n      isZoomConstant = true;\n    }\n  }\n\n  fun.isZoomConstant = isZoomConstant;\n  fun.isFeatureConstant = isFeatureConstant;\n  return fun;\n}\n\nfunction coalesce(a, b, c) {\n  if (a !== undefined) return a;\n  if (b !== undefined) return b;\n  if (c !== undefined) return c;\n  return null;\n}\n\nfunction evaluateCategoricalFunction(parameters, input) {\n  for (var i = 0; i < parameters.stops.length; i++) {\n    if (input === parameters.stops[i][0]) {\n      return parameters.stops[i][1];\n    }\n  }\n\n  return parameters.default;\n}\n\nfunction evaluateIntervalFunction(parameters, input) {\n  for (var i = 0; i < parameters.stops.length; i++) {\n    if (input < parameters.stops[i][0]) break;\n  }\n\n  return parameters.stops[Math.max(i - 1, 0)][1];\n}\n\nfunction evaluateExponentialFunction(parameters, input) {\n  var base = parameters.base !== undefined ? parameters.base : 1;\n  var i = 0;\n\n  while (true) {\n    if (i >= parameters.stops.length) break;else if (input <= parameters.stops[i][0]) break;else i++;\n  }\n\n  if (i === 0) {\n    return parameters.stops[i][1];\n  } else if (i === parameters.stops.length) {\n    return parameters.stops[i - 1][1];\n  } else {\n    return interpolate$1(input, base, parameters.stops[i - 1][0], parameters.stops[i][0], parameters.stops[i - 1][1], parameters.stops[i][1]);\n  }\n}\n\nfunction evaluateIdentityFunction(parameters, input) {\n  return coalesce(input, parameters.default);\n}\n\nfunction interpolate$1(input, base, inputLower, inputUpper, outputLower, outputUpper) {\n  if (typeof outputLower === 'function') {\n    return function () {\n      var evaluatedLower = outputLower.apply(undefined, arguments);\n      var evaluatedUpper = outputUpper.apply(undefined, arguments);\n      return interpolate$1(input, base, inputLower, inputUpper, evaluatedLower, evaluatedUpper);\n    };\n  } else if (outputLower.length) {\n    return interpolateArray(input, base, inputLower, inputUpper, outputLower, outputUpper);\n  } else {\n    return interpolateNumber(input, base, inputLower, inputUpper, outputLower, outputUpper);\n  }\n}\n\nfunction interpolateNumber(input, base, inputLower, inputUpper, outputLower, outputUpper) {\n  var difference = inputUpper - inputLower;\n  var progress = input - inputLower;\n  var ratio;\n\n  if (base === 1) {\n    ratio = progress / difference;\n  } else {\n    ratio = (Math.pow(base, progress) - 1) / (Math.pow(base, difference) - 1);\n  }\n\n  return outputLower * (1 - ratio) + outputUpper * ratio;\n}\n\nfunction interpolateArray(input, base, inputLower, inputUpper, outputLower, outputUpper) {\n  var output = [];\n\n  for (var i = 0; i < outputLower.length; i++) {\n    output[i] = interpolateNumber(input, base, inputLower, inputUpper, outputLower[i], outputUpper[i]);\n  }\n\n  return output;\n}\n\nfunction isFunctionDefinition(obj) {\n  return obj && typeof obj === 'object' && (obj.stops || obj.property && obj.type === 'identity');\n}\nfunction hasFunctionDefinition(obj) {\n  for (var p in obj) {\n    if (isFunctionDefinition(obj[p])) {\n      return true;\n    }\n  }\n\n  return false;\n}\nfunction interpolated(parameters) {\n  return createFunction1(parameters, 'exponential');\n}\nfunction piecewiseConstant(parameters) {\n  return createFunction1(parameters, 'interval');\n}\nfunction loadFunctionTypes(obj, argFn) {\n  if (!obj) {\n    return null;\n  }\n\n  var hit = false;\n\n  if (Array.isArray(obj)) {\n    var multResult = [],\n        loaded;\n\n    for (var i = 0; i < obj.length; i++) {\n      loaded = loadFunctionTypes(obj[i], argFn);\n\n      if (!loaded) {\n        multResult.push(obj[i]);\n      } else {\n        multResult.push(loaded);\n        hit = true;\n      }\n    }\n\n    return hit ? multResult : obj;\n  }\n\n  var result = {\n    '__fn_types_loaded': true\n  },\n      props = [],\n      p;\n\n  for (p in obj) {\n    if (obj.hasOwnProperty(p)) {\n      props.push(p);\n    }\n  }\n\n  var buildFn = function buildFn(p) {\n    Object.defineProperty(result, p, {\n      get: function get() {\n        if (!this['__fn_' + p]) {\n          this['__fn_' + p] = interpolated(this['_' + p]);\n        }\n\n        return this['__fn_' + p].apply(this, argFn());\n      },\n      set: function set(v) {\n        this['_' + p] = v;\n      },\n      configurable: true,\n      enumerable: true\n    });\n  };\n\n  for (var _i = 0, len = props.length; _i < len; _i++) {\n    p = props[_i];\n\n    if (isFunctionDefinition(obj[p])) {\n      hit = true;\n      result['_' + p] = obj[p];\n      buildFn(p);\n    } else {\n      result[p] = obj[p];\n    }\n  }\n\n  return hit ? result : obj;\n}\nfunction getFunctionTypeResources(t) {\n  if (!t || !t.stops) {\n    return [];\n  }\n\n  var res = [];\n\n  for (var i = 0, l = t.stops.length; i < l; i++) {\n    res.push(t.stops[i][1]);\n  }\n\n  return res;\n}\n\nfunction createFunction1(parameters, defaultType) {\n  if (!isFunctionDefinition(parameters)) {\n    return function () {\n      return parameters;\n    };\n  }\n\n  parameters = JSON.parse(JSON.stringify(parameters));\n  var isZoomConstant = true;\n  var isFeatureConstant = true;\n  var stops = parameters.stops;\n\n  if (stops) {\n    for (var i = 0; i < stops.length; i++) {\n      if (isFunctionDefinition(stops[i][1])) {\n        var _fn = createFunction1(stops[i][1], defaultType);\n\n        isZoomConstant = isZoomConstant && _fn.isZoomConstant;\n        isFeatureConstant = isFeatureConstant && _fn.isFeatureConstant;\n        stops[i] = [stops[i][0], _fn];\n      }\n    }\n  }\n\n  var fn = createFunction(parameters, defaultType);\n  fn.isZoomConstant = isZoomConstant && fn.isZoomConstant;\n  fn.isFeatureConstant = isFeatureConstant && fn.isFeatureConstant;\n  return fn;\n}\n\nvar types = ['Unknown', 'Point', 'LineString', 'Polygon', 'MultiPoint', 'MultiLineString', 'MultiPolygon', 'GeometryCollection'];\nfunction createFilter(filter) {\n  return new Function('f', \"var p = (f && f.properties || {}); return \" + compile(filter));\n}\n\nfunction compile(filter) {\n  if (!filter) return 'true';\n  var op = filter[0];\n  if (filter.length <= 1) return op === 'any' ? 'false' : 'true';\n  var str = op === '==' ? compileComparisonOp(filter[1], filter[2], '===', false) : op === '!=' ? compileComparisonOp(filter[1], filter[2], '!==', false) : op === '<' || op === '>' || op === '<=' || op === '>=' ? compileComparisonOp(filter[1], filter[2], op, true) : op === 'any' ? compileLogicalOp(filter.slice(1), '||') : op === 'all' ? compileLogicalOp(filter.slice(1), '&&') : op === 'none' ? compileNegation(compileLogicalOp(filter.slice(1), '||')) : op === 'in' ? compileInOp(filter[1], filter.slice(2)) : op === '!in' ? compileNegation(compileInOp(filter[1], filter.slice(2))) : op === 'has' ? compileHasOp(filter[1]) : op === '!has' ? compileNegation(compileHasOp(filter[1])) : 'true';\n  return \"(\" + str + \")\";\n}\n\nfunction compilePropertyReference(property) {\n  return property[0] === '$' ? 'f.' + property.substring(1) : 'p[' + JSON.stringify(property) + ']';\n}\n\nfunction compileComparisonOp(property, value, op, checkType) {\n  var left = compilePropertyReference(property);\n  var right = property === '$type' ? types.indexOf(value) : JSON.stringify(value);\n  return (checkType ? \"typeof \" + left + \"=== typeof \" + right + \"&&\" : '') + left + op + right;\n}\n\nfunction compileLogicalOp(expressions, op) {\n  return expressions.map(compile).join(op);\n}\n\nfunction compileInOp(property, values) {\n  if (property === '$type') values = values.map(function (value) {\n    return types.indexOf(value);\n  });\n  var left = JSON.stringify(values.sort(compare));\n  var right = compilePropertyReference(property);\n  if (values.length <= 200) return left + \".indexOf(\" + right + \") !== -1\";\n  return \"function(v, a, i, j) {\\n        while (i <= j) { var m = (i + j) >> 1;\\n            if (a[m] === v) return true; if (a[m] > v) j = m - 1; else i = m + 1;\\n        }\\n    return false; }(\" + right + \", \" + left + \",0,\" + (values.length - 1) + \")\";\n}\n\nfunction compileHasOp(property) {\n  return property === '$id' ? '\"id\" in f' : JSON.stringify(property) + \" in p\";\n}\n\nfunction compileNegation(expression) {\n  return \"!(\" + expression + \")\";\n}\n\nfunction compare(a, b) {\n  return a < b ? -1 : a > b ? 1 : 0;\n}\n\nfunction getFilterFeature(geometry) {\n  var json = geometry._toJSON(),\n      g = json['feature'];\n\n  g['type'] = types.indexOf(g['geometry']['type']);\n  g['subType'] = json['subType'];\n  return g;\n}\nfunction compileStyle(styles) {\n  if (!Array.isArray(styles)) {\n    return compileStyle([styles]);\n  }\n\n  var compiled = [];\n\n  for (var i = 0; i < styles.length; i++) {\n    var filter = void 0;\n\n    if (styles[i]['filter'] === true) {\n      filter = function filter() {\n        return true;\n      };\n    } else {\n      filter = createFilter(styles[i]['filter']);\n    }\n\n    compiled.push(extend$1({}, styles[i], {\n      filter: filter\n    }));\n  }\n\n  return compiled;\n}\n\nfunction extend$1(dest) {\n  for (var i = 1; i < arguments.length; i++) {\n    var src = arguments[i];\n\n    for (var k in src) {\n      dest[k] = src[k];\n    }\n  }\n\n  return dest;\n}\n\nvar arr = [],\n    prop = {};\nfunction loadGeoSymbol(symbol, geo) {\n  return loadFunctionTypes(symbol, function () {\n    var map = geo.getMap();\n    return set$1(arr, map ? map.getZoom() : 12, extend({}, geo.getProperties(), setProp(prop, map && map.getBearing() || 0, map && map.getPitch() || 0, map ? map.getZoom() : 10)));\n  });\n}\n\nfunction set$1(arr, a0, a1) {\n  arr[0] = a0;\n  arr[1] = a1;\n  return arr;\n}\n\nfunction setProp(prop, b, p, z) {\n  prop['{bearing}'] = b;\n  prop['{pitch}'] = p;\n  prop['{zoom}'] = z;\n  return prop;\n}\n\nvar index = /*#__PURE__*/Object.freeze({\n  loadGeoSymbol: loadGeoSymbol,\n  createFilter: createFilter,\n  getFilterFeature: getFilterFeature,\n  compileStyle: compileStyle,\n  isFunctionDefinition: isFunctionDefinition,\n  hasFunctionDefinition: hasFunctionDefinition,\n  interpolated: interpolated,\n  piecewiseConstant: piecewiseConstant,\n  loadFunctionTypes: loadFunctionTypes,\n  getFunctionTypeResources: getFunctionTypeResources\n});\n\nfunction translateToSVGStyles(s) {\n  var result = {\n    'stroke': {\n      'stroke': s['markerLineColor'],\n      'stroke-width': s['markerLineWidth'],\n      'stroke-opacity': s['markerLineOpacity'],\n      'stroke-dasharray': null,\n      'stroke-linecap': 'butt',\n      'stroke-linejoin': 'round'\n    },\n    'fill': {\n      'fill': s['markerFill'],\n      'fill-opacity': s['markerFillOpacity']\n    }\n  };\n\n  if (result['stroke']['stroke-width'] === 0) {\n    result['stroke']['stroke-opacity'] = 0;\n  }\n\n  return result;\n}\nfunction getMarkerPathBase64(symbol, width, height) {\n  if (!symbol['markerPath']) {\n    return null;\n  }\n\n  var op = 1;\n  var styles = translateToSVGStyles(symbol);\n\n  if (isNumber(symbol['markerOpacity'])) {\n    op = symbol['markerOpacity'];\n  }\n\n  if (isNumber(symbol['opacity'])) {\n    op *= symbol['opacity'];\n  }\n\n  var svgStyles = {};\n\n  if (styles) {\n    for (var p in styles['stroke']) {\n      if (styles['stroke'].hasOwnProperty(p)) {\n        if (!isNil(styles['stroke'][p])) {\n          svgStyles[p] = styles['stroke'][p];\n        }\n      }\n    }\n\n    for (var _p in styles['fill']) {\n      if (styles['fill'].hasOwnProperty(_p)) {\n        if (!isNil(styles['fill'][_p])) {\n          svgStyles[_p] = styles['fill'][_p];\n        }\n      }\n    }\n  }\n\n  var pathes = Array.isArray(symbol['markerPath']) ? symbol['markerPath'] : [symbol['markerPath']];\n  var path;\n  var pathesToRender = [];\n\n  for (var i = 0; i < pathes.length; i++) {\n    path = isString(pathes[i]) ? {\n      'path': pathes[i]\n    } : pathes[i];\n    path = extend({}, path, svgStyles);\n    path['d'] = path['path'];\n    delete path['path'];\n    pathesToRender.push(path);\n  }\n\n  var svg = ['<svg version=\"1.1\"', 'xmlns=\"http://www.w3.org/2000/svg\"'];\n\n  if (op < 1) {\n    svg.push('opacity=\"' + op + '\"');\n  }\n\n  if (symbol['markerPathWidth'] && symbol['markerPathHeight']) {\n    svg.push('viewBox=\"0 0 ' + symbol['markerPathWidth'] + ' ' + symbol['markerPathHeight'] + '\"');\n  }\n\n  svg.push('preserveAspectRatio=\"none\"');\n\n  if (width) {\n    svg.push('width=\"' + width + '\"');\n  }\n\n  if (height) {\n    svg.push('height=\"' + height + '\"');\n  }\n\n  svg.push('><defs></defs>');\n\n  for (var _i = 0; _i < pathesToRender.length; _i++) {\n    var strPath = '<path ';\n\n    for (var _p2 in pathesToRender[_i]) {\n      if (pathesToRender[_i].hasOwnProperty(_p2)) {\n        strPath += ' ' + _p2 + '=\"' + pathesToRender[_i][_p2] + '\"';\n      }\n    }\n\n    strPath += '></path>';\n    svg.push(strPath);\n  }\n\n  svg.push('</svg>');\n  var b64 = 'data:image/svg+xml;base64,' + btoa$1(svg.join(' '));\n  return b64;\n}\nfunction getExternalResources(symbol, toAbsolute) {\n  if (!symbol) {\n    return [];\n  }\n\n  var symbols = symbol;\n\n  if (!Array.isArray(symbol)) {\n    symbols = [symbol];\n  }\n\n  var resources = [];\n  var props = RESOURCE_PROPERTIES;\n  var res, resSizeProp;\n  var w, h;\n\n  for (var i = symbols.length - 1; i >= 0; i--) {\n    symbol = symbols[i];\n\n    if (!symbol) {\n      continue;\n    }\n\n    if (toAbsolute) {\n      symbol = convertResourceUrl(symbol);\n    }\n\n    for (var ii = 0; ii < props.length; ii++) {\n      res = symbol[props[ii]];\n\n      if (isFunctionDefinition(res)) {\n        res = getFunctionTypeResources(res);\n      }\n\n      if (!res) {\n        continue;\n      }\n\n      if (!Array.isArray(res)) {\n        res = [res];\n      }\n\n      for (var iii = 0; iii < res.length; iii++) {\n        if (res[iii].slice(0, 4) === 'url(') {\n          res[iii] = extractCssUrl(res[iii]);\n        }\n\n        resSizeProp = RESOURCE_SIZE_PROPERTIES[ii];\n        resources.push([res[iii], symbol[resSizeProp[0]], symbol[resSizeProp[1]]]);\n      }\n    }\n\n    if (symbol['markerType'] === 'path' && symbol['markerPath']) {\n      w = isFunctionDefinition(symbol['markerWidth']) ? 200 : symbol['markerWidth'];\n      h = isFunctionDefinition(symbol['markerHeight']) ? 200 : symbol['markerHeight'];\n\n      if (isFunctionDefinition(symbol['markerPath'])) {\n        res = getFunctionTypeResources(symbol['markerPath']);\n        var path = symbol['markerPath'];\n\n        for (var _iii = 0; _iii < res.length; _iii++) {\n          symbol['markerPath'] = res[_iii];\n          resources.push([getMarkerPathBase64(symbol), w, h]);\n        }\n\n        symbol['markerPath'] = path;\n      } else {\n        resources.push([getMarkerPathBase64(symbol), w, h]);\n      }\n    }\n  }\n\n  return resources;\n}\nfunction convertResourceUrl(symbol) {\n  if (!symbol) {\n    return null;\n  }\n\n  var s = symbol;\n\n  if (IS_NODE) {\n    return s;\n  }\n\n  var props = RESOURCE_PROPERTIES;\n  var res;\n\n  for (var ii = 0, len = props.length; ii < len; ii++) {\n    res = s[props[ii]];\n\n    if (!res) {\n      continue;\n    }\n\n    s[props[ii]] = _convertUrl(res);\n  }\n\n  return s;\n}\n\nfunction _convertUrl(res) {\n  if (isFunctionDefinition(res)) {\n    var stops = res.stops;\n\n    for (var i = 0; i < stops.length; i++) {\n      stops[i][1] = _convertUrl(stops[i][1]);\n    }\n\n    return res;\n  }\n\n  if (res.slice(0, 4) === 'url(') {\n    res = extractCssUrl(res);\n  }\n\n  return res;\n}\n\nvar Size = function () {\n  function Size(width, height) {\n    if (isNumber(width) && isNumber(height)) {\n      this.width = width;\n      this.height = height;\n    } else if (isNumber(width['width'])) {\n      this.width = width.width;\n      this.height = width.height;\n    } else if (Array.isArray(width)) {\n      this.width = width[0];\n      this.height = width[1];\n    }\n  }\n\n  var _proto = Size.prototype;\n\n  _proto.copy = function copy() {\n    return new Size(this['width'], this['height']);\n  };\n\n  _proto.add = function add(x, y) {\n    var w, h;\n\n    if (x instanceof Size) {\n      w = this.width + x.width;\n      h = this.height + x.height;\n    } else {\n      w = this.width + x;\n      h = this.height + y;\n    }\n\n    return new Size(w, h);\n  };\n\n  _proto.equals = function equals(size) {\n    return this['width'] === size['width'] && this['height'] === size['height'];\n  };\n\n  _proto.multi = function multi(ratio) {\n    return new Size(this['width'] * ratio, this['height'] * ratio);\n  };\n\n  _proto._multi = function _multi(ratio) {\n    this['width'] *= ratio;\n    this['height'] *= ratio;\n    return this;\n  };\n\n  _proto._round = function _round() {\n    this['width'] = Math.round(this['width']);\n    this['height'] = Math.round(this['height']);\n    return this;\n  };\n\n  _proto.toPoint = function toPoint() {\n    return new Point(this['width'], this['height']);\n  };\n\n  _proto.toArray = function toArray() {\n    return [this['width'], this['height']];\n  };\n\n  _proto.toJSON = function toJSON() {\n    return {\n      'width': this['width'],\n      'height': this['height']\n    };\n  };\n\n  return Size;\n}();\n\nfunction trim(str) {\n  return str.trim ? str.trim() : str.replace(/^\\s+|\\s+$/g, '');\n}\nvar specialPattern = /[\\b\\t\\r\\v\\f]/igm;\nfunction escapeSpecialChars(str) {\n  if (!isString(str)) {\n    return str;\n  }\n\n  return str.replace(specialPattern, '');\n}\nfunction splitWords(chr) {\n  return trim(chr).split(/\\s+/);\n}\nvar rulerCtx = typeof document !== 'undefined' ? document.createElement('canvas').getContext('2d') : null;\nfunction stringWidth(text, font) {\n  if (stringWidth.node) {\n    return stringWidth.node(text, font);\n  }\n\n  rulerCtx.font = font;\n  return rulerCtx.measureText(text).width;\n}\nfunction stringLength(text, font, size) {\n  var w = stringWidth(text, font);\n  return new Size(w, size || DEFAULT_TEXT_SIZE);\n}\nfunction splitContent(content, font, wrapWidth, textWidth) {\n  if (!content || content.length === 0) {\n    return [{\n      'text': '',\n      'width': 0\n    }];\n  }\n\n  var width = isNil(textWidth) ? stringWidth(content, font) : textWidth;\n  var chrWidth = width / content.length,\n      minChrCount = Math.floor(wrapWidth / chrWidth / 2);\n\n  if (chrWidth >= wrapWidth || minChrCount <= 0) {\n    return [{\n      'text': '',\n      'width': wrapWidth\n    }];\n  }\n\n  if (width <= wrapWidth) return [{\n    'text': content,\n    'width': width\n  }];\n  var result = [];\n  var testStr = content.substring(0, minChrCount),\n      prew = chrWidth * minChrCount;\n\n  for (var i = minChrCount, l = content.length; i < l; i++) {\n    var chr = content[i];\n    var w = stringWidth(testStr + chr);\n\n    if (w >= wrapWidth) {\n      result.push({\n        'text': testStr,\n        'width': prew\n      });\n      testStr = content.substring(i, minChrCount + i);\n      i += minChrCount - 1;\n      prew = chrWidth * minChrCount;\n    } else {\n      testStr += chr;\n      prew = w;\n    }\n\n    if (i >= l - 1) {\n      prew = stringWidth(testStr);\n      result.push({\n        'text': testStr,\n        'width': prew\n      });\n    }\n  }\n\n  return result;\n}\nvar contentExpRe = /\\{([\\w_]+)\\}/g;\nfunction replaceVariable(str, props) {\n  if (!isString(str)) {\n    return str;\n  }\n\n  return str.replace(contentExpRe, function (str, key) {\n    if (!props) {\n      return '';\n    }\n\n    var value = props[key];\n\n    if (isNil(value)) {\n      return '';\n    } else if (Array.isArray(value)) {\n      return value.join();\n    }\n\n    return value;\n  });\n}\nfunction describeText(textContent, symbol) {\n  if (isNumber(textContent)) {\n    textContent += '';\n  }\n\n  textContent = textContent || '';\n  var maxHeight = symbol['textMaxHeight'] || 0;\n  var textDesc = splitTextToRow(textContent, symbol);\n\n  if (maxHeight && maxHeight < textDesc.size.height) {\n    textDesc.size.height = maxHeight;\n  }\n\n  return textDesc;\n}\nfunction getAlignPoint(size, horizontalAlignment, verticalAlignment) {\n  var width = size['width'],\n      height = size['height'];\n  var alignW, alignH;\n\n  if (horizontalAlignment === 'left') {\n    alignW = -width;\n  } else if (horizontalAlignment === 'right') {\n    alignW = 0;\n  } else {\n    alignW = -width / 2;\n  }\n\n  if (verticalAlignment === 'top') {\n    alignH = -height;\n  } else if (verticalAlignment === 'bottom') {\n    alignH = 0;\n  } else {\n    alignH = -height / 2;\n  }\n\n  return new Point(alignW, alignH);\n}\nvar DEFAULT_FONT = 'monospace';\nfunction getFont(style) {\n  if (style['textFont']) {\n    return style['textFont'];\n  } else {\n    return (style['textStyle'] && style['textStyle'] !== 'normal' ? style['textStyle'] + ' ' : '') + (style['textWeight'] && style['textWeight'] !== 'normal' ? style['textWeight'] + ' ' : '') + style['textSize'] + 'px ' + (!style['textFaceName'] ? DEFAULT_FONT : style['textFaceName'][0] === '\"' ? style['textFaceName'] : '\"' + style['textFaceName'] + '\"');\n  }\n}\nfunction splitTextToRow(text, style) {\n  var font = getFont(style),\n      lineSpacing = style['textLineSpacing'] || 0,\n      size = stringLength(text, font, style['textSize']),\n      textWidth = size['width'],\n      textHeight = size['height'],\n      wrapChar = style['textWrapCharacter'],\n      textRows = [];\n  var wrapWidth = style['textWrapWidth'];\n\n  if (!wrapWidth || wrapWidth > textWidth) {\n    wrapWidth = textWidth;\n  }\n\n  if (!isString(text)) {\n    text += '';\n  }\n\n  var actualWidth = 0;\n\n  if (wrapChar && text.indexOf(wrapChar) >= 0) {\n    var texts = text.split(wrapChar);\n\n    for (var i = 0, l = texts.length; i < l; i++) {\n      var t = texts[i];\n      var tWidth = stringWidth(t, font);\n\n      if (tWidth > wrapWidth) {\n        var contents = splitContent(t, font, wrapWidth, tWidth);\n\n        for (var ii = 0, ll = contents.length; ii < ll; ii++) {\n          var w = contents[ii].width;\n\n          if (w > actualWidth) {\n            actualWidth = w;\n          }\n\n          textRows.push({\n            'text': contents[ii].text,\n            'size': new Size(w, textHeight)\n          });\n        }\n      } else {\n        if (tWidth > actualWidth) {\n          actualWidth = tWidth;\n        }\n\n        textRows.push({\n          'text': t,\n          'size': new Size(tWidth, textHeight)\n        });\n      }\n    }\n  } else if (textWidth > wrapWidth) {\n    var _contents = splitContent(text, font, wrapWidth, textWidth);\n\n    for (var _i = 0; _i < _contents.length; _i++) {\n      var _w = _contents[_i].width;\n\n      if (_w > actualWidth) {\n        actualWidth = _w;\n      }\n\n      textRows.push({\n        'text': _contents[_i].text,\n        'size': new Size(_w, textHeight)\n      });\n    }\n  } else {\n    if (textWidth > actualWidth) {\n      actualWidth = textWidth;\n    }\n\n    textRows.push({\n      'text': text,\n      'size': size\n    });\n  }\n\n  var rowNum = textRows.length;\n  var textSize = new Size(actualWidth, textHeight * rowNum + lineSpacing * (rowNum - 1));\n  return {\n    'total': rowNum,\n    'size': textSize,\n    'rows': textRows,\n    'rawSize': size\n  };\n}\nfunction hashCode(s) {\n  var hash = 0;\n  var strlen = s && s.length || 0;\n\n  if (!strlen) {\n    return hash;\n  }\n\n  var c;\n\n  for (var i = 0; i < strlen; i++) {\n    c = s.charCodeAt(i);\n    hash = (hash << 5) - hash + c;\n    hash = hash & hash;\n  }\n\n  return hash;\n}\n\nvar strings = /*#__PURE__*/Object.freeze({\n  trim: trim,\n  escapeSpecialChars: escapeSpecialChars,\n  splitWords: splitWords,\n  stringWidth: stringWidth,\n  stringLength: stringLength,\n  splitContent: splitContent,\n  replaceVariable: replaceVariable,\n  describeText: describeText,\n  getAlignPoint: getAlignPoint,\n  getFont: getFont,\n  splitTextToRow: splitTextToRow,\n  hashCode: hashCode\n});\n\nfunction isGradient(g) {\n  return g && g['colorStops'];\n}\nfunction getGradientStamp(g) {\n  var keys = [g['type']];\n\n  if (g['places']) {\n    keys.push(g['places'].join());\n  }\n\n  if (g['colorStops']) {\n    var stops = [];\n\n    for (var i = g['colorStops'].length - 1; i >= 0; i--) {\n      stops.push(g['colorStops'][i].join());\n    }\n\n    keys.push(stops.join(','));\n  }\n\n  return keys.join('_');\n}\nfunction getSymbolStamp(symbol, prefix) {\n  return getSymbolHash(symbol, prefix);\n}\nfunction getSymbolHash(symbol, prefix) {\n  if (!symbol) {\n    return 1;\n  }\n\n  var keys = [];\n\n  if (Array.isArray(symbol)) {\n    for (var i = 0; i < symbol.length; i++) {\n      keys.push(getSymbolHash(symbol[i], prefix));\n    }\n\n    return keys.sort().join(',');\n  }\n\n  var sortedKeys = Object.keys(symbol).sort();\n  var sortedSymbol = sortedKeys.reduce(function (accumulator, curValue) {\n    if (!prefix || curValue.indexOf(prefix) === 0) {\n      accumulator[curValue] = symbol[curValue];\n    }\n\n    return accumulator;\n  }, {});\n  var hash = hashCode(JSON.stringify(sortedSymbol));\n  return hash;\n}\nfunction lowerSymbolOpacity(symbol, ratio) {\n  function s(_symbol, _ratio) {\n    var op = _symbol['opacity'];\n\n    if (isNil(op)) {\n      _symbol['opacity'] = _ratio;\n    } else {\n      _symbol['opacity'] *= _ratio;\n    }\n  }\n\n  var lower;\n\n  if (Array.isArray(symbol)) {\n    lower = [];\n\n    for (var i = 0; i < symbol.length; i++) {\n      var d = extend({}, symbol[i]);\n      s(d, ratio);\n      lower.push(d);\n    }\n  } else {\n    lower = extend({}, symbol);\n    s(lower, ratio);\n  }\n\n  return lower;\n}\nfunction extendSymbol(symbol) {\n  var sources = Array.prototype.slice.call(arguments, 1);\n\n  if (!sources || !sources.length) {\n    sources = [{}];\n  }\n\n  if (Array.isArray(symbol)) {\n    var s, dest;\n    var result = [];\n\n    for (var i = 0, l = symbol.length; i < l; i++) {\n      s = symbol[i];\n      dest = {};\n\n      for (var ii = 0, ll = sources.length; ii < ll; ii++) {\n        if (!Array.isArray(sources[ii])) {\n          extend(dest, s, sources[ii] ? sources[ii] : {});\n        } else if (!isNil(sources[ii][i])) {\n          extend(dest, s, sources[ii][i]);\n        } else {\n          extend(dest, s ? s : {});\n        }\n      }\n\n      result.push(dest);\n    }\n\n    return result;\n  } else {\n    var args = [{}, symbol];\n    args.push.apply(args, sources);\n    return extend.apply(this, args);\n  }\n}\nfunction parseStyleRootPath(style) {\n  if (style.symbol) {\n    style = [style];\n  }\n\n  if (Array.isArray(style)) {\n    return style;\n  }\n\n  var root = style['$root'];\n  var iconset = style['$iconset'];\n  style = style.style;\n\n  if (root || iconset) {\n    if (root && root[root.length - 1] === '/') {\n      root = root.substring(0, root.length - 1);\n    }\n\n    if (iconset && iconset[iconset.length - 1] === '/') {\n      iconset = iconset.substring(0, iconset.length - 1);\n    }\n\n    var replacer = function replacer(match) {\n      if (match === '{$root}') {\n        return root;\n      } else if (match === '{$iconset}') {\n        return iconset;\n      }\n\n      return null;\n    };\n\n    convertStylePath(style, replacer);\n  }\n\n  return style;\n}\nfunction convertStylePath(styles, replacer) {\n  for (var i = 0; i < styles.length; i++) {\n    var symbol = styles[i].symbol;\n\n    if (symbol) {\n      parseSymbolPath(symbol, replacer);\n    }\n  }\n}\nvar URL_PATTERN = /(\\{\\$root\\}|\\{\\$iconset\\})/g;\nfunction parseSymbolPath(symbol, replacer) {\n  for (var p in symbol) {\n    if (symbol.hasOwnProperty(p) && p !== 'textName') {\n      if (isString(symbol[p]) && symbol[p].length > 2) {\n        symbol[p] = symbol[p].replace(URL_PATTERN, replacer);\n      } else if (isFunctionDefinition(symbol[p])) {\n        symbol[p] = parseStops(symbol[p], replacer);\n      } else if (isObject(symbol[p])) {\n        parseSymbolPath(symbol[p], replacer);\n      }\n    }\n  }\n}\n\nfunction parseStops(value, replacer) {\n  var defaultValue = value['default'];\n\n  if (isString(defaultValue)) {\n    value['default'] = defaultValue.replace(URL_PATTERN, replacer);\n  }\n\n  var stops = value.stops;\n\n  for (var i = 0; i < stops.length; i++) {\n    if (!Array.isArray(stops[i])) {\n      continue;\n    }\n\n    if (isString(stops[i][1])) {\n      stops[i][1] = stops[i][1].replace(URL_PATTERN, replacer);\n    } else if (isFunctionDefinition(stops[i][1])) {\n      stops[i][1] = parseStops(stops[i][1], replacer);\n    }\n  }\n\n  return value;\n}\n\nfunction isDashLine(symbolizers) {\n  if (symbolizers === void 0) {\n    symbolizers = [];\n  }\n\n  if (!Array.isArray(symbolizers)) {\n    symbolizers = [symbolizers];\n  }\n\n  var len = symbolizers.length;\n\n  for (var i = 0; i < len; i++) {\n    var symbolizer = symbolizers[i];\n\n    if (!symbolizer.style) {\n      continue;\n    }\n\n    var _symbolizer$style = symbolizer.style,\n        lineDasharray = _symbolizer$style.lineDasharray,\n        lineWidth = _symbolizer$style.lineWidth;\n\n    if (lineWidth && isNumber(lineWidth) && lineWidth > 0 && lineDasharray && Array.isArray(lineDasharray) && lineDasharray.length) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n\n\nvar index$1 = /*#__PURE__*/Object.freeze({\n  now: now,\n  extend: extend,\n  isNil: isNil,\n  isNumber: isNumber,\n  isInteger: isInteger,\n  isObject: isObject,\n  isString: isString,\n  isFunction: isFunction,\n  hasOwn: hasOwn,\n  join: join,\n  isEmpty: isEmpty,\n  toRadian: toRadian,\n  toDegree: toDegree,\n  IS_NODE: IS_NODE,\n  get requestAnimFrame () { return requestAnimFrame; },\n  get cancelAnimFrame () { return cancelAnimFrame; },\n  isSVG: isSVG,\n  loadImage: loadImage,\n  UID: UID,\n  GUID: GUID,\n  parseJSON: parseJSON,\n  pushIn: pushIn,\n  removeFromArray: removeFromArray,\n  forEachCoord: forEachCoord,\n  getValueOrDefault: getValueOrDefault,\n  sign: sign,\n  log2: log2,\n  interpolate: interpolate,\n  wrap: wrap,\n  clamp: clamp,\n  isArrayHasData: isArrayHasData,\n  isURL: isURL,\n  isCssUrl: isCssUrl,\n  extractCssUrl: extractCssUrl,\n  btoa: btoa$1,\n  b64toBlob: b64toBlob,\n  computeDegree: computeDegree,\n  emptyImageUrl: emptyImageUrl,\n  equalMapView: equalMapView,\n  flash: flash,\n  _defaults: _defaults$1,\n  getPointsResultPts: getPointsResultPts,\n  getImageBitMap: getImageBitMap,\n  getAbsoluteURL: getAbsoluteURL,\n  calCanvasSize: calCanvasSize,\n  translateToSVGStyles: translateToSVGStyles,\n  getMarkerPathBase64: getMarkerPathBase64,\n  getExternalResources: getExternalResources,\n  convertResourceUrl: convertResourceUrl,\n  isGradient: isGradient,\n  getGradientStamp: getGradientStamp,\n  getSymbolStamp: getSymbolStamp,\n  getSymbolHash: getSymbolHash,\n  lowerSymbolOpacity: lowerSymbolOpacity,\n  extendSymbol: extendSymbol,\n  parseStyleRootPath: parseStyleRootPath,\n  convertStylePath: convertStylePath,\n  parseSymbolPath: parseSymbolPath,\n  isDashLine: isDashLine\n});\n\nvar first = function first(props) {\n  return props[0];\n};\n\nvar testProp = IS_NODE ? first : function (props) {\n  var style = document.documentElement.style;\n\n  for (var i = 0; i < props.length; i++) {\n    if (props[i] in style) {\n      return props[i];\n    }\n  }\n\n  return false;\n};\nvar TRANSFORM = testProp(['transform', 'WebkitTransform', 'OTransform', 'MozTransform', 'msTransform']);\nvar TRANSFORMORIGIN = testProp(['transformOrigin', 'WebkitTransformOrigin', 'OTransformOrigin', 'MozTransformOrigin', 'msTransformOrigin']);\nvar TRANSITION = testProp(['transition', 'WebkitTransition', 'OTransition', 'MozTransition', 'msTransition']);\nvar CSSFILTER = testProp(['filter', 'WebkitFilter', 'OFilter', 'MozFilter', 'msFilter']);\nfunction createEl(tagName, className) {\n  var el = document.createElement(tagName);\n\n  if (className) {\n    setClass(el, className);\n  }\n\n  return el;\n}\nfunction createElOn(tagName, style, container) {\n  var el = createEl(tagName);\n\n  if (style) {\n    setStyle(el, style);\n  }\n\n  if (container) {\n    container.appendChild(el);\n  }\n\n  return el;\n}\nfunction removeDomNode(node) {\n  if (!node) {\n    return this;\n  }\n\n  if (Browser$1.ielt9 || Browser$1.ie9) {\n    var d = createEl('div');\n    d.appendChild(node);\n    d.innerHTML = '';\n    d = null;\n  } else if (node.parentNode) {\n    node.parentNode.removeChild(node);\n  }\n\n  return this;\n}\nfunction addDomEvent(obj, typeArr, handler, context) {\n  if (!obj || !obj.addEventListener || !typeArr || !handler) {\n    return this;\n  }\n\n  var eventHandler = function eventHandler(e) {\n    if (!e) {\n      e = window.event;\n    }\n\n    handler.call(context || obj, e);\n    return;\n  };\n\n  var types = typeArr.split(' ');\n\n  for (var i = types.length - 1; i >= 0; i--) {\n    var type = types[i];\n\n    if (!type) {\n      continue;\n    }\n\n    if (!obj['Z__' + type]) {\n      obj['Z__' + type] = [];\n    }\n\n    var hit = listensDomEvent(obj, type, handler);\n\n    if (hit >= 0) {\n      removeDomEvent(obj, type, handler);\n    }\n\n    obj['Z__' + type].push({\n      callback: eventHandler,\n      src: handler\n    });\n    obj.addEventListener(type, eventHandler, Browser$1.supportsPassive ? {\n      capture: false,\n      passive: false\n    } : false);\n  }\n\n  return this;\n}\nfunction removeDomEvent(obj, typeArr, handler) {\n  function doRemove(type, callback) {\n    if (type === 'mousewheel' && Browser$1.gecko) {\n      type = 'DOMMouseScroll';\n    }\n\n    obj.removeEventListener(type, callback, false);\n  }\n\n  if (!obj || !obj.removeEventListener || !typeArr) {\n    return this;\n  }\n\n  var types = typeArr.split(' ');\n\n  for (var i = types.length - 1; i >= 0; i--) {\n    var type = types[i];\n\n    if (!type) {\n      continue;\n    }\n\n    if (!handler && obj['Z__' + type]) {\n      var handlers = obj['Z__' + type];\n\n      for (var j = 0, jlen = handlers.length; j < jlen; j++) {\n        doRemove(handlers[j].callback);\n      }\n\n      delete obj['Z__' + type];\n      return this;\n    }\n\n    var hit = listensDomEvent(obj, type, handler);\n\n    if (hit < 0) {\n      return this;\n    }\n\n    var hitHandler = obj['Z__' + type][hit];\n    doRemove(type, hitHandler.callback);\n    obj['Z__' + type].splice(hit, 1);\n  }\n\n  return this;\n}\nfunction listensDomEvent(obj, type, handler) {\n  if (!obj || !obj['Z__' + type] || !handler) {\n    return -1;\n  }\n\n  var handlers = obj['Z__' + type];\n\n  for (var i = 0, len = handlers.length; i < len; i++) {\n    if (handlers[i].src === handler) {\n      return i;\n    }\n  }\n\n  return -1;\n}\nfunction preventDefault(event) {\n  if (event.preventDefault) {\n    event.preventDefault();\n  } else {\n    event.returnValue = false;\n  }\n\n  return this;\n}\nfunction stopPropagation(e) {\n  if (e.stopPropagation) {\n    e.stopPropagation();\n  } else {\n    e.cancelBubble = true;\n  }\n\n  return this;\n}\nfunction preventSelection(dom) {\n  dom.onselectstart = function () {\n    return false;\n  };\n\n  dom.ondragstart = function () {\n    return false;\n  };\n\n  dom.setAttribute('unselectable', 'on');\n  return this;\n}\nfunction offsetDom(dom, offset) {\n  if (!dom) {\n    return null;\n  }\n\n  if (Browser$1.any3d) {\n    setTransform(dom, offset);\n  } else {\n    dom.style.left = offset.x + 'px';\n    dom.style.top = offset.y + 'px';\n  }\n\n  return offset;\n}\nfunction computeDomPosition(dom) {\n  var style = window.getComputedStyle(dom);\n  var padding = [parseInt(style['padding-left']), parseInt(style['padding-top'])];\n  var rect = dom.getBoundingClientRect();\n  var offsetWidth = dom.offsetWidth,\n      offsetHeight = dom.offsetHeight;\n  var scaleX = offsetWidth ? rect.width / offsetWidth : 1,\n      scaleY = offsetHeight ? rect.height / offsetHeight : 1;\n  dom.__position = [rect.left + padding[0], rect.top + padding[1], scaleX, scaleY];\n  return dom.__position;\n}\nfunction getEventContainerPoint(ev, dom) {\n  if (!ev) {\n    ev = window.event;\n  }\n\n  var domPos = dom.__position;\n\n  if (!domPos) {\n    domPos = computeDomPosition(dom);\n  }\n\n  return new Point((ev.clientX - domPos[0] - dom.clientLeft) / domPos[2], (ev.clientY - domPos[1] - dom.clientTop) / domPos[3]);\n}\n\nfunction endsWith(str, suffix) {\n  var l = str.length - suffix.length;\n  return l >= 0 && str.indexOf(suffix, l) === l;\n}\n\nfunction setStyle(dom, strCss) {\n  var cssText = dom.style.cssText;\n\n  if (!endsWith(cssText, ';')) {\n    cssText += ';';\n  }\n\n  dom.style.cssText = cssText + strCss;\n  return this;\n}\nfunction hasClass(el, name) {\n  if (el.classList !== undefined) {\n    return el.classList.contains(name);\n  }\n\n  var className = getClass(el);\n  return className.length > 0 && new RegExp('(^|\\\\s)' + name + '(\\\\s|$)').test(className);\n}\nfunction addClass(el, name) {\n  if (el.classList !== undefined && !hasClass(el, name)) {\n    var classes = splitWords(name);\n\n    for (var i = 0, len = classes.length; i < len; i++) {\n      el.classList.add(classes[i]);\n    }\n  } else {\n    var className = getClass(el);\n    setClass(el, (className ? className + ' ' : '') + name);\n  }\n\n  return this;\n}\nfunction setClass(el, name) {\n  if (isNil(el.className.baseVal)) {\n    el.className = name;\n  } else {\n    el.className.baseVal = name;\n  }\n\n  return this;\n}\nfunction getClass(el) {\n  return isNil(el.className.baseVal) ? el.className : el.className.baseVal;\n}\nfunction setOpacity(el, value) {\n  el.style.opacity = value;\n  return this;\n}\nfunction setTransform(el, offset) {\n  var pos = offset || new Point(0, 0);\n  el.style[TRANSFORM] = Browser$1.any3d ? 'translate3d(' + pos.x + 'px,' + pos.y + 'px,0px)' : 'translate(' + pos.x + 'px,' + pos.y + 'px)';\n  return this;\n}\nfunction setTransformMatrix(el, m) {\n  var text = 'matrix(' + (isString(m) ? m : m.join()) + ')';\n\n  if (el.style[TRANSFORM] !== text) {\n    el.style[TRANSFORM] = text;\n  }\n\n  return this;\n}\nfunction removeTransform(el) {\n  if (el.style[TRANSFORM]) {\n    el.style[TRANSFORM] = '';\n  }\n\n  return this;\n}\nfunction isHTML(str) {\n  return /<[a-z\\][\\s\\S]*>/i.test(str);\n}\nfunction measureDom(parentTag, dom) {\n  var ruler = getDomRuler(parentTag);\n\n  if (isString(dom)) {\n    ruler.innerHTML = dom;\n  } else {\n    ruler.appendChild(dom);\n  }\n\n  var result = new Size(ruler.clientWidth, ruler.clientHeight);\n  removeDomNode(ruler);\n  return result;\n}\nfunction getDomRuler(tag) {\n  var span = document.createElement(tag);\n  span.style.cssText = 'position:absolute;left:-10000px;top:-10000px;';\n  document.body.appendChild(span);\n  return span;\n}\nvar on = addDomEvent;\nvar off = removeDomEvent;\n\nvar dom = /*#__PURE__*/Object.freeze({\n  TRANSFORM: TRANSFORM,\n  TRANSFORMORIGIN: TRANSFORMORIGIN,\n  TRANSITION: TRANSITION,\n  CSSFILTER: CSSFILTER,\n  createEl: createEl,\n  createElOn: createElOn,\n  removeDomNode: removeDomNode,\n  addDomEvent: addDomEvent,\n  removeDomEvent: removeDomEvent,\n  listensDomEvent: listensDomEvent,\n  preventDefault: preventDefault,\n  stopPropagation: stopPropagation,\n  preventSelection: preventSelection,\n  offsetDom: offsetDom,\n  computeDomPosition: computeDomPosition,\n  getEventContainerPoint: getEventContainerPoint,\n  setStyle: setStyle,\n  hasClass: hasClass,\n  addClass: addClass,\n  setClass: setClass,\n  getClass: getClass,\n  setOpacity: setOpacity,\n  setTransform: setTransform,\n  setTransformMatrix: setTransformMatrix,\n  removeTransform: removeTransform,\n  isHTML: isHTML,\n  measureDom: measureDom,\n  getDomRuler: getDomRuler,\n  on: on,\n  off: off\n});\n\nvar isMapSupported = typeof Map === 'function';\n\nvar ArrayLRUCache = function () {\n  function ArrayLRUCache(max, onRemove) {\n    this.max = max;\n    this.onRemove = onRemove;\n    this.reset();\n  }\n\n  var _proto = ArrayLRUCache.prototype;\n\n  _proto.reset = function reset() {\n    for (var key in this.data) {\n      this.onRemove(this.data[key]);\n    }\n\n    this.data = {};\n    this.order = [];\n    return this;\n  };\n\n  _proto.clear = function clear() {\n    this.reset();\n    delete this.onRemove;\n  };\n\n  _proto.add = function add(key, data) {\n    if (this.has(key)) {\n      this.order.splice(this.order.indexOf(key), 1);\n      this.data[key] = data;\n      this.order.push(key);\n    } else {\n      this.data[key] = data;\n      this.order.push(key);\n\n      if (this.order.length > this.max) {\n        var removedData = this.getAndRemove(this.order[0]);\n        if (removedData) this.onRemove(removedData);\n      }\n    }\n\n    return this;\n  };\n\n  _proto.has = function has(key) {\n    return key in this.data;\n  };\n\n  _proto.keys = function keys() {\n    return this.order;\n  };\n\n  _proto.getAndRemove = function getAndRemove(key) {\n    if (!this.has(key)) {\n      return null;\n    }\n\n    var data = this.data[key];\n    delete this.data[key];\n    this.order.splice(this.order.indexOf(key), 1);\n    return data;\n  };\n\n  _proto.get = function get(key) {\n    if (!this.has(key)) {\n      return null;\n    }\n\n    var data = this.data[key];\n    return data;\n  };\n\n  _proto.remove = function remove(key) {\n    if (!this.has(key)) {\n      return this;\n    }\n\n    var data = this.data[key];\n    delete this.data[key];\n    this.onRemove(data);\n    this.order.splice(this.order.indexOf(key), 1);\n    return this;\n  };\n\n  _proto.setMaxSize = function setMaxSize(max) {\n    this.max = max;\n\n    while (this.order.length > this.max) {\n      var removedData = this.getAndRemove(this.order[0]);\n      if (removedData) this.onRemove(removedData);\n    }\n\n    return this;\n  };\n\n  return ArrayLRUCache;\n}();\n\nvar MapLRUCache;\n\nif (isMapSupported) {\n  MapLRUCache = function () {\n    function MapLRUCache(max, onRemove) {\n      this.max = max;\n      this.onRemove = onRemove;\n      this.reset();\n    }\n\n    var _proto2 = MapLRUCache.prototype;\n\n    _proto2.reset = function reset() {\n      if (this.data) {\n        var values = this.data.values();\n\n        for (var _iterator = values, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {\n          var _ref;\n\n          if (_isArray) {\n            if (_i >= _iterator.length) break;\n            _ref = _iterator[_i++];\n          } else {\n            _i = _iterator.next();\n            if (_i.done) break;\n            _ref = _i.value;\n          }\n\n          var p = _ref;\n          this.onRemove(p);\n        }\n      }\n\n      this.data = new Map();\n      return this;\n    };\n\n    _proto2.clear = function clear() {\n      this.reset();\n      delete this.onRemove;\n    };\n\n    _proto2.add = function add(key, data) {\n      if (!data) {\n        return this;\n      }\n\n      if (this.has(key)) {\n        this.data.delete(key);\n        this.data.set(key, data);\n\n        if (this.data.size > this.max) {\n          this.shrink();\n        }\n      } else {\n        this.data.set(key, data);\n      }\n\n      return this;\n    };\n\n    _proto2.keys = function keys() {\n      var keys = new Array(this.data.size);\n      var i = 0;\n      var iterator = this.data.keys();\n\n      for (var _iterator2 = iterator, _isArray2 = Array.isArray(_iterator2), _i2 = 0, _iterator2 = _isArray2 ? _iterator2 : _iterator2[Symbol.iterator]();;) {\n        var _ref2;\n\n        if (_isArray2) {\n          if (_i2 >= _iterator2.length) break;\n          _ref2 = _iterator2[_i2++];\n        } else {\n          _i2 = _iterator2.next();\n          if (_i2.done) break;\n          _ref2 = _i2.value;\n        }\n\n        var k = _ref2;\n        keys[i++] = k;\n      }\n\n      return keys;\n    };\n\n    _proto2.shrink = function shrink() {\n      var iterator = this.data.keys();\n      var item = iterator.next();\n\n      while (this.data.size > this.max) {\n        var removedData = this.getAndRemove(item.value);\n\n        if (removedData) {\n          this.onRemove(removedData);\n        }\n\n        item = iterator.next();\n      }\n    };\n\n    _proto2.has = function has(key) {\n      return this.data.has(key);\n    };\n\n    _proto2.getAndRemove = function getAndRemove(key) {\n      if (!this.has(key)) {\n        return null;\n      }\n\n      var data = this.data.get(key);\n      this.data.delete(key);\n      return data;\n    };\n\n    _proto2.get = function get(key) {\n      if (!this.has(key)) {\n        return null;\n      }\n\n      var data = this.data.get(key);\n      return data;\n    };\n\n    _proto2.remove = function remove(key) {\n      if (!this.has(key)) {\n        return this;\n      }\n\n      var data = this.data.get(key);\n      this.data.delete(key);\n      this.onRemove(data);\n      return this;\n    };\n\n    _proto2.setMaxSize = function setMaxSize(max) {\n      this.max = max;\n\n      if (this.data.size > this.max) {\n        this.shrink();\n      }\n\n      return this;\n    };\n\n    return MapLRUCache;\n  }();\n}\n\nvar LRUCache = isMapSupported ? MapLRUCache : ArrayLRUCache;\n\nvar Ajax = {\n  jsonp: function jsonp(url, callback) {\n    var name = '_maptalks_jsonp_' + UID();\n    if (url.match(/\\?/)) url += '&callback=' + name;else url += '?callback=' + name;\n    var script = document.createElement('script');\n    script.type = 'text/javascript';\n    script.src = url;\n\n    window[name] = function (data) {\n      callback(null, data);\n      document.getElementsByTagName('head')[0].removeChild(script);\n      script = null;\n      delete window[name];\n    };\n\n    document.getElementsByTagName('head')[0].appendChild(script);\n    return this;\n  },\n  get: function get(url, options, cb) {\n    if (isFunction(options)) {\n      var t = cb;\n      cb = options;\n      options = t;\n    }\n\n    if (IS_NODE && Ajax.get.node) {\n      return Ajax.get.node(url, cb, options);\n    }\n\n    var client = Ajax._getClient(cb);\n\n    client.open('GET', url, true);\n\n    if (options) {\n      for (var k in options.headers) {\n        client.setRequestHeader(k, options.headers[k]);\n      }\n\n      client.withCredentials = options.credentials === 'include';\n\n      if (options['responseType']) {\n        client.responseType = options['responseType'];\n      }\n    }\n\n    client.send(null);\n    return client;\n  },\n  post: function post(url, options, cb) {\n    var postData;\n\n    if (!isString(url)) {\n      var t = cb;\n      postData = options;\n      options = url;\n      url = options.url;\n      cb = t;\n    } else {\n      if (isFunction(options)) {\n        var _t = cb;\n        cb = options;\n        options = _t;\n      }\n\n      options = options || {};\n      postData = options.postData;\n    }\n\n    if (IS_NODE && Ajax.post.node) {\n      options.url = url;\n      return Ajax.post.node(options, postData, cb);\n    }\n\n    var client = Ajax._getClient(cb);\n\n    client.open('POST', options.url, true);\n\n    if (!options.headers) {\n      options.headers = {};\n    }\n\n    if (!options.headers['Content-Type']) {\n      options.headers['Content-Type'] = 'application/x-www-form-urlencoded';\n    }\n\n    if ('setRequestHeader' in client) {\n      for (var p in options.headers) {\n        if (options.headers.hasOwnProperty(p)) {\n          client.setRequestHeader(p, options.headers[p]);\n        }\n      }\n    }\n\n    if (!isString(postData)) {\n      postData = JSON.stringify(postData);\n    }\n\n    client.send(postData);\n    return client;\n  },\n  _wrapCallback: function _wrapCallback(client, cb) {\n    return function () {\n      if (client.readyState === 4) {\n        if (client.status === 200) {\n          if (client.responseType === 'arraybuffer') {\n            var response = client.response;\n\n            if (response.byteLength === 0) {\n              cb(new Error('http status 200 returned without content.'));\n            } else {\n              cb(null, {\n                data: client.response,\n                cacheControl: client.getResponseHeader('Cache-Control'),\n                expires: client.getResponseHeader('Expires'),\n                contentType: client.getResponseHeader('Content-Type')\n              });\n            }\n          } else {\n            cb(null, client.responseText);\n          }\n        } else {\n          cb(new Error(client.statusText + ',' + client.status));\n        }\n      }\n    };\n  },\n  _getClient: function _getClient(cb) {\n    var client;\n\n    try {\n      client = new XMLHttpRequest();\n    } catch (e) {\n      try {\n        client = new ActiveXObject('Msxml2.XMLHTTP');\n      } catch (e) {\n        try {\n          client = new ActiveXObject('Microsoft.XMLHTTP');\n        } catch (e) {}\n      }\n    }\n\n    client.onreadystatechange = Ajax._wrapCallback(client, cb);\n    return client;\n  },\n  getArrayBuffer: function getArrayBuffer(url, options, cb) {\n    if (isFunction(options)) {\n      var t = cb;\n      cb = options;\n      options = t;\n    }\n\n    if (!options) {\n      options = {};\n    }\n\n    options['responseType'] = 'arraybuffer';\n    return Ajax.get(url, options, cb);\n  },\n  getImage: function getImage(img, url, options) {\n    return Ajax.getArrayBuffer(url, options, function (err, imgData) {\n      if (err) {\n        if (img.onerror) {\n          img.onerror(err);\n        }\n      } else if (imgData) {\n        var URL = window.URL || window.webkitURL;\n        var onload = img.onload;\n\n        img.onload = function () {\n          if (onload) {\n            onload();\n          }\n\n          URL.revokeObjectURL(img.src);\n        };\n\n        var blob = new Blob([new Uint8Array(imgData.data)], {\n          type: imgData.contentType\n        });\n        img.cacheControl = imgData.cacheControl;\n        img.expires = imgData.expires;\n        img.src = imgData.data.byteLength ? URL.createObjectURL(blob) : emptyImageUrl;\n      }\n    });\n  }\n};\n\nAjax.getJSON = function (url, options, cb) {\n  if (isFunction(options)) {\n    var t = cb;\n    cb = options;\n    options = t;\n  }\n\n  var callback = function callback(err, resp) {\n    var data = resp ? parseJSON(resp) : null;\n    cb(err, data);\n  };\n\n  if (options && options['jsonp']) {\n    return Ajax.jsonp(url, callback);\n  }\n\n  return Ajax.get(url, options, callback);\n};\n\nvar DEFAULT_STROKE_COLOR = '#000';\nvar DEFAULT_FILL_COLOR = 'rgba(255,255,255,0)';\nvar DEFAULT_TEXT_COLOR = '#000';\nvar hitTesting = false;\nvar TEMP_CANVAS = null;\nvar RADIAN = Math.PI / 180;\nvar textOffsetY = 1;\nvar Canvas = {\n  setHitTesting: function setHitTesting(testing) {\n    hitTesting = testing;\n  },\n  createCanvas: function createCanvas(width, height, canvasClass) {\n    var canvas;\n\n    if (!IS_NODE) {\n      canvas = createEl('canvas');\n      canvas.width = width;\n      canvas.height = height;\n    } else {\n      canvas = new canvasClass(width, height);\n    }\n\n    return canvas;\n  },\n  prepareCanvasFont: function prepareCanvasFont(ctx, style) {\n    ctx.textBaseline = 'top';\n    ctx.font = getFont(style);\n    var fill = style['textFill'];\n\n    if (!fill) {\n      fill = DEFAULT_TEXT_COLOR;\n    }\n\n    ctx.fillStyle = Canvas.getRgba(fill, style['textOpacity']);\n  },\n  prepareCanvas: function prepareCanvas(ctx, style, resources, testing) {\n    if (!style) {\n      return;\n    }\n\n    var strokeWidth = style['lineWidth'];\n\n    if (!isNil(strokeWidth) && ctx.lineWidth !== strokeWidth) {\n      ctx.lineWidth = strokeWidth;\n    }\n\n    var strokePattern = style['linePatternFile'];\n    var strokeColor = style['lineColor'] || DEFAULT_STROKE_COLOR;\n\n    if (testing) {\n      ctx.strokeStyle = '#000';\n    } else if (strokePattern && resources) {\n      var patternOffset;\n\n      if (style['linePatternDx'] || style['linePatternDy']) {\n        patternOffset = [style['linePatternDx'], style['linePatternDy']];\n      }\n\n      Canvas._setStrokePattern(ctx, strokePattern, strokeWidth, patternOffset, resources);\n\n      style['lineDasharray'] = [];\n    } else if (isGradient(strokeColor)) {\n      if (style['lineGradientExtent']) {\n        ctx.strokeStyle = Canvas._createGradient(ctx, strokeColor, style['lineGradientExtent']);\n      } else {\n        ctx.strokeStyle = DEFAULT_STROKE_COLOR;\n      }\n    } else {\n        if (Array.isArray(strokeColor)) {\n          strokeColor = Canvas.normalizeColorToRGBA(strokeColor);\n        }\n\n        ctx.strokeStyle = strokeColor;\n      }\n\n    if (style['lineJoin']) {\n      ctx.lineJoin = style['lineJoin'];\n    }\n\n    if (style['lineCap']) {\n      ctx.lineCap = style['lineCap'];\n    }\n\n    if (ctx.setLineDash && isArrayHasData(style['lineDasharray'])) {\n      ctx.setLineDash(style['lineDasharray']);\n    }\n\n    var polygonPattern = style['polygonPatternFile'];\n    var fill = style['polygonFill'] || DEFAULT_FILL_COLOR;\n\n    if (testing) {\n      ctx.fillStyle = '#000';\n    } else if (polygonPattern && resources) {\n      var fillImgUrl = extractImageUrl(polygonPattern);\n      var fillTexture = resources.getImage([fillImgUrl, null, null]);\n\n      if (!fillTexture) {\n        fillTexture = resources.getImage([fillImgUrl + '-texture', null, strokeWidth]);\n      }\n\n      if (isSVG(fillImgUrl) && fillTexture instanceof Image && (Browser$1.edge || Browser$1.ie)) {\n        var w = fillTexture.width || 20,\n            h = fillTexture.height || 20;\n        var canvas = Canvas.createCanvas(w, h);\n        Canvas.image(canvas.getContext('2d'), fillTexture, 0, 0, w, h);\n        fillTexture = canvas;\n      }\n\n      if (!fillTexture) {\n        if (typeof console !== 'undefined') {\n          console.warn('img not found for', fillImgUrl);\n        }\n      } else {\n        ctx.fillStyle = ctx.createPattern(fillTexture, 'repeat');\n\n        if (style['polygonPatternDx'] || style['polygonPatternDy']) {\n          ctx.fillStyle['polygonPatternOffset'] = [style['polygonPatternDx'], style['polygonPatternDy']];\n        }\n      }\n    } else if (isGradient(fill)) {\n      if (style['polygonGradientExtent']) {\n        ctx.fillStyle = Canvas._createGradient(ctx, fill, style['polygonGradientExtent']);\n      } else {\n        ctx.fillStyle = 'rgba(255,255,255,0)';\n      }\n    } else {\n        if (Array.isArray(fill)) {\n          fill = Canvas.normalizeColorToRGBA(fill);\n        }\n\n        ctx.fillStyle = fill;\n      }\n  },\n  _createGradient: function _createGradient(ctx, g, extent) {\n    var gradient = null,\n        places = g['places'];\n    var min = extent.getMin(),\n        max = extent.getMax(),\n        width = extent.getWidth(),\n        height = extent.getHeight();\n\n    if (!g['type'] || g['type'] === 'linear') {\n      if (!places) {\n        places = [min.x, min.y, max.x, min.y];\n      } else {\n        if (places.length !== 4) {\n          throw new Error('A linear gradient\\'s places should have 4 numbers.');\n        }\n\n        places = [min.x + places[0] * width, min.y + places[1] * height, min.x + places[2] * width, min.y + places[3] * height];\n      }\n\n      gradient = ctx.createLinearGradient.apply(ctx, places);\n    } else if (g['type'] === 'radial') {\n      if (!places) {\n        var c = extent.getCenter()._round();\n\n        places = [c.x, c.y, Math.abs(c.x - min.x), c.x, c.y, 0];\n      } else {\n        if (places.length !== 6) {\n          throw new Error('A radial gradient\\'s places should have 6 numbers.');\n        }\n\n        places = [min.x + places[0] * width, min.y + places[1] * height, width * places[2], min.x + places[3] * width, min.y + places[4] * height, width * places[5]];\n      }\n\n      gradient = ctx.createRadialGradient.apply(ctx, places);\n    }\n\n    g['colorStops'].forEach(function (stop) {\n      gradient.addColorStop.apply(gradient, stop);\n    });\n    return gradient;\n  },\n  _setStrokePattern: function _setStrokePattern(ctx, strokePattern, strokeWidth, linePatternOffset, resources) {\n    var imgUrl = extractImageUrl(strokePattern);\n    var imageTexture;\n\n    if (IS_NODE) {\n      imageTexture = resources.getImage([imgUrl, null, strokeWidth]);\n    } else {\n      var key = imgUrl + '-texture-' + strokeWidth;\n      imageTexture = resources.getImage(key);\n\n      if (!imageTexture) {\n        var imageRes = resources.getImage([imgUrl, null, null]);\n\n        if (imageRes) {\n          var w;\n\n          if (!imageRes.width || !imageRes.height) {\n            w = strokeWidth;\n          } else {\n            w = Math.round(imageRes.width * strokeWidth / imageRes.height);\n          }\n\n          var patternCanvas = Canvas.createCanvas(w, strokeWidth, ctx.canvas.constructor);\n          Canvas.image(patternCanvas.getContext('2d'), imageRes, 0, 0, w, strokeWidth);\n          resources.addResource([key, null, strokeWidth], patternCanvas);\n          imageTexture = patternCanvas;\n        }\n      }\n    }\n\n    if (imageTexture) {\n      ctx.strokeStyle = ctx.createPattern(imageTexture, 'repeat');\n      ctx.strokeStyle['linePatternOffset'] = linePatternOffset;\n    } else if (typeof console !== 'undefined') {\n      console.warn('img not found for', imgUrl);\n    }\n  },\n  clearRect: function clearRect(ctx, x1, y1, x2, y2) {\n    ctx.canvas._drawn = false;\n    ctx.clearRect(x1, y1, x2, y2);\n  },\n  fillCanvas: function fillCanvas(ctx, fillOpacity, x, y) {\n    if (hitTesting) {\n      fillOpacity = 1;\n    }\n\n    ctx.canvas._drawn = true;\n\n    if (fillOpacity === 0) {\n      return;\n    }\n\n    var isPattern = Canvas._isPattern(ctx.fillStyle);\n\n    var offset = ctx.fillStyle && ctx.fillStyle['polygonPatternOffset'];\n    var dx = offset ? offset[0] : 0,\n        dy = offset ? offset[1] : 0;\n\n    if (isNil(fillOpacity)) {\n      fillOpacity = 1;\n    }\n\n    var alpha;\n\n    if (fillOpacity < 1) {\n      alpha = ctx.globalAlpha;\n      ctx.globalAlpha *= fillOpacity;\n    }\n\n    if (isPattern) {\n      x = x || 0;\n      y = y || 0;\n      ctx.translate(x + dx, y + dy);\n    }\n\n    ctx.fill();\n\n    if (isPattern) {\n      ctx.translate(-x - dx, -y - dy);\n    }\n\n    if (fillOpacity < 1) {\n      ctx.globalAlpha = alpha;\n    }\n  },\n  getRgba: function getRgba(color, op) {\n    if (isNil(op)) {\n      op = 1;\n    }\n\n    if (color[0] !== '#') {\n      if (Array.isArray(color)) {\n        color = Canvas.normalizeColorToRGBA(color, op);\n      }\n\n      return color;\n    }\n\n    var r, g, b;\n\n    if (color.length === 7) {\n      r = parseInt(color.substring(1, 3), 16);\n      g = parseInt(color.substring(3, 5), 16);\n      b = parseInt(color.substring(5, 7), 16);\n    } else {\n      r = parseInt(color.substring(1, 2), 16) * 17;\n      g = parseInt(color.substring(2, 3), 16) * 17;\n      b = parseInt(color.substring(3, 4), 16) * 17;\n    }\n\n    return 'rgba(' + r + ',' + g + ',' + b + ',' + op + ')';\n  },\n  normalizeColorToRGBA: function normalizeColorToRGBA(fill, opacity) {\n    if (opacity === void 0) {\n      opacity = 1;\n    }\n\n    return \"rgba(\" + fill[0] * 255 + \",\" + fill[1] * 255 + \",\" + fill[2] * 255 + \",\" + (fill.length === 4 ? fill[3] : 1) * opacity + \")\";\n  },\n  image: function image(ctx, img, x, y, width, height) {\n    ctx.canvas._drawn = true;\n\n    try {\n      if (isNumber(width) && isNumber(height)) {\n        ctx.drawImage(img, x, y, width, height);\n      } else {\n        ctx.drawImage(img, x, y);\n      }\n    } catch (error) {\n      if (console) {\n        console.warn('error when drawing image on canvas:', error);\n        console.warn(img);\n      }\n    }\n  },\n  text: function text(ctx, _text, pt, style, textDesc) {\n    Canvas._textOnMultiRow(ctx, textDesc['rows'], style, pt, textDesc['size'], textDesc['rawSize']);\n  },\n  _textOnMultiRow: function _textOnMultiRow(ctx, texts, style, point, splitTextSize, textSize) {\n    var ptAlign = getAlignPoint(splitTextSize, style['textHorizontalAlignment'], style['textVerticalAlignment']),\n        lineHeight = textSize['height'] + style['textLineSpacing'],\n        basePoint = point.add(0, ptAlign.y),\n        maxHeight = style['textMaxHeight'];\n    var text,\n        rowAlign,\n        height = 0;\n\n    for (var i = 0, len = texts.length; i < len; i++) {\n      text = texts[i]['text'];\n      rowAlign = getAlignPoint(texts[i]['size'], style['textHorizontalAlignment'], style['textVerticalAlignment']);\n\n      Canvas._textOnLine(ctx, text, basePoint.add(rowAlign.x, i * lineHeight), style['textHaloRadius'], style['textHaloFill'], style['textHaloOpacity']);\n\n      if (maxHeight > 0) {\n        height += lineHeight;\n\n        if (height + textSize['height'] >= maxHeight) {\n          break;\n        }\n      }\n    }\n  },\n  _textOnLine: function _textOnLine(ctx, text, pt, textHaloRadius, textHaloFill, textHaloAlpha) {\n    if (hitTesting) {\n      textHaloAlpha = 1;\n    }\n\n    var drawHalo = textHaloAlpha !== 0 && textHaloRadius !== 0;\n    ctx.textBaseline = 'top';\n    var gco, fill;\n    var shadowBlur = ctx.shadowBlur,\n        shadowOffsetX = ctx.shadowOffsetX,\n        shadowOffsetY = ctx.shadowOffsetY;\n\n    if (drawHalo) {\n      var alpha = ctx.globalAlpha;\n      ctx.globalAlpha *= textHaloAlpha;\n      ctx.miterLimit = 2;\n      ctx.lineJoin = 'round';\n      ctx.lineCap = 'round';\n      ctx.lineWidth = textHaloRadius * 2;\n\n      if (Array.isArray(textHaloFill)) {\n        textHaloFill = Canvas.normalizeColorToRGBA(textHaloFill);\n      }\n\n      ctx.strokeStyle = textHaloFill;\n      ctx.strokeText(text, pt.x, pt.y + textOffsetY);\n      ctx.miterLimit = 10;\n      ctx.globalAlpha = alpha;\n      gco = ctx.globalCompositeOperation;\n      ctx.globalCompositeOperation = 'destination-out';\n      fill = ctx.fillStyle;\n      ctx.fillStyle = '#000';\n    }\n\n    if (shadowBlur && drawHalo) {\n      ctx.shadowBlur = ctx.shadowOffsetX = ctx.shadowOffsetY = 0;\n    }\n\n    Canvas.fillText(ctx, text, pt);\n\n    if (gco) {\n      ctx.globalCompositeOperation = gco;\n      Canvas.fillText(ctx, text, pt, fill);\n\n      if (shadowBlur) {\n        ctx.shadowBlur = shadowBlur;\n        ctx.shadowOffsetX = shadowOffsetX;\n        ctx.shadowOffsetY = shadowOffsetY;\n      }\n    }\n  },\n  fillText: function fillText(ctx, text, pt, rgba) {\n    ctx.canvas._drawn = true;\n\n    if (rgba) {\n      ctx.fillStyle = rgba;\n    }\n\n    ctx.fillText(text, pt.x, pt.y + textOffsetY);\n  },\n  _stroke: function _stroke(ctx, strokeOpacity, x, y) {\n    if (hitTesting) {\n      strokeOpacity = 1;\n    }\n\n    ctx.canvas._drawn = true;\n\n    if (strokeOpacity === 0) {\n      return;\n    }\n\n    var offset = ctx.strokeStyle && ctx.strokeStyle['linePatternOffset'];\n    var dx = offset ? offset[0] : 0,\n        dy = offset ? offset[1] : 0;\n    var isPattern = Canvas._isPattern(ctx.strokeStyle) && (!isNil(x) && !isNil(y) || !isNil(dx) && !isNil(dy));\n\n    if (isNil(strokeOpacity)) {\n      strokeOpacity = 1;\n    }\n\n    var alpha;\n\n    if (strokeOpacity < 1) {\n      alpha = ctx.globalAlpha;\n      ctx.globalAlpha *= strokeOpacity;\n    }\n\n    if (isPattern) {\n      x = x || 0;\n      y = y || 0;\n      ctx.translate(x + dx, y + dy);\n    }\n\n    ctx.stroke();\n\n    if (isPattern) {\n      ctx.translate(-x - dx, -y - dy);\n    }\n\n    if (strokeOpacity < 1) {\n      ctx.globalAlpha = alpha;\n    }\n  },\n  _path: function _path(ctx, points, lineDashArray, lineOpacity, ignoreStrokePattern) {\n    if (!isArrayHasData(points)) {\n      return;\n    }\n\n    function fillWithPattern(p1, p2) {\n      var degree = computeDegree(p1.x, p1.y, p2.x, p2.y);\n      ctx.save();\n      var cosd = Math.cos(degree);\n\n      if (Math.abs(cosd) < 1E-7) {\n        ctx.translate(p1.x - ctx.lineWidth / 2, p1.y);\n      } else {\n        ctx.translate(p1.x, p1.y - ctx.lineWidth / 2 / cosd);\n      }\n\n      ctx.rotate(degree);\n\n      Canvas._stroke(ctx, lineOpacity);\n\n      ctx.restore();\n    }\n\n    var isDashed = isArrayHasData(lineDashArray);\n    var isPatternLine = ignoreStrokePattern === true ? false : Canvas._isPattern(ctx.strokeStyle);\n    var point, prePoint, nextPoint;\n\n    for (var i = 0, len = points.length; i < len; i++) {\n      point = points[i];\n\n      if (!isDashed || ctx.setLineDash) {\n        ctx.lineTo(point.x, point.y);\n\n        if (isPatternLine && i > 0) {\n          prePoint = points[i - 1];\n          fillWithPattern(prePoint, point);\n          ctx.beginPath();\n          ctx.moveTo(point.x, point.y);\n        }\n      } else if (isDashed) {\n        if (i === len - 1) {\n          break;\n        }\n\n        nextPoint = points[i + 1];\n        drawDashLine(ctx, point, nextPoint, lineDashArray, isPatternLine);\n      }\n    }\n  },\n  path: function path(ctx, points, lineOpacity, fillOpacity, lineDashArray) {\n    if (!isArrayHasData(points)) {\n      return;\n    }\n\n    ctx.beginPath();\n    ctx.moveTo(points[0].x, points[0].y);\n\n    Canvas._path(ctx, points, lineDashArray, lineOpacity);\n\n    Canvas._stroke(ctx, lineOpacity);\n  },\n  _multiClip: function _multiClip(ctx, points) {\n    if (!points || points.length === 0) return;\n    points = points[0];\n\n    for (var i = 0, len = points.length; i < len; i++) {\n      var point = points[i];\n      var x = point.x,\n          y = point.y;\n\n      if (i === 0) {\n        ctx.moveTo(x, y);\n      } else {\n        ctx.lineTo(x, y);\n      }\n\n      if (i === len - 1) {\n        x = points[0].x;\n        y = points[0].y;\n        ctx.lineTo(x, y);\n      }\n    }\n  },\n  polygon: function polygon(ctx, points, lineOpacity, fillOpacity, lineDashArray, smoothness) {\n    if (ctx.isMultiClip) {\n      Canvas._multiClip(ctx, points);\n\n      return;\n    }\n\n    if (!isArrayHasData(points)) {\n      return;\n    }\n\n    var isPatternLine = Canvas._isPattern(ctx.strokeStyle),\n        fillFirst = isArrayHasData(lineDashArray) && !ctx.setLineDash || isPatternLine && !smoothness;\n\n    if (!isArrayHasData(points[0])) {\n      points = [points];\n    }\n\n    var savedCtx = ctx;\n\n    if (points.length > 1 && !IS_NODE) {\n      if (!TEMP_CANVAS) {\n        TEMP_CANVAS = Canvas.createCanvas(1, 1);\n      }\n\n      ctx.canvas._drawn = false;\n      TEMP_CANVAS.width = ctx.canvas.width;\n      TEMP_CANVAS.height = ctx.canvas.height;\n      ctx = TEMP_CANVAS.getContext('2d');\n      copyProperties(ctx, savedCtx);\n    }\n\n    var op, i, len;\n\n    if (fillFirst) {\n      ctx.save();\n\n      for (i = 0, len = points.length; i < len; i++) {\n        if (!isArrayHasData(points[i])) {\n          continue;\n        }\n\n        Canvas._ring(ctx, points[i], null, 0, true);\n\n        op = fillOpacity;\n\n        if (i > 0) {\n          ctx.globalCompositeOperation = 'destination-out';\n          op = 1;\n        }\n\n        Canvas.fillCanvas(ctx, op, points[i][0].x, points[i][0].y);\n\n        if (i > 0) {\n          ctx.globalCompositeOperation = 'source-over';\n        } else if (len > 1) {\n          ctx.fillStyle = '#fff';\n        }\n\n        Canvas._stroke(ctx, 0);\n      }\n\n      ctx.restore();\n    }\n\n    var fillStyle = ctx.fillStyle;\n\n    for (i = 0, len = points.length; i < len; i++) {\n      if (!isArrayHasData(points[i])) {\n        continue;\n      }\n\n      if (smoothness) {\n        Canvas.paintSmoothLine(ctx, points[i], lineOpacity, smoothness, true);\n        ctx.closePath();\n      } else {\n        Canvas._ring(ctx, points[i], lineDashArray, lineOpacity);\n      }\n\n      if (!fillFirst) {\n        op = fillOpacity;\n\n        if (i > 0) {\n          ctx.globalCompositeOperation = 'destination-out';\n          op = 1;\n        }\n\n        Canvas.fillCanvas(ctx, op, points[i][0].x, points[i][0].y);\n\n        if (i > 0) {\n          ctx.globalCompositeOperation = 'source-over';\n        } else if (len > 1) {\n          ctx.fillStyle = '#fff';\n        }\n      }\n\n      Canvas._stroke(ctx, lineOpacity);\n    }\n\n    if (ctx.fillStyle !== fillStyle) {\n      ctx.fillStyle = fillStyle;\n    }\n\n    if (points.length > 1 && !IS_NODE) {\n      savedCtx.drawImage(TEMP_CANVAS, 0, 0);\n      savedCtx.canvas._drawn = ctx.canvas._drawn;\n      copyProperties(savedCtx, ctx);\n    }\n  },\n  _ring: function _ring(ctx, ring, lineDashArray, lineOpacity, ignorePattern) {\n    var isPattern = Canvas._isPattern(ctx.strokeStyle);\n\n    if (!ignorePattern && isPattern && !ring[0].equals(ring[ring.length - 1])) {\n      ring = ring.concat([ring[0]]);\n    }\n\n    ctx.beginPath();\n    ctx.moveTo(ring[0].x, ring[0].y);\n\n    Canvas._path(ctx, ring, lineDashArray, lineOpacity, ignorePattern);\n\n    if (!isPattern) {\n      ctx.closePath();\n    }\n  },\n  paintSmoothLine: function paintSmoothLine(ctx, points, lineOpacity, smoothValue, close, tailIdx, tailRatio) {\n    if (!points) {\n      return;\n    }\n\n    if (points.length <= 2 || !smoothValue) {\n      Canvas.path(ctx, points, lineOpacity);\n      return;\n    }\n\n    function interpolate$$1(t0, t1, x1, y1, bx1, by1, bx2, by2, x2, y2) {\n      var u0 = 1.0 - t0;\n      var u1 = 1.0 - t1;\n      var qxa = x1 * u0 * u0 + bx1 * 2 * t0 * u0 + bx2 * t0 * t0;\n      var qxb = x1 * u1 * u1 + bx1 * 2 * t1 * u1 + bx2 * t1 * t1;\n      var qxc = bx1 * u0 * u0 + bx2 * 2 * t0 * u0 + x2 * t0 * t0;\n      var qxd = bx1 * u1 * u1 + bx2 * 2 * t1 * u1 + x2 * t1 * t1;\n      var qya = y1 * u0 * u0 + by1 * 2 * t0 * u0 + by2 * t0 * t0;\n      var qyb = y1 * u1 * u1 + by1 * 2 * t1 * u1 + by2 * t1 * t1;\n      var qyc = by1 * u0 * u0 + by2 * 2 * t0 * u0 + y2 * t0 * t0;\n      var qyd = by1 * u1 * u1 + by2 * 2 * t1 * u1 + y2 * t1 * t1;\n      var xb = qxa * u1 + qxc * t1;\n      var xc = qxb * u0 + qxd * t0;\n      var xd = qxb * u1 + qxd * t1;\n      var yb = qya * u1 + qyc * t1;\n      var yc = qyb * u0 + qyd * t0;\n      var yd = qyb * u1 + qyd * t1;\n      return [xb, yb, xc, yc, xd, yd];\n    }\n\n    function getCubicControlPoints(x0, y0, x1, y1, x2, y2, x3, y3, smoothValue, t) {\n      var xc1 = (x0 + x1) / 2.0,\n          yc1 = (y0 + y1) / 2.0;\n      var xc2 = (x1 + x2) / 2.0,\n          yc2 = (y1 + y2) / 2.0;\n      var xc3 = (x2 + x3) / 2.0,\n          yc3 = (y2 + y3) / 2.0;\n      var len1 = Math.sqrt((x1 - x0) * (x1 - x0) + (y1 - y0) * (y1 - y0));\n      var len2 = Math.sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1));\n      var len3 = Math.sqrt((x3 - x2) * (x3 - x2) + (y3 - y2) * (y3 - y2));\n      var k1 = len1 / (len1 + len2);\n      var k2 = len2 / (len2 + len3);\n      var xm1 = xc1 + (xc2 - xc1) * k1,\n          ym1 = yc1 + (yc2 - yc1) * k1;\n      var xm2 = xc2 + (xc3 - xc2) * k2,\n          ym2 = yc2 + (yc3 - yc2) * k2;\n      var ctrl1X = xm1 + (xc2 - xm1) * smoothValue + x1 - xm1,\n          ctrl1Y = ym1 + (yc2 - ym1) * smoothValue + y1 - ym1,\n          ctrl2X = xm2 + (xc2 - xm2) * smoothValue + x2 - xm2,\n          ctrl2Y = ym2 + (yc2 - ym2) * smoothValue + y2 - ym2;\n      var ctrlPoints = [ctrl1X, ctrl1Y, ctrl2X, ctrl2Y];\n\n      if (t < 1) {\n        return interpolate$$1(0, t, x1, y1, ctrl1X, ctrl1Y, ctrl2X, ctrl2Y, x2, y2);\n      } else {\n        return ctrlPoints;\n      }\n    }\n\n    var count = points.length;\n    var l = close ? count : count - 1;\n    ctx.beginPath();\n    ctx.moveTo(points[0].x, points[0].y);\n    if (tailRatio !== undefined) l -= Math.max(l - tailIdx - 1, 0);\n    var preCtrlPoints;\n\n    for (var i = 0; i < l; i++) {\n      var x1 = points[i].x,\n          y1 = points[i].y;\n      var x0 = void 0,\n          y0 = void 0,\n          x2 = void 0,\n          y2 = void 0,\n          x3 = void 0,\n          y3 = void 0;\n\n      if (i - 1 < 0) {\n        if (!close) {\n          x0 = points[i + 1].x;\n          y0 = points[i + 1].y;\n        } else {\n          x0 = points[l - 1].x;\n          y0 = points[l - 1].y;\n        }\n      } else {\n        x0 = points[i - 1].x;\n        y0 = points[i - 1].y;\n      }\n\n      if (i + 1 < count) {\n        x2 = points[i + 1].x;\n        y2 = points[i + 1].y;\n      } else {\n        x2 = points[i + 1 - count].x;\n        y2 = points[i + 1 - count].y;\n      }\n\n      if (i + 2 < count) {\n        x3 = points[i + 2].x;\n        y3 = points[i + 2].y;\n      } else if (!close) {\n        x3 = points[i].x;\n        y3 = points[i].y;\n      } else {\n        x3 = points[i + 2 - count].x;\n        y3 = points[i + 2 - count].y;\n      }\n\n      var ctrlPoints = getCubicControlPoints(x0, y0, x1, y1, x2, y2, x3, y3, smoothValue, i === l - 1 ? tailRatio : 1);\n\n      if (i === l - 1 && tailRatio >= 0 && tailRatio < 1) {\n        ctx.bezierCurveTo(ctrlPoints[0], ctrlPoints[1], ctrlPoints[2], ctrlPoints[3], ctrlPoints[4], ctrlPoints[5]);\n        points.splice(l - 1, count - (l - 1) - 1);\n        var lastPoint = new Point(ctrlPoints[4], ctrlPoints[5]);\n        lastPoint.prevCtrlPoint = new Point(ctrlPoints[2], ctrlPoints[3]);\n        points.push(lastPoint);\n        count = points.length;\n      } else {\n        ctx.bezierCurveTo(ctrlPoints[0], ctrlPoints[1], ctrlPoints[2], ctrlPoints[3], x2, y2);\n      }\n\n      points[i].nextCtrlPoint = ctrlPoints.slice(0, 2);\n      points[i].prevCtrlPoint = preCtrlPoints ? preCtrlPoints.slice(2) : null;\n      preCtrlPoints = ctrlPoints;\n    }\n\n    if (!close && points[1].prevCtrlPoint) {\n      points[0].nextCtrlPoint = points[1].prevCtrlPoint;\n      delete points[0].prevCtrlPoint;\n    }\n\n    if (!points[count - 1].prevCtrlPoint) {\n      points[count - 1].prevCtrlPoint = points[count - 2].nextCtrlPoint;\n    }\n\n    Canvas._stroke(ctx, lineOpacity);\n  },\n  _arcBetween: function _arcBetween(ctx, p1, p2, degree) {\n    var a = degree,\n        dist = p1.distanceTo(p2),\n        r = dist / 2 / Math.sin(a / 2);\n    var p1p2 = Math.asin((p2.y - p1.y) / dist);\n\n    if (p1.x > p2.x) {\n      p1p2 = Math.PI - p1p2;\n    }\n\n    var cp2 = 90 * RADIAN - a / 2,\n        da = p1p2 - cp2;\n    var dx = Math.cos(da) * r,\n        dy = Math.sin(da) * r,\n        cx = p1.x + dx,\n        cy = p1.y + dy;\n    var startAngle = Math.asin((p2.y - cy) / r);\n\n    if (cx > p2.x) {\n      startAngle = Math.PI - startAngle;\n    }\n\n    var endAngle = startAngle + a;\n    ctx.beginPath();\n    ctx.arc(cx, cy, r, startAngle, endAngle);\n    return [cx, cy];\n  },\n  _lineTo: function _lineTo(ctx, p) {\n    ctx.lineTo(p.x, p.y);\n  },\n  bezierCurveAndFill: function bezierCurveAndFill(ctx, points, lineOpacity, fillOpacity) {\n    ctx.beginPath();\n    var start = points[0];\n    ctx.moveTo(start.x, start.y);\n    var args = [ctx];\n    args.push.apply(args, points.splice(1));\n\n    Canvas._bezierCurveTo.apply(Canvas, args);\n\n    Canvas.fillCanvas(ctx, fillOpacity);\n\n    Canvas._stroke(ctx, lineOpacity);\n  },\n  _bezierCurveTo: function _bezierCurveTo(ctx, p1, p2, p3) {\n    ctx.bezierCurveTo(p1.x, p1.y, p2.x, p2.y, p3.x, p3.y);\n  },\n  ellipse: function ellipse(ctx, pt, width, heightTop, heightBottom, lineOpacity, fillOpacity) {\n    function bezierEllipse(x, y, a, b, b1) {\n      var k = 0.5522848,\n          ox = a * k,\n          oy = b * k,\n          oy1 = b1 * k;\n      ctx.moveTo(x - a, y);\n      ctx.bezierCurveTo(x - a, y - oy, x - ox, y - b, x, y - b);\n      ctx.bezierCurveTo(x + ox, y - b, x + a, y - oy, x + a, y);\n      ctx.bezierCurveTo(x + a, y + oy1, x + ox, y + b1, x, y + b1);\n      ctx.bezierCurveTo(x - ox, y + b1, x - a, y + oy1, x - a, y);\n      ctx.closePath();\n    }\n\n    ctx.beginPath();\n\n    if (width === heightTop && width === heightBottom) {\n      ctx.arc(pt.x, pt.y, width, 0, 2 * Math.PI);\n    } else if (ctx.ellipse) {\n      if (heightTop !== heightBottom) {\n        ctx.ellipse(pt.x, pt.y, width, heightTop, 0, RADIAN * 180, RADIAN * 360, false);\n        ctx.ellipse(pt.x, pt.y, width, heightBottom, 0, 0, RADIAN * 180, false);\n      } else {\n        ctx.ellipse(pt.x, pt.y, width, heightTop, 0, 0, RADIAN * 360, false);\n      }\n    } else {\n      bezierEllipse(pt.x, pt.y, width, heightTop, heightBottom);\n    }\n\n    Canvas.fillCanvas(ctx, fillOpacity, pt.x - width, pt.y - heightTop);\n\n    Canvas._stroke(ctx, lineOpacity, pt.x - width, pt.y - heightTop);\n  },\n  rectangle: function rectangle(ctx, pt, size, lineOpacity, fillOpacity) {\n    var x = pt.x,\n        y = pt.y;\n    ctx.beginPath();\n    ctx.rect(x, y, size['width'], size['height']);\n    Canvas.fillCanvas(ctx, fillOpacity, x, y);\n\n    Canvas._stroke(ctx, lineOpacity, x, y);\n  },\n  sector: function sector(ctx, pt, size, angles, lineOpacity, fillOpacity) {\n    var rad = RADIAN;\n    var startAngle = angles[0],\n        endAngle = angles[1];\n\n    function sector(ctx, x, y, radius, startAngle, endAngle) {\n      var sDeg = rad * -endAngle;\n      var eDeg = rad * -startAngle;\n      ctx.beginPath();\n      ctx.moveTo(x, y);\n      ctx.arc(x, y, radius, sDeg, eDeg);\n      ctx.lineTo(x, y);\n      Canvas.fillCanvas(ctx, fillOpacity, x - radius, y - radius);\n\n      Canvas._stroke(ctx, lineOpacity, x - radius, y - radius);\n    }\n\n    sector(ctx, pt.x, pt.y, size, startAngle, endAngle);\n  },\n  _isPattern: function _isPattern(style) {\n    return !isString(style) && !('addColorStop' in style);\n  },\n  drawCross: function drawCross(ctx, x, y, lineWidth, color) {\n    ctx.canvas._drawn = true;\n    ctx.strokeStyle = color;\n    ctx.lineWidth = lineWidth;\n    ctx.beginPath();\n    ctx.moveTo(x - 5, y);\n    ctx.lineTo(x + 5, y);\n    ctx.moveTo(x, y - 5);\n    ctx.lineTo(x, y + 5);\n    ctx.stroke();\n  },\n  copy: function copy(canvas, c) {\n    var target = c || createEl('canvas');\n    target.width = canvas.width;\n    target.height = canvas.height;\n    target.getContext('2d').drawImage(canvas, 0, 0);\n    return target;\n  },\n  pixelRect: function pixelRect(ctx, point, lineOpacity, fillOpacity) {\n    var lineWidth = ctx.lineWidth;\n    var alpha = ctx.globalAlpha;\n    var isStroke = false;\n\n    if (lineWidth > 0 && lineOpacity > 0) {\n      isStroke = true;\n\n      if (lineOpacity < 1) {\n        ctx.globalAlpha *= lineOpacity;\n      }\n    } else if (fillOpacity > 0) {\n      if (fillOpacity < 1) {\n        ctx.globalAlpha *= fillOpacity;\n      }\n    } else {\n      return;\n    }\n\n    ctx.canvas._drawn = true;\n\n    if (isStroke) {\n      ctx.strokeRect(point[0], point[1], 1, 1);\n    } else {\n      ctx.fillRect(point[0], point[1], 1, 1);\n    }\n\n    if (ctx.globalAlpha !== alpha) {\n      ctx.globalAlpha = alpha;\n    }\n  }\n};\n\nfunction drawDashLine(ctx, startPoint, endPoint, dashArray) {\n  var fromX = startPoint.x,\n      fromY = startPoint.y,\n      toX = endPoint.x,\n      toY = endPoint.y;\n  var pattern = dashArray;\n\n  var lt = function lt(a, b) {\n    return a <= b;\n  };\n\n  var gt = function gt(a, b) {\n    return a >= b;\n  };\n\n  var capmin = function capmin(a, b) {\n    return Math.min(a, b);\n  };\n\n  var capmax = function capmax(a, b) {\n    return Math.max(a, b);\n  };\n\n  var checkX = {\n    thereYet: gt,\n    cap: capmin\n  };\n  var checkY = {\n    thereYet: gt,\n    cap: capmin\n  };\n\n  if (fromY - toY > 0) {\n    checkY.thereYet = lt;\n    checkY.cap = capmax;\n  }\n\n  if (fromX - toX > 0) {\n    checkX.thereYet = lt;\n    checkX.cap = capmax;\n  }\n\n  ctx.moveTo(fromX, fromY);\n  var offsetX = fromX;\n  var offsetY = fromY;\n  var idx = 0,\n      dash = true;\n  var ang, len;\n\n  while (!(checkX.thereYet(offsetX, toX) && checkY.thereYet(offsetY, toY))) {\n    ang = Math.atan2(toY - fromY, toX - fromX);\n    len = pattern[idx];\n    offsetX = checkX.cap(toX, offsetX + Math.cos(ang) * len);\n    offsetY = checkY.cap(toY, offsetY + Math.sin(ang) * len);\n\n    if (dash) {\n      ctx.lineTo(offsetX, offsetY);\n    } else {\n      ctx.moveTo(offsetX, offsetY);\n    }\n\n    idx = (idx + 1) % pattern.length;\n    dash = !dash;\n  }\n}\n\nvar prefix = 'data:image/';\n\nfunction extractImageUrl(url) {\n  if (url.substring(0, prefix.length) === prefix) {\n    return url;\n  }\n\n  return extractCssUrl(url);\n}\n\nfunction copyProperties(ctx, savedCtx) {\n  ctx.filter = savedCtx.filter;\n  ctx.fillStyle = savedCtx.fillStyle;\n  ctx.globalAlpha = savedCtx.globalAlpha;\n  ctx.lineCap = savedCtx.lineCap;\n  ctx.lineDashOffset = savedCtx.lineDashOffset;\n  ctx.lineJoin = savedCtx.lineJoin;\n  ctx.lineWidth = savedCtx.lineWidth;\n  ctx.shadowBlur = savedCtx.shadowBlur;\n  ctx.shadowColor = savedCtx.shadowColor;\n  ctx.shadowOffsetX = savedCtx.shadowOffsetX;\n  ctx.shadowOffsetY = savedCtx.shadowOffsetY;\n  ctx.strokeStyle = savedCtx.strokeStyle;\n}\n\nvar promise;\n\nif (typeof Promise !== 'undefined') {\n  promise = Promise;\n} else {\n  promise = Zousan;\n}\n\nvar Promise$1 = promise;\n\nvar Eventable = function Eventable(Base) {\n  return function (_Base) {\n    _inheritsLoose(_class, _Base);\n\n    function _class() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    var _proto = _class.prototype;\n\n    _proto.on = function on$$1(eventsOn, handler, context) {\n      if (!eventsOn) {\n        return this;\n      }\n\n      if (!isString(eventsOn)) {\n        return this._switch('on', eventsOn, handler);\n      }\n\n      if (!handler) {\n        return this;\n      }\n\n      if (!this._eventMap) {\n        this._eventMap = {};\n      }\n\n      var eventTypes = eventsOn.toLowerCase().split(' ');\n      var evtType;\n\n      if (!context) {\n        context = this;\n      }\n\n      var handlerChain;\n\n      for (var ii = 0, ll = eventTypes.length; ii < ll; ii++) {\n        evtType = eventTypes[ii];\n        handlerChain = this._eventMap[evtType];\n\n        if (!handlerChain) {\n          handlerChain = [];\n          this._eventMap[evtType] = handlerChain;\n        }\n\n        var l = handlerChain.length;\n\n        if (l > 0) {\n          for (var i = 0; i < l; i++) {\n            if (handler === handlerChain[i].handler && handlerChain[i].context === context) {\n              return this;\n            }\n          }\n        }\n\n        handlerChain.push({\n          handler: handler,\n          context: context\n        });\n      }\n\n      return this;\n    };\n\n    _proto.addEventListener = function addEventListener() {\n      return this.on.apply(this, arguments);\n    };\n\n    _proto.once = function once(eventTypes, handler, context) {\n      if (!isString(eventTypes)) {\n        var once = {};\n\n        for (var p in eventTypes) {\n          if (eventTypes.hasOwnProperty(p)) {\n            once[p] = this._wrapOnceHandler(p, eventTypes[p], context);\n          }\n        }\n\n        return this._switch('on', once);\n      }\n\n      var evetTypes = eventTypes.split(' ');\n\n      for (var i = 0, l = evetTypes.length; i < l; i++) {\n        this.on(evetTypes[i], this._wrapOnceHandler(evetTypes[i], handler, context));\n      }\n\n      return this;\n    };\n\n    _proto.off = function off$$1(eventsOff, handler, context) {\n      if (!this._eventMap || !eventsOff) {\n        return this;\n      }\n\n      if (!isString(eventsOff)) {\n        return this._switch('off', eventsOff, handler);\n      }\n\n      if (!handler) {\n        return this;\n      }\n\n      var eventTypes = eventsOff.split(' ');\n      var eventType, listeners, wrapKey;\n\n      if (!context) {\n        context = this;\n      }\n\n      for (var j = 0, jl = eventTypes.length; j < jl; j++) {\n        eventType = eventTypes[j].toLowerCase();\n        wrapKey = 'Z__' + eventType;\n        listeners = this._eventMap[eventType];\n\n        if (!listeners) {\n          return this;\n        }\n\n        for (var i = listeners.length - 1; i >= 0; i--) {\n          var listener = listeners[i];\n\n          if ((handler === listener.handler || handler === listener.handler[wrapKey]) && listener.context === context) {\n            delete listener.handler[wrapKey];\n            listeners.splice(i, 1);\n          }\n        }\n\n        if (!listeners.length) {\n          delete this._eventMap[eventType];\n        }\n      }\n\n      return this;\n    };\n\n    _proto.removeEventListener = function removeEventListener() {\n      return this.off.apply(this, arguments);\n    };\n\n    _proto.listens = function listens(eventType, handler, context) {\n      if (!this._eventMap || !isString(eventType)) {\n        return 0;\n      }\n\n      var handlerChain = this._eventMap[eventType.toLowerCase()];\n\n      if (!handlerChain || !handlerChain.length) {\n        return 0;\n      }\n\n      if (!handler) {\n        return handlerChain.length;\n      }\n\n      for (var i = 0, len = handlerChain.length; i < len; i++) {\n        if (handler === handlerChain[i].handler && (isNil(context) || handlerChain[i].context === context)) {\n          return 1;\n        }\n      }\n\n      return 0;\n    };\n\n    _proto.getListeningEvents = function getListeningEvents() {\n      if (!this._eventMap) {\n        return [];\n      }\n\n      return Object.keys(this._eventMap);\n    };\n\n    _proto.copyEventListeners = function copyEventListeners(target) {\n      var eventMap = target._eventMap;\n\n      if (!eventMap) {\n        return this;\n      }\n\n      var handlerChain;\n\n      for (var eventType in eventMap) {\n        handlerChain = eventMap[eventType];\n\n        for (var i = 0, len = handlerChain.length; i < len; i++) {\n          this.on(eventType, handlerChain[i].handler, handlerChain[i].context);\n        }\n      }\n\n      return this;\n    };\n\n    _proto.fire = function fire() {\n      if (this._eventParent) {\n        return this._eventParent.fire.apply(this._eventParent, arguments);\n      }\n\n      return this._fire.apply(this, arguments);\n    };\n\n    _proto._wrapOnceHandler = function _wrapOnceHandler(evtType, handler, context) {\n      var me = this;\n      var key = 'Z__' + evtType;\n      var called = false;\n\n      var fn = function onceHandler() {\n        if (called) {\n          return;\n        }\n\n        delete fn[key];\n        called = true;\n\n        if (context) {\n          handler.apply(context, arguments);\n        } else {\n          handler.apply(this, arguments);\n        }\n\n        me.off(evtType, onceHandler, this);\n      };\n\n      fn[key] = handler;\n      return fn;\n    };\n\n    _proto._switch = function _switch(to, eventKeys, context) {\n      for (var p in eventKeys) {\n        if (eventKeys.hasOwnProperty(p)) {\n          this[to](p, eventKeys[p], context);\n        }\n      }\n\n      return this;\n    };\n\n    _proto._clearListeners = function _clearListeners(eventType) {\n      if (!this._eventMap || !isString(eventType)) {\n        return;\n      }\n\n      var handlerChain = this._eventMap[eventType.toLowerCase()];\n\n      if (!handlerChain) {\n        return;\n      }\n\n      this._eventMap[eventType] = null;\n    };\n\n    _proto._clearAllListeners = function _clearAllListeners() {\n      this._eventMap = null;\n    };\n\n    _proto._setEventParent = function _setEventParent(parent) {\n      this._eventParent = parent;\n      return this;\n    };\n\n    _proto._setEventTarget = function _setEventTarget(target) {\n      this._eventTarget = target;\n      return this;\n    };\n\n    _proto._fire = function _fire(eventType, param) {\n      if (!this._eventMap) {\n        return this;\n      }\n\n      var handlerChain = this._eventMap[eventType.toLowerCase()];\n\n      if (!handlerChain) {\n        return this;\n      }\n\n      if (!param) {\n        param = {};\n      }\n\n      param['type'] = eventType;\n      param['target'] = this._eventTarget || this;\n      var queue = handlerChain.slice(0);\n      var context, bubble, passed;\n\n      for (var i = 0, len = queue.length; i < len; i++) {\n        if (!queue[i]) {\n          continue;\n        }\n\n        context = queue[i].context;\n        bubble = true;\n        passed = extend({}, param);\n\n        if (context) {\n          bubble = queue[i].handler.call(context, passed);\n        } else {\n          bubble = queue[i].handler(passed);\n        }\n\n        if (bubble === false) {\n          if (param['domEvent']) {\n            stopPropagation(param['domEvent']);\n          }\n        }\n      }\n\n      return this;\n    };\n\n    return _class;\n  }(Base);\n};\n\nvar Handler = function () {\n  function Handler(target) {\n    this.target = target;\n  }\n\n  var _proto = Handler.prototype;\n\n  _proto.enable = function enable() {\n    if (this._enabled) {\n      return this;\n    }\n\n    this._enabled = true;\n    this.addHooks();\n    return this;\n  };\n\n  _proto.disable = function disable() {\n    if (!this._enabled) {\n      return this;\n    }\n\n    this._enabled = false;\n    this.removeHooks();\n    return this;\n  };\n\n  _proto.enabled = function enabled() {\n    return !!this._enabled;\n  };\n\n  _proto.remove = function remove() {\n    this.disable();\n    delete this.target;\n    delete this.dom;\n  };\n\n  return Handler;\n}();\n\nvar Handler$1 = Eventable(Handler);\n\nvar Class = function () {\n  function Class(options) {\n    if (!this || !this.setOptions) {\n      throw new Error('Class instance is being created without \"new\" operator.');\n    }\n\n    this.setOptions(options);\n    this.callInitHooks();\n  }\n\n  var _proto = Class.prototype;\n\n  _proto.callInitHooks = function callInitHooks() {\n    var proto = Object.getPrototypeOf(this);\n\n    this._visitInitHooks(proto);\n\n    return this;\n  };\n\n  _proto.setOptions = function setOptions(options) {\n    if (!this.hasOwnProperty('options')) {\n      this.options = this.options ? Object.create(this.options) : {};\n    }\n\n    if (!options) {\n      return this;\n    }\n\n    for (var i in options) {\n      this.options[i] = options[i];\n    }\n\n    return this;\n  };\n\n  _proto.config = function config(conf) {\n    if (!conf) {\n      var config = {};\n\n      for (var p in this.options) {\n        if (this.options.hasOwnProperty(p)) {\n          config[p] = this.options[p];\n        }\n      }\n\n      return config;\n    } else {\n      if (arguments.length === 2) {\n        var t = {};\n        t[conf] = arguments[1];\n        conf = t;\n      }\n\n      for (var i in conf) {\n        this.options[i] = conf[i];\n\n        if (this[i] && this[i] instanceof Handler$1) {\n          if (conf[i]) {\n            this[i].enable();\n          } else {\n            this[i].disable();\n          }\n        }\n      }\n\n      this.onConfig(conf);\n    }\n\n    return this;\n  };\n\n  _proto.onConfig = function onConfig() {};\n\n  _proto._visitInitHooks = function _visitInitHooks(proto) {\n    if (this._initHooksCalled) {\n      return;\n    }\n\n    var parentProto = Object.getPrototypeOf(proto);\n\n    if (parentProto._visitInitHooks) {\n      parentProto._visitInitHooks.call(this, parentProto);\n    }\n\n    this._initHooksCalled = true;\n    var hooks = proto._initHooks;\n\n    if (hooks && hooks !== parentProto._initHooks) {\n      for (var i = 0; i < hooks.length; i++) {\n        hooks[i].call(this);\n      }\n    }\n  };\n\n  Class.addInitHook = function addInitHook(fn) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    var init = typeof fn === 'function' ? fn : function () {\n      this[fn].apply(this, args);\n    };\n    var proto = this.prototype;\n    var parentProto = Object.getPrototypeOf(proto);\n\n    if (!proto._initHooks || proto._initHooks === parentProto._initHooks) {\n      proto._initHooks = [];\n    }\n\n    proto._initHooks.push(init);\n\n    return this;\n  };\n\n  Class.include = function include() {\n    for (var i = 0; i < arguments.length; i++) {\n      extend(this.prototype, i < 0 || arguments.length <= i ? undefined : arguments[i]);\n    }\n\n    return this;\n  };\n\n  Class.mergeOptions = function mergeOptions(options) {\n    var proto = this.prototype;\n    var parentProto = Object.getPrototypeOf(proto);\n\n    if (!proto.options || proto.options === parentProto.options) {\n      proto.options = proto.options ? Object.create(proto.options) : {};\n    }\n\n    extend(proto.options, options);\n    return this;\n  };\n\n  return Class;\n}();\n\nvar registeredTypes = {};\nvar JSONAble = (function (Base) {\n  return function (_Base) {\n    _inheritsLoose(_class, _Base);\n\n    function _class() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    _class.registerJSONType = function registerJSONType(type) {\n      if (!type) {\n        return this;\n      }\n\n      registeredTypes[type] = this;\n      return this;\n    };\n\n    _class.getJSONClass = function getJSONClass(type) {\n      if (!type) {\n        return null;\n      }\n\n      return registeredTypes[type];\n    };\n\n    var _proto = _class.prototype;\n\n    _proto.getJSONType = function getJSONType() {\n      if (this._jsonType === undefined) {\n        var clazz = Object.getPrototypeOf(this).constructor;\n\n        for (var p in registeredTypes) {\n          if (registeredTypes[p] === clazz) {\n            this._jsonType = p;\n            break;\n          }\n        }\n      }\n\n      if (!this._jsonType) {\n        throw new Error('Found an unregistered geometry class!');\n      }\n\n      return this._jsonType;\n    };\n\n    return _class;\n  }(Base);\n});\n\nvar search = {};\n\nvar CollisionIndex = function () {\n  function CollisionIndex() {\n    this._tree = rbush(9, ['[0]', '[1]', '[2]', '[3]']);\n  }\n\n  var _proto = CollisionIndex.prototype;\n\n  _proto.collides = function collides(box) {\n    search.minX = box[0];\n    search.minY = box[1];\n    search.maxX = box[2];\n    search.maxY = box[3];\n    return this._tree.collides(search);\n  };\n\n  _proto.insertBox = function insertBox(box) {\n    var tree = this._tree;\n    tree.insert(box);\n    return this;\n  };\n\n  _proto.bulkInsertBox = function bulkInsertBox(boxes) {\n    this._tree.load(boxes);\n\n    return this;\n  };\n\n  _proto.clear = function clear() {\n    this._tree.clear();\n\n    return this;\n  };\n\n  return CollisionIndex;\n}();\n\nfunction Handlerable (Base) {\n  return function (_Base) {\n    _inheritsLoose(_class, _Base);\n\n    function _class() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    var _proto = _class.prototype;\n\n    _proto.addHandler = function addHandler(name, handlerClass) {\n      if (!handlerClass) {\n        return this;\n      }\n\n      if (!this._handlers) {\n        this._handlers = [];\n      }\n\n      if (this[name]) {\n        this[name].enable();\n        return this;\n      }\n\n      var handler = this[name] = new handlerClass(this);\n\n      this._handlers.push(handler);\n\n      if (this.options[name]) {\n        handler.enable();\n      }\n\n      return this;\n    };\n\n    _proto.removeHandler = function removeHandler(name) {\n      if (!name) {\n        return this;\n      }\n\n      var handler = this[name];\n\n      if (handler) {\n        var hit = this._handlers.indexOf(handler);\n\n        if (hit >= 0) {\n          this._handlers.splice(hit, 1);\n        }\n\n        this[name].remove();\n        delete this[name];\n      }\n\n      return this;\n    };\n\n    _proto._clearHandlers = function _clearHandlers() {\n      for (var i = 0, len = this._handlers.length; i < len; i++) {\n        this._handlers[i].remove();\n      }\n\n      this._handlers = [];\n    };\n\n    return _class;\n  }(Base);\n}\n\nvar START_EVENTS = 'touchstart mousedown';\nvar MOVE_EVENTS = {\n  mousedown: 'mousemove',\n  touchstart: 'touchmove',\n  pointerdown: 'touchmove',\n  MSPointerDown: 'touchmove'\n};\nvar END_EVENTS = {\n  mousedown: 'mouseup',\n  touchstart: 'touchend',\n  pointerdown: 'touchend',\n  MSPointerDown: 'touchend'\n};\n\nvar DragHandler = function (_Handler) {\n  _inheritsLoose(DragHandler, _Handler);\n\n  function DragHandler(dom, options) {\n    var _this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    _this = _Handler.call(this, null) || this;\n    _this.dom = dom;\n    _this.options = options;\n    return _this;\n  }\n\n  var _proto = DragHandler.prototype;\n\n  _proto.enable = function enable() {\n    if (!this.dom) {\n      return this;\n    }\n\n    this._onMouseDown = function (e) {\n      return this.onMouseDown(e);\n    };\n\n    on(this.dom, START_EVENTS, this._onMouseDown, this);\n    return this;\n  };\n\n  _proto.disable = function disable() {\n    if (!this.dom) {\n      return this;\n    }\n\n    this._offEvents();\n\n    off(this.dom, START_EVENTS, this._onMouseDown);\n    delete this._onMouseDown;\n    return this;\n  };\n\n  _proto.onMouseDown = function onMouseDown(event) {\n    if (!this.options['rightclick'] && event.button === 2) {\n      return;\n    }\n\n    if (event.touches && event.touches.length > 1) {\n      return;\n    }\n\n    if (this.options['cancelOn'] && this.options['cancelOn'](event) === true) {\n      return;\n    }\n\n    var dom = this.dom;\n\n    if (dom.setCapture) {\n      dom.setCapture();\n    } else if (window.captureEvents) {\n      window.captureEvents(window['Event'].MOUSEMOVE | window['Event'].MOUSEUP);\n    }\n\n    dom['ondragstart'] = function () {\n      return false;\n    };\n\n    delete this.moved;\n    var actual = event.touches ? event.touches[0] : event;\n    this.startPos = new Point(actual.clientX, actual.clientY);\n    on(document, MOVE_EVENTS[event.type], this.onMouseMove, this);\n    on(document, END_EVENTS[event.type], this.onMouseUp, this);\n\n    if (!this.options['ignoreMouseleave']) {\n      on(this.dom, 'mouseleave', this.onMouseUp, this);\n    }\n\n    this.fire('mousedown', {\n      'domEvent': event,\n      'mousePos': new Point(actual.clientX, actual.clientY)\n    });\n  };\n\n  _proto.onMouseMove = function onMouseMove(event) {\n    if (event.touches && event.touches.length > 1) {\n      if (this.moved) {\n        this.interupted = true;\n        this.onMouseUp(event);\n      }\n\n      return;\n    }\n\n    var actual = event.touches ? event.touches[0] : event;\n    var newPos = new Point(actual.clientX, actual.clientY),\n        offset = newPos.sub(this.startPos);\n\n    if (!offset.x && !offset.y) {\n      return;\n    }\n\n    if (!this.moved) {\n      this.fire('dragstart', {\n        'domEvent': event,\n        'mousePos': this.startPos.copy()\n      });\n      this.moved = true;\n    } else {\n      this.fire('dragging', {\n        'domEvent': event,\n        'mousePos': new Point(actual.clientX, actual.clientY)\n      });\n    }\n  };\n\n  _proto.onMouseUp = function onMouseUp(event) {\n    var actual = event.changedTouches ? event.changedTouches[0] : event;\n\n    this._offEvents();\n\n    var param = {\n      'domEvent': event\n    };\n\n    if (isNumber(actual.clientX)) {\n      param['mousePos'] = new Point(parseInt(actual.clientX, 0), parseInt(actual.clientY, 0));\n    }\n\n    if (this.moved) {\n        param.interupted = this.interupted;\n        this.fire('dragend', param);\n        delete this.interupted;\n        delete this.moved;\n      }\n\n    this.fire('mouseup', param);\n  };\n\n  _proto._offEvents = function _offEvents() {\n    var dom = this.dom;\n    off(dom, 'mouseleave', this.onMouseUp, this);\n\n    if (typeof document === 'undefined' || typeof window === 'undefined') {\n      return;\n    }\n\n    for (var i in MOVE_EVENTS) {\n      off(document, MOVE_EVENTS[i], this.onMouseMove, this);\n      off(document, END_EVENTS[i], this.onMouseUp, this);\n    }\n\n    if (dom['releaseCapture']) {\n      dom['releaseCapture']();\n    } else if (window.captureEvents) {\n      window.captureEvents(window['Event'].MOUSEMOVE | window['Event'].MOUSEUP);\n    }\n  };\n\n  return DragHandler;\n}(Handler$1);\n\nvar Coordinate = function (_Position) {\n  _inheritsLoose(Coordinate, _Position);\n\n  function Coordinate() {\n    return _Position.apply(this, arguments) || this;\n  }\n\n  Coordinate.toNumberArrays = function toNumberArrays(coordinates) {\n    if (!Array.isArray(coordinates)) {\n      return [coordinates.x, coordinates.y];\n    }\n\n    return forEachCoord(coordinates, function (coord) {\n      return [coord.x, coord.y];\n    });\n  };\n\n  Coordinate.toCoordinates = function toCoordinates(coordinates) {\n    if (isNumber(coordinates[0]) && isNumber(coordinates[1])) {\n      return new Coordinate(coordinates);\n    }\n\n    if (coordinates instanceof Coordinate) {\n      return coordinates;\n    }\n\n    var result = [];\n\n    for (var i = 0, len = coordinates.length; i < len; i++) {\n      var child = coordinates[i];\n\n      if (Array.isArray(child)) {\n        if (isNumber(child[0])) {\n          result.push(new Coordinate(child));\n        } else {\n          result.push(Coordinate.toCoordinates(child));\n        }\n      } else if (child instanceof Coordinate) {\n        result.push(child);\n      } else {\n        result.push(new Coordinate(child));\n      }\n    }\n\n    return result;\n  };\n\n  return Coordinate;\n}(Position);\n\nvar CRS = function () {\n  function CRS(type, properties) {\n    this.type = type;\n    this.properties = properties;\n  }\n\n  CRS.createProj4 = function createProj4(proj) {\n    return new CRS('proj4', {\n      'proj': proj\n    });\n  };\n\n  CRS.fromProjectionCode = function fromProjectionCode(code) {\n    if (!code) {\n      return null;\n    }\n\n    code = code.toUpperCase().replace(':', '');\n    return CRS[code] || null;\n  };\n\n  return CRS;\n}();\n\nCRS.WGS84 = CRS.createProj4('+proj=longlat +datum=WGS84 +no_defs');\nCRS.EPSG4326 = CRS.WGS84;\nCRS.EPSG3857 = CRS.createProj4('+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs');\nCRS.IDENTITY = CRS.createProj4('+proj=identity +no_defs');\nCRS.CGCS2000 = CRS.createProj4('+proj=longlat +datum=CGCS2000');\nCRS.EPSG4490 = CRS.CGCS2000;\nCRS.BD09LL = CRS.createProj4('+proj=longlat +datum=BD09');\nCRS.GCJ02 = CRS.createProj4('+proj=longlat +datum=GCJ02');\n\nvar TEMP_POINT0 = new Point(0, 0);\nvar TEMP_COORD0 = new Coordinate(0, 0);\nvar TEMP_COORD1 = new Coordinate(0, 0);\nvar TEMP_COORD2 = new Coordinate(0, 0);\nvar TEMP_COORD3 = new Coordinate(0, 0);\nvar TEMP_COORD4 = new Coordinate(0, 0);\nvar TEMP_COORD5 = new Coordinate(0, 0);\nvar TEMP_COORD6 = new Coordinate(0, 0);\nvar TEMP_COORD7 = new Coordinate(0, 0);\nvar MINMAX = [];\nvar TEMP_EXTENT;\nvar TEMP_COMBINE = [];\n\nvar Extent = function () {\n  function Extent(p1, p2, p3, p4) {\n    this._clazz = Coordinate;\n    var l = arguments.length;\n    var proj = l > 0 ? arguments[l - 1] : null;\n\n    if (proj && proj.unproject) {\n      this.projection = arguments[l - 1];\n    }\n\n    this._dirty = true;\n\n    this._initialize(p1, p2, p3, p4);\n  }\n\n  var _proto = Extent.prototype;\n\n  _proto._initialize = function _initialize(p1, p2, p3, p4) {\n    this.xmin = null;\n    this.xmax = null;\n    this.ymin = null;\n    this.ymax = null;\n\n    if (isNil(p1)) {\n      return;\n    }\n\n    var projection = this.projection;\n\n    if (isNumber(p1) && isNumber(p2) && isNumber(p3) && isNumber(p4)) {\n      if (projection) {\n        this.set(p1, p2, p3, p4);\n      } else {\n        this.set(Math.min(p1, p3), Math.min(p2, p4), Math.max(p1, p3), Math.max(p2, p4));\n      }\n\n      return;\n    } else if (Array.isArray(p1)) {\n      if (projection) {\n        this.set(p1[0], p1[1], p1[2], p1[3]);\n      } else {\n        this.set(Math.min(p1[0], p1[2]), Math.min(p1[1], p1[3]), Math.max(p1[0], p1[2]), Math.max(p1[1], p1[3]));\n      }\n    } else if (isNumber(p1.x) && isNumber(p2.x) && isNumber(p1.y) && isNumber(p2.y)) {\n      if (projection) {\n        this.set(p1.x, p1.y, p2.x, p2.y);\n      } else {\n        if (p1.x > p2.x) {\n          this['xmin'] = p2.x;\n          this['xmax'] = p1.x;\n        } else {\n          this['xmin'] = p1.x;\n          this['xmax'] = p2.x;\n        }\n\n        if (p1.y > p2.y) {\n          this['ymin'] = p2.y;\n          this['ymax'] = p1.y;\n        } else {\n          this['ymin'] = p1.y;\n          this['ymax'] = p2.y;\n        }\n      }\n    } else if (isNumber(p1['xmin']) && isNumber(p1['xmax']) && isNumber(p1['ymin']) && isNumber(p1['ymax'])) {\n      this.set(p1['xmin'], p1['ymin'], p1['xmax'], p1['ymax']);\n    }\n  };\n\n  _proto._add = function _add(p) {\n    this._dirty = true;\n\n    if (!isNil(p.x)) {\n      this['xmin'] += p.x;\n      this['ymin'] += p.y;\n      this['xmax'] += p.x;\n      this['ymax'] += p.y;\n    } else if (!isNil(p.xmin)) {\n      this['xmin'] += p.xmin;\n      this['ymin'] += p.ymin;\n      this['xmax'] += p.xmax;\n      this['ymax'] += p.ymax;\n    } else if (!isNil(p[0])) {\n      this['xmin'] += p[0];\n      this['ymin'] += p[1];\n      this['xmax'] += p[0];\n      this['ymax'] += p[1];\n    }\n\n    return this;\n  };\n\n  _proto.add = function add() {\n    var e = new this.constructor(this['xmin'], this['ymin'], this['xmax'], this['ymax'], this.projection);\n    return e._add.apply(e, arguments);\n  };\n\n  _proto._scale = function _scale(s) {\n    this._dirty = true;\n    this['xmin'] *= s;\n    this['ymin'] *= s;\n    this['xmax'] *= s;\n    this['ymax'] *= s;\n    return this;\n  };\n\n  _proto._sub = function _sub(p) {\n    this._dirty = true;\n\n    if (!isNil(p.x)) {\n      this['xmin'] -= p.x;\n      this['ymin'] -= p.y;\n      this['xmax'] -= p.x;\n      this['ymax'] -= p.y;\n    } else if (!isNil(p.xmin)) {\n      this['xmin'] -= p.xmin;\n      this['ymin'] -= p.ymin;\n      this['xmax'] -= p.xmax;\n      this['ymax'] -= p.ymax;\n    } else if (!isNil(p[0])) {\n      this['xmin'] -= p[0];\n      this['ymin'] -= p[1];\n      this['xmax'] -= p[0];\n      this['ymax'] -= p[1];\n    }\n\n    return this;\n  };\n\n  _proto._substract = function _substract() {\n    return this._sub.apply(this, arguments);\n  };\n\n  _proto.sub = function sub() {\n    var e = new this.constructor(this['xmin'], this['ymin'], this['xmax'], this['ymax'], this.projection);\n    return e._sub.apply(e, arguments);\n  };\n\n  _proto.substract = function substract() {\n    return this.sub.apply(this, arguments);\n  };\n\n  _proto.round = function round() {\n    return new this.constructor(Math.round(this['xmin']), Math.round(this['ymin']), Math.round(this['xmax']), Math.round(this['ymax']), this.projection);\n  };\n\n  _proto._round = function _round() {\n    this._dirty = true;\n    this['xmin'] = Math.round(this['xmin']);\n    this['ymin'] = Math.round(this['ymin']);\n    this['xmax'] = Math.round(this['xmax']);\n    this['ymax'] = Math.round(this['ymax']);\n    return this;\n  };\n\n  _proto.getMin = function getMin(out) {\n    if (out) {\n      out.set(this['xmin'], this['ymin']);\n      return out;\n    }\n\n    return new this._clazz(this['xmin'], this['ymin']);\n  };\n\n  _proto.getMax = function getMax(out) {\n    if (out) {\n      out.set(this['xmax'], this['ymax']);\n      return out;\n    }\n\n    return new this._clazz(this['xmax'], this['ymax']);\n  };\n\n  _proto.getCenter = function getCenter(out) {\n    var x = (this['xmin'] + this['xmax']) / 2;\n    var y = (this['ymin'] + this['ymax']) / 2;\n\n    if (out) {\n      out.set(x, y);\n      return out;\n    }\n\n    return new this._clazz(x, y);\n  };\n\n  _proto.isValid = function isValid() {\n    return !isNil(this['xmin']) && !isNil(this['ymin']) && !isNil(this['xmax']) && !isNil(this['ymax']);\n  };\n\n  _proto.equals = function equals(ext2) {\n    return this['xmin'] === ext2['xmin'] && this['xmax'] === ext2['xmax'] && this['ymin'] === ext2['ymin'] && this['ymax'] === ext2['ymax'];\n  };\n\n  _proto.intersects = function intersects(ext2) {\n    this._project(this);\n\n    this._project(ext2);\n\n    var rxmin = Math.max(this['pxmin'], ext2['pxmin']);\n    var rymin = Math.max(this['pymin'], ext2['pymin']);\n    var rxmax = Math.min(this['pxmax'], ext2['pxmax']);\n    var rymax = Math.min(this['pymax'], ext2['pymax']);\n    var intersects = !(rxmin > rxmax || rymin > rymax);\n    return intersects;\n  };\n\n  _proto.within = function within(extent) {\n    this._project(this);\n\n    this._project(extent);\n\n    return this.pxmin >= extent.pxmin && this.pxmax <= extent.pxmax && this.pymin >= extent.pymin && this.pymax <= extent.pymax;\n  };\n\n  _proto.contains = function contains(c) {\n    if (!c) {\n      return false;\n    }\n\n    this._project(this);\n\n    var proj = this.projection;\n\n    if (proj) {\n      if (c.x !== undefined) {\n        var coord = TEMP_COORD0;\n\n        if (Array.isArray(c)) {\n          coord.x = c[0];\n          coord.y = c[1];\n        } else {\n          coord.x = c.x;\n          coord.y = c.y;\n        }\n\n        c = proj.project(coord, coord);\n      } else if (c.xmin !== undefined) {\n        this._project(c);\n      }\n    }\n\n    return (c.x || c.pxmin || 0) >= this.pxmin && (c.x || c.pxmax || 0) <= this.pxmax && (c.y || c.pymin || 0) >= this.pymin && (c.y || c.pymax || 0) <= this.pymax;\n  };\n\n  _proto.getWidth = function getWidth() {\n    return Math.abs(this['xmax'] - this['xmin']);\n  };\n\n  _proto.getHeight = function getHeight() {\n    return Math.abs(this['ymax'] - this['ymin']);\n  };\n\n  _proto.getSize = function getSize() {\n    return new Size(this.getWidth(), this.getHeight());\n  };\n\n  _proto.set = function set(xmin, ymin, xmax, ymax) {\n    this.xmin = xmin;\n    this.ymin = ymin;\n    this.xmax = xmax;\n    this.ymax = ymax;\n    this._dirty = true;\n    return this;\n  };\n\n  _proto.__combine = function __combine(extent) {\n    if (extent.x !== undefined) {\n      TEMP_EXTENT.xmin = TEMP_EXTENT.xmax = extent.x;\n      TEMP_EXTENT.ymin = TEMP_EXTENT.ymax = extent.y;\n      extent = TEMP_EXTENT;\n    }\n\n    this._project(extent);\n\n    this._project(this);\n\n    var inited = isNumber(this.pxmin);\n    var xmin, ymin, xmax, ymax;\n\n    if (!inited) {\n      xmin = extent['pxmin'];\n      ymin = extent['pymin'];\n      xmax = extent['pxmax'];\n      ymax = extent['pymax'];\n    } else {\n      xmin = Math.min(this['pxmin'], extent['pxmin']);\n      ymin = Math.min(this['pymin'], extent['pymin']);\n      xmax = Math.max(this['pxmax'], extent['pxmax']);\n      ymax = Math.max(this['pymax'], extent['pymax']);\n    }\n\n    var proj = this.projection;\n\n    if (proj) {\n      TEMP_COORD1.set(xmin, ymin);\n      TEMP_COORD2.set(xmax, ymax);\n      var min = proj.unproject(TEMP_COORD1, TEMP_COORD1),\n          max = proj.unproject(TEMP_COORD2, TEMP_COORD2);\n      xmin = min.x;\n      ymin = min.y;\n      xmax = max.x;\n      ymax = max.y;\n    }\n\n    TEMP_COMBINE[0] = xmin;\n    TEMP_COMBINE[1] = ymin;\n    TEMP_COMBINE[2] = xmax;\n    TEMP_COMBINE[3] = ymax;\n    return TEMP_COMBINE;\n  };\n\n  _proto._combine = function _combine(extent) {\n    if (!extent || extent.isValid && !extent.isValid()) {\n      return this;\n    }\n\n    var ext = this.__combine(extent);\n\n    this.set(ext[0], ext[1], ext[2], ext[3]);\n    this._dirty = true;\n    return this;\n  };\n\n  _proto.combine = function combine(extent) {\n    if (!extent || extent.isValid && !extent.isValid()) {\n      return this;\n    }\n\n    var ext = this.__combine(extent);\n\n    return new this.constructor(ext[0], ext[1], ext[2], ext[3], this.projection);\n  };\n\n  _proto.intersection = function intersection(extent) {\n    if (!this.intersects(extent)) {\n      return null;\n    }\n\n    TEMP_COORD3.x = Math.max(this['pxmin'], extent['pxmin']);\n    TEMP_COORD3.y = Math.max(this['pymin'], extent['pymin']);\n    TEMP_COORD4.x = Math.min(this['pxmax'], extent['pxmax']);\n    TEMP_COORD4.y = Math.min(this['pymax'], extent['pymax']);\n    var min = TEMP_COORD3,\n        max = TEMP_COORD4;\n    var proj = this.projection;\n\n    if (proj) {\n      min = proj.unproject(min, min);\n      max = proj.unproject(max, max);\n    }\n\n    return new this.constructor(min, max, proj);\n  };\n\n  _proto.expand = function expand(distance) {\n    var w, h;\n\n    if (!isNumber(distance)) {\n      w = distance['width'] || distance['x'] || distance[0] || 0;\n      h = distance['height'] || distance['y'] || distance[1] || 0;\n    } else {\n      w = h = distance;\n    }\n\n    return new this.constructor(this['xmin'] - w, this['ymin'] - h, this['xmax'] + w, this['ymax'] + h, this.projection);\n  };\n\n  _proto._expand = function _expand(distance) {\n    var w, h;\n\n    if (!isNumber(distance)) {\n      w = distance['width'] || distance['x'] || distance[0] || 0;\n      h = distance['height'] || distance['y'] || distance[1] || 0;\n    } else {\n      w = h = distance;\n    }\n\n    this['xmin'] -= w;\n    this['ymin'] -= h;\n    this['xmax'] += w;\n    this['ymax'] += h;\n    this._dirty = true;\n    return this;\n  };\n\n  _proto.toJSON = function toJSON() {\n    return {\n      'xmin': this['xmin'],\n      'ymin': this['ymin'],\n      'xmax': this['xmax'],\n      'ymax': this['ymax']\n    };\n  };\n\n  _proto.toArray = function toArray(out) {\n    var xmin = this['xmin'],\n        ymin = this['ymin'],\n        xmax = this['xmax'],\n        ymax = this['ymax'];\n\n    if (!out) {\n      return [new this._clazz([xmin, ymax]), new this._clazz([xmax, ymax]), new this._clazz([xmax, ymin]), new this._clazz([xmin, ymin]), new this._clazz([xmin, ymax])];\n    } else {\n      out[0].x = xmin;\n      out[0].y = ymax;\n      out[1].x = xmax;\n      out[1].y = ymax;\n      out[2].x = xmax;\n      out[2].y = ymin;\n      out[3].x = xmin;\n      out[3].y = ymin;\n      out[4].x = xmin;\n      out[4].y = ymax;\n      return out;\n    }\n  };\n\n  _proto.toString = function toString() {\n    return this.xmin + \",\" + this.ymin + \",\" + this.xmax + \",\" + this.ymax;\n  };\n\n  _proto.copy = function copy() {\n    return new this.constructor(this['xmin'], this['ymin'], this['xmax'], this['ymax'], this.projection);\n  };\n\n  _proto.convertTo = function convertTo(fn, out) {\n    if (!this.isValid()) {\n      return null;\n    }\n\n    var e = out || new this.constructor();\n\n    if (out) {\n      e.set(null, null, null, null);\n    }\n\n    var coord;\n\n    if (this._clazz === Coordinate) {\n      coord = TEMP_COORD5;\n    } else if (this._clazz === Point) {\n      coord = TEMP_POINT0;\n    }\n\n    coord.x = this.xmin;\n    coord.y = this.ymax;\n\n    e._combine(fn(coord));\n\n    coord.x = this.xmax;\n\n    e._combine(fn(coord));\n\n    coord.y = this.ymin;\n\n    e._combine(fn(coord));\n\n    coord.x = this.xmin;\n\n    e._combine(fn(coord));\n\n    return e;\n  };\n\n  _proto._project = function _project(ext) {\n    if (!ext || !ext.isValid()) {\n      if (ext) {\n        ext.pxmin = ext.pxmax = ext.pymin = ext.pymax = null;\n      }\n\n      return;\n    }\n\n    var proj = this.projection;\n\n    if (proj) {\n      if (ext._dirty) {\n        TEMP_COORD6.set(ext.xmax, ext.ymin);\n        TEMP_COORD7.set(ext.xmin, ext.ymax);\n        MINMAX[0] = TEMP_COORD6;\n        MINMAX[1] = TEMP_COORD7;\n        var minmax = proj.projectCoords(MINMAX);\n        var min = minmax[0],\n            max = minmax[1];\n        ext.pxmin = Math.min(min.x, max.x);\n        ext.pymin = Math.min(min.y, max.y);\n        ext.pxmax = Math.max(min.x, max.x);\n        ext.pymax = Math.max(min.y, max.y);\n      }\n\n      delete ext._dirty;\n    } else {\n      ext.pxmin = ext.xmin;\n      ext.pxmax = ext.xmax;\n      ext.pymin = ext.ymin;\n      ext.pymax = ext.ymax;\n    }\n  };\n\n  return Extent;\n}();\n\nTEMP_EXTENT = new Extent(0, 0, 0, 0);\n\nvar PointExtent = function (_Extent) {\n  _inheritsLoose(PointExtent, _Extent);\n\n  function PointExtent(p1, p2, p3, p4) {\n    var _this;\n\n    _this = _Extent.call(this, p1, p2, p3, p4) || this;\n    _this._clazz = Point;\n    return _this;\n  }\n\n  return PointExtent;\n}(Extent);\n\nvar Transformation = function () {\n  function Transformation(matrix) {\n    this.matrix = matrix;\n  }\n\n  var _proto = Transformation.prototype;\n\n  _proto.transform = function transform(coordinates, scale, out) {\n    var x = this.matrix[0] * (coordinates.x - this.matrix[2]) / scale;\n    var y = -this.matrix[1] * (coordinates.y - this.matrix[3]) / scale;\n\n    if (out) {\n      out.x = x;\n      out.y = y;\n      return out;\n    }\n\n    return new Point(x, y);\n  };\n\n  _proto.untransform = function untransform(point, scale, out) {\n    var x = point.x * scale / this.matrix[0] + this.matrix[2];\n    var y = point.y * scale / -this.matrix[1] + this.matrix[3];\n\n    if (out) {\n      out.x = x;\n      out.y = y;\n      return out;\n    }\n\n    return new Coordinate(x, y);\n  };\n\n  return Transformation;\n}();\n\nvar Common = {\n  project: function project() {},\n  unproject: function unproject() {},\n  projectCoords: function projectCoords(coordinates) {\n    var _this = this;\n\n    if (!coordinates) {\n      return [];\n    }\n\n    if (!Array.isArray(coordinates)) {\n      return this.project(coordinates);\n    }\n\n    if (coordinates.length === 0) {\n      return [];\n    }\n\n    if (!this.isSphere()) {\n      return forEachCoord(coordinates, this.project, this);\n    }\n\n    if (Array.isArray(coordinates[0])) {\n      return coordinates.map(function (coords) {\n        return _this.projectCoords(coords);\n      });\n    } else {\n      var circum = this.getCircum();\n      var extent = this.getSphereExtent(),\n          sx = extent.sx,\n          sy = extent.sy;\n      var wrapX, wrapY;\n      var pre = coordinates[0],\n          current,\n          dx,\n          dy,\n          p;\n      var prj = [this.project(pre)];\n\n      for (var i = 1, l = coordinates.length; i < l; i++) {\n        current = coordinates[i];\n        dx = current.x - pre.x;\n        dy = current.y - pre.y;\n        p = this.project(current);\n\n        if (Math.abs(dx) > 180) {\n          if (wrapX === undefined) {\n            wrapX = current.x > pre.x;\n          }\n\n          if (wrapX) {\n            p._add(-circum.x * sign(dx) * sx, 0);\n\n            current._add(-360 * sign(dx), 0);\n          }\n        }\n\n        if (Math.abs(dy) > 90) {\n          if (wrapY === undefined) {\n            wrapY = current.y < pre.y;\n          }\n\n          if (wrapY) {\n            p._add(0, -circum.y * sign(dy) * sy);\n\n            current._add(0, -180 * sign(dy));\n          }\n        }\n\n        pre = current;\n        prj.push(p);\n      }\n\n      return prj;\n    }\n  },\n  unprojectCoords: function unprojectCoords(projCoords) {\n    if (!projCoords) {\n      return [];\n    }\n\n    if (!Array.isArray(projCoords)) {\n      return this.unproject(projCoords);\n    }\n\n    return forEachCoord(projCoords, this.unproject, this);\n  },\n  isSphere: function isSphere() {\n    return !!this.sphere;\n  },\n  isOutSphere: function isOutSphere(pcoord) {\n    if (!this.isSphere()) {\n      return false;\n    }\n\n    var extent = this.getSphereExtent();\n    return !extent.contains(pcoord);\n  },\n  wrapCoord: function wrapCoord(pcoord) {\n    if (!this.isSphere()) {\n      return pcoord;\n    }\n\n    var extent = this.getSphereExtent();\n    var wrapped = new Coordinate(pcoord);\n\n    if (!extent.contains(wrapped)) {\n      wrapped.x = wrap(pcoord.x, extent.xmin, extent.xmax);\n      wrapped.y = wrap(pcoord.y, extent.ymin, extent.ymax);\n    }\n\n    return wrapped;\n  },\n  getCircum: function getCircum() {\n    if (!this.circum && this.isSphere()) {\n      var extent = this.getSphereExtent();\n      this.circum = {\n        x: extent.getWidth(),\n        y: extent.getHeight()\n      };\n    }\n\n    return this.circum;\n  },\n  getSphereExtent: function getSphereExtent() {\n    if (!this.extent && this.isSphere()) {\n      var max = this.project(new Coordinate(180, 90)),\n          min = this.project(new Coordinate(-180, -90));\n      this.extent = new Extent(min, max, this);\n      this.extent.sx = max.x > min.x ? 1 : -1;\n      this.extent.sy = max.y > min.y ? 1 : -1;\n    }\n\n    return this.extent;\n  }\n};\n\nvar Common$1 = {\n  measureLength: function measureLength(c1, c2) {\n    if (!Array.isArray(c1)) {\n      return this.measureLenBetween(c1, c2);\n    }\n\n    var len = 0;\n\n    for (var i = 0, l = c1.length; i < l - 1; i++) {\n      len += this.measureLenBetween(c1[i], c1[i + 1]);\n    }\n\n    return len;\n  }\n};\n\nvar Identity = extend({\n  'measure': 'IDENTITY',\n  measureLenBetween: function measureLenBetween(c1, c2) {\n    if (!c1 || !c2) {\n      return 0;\n    }\n\n    try {\n      return Math.sqrt(Math.pow(c1.x - c2.x, 2) + Math.pow(c1.y - c2.y, 2));\n    } catch (err) {\n      return 0;\n    }\n  },\n  measureArea: function measureArea(coordinates) {\n    if (!Array.isArray(coordinates)) {\n      return 0;\n    }\n\n    var area = 0;\n\n    for (var i = 0, len = coordinates.length; i < len; i++) {\n      var c1 = coordinates[i];\n      var c2 = null;\n\n      if (i === len - 1) {\n        c2 = coordinates[0];\n      } else {\n        c2 = coordinates[i + 1];\n      }\n\n      area += c1.x * c2.y - c1.y * c2.x;\n    }\n\n    return Math.abs(area / 2);\n  },\n  locate: function locate(c, xDist, yDist) {\n    c = new Coordinate(c.x, c.y);\n    return this._locate(c, xDist, yDist);\n  },\n  _locate: function _locate(c, xDist, yDist) {\n    if (!c) {\n      return null;\n    }\n\n    if (!xDist) {\n      xDist = 0;\n    }\n\n    if (!yDist) {\n      yDist = 0;\n    }\n\n    if (!xDist && !yDist) {\n      return c;\n    }\n\n    c.x = c.x + xDist;\n    c.y = c.y + yDist;\n    return c;\n  },\n  rotate: function rotate(c, pivot, angle) {\n    c = new Coordinate(c.x, c.y);\n    return this._rotate(c, pivot, angle);\n  },\n  _rotate: function () {\n    var tmp = new Point(0, 0);\n    return function (c, pivot, angle) {\n      tmp.x = c.x - pivot.x;\n      tmp.y = c.y - pivot.y;\n\n      tmp._rotate(angle * Math.PI / 180);\n\n      c.x = pivot.x + tmp.x;\n      c.y = pivot.y + tmp.y;\n      return c;\n    };\n  }()\n}, Common$1);\n\nvar Sphere = function () {\n  function Sphere(radius) {\n    this.radius = radius;\n  }\n\n  var _proto = Sphere.prototype;\n\n  _proto.measureLenBetween = function measureLenBetween(c1, c2) {\n    if (!c1 || !c2) {\n      return 0;\n    }\n\n    var b = toRadian(c1.y);\n    var d = toRadian(c2.y),\n        e = b - d,\n        f = toRadian(c1.x) - toRadian(c2.x);\n    b = 2 * Math.asin(Math.sqrt(Math.pow(Math.sin(e / 2), 2) + Math.cos(b) * Math.cos(d) * Math.pow(Math.sin(f / 2), 2)));\n    b *= this.radius;\n    return Math.round(b * 1E5) / 1E5;\n  };\n\n  _proto.measureArea = function measureArea(coordinates) {\n    var a = toRadian(this.radius);\n    var b = 0,\n        c = coordinates,\n        d = c.length;\n\n    if (d < 3) {\n      return 0;\n    }\n\n    var i;\n\n    for (i = 0; i < d - 1; i++) {\n      var e = c[i],\n          f = c[i + 1];\n      b += e.x * a * Math.cos(toRadian(e.y)) * f.y * a - f.x * a * Math.cos(toRadian(f.y)) * e.y * a;\n    }\n\n    d = c[i];\n    c = c[0];\n    b += d.x * a * Math.cos(toRadian(d.y)) * c.y * a - c.x * a * Math.cos(toRadian(c.y)) * d.y * a;\n    return 0.5 * Math.abs(b);\n  };\n\n  _proto.locate = function locate(c, xDist, yDist) {\n    c = new Coordinate(c.x, c.y);\n    return this._locate(c, xDist, yDist);\n  };\n\n  _proto._locate = function _locate(c, xDist, yDist) {\n    if (!c) {\n      return null;\n    }\n\n    if (!xDist) {\n      xDist = 0;\n    }\n\n    if (!yDist) {\n      yDist = 0;\n    }\n\n    if (!xDist && !yDist) {\n      return c;\n    }\n\n    var x, y;\n    var ry = toRadian(c.y);\n\n    if (yDist !== 0) {\n      var dy = Math.abs(yDist);\n      var sy = Math.sin(dy / (2 * this.radius)) * 2;\n      ry = ry + sy * (yDist > 0 ? 1 : -1);\n      y = wrap(ry * 180 / Math.PI, -90, 90);\n    } else {\n      y = c.y;\n    }\n\n    if (xDist !== 0) {\n      var dx = Math.abs(xDist);\n      var rx = toRadian(c.x);\n      var sx = 2 * Math.sqrt(Math.pow(Math.sin(dx / (2 * this.radius)), 2) / Math.pow(Math.cos(ry), 2));\n      rx = rx + sx * (xDist > 0 ? 1 : -1);\n      x = wrap(rx * 180 / Math.PI, -180, 180);\n    } else {\n      x = c.x;\n    }\n\n    c.x = x;\n    c.y = y;\n    return c;\n  };\n\n  _proto.rotate = function rotate(c, pivot, angle) {\n    c = new Coordinate(c);\n    return this._rotate(c, pivot, angle);\n  };\n\n  _proto._rotate = function _rotate(c, pivot, angle) {\n    var initialAngle = rhumbBearing(pivot, c);\n    var finalAngle = initialAngle - angle;\n    var distance = this.measureLenBetween(pivot, c);\n    c.x = pivot.x;\n    c.y = pivot.y;\n    return calculateRhumbDestination(c, distance, finalAngle, this.radius);\n  };\n\n  return Sphere;\n}();\n\nfunction rhumbBearing(start, end, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var bear360;\n  if (options.final) bear360 = calculateRhumbBearing(end, start);else bear360 = calculateRhumbBearing(start, end);\n  var bear180 = bear360 > 180 ? -(360 - bear360) : bear360;\n  return bear180;\n}\n\nfunction calculateRhumbBearing(from, to) {\n  var phi1 = toRadian(from.y);\n  var phi2 = toRadian(to.y);\n  var deltaLambda = toRadian(to.x - from.x);\n  if (deltaLambda > Math.PI) deltaLambda -= 2 * Math.PI;\n  if (deltaLambda < -Math.PI) deltaLambda += 2 * Math.PI;\n  var deltaPsi = Math.log(Math.tan(phi2 / 2 + Math.PI / 4) / Math.tan(phi1 / 2 + Math.PI / 4));\n  var theta = Math.atan2(deltaLambda, deltaPsi);\n  return (toDegree(theta) + 360) % 360;\n}\n\nfunction calculateRhumbDestination(origin, distance, bearing, radius) {\n  var delta = distance / radius;\n  var lambda1 = origin.x * Math.PI / 180;\n  var phi1 = toRadian(origin.y);\n  var theta = toRadian(bearing);\n  var DeltaPhi = delta * Math.cos(theta);\n  var phi2 = phi1 + DeltaPhi;\n  if (Math.abs(phi2) > Math.PI / 2) phi2 = phi2 > 0 ? Math.PI - phi2 : -Math.PI - phi2;\n  var DeltaPsi = Math.log(Math.tan(phi2 / 2 + Math.PI / 4) / Math.tan(phi1 / 2 + Math.PI / 4));\n  var q = Math.abs(DeltaPsi) > 10e-12 ? DeltaPhi / DeltaPsi : Math.cos(phi1);\n  var DeltaLambda = delta * Math.sin(theta) / q;\n  var lambda2 = lambda1 + DeltaLambda;\n  origin.x = (lambda2 * 180 / Math.PI + 540) % 360 - 180;\n  origin.y = phi2 * 180 / Math.PI;\n  return origin;\n}\n\nvar WGS84Sphere = extend({\n  'measure': 'EPSG:4326',\n  sphere: new Sphere(6378137),\n  measureLenBetween: function measureLenBetween() {\n    return this.sphere.measureLenBetween.apply(this.sphere, arguments);\n  },\n  measureArea: function measureArea() {\n    return this.sphere.measureArea.apply(this.sphere, arguments);\n  },\n  _locate: function _locate() {\n    return this.sphere._locate.apply(this.sphere, arguments);\n  },\n  locate: function locate() {\n    return this.sphere.locate.apply(this.sphere, arguments);\n  },\n  _rotate: function _rotate() {\n    return this.sphere._rotate.apply(this.sphere, arguments);\n  },\n  rotate: function rotate() {\n    return this.sphere.rotate.apply(this.sphere, arguments);\n  }\n}, Common$1);\nvar BaiduSphere = extend({\n  'measure': 'BAIDU',\n  sphere: new Sphere(6370996.81),\n  measureLenBetween: function measureLenBetween() {\n    return this.sphere.measureLenBetween.apply(this.sphere, arguments);\n  },\n  measureArea: function measureArea() {\n    return this.sphere.measureArea.apply(this.sphere, arguments);\n  },\n  _locate: function _locate() {\n    return this.sphere._locate.apply(this.sphere, arguments);\n  },\n  locate: function locate() {\n    return this.sphere.locate.apply(this.sphere, arguments);\n  },\n  _rotate: function _rotate() {\n    return this.sphere._rotate.apply(this.sphere, arguments);\n  },\n  rotate: function rotate() {\n    return this.sphere.rotate.apply(this.sphere, arguments);\n  }\n}, Common$1);\n\nvar DEFAULT = WGS84Sphere;\nvar measurers = {};\n\nfunction registerMeasurer(m) {\n  measurers[m.measure] = m;\n}\n\nregisterMeasurer(Identity);\nregisterMeasurer(WGS84Sphere);\nregisterMeasurer(BaiduSphere);\nvar Measurer = {\n  getInstance: function getInstance(name) {\n    if (!name) {\n      return DEFAULT;\n    }\n\n    for (var p in measurers) {\n      if (hasOwn(measurers, p)) {\n        var mName = measurers[p]['measure'];\n\n        if (!mName) {\n          continue;\n        }\n\n        if (name.toLowerCase() === mName.toLowerCase()) {\n          return measurers[p];\n        }\n      }\n    }\n\n    return null;\n  }\n};\n\nvar index$2 = /*#__PURE__*/Object.freeze({\n  Identity: Identity,\n  DEFAULT: DEFAULT,\n  Measurer: Measurer,\n  WGS84Sphere: WGS84Sphere,\n  BaiduSphere: BaiduSphere\n});\n\nvar delta = 1E-7;\nvar EPSG3857 = extend({}, Common, {\n  code: 'EPSG:3857',\n  rad: Math.PI / 180,\n  metersPerDegree: 6378137 * Math.PI / 180,\n  maxLatitude: 85.0511287798,\n  project: function project(lnglat, out) {\n    var rad = this.rad,\n        metersPerDegree = this.metersPerDegree,\n        max = this.maxLatitude;\n    var lng = lnglat.x,\n        lat = Math.max(Math.min(max, lnglat.y), -max);\n    var c;\n\n    if (lat === 0) {\n      c = 0;\n    } else {\n      c = Math.log(Math.tan((90 + lat) * rad / 2)) / rad;\n    }\n\n    var x = lng * metersPerDegree;\n    var y = c * metersPerDegree;\n\n    if (out) {\n      out.x = x;\n      out.y = y;\n      return out;\n    }\n\n    return new Coordinate(x, y);\n  },\n  unproject: function unproject(pLnglat, out) {\n    var rad = this.rad;\n    var metersPerDegree = this.metersPerDegree;\n    var x = pLnglat.x / metersPerDegree;\n    var y = pLnglat.y;\n    var c;\n\n    if (y === 0) {\n      c = 0;\n    } else {\n      c = y / metersPerDegree;\n      c = (2 * Math.atan(Math.exp(c * rad)) - Math.PI / 2) / rad;\n    }\n\n    if (Math.abs(Math.abs(x) - 180) < delta) {\n      x = sign(x) * 180;\n    }\n\n    if (Math.abs(Math.abs(c) - this.maxLatitude) < delta) {\n      c = sign(c) * this.maxLatitude;\n    }\n\n    var rx = wrap(x, -180, 180);\n    var ry = wrap(c, -this.maxLatitude, this.maxLatitude);\n\n    if (out) {\n      out.x = rx;\n      out.y = ry;\n      return out;\n    }\n\n    return new Coordinate(rx, ry);\n  }\n}, WGS84Sphere);\n\nvar PROJ4326 = extend({}, Common, {\n  code: 'EPSG:4326',\n  project: function project(p, out) {\n    if (out) {\n      out.x = p.x;\n      out.y = p.y;\n      return out;\n    }\n\n    return new Coordinate(p);\n  },\n  unproject: function unproject(p, out) {\n    if (out) {\n      out.x = p.x;\n      out.y = p.y;\n      return out;\n    }\n\n    return new Coordinate(p);\n  }\n}, WGS84Sphere);\n\nvar Projection_EPSG4490 = extend({}, PROJ4326, {\n  code: 'EPSG:4490'\n});\n\nvar Projection_Baidu = extend({}, Common, {\n  code: 'BAIDU',\n  project: function project(p, out) {\n    return this.convertLL2MC(p, out);\n  },\n  unproject: function unproject(p, out) {\n    return this.convertMC2LL(p, out);\n  }\n}, BaiduSphere, {\n  EARTHRADIUS: 6370996.81,\n  MCBAND: [12890594.86, 8362377.87, 5591021, 3481989.83, 1678043.12, 0],\n  LLBAND: [75, 60, 45, 30, 15, 0],\n  MC2LL: [[1.410526172116255e-8, 0.00000898305509648872, -1.9939833816331, 200.9824383106796, -187.2403703815547, 91.6087516669843, -23.38765649603339, 2.57121317296198, -0.03801003308653, 17337981.2], [-7.435856389565537e-9, 0.000008983055097726239, -0.78625201886289, 96.32687599759846, -1.85204757529826, -59.36935905485877, 47.40033549296737, -16.50741931063887, 2.28786674699375, 10260144.86], [-3.030883460898826e-8, 0.00000898305509983578, 0.30071316287616, 59.74293618442277, 7.357984074871, -25.38371002664745, 13.45380521110908, -3.29883767235584, 0.32710905363475, 6856817.37], [-1.981981304930552e-8, 0.000008983055099779535, 0.03278182852591, 40.31678527705744, 0.65659298677277, -4.44255534477492, 0.85341911805263, 0.12923347998204, -0.04625736007561, 4482777.06], [3.09191371068437e-9, 0.000008983055096812155, 0.00006995724062, 23.10934304144901, -0.00023663490511, -0.6321817810242, -0.00663494467273, 0.03430082397953, -0.00466043876332, 2555164.4], [2.890871144776878e-9, 0.000008983055095805407, -3.068298e-8, 7.47137025468032, -0.00000353937994, -0.02145144861037, -0.00001234426596, 0.00010322952773, -0.00000323890364, 826088.5]],\n  LL2MC: [[-0.0015702102444, 111320.7020616939, 1704480524535203, -10338987376042340, 26112667856603880, -35149669176653700, 26595700718403920, -10725012454188240, 1800819912950474, 82.5], [0.0008277824516172526, 111320.7020463578, 647795574.6671607, -4082003173.641316, 10774905663.51142, -15171875531.51559, 12053065338.62167, -5124939663.577472, 913311935.9512032, 67.5], [0.00337398766765, 111320.7020202162, 4481351.045890365, -23393751.19931662, 79682215.47186455, -115964993.2797253, 97236711.15602145, -43661946.33752821, 8477230.501135234, 52.5], [0.00220636496208, 111320.7020209128, 51751.86112841131, 3796837.749470245, 992013.7397791013, -1221952.21711287, 1340652.697009075, -620943.6990984312, 144416.9293806241, 37.5], [-0.0003441963504368392, 111320.7020576856, 278.2353980772752, 2485758.690035394, 6070.750963243378, 54821.18345352118, 9540.606633304236, -2710.55326746645, 1405.483844121726, 22.5], [-0.0003218135878613132, 111320.7020701615, 0.00369383431289, 823725.6402795718, 0.46104986909093, 2351.343141331292, 1.58060784298199, 8.77738589078284, 0.37238884252424, 7.45]],\n  convertMC2LL: function convertMC2LL(cB, out) {\n    var cE;\n\n    for (var cD = 0, len = this.MCBAND.length; cD < len; cD++) {\n      if (Math.abs(cB.y) >= this.MCBAND[cD]) {\n        cE = this.MC2LL[cD];\n        break;\n      }\n    }\n\n    var T = this.convertor(cB, cE, out);\n    return T;\n  },\n  convertLL2MC: function convertLL2MC(T, out) {\n    var cD, cC, len;\n    T.x = this.getLoop(T.x, -180, 180);\n    T.y = this.getRange(T.y, -74, 74);\n    var cB = new Coordinate(T.x, T.y);\n\n    for (cC = 0, len = this.LLBAND.length; cC < len; cC++) {\n      if (cB.y >= this.LLBAND[cC]) {\n        cD = this.LL2MC[cC];\n        break;\n      }\n    }\n\n    if (!cD) {\n      for (cC = this.LLBAND.length - 1; cC >= 0; cC--) {\n        if (cB.y <= -this.LLBAND[cC]) {\n          cD = this.LL2MC[cC];\n          break;\n        }\n      }\n    }\n\n    var cE = this.convertor(T, cD, out);\n    return cE;\n  },\n  convertor: function convertor(cC, cD, out) {\n    if (!cC || !cD) {\n      return null;\n    }\n\n    var T = cD[0] + cD[1] * Math.abs(cC.x);\n    var cB = Math.abs(cC.y) / cD[9];\n    var cE = cD[2] + cD[3] * cB + cD[4] * cB * cB + cD[5] * cB * cB * cB + cD[6] * cB * cB * cB * cB + cD[7] * cB * cB * cB * cB * cB + cD[8] * cB * cB * cB * cB * cB * cB;\n    T *= cC.x < 0 ? -1 : 1;\n    cE *= cC.y < 0 ? -1 : 1;\n\n    if (out) {\n      out.x = T;\n      out.y = cE;\n      return out;\n    }\n\n    return new Coordinate(T, cE);\n  },\n  toRadians: function toRadians(T) {\n    return Math.PI * T / 180;\n  },\n  toDegrees: function toDegrees(T) {\n    return 180 * T / Math.PI;\n  },\n  getRange: function getRange(cC, cB, T) {\n    if (cB != null) {\n      cC = Math.max(cC, cB);\n    }\n\n    if (T != null) {\n      cC = Math.min(cC, T);\n    }\n\n    return cC;\n  },\n  getLoop: function getLoop(cC, cB, T) {\n    if (cC === Infinity) {\n      return T;\n    } else if (cC === -Infinity) {\n      return cB;\n    }\n\n    while (cC > T) {\n      cC -= T - cB;\n    }\n\n    while (cC < cB) {\n      cC += T - cB;\n    }\n\n    return cC;\n  }\n});\n\nvar Projection_IDENTITY = extend({}, Common, {\n  code: 'IDENTITY',\n  project: function project(p, out) {\n    if (out) {\n      out.x = p.x;\n      out.y = p.y;\n      return out;\n    }\n\n    return p.copy();\n  },\n  unproject: function unproject(p, out) {\n    if (out) {\n      out.x = p.x;\n      out.y = p.y;\n      return out;\n    }\n\n    return p.copy();\n  }\n}, Identity);\n\nvar DEFAULT$1 = EPSG3857;\n\nvar projections = /*#__PURE__*/Object.freeze({\n  EPSG3857: EPSG3857,\n  DEFAULT: DEFAULT$1,\n  EPSG4326: PROJ4326,\n  EPSG4490: Projection_EPSG4490,\n  BAIDU: Projection_Baidu,\n  IDENTITY: Projection_IDENTITY,\n  Common: Common\n});\n\nvar Renderable = (function (Base) {\n  return function (_Base) {\n    _inheritsLoose(_class, _Base);\n\n    function _class() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    _class.registerRenderer = function registerRenderer(name, clazz) {\n      var proto = this.prototype;\n      var parentProto = Object.getPrototypeOf(proto);\n\n      if (!proto._rendererClasses || proto._rendererClasses === parentProto._rendererClasses) {\n        proto._rendererClasses = proto._rendererClasses ? Object.create(proto._rendererClasses) : {};\n      }\n\n      proto._rendererClasses[name.toLowerCase()] = clazz;\n      return this;\n    };\n\n    _class.getRendererClass = function getRendererClass(name) {\n      var proto = this.prototype;\n\n      if (!proto._rendererClasses) {\n        return null;\n      }\n\n      return proto._rendererClasses[name.toLowerCase()];\n    };\n\n    return _class;\n  }(Base);\n});\n\nvar adapters = {};\nfunction registerWorkerAdapter(workerKey, adapter) {\n  adapters[workerKey] = adapter;\n}\nvar header = \"\\n    var adapters = {};\\n    onmessage = function (msg) {\\n        msg = msg.data;\\n        if (msg.messageType === 'batch') {\\n            const messages = msg.messages;\\n            if (messages) {\\n                for (let i = 0; i < messages.length; i++) {\\n                    dispatch(messages[i]);\\n                }\\n            }\\n        } else {\\n            dispatch(msg);\\n        }\\n    };\\n\\n    function dispatch(msg) {\\n        var workerKey = msg.workerKey;\\n        var adapter = adapters[workerKey];\\n        if (!adapter) {\\n            post(msg.callback, 'Unregistered worker adapters for ' + workerKey);\\n            return;\\n        }\\n        try {\\n            adapter.onmessage(msg, wrap(msg.callback));\\n        } catch (err) {\\n            post(msg.callback, workerKey + ':' + err.message);\\n            console.error(err);\\n            throw err;\\n        }\\n    }\\n\\n    function post(callback, err, data, buffers) {\\n        var msg = {\\n            callback : callback\\n        };\\n        if (err) {\\n            msg.error = err;\\n        } else {\\n            msg.data = data;\\n        }\\n        if (buffers && buffers.length > 0) {\\n            postMessage(msg, buffers);\\n        } else {\\n            postMessage(msg);\\n        }\\n    }\\n    function wrap(callback) {\\n        return function (err, data, buffers) {\\n            post(callback, err, data, buffers);\\n        };\\n    }\\n    var workerExports;\\n\";\nvar footer = \"\\n    workerExports = null;\\n\";\n\nfunction compileWorkerSource() {\n  var source = header;\n\n  for (var p in adapters) {\n    var adapter = adapters[p];\n\n    if (isFunction(adapter)) {\n      if (adapter.length === 0) {\n        adapter = adapter();\n      }\n    }\n\n    source += \"\\n    workerExports = {};\\n    (\" + adapter + \")(workerExports, self);\\n    adapters['\" + p + \"'] = workerExports\";\n    source += \"\\n    workerExports.initialize && workerExports.initialize(self);\\n        \";\n  }\n\n  source += footer;\n  return source;\n}\n\nvar url;\nfunction getWorkerSourcePath() {\n  if (typeof window === 'undefined') {\n    return null;\n  }\n\n  if (!url) {\n    var source = compileWorkerSource();\n    url = window.URL.createObjectURL(new Blob([source], {\n      type: 'text/javascript'\n    }));\n    adapters = null;\n  }\n\n  return url;\n}\n\nvar hardwareConcurrency = typeof window !== 'undefined' ? window.navigator.hardwareConcurrency || 4 : 0;\nvar workerCount = Math.max(Math.floor(hardwareConcurrency / 2), 1);\n\nvar MessageBatch = function () {\n  function MessageBatch(limit) {\n    if (limit === void 0) {\n      limit = 50;\n    }\n\n    this._limit = limit;\n    this._messages = [];\n    this.buffers = [];\n  }\n\n  var _proto = MessageBatch.prototype;\n\n  _proto.addMessage = function addMessage(msg, buffers) {\n    this._messages.push(msg);\n\n    if (!Array.isArray(buffers)) {\n      return;\n    }\n\n    for (var i = 0; i < buffers.length; i++) {\n      if (this.buffers.indexOf(buffers[i]) < 0) {\n        this.buffers.push(buffers[i]);\n      }\n    }\n  };\n\n  _proto.isFull = function isFull() {\n    return this._messages.length >= this._limit;\n  };\n\n  _proto.getMessage = function getMessage() {\n    return {\n      messageType: 'batch',\n      messages: this._messages\n    };\n  };\n\n  return MessageBatch;\n}();\n\nvar WorkerPool = function () {\n  function WorkerPool() {\n    this.active = {};\n    this.workerCount = typeof window !== 'undefined' ? window.MAPTALKS_WORKER_COUNT || workerCount : 0;\n    this._messages = [];\n    this._messageBuffers = [];\n  }\n\n  var _proto2 = WorkerPool.prototype;\n\n  _proto2.acquire = function acquire(id) {\n    if (!this.workers) {\n      this.workers = [];\n      var url = getWorkerSourcePath();\n\n      for (var i = 0; i < this.workerCount; i++) {\n        var worker = new Worker(url);\n        worker.id = i;\n        this.workers.push(worker);\n      }\n\n      URL.revokeObjectURL(url);\n    }\n\n    this.active[id] = true;\n    return this.workers.slice();\n  };\n\n  _proto2.release = function release(id) {\n    delete this.active[id];\n\n    if (Object.keys(this.active).length === 0) {\n      this.workers.forEach(function (w) {\n        w.terminate();\n      });\n      this.workers = null;\n    }\n  };\n\n  _proto2.addMessage = function addMessage(workerId, data, buffers) {\n    var batches = this._messages[workerId];\n\n    if (!batches || !batches.length) {\n      batches = this._messages[workerId] = [new MessageBatch()];\n    }\n\n    var batch = batches[batches.length - 1];\n\n    if (batch.isFull()) {\n      batch = new MessageBatch();\n\n      this._messages[workerId].push(batch);\n    }\n\n    batch.addMessage(data, buffers);\n  };\n\n  _proto2.commit = function commit() {\n    if (this._messages.length) {\n      for (var i = 0; i < this._messages.length; i++) {\n        if (!this._messages[i] || !this._messages[i].length) {\n          continue;\n        }\n\n        var batch = this._messages[i].shift();\n\n        this.workers[i].postMessage(batch.getMessage(), batch.buffers);\n      }\n    }\n  };\n\n  return WorkerPool;\n}();\nvar globalWorkerPool;\nfunction getGlobalWorkerPool() {\n  if (!globalWorkerPool) {\n    globalWorkerPool = new WorkerPool();\n  }\n\n  return globalWorkerPool;\n}\n\nvar dedicatedWorker = 0;\nvar EMPTY_BUFFERS = [];\n\nvar Actor = function () {\n  function Actor(workerKey) {\n    var _this = this;\n\n    this.workerKey = workerKey;\n    this.workerPool = getGlobalWorkerPool();\n    this.currentActor = 0;\n    this.actorId = UID();\n    this.workers = this.workerPool.acquire(this.actorId);\n    this.callbacks = {};\n    this.callbackID = 0;\n    this.receiveFn = this.receive.bind(this);\n    this.workers.forEach(function (w) {\n      w.addEventListener('message', _this.receiveFn, false);\n    });\n  }\n\n  var _proto = Actor.prototype;\n\n  _proto.isActive = function isActive() {\n    return !!this.workers;\n  };\n\n  _proto.broadcast = function broadcast(data, buffers, cb) {\n    var _this2 = this;\n\n    cb = cb || function () {};\n\n    asyncAll(this.workers, function (worker, done) {\n      _this2.send(data, buffers, done, worker.id);\n    }, cb);\n    return this;\n  };\n\n  _proto.send = function send(data, buffers, cb, workerId) {\n    var id = cb ? this.actorId + \":\" + this.callbackID++ : null;\n    if (cb) this.callbacks[id] = cb;\n    this.post({\n      data: data,\n      callback: String(id)\n    }, buffers, workerId);\n    return this;\n  };\n\n  _proto.receive = function receive(message) {\n    var _this3 = this;\n\n    var data = message.data,\n        id = data.callback;\n    var callback = this.callbacks[id];\n    delete this.callbacks[id];\n\n    if (data.type === '<request>') {\n      if (this.actorId === data.actorId) {\n        this[data.command](data.params, function (err, cbData, buffers) {\n          var message = {\n            type: '<response>',\n            callback: data.callback\n          };\n\n          if (err) {\n            message.error = err.message;\n          } else {\n            message.data = cbData;\n          }\n\n          _this3.post(message, buffers || EMPTY_BUFFERS, data.workerId);\n        });\n      }\n    } else if (callback && data.error) {\n      callback(data.error);\n    } else if (callback) {\n      callback(null, data.data);\n    }\n  };\n\n  _proto.remove = function remove() {\n    var _this4 = this;\n\n    this.workers.forEach(function (w) {\n      w.removeEventListener('message', _this4.receiveFn, false);\n    });\n    this.workerPool.release(this.actorId);\n    delete this.receiveFn;\n    delete this.workers;\n    delete this.callbacks;\n    delete this.workerPool;\n  };\n\n  _proto.post = function post(data, buffers, targetID) {\n    if (typeof targetID !== 'number' || isNaN(targetID)) {\n      targetID = this.currentActor = (this.currentActor + 1) % this.workerPool.workerCount;\n    }\n\n    data.workerId = targetID;\n    data.workerKey = this.workerKey;\n    data.actorId = this.actorId;\n    this.workerPool.addMessage(targetID, data, buffers || EMPTY_BUFFERS);\n    return targetID;\n  };\n\n  _proto.getDedicatedWorker = function getDedicatedWorker() {\n    dedicatedWorker = (dedicatedWorker + 1) % this.workerPool.workerCount;\n    return dedicatedWorker;\n  };\n\n  return Actor;\n}();\n\nfunction asyncAll(array, fn, callback) {\n  if (!array.length) {\n    callback(null, []);\n  }\n\n  var remaining = array.length;\n  var results = new Array(array.length);\n  var error = null;\n  array.forEach(function (item, i) {\n    fn(item, function (err, result) {\n      if (err) error = err;\n      results[i] = result;\n      if (--remaining === 0) callback(error, results);\n    });\n  });\n}\n\nvar imageFetchWorkerKey = 'core-fetch-image';\n\nvar EMPTY_ARRAY = [];\n\nvar ResourceWorkerConnection = function (_Actor) {\n  _inheritsLoose(ResourceWorkerConnection, _Actor);\n\n  function ResourceWorkerConnection() {\n    return _Actor.call(this, imageFetchWorkerKey) || this;\n  }\n\n  var _proto = ResourceWorkerConnection.prototype;\n\n  _proto.fetchImage = function fetchImage(url, cb) {\n    var data = {\n      url: url\n    };\n    this.send(data, EMPTY_ARRAY, cb);\n  };\n\n  return ResourceWorkerConnection;\n}(Actor);\n\nvar CanvasRenderer = function (_Class) {\n  _inheritsLoose(CanvasRenderer, _Class);\n\n  function CanvasRenderer(layer) {\n    var _this;\n\n    _this = _Class.call(this) || this;\n    _this.layer = layer;\n    _this._painted = false;\n    _this._drawTime = 0;\n\n    if (Browser$1.decodeImageInWorker) {\n      _this._resWorkerConn = new ResourceWorkerConnection();\n    }\n\n    _this.setToRedraw();\n\n    return _this;\n  }\n\n  var _proto2 = CanvasRenderer.prototype;\n\n  _proto2.render = function render(framestamp) {\n    this.prepareRender();\n\n    if (!this.getMap() || !this.layer.isVisible()) {\n      return;\n    }\n\n    if (!this.resources) {\n      this.resources = new ResourceCache();\n    }\n\n    this.checkAndDraw(this._tryToDraw, framestamp);\n  };\n\n  _proto2.checkAndDraw = function checkAndDraw(drawFn) {\n    var _this2 = this;\n\n    this._toRedraw = false;\n\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    if (this.checkResources) {\n      var resources = this.checkResources();\n\n      if (resources.length > 0) {\n        this._loadingResource = true;\n        this.loadResources(resources).then(function () {\n          _this2._loadingResource = false;\n\n          if (_this2.layer) {\n            _this2.layer.fire('resourceload');\n\n            _this2.setToRedraw();\n          }\n        });\n      } else {\n        drawFn.call.apply(drawFn, [this].concat(args));\n      }\n    } else {\n      drawFn.call.apply(drawFn, [this].concat(args));\n    }\n  };\n\n  _proto2.testIfNeedRedraw = function testIfNeedRedraw() {\n    var map = this.getMap();\n\n    if (this._loadingResource) {\n      return false;\n    }\n\n    if (this._toRedraw) {\n      return true;\n    }\n\n    if (map.isInteracting() && !this.drawOnInteracting) {\n      return false;\n    }\n\n    if (this.needToRedraw()) {\n      return true;\n    }\n\n    return false;\n  };\n\n  _proto2.needToRedraw = function needToRedraw() {\n    var map = this.getMap();\n\n    if (map.isInteracting() || map.getRenderer().isViewChanged()) {\n      return !(!map.getPitch() && map.isMoving() && !map.isZooming() && !map.isRotating() && !this.layer.options['forceRenderOnMoving']);\n    }\n\n    return false;\n  };\n\n  _proto2.onSkipDrawOnInteracting = function onSkipDrawOnInteracting() {};\n\n  _proto2.isLoadingResource = function isLoadingResource() {\n    return this._loadingResource;\n  };\n\n  _proto2.isRenderComplete = function isRenderComplete() {\n    return !!this._renderComplete;\n  };\n\n  _proto2.mustRenderOnInteracting = function mustRenderOnInteracting() {\n    return !this._painted;\n  };\n\n  _proto2.setToRedraw = function setToRedraw() {\n    this._toRedraw = true;\n    return this;\n  };\n\n  _proto2.setCanvasUpdated = function setCanvasUpdated() {\n    this._canvasUpdated = true;\n    return this;\n  };\n\n  _proto2.isCanvasUpdated = function isCanvasUpdated() {\n    return !!this._canvasUpdated;\n  };\n\n  _proto2.remove = function remove() {\n    this.onRemove();\n    delete this._loadingResource;\n    delete this.southWest;\n    delete this.canvas;\n    delete this.context;\n    delete this.canvasExtent2D;\n    delete this._extent2D;\n\n    if (this.resources) {\n      this.resources.remove();\n    }\n\n    delete this.resources;\n    delete this.layer;\n  };\n\n  _proto2.onRemove = function onRemove() {};\n\n  _proto2.onAdd = function onAdd() {};\n\n  _proto2.getMap = function getMap() {\n    if (!this.layer) {\n      return null;\n    }\n\n    return this.layer.getMap();\n  };\n\n  _proto2.getCanvasImage = function getCanvasImage() {\n    var map = this.getMap();\n    this._canvasUpdated = false;\n\n    if (this._renderZoom !== map.getZoom() || !this.canvas || !this._extent2D) {\n      return null;\n    }\n\n    if (this.isBlank()) {\n      return null;\n    }\n\n    if (this.layer.isEmpty && this.layer.isEmpty()) {\n      return null;\n    }\n\n    var containerPoint = map._pointToContainerPoint(this.southWest)._add(0, -map.height);\n\n    return {\n      'image': this.canvas,\n      'layer': this.layer,\n      'point': containerPoint\n    };\n  };\n\n  _proto2.clear = function clear() {\n    this.clearCanvas();\n  };\n\n  _proto2.isBlank = function isBlank() {\n    if (!this._painted) {\n      return true;\n    }\n\n    return false;\n  };\n\n  _proto2.show = function show() {\n    this.setToRedraw();\n  };\n\n  _proto2.hide = function hide() {\n    this.clear();\n    this.setToRedraw();\n  };\n\n  _proto2.setZIndex = function setZIndex() {\n    this.setToRedraw();\n  };\n\n  _proto2.hitDetect = function hitDetect(point) {\n    if (!this.context || this.layer.isEmpty && this.layer.isEmpty() || this.isBlank() || this._errorThrown) {\n      return false;\n    }\n\n    var map = this.getMap();\n    var r = map.getDevicePixelRatio();\n    var size = map.getSize();\n\n    if (point.x < 0 || point.x > size['width'] * r || point.y < 0 || point.y > size['height'] * r) {\n      return false;\n    }\n\n    var imageData = this.getImageData && this.getImageData();\n\n    if (imageData) {\n      var x = r * point.x,\n          y = r * point.y;\n      var idx = y * imageData.width * 4 + x * 4;\n      return imageData.data[idx + 3] > 0;\n    }\n\n    try {\n      var imgData = this.context.getImageData(r * point.x, r * point.y, 1, 1).data;\n\n      if (imgData[3] > 0) {\n        return true;\n      }\n    } catch (error) {\n      if (!this._errorThrown) {\n        if (console) {\n          console.warn('hit detect failed with tainted canvas, some geometries have external resources in another domain:\\n', error);\n        }\n\n        this._errorThrown = true;\n      }\n\n      return false;\n    }\n\n    return false;\n  };\n\n  _proto2.loadResources = function loadResources(resourceUrls) {\n    if (!this.resources) {\n      this.resources = new ResourceCache();\n    }\n\n    var resources = this.resources,\n        promises = [];\n\n    if (isArrayHasData(resourceUrls)) {\n      var cache = {};\n\n      for (var i = resourceUrls.length - 1; i >= 0; i--) {\n        var url = resourceUrls[i];\n\n        if (!url || !url.length || cache[url.join('-')]) {\n          continue;\n        }\n\n        cache[url.join('-')] = 1;\n\n        if (!resources.isResourceLoaded(url, true)) {\n          promises.push(new Promise$1(this._promiseResource(url)));\n        }\n      }\n    }\n\n    return Promise$1.all(promises);\n  };\n\n  _proto2.prepareRender = function prepareRender() {\n    delete this._renderComplete;\n    var map = this.getMap();\n    this._renderZoom = map.getZoom();\n    this.canvasExtent2D = this._extent2D = map._get2DExtent();\n    this.southWest = map._containerPointToPoint(new Point(0, map.height));\n  };\n\n  _proto2.createCanvas = function createCanvas() {\n    if (this.canvas) {\n      return;\n    }\n\n    var map = this.getMap();\n    var size = map.getSize();\n    var r = map.getDevicePixelRatio(),\n        w = Math.round(r * size.width),\n        h = Math.round(r * size.height);\n\n    if (this.layer._canvas) {\n      var canvas = this.layer._canvas;\n      canvas.width = w;\n      canvas.height = h;\n\n      if (canvas.style) {\n        canvas.style.width = size.width + 'px';\n        canvas.style.height = size.height + 'px';\n      }\n\n      this.canvas = this.layer._canvas;\n    } else {\n      this.canvas = Canvas.createCanvas(w, h, map.CanvasClass);\n    }\n\n    this.onCanvasCreate();\n  };\n\n  _proto2.onCanvasCreate = function onCanvasCreate() {};\n\n  _proto2.createContext = function createContext() {\n    if (this.gl && this.gl.canvas === this.canvas || this.context) {\n      return;\n    }\n\n    this.context = this.canvas.getContext('2d');\n\n    if (!this.context) {\n      return;\n    }\n\n    if (this.layer.options['globalCompositeOperation']) {\n      this.context.globalCompositeOperation = this.layer.options['globalCompositeOperation'];\n    }\n\n    var dpr = this.getMap().getDevicePixelRatio();\n\n    if (dpr !== 1) {\n      this.context.scale(dpr, dpr);\n    }\n  };\n\n  _proto2.resetCanvasTransform = function resetCanvasTransform() {\n    if (!this.context) {\n      return;\n    }\n\n    var dpr = this.getMap().getDevicePixelRatio();\n    this.context.setTransform(dpr, 0, 0, dpr, 0, 0);\n  };\n\n  _proto2.resizeCanvas = function resizeCanvas(canvasSize) {\n    var canvas = this.canvas;\n\n    if (!canvas) {\n      return;\n    }\n\n    var size = canvasSize || this.getMap().getSize();\n    var r = this.getMap().getDevicePixelRatio();\n\n    var _calCanvasSize = calCanvasSize(size, r),\n        width = _calCanvasSize.width,\n        height = _calCanvasSize.height,\n        cssWidth = _calCanvasSize.cssWidth,\n        cssHeight = _calCanvasSize.cssHeight;\n\n    if (this.layer._canvas && (canvas.style.width !== cssWidth || canvas.style.height !== cssHeight)) {\n      canvas.style.width = cssWidth;\n      canvas.style.height = cssHeight;\n    }\n\n    if (canvas.width === width && canvas.height === height) {\n      return;\n    }\n\n    canvas.height = height;\n    canvas.width = width;\n\n    if (r !== 1 && this.context) {\n      this.context.scale(r, r);\n    }\n  };\n\n  _proto2.clearCanvas = function clearCanvas() {\n    if (!this.context || !this.getMap()) {\n      return;\n    }\n\n    var r = this.getMap().getDevicePixelRatio();\n    var rScale = 1 / r;\n    var w = this.canvas.width * rScale,\n        h = this.canvas.height * rScale;\n    Canvas.clearRect(this.context, 0, 0, Math.max(w, this.canvas.width), Math.max(h, this.canvas.height));\n  };\n\n  _proto2.prepareCanvas = function prepareCanvas() {\n    if (!this.canvas) {\n      this.createCanvas();\n      this.createContext();\n      this.layer.onCanvasCreate();\n      this.layer.fire('canvascreate', {\n        'context': this.context,\n        'gl': this.gl\n      });\n    } else {\n      this.resetCanvasTransform();\n      this.clearCanvas();\n      this.resizeCanvas();\n    }\n\n    delete this._maskExtent;\n    var mask = this.layer.getMask();\n\n    if (!mask) {\n      this.layer.fire('renderstart', {\n        'context': this.context,\n        'gl': this.gl\n      });\n      return null;\n    }\n\n    var maskExtent2D = this._maskExtent = mask._getMaskPainter().get2DExtent();\n\n    if (!maskExtent2D.intersects(this._extent2D)) {\n      this.layer.fire('renderstart', {\n        'context': this.context,\n        'gl': this.gl\n      });\n      return maskExtent2D;\n    }\n\n    this.layer.fire('renderstart', {\n      'context': this.context,\n      'gl': this.gl\n    });\n    return maskExtent2D;\n  };\n\n  _proto2.clipCanvas = function clipCanvas(context) {\n    var mask = this.layer.getMask();\n\n    if (!mask) {\n      return false;\n    }\n\n    var old = this.southWest;\n    var map = this.getMap();\n    this.southWest = map._containerPointToPoint(new Point(0, map.height));\n    context.save();\n    var dpr = map.getDevicePixelRatio();\n\n    if (dpr !== 1) {\n      context.save();\n      context.scale(dpr, dpr);\n    }\n\n    if (mask.getGeometries) {\n      context.isMultiClip = true;\n      var masks = mask.getGeometries() || [];\n      context.beginPath();\n      masks.forEach(function (_mask) {\n        var painter = _mask._getMaskPainter();\n\n        painter.paint(null, context);\n      });\n      context.stroke();\n      delete context.isMultiClip;\n    } else {\n      var painter = mask._getMaskPainter();\n\n      painter.paint(null, context);\n    }\n\n    if (dpr !== 1) {\n      context.restore();\n    }\n\n    context.clip();\n    this.southWest = old;\n    return true;\n  };\n\n  _proto2.getViewExtent = function getViewExtent() {\n    return {\n      'extent': this._extent2D,\n      'maskExtent': this._maskExtent,\n      'zoom': this._renderZoom,\n      'southWest': this.southWest\n    };\n  };\n\n  _proto2.completeRender = function completeRender() {\n    if (this.getMap()) {\n      this._renderComplete = true;\n      this.layer.fire('renderend', {\n        'context': this.context,\n        'gl': this.gl\n      });\n      this.setCanvasUpdated();\n    }\n  };\n\n  _proto2.getEvents = function getEvents() {\n    return {\n      '_zoomstart': this.onZoomStart,\n      '_zooming': this.onZooming,\n      '_zoomend': this.onZoomEnd,\n      '_resize': this.onResize,\n      '_movestart': this.onMoveStart,\n      '_moving': this.onMoving,\n      '_moveend': this.onMoveEnd,\n      '_dragrotatestart': this.onDragRotateStart,\n      '_dragrotating': this.onDragRotating,\n      '_dragrotateend': this.onDragRotateEnd,\n      '_spatialreferencechange': this.onSpatialReferenceChange\n    };\n  };\n\n  _proto2.onZoomStart = function onZoomStart() {};\n\n  _proto2.onZoomEnd = function onZoomEnd() {\n    this.setToRedraw();\n  };\n\n  _proto2.onZooming = function onZooming() {};\n\n  _proto2.onMoveStart = function onMoveStart() {};\n\n  _proto2.onMoving = function onMoving() {};\n\n  _proto2.onMoveEnd = function onMoveEnd() {\n    this.setToRedraw();\n  };\n\n  _proto2.onResize = function onResize() {\n    delete this._extent2D;\n    this.resizeCanvas();\n    this.setToRedraw();\n  };\n\n  _proto2.onDragRotateStart = function onDragRotateStart() {};\n\n  _proto2.onDragRotating = function onDragRotating() {};\n\n  _proto2.onDragRotateEnd = function onDragRotateEnd() {\n    this.setToRedraw();\n  };\n\n  _proto2.onSpatialReferenceChange = function onSpatialReferenceChange() {};\n\n  _proto2.getDrawTime = function getDrawTime() {\n    return this._drawTime;\n  };\n\n  _proto2._tryToDraw = function _tryToDraw(framestamp) {\n    this._toRedraw = false;\n\n    if (!this.canvas && this.layer.isEmpty && this.layer.isEmpty()) {\n      this._renderComplete = true;\n      return;\n    }\n\n    this._drawAndRecord(framestamp);\n  };\n\n  _proto2._drawAndRecord = function _drawAndRecord(framestamp) {\n    if (!this.getMap()) {\n      return;\n    }\n\n    var painted = this._painted;\n    this._painted = true;\n    var t = now();\n    this.draw(framestamp);\n    t = now() - t;\n    this._drawTime = painted ? t : t / 2;\n\n    if (painted && this.layer && this.layer.options['logDrawTime']) {\n      console.log(this.layer.getId(), 'frameTimeStamp:', framestamp, 'drawTime:', this._drawTime);\n    }\n  };\n\n  _proto2._promiseResource = function _promiseResource(url) {\n    var me = this,\n        resources = this.resources,\n        crossOrigin = this.layer.options['crossOrigin'];\n    var renderer = this.layer.options['renderer'] || '';\n    return function (resolve) {\n      if (resources.isResourceLoaded(url, true)) {\n        resolve(url);\n        return;\n      }\n\n      if (!isSVG(url[0]) && Browser$1.decodeImageInWorker) {\n        var uri = getAbsoluteURL(url[0]);\n\n        me._resWorkerConn.fetchImage(uri, function (err, data) {\n          if (err) {\n            if (err && typeof console !== 'undefined') {\n              console.warn(err);\n            }\n\n            resolve(url);\n            return;\n          }\n\n          getImageBitMap(data, function (bitmap) {\n            me._cacheResource(url, bitmap);\n\n            resolve(url);\n          });\n        });\n      } else {\n        var img = new Image();\n\n        if (!isNil(crossOrigin)) {\n          img['crossOrigin'] = crossOrigin;\n        } else if (renderer !== 'canvas') {\n          img['crossOrigin'] = '';\n        }\n\n        if (isSVG(url[0]) && !IS_NODE) {\n          if (url[1]) {\n            url[1] *= 2;\n          }\n\n          if (url[2]) {\n            url[2] *= 2;\n          }\n        }\n\n        img.onload = function () {\n          me._cacheResource(url, img);\n\n          resolve(url);\n        };\n\n        img.onabort = function (err) {\n          if (console) {\n            console.warn('image loading aborted: ' + url[0]);\n          }\n\n          if (err) {\n            if (console) {\n              console.warn(err);\n            }\n          }\n\n          resolve(url);\n        };\n\n        img.onerror = function (err) {\n          if (err && typeof console !== 'undefined') {\n            console.warn(err);\n          }\n\n          resources.markErrorResource(url);\n          resolve(url);\n        };\n\n        loadImage(img, url);\n      }\n    };\n  };\n\n  _proto2._cacheResource = function _cacheResource(url, img) {\n    if (!this.layer || !this.resources) {\n      return;\n    }\n\n    var w = url[1],\n        h = url[2];\n\n    if (this.layer.options['cacheSvgOnCanvas'] && isSVG(url[0]) === 1 && (Browser$1.edge || Browser$1.ie)) {\n      if (isNil(w)) {\n        w = img.width || this.layer.options['defaultIconSize'][0];\n      }\n\n      if (isNil(h)) {\n        h = img.height || this.layer.options['defaultIconSize'][1];\n      }\n\n      var canvas = Canvas.createCanvas(w, h);\n      Canvas.image(canvas.getContext('2d'), img, 0, 0, w, h);\n      img = canvas;\n    }\n\n    this.resources.addResource(url, img);\n  };\n\n  return CanvasRenderer;\n}(Class);\nvar ResourceCache = function () {\n  function ResourceCache() {\n    this.resources = {};\n    this._errors = {};\n  }\n\n  var _proto3 = ResourceCache.prototype;\n\n  _proto3.addResource = function addResource(url, img) {\n    var _this3 = this;\n\n    this.resources[url[0]] = {\n      image: img,\n      width: +url[1],\n      height: +url[2],\n      refCnt: 0\n    };\n\n    if (img && !img.close && Browser$1.imageBitMap) {\n      if (img.src && isSVG(img.src)) {\n        return;\n      }\n\n      createImageBitmap(img).then(function (imageBitmap) {\n        if (!_this3.resources[url[0]]) {\n          return;\n        }\n\n        _this3.resources[url[0]].image = imageBitmap;\n      });\n    }\n  };\n\n  _proto3.isResourceLoaded = function isResourceLoaded(url, checkSVG) {\n    if (!url) {\n      return false;\n    }\n\n    var imgUrl = this._getImgUrl(url);\n\n    if (this._errors[imgUrl]) {\n      return true;\n    }\n\n    var img = this.resources[imgUrl];\n\n    if (!img) {\n      return false;\n    }\n\n    if (checkSVG && isSVG(url[0]) && (+url[1] > img.width || +url[2] > img.height)) {\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto3.login = function login(url) {\n    var res = this.resources[url];\n\n    if (res) {\n      res.refCnt++;\n    }\n  };\n\n  _proto3.logout = function logout(url) {\n    var res = this.resources[url];\n\n    if (res && res.refCnt-- <= 0) {\n      delete this.resources[url];\n    }\n  };\n\n  _proto3.getImage = function getImage(url) {\n    var imgUrl = this._getImgUrl(url);\n\n    if (!this.isResourceLoaded(url) || this._errors[imgUrl]) {\n      return null;\n    }\n\n    return this.resources[imgUrl].image;\n  };\n\n  _proto3.markErrorResource = function markErrorResource(url) {\n    this._errors[this._getImgUrl(url)] = 1;\n  };\n\n  _proto3.merge = function merge(res) {\n    if (!res) {\n      return this;\n    }\n\n    for (var p in res.resources) {\n      var img = res.resources[p];\n      this.addResource([p, img.width, img.height], img.image);\n    }\n\n    return this;\n  };\n\n  _proto3.forEach = function forEach(fn) {\n    if (!this.resources) {\n      return this;\n    }\n\n    for (var p in this.resources) {\n      if (hasOwn(this.resources, p)) {\n        fn(p, this.resources[p]);\n      }\n    }\n\n    return this;\n  };\n\n  _proto3._getImgUrl = function _getImgUrl(url) {\n    if (!Array.isArray(url)) {\n      return url;\n    }\n\n    return url[0];\n  };\n\n  _proto3.remove = function remove() {\n    for (var p in this.resources) {\n      var res = this.resources[p];\n\n      if (res && res.image && res.image.close) {\n        res.image.close();\n      }\n    }\n\n    this.resources = {};\n  };\n\n  return ResourceCache;\n}();\n\nvar DEFAULT_MARKER_SYMBOLS = {\n  markerWidth: 10,\n  markerHeight: 10,\n  markerLineWidth: 1\n};\n\nfunction getVectorPadding() {\n  return 0.5;\n}\n\nvar DXDY = new Point(0, 0);\n\nfunction getFixedExtent(out, dx, dy, rotation, alignPoint, w, h) {\n  var dxdy = DXDY.set(dx, dy);\n  var result = out.set(dxdy.x, dxdy.y, dxdy.x + w, dxdy.y + h);\n\n  result._add(alignPoint);\n\n  if (rotation) {\n    rotateExtent(result, rotation);\n  }\n\n  return result;\n}\n\nvar SIZE = [];\nfunction getVectorMarkerFixedExtent(out, symbol, size) {\n  size = size || calVectorMarkerSize(SIZE, symbol);\n  var alignPoint = getVectorMarkerAnchor(symbol, size[0], size[1]);\n  return getFixedExtent(out, symbol['markerDx'] || 0, symbol['markerDy'] || 0, getMarkerRotation(symbol), alignPoint, size[0], size[1]);\n}\nfunction getDefaultHAlign(markerType) {\n  if (markerType === 'rectangle') {\n    return 'right';\n  } else {\n    return 'middle';\n  }\n}\nfunction getDefaultVAlign(markerType) {\n  if (markerType === 'bar' || markerType === 'pie' || markerType === 'pin') {\n    return 'top';\n  } else if (markerType === 'rectangle') {\n    return 'bottom';\n  } else {\n    return 'middle';\n  }\n}\nvar TEMP_SIZE = new Size(0, 0);\nfunction getVectorMarkerAnchor(symbol, w, h) {\n  var padding = getVectorPadding();\n  var shadow = 2 * (symbol['shadowBlur'] || 0),\n      margin = shadow + padding;\n  TEMP_SIZE.width = w;\n  TEMP_SIZE.height = h;\n  var markerType = symbol['markerType'];\n  var p = getAlignPoint(TEMP_SIZE, symbol['markerHorizontalAlignment'] || getDefaultHAlign(markerType), symbol['markerVerticalAlignment'] || getDefaultVAlign(markerType));\n\n  if (p.x !== -w / 2) {\n    p.x -= sign(p.x + w / 2) * margin;\n  }\n\n  if (p.y !== -h / 2) {\n    p.y -= sign(p.y + h / 2) * margin;\n  }\n\n  return p;\n}\nfunction calVectorMarkerSize(out, symbol) {\n  var padding = getVectorPadding(symbol);\n  var width = getValueOrDefault(symbol['markerWidth'], DEFAULT_MARKER_SYMBOLS.markerWidth);\n  var height = getValueOrDefault(symbol['markerHeight'], DEFAULT_MARKER_SYMBOLS.markerHeight);\n  var lineWidth = getValueOrDefault(symbol['markerLineWidth'], DEFAULT_MARKER_SYMBOLS.markerLineWidth),\n      shadow = 2 * ((symbol['shadowBlur'] || 0) + Math.max(Math.abs(symbol['shadowOffsetX'] || 0) + Math.abs(symbol['shadowOffsetY'] || 0))),\n      w = Math.round(width + lineWidth + shadow + padding * 2),\n      h = Math.round(height + lineWidth + shadow + padding * 2);\n  out[0] = w;\n  out[1] = h;\n  return out;\n}\nvar ROTATE_EXTENT = new PointExtent();\n\nfunction rotateExtent(fixedExtent, angle) {\n  var xmin = fixedExtent.xmin,\n      ymin = fixedExtent.ymin,\n      xmax = fixedExtent.xmax,\n      ymax = fixedExtent.ymax;\n  ROTATE_EXTENT.set(xmin, ymin, xmax, ymax);\n  return ROTATE_EXTENT.convertTo(function (p) {\n    return p._rotate(angle);\n  }, fixedExtent);\n}\n\nfunction getMarkerRotation(symbol, prop) {\n  if (prop === void 0) {\n    prop = 'markerRotation';\n  }\n\n  var r = symbol[prop];\n\n  if (!isNumber(r)) {\n    return 0;\n  }\n\n  return -r * Math.PI / 180;\n}\nfunction getImageMarkerFixedExtent(out, symbol, resources) {\n  var url = symbol['markerFile'],\n      img = resources ? resources.getImage(url) : null;\n  var width = symbol['markerWidth'] || (img ? img.width : 0),\n      height = symbol['markerHeight'] || (img ? img.height : 0);\n  TEMP_SIZE.width = width;\n  TEMP_SIZE.height = height;\n  var alignPoint = getAlignPoint(TEMP_SIZE, symbol['markerHorizontalAlignment'] || 'middle', symbol['markerVerticalAlignment'] || 'top');\n  return getFixedExtent(out, symbol['markerDx'] || 0, symbol['markerDy'] || 0, getMarkerRotation(symbol), alignPoint, width, height);\n}\nfunction getTextMarkerFixedExtent(out, symbol, textDesc) {\n  var size = textDesc['size'];\n  var alignPoint = getAlignPoint(size, symbol['textHorizontalAlignment'], symbol['textVerticalAlignment']);\n\n  if (symbol['textHaloRadius']) {\n    var r = symbol['textHaloRadius'];\n    size = size.add(r * 2, r * 2);\n  }\n\n  return getFixedExtent(out, symbol['textDx'] || 0, symbol['textDy'] || 0, getMarkerRotation(symbol, 'textRotation'), alignPoint, size.width, size.height);\n}\nvar FIXED_EXTENT = new PointExtent();\nfunction getMarkerFixedExtent(out, symbol, resources, textDesc) {\n  var extent = out || new PointExtent();\n\n  if (Array.isArray(symbol)) {\n    var symbols = symbol;\n\n    for (var i = 0; i < symbols.length; i++) {\n      getMarkerFixedExtent(extent, symbols[i], resources, textDesc[i]);\n    }\n\n    return extent;\n  }\n\n  if (isTextSymbol(symbol)) {\n    extent._combine(getTextMarkerFixedExtent(FIXED_EXTENT, symbol, textDesc));\n  }\n\n  if (isImageSymbol(symbol)) {\n    extent._combine(getImageMarkerFixedExtent(FIXED_EXTENT, symbol, resources));\n  }\n\n  if (isVectorSymbol(symbol)) {\n    extent._combine(getVectorMarkerFixedExtent(FIXED_EXTENT, symbol));\n  }\n\n  if (isPathSymbol(symbol)) {\n    extent._combine(getImageMarkerFixedExtent(FIXED_EXTENT, symbol));\n  }\n\n  return extent;\n}\nfunction isTextSymbol(symbol) {\n  if (!symbol) {\n    return false;\n  }\n\n  if (!isNil(symbol['textName'])) {\n    return true;\n  }\n\n  return false;\n}\nfunction isImageSymbol(symbol) {\n  if (!symbol) {\n    return false;\n  }\n\n  if (!isNil(symbol['markerFile'])) {\n    return true;\n  }\n\n  return false;\n}\nfunction isVectorSymbol(symbol) {\n  if (!symbol) {\n    return false;\n  }\n\n  if (isNil(symbol['markerFile']) && !isNil(symbol['markerType']) && symbol['markerType'] !== 'path') {\n    return true;\n  }\n\n  return false;\n}\nfunction isPathSymbol(symbol) {\n  if (!symbol) {\n    return false;\n  }\n\n  if (isNil(symbol['markerFile']) && symbol['markerType'] === 'path') {\n    return true;\n  }\n\n  return false;\n}\nvar DYNAMIC_SYMBOL_PROPS = ['markerWidth', 'markerHeight', 'markerHorizontalAlignment', 'markerVerticalAlignment', 'markerDx', 'markerDy', 'textName', 'textSize', 'textDx', 'textDy', 'textVerticalAlignment', 'textHorizontalAlignment', 'textRotation'];\nvar SIZE_SYMBOL_PROPS = ['textName', 'markerType', 'markerFile', 'textHaloRadius', 'shadowBlur', 'shadowOffsetX', 'shadowOffsetY'];\n\nfunction clipLine(points, bounds, round, noCut) {\n  var parts = [];\n  var k = 0,\n      segment;\n\n  for (var j = 0, l = points.length; j < l - 1; j++) {\n    segment = clipSegment(points[j], points[j + 1], bounds, j, round, noCut);\n\n    if (!segment) {\n      continue;\n    }\n\n    parts[k] = parts[k] || [];\n    parts[k].push({\n      'point': segment[0],\n      'index': j\n    });\n\n    if (segment[1] !== points[j + 1] || j === l - 2) {\n      parts[k].push({\n        'point': segment[1],\n        'index': j + 1\n      });\n      k++;\n    }\n  }\n\n  return parts;\n}\n\nvar _lastCode;\n\nfunction clipSegment(a, b, bounds, useLastCode, round, noCut) {\n  var codeA = useLastCode ? _lastCode : _getBitCode(a, bounds),\n      codeB = _getBitCode(b, bounds),\n      codeOut,\n      p,\n      newCode;\n\n  _lastCode = codeB;\n\n  while (true) {\n    if (!(codeA | codeB)) {\n      return [a, b];\n    }\n\n    if (codeA & codeB) {\n      return false;\n    }\n\n    if (noCut) {\n      return [a, b];\n    }\n\n    codeOut = codeA || codeB;\n    p = _getEdgeIntersection(a, b, codeOut, bounds, round);\n    newCode = _getBitCode(p, bounds);\n\n    if (codeOut === codeA) {\n      a = p;\n      codeA = newCode;\n    } else {\n      b = p;\n      codeB = newCode;\n    }\n  }\n}\nfunction clipPolygon(points, bounds, round) {\n  var edges = [1, 4, 2, 8];\n  var clippedPoints, i, j, k, a, b, len, edge, p;\n\n  for (i = 0, len = points.length; i < len; i++) {\n    points[i]._code = _getBitCode(points[i], bounds);\n  }\n\n  for (k = 0; k < 4; k++) {\n    edge = edges[k];\n    clippedPoints = [];\n\n    for (i = 0, len = points.length, j = len - 1; i < len; j = i++) {\n      a = points[i];\n      b = points[j];\n\n      if (!(a._code & edge)) {\n        if (b._code & edge) {\n          p = _getEdgeIntersection(b, a, edge, bounds, round);\n          p._code = _getBitCode(p, bounds);\n          clippedPoints.push(p);\n        }\n\n        clippedPoints.push(a);\n      } else if (!(b._code & edge)) {\n        p = _getEdgeIntersection(b, a, edge, bounds, round);\n        p._code = _getBitCode(p, bounds);\n        clippedPoints.push(p);\n      }\n    }\n\n    points = clippedPoints;\n  }\n\n  return points;\n}\n\nfunction _getEdgeIntersection(a, b, code, bounds, round) {\n  var dx = b.x - a.x,\n      dy = b.y - a.y,\n      min = bounds.getMin(),\n      max = bounds.getMax();\n  var x, y;\n\n  if (code & 8) {\n    x = a.x + dx * (max.y - a.y) / dy;\n    y = max.y;\n  } else if (code & 4) {\n    x = a.x + dx * (min.y - a.y) / dy;\n    y = min.y;\n  } else if (code & 2) {\n    x = max.x;\n    y = a.y + dy * (max.x - a.x) / dx;\n  } else if (code & 1) {\n    x = min.x;\n    y = a.y + dy * (min.x - a.x) / dx;\n  }\n\n  var p = new Point(x, y);\n\n  if (round) {\n    p._round();\n  }\n\n  return p;\n}\n\nfunction _getBitCode(p, bounds) {\n  var code = 0;\n\n  if (p.x < bounds.getMin().x) {\n    code |= 1;\n  } else if (p.x > bounds.getMax().x) {\n    code |= 2;\n  }\n\n  if (p.y < bounds.getMin().y) {\n    code |= 4;\n  } else if (p.y > bounds.getMax().y) {\n    code |= 8;\n  }\n\n  return code;\n}\n\nfunction withInEllipse(point, center, southeast, tolerance) {\n  point = new Point(point);\n  var a = Math.abs(southeast.x - center.x),\n      b = Math.abs(southeast.y - center.y),\n      c = Math.sqrt(Math.abs(a * a - b * b)),\n      xfocus = a >= b;\n  var f1, f2, d;\n\n  if (xfocus) {\n    f1 = new Point(center.x - c, center.y);\n    f2 = new Point(center.x + c, center.y);\n    d = a * 2;\n  } else {\n    f1 = new Point(center.x, center.y - c);\n    f2 = new Point(center.x, center.y + c);\n    d = b * 2;\n  }\n\n  return point.distanceTo(f1) + point.distanceTo(f2) <= d + 2 * tolerance;\n}\n\nvar Symbolizer = function () {\n  function Symbolizer() {}\n\n  var _proto = Symbolizer.prototype;\n\n  _proto.getMap = function getMap() {\n    return this.geometry.getMap();\n  };\n\n  _proto.getPainter = function getPainter() {\n    return this.painter;\n  };\n\n  _proto.isDynamicSize = function isDynamicSize() {\n    return false;\n  };\n\n  Symbolizer.testColor = function testColor(prop) {\n    if (!prop || !isString(prop)) {\n      return false;\n    }\n\n    if (COLOR_PROPERTIES.indexOf(prop) >= 0) {\n      return true;\n    }\n\n    return false;\n  };\n\n  return Symbolizer;\n}();\n\nvar CanvasSymbolizer = function (_Symbolizer) {\n  _inheritsLoose(CanvasSymbolizer, _Symbolizer);\n\n  function CanvasSymbolizer() {\n    return _Symbolizer.apply(this, arguments) || this;\n  }\n\n  var _proto = CanvasSymbolizer.prototype;\n\n  _proto._prepareContext = function _prepareContext(ctx) {\n    if (isFunctionDefinition(this.symbol['opacity'])) {\n      if (!this._opacityFn) {\n        this._opacityFn = interpolated(this.symbol['opacity']);\n      }\n    } else {\n      delete this._opacityFn;\n    }\n\n    if (isNumber(this.symbol['opacity'])) {\n      if (ctx.globalAlpha !== this.symbol['opacity']) {\n        ctx.globalAlpha = this.symbol['opacity'];\n      }\n    } else if (this._opacityFn) {\n      var map = this.getMap();\n      ctx.globalAlpha = this._opacityFn(map.getZoom());\n    } else if (ctx.globalAlpha !== 1) {\n      ctx.globalAlpha = 1;\n    }\n  };\n\n  _proto.prepareCanvas = function prepareCanvas(ctx, style, resources) {\n    if (ctx.setLineDash && isArrayHasData(style['lineDasharray'])) {\n      ctx.setLineDash(style['lineDasharray']);\n    }\n\n    var isHitTesting = this.getPainter().isHitTesting();\n    Canvas.prepareCanvas(ctx, style, resources, isHitTesting);\n  };\n\n  _proto.remove = function remove() {};\n\n  _proto.setZIndex = function setZIndex() {};\n\n  _proto.show = function show() {};\n\n  _proto.hide = function hide() {};\n\n  _proto._defineStyle = function _defineStyle(style) {\n    return loadGeoSymbol(style, this.geometry);\n  };\n\n  return CanvasSymbolizer;\n}(Symbolizer);\n\nfunction getImage(resources, url) {\n  var img = resources && resources.getImage(url);\n  return img || null;\n}\nfunction drawVectorMarker(ctx, point, symbol, resources) {\n  var strokeAndFill = translateMarkerLineAndFill(symbol);\n  var style = symbol,\n      markerType = style['markerType'].toLowerCase(),\n      vectorArray = getVectorMarkerPoints(markerType, style['markerWidth'], style['markerHeight']),\n      lineOpacity = strokeAndFill['lineOpacity'],\n      fillOpacity = strokeAndFill['polygonOpacity'];\n  var gradient = isGradient(strokeAndFill['polygonFill']);\n\n  if (gradient) {\n    var gradientExtent;\n\n    if (isGradient(strokeAndFill['polygonFill'])) {\n      if (!gradientExtent) {\n        gradientExtent = getGraidentExtent(point, style.markerWidth, style.markerHeight);\n      }\n\n      strokeAndFill['polygonGradientExtent'] = gradientExtent;\n    }\n  }\n\n  Canvas.prepareCanvas(ctx, strokeAndFill, resources);\n  var width = style['markerWidth'],\n      height = style['markerHeight'],\n      hLineWidth = style['markerLineWidth'] / 2;\n\n  if (markerType === 'ellipse') {\n    Canvas.ellipse(ctx, point, width / 2, height / 2, height / 2, lineOpacity, fillOpacity);\n  } else if (markerType === 'cross' || markerType === 'x') {\n    for (var j = vectorArray.length - 1; j >= 0; j--) {\n      vectorArray[j]._add(point);\n    }\n\n    Canvas.path(ctx, vectorArray.slice(0, 2), lineOpacity);\n    Canvas.path(ctx, vectorArray.slice(2, 4), lineOpacity);\n  } else if (markerType === 'diamond' || markerType === 'bar' || markerType === 'square' || markerType === 'rectangle' || markerType === 'triangle') {\n    if (markerType === 'bar') {\n      point = point.add(0, -hLineWidth);\n    } else if (markerType === 'rectangle') {\n      point = point.add(hLineWidth, hLineWidth);\n    }\n\n    for (var _j = vectorArray.length - 1; _j >= 0; _j--) {\n      vectorArray[_j]._add(point);\n    }\n\n    Canvas.polygon(ctx, vectorArray, lineOpacity, fillOpacity);\n  } else if (markerType === 'pin') {\n    point = point.add(0, -hLineWidth);\n\n    for (var _j2 = vectorArray.length - 1; _j2 >= 0; _j2--) {\n      vectorArray[_j2]._add(point);\n    }\n\n    var lineCap = ctx.lineCap;\n    ctx.lineCap = 'round';\n    Canvas.bezierCurveAndFill(ctx, vectorArray, lineOpacity, fillOpacity);\n    ctx.lineCap = lineCap;\n  } else if (markerType === 'pie') {\n    point = point.add(0, -hLineWidth);\n    var angle = Math.atan(width / 2 / height) * 180 / Math.PI;\n    var _lineCap = ctx.lineCap;\n    ctx.lineCap = 'round';\n    Canvas.sector(ctx, point, height, [90 - angle, 90 + angle], lineOpacity, fillOpacity);\n    ctx.lineCap = _lineCap;\n  } else {\n    throw new Error('unsupported markerType: ' + markerType);\n  }\n\n  return ctx.canvas;\n}\n\nfunction getGraidentExtent(point, w, h) {\n  var e = new PointExtent();\n\n  e._combine(point);\n\n  e['xmin'] += -w / 2;\n  e['ymin'] += -h / 2;\n  e['xmax'] += w / 2;\n  e['ymax'] += h / 2;\n  return e;\n}\n\nfunction translateMarkerLineAndFill(s) {\n  var result = {\n    'lineColor': s['markerLineColor'],\n    'linePatternFile': s['markerLinePatternFile'],\n    'lineWidth': s['markerLineWidth'],\n    'lineOpacity': s['markerLineOpacity'],\n    'lineDasharray': s['markerLineDasharray'],\n    'lineCap': 'butt',\n    'lineJoin': 'round',\n    'polygonFill': s['markerFill'],\n    'polygonPatternFile': s['markerFillPatternFile'],\n    'polygonOpacity': s['markerFillOpacity']\n  };\n\n  if (result['lineWidth'] === 0) {\n    result['lineOpacity'] = 0;\n  }\n\n  return result;\n}\nfunction getVectorMarkerPoints(markerType, width, height) {\n  var hh = height / 2,\n      hw = width / 2;\n  var left = 0,\n      top = 0;\n  var v0, v1, v2, v3;\n\n  if (markerType === 'triangle') {\n    v0 = new Point(left, top - hh);\n    v1 = new Point(left - hw, top + hh);\n    v2 = new Point(left + hw, top + hh);\n    return [v0, v1, v2];\n  } else if (markerType === 'cross') {\n    v0 = new Point(left - hw, top);\n    v1 = new Point(left + hw, top);\n    v2 = new Point(left, top - hh);\n    v3 = new Point(left, top + hh);\n    return [v0, v1, v2, v3];\n  } else if (markerType === 'diamond') {\n    v0 = new Point(left - hw, top);\n    v1 = new Point(left, top - hh);\n    v2 = new Point(left + hw, top);\n    v3 = new Point(left, top + hh);\n    return [v0, v1, v2, v3];\n  } else if (markerType === 'square') {\n    v0 = new Point(left - hw, top + hh);\n    v1 = new Point(left + hw, top + hh);\n    v2 = new Point(left + hw, top - hh);\n    v3 = new Point(left - hw, top - hh);\n    return [v0, v1, v2, v3];\n  } else if (markerType === 'rectangle') {\n    v0 = new Point(left, top);\n    v1 = v0.add(width, 0);\n    v2 = v0.add(width, height);\n    v3 = v0.add(0, height);\n    return [v0, v1, v2, v3];\n  } else if (markerType === 'x') {\n    v0 = new Point(left - hw, top + hh);\n    v1 = new Point(left + hw, top - hh);\n    v2 = new Point(left + hw, top + hh);\n    v3 = new Point(left - hw, top - hh);\n    return [v0, v1, v2, v3];\n  } else if (markerType === 'bar') {\n    v0 = new Point(left - hw, top - height);\n    v1 = new Point(left + hw, top - height);\n    v2 = new Point(left + hw, top);\n    v3 = new Point(left - hw, top);\n    return [v0, v1, v2, v3];\n  } else if (markerType === 'pin' || markerType === 'pie') {\n    var extWidth = height * Math.atan(hw / hh);\n    v0 = new Point(left, top);\n    v1 = new Point(left - extWidth, top - height);\n    v2 = new Point(left + extWidth, top - height);\n    v3 = new Point(left, top);\n    return [v0, v1, v2, v3];\n  }\n\n  return [];\n}\n\nvar TEMP_POINT0$1 = new Point(0, 0);\nvar TEMP_POINT1 = new Point(0, 0);\nvar TEMP_POINT2 = new Point(0, 0);\nvar TEMP_POINT3 = new Point(0, 0);\n\nvar PointSymbolizer = function (_CanvasSymbolizer) {\n  _inheritsLoose(PointSymbolizer, _CanvasSymbolizer);\n\n  function PointSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    _this = _CanvasSymbolizer.call(this) || this;\n    _this.symbol = symbol;\n    _this.geometry = geometry;\n    _this.painter = painter;\n    return _this;\n  }\n\n  var _proto = PointSymbolizer.prototype;\n\n  _proto.get2DExtent = function get2DExtent() {\n    var map = this.getMap();\n    var glRes = map.getGLRes();\n    var extent = new PointExtent();\n\n    var renderPoints = this._getRenderPoints()[0];\n\n    for (var i = renderPoints.length - 1; i >= 0; i--) {\n      if (renderPoints[i]) {\n        extent._combine(map._pointAtResToPoint(renderPoints[i], glRes));\n      }\n    }\n\n    return extent;\n  };\n\n  _proto.isDynamicSize = function isDynamicSize() {\n    var symbol = this.symbol;\n    return isFunctionDefinition(symbol['markerWidth']) || isFunctionDefinition(symbol['markerHeight']) || isFunctionDefinition(symbol['textSize']);\n  };\n\n  _proto._rotateExtent = function _rotateExtent(fixedExtent, angle) {\n    return fixedExtent.convertTo(function (p) {\n      return p._rotate(angle);\n    });\n  };\n\n  _proto._getRenderPoints = function _getRenderPoints() {\n    var painter = this.getPainter();\n    var placement = painter.isSpriting() ? 'center' : this.getPlacement();\n    return this.getPainter().getRenderPoints(placement);\n  };\n\n  _proto._getRenderContainerPoints = function _getRenderContainerPoints(ignoreAltitude) {\n    var painter = this.getPainter();\n\n    if (painter.isSpriting()) {\n      return this._getRenderPoints()[0];\n    }\n\n    var geometry = this.geometry;\n    var dxdy = this.getDxDy();\n    var cpoints;\n\n    if (geometry._cPoint && !ignoreAltitude) {\n      var p = ignoreAltitude ? TEMP_POINT2 : TEMP_POINT3;\n      p.set(geometry._cPoint.x, geometry._cPoint.y);\n      var containerOffset = painter.containerOffset;\n\n      p._sub(containerOffset);\n\n      var dx = dxdy.x,\n          dy = dxdy.y;\n\n      if (dx || dy) {\n        p._add(dx || 0, dy || 0);\n      }\n\n      cpoints = [p];\n    } else {\n      var points = this._getRenderPoints()[0];\n\n      cpoints = this.painter._pointContainerPoints(points, dxdy.x, dxdy.y, ignoreAltitude, true, this.getPlacement());\n    }\n\n    if (!cpoints || !Array.isArray(cpoints[0])) {\n      return cpoints;\n    }\n\n    var flat = [];\n\n    for (var i = 0, l = cpoints.length; i < l; i++) {\n      for (var ii = 0, ll = cpoints[i].length; ii < ll; ii++) {\n        flat.push(cpoints[i][ii]);\n      }\n    }\n\n    return flat;\n  };\n\n  _proto.getPlacement = function getPlacement() {\n    return this.symbol['markerPlacement'];\n  };\n\n  _proto.getRotation = function getRotation() {\n    return getMarkerRotation(this.style);\n  };\n\n  _proto.getDxDy = function getDxDy() {\n    var s = this.style;\n    var dx = s['markerDx'],\n        dy = s['markerDy'];\n    return new Point(dx, dy);\n  };\n\n  _proto._getRotationAt = function _getRotationAt(i) {\n    var r = this.getRotation();\n\n    if (!r) {\n      r = 0;\n    }\n\n    var rotations = this._getRenderPoints()[1];\n\n    if (!rotations || !rotations[i]) {\n      return r;\n    }\n\n    var map = this.getMap();\n    var p0 = rotations[i][0],\n        p1 = rotations[i][1];\n\n    if (map.isTransforming()) {\n      var glRes = map.getGLRes();\n      p0 = map._pointAtResToContainerPoint(rotations[i][0], glRes, 0, TEMP_POINT0$1);\n      p1 = map._pointAtResToContainerPoint(rotations[i][1], glRes, 0, TEMP_POINT1);\n      return r + computeDegree(p0.x, p0.y, p1.x, p1.y);\n    } else {\n      return r + -computeDegree(p0.x, p0.y, p1.x, p1.y);\n    }\n  };\n\n  _proto._rotate = function _rotate(ctx, origin, rotation) {\n    if (rotation) {\n      var dxdy = this.getDxDy();\n      var p = origin.sub(dxdy);\n      ctx.save();\n      ctx.translate(p.x, p.y);\n      ctx.rotate(rotation);\n      return dxdy;\n    }\n\n    return null;\n  };\n\n  return PointSymbolizer;\n}(CanvasSymbolizer);\n\nvar DebugSymbolizer = function (_PointSymbolizer) {\n  _inheritsLoose(DebugSymbolizer, _PointSymbolizer);\n\n  function DebugSymbolizer() {\n    return _PointSymbolizer.apply(this, arguments) || this;\n  }\n\n  var _proto = DebugSymbolizer.prototype;\n\n  _proto.getPlacement = function getPlacement() {\n    return 'point';\n  };\n\n  _proto.getDxDy = function getDxDy() {\n    return new Point(0, 0);\n  };\n\n  _proto.symbolize = function symbolize(ctx) {\n    var geometry = this.geometry,\n        layer = geometry.getLayer();\n\n    if (!geometry.options['debug'] && layer && !layer.options['debug']) {\n      return;\n    }\n\n    var map = this.getMap();\n\n    if (!map || map.isZooming()) {\n      return;\n    }\n\n    var color = layer.options['debugOutline'],\n        op = 1;\n    ctx.strokeStyle = color;\n    ctx.fillStyle = color;\n    var outline = geometry.getContainerExtent().toArray();\n    Canvas.polygon(ctx, [outline], op, 0);\n\n    var points = this._getRenderContainerPoints(),\n        id = this.geometry.getId(),\n        cross = getVectorMarkerPoints('cross', 10, 10);\n\n    for (var i = 0; i < points.length; i++) {\n      var p = points[i];\n\n      if (!isNil(id)) {\n        Canvas.fillText(ctx, id, p.add(8, -4), color);\n      }\n\n      var c = [];\n\n      for (var ii = 0; ii < cross.length; ii++) {\n        c.push(cross[ii].add(p));\n      }\n\n      Canvas.path(ctx, c.slice(0, 2), op);\n      Canvas.path(ctx, c.slice(2, 4), op);\n    }\n  };\n\n  return DebugSymbolizer;\n}(PointSymbolizer);\n\nvar TEMP_SIZE$1 = new Size(1, 1);\n\nvar ImageMarkerSymbolizer = function (_PointSymbolizer) {\n  _inheritsLoose(ImageMarkerSymbolizer, _PointSymbolizer);\n\n  ImageMarkerSymbolizer.test = function test(symbol) {\n    return isImageSymbol(symbol);\n  };\n\n  function ImageMarkerSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    _this = _PointSymbolizer.call(this, symbol, geometry, painter) || this;\n    _this.style = _this._defineStyle(_this.translate());\n    return _this;\n  }\n\n  var _proto = ImageMarkerSymbolizer.prototype;\n\n  _proto.symbolize = function symbolize(ctx, resources) {\n    var style = this.style;\n\n    if (!this.painter.isHitTesting() && (style['markerWidth'] === 0 || style['markerHeight'] === 0 || style['markerOpacity'] === 0)) {\n      return;\n    }\n\n    var cookedPoints = this._getRenderContainerPoints();\n\n    if (!isArrayHasData(cookedPoints)) {\n      return;\n    }\n\n    var img = this._getImage(resources);\n\n    if (!img) {\n      if (typeof console !== 'undefined') {\n        console.warn('no img found for ' + (this.style['markerFile'] || this._url[0]));\n      }\n\n      return;\n    }\n\n    this._prepareContext(ctx);\n\n    var width = style['markerWidth'];\n    var height = style['markerHeight'];\n\n    if (!isNumber(width) || !isNumber(height)) {\n      width = img.width;\n      height = img.height;\n      style['markerWidth'] = width;\n      style['markerHeight'] = height;\n      var imgURL = style['markerFile'];\n\n      if (!resources.isResourceLoaded(imgURL)) {\n        resources.addResource(imgURL, img);\n      }\n\n      var painter = this.getPainter();\n\n      if (!painter.isSpriting()) {\n        painter.removeCache();\n      }\n    }\n\n    var alpha;\n\n    if (this.symbol['markerType'] !== 'path' && isNumber(style['markerOpacity']) && style['markerOpacity'] < 1) {\n      alpha = ctx.globalAlpha;\n      ctx.globalAlpha *= style['markerOpacity'];\n    }\n\n    TEMP_SIZE$1.width = width;\n    TEMP_SIZE$1.height = height;\n    var alignPoint = getAlignPoint(TEMP_SIZE$1, style['markerHorizontalAlignment'], style['markerVerticalAlignment']);\n\n    for (var i = 0, len = cookedPoints.length; i < len; i++) {\n      var p = cookedPoints[i];\n      var origin = this.getRotation() ? this._rotate(ctx, p, this._getRotationAt(i)) : null;\n\n      if (origin) {\n        p = origin;\n      }\n\n      Canvas.image(ctx, img, p.x + alignPoint.x, p.y + alignPoint.y, width, height);\n\n      if (origin) {\n        ctx.restore();\n      }\n    }\n\n    if (alpha !== undefined) {\n      ctx.globalAlpha = alpha;\n    }\n  };\n\n  _proto._getImage = function _getImage(resources) {\n    return getImage(resources, this.style['markerFile']);\n  };\n\n  _proto.getFixedExtent = function getFixedExtent(resources) {\n    this._fixedExtent = this._fixedExtent || new PointExtent();\n    return getImageMarkerFixedExtent(this._fixedExtent, this.style, resources);\n  };\n\n  _proto.translate = function translate() {\n    var s = this.symbol;\n    return {\n      'markerFile': s['markerFile'],\n      'markerOpacity': getValueOrDefault(s['markerOpacity'], 1),\n      'markerWidth': getValueOrDefault(s['markerWidth'], null),\n      'markerHeight': getValueOrDefault(s['markerHeight'], null),\n      'markerRotation': getValueOrDefault(s['markerRotation'], 0),\n      'markerDx': getValueOrDefault(s['markerDx'], 0),\n      'markerDy': getValueOrDefault(s['markerDy'], 0),\n      'markerHorizontalAlignment': getValueOrDefault(s['markerHorizontalAlignment'], 'middle'),\n      'markerVerticalAlignment': getValueOrDefault(s['markerVerticalAlignment'], 'top')\n    };\n  };\n\n  return ImageMarkerSymbolizer;\n}(PointSymbolizer);\n\nvar TEMP_COORD0$1 = new Coordinate(0, 0);\nvar TEMP_COORD1$1 = new Coordinate(0, 0);\n\nvar StrokeAndFillSymbolizer = function (_CanvasSymbolizer) {\n  _inheritsLoose(StrokeAndFillSymbolizer, _CanvasSymbolizer);\n\n  StrokeAndFillSymbolizer.test = function test(symbol, geometry) {\n    if (!symbol) {\n      return false;\n    }\n\n    if (geometry && geometry.type === 'Point') {\n      return false;\n    }\n\n    for (var p in symbol) {\n      var f = p.slice(0, 4);\n\n      if (f === 'line' || f === 'poly') {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  function StrokeAndFillSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    _this = _CanvasSymbolizer.call(this) || this;\n    _this.symbol = symbol;\n    _this.geometry = geometry;\n    _this.painter = painter;\n\n    if (geometry.type === 'Point') {\n      return _assertThisInitialized(_this);\n    }\n\n    _this.style = _this._defineStyle(_this.translate());\n    return _this;\n  }\n\n  var _proto = StrokeAndFillSymbolizer.prototype;\n\n  _proto.symbolize = function symbolize(ctx, resources) {\n    var style = this.style;\n\n    if (style['polygonOpacity'] === 0 && style['lineOpacity'] === 0 && !this.painter.isHitTesting()) {\n      return;\n    }\n\n    var paintParams = this._getPaintParams();\n\n    if (!paintParams) {\n      return;\n    }\n\n    this._prepareContext(ctx);\n\n    var isGradient$$1 = isGradient(style['lineColor']),\n        isPath = this.geometry.getJSONType() === 'Polygon' || this.geometry.type === 'LineString';\n\n    if (isGradient$$1 && (style['lineColor']['places'] || !isPath)) {\n      style['lineGradientExtent'] = this.geometry.getContainerExtent()._expand(style['lineWidth']);\n    }\n\n    if (isGradient(style['polygonFill'])) {\n      style['polygonGradientExtent'] = this.geometry.getContainerExtent();\n    }\n\n    var points = paintParams[0],\n        isSplitted = this.geometry.getJSONType() === 'Polygon' && points.length > 0 && Array.isArray(points[0][0]) || this.geometry.type === 'LineString' && points.length > 0 && Array.isArray(points[0]);\n\n    if (isSplitted) {\n      for (var i = 0; i < points.length; i++) {\n        this.prepareCanvas(ctx, style, resources);\n\n        if (isGradient$$1 && isPath && !style['lineColor']['places']) {\n          this._createGradient(ctx, points[i], style['lineColor']);\n        }\n\n        var params = [ctx, points[i]];\n\n        if (paintParams.length > 1) {\n          params.push.apply(params, paintParams.slice(1));\n        }\n\n        params.push(style['lineOpacity'], style['polygonOpacity'], style['lineDasharray']);\n\n        this.geometry._paintOn.apply(this.geometry, params);\n      }\n    } else {\n      this.prepareCanvas(ctx, style, resources);\n\n      if (isGradient$$1 && isPath && !style['lineColor']['places']) {\n        this._createGradient(ctx, points, style['lineColor']);\n      }\n\n      var _params = [ctx];\n\n      _params.push.apply(_params, paintParams);\n\n      _params.push(style['lineOpacity'], style['polygonOpacity'], style['lineDasharray']);\n\n      this.geometry._paintOn.apply(this.geometry, _params);\n    }\n\n    if (ctx.setLineDash && Array.isArray(style['lineDasharray'])) {\n      ctx.setLineDash([]);\n    }\n  };\n\n  _proto.get2DExtent = function get2DExtent() {\n    var map = this.getMap();\n\n    var extent = this.geometry._getPrjExtent();\n\n    if (!extent) {\n      return null;\n    }\n\n    if (!this._extMin || !this._extMax) {\n      this._extMin = new Coordinate(0, 0);\n      this._extMax = new Coordinate(0, 0);\n    }\n\n    this._extMin.x = extent['xmin'];\n    this._extMin.y = extent['ymin'];\n    this._extMax.x = extent['xmax'];\n    this._extMax.y = extent['ymax'];\n\n    var min = map._prjToPoint(this._extMin, undefined, TEMP_COORD0$1),\n        max = map._prjToPoint(this._extMax, undefined, TEMP_COORD1$1);\n\n    if (!this._pxExtent) {\n      this._pxExtent = new PointExtent(min, max);\n    } else {\n      this._pxExtent.set(Math.min(min.x, max.x), Math.min(min.y, max.y), Math.max(min.x, max.x), Math.max(min.y, max.y));\n    }\n\n    return this._pxExtent;\n  };\n\n  _proto.getFixedExtent = function getFixedExtent() {\n    var t = this.style['lineWidth'] / 2;\n    return new PointExtent(-t, -t, t, t);\n  };\n\n  _proto._getPaintParams = function _getPaintParams() {\n    return this.getPainter().getPaintParams(this.style['lineDx'], this.style['lineDy']);\n  };\n\n  _proto.translate = function translate() {\n    var s = this.symbol;\n    var result = {\n      'lineColor': getValueOrDefault(s['lineColor'], '#000'),\n      'lineWidth': getValueOrDefault(s['lineWidth'], 2),\n      'lineOpacity': getValueOrDefault(s['lineOpacity'], 1),\n      'lineDasharray': getValueOrDefault(s['lineDasharray'], []),\n      'lineCap': getValueOrDefault(s['lineCap'], 'butt'),\n      'lineJoin': getValueOrDefault(s['lineJoin'], 'miter'),\n      'linePatternFile': getValueOrDefault(s['linePatternFile'], null),\n      'lineDx': getValueOrDefault(s['lineDx'], 0),\n      'lineDy': getValueOrDefault(s['lineDy'], 0),\n      'polygonFill': getValueOrDefault(s['polygonFill'], null),\n      'polygonOpacity': getValueOrDefault(s['polygonOpacity'], 1),\n      'polygonPatternFile': getValueOrDefault(s['polygonPatternFile'], null),\n      'polygonPatternDx': getValueOrDefault(s['polygonPatternDx'], 0),\n      'polygonPatternDy': getValueOrDefault(s['polygonPatternDy'], 0),\n      'linePatternDx': getValueOrDefault(s['linePatternDx'], 0),\n      'linePatternDy': getValueOrDefault(s['linePatternDy'], 0)\n    };\n\n    if (result['lineWidth'] === 0) {\n      result['lineOpacity'] = 0;\n    }\n\n    if (this.geometry.type === 'LineString' && !result['polygonFill']) {\n      result['polygonFill'] = result['lineColor'];\n    }\n\n    return result;\n  };\n\n  _proto._createGradient = function _createGradient(ctx, points, lineColor) {\n    if (!Array.isArray(points) || !points.length) {\n      return;\n    }\n\n    var len = points.length;\n    var grad = ctx.createLinearGradient(points[0].x, points[0].y, points[len - 1].x, points[len - 1].y);\n    lineColor['colorStops'].forEach(function (stop) {\n      grad.addColorStop.apply(grad, stop);\n    });\n    ctx.strokeStyle = grad;\n  };\n\n  return StrokeAndFillSymbolizer;\n}(CanvasSymbolizer);\n\nvar TextMarkerSymbolizer = function (_PointSymbolizer) {\n  _inheritsLoose(TextMarkerSymbolizer, _PointSymbolizer);\n\n  TextMarkerSymbolizer.test = function test(symbol) {\n    return isTextSymbol(symbol);\n  };\n\n  function TextMarkerSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    _this = _PointSymbolizer.call(this, symbol, geometry, painter) || this;\n\n    var style = _this.translate();\n\n    _this._dynamic = hasFunctionDefinition(style);\n    _this.style = _this._defineStyle(style);\n\n    if (_this.style['textWrapWidth'] === 0) {\n      return _assertThisInitialized(_this);\n    }\n\n    _this.strokeAndFill = _this._defineStyle(_this.translateLineAndFill(_this.style));\n    return _this;\n  }\n\n  var _proto = TextMarkerSymbolizer.prototype;\n\n  _proto.symbolize = function symbolize(ctx, resources) {\n    if (!this.painter.isHitTesting() && (this.style['textSize'] === 0 || !this.style['textOpacity'] && (!this.style['textHaloRadius'] || !this.style['textHaloOpacity']) || this.style['textWrapWidth'] === 0)) {\n      return;\n    }\n\n    var cookedPoints = this._getRenderContainerPoints();\n\n    if (!isArrayHasData(cookedPoints)) {\n      return;\n    }\n\n    var style = this.style,\n        strokeAndFill = this.strokeAndFill;\n    var textContent = replaceVariable(this.style['textName'], this.geometry.getProperties());\n\n    if (this._dynamic) {\n      delete this._textDesc;\n    }\n\n    var textDesc = this._textDesc = this._textDesc || describeText(textContent, this.style);\n\n    this._prepareContext(ctx);\n\n    this.prepareCanvas(ctx, strokeAndFill, resources);\n    Canvas.prepareCanvasFont(ctx, style);\n\n    for (var i = 0, len = cookedPoints.length; i < len; i++) {\n      var p = cookedPoints[i];\n      var origin = this.getRotation() ? this._rotate(ctx, p, this._getRotationAt(i)) : null;\n\n      if (origin) {\n        p = origin;\n      }\n\n      Canvas.text(ctx, textContent, p, style, textDesc);\n\n      if (origin) {\n        ctx.restore();\n      }\n    }\n  };\n\n  _proto.getPlacement = function getPlacement() {\n    return this.symbol['textPlacement'];\n  };\n\n  _proto.getRotation = function getRotation() {\n    var r = this.style['textRotation'];\n\n    if (!isNumber(r)) {\n      return null;\n    }\n\n    return -r * Math.PI / 180;\n  };\n\n  _proto.getDxDy = function getDxDy() {\n    var s = this.style;\n    return new Point(s['textDx'], s['textDy']);\n  };\n\n  _proto.getFixedExtent = function getFixedExtent() {\n    var textDesc = this.geometry.getTextDesc();\n\n    if (Array.isArray(textDesc)) {\n      textDesc = textDesc[this._index];\n    }\n\n    this._fixedExtent = this._fixedExtent || new PointExtent();\n\n    if (!textDesc) {\n      return this._fixedExtent;\n    }\n\n    return getTextMarkerFixedExtent(this._fixedExtent, this.style, textDesc);\n  };\n\n  _proto.translate = function translate() {\n    var s = this.symbol;\n    var result = {\n      'textName': s['textName'],\n      'textFaceName': getValueOrDefault(s['textFaceName'], 'monospace'),\n      'textWeight': getValueOrDefault(s['textWeight'], 'normal'),\n      'textStyle': getValueOrDefault(s['textStyle'], 'normal'),\n      'textSize': getValueOrDefault(s['textSize'], DEFAULT_TEXT_SIZE),\n      'textFont': getValueOrDefault(s['textFont'], null),\n      'textFill': getValueOrDefault(s['textFill'], '#000'),\n      'textOpacity': getValueOrDefault(s['textOpacity'], 1),\n      'textHaloFill': getValueOrDefault(s['textHaloFill'], '#ffffff'),\n      'textHaloRadius': getValueOrDefault(s['textHaloRadius'], 0),\n      'textHaloOpacity': getValueOrDefault(s['textHaloOpacity'], 1),\n      'textWrapWidth': getValueOrDefault(s['textWrapWidth'], null),\n      'textWrapCharacter': getValueOrDefault(s['textWrapCharacter'], '\\n'),\n      'textLineSpacing': getValueOrDefault(s['textLineSpacing'], 0),\n      'textDx': getValueOrDefault(s['textDx'], 0),\n      'textDy': getValueOrDefault(s['textDy'], 0),\n      'textHorizontalAlignment': getValueOrDefault(s['textHorizontalAlignment'], 'middle'),\n      'textVerticalAlignment': getValueOrDefault(s['textVerticalAlignment'], 'middle'),\n      'textAlign': getValueOrDefault(s['textAlign'], 'center'),\n      'textRotation': getValueOrDefault(s['textRotation'], 0),\n      'textMaxWidth': getValueOrDefault(s['textMaxWidth'], 0),\n      'textMaxHeight': getValueOrDefault(s['textMaxHeight'], 0)\n    };\n\n    if (result['textMaxWidth'] > 0 && (!result['textWrapWidth'] || result['textWrapWidth'] > result['textMaxWidth'])) {\n      if (!result['textWrapWidth']) {\n        result['textMaxHeight'] = 1;\n      }\n\n      result['textWrapWidth'] = result['textMaxWidth'];\n    }\n\n    return result;\n  };\n\n  _proto.translateLineAndFill = function translateLineAndFill(s) {\n    return {\n      'lineColor': s['textHaloRadius'] ? s['textHaloFill'] : s['textFill'],\n      'lineWidth': s['textHaloRadius'],\n      'lineOpacity': s['textOpacity'],\n      'lineDasharray': null,\n      'lineCap': 'butt',\n      'lineJoin': 'round',\n      'polygonFill': s['textFill'],\n      'polygonOpacity': s['textOpacity']\n    };\n  };\n\n  return TextMarkerSymbolizer;\n}(PointSymbolizer);\n\nvar MARKER_SIZE = [];\n\nvar VectorMarkerSymbolizer = function (_PointSymbolizer) {\n  _inheritsLoose(VectorMarkerSymbolizer, _PointSymbolizer);\n\n  VectorMarkerSymbolizer.test = function test(symbol) {\n    return isVectorSymbol(symbol);\n  };\n\n  function VectorMarkerSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    _this = _PointSymbolizer.call(this, symbol, geometry, painter) || this;\n\n    var style = _this.translate();\n\n    _this._dynamic = hasFunctionDefinition(style);\n    _this.style = _this._defineStyle(style);\n    _this.strokeAndFill = _this._defineStyle(translateMarkerLineAndFill(_this.style));\n    _this.padding = 0;\n    return _this;\n  }\n\n  var _proto = VectorMarkerSymbolizer.prototype;\n\n  _proto.symbolize = function symbolize(ctx, resources) {\n    var style = this.style;\n\n    if (!this.painter.isHitTesting() && (style['markerWidth'] === 0 || style['markerHeight'] === 0 || style['polygonOpacity'] === 0 && style['lineOpacity'] === 0)) {\n      return;\n    }\n\n    var cookedPoints = this._getRenderContainerPoints();\n\n    if (!isArrayHasData(cookedPoints)) {\n      return;\n    }\n\n    this._prepareContext(ctx);\n\n    if (this.getPainter().isSpriting() || this.geometry.getLayer().getMask() === this.geometry || this._dynamic || this.geometry.getLayer().options['cacheVectorOnCanvas'] === false) {\n      this._drawMarkers(ctx, cookedPoints, resources);\n    } else {\n      this._drawMarkersWithCache(ctx, cookedPoints, resources);\n    }\n  };\n\n  _proto._drawMarkers = function _drawMarkers(ctx, cookedPoints, resources) {\n    for (var i = cookedPoints.length - 1; i >= 0; i--) {\n      var point = cookedPoints[i];\n      var origin = this.getRotation() ? this._rotate(ctx, point, this._getRotationAt(i)) : null;\n\n      if (origin) {\n        point = origin;\n      }\n\n      this._drawVectorMarker(ctx, point, resources);\n\n      if (origin) {\n        ctx.restore();\n      }\n    }\n  };\n\n  _proto._drawMarkersWithCache = function _drawMarkersWithCache(ctx, cookedPoints, resources) {\n    var stamp = this._stampSymbol();\n\n    var image = resources.getImage(stamp);\n\n    if (!image) {\n      image = this._createMarkerImage(ctx, resources);\n      resources.addResource([stamp, image.width, image.height], image);\n    }\n\n    var anchor = getVectorMarkerAnchor(this.style, image.width, image.height);\n\n    for (var i = cookedPoints.length - 1; i >= 0; i--) {\n      var point = cookedPoints[i];\n      var origin = this.getRotation() ? this._rotate(ctx, point, this._getRotationAt(i)) : null;\n\n      if (origin) {\n        point = origin;\n      }\n\n      Canvas.image(ctx, image, point.x + anchor.x, point.y + anchor.y);\n\n      if (origin) {\n        ctx.restore();\n      }\n    }\n  };\n\n  _proto._createMarkerImage = function _createMarkerImage(ctx, resources) {\n    var canvasClass = ctx.canvas.constructor,\n        size = calVectorMarkerSize(MARKER_SIZE, this.style),\n        canvas = Canvas.createCanvas(size[0], size[1], canvasClass),\n        point = this._getCacheImageAnchor(size[0], size[1]);\n\n    var context = canvas.getContext('2d');\n\n    this._drawVectorMarker(context, point, resources);\n\n    return canvas;\n  };\n\n  _proto._stampSymbol = function _stampSymbol() {\n    if (!this._stamp) {\n      this._stamp = hashCode([this.style['markerType'], isGradient(this.style['markerFill']) ? getGradientStamp(this.style['markerFill']) : this.style['markerFill'], this.style['markerFillOpacity'], this.style['markerFillPatternFile'], isGradient(this.style['markerLineColor']) ? getGradientStamp(this.style['markerLineColor']) : this.style['markerLineColor'], this.style['markerLineWidth'], this.style['markerLineOpacity'], this.style['markerLineDasharray'] ? this.style['markerLineDasharray'].join(',') : '', this.style['markerLinePatternFile'], this.style['markerWidth'], this.style['markerHeight'], this.style['markerHorizontalAlignment'], this.style['markerVerticalAlignment']].join('_'));\n    }\n\n    return this._stamp;\n  };\n\n  _proto._getCacheImageAnchor = function _getCacheImageAnchor(w, h) {\n    var shadow = 2 * (this.symbol['shadowBlur'] || 0),\n        margin = shadow + this.padding;\n    var markerType = this.style['markerType'];\n\n    if (markerType === 'bar' || markerType === 'pie' || markerType === 'pin') {\n      return new Point(w / 2, h - margin);\n    } else if (markerType === 'rectangle') {\n      return new Point(margin, margin);\n    } else {\n      return new Point(w / 2, h / 2);\n    }\n  };\n\n  _proto._getGraidentExtent = function _getGraidentExtent(points) {\n    var e = new PointExtent(),\n        dxdy = this.getDxDy(),\n        m = this.getFixedExtent();\n\n    if (Array.isArray(points)) {\n      for (var i = points.length - 1; i >= 0; i--) {\n        e._combine(points[i]);\n      }\n    } else {\n      e._combine(points);\n    }\n\n    e['xmin'] += m['xmin'] - dxdy.x;\n    e['ymin'] += m['ymin'] - dxdy.y;\n    e['xmax'] += m['xmax'] - dxdy.x;\n    e['ymax'] += m['ymax'] - dxdy.y;\n    return e;\n  };\n\n  _proto._drawVectorMarker = function _drawVectorMarker(ctx, point, resources) {\n    drawVectorMarker(ctx, point, this.style, resources);\n  };\n\n  _proto.getFixedExtent = function getFixedExtent() {\n    var isDynamic = this.isDynamicSize();\n    var w = this.style.markerWidth;\n    var h = this.style.markerHeight;\n    this._fixedExtent = this._fixedExtent || new PointExtent();\n    return getVectorMarkerFixedExtent(this._fixedExtent, this.style, isDynamic ? [128, 128 * h / w] : null);\n  };\n\n  _proto.translate = function translate() {\n    var s = this.symbol;\n    var result = {\n      'markerType': getValueOrDefault(s['markerType'], 'ellipse'),\n      'markerFill': getValueOrDefault(s['markerFill'], '#00f'),\n      'markerFillOpacity': getValueOrDefault(s['markerFillOpacity'], 1),\n      'markerFillPatternFile': getValueOrDefault(s['markerFillPatternFile'], null),\n      'markerLineColor': getValueOrDefault(s['markerLineColor'], '#000'),\n      'markerLineWidth': getValueOrDefault(s['markerLineWidth'], DEFAULT_MARKER_SYMBOLS.markerLineWidth),\n      'markerLineOpacity': getValueOrDefault(s['markerLineOpacity'], 1),\n      'markerLineDasharray': getValueOrDefault(s['markerLineDasharray'], []),\n      'markerLinePatternFile': getValueOrDefault(s['markerLinePatternFile'], null),\n      'markerDx': getValueOrDefault(s['markerDx'], 0),\n      'markerDy': getValueOrDefault(s['markerDy'], 0),\n      'markerWidth': getValueOrDefault(s['markerWidth'], DEFAULT_MARKER_SYMBOLS.markerWidth),\n      'markerHeight': getValueOrDefault(s['markerHeight'], DEFAULT_MARKER_SYMBOLS.markerHeight),\n      'markerRotation': getValueOrDefault(s['markerRotation'], 0),\n      'shadowBlur': getValueOrDefault(s['shadowBlur'], 0),\n      'shadowOffsetX': getValueOrDefault(s['shadowOffsetX'], 0),\n      'shadowOffsetY': getValueOrDefault(s['shadowOffsetY'], 0)\n    };\n    var markerType = result['markerType'];\n    var ha = getDefaultHAlign(markerType);\n    var va = getDefaultVAlign(markerType);\n    result['markerHorizontalAlignment'] = getValueOrDefault(s['markerHorizontalAlignment'], ha);\n    result['markerVerticalAlignment'] = getValueOrDefault(s['markerVerticalAlignment'], va);\n\n    if (isNumber(s['markerOpacity'])) {\n      if (isNumber(s['markerFillOpacity'])) {\n        result['markerFillOpacity'] *= s['markerOpacity'];\n      }\n\n      if (isNumber(s['markerLineOpacity'])) {\n        result['markerLineOpacity'] *= s['markerOpacity'];\n      }\n    }\n\n    return result;\n  };\n\n  return VectorMarkerSymbolizer;\n}(PointSymbolizer);\n\nvar VectorPathMarkerSymbolizer = function (_ImageMarkerSymbolize) {\n  _inheritsLoose(VectorPathMarkerSymbolizer, _ImageMarkerSymbolize);\n\n  VectorPathMarkerSymbolizer.test = function test(symbol) {\n    return isPathSymbol(symbol);\n  };\n\n  function VectorPathMarkerSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    if (isNil(symbol['markerWidth'])) {\n      symbol['markerWidth'] = 80;\n    }\n\n    if (isNil(symbol['markerHeight'])) {\n      symbol['markerHeight'] = 80;\n    }\n\n    _this = _ImageMarkerSymbolize.call(this, symbol, geometry, painter) || this;\n    symbol = extend(symbol, _this.translate());\n\n    var style = _this.style = _this._defineStyle(symbol);\n\n    if (Browser$1.gecko) {\n      _this._url = [getMarkerPathBase64(style, style['markerWidth'], style['markerHeight']), style['markerWidth'], style['markerHeight']];\n    } else {\n      _this._url = [getMarkerPathBase64(style), style['markerWidth'], style['markerHeight']];\n    }\n\n    return _this;\n  }\n\n  var _proto = VectorPathMarkerSymbolizer.prototype;\n\n  _proto._prepareContext = function _prepareContext() {};\n\n  _proto._getImage = function _getImage(resources) {\n    var _this2 = this;\n\n    if (resources && resources.isResourceLoaded(this._url)) {\n      return resources.getImage(this._url);\n    }\n\n    var painter = this.painter;\n    var image = new Image();\n\n    image.onload = function () {\n      var renderer = painter.getLayer() && painter.getLayer().getRenderer();\n\n      if (renderer) {\n        renderer.setToRedraw();\n      }\n    };\n\n    image.onerror = function (err) {\n      if (err && typeof console !== 'undefined') {\n        console.warn(err);\n      }\n\n      resources.markErrorResource(_this2._url);\n    };\n\n    image.src = this._url[0];\n\n    if (resources) {\n      resources.addResource(this._url, image);\n    }\n\n    return image;\n  };\n\n  return VectorPathMarkerSymbolizer;\n}(ImageMarkerSymbolizer);\n\nvar defaultSymbol = {\n  lineWidth: 1,\n  polygonFill: '#fff',\n  polygonOpacity: 0.5\n};\n\nvar DrawAltitudeSymbolizer = function (_PointSymbolizer) {\n  _inheritsLoose(DrawAltitudeSymbolizer, _PointSymbolizer);\n\n  DrawAltitudeSymbolizer.test = function test(symbol, geometry) {\n    var layer = geometry.getLayer();\n\n    if (!layer) {\n      return false;\n    }\n\n    var type = geometry.getJSONType();\n    return type === 'Marker' || type === 'LineString';\n  };\n\n  function DrawAltitudeSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    _this = _PointSymbolizer.call(this, symbol, geometry, painter) || this;\n    _this.style = geometry.getLayer().options['drawAltitude'];\n\n    if (!_this.style || !isObject(_this.style)) {\n      _this.style = {\n        'lineWidth': 2\n      };\n    }\n\n    if (!_this.style['lineWidth']) {\n      _this.style['lineWidth'] = 0;\n    }\n\n    _this.dxdy = _this._defineStyle({\n      'dx': symbol['textDx'] || symbol['markerDx'],\n      'dy': symbol['textDy'] || symbol['markerDy']\n    });\n    return _this;\n  }\n\n  var _proto = DrawAltitudeSymbolizer.prototype;\n\n  _proto.symbolize = function symbolize(ctx) {\n    var layer = this.geometry.getLayer();\n\n    if (!layer.options['drawAltitude']) {\n      return;\n    }\n\n    var properties = this.geometry.getProperties();\n\n    if (!properties || !properties[layer.options['altitudeProperty']]) {\n      return;\n    }\n\n    var style = this._getStyle();\n\n    this._prepareContext(ctx);\n\n    if (this.geometry.type === 'LineString') {\n      var paintParams = this._getPaintParams(style['lineDx'], style['lineDy'], false, true);\n\n      if (!paintParams) {\n        return;\n      }\n\n      var groundPoints = this.getPainter().getPaintParams(style['lineDx'], style['lineDy'], true, true, '_groundpt')[0];\n\n      this._drawLineAltitude(ctx, paintParams[0], groundPoints);\n    } else {\n      var point = this._getRenderContainerPoints(),\n          groundPoint = this._getRenderContainerPoints(true);\n\n      if (!point || point.length === 0) {\n        return;\n      }\n\n      this._drawMarkerAltitude(ctx, point[0], groundPoint[0]);\n    }\n  };\n\n  _proto.getDxDy = function getDxDy() {\n    var s = this.dxdy;\n    return new Point(s['dx'] || 0, s['dy'] || 0);\n  };\n\n  _proto.get2DExtent = function get2DExtent() {\n    if (this.geometry.type === 'LineString') {\n      return StrokeAndFillSymbolizer.prototype.get2DExtent.apply(this);\n    } else {\n      return _PointSymbolizer.prototype.get2DExtent.call(this);\n    }\n  };\n\n  _proto.getPlacement = function getPlacement() {\n    return 'point';\n  };\n\n  _proto._getPaintParams = function _getPaintParams(dx, dy) {\n    return this.getPainter().getPaintParams(dx || 0, dy || 0, null, true, '_altpt');\n  };\n\n  _proto._drawMarkerAltitude = function _drawMarkerAltitude(ctx, point, groundPoint) {\n    var style = this._getStyle();\n\n    this.prepareCanvas(ctx, style);\n    Canvas.path(ctx, [point, groundPoint], style['lineOpacity'], null, style['lineDasharray']);\n  };\n\n  _proto._drawLineAltitude = function _drawLineAltitude(ctx, points, groundPoints) {\n    var style = this._getStyle();\n\n    var isSplitted = points.length > 0 && Array.isArray(points[0]);\n\n    if (isSplitted) {\n      for (var i = 0; i < points.length; i++) {\n        this._drawLine(ctx, points[i], groundPoints[i]);\n      }\n    } else {\n      this._drawLine(ctx, points, groundPoints);\n    }\n\n    if (ctx.setLineDash && Array.isArray(style['lineDasharray'])) {\n      ctx.setLineDash([]);\n    }\n  };\n\n  _proto._drawLine = function _drawLine(ctx, points, groundPoints) {\n    var style = this._getStyle();\n\n    this.prepareCanvas(ctx, style);\n\n    for (var i = 0, l = points.length - 1; i < l; i++) {\n      Canvas.polygon(ctx, [points[i], points[i + 1], groundPoints[i + 1], groundPoints[i]], style['lineOpacity'], style['polygonOpacity'], style['lineDasharray']);\n    }\n  };\n\n  _proto._getStyle = function _getStyle() {\n    var style = this.geometry.getLayer().options['drawAltitude'];\n\n    if (!isObject(style)) {\n      style = defaultSymbol;\n    }\n\n    if (!style['lineWidth']) {\n      style['lineWidth'] = 0;\n      style['lineOpacity'] = 0;\n    }\n\n    return style;\n  };\n\n  return DrawAltitudeSymbolizer;\n}(PointSymbolizer);\n\n\n\nvar index$3 = /*#__PURE__*/Object.freeze({\n  Symbolizer: Symbolizer,\n  CanvasSymbolizer: CanvasSymbolizer,\n  DebugSymbolizer: DebugSymbolizer,\n  ImageMarkerSymbolizer: ImageMarkerSymbolizer,\n  PointSymbolizer: PointSymbolizer,\n  StrokeAndFillSymbolizer: StrokeAndFillSymbolizer,\n  TextMarkerSymbolizer: TextMarkerSymbolizer,\n  VectorMarkerSymbolizer: VectorMarkerSymbolizer,\n  VectorPathMarkerSymbolizer: VectorPathMarkerSymbolizer,\n  DrawAltitudeSymbolizer: DrawAltitudeSymbolizer\n});\n\nvar registerSymbolizers = [DrawAltitudeSymbolizer, StrokeAndFillSymbolizer, ImageMarkerSymbolizer, VectorPathMarkerSymbolizer, VectorMarkerSymbolizer, TextMarkerSymbolizer];\nvar testCanvas;\nvar TEMP_POINT0$2 = new Point(0, 0);\nvar TEMP_PAINT_EXTENT = new PointExtent();\nvar TEMP_FIXED_EXTENT = new PointExtent();\nvar TEMP_CLIP_EXTENT0 = new PointExtent();\nvar TEMP_CLIP_EXTENT1 = new PointExtent();\nvar TEMP_CLIP_EXTENT2 = new PointExtent();\nvar PROJECTION = {};\nvar TEMP_BBOX = {\n  minx: Infinity,\n  miny: Infinity,\n  maxx: -Infinity,\n  maxy: -Infinity\n};\n\nvar Painter = function (_Class) {\n  _inheritsLoose(Painter, _Class);\n\n  function Painter(geometry) {\n    var _this;\n\n    _this = _Class.call(this) || this;\n    _this.geometry = geometry;\n    _this.symbolizers = _this._createSymbolizers();\n    _this._altAtGL = _this._getGeometryAltitude();\n    return _this;\n  }\n\n  var _proto = Painter.prototype;\n\n  _proto.getMap = function getMap() {\n    return this.geometry.getMap();\n  };\n\n  _proto.getLayer = function getLayer() {\n    return this.geometry.getLayer();\n  };\n\n  _proto._createSymbolizers = function _createSymbolizers() {\n    var geoSymbol = this.getSymbol(),\n        symbolizers = [],\n        regSymbolizers = registerSymbolizers;\n    var symbols = geoSymbol;\n\n    if (!Array.isArray(geoSymbol)) {\n      symbols = [geoSymbol];\n    }\n\n    for (var ii = symbols.length - 1; ii >= 0; ii--) {\n      var symbol = symbols[ii];\n\n      for (var i = regSymbolizers.length - 1; i >= 0; i--) {\n        if (regSymbolizers[i].test(symbol, this.geometry)) {\n          var symbolizer = new regSymbolizers[i](symbol, this.geometry, this);\n          symbolizer._index = ii;\n          symbolizers.push(symbolizer);\n\n          if (symbolizer instanceof PointSymbolizer) {\n            this._hasPoint = true;\n          }\n        }\n      }\n    }\n\n    if (!symbolizers.length) {\n      if (console) {\n        var id = this.geometry.getId();\n        console.warn('invalid symbol for geometry(' + (this.geometry ? this.geometry.getType() + (id ? ':' + id : '') : '') + ') to draw : ' + JSON.stringify(geoSymbol));\n      }\n    }\n\n    this._debugSymbolizer = new DebugSymbolizer(geoSymbol, this.geometry, this);\n    return symbolizers;\n  };\n\n  _proto.hasPoint = function hasPoint() {\n    return !!this._hasPoint;\n  };\n\n  _proto.getRenderPoints = function getRenderPoints(placement) {\n    this._verifyProjection();\n\n    if (!this._renderPoints) {\n      this._renderPoints = {};\n    }\n\n    if (!placement) {\n      placement = 'center';\n    }\n\n    if (!this._renderPoints[placement]) {\n      this._renderPoints[placement] = this.geometry._getRenderPoints(placement);\n    }\n\n    return this._renderPoints[placement];\n  };\n\n  _proto.getPaintParams = function getPaintParams(dx, dy, ignoreAltitude, disableClip, ptkey) {\n    if (ptkey === void 0) {\n      ptkey = '_pt';\n    }\n\n    var renderer = this.getLayer()._getRenderer();\n\n    var mapStateCache = renderer.mapStateCache;\n    var resolution, pitch, bearing, glScale, containerExtent;\n    var map = this.getMap();\n\n    if (mapStateCache && !this._hitPoint) {\n      resolution = mapStateCache.resolution;\n      pitch = mapStateCache.pitch;\n      bearing = mapStateCache.bearing;\n      glScale = mapStateCache.glScale;\n      containerExtent = mapStateCache.containerExtent;\n    } else {\n      resolution = map.getResolution();\n      pitch = map.getPitch();\n      bearing = map.getBearing();\n      glScale = map.getGLScale();\n      containerExtent = map.getContainerExtent();\n    }\n\n    var geometry = this.geometry,\n        res = resolution,\n        pitched = pitch !== 0,\n        rotated = bearing !== 0;\n    var params = this._cachedParams;\n\n    var paintAsPath = geometry._paintAsPath && geometry._paintAsPath();\n\n    if (paintAsPath && this._unsimpledParams && res <= this._unsimpledParams._res) {\n      params = this._unsimpledParams;\n    } else if (!params || params._res !== resolution || this._pitched !== pitched && geometry._redrawWhenPitch() || this._rotated !== rotated && geometry._redrawWhenRotate()) {\n      params = geometry._getPaintParams();\n\n      if (!params) {\n        return null;\n      }\n\n      params._res = res;\n\n      if (!geometry._simplified && paintAsPath) {\n        if (!this._unsimpledParams) {\n          this._unsimpledParams = params;\n        }\n\n        if (res > this._unsimpledParams._res) {\n          this._unsimpledParams._res = res;\n        }\n      }\n\n      this._cachedParams = params;\n    }\n\n    if (!params) {\n      return null;\n    }\n\n    this._pitched = pitched;\n    this._rotated = rotated;\n    var zoomScale = glScale,\n        tr = [],\n        points = params[0];\n    var mapExtent = containerExtent;\n\n    var cPoints = this._pointContainerPoints(points, dx, dy, ignoreAltitude, disableClip || this._hitPoint && !mapExtent.contains(this._hitPoint), null, ptkey);\n\n    if (!cPoints) {\n      return null;\n    }\n\n    tr.push(cPoints);\n\n    for (var i = 1, l = params.length; i < l; i++) {\n      if (isNumber(params[i]) || params[i] instanceof Size) {\n        if (isNumber(params[i])) {\n          tr.push(params[i] / zoomScale);\n        } else {\n          tr.push(params[i].multi(1 / zoomScale));\n        }\n      } else {\n        tr.push(params[i]);\n      }\n    }\n\n    return tr;\n  };\n\n  _proto._pointContainerPoints = function _pointContainerPoints(points, dx, dy, ignoreAltitude, disableClip, pointPlacement, ptkey) {\n    if (ptkey === void 0) {\n      ptkey = '_pt';\n    }\n\n    if (this._aboveCamera()) {\n      return null;\n    }\n\n    var renderer = this.getLayer()._getRenderer();\n\n    var mapStateCache = renderer.mapStateCache;\n    var map = this.getMap(),\n        geometry = this.geometry,\n        containerOffset = this.containerOffset;\n    var glRes, containerExtent;\n\n    if (mapStateCache) {\n      glRes = mapStateCache.glRes;\n      containerExtent = mapStateCache.containerExtent;\n    } else {\n      glRes = map.getGLRes();\n      containerExtent = map.getContainerExtent();\n    }\n\n    var cPoints;\n    var roundPoint = this.getLayer().options['roundPoint'];\n    var minx = Infinity,\n        miny = Infinity,\n        maxx = -Infinity,\n        maxy = -Infinity;\n    var needClip = !disableClip;\n    var clipBBoxBufferSize = renderer.layer.options['clipBBoxBufferSize'] || 3;\n    var symbolizers = this.symbolizers;\n\n    function pointsContainerPoints(viewPoints, alts) {\n      if (viewPoints === void 0) {\n        viewPoints = [];\n      }\n\n      if (alts === void 0) {\n        alts = [];\n      }\n\n      var pts = getPointsResultPts(viewPoints, ptkey);\n      pts = map._pointsAtResToContainerPoints(viewPoints, glRes, alts, pts);\n\n      for (var i = 0, len = pts.length; i < len; i++) {\n        var p = pts[i];\n\n        p._sub(containerOffset);\n\n        if (dx || dy) {\n          p._add(dx || 0, dy || 0);\n        }\n\n        if (roundPoint) {\n          p.x = Math.ceil(p.x);\n          p.y = Math.ceil(p.y);\n        }\n\n        minx = Math.min(p.x, minx);\n        miny = Math.min(p.y, miny);\n        maxx = Math.max(p.x, maxx);\n        maxy = Math.max(p.y, maxy);\n      }\n\n      if (needClip && isDashLine(symbolizers)) {\n        TEMP_CLIP_EXTENT2.ymin = containerExtent.ymin;\n\n        if (TEMP_CLIP_EXTENT2.ymin < clipBBoxBufferSize) {\n          TEMP_CLIP_EXTENT2.ymin = containerExtent.ymin - clipBBoxBufferSize;\n        }\n\n        TEMP_CLIP_EXTENT2.xmin = containerExtent.xmin - clipBBoxBufferSize;\n        TEMP_CLIP_EXTENT2.xmax = containerExtent.xmax + clipBBoxBufferSize;\n        TEMP_CLIP_EXTENT2.ymax = containerExtent.ymax + clipBBoxBufferSize;\n\n        if (geometry.getShell && geometry.getHoles) {\n          return clipPolygon(pts, TEMP_CLIP_EXTENT2);\n        }\n\n        var clipPts = clipLine(pts, TEMP_CLIP_EXTENT2, false);\n\n        if (clipPts.length) {\n          var _points = [];\n          clipPts.forEach(function (clipPt) {\n            for (var _i = 0, _len = clipPt.length; _i < _len; _i++) {\n              _points.push(clipPt[_i].point);\n            }\n          });\n          return _points;\n        }\n      }\n\n      return pts;\n    }\n\n    var altitude = this.getAltitude();\n\n    if (Array.isArray(points)) {\n      var _geometry = this.geometry;\n      var clipped;\n\n      if (!disableClip && _geometry.options['enableClip']) {\n        clipped = this._clip(points, altitude);\n\n        if (clipped.inView) {\n          needClip = false;\n        }\n      } else {\n        clipped = {\n          points: points,\n          altitude: altitude\n        };\n      }\n\n      var clipPoints = clipped.points;\n      altitude = clipped.altitude;\n\n      if (ignoreAltitude) {\n        altitude = 0;\n      }\n\n      var alt = altitude;\n      cPoints = [];\n      var alts = [];\n      var altitudeIsNumber = isNumber(altitude);\n\n      for (var i = 0, l = clipPoints.length; i < l; i++) {\n        var c = clipPoints[i];\n\n        if (Array.isArray(c)) {\n          if (altitudeIsNumber) {\n            var _cring = pointsContainerPoints(c, altitude);\n\n            cPoints.push(_cring);\n            continue;\n          }\n\n          var altArray = [];\n\n          for (var ii = 0, ll = c.length; ii < ll; ii++) {\n            if (Array.isArray(altitude)) {\n              if (altitude[i]) {\n                alt = altitude[i][ii];\n              } else {\n                alt = 0;\n              }\n            }\n\n            altArray.push(alt);\n          }\n\n          var cring = pointsContainerPoints(c, altArray);\n          cPoints.push(cring);\n        } else {\n          if (Array.isArray(altitude)) {\n            if (pointPlacement === 'vertex-last') {\n              alt = altitude[altitude.length - 1 - i];\n            } else if (pointPlacement === 'line') {\n              alt = (altitude[i] + altitude[i + 1]) / 2;\n            } else {\n              alt = altitude[i];\n            }\n          }\n\n          alts.push(alt);\n        }\n      }\n\n      if (alts.length) {\n        cPoints = pointsContainerPoints(clipPoints, alts);\n      }\n    } else if (points instanceof Point) {\n      if (ignoreAltitude) {\n        altitude = 0;\n      }\n\n      cPoints = map._pointAtResToContainerPoint(points, glRes, altitude)._sub(containerOffset);\n\n      if (dx || dy) {\n        cPoints._add(dx, dy);\n      }\n    }\n\n    TEMP_BBOX.minx = minx;\n    TEMP_BBOX.miny = miny;\n    TEMP_BBOX.maxx = maxx;\n    TEMP_BBOX.maxy = maxy;\n    this._containerBbox = TEMP_BBOX;\n    return cPoints;\n  };\n\n  _proto._clip = function _clip(points, altitude) {\n    if (isNumber(altitude) && altitude !== 0) {\n      return {\n        points: points,\n        altitude: altitude\n      };\n    }\n\n    if (Array.isArray(altitude)) {\n      var hasAltitude = false;\n\n      for (var i = 0, len = altitude.length; i < len; i++) {\n        if (altitude[i] !== 0) {\n          hasAltitude = true;\n          break;\n        }\n      }\n\n      if (hasAltitude) {\n        return {\n          points: points,\n          altitude: altitude\n        };\n      }\n    }\n\n    var map = this.getMap(),\n        geometry = this.geometry;\n    var lineWidth = this.getSymbol()['lineWidth'];\n\n    if (!isNumber(lineWidth)) {\n      lineWidth = 4;\n    }\n\n    var renderer = this.getLayer()._getRenderer();\n\n    var mapStateCache = renderer.mapStateCache;\n\n    var _2DExtent, glExtent, pitch;\n\n    if (mapStateCache) {\n      _2DExtent = mapStateCache._2DExtent;\n      glExtent = mapStateCache.glExtent;\n      pitch = mapStateCache.pitch;\n    } else {\n      _2DExtent = map._get2DExtent();\n      glExtent = map._get2DExtentAtRes(map.getGLRes());\n      pitch = map.getPitch();\n    }\n\n    var extent2D = _2DExtent._expand(lineWidth);\n\n    if (pitch > 0 && altitude) {\n      var c = map.cameraLookAt;\n      var pos = map.cameraPosition;\n      TEMP_POINT0$2.set(pos.x, pos.y);\n      extent2D = extent2D._combine(TEMP_POINT0$2._add(sign(c[0] - pos[0]), sign(c[1] - pos[1])));\n    }\n\n    var e = this.get2DExtent(null, TEMP_CLIP_EXTENT1);\n    var clipPoints = points;\n\n    if (e.within(extent2D)) {\n      return {\n        points: clipPoints,\n        altitude: altitude,\n        inView: true\n      };\n    }\n\n    var glExtent2D = glExtent._expand(lineWidth * map._glScale);\n\n    TEMP_CLIP_EXTENT0.xmin = glExtent2D.xmin;\n    TEMP_CLIP_EXTENT0.xmax = glExtent2D.xmax;\n    TEMP_CLIP_EXTENT0.ymin = glExtent2D.ymin;\n    TEMP_CLIP_EXTENT0.ymax = glExtent2D.ymax;\n    var smoothness = geometry.options['smoothness'];\n\n    if (geometry.getShell && this.geometry.getHoles && !smoothness) {\n      var xmin = glExtent2D.xmin,\n          ymin = glExtent2D.ymin,\n          xmax = glExtent2D.xmax,\n          ymax = glExtent2D.ymax;\n      var dx = Math.abs(xmax - xmin),\n          dy = Math.abs(ymax - ymin);\n      var r = Math.sqrt(dx * dx + dy * dy);\n      var rx = (r - dx) / 2,\n          ry = (r - dy) / 2;\n      TEMP_CLIP_EXTENT0.xmin = glExtent2D.xmin - rx;\n      TEMP_CLIP_EXTENT0.xmax = glExtent2D.xmax + rx;\n      TEMP_CLIP_EXTENT0.ymin = glExtent2D.ymin - ry;\n      TEMP_CLIP_EXTENT0.ymax = glExtent2D.ymax + ry;\n\n      if (!Array.isArray(points[0])) {\n        clipPoints = clipPolygon(points, TEMP_CLIP_EXTENT0);\n      } else {\n        clipPoints = [];\n\n        for (var _i2 = 0; _i2 < points.length; _i2++) {\n          var part = clipPolygon(points[_i2], TEMP_CLIP_EXTENT0);\n\n          if (part.length) {\n            clipPoints.push(part);\n          }\n        }\n      }\n    } else if (geometry.getJSONType() === 'LineString' && !smoothness) {\n      if (!Array.isArray(points[0])) {\n        clipPoints = clipLine(points, TEMP_CLIP_EXTENT0, false, !!smoothness);\n      } else {\n        clipPoints = [];\n\n        for (var _i3 = 0; _i3 < points.length; _i3++) {\n          pushIn(clipPoints, clipLine(points[_i3], TEMP_CLIP_EXTENT0, false, !!smoothness));\n        }\n      }\n\n      return this._interpolateSegAlt(clipPoints, points, altitude);\n    }\n\n    return {\n      points: clipPoints,\n      altitude: altitude\n    };\n  };\n\n  _proto._interpolateSegAlt = function _interpolateSegAlt(clipSegs, orig, altitude) {\n    if (!Array.isArray(altitude)) {\n      var fn = function fn(cc) {\n        return cc.point;\n      };\n\n      return {\n        points: clipSegs.map(function (c) {\n          if (Array.isArray(c)) {\n            return c.map(fn);\n          }\n\n          return c.point;\n        }),\n        altitude: altitude\n      };\n    }\n\n    var segsWithAlt = interpolateAlt(clipSegs, orig, altitude);\n    altitude = [];\n    var points = segsWithAlt.map(function (p) {\n      if (Array.isArray(p)) {\n        var alt = [];\n        var cp = p.map(function (pp) {\n          alt.push(pp.altitude);\n          return pp.point;\n        });\n        altitude.push(alt);\n        return cp;\n      }\n\n      altitude.push(p.altitude);\n      return p.point;\n    });\n    return {\n      points: points,\n      altitude: altitude\n    };\n  };\n\n  _proto.getSymbol = function getSymbol() {\n    return this.geometry._getInternalSymbol();\n  };\n\n  _proto.paint = function paint(extent, context, offset) {\n    if (!this.symbolizers) {\n      return;\n    }\n\n    var layer = this.getLayer();\n\n    var renderer = layer._getRenderer();\n\n    if (!renderer || !renderer.context && !context) {\n      return;\n    }\n\n    var mapStateCache = renderer.mapStateCache || {};\n\n    if (!this.geometry._isCheck) {\n      if (extent && !extent.intersects(this.get2DExtent(renderer.resources, TEMP_PAINT_EXTENT))) {\n        return;\n      }\n    }\n\n    var map = this.getMap();\n    var minAltitude = this.getMinAltitude();\n    var frustumAlt = map.getFrustumAltitude();\n\n    if (minAltitude && frustumAlt && frustumAlt < minAltitude) {\n      return;\n    }\n\n    this.containerOffset = offset || mapStateCache.offset || map._pointToContainerPoint(renderer.southWest)._add(0, -map.height);\n\n    this._beforePaint();\n\n    var ctx = context || renderer.context;\n    var contexts = [ctx, renderer.resources];\n\n    for (var i = this.symbolizers.length - 1; i >= 0; i--) {\n      if (ctx.shadowBlur || this.symbolizers[i].symbol['shadowBlur']) {\n        this._prepareShadow(ctx, this.symbolizers[i].symbol);\n      }\n\n      this.symbolizers[i].symbolize.apply(this.symbolizers[i], contexts);\n    }\n\n    this._afterPaint();\n\n    this._painted = true;\n\n    if (this.geometry.options['debug'] || layer.options['debug']) {\n      this._debugSymbolizer.symbolize.apply(this._debugSymbolizer, contexts);\n    }\n  };\n\n  _proto.getSprite = function getSprite(resources, canvasClass) {\n    if (this.geometry.type !== 'Point') {\n      return null;\n    }\n\n    this._spriting = true;\n\n    if (!this._sprite && this.symbolizers.length > 0) {\n      var extent = new PointExtent();\n      this.symbolizers.forEach(function (s) {\n        var markerExtent = s.getFixedExtent(resources);\n\n        extent._combine(markerExtent);\n      });\n      var origin = extent.getMin().multi(-1);\n      var clazz = canvasClass || (this.getMap() ? this.getMap().CanvasClass : null);\n      var canvas = Canvas.createCanvas(extent.getWidth(), extent.getHeight(), clazz);\n      var bak;\n\n      if (this._renderPoints) {\n        bak = this._renderPoints;\n      }\n\n      var ctx = canvas.getContext('2d');\n      var contexts = [ctx, resources];\n\n      for (var i = this.symbolizers.length - 1; i >= 0; i--) {\n        var dxdy = this.symbolizers[i].getDxDy();\n        this._renderPoints = {\n          'center': [[origin.add(dxdy)]]\n        };\n\n        this._prepareShadow(ctx, this.symbolizers[i].symbol);\n\n        this.symbolizers[i].symbolize.apply(this.symbolizers[i], contexts);\n      }\n\n      if (bak) {\n        this._renderPoints = bak;\n      }\n\n      this._sprite = {\n        'canvas': canvas,\n        'offset': extent.getCenter()\n      };\n    }\n\n    this._spriting = false;\n    return this._sprite;\n  };\n\n  _proto.isSpriting = function isSpriting() {\n    return !!this._spriting;\n  };\n\n  _proto.hitTest = function hitTest(cp, tolerance) {\n    if (!tolerance || tolerance < 0.5) {\n      tolerance = 0.5;\n    }\n\n    this._hitPoint = cp.sub(tolerance, tolerance);\n\n    if (!testCanvas) {\n      var canvasClass = this.getMap() ? this.getMap().CanvasClass : null;\n      testCanvas = Canvas.createCanvas(1, 1, canvasClass);\n    }\n\n    Canvas.setHitTesting(true);\n    testCanvas.width = testCanvas.height = 2 * tolerance;\n    var ctx = testCanvas.getContext('2d');\n\n    try {\n      this.paint(null, ctx, this._hitPoint);\n    } catch (e) {\n      throw e;\n    } finally {\n      Canvas.setHitTesting(false);\n    }\n\n    delete this._hitPoint;\n    var imgData = ctx.getImageData(0, 0, testCanvas.width, testCanvas.height).data;\n\n    for (var i = 3, l = imgData.length; i < l; i += 4) {\n      if (imgData[i] > 0) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  _proto.isHitTesting = function isHitTesting() {\n    return !!this._hitPoint;\n  };\n\n  _proto._prepareShadow = function _prepareShadow(ctx, symbol) {\n    if (symbol['shadowBlur']) {\n      ctx.shadowBlur = this.isHitTesting() ? 0 : symbol['shadowBlur'];\n      ctx.shadowColor = symbol['shadowColor'] || '#000';\n      ctx.shadowOffsetX = symbol['shadowOffsetX'] || 0;\n      ctx.shadowOffsetY = symbol['shadowOffsetY'] || 0;\n    } else if (ctx.shadowBlur) {\n      ctx.shadowBlur = null;\n      ctx.shadowColor = null;\n      ctx.shadowOffsetX = null;\n      ctx.shadowOffsetY = null;\n    }\n  };\n\n  _proto._eachSymbolizer = function _eachSymbolizer(fn, context) {\n    if (!this.symbolizers) {\n      return;\n    }\n\n    if (!context) {\n      context = this;\n    }\n\n    for (var i = this.symbolizers.length - 1; i >= 0; i--) {\n      fn.apply(context, [this.symbolizers[i]]);\n    }\n  };\n\n  _proto.get2DExtent = function get2DExtent(resources, out) {\n    this._verifyProjection();\n\n    var map = this.getMap();\n    resources = resources || this.getLayer()._getRenderer().resources;\n    var zoom = map.getZoom();\n\n    var isDynamicSize = this._isDynamicSize();\n\n    if (!this._extent2D || this._extent2D._zoom !== zoom || !this._fixedExtent) {\n      if (this._extent2D && this._extent2D._zoom !== zoom) {\n        delete this._extent2D;\n      }\n\n      if (this.symbolizers) {\n        if (!this._extent2D) {\n          this._extent2D = this._computeExtent2D(new PointExtent());\n          this._extent2D._zoom = zoom;\n        }\n\n        if (!this._fixedExtent) {\n          this._fixedExtent = this._computeFixedExtent(resources, new PointExtent());\n        }\n      }\n    }\n\n    if (!this._extent2D) {\n      if (isDynamicSize) {\n        delete this._fixedExtent;\n      }\n\n      return null;\n    }\n\n    var _this$_fixedExtent = this._fixedExtent,\n        xmin = _this$_fixedExtent.xmin,\n        ymin = _this$_fixedExtent.ymin,\n        xmax = _this$_fixedExtent.xmax,\n        ymax = _this$_fixedExtent.ymax;\n\n    if (isDynamicSize) {\n      delete this._fixedExtent;\n    }\n\n    TEMP_FIXED_EXTENT.set(xmin, -ymax, xmax, -ymin);\n\n    if (out) {\n      out.set(this._extent2D['xmin'], this._extent2D['ymin'], this._extent2D['xmax'], this._extent2D['ymax']);\n\n      out._add(TEMP_FIXED_EXTENT);\n\n      return out;\n    }\n\n    return this._extent2D.add(TEMP_FIXED_EXTENT);\n  };\n\n  _proto._computeExtent2D = function _computeExtent2D(extent) {\n    for (var i = this.symbolizers.length - 1; i >= 0; i--) {\n      var symbolizer = this.symbolizers[i];\n\n      extent._combine(symbolizer.get2DExtent());\n    }\n\n    return extent;\n  };\n\n  _proto._computeFixedExtent = function _computeFixedExtent(resources, extent) {\n    for (var i = this.symbolizers.length - 1; i >= 0; i--) {\n      var symbolizer = this.symbolizers[i];\n\n      if (symbolizer.getFixedExtent) {\n        extent._combine(symbolizer.getFixedExtent(resources));\n      }\n    }\n\n    return extent;\n  };\n\n  _proto._isDynamicSize = function _isDynamicSize() {\n    for (var i = this.symbolizers.length - 1; i >= 0; i--) {\n      var symbolizer = this.symbolizers[i];\n\n      if (symbolizer.isDynamicSize()) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  _proto._aboveCamera = function _aboveCamera() {\n    var altitude = this.getMinAltitude();\n    var map = this.getMap();\n    var frustumAlt = map.getFrustumAltitude();\n    return altitude && frustumAlt && frustumAlt < altitude;\n  };\n\n  _proto.getFixedExtent = function getFixedExtent() {\n    var map = this.getMap();\n    var zoom = map.getZoom();\n\n    if (this._isDynamicSize()) {\n      return this._computeFixedExtent(null, new PointExtent());\n    }\n\n    if (!this._extent2D || this._extent2D._zoom !== zoom) {\n      this.get2DExtent(null, TEMP_FIXED_EXTENT);\n    }\n\n    return this._fixedExtent;\n  };\n\n  _proto.setZIndex = function setZIndex(change) {\n    this._eachSymbolizer(function (symbolizer) {\n      symbolizer.setZIndex(change);\n    });\n  };\n\n  _proto.show = function show() {\n    if (!this._painted) {\n      var layer = this.getLayer();\n\n      if (!layer.isCanvasRender()) {\n        this.paint();\n      }\n    } else {\n      this.removeCache();\n\n      this._eachSymbolizer(function (symbolizer) {\n        symbolizer.show();\n      });\n    }\n  };\n\n  _proto.hide = function hide() {\n    this._eachSymbolizer(function (symbolizer) {\n      symbolizer.hide();\n    });\n  };\n\n  _proto.repaint = function repaint() {\n    this._altAtGL = this._getGeometryAltitude();\n    this.removeCache();\n    var layer = this.getLayer();\n\n    if (!layer) {\n      return;\n    }\n\n    var renderer = layer.getRenderer();\n\n    if (!renderer || !renderer.setToRedraw()) {\n      return;\n    }\n\n    renderer.setToRedraw();\n  };\n\n  _proto.refreshSymbol = function refreshSymbol() {\n    this.removeCache();\n\n    this._removeSymbolizers();\n\n    this.symbolizers = this._createSymbolizers();\n  };\n\n  _proto.remove = function remove() {\n    this.removeCache();\n\n    this._removeSymbolizers();\n  };\n\n  _proto._removeSymbolizers = function _removeSymbolizers() {\n    this._eachSymbolizer(function (symbolizer) {\n      delete symbolizer.painter;\n      symbolizer.remove();\n    });\n\n    delete this.symbolizers;\n  };\n\n  _proto.removeCache = function removeCache() {\n    delete this._renderPoints;\n    delete this._paintParams;\n    delete this._sprite;\n    delete this._extent2D;\n    delete this._fixedExtent;\n    delete this._cachedParams;\n    delete this._unsimpledParams;\n  };\n\n  _proto.getAltitude = function getAltitude() {\n    var propAlt = this.geometry.getAltitude();\n\n    if (propAlt !== this._propAlt) {\n      this._altAtGL = this._getGeometryAltitude();\n    }\n\n    if (!this._altAtGL) {\n      return 0;\n    }\n\n    return this._altAtGL;\n  };\n\n  _proto.getMinAltitude = function getMinAltitude() {\n    if (!this.minAltitude) {\n      return 0;\n    }\n\n    return this.minAltitude;\n  };\n\n  _proto.getMaxAltitude = function getMaxAltitude() {\n    if (!this.maxAltitude) {\n      return 0;\n    }\n\n    return this.maxAltitude;\n  };\n\n  _proto._getGeometryAltitude = function _getGeometryAltitude() {\n    var _this2 = this;\n\n    var map = this.getMap();\n\n    if (!map) {\n      return 0;\n    }\n\n    var altitude = this.geometry.getAltitude();\n    this._propAlt = altitude;\n\n    if (!altitude) {\n      this.minAltitude = this.maxAltitude = 0;\n      return 0;\n    }\n\n    var center = this.geometry.getCenter();\n\n    if (!center) {\n      return 0;\n    }\n\n    if (Array.isArray(altitude)) {\n      this.minAltitude = Number.MAX_VALUE;\n      this.maxAltitude = Number.MIN_VALUE;\n      return altitude.map(function (alt) {\n        var a = _this2._meterToPoint(center, alt);\n\n        if (a < _this2.minAltitude) {\n          _this2.minAltitude = a;\n        }\n\n        if (a > _this2.maxAltitude) {\n          _this2.maxAltitude = a;\n        }\n\n        return a;\n      });\n    } else {\n      this.minAltitude = this.maxAltitude = this._meterToPoint(center, altitude);\n      return this.minAltitude;\n    }\n  };\n\n  _proto._meterToPoint = function _meterToPoint(center, altitude) {\n    var map = this.getMap();\n    var glRes = map.getGLRes();\n    return map.distanceToPointAtRes(altitude, 0, glRes, center).x * sign(altitude);\n  };\n\n  _proto._verifyProjection = function _verifyProjection() {\n    var projection = this.geometry._getProjection() || PROJECTION;\n\n    if (this._projCode && this._projCode !== projection.code) {\n      this.removeCache();\n    }\n\n    this._projCode = projection.code;\n  };\n\n  _proto._beforePaint = function _beforePaint() {};\n\n  _proto._afterPaint = function _afterPaint() {};\n\n  return Painter;\n}(Class);\n\nfunction interpolateAlt(points, orig, altitude) {\n  if (!Array.isArray(altitude)) {\n    return points;\n  }\n\n  var parts = [];\n\n  for (var i = 0, l = points.length; i < l; i++) {\n    if (Array.isArray(points[i])) {\n      parts.push(interpolateAlt(points[i], orig, altitude));\n    } else {\n      var p = points[i];\n\n      if (!p.point.equals(orig[p.index])) {\n        var w0 = void 0,\n            w1 = void 0;\n\n        if (p.index === 0) {\n          w0 = p.index;\n          w1 = p.index + 1;\n        } else {\n          w0 = p.index - 1;\n          w1 = p.index;\n        }\n\n        var t0 = p.point.distanceTo(orig[w1]);\n        var t = t0 / (t0 + orig[w0].distanceTo(p.point));\n        var alt = interpolate(altitude[w0], altitude[w1], 1 - t);\n        p.altitude = alt;\n        parts.push(p);\n      } else {\n        p.altitude = altitude[p.index];\n        parts.push(p);\n      }\n    }\n  }\n\n  return parts;\n}\n\nvar TEMP_EXTENT$1 = new PointExtent();\n\nvar CollectionPainter = function (_Class) {\n  _inheritsLoose(CollectionPainter, _Class);\n\n  function CollectionPainter(geometry, isMask) {\n    var _this;\n\n    _this = _Class.call(this) || this;\n    _this.geometry = geometry;\n    _this.isMask = isMask;\n    return _this;\n  }\n\n  var _proto = CollectionPainter.prototype;\n\n  _proto._eachPainter = function _eachPainter(fn) {\n    var geometries = this.geometry.getGeometries();\n    var painter;\n\n    for (var i = 0, len = geometries.length; i < len; i++) {\n      painter = this.isMask ? geometries[i]._getMaskPainter() : geometries[i]._getPainter();\n\n      if (!painter) {\n        continue;\n      }\n\n      if (painter) {\n        if (fn.call(this, painter) === false) {\n          break;\n        }\n      }\n    }\n  };\n\n  _proto.paint = function paint(extent) {\n    if (!this.geometry) {\n      return;\n    }\n\n    this._eachPainter(function (painter) {\n      painter.paint(extent);\n    });\n  };\n\n  _proto.get2DExtent = function get2DExtent(resources, out) {\n    if (out) {\n      out.set(null, null, null, null);\n    }\n\n    var extent = out || new PointExtent();\n\n    this._eachPainter(function (painter) {\n      extent = extent._combine(painter.get2DExtent(resources, TEMP_EXTENT$1));\n    });\n\n    return extent;\n  };\n\n  _proto.remove = function remove() {\n    var args = arguments;\n\n    this._eachPainter(function (painter) {\n      painter.remove.apply(painter, args);\n    });\n  };\n\n  _proto.setZIndex = function setZIndex() {\n    var args = arguments;\n\n    this._eachPainter(function (painter) {\n      painter.setZIndex.apply(painter, args);\n    });\n  };\n\n  _proto.show = function show() {\n    var args = arguments;\n\n    this._eachPainter(function (painter) {\n      painter.show.apply(painter, args);\n    });\n  };\n\n  _proto.hide = function hide() {\n    var args = arguments;\n\n    this._eachPainter(function (painter) {\n      painter.hide.apply(painter, args);\n    });\n  };\n\n  _proto.repaint = function repaint() {\n    var args = arguments;\n\n    this._eachPainter(function (painter) {\n      painter.repaint.apply(painter, args);\n    });\n  };\n\n  _proto.refreshSymbol = function refreshSymbol() {\n    var args = arguments;\n\n    this._eachPainter(function (painter) {\n      painter.refreshSymbol.apply(painter, args);\n    });\n  };\n\n  _proto.hasPoint = function hasPoint() {\n    var result = false;\n\n    this._eachPainter(function (painter) {\n      if (painter.hasPoint()) {\n        result = true;\n        return false;\n      }\n\n      return true;\n    });\n\n    return result;\n  };\n\n  _proto.getMinAltitude = function getMinAltitude() {\n    var first = true;\n    var result = 0;\n\n    this._eachPainter(function (painter) {\n      var alt = painter.getMinAltitude();\n\n      if (first || alt < result) {\n        first = false;\n        result = alt;\n      }\n    });\n\n    return result;\n  };\n\n  _proto.getMaxAltitude = function getMaxAltitude() {\n    var result = 0;\n\n    this._eachPainter(function (painter) {\n      var alt = painter.getMaxAltitude();\n\n      if (alt > result) {\n        result = alt;\n      }\n    });\n\n    return result;\n  };\n\n  return CollectionPainter;\n}(Class);\n\nvar MAX_ZOOM = 23;\nvar DefaultSpatialReference = {\n  'EPSG:3857': {\n    'projection': 'EPSG:3857',\n    'resolutions': function () {\n      var resolutions = [];\n      var d = 2 * 6378137 * Math.PI;\n\n      for (var i = 0; i < MAX_ZOOM; i++) {\n        resolutions[i] = d / (256 * Math.pow(2, i));\n      }\n\n      return resolutions;\n    }(),\n    'fullExtent': {\n      'top': 6378137 * Math.PI,\n      'left': -6378137 * Math.PI,\n      'bottom': -6378137 * Math.PI,\n      'right': 6378137 * Math.PI\n    }\n  },\n  'EPSG:4326': {\n    'projection': 'EPSG:4326',\n    'fullExtent': {\n      'top': 90,\n      'left': -180,\n      'bottom': -90,\n      'right': 180\n    },\n    'resolutions': function () {\n      var resolutions = [];\n\n      for (var i = 0; i < MAX_ZOOM; i++) {\n        resolutions[i] = 180 / (Math.pow(2, i) * 128);\n      }\n\n      return resolutions;\n    }()\n  },\n  'BAIDU': {\n    'projection': 'baidu',\n    'resolutions': function () {\n      var res = Math.pow(2, 18);\n      var resolutions = [];\n\n      for (var i = 0; i < MAX_ZOOM; i++) {\n        resolutions[i] = res;\n        res *= 0.5;\n      }\n\n      return resolutions;\n    }(),\n    'fullExtent': {\n      'top': 33554432,\n      'left': -33554432,\n      'bottom': -33554432,\n      'right': 33554432\n    }\n  },\n  'IDENTITY': {\n    'projection': 'identity',\n    'resolutions': function () {\n      var res = Math.pow(2, 8);\n      var resolutions = [];\n\n      for (var i = 0; i < MAX_ZOOM; i++) {\n        resolutions[i] = res;\n        res *= 0.5;\n      }\n\n      return resolutions;\n    }(),\n    'fullExtent': {\n      'top': 200000,\n      'left': -200000,\n      'bottom': -200000,\n      'right': 200000\n    }\n  },\n  'PRESET-VT-3857': {\n    'projection': 'EPSG:3857',\n    'resolutions': function () {\n      var resolutions = [];\n      var d = 6378137 * Math.PI;\n\n      for (var i = 0; i < MAX_ZOOM; i++) {\n        resolutions[i] = d / (256 * Math.pow(2, i));\n      }\n\n      return resolutions;\n    }(),\n    'fullExtent': {\n      'top': 6378137 * Math.PI,\n      'left': -6378137 * Math.PI,\n      'bottom': -6378137 * Math.PI,\n      'right': 6378137 * Math.PI\n    }\n  }\n};\nDefaultSpatialReference['EPSG:4490'] = DefaultSpatialReference['EPSG:4326'];\n\nvar SpatialReference = function () {\n  function SpatialReference(options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    this.options = options;\n\n    this._initSpatialRef();\n  }\n\n  SpatialReference.getPreset = function getPreset(preset) {\n    return DefaultSpatialReference[preset.toUpperCase()];\n  };\n\n  SpatialReference.getAllPresets = function getAllPresets() {\n    return Object.keys(DefaultSpatialReference);\n  };\n\n  SpatialReference.getProjectionInstance = function getProjectionInstance(prjName) {\n    if (!prjName) {\n      return null;\n    }\n\n    if (isObject(prjName)) {\n      if (!prjName.locate) {\n        prjName = extend({}, prjName);\n\n        if (prjName.measure === 'identity') {\n          extend(prjName, Measurer.getInstance('IDENTITY'));\n        } else {\n          extend(prjName, Measurer.getInstance('EPSG:4326'));\n        }\n      }\n\n      return prjName;\n    }\n\n    prjName = (prjName + '').toLowerCase();\n\n    for (var p in projections) {\n      if (hasOwn(projections, p)) {\n        var code = projections[p]['code'];\n\n        if (code && code.toLowerCase() === prjName) {\n          return projections[p];\n        }\n      }\n    }\n\n    return null;\n  };\n\n  SpatialReference.equals = function equals(sp1, sp2) {\n    if (isString(sp1) || isString(sp2)) {\n      return sp1 === sp2;\n    }\n\n    if (!sp1 && !sp2) {\n      return true;\n    } else if (!sp1 || !sp2) {\n      return false;\n    }\n\n    if (sp1.projection !== sp2.projection) {\n      return false;\n    }\n\n    var f1 = sp1.fullExtent,\n        f2 = sp2.fullExtent;\n\n    if (f1 && !f2 || !f1 && f2) {\n      return false;\n    }\n\n    if (f1 && f2) {\n      if (f1.top !== f2.top || f1.bottom !== f2.bottom || f1.left !== f2.left || f1.right !== f2.right) {\n        return false;\n      }\n    }\n\n    var r1 = sp1.resolutions,\n        r2 = sp2.resolutions;\n\n    if (r1 && r2) {\n      if (r1.length !== r2.length) {\n        return false;\n      }\n\n      for (var i = 0; i < r1.length; i++) {\n        if (r1[i] !== r2[i]) {\n          return false;\n        }\n      }\n    } else if (r1 || r2) {\n      return false;\n    }\n\n    return true;\n  };\n\n  var _proto = SpatialReference.prototype;\n\n  _proto._initSpatialRef = function _initSpatialRef() {\n    var projection = this.options['projection'];\n\n    if (projection) {\n      projection = SpatialReference.getProjectionInstance(projection);\n    } else {\n      projection = DEFAULT$1;\n    }\n\n    if (!projection) {\n      throw new Error('must provide a valid projection in map\\'s spatial reference.');\n    }\n\n    projection = extend({}, Common, projection);\n\n    if (!projection.measureLength) {\n      extend(projection, Measurer.DEFAULT);\n    }\n\n    this._projection = projection;\n    var defaultSpatialRef,\n        resolutions = this.options['resolutions'];\n\n    if (!resolutions) {\n      if (projection['code']) {\n        defaultSpatialRef = DefaultSpatialReference[projection['code'].toUpperCase()];\n\n        if (defaultSpatialRef) {\n          resolutions = defaultSpatialRef['resolutions'];\n          this.isEPSG = projection['code'] !== 'IDENTITY';\n        }\n      }\n\n      if (!resolutions) {\n        throw new Error('must provide valid resolutions in map\\'s spatial reference.');\n      }\n    }\n\n    this._resolutions = resolutions;\n    this._pyramid = true;\n\n    if (this._pyramid) {\n      for (var i = 0; i < resolutions.length; i++) {\n        if (resolutions[i] && resolutions[i - 1]) {\n          if (resolutions[i - 1] / resolutions[i] !== 2) {\n            this._pyramid = false;\n            break;\n          }\n        }\n      }\n    }\n\n    var fullExtent = this.options['fullExtent'];\n\n    if (!fullExtent) {\n      if (projection['code']) {\n        defaultSpatialRef = DefaultSpatialReference[projection['code'].toUpperCase()];\n\n        if (defaultSpatialRef) {\n          fullExtent = defaultSpatialRef['fullExtent'];\n        }\n      }\n\n      if (!fullExtent) {\n        throw new Error('must provide a valid fullExtent in map\\'s spatial reference.');\n      }\n    }\n\n    if (!isNil(fullExtent['left'])) {\n      this._fullExtent = new Extent(new Coordinate(fullExtent['left'], fullExtent['top']), new Coordinate(fullExtent['right'], fullExtent['bottom']));\n    } else {\n      this._fullExtent = new Extent(fullExtent);\n      fullExtent['left'] = fullExtent['xmin'];\n      fullExtent['right'] = fullExtent['xmax'];\n      fullExtent['top'] = fullExtent['ymax'];\n      fullExtent['bottom'] = fullExtent['ymin'];\n    }\n\n    if (isNil(fullExtent['top']) || isNil(fullExtent['bottom']) || isNil(fullExtent['left']) || isNil(fullExtent['right'])) {\n      throw new Error('must provide valid top/bottom/left/right in fullExtent.');\n    }\n\n    extend(this._fullExtent, fullExtent);\n    this._projection.fullExtent = fullExtent;\n    var a = fullExtent['right'] >= fullExtent['left'] ? 1 : -1,\n        b = fullExtent['top'] >= fullExtent['bottom'] ? -1 : 1;\n    this._transformation = new Transformation([a, b, 0, 0]);\n  };\n\n  _proto.getResolutions = function getResolutions() {\n    return this._resolutions || [];\n  };\n\n  _proto.getResolution = function getResolution(zoom) {\n    var z = zoom | 0;\n\n    if (z < 0) {\n      z = 0;\n    } else if (z > this._resolutions.length - 1) {\n      z = this._resolutions.length - 1;\n    }\n\n    var res = this._resolutions[z];\n\n    if (z !== zoom && zoom > 0 && z < this._resolutions.length - 1) {\n      var next = this._resolutions[z + 1];\n      return res + (next - res) * (zoom - z);\n    }\n\n    return res;\n  };\n\n  _proto.getProjection = function getProjection() {\n    return this._projection;\n  };\n\n  _proto.getFullExtent = function getFullExtent() {\n    return this._fullExtent;\n  };\n\n  _proto.getTransformation = function getTransformation() {\n    return this._transformation;\n  };\n\n  _proto.getMinZoom = function getMinZoom() {\n    for (var i = 0; i < this._resolutions.length; i++) {\n      if (!isNil(this._resolutions[i])) {\n        return i;\n      }\n    }\n\n    return 0;\n  };\n\n  _proto.getMaxZoom = function getMaxZoom() {\n    for (var i = this._resolutions.length - 1; i >= 0; i--) {\n      if (!isNil(this._resolutions[i])) {\n        return i;\n      }\n    }\n\n    return this._resolutions.length - 1;\n  };\n\n  _proto.getZoomDirection = function getZoomDirection() {\n    return sign(this._resolutions[this.getMinZoom()] - this._resolutions[this.getMaxZoom()]);\n  };\n\n  _proto.toJSON = function toJSON() {\n    if (!this.json) {\n      this.json = {\n        'resolutions': this._resolutions,\n        'fullExtent': {\n          'top': this._fullExtent.top,\n          'left': this._fullExtent.left,\n          'bottom': this._fullExtent.bottom,\n          'right': this._fullExtent.right\n        },\n        'projection': this._projection.code\n      };\n    }\n\n    return this.json;\n  };\n\n  _proto.isPyramid = function isPyramid() {\n    return this._pyramid;\n  };\n\n  return SpatialReference;\n}();\n\nvar TEMP_POINT0$3 = new Point(0, 0);\nvar TEMP_EXTENT$2 = new PointExtent();\nvar options = {\n  'id': null,\n  'visible': true,\n  'interactive': true,\n  'editable': true,\n  'cursor': null,\n  'defaultProjection': 'EPSG:4326'\n};\n\nvar Geometry = function (_JSONAble) {\n  _inheritsLoose(Geometry, _JSONAble);\n\n  function Geometry(options) {\n    var _this;\n\n    var opts = extend({}, options);\n    var symbol = opts['symbol'];\n    var properties = opts['properties'];\n    var id = opts['id'];\n    delete opts['symbol'];\n    delete opts['id'];\n    delete opts['properties'];\n    _this = _JSONAble.call(this, opts) || this;\n\n    if (symbol) {\n      _this.setSymbol(symbol);\n    } else {\n      _this._genSizeSymbol();\n    }\n\n    if (properties) {\n      _this.setProperties(properties);\n    }\n\n    if (!isNil(id)) {\n      _this.setId(id);\n    }\n\n    return _this;\n  }\n\n  var _proto = Geometry.prototype;\n\n  _proto.getFirstCoordinate = function getFirstCoordinate() {\n    if (this.type === 'GeometryCollection') {\n      var geometries = this.getGeometries();\n\n      if (!geometries.length) {\n        return null;\n      }\n\n      return geometries[0].getFirstCoordinate();\n    }\n\n    var coordinates = this.getCoordinates();\n\n    if (!Array.isArray(coordinates)) {\n      return coordinates;\n    }\n\n    do {\n      coordinates = coordinates[0];\n    } while (Array.isArray(coordinates) && coordinates.length > 0);\n\n    return coordinates;\n  };\n\n  _proto.getLastCoordinate = function getLastCoordinate() {\n    if (this.type === 'GeometryCollection') {\n      var geometries = this.getGeometries();\n\n      if (!geometries.length) {\n        return null;\n      }\n\n      return geometries[geometries.length - 1].getLastCoordinate();\n    }\n\n    var coordinates = this.getCoordinates();\n\n    if (!Array.isArray(coordinates)) {\n      return coordinates;\n    }\n\n    do {\n      coordinates = coordinates[coordinates.length - 1];\n    } while (Array.isArray(coordinates) && coordinates.length > 0);\n\n    return coordinates;\n  };\n\n  _proto.addTo = function addTo(layer, fitview) {\n    layer.addGeometry(this, fitview);\n    return this;\n  };\n\n  _proto.getLayer = function getLayer() {\n    if (!this._layer) {\n      return null;\n    }\n\n    return this._layer;\n  };\n\n  _proto.getMap = function getMap() {\n    if (!this._layer) {\n      return null;\n    }\n\n    return this._layer.getMap();\n  };\n\n  _proto.getId = function getId() {\n    return this._id;\n  };\n\n  _proto.setId = function setId(id) {\n    var oldId = this.getId();\n    this._id = id;\n\n    this._fireEvent('idchange', {\n      'old': oldId,\n      'new': id\n    });\n\n    return this;\n  };\n\n  _proto.getProperties = function getProperties() {\n    if (!this.properties) {\n      if (this._getParent()) {\n        return this._getParent().getProperties();\n      }\n\n      return null;\n    }\n\n    return this.properties;\n  };\n\n  _proto.setProperties = function setProperties(properties) {\n    var old = this.properties;\n    this.properties = isObject(properties) ? extend({}, properties) : properties;\n\n    this._repaint();\n\n    this._fireEvent('propertieschange', {\n      'old': old,\n      'new': properties\n    });\n\n    return this;\n  };\n\n  _proto.getType = function getType() {\n    return this.type;\n  };\n\n  _proto.getSymbol = function getSymbol() {\n    var s = this._symbol;\n\n    if (s) {\n      if (!Array.isArray(s)) {\n        return extend({}, s);\n      } else {\n        return extendSymbol(s);\n      }\n    }\n\n    return null;\n  };\n\n  _proto.setSymbol = function setSymbol(symbol) {\n    this._symbolUpdated = symbol;\n    this._symbol = this._prepareSymbol(symbol);\n    this.onSymbolChanged();\n    delete this._compiledSymbol;\n    delete this._symbolHash;\n    return this;\n  };\n\n  _proto.getSymbolHash = function getSymbolHash$$1() {\n    if (!this._symbolHash) {\n      this._symbolHash = getSymbolHash(this._symbolUpdated);\n    }\n\n    return this._symbolHash;\n  };\n\n  _proto.updateSymbol = function updateSymbol(props) {\n    if (!props) {\n      return this;\n    }\n\n    var s = this._getSymbol();\n\n    if (Array.isArray(s)) {\n      if (!Array.isArray(props)) {\n        throw new Error('Parameter of updateSymbol is not an array.');\n      }\n\n      for (var i = 0; i < props.length; i++) {\n        if (isTextSymbol(props[i])) {\n          delete this._textDesc;\n        }\n\n        if (s[i] && props[i]) {\n          s[i] = extendSymbol(s[i], props[i]);\n        }\n      }\n    } else if (Array.isArray(props)) {\n      throw new Error('Geometry\\'s symbol is not an array to update.');\n    } else {\n      if (isTextSymbol(s)) {\n        delete this._textDesc;\n      }\n\n      if (s) {\n        s = extendSymbol(s, props);\n      } else {\n        s = extendSymbol(this._getInternalSymbol(), props);\n      }\n    }\n\n    this._eventSymbolProperties = props;\n    delete this._compiledSymbol;\n    return this.setSymbol(s);\n  };\n\n  _proto.getTextContent = function getTextContent() {\n    var symbol = this._getInternalSymbol();\n\n    if (Array.isArray(symbol)) {\n      var contents = [];\n      var has = false;\n\n      for (var i = 0; i < symbol.length; i++) {\n        contents[i] = replaceVariable(symbol[i] && symbol[i]['textName'], this.getProperties());\n\n        if (!isNil(contents[i])) {\n          has = true;\n        }\n      }\n\n      return has ? contents : null;\n    }\n\n    return replaceVariable(symbol && symbol['textName'], this.getProperties());\n  };\n\n  _proto.getTextDesc = function getTextDesc() {\n    if (!this._textDesc) {\n      var textContent = this.getTextContent();\n      var symbol = this._sizeSymbol;\n      var isArray = Array.isArray(textContent);\n\n      if (Array.isArray(symbol)) {\n        this._textDesc = symbol.map(function (s, i) {\n          return describeText(isArray ? textContent[i] : '', s);\n        });\n      } else {\n        this._textDesc = describeText(textContent, symbol);\n      }\n    }\n\n    return this._textDesc;\n  };\n\n  _proto.getCenter = function getCenter() {\n    return this._computeCenter(this._getMeasurer());\n  };\n\n  _proto.getExtent = function getExtent() {\n    var prjExt = this._getPrjExtent();\n\n    var projection = this._getProjection();\n\n    if (prjExt && projection) {\n      var min = projection.unproject(new Coordinate(prjExt['xmin'], prjExt['ymin'])),\n          max = projection.unproject(new Coordinate(prjExt['xmax'], prjExt['ymax']));\n      return new Extent(min, max, projection);\n    } else {\n      return this._computeExtent(this._getMeasurer());\n    }\n  };\n\n  _proto.getContainerExtent = function getContainerExtent(out) {\n    var extent2d = this.get2DExtent();\n\n    if (!extent2d || !extent2d.isValid()) {\n      return null;\n    }\n\n    var map = this.getMap();\n    var center = this.getCenter();\n    var glRes = map.getGLRes();\n    var minAltitude = this.getMinAltitude();\n    var altitude = map.distanceToPointAtRes(minAltitude, 0, glRes, center).x * sign(minAltitude);\n    var extent = extent2d.convertTo(function (c) {\n      return map._pointAtResToContainerPoint(c, glRes, altitude, TEMP_POINT0$3);\n    }, out);\n    var maxAltitude = this.getMaxAltitude();\n\n    if (maxAltitude !== minAltitude) {\n      maxAltitude = map.distanceToPointAtRes(maxAltitude, 0, glRes, center).x * sign(maxAltitude);\n      var extent2 = extent2d.convertTo(function (c) {\n        return map._pointAtResToContainerPoint(c, glRes, maxAltitude, TEMP_POINT0$3);\n      }, TEMP_EXTENT$2);\n\n      extent._combine(extent2);\n    }\n\n    var layer = this.getLayer();\n\n    if (layer && this.type === 'LineString' && maxAltitude && layer.options['drawAltitude']) {\n      var groundExtent = extent2d.convertTo(function (c) {\n        return map._pointAtResToContainerPoint(c, glRes, 0, TEMP_POINT0$3);\n      }, TEMP_EXTENT$2);\n\n      extent._combine(groundExtent);\n    }\n\n    if (extent) {\n      extent._add(this._getFixedExtent());\n    }\n\n    var smoothness = this.options['smoothness'];\n\n    if (smoothness) {\n      extent._expand(extent.getWidth() * 0.15);\n    }\n\n    return extent;\n  };\n\n  _proto._getFixedExtent = function _getFixedExtent() {\n    if (!this._fixedExtent) {\n      this._fixedExtent = new PointExtent();\n    }\n\n    var symbol = this._sizeSymbol;\n    var t = (symbol && symbol['lineWidth'] || 1) / 2;\n\n    this._fixedExtent.set(-t, -t, t, t);\n\n    var dx = symbol && symbol['lineDx'] || 0;\n\n    this._fixedExtent._add([dx, 0]);\n\n    var dy = symbol && symbol['lineDy'] || 0;\n\n    this._fixedExtent._add([0, dy]);\n\n    return this._fixedExtent;\n  };\n\n  _proto.get2DExtent = function get2DExtent() {\n    var map = this.getMap();\n\n    if (!map) {\n      return null;\n    }\n\n    if (this._extent2d) {\n      return this._extent2d;\n    }\n\n    var extent = this._getPrjExtent();\n\n    if (!extent || !extent.isValid()) {\n      return null;\n    }\n\n    var min = extent.getMin();\n    var max = extent.getMax();\n    var glRes = map.getGLRes();\n\n    map._prjToPointAtRes(min, glRes, min);\n\n    map._prjToPointAtRes(max, glRes, max);\n\n    this._extent2d = new PointExtent(min, max);\n    this._extent2d.z = map.getZoom();\n    return this._extent2d;\n  };\n\n  _proto.getSize = function getSize() {\n    var extent = this.getContainerExtent();\n    return extent ? extent.getSize() : null;\n  };\n\n  _proto.containsPoint = function containsPoint(containerPoint, t) {\n    if (!this.getMap()) {\n      throw new Error('The geometry is required to be added on a map to perform \"containsPoint\".');\n    }\n\n    if (containerPoint instanceof Coordinate) {\n      containerPoint = this.getMap().coordToContainerPoint(containerPoint);\n    }\n\n    return this._containsPoint(containerPoint, t);\n  };\n\n  _proto._containsPoint = function _containsPoint(containerPoint, t) {\n    var painter = this._getPainter();\n\n    if (!painter) {\n      return false;\n    }\n\n    if (isNil(t) && this._hitTestTolerance) {\n      t = this._hitTestTolerance();\n    }\n\n    return painter.hitTest(containerPoint, t);\n  };\n\n  _proto.show = function show() {\n    this.options['visible'] = true;\n\n    if (this.getMap()) {\n      var painter = this._getPainter();\n\n      if (painter) {\n        painter.show();\n      }\n\n      this._fireEvent('show');\n    }\n\n    return this;\n  };\n\n  _proto.hide = function hide() {\n    this.options['visible'] = false;\n\n    if (this.getMap()) {\n      this.onHide();\n\n      var painter = this._getPainter();\n\n      if (painter) {\n        painter.hide();\n      }\n\n      this._fireEvent('hide');\n    }\n\n    return this;\n  };\n\n  _proto.isVisible = function isVisible() {\n    if (!this.options['visible']) {\n      return false;\n    }\n\n    var symbol = this._getInternalSymbol();\n\n    if (!symbol) {\n      return true;\n    }\n\n    if (Array.isArray(symbol)) {\n      if (!symbol.length) {\n        return true;\n      }\n\n      for (var i = 0, l = symbol.length; i < l; i++) {\n        if (isNil(symbol[i]['opacity']) || symbol[i]['opacity'] > 0) {\n          return true;\n        }\n      }\n\n      return false;\n    } else {\n      return isNil(symbol['opacity']) || isObject(symbol['opacity']) || isNumber(symbol['opacity']) && symbol['opacity'] > 0;\n    }\n  };\n\n  _proto.getZIndex = function getZIndex() {\n    return this.options['zIndex'] || 0;\n  };\n\n  _proto.setZIndex = function setZIndex(zIndex) {\n    var old = this.options['zIndex'];\n    this.options['zIndex'] = zIndex;\n\n    this._fireEvent('zindexchange', {\n      'old': old,\n      'new': zIndex\n    });\n\n    return this;\n  };\n\n  _proto.setZIndexSilently = function setZIndexSilently(zIndex) {\n    this.options['zIndex'] = zIndex;\n    return this;\n  };\n\n  _proto.bringToFront = function bringToFront() {\n    var layer = this.getLayer();\n\n    if (!layer || !layer.getGeoMaxZIndex) {\n      return this;\n    }\n\n    var topZ = layer.getGeoMaxZIndex();\n    this.setZIndex(topZ + 1);\n    return this;\n  };\n\n  _proto.bringToBack = function bringToBack() {\n    var layer = this.getLayer();\n\n    if (!layer || !layer.getGeoMinZIndex) {\n      return this;\n    }\n\n    var bottomZ = layer.getGeoMinZIndex();\n    this.setZIndex(bottomZ - 1);\n    return this;\n  };\n\n  _proto.translate = function translate(x, y) {\n    if (isNil(x)) {\n      return this;\n    }\n\n    var offset = new Coordinate(x, y);\n\n    if (offset.x === 0 && offset.y === 0) {\n      return this;\n    }\n\n    var coordinates = this.getCoordinates();\n    this._silence = true;\n\n    if (coordinates) {\n      if (Array.isArray(coordinates)) {\n        var translated = forEachCoord(coordinates, function (coord) {\n          return coord.add(offset);\n        });\n        this.setCoordinates(translated);\n      } else {\n        this.setCoordinates(coordinates.add(offset));\n      }\n    }\n\n    this._silence = false;\n\n    this._fireEvent('positionchange');\n\n    return this;\n  };\n\n  _proto.flash = function flash$$1(interval, count, cb, context) {\n    return flash.call(this, interval, count, cb, context);\n  };\n\n  _proto.copy = function copy() {\n    var json = this.toJSON();\n    var ret = Geometry.fromJSON(json);\n    ret.options['visible'] = true;\n    return ret;\n  };\n\n  _proto.remove = function remove() {\n    var layer = this.getLayer();\n\n    if (!layer) {\n      return this;\n    }\n\n    this._fireEvent('removestart');\n\n    this._unbind();\n\n    this._fireEvent('removeend');\n\n    this._fireEvent('remove');\n\n    return this;\n  };\n\n  _proto.toGeoJSONGeometry = function toGeoJSONGeometry() {\n    var gJson = this._exportGeoJSONGeometry();\n\n    return gJson;\n  };\n\n  _proto.toGeoJSON = function toGeoJSON(opts) {\n    if (!opts) {\n      opts = {};\n    }\n\n    var feature = {\n      'type': 'Feature',\n      'geometry': null\n    };\n\n    if (isNil(opts['geometry']) || opts['geometry']) {\n      var geoJSON = this._exportGeoJSONGeometry();\n\n      feature['geometry'] = geoJSON;\n    }\n\n    var id = this.getId();\n\n    if (!isNil(id)) {\n      feature['id'] = id;\n    }\n\n    var properties;\n\n    if (isNil(opts['properties']) || opts['properties']) {\n      properties = this._exportProperties();\n    }\n\n    feature['properties'] = properties;\n    return feature;\n  };\n\n  _proto.toJSON = function toJSON(options) {\n    if (!options) {\n      options = {};\n    }\n\n    var json = this._toJSON(options);\n\n    var other = this._exportGraphicOptions(options);\n\n    extend(json, other);\n    return json;\n  };\n\n  _proto.getLength = function getLength() {\n    return this._computeGeodesicLength(this._getMeasurer());\n  };\n\n  _proto.getArea = function getArea() {\n    return this._computeGeodesicArea(this._getMeasurer());\n  };\n\n  _proto.rotate = function rotate(angle, pivot) {\n    if (this.type === 'GeometryCollection') {\n      var geometries = this.getGeometries();\n      geometries.forEach(function (g) {\n        return g.rotate(angle, pivot);\n      });\n      return this;\n    }\n\n    if (!pivot) {\n      pivot = this.getCenter();\n    } else {\n      pivot = new Coordinate(pivot);\n    }\n\n    var measurer = this._getMeasurer();\n\n    var coordinates = this.getCoordinates();\n\n    if (!Array.isArray(coordinates)) {\n      if (pivot.x !== coordinates.x || pivot.y !== coordinates.y) {\n        var c = measurer._rotate(coordinates, pivot, angle);\n\n        this.setCoordinates(c);\n      }\n\n      return this;\n    }\n\n    forEachCoord(coordinates, function (c) {\n      return measurer._rotate(c, pivot, angle);\n    });\n    this.setCoordinates(coordinates);\n    return this;\n  };\n\n  _proto._getConnectPoints = function _getConnectPoints() {\n    return [this.getCenter()];\n  };\n\n  _proto._initOptions = function _initOptions(options) {\n    var opts = extend({}, options);\n    var symbol = opts['symbol'];\n    var properties = opts['properties'];\n    var id = opts['id'];\n    delete opts['symbol'];\n    delete opts['id'];\n    delete opts['properties'];\n    this.setOptions(opts);\n\n    if (symbol) {\n      this.setSymbol(symbol);\n    }\n\n    if (properties) {\n      this.setProperties(properties);\n    }\n\n    if (!isNil(id)) {\n      this.setId(id);\n    }\n  };\n\n  _proto._bindLayer = function _bindLayer(layer) {\n    if (this.getLayer()) {\n      throw new Error('Geometry cannot be added to two or more layers at the same time.');\n    }\n\n    this._layer = layer;\n\n    this._clearCache();\n\n    this._bindInfoWindow();\n\n    this._bindMenu();\n  };\n\n  _proto._prepareSymbol = function _prepareSymbol(symbol) {\n    if (Array.isArray(symbol)) {\n      var cookedSymbols = [];\n\n      for (var i = 0; i < symbol.length; i++) {\n        cookedSymbols.push(convertResourceUrl(this._checkAndCopySymbol(symbol[i])));\n      }\n\n      return cookedSymbols;\n    } else if (symbol) {\n      symbol = this._checkAndCopySymbol(symbol);\n      return convertResourceUrl(symbol);\n    }\n\n    return null;\n  };\n\n  _proto._checkAndCopySymbol = function _checkAndCopySymbol(symbol) {\n    var s = {};\n\n    for (var i in symbol) {\n      if (NUMERICAL_PROPERTIES[i] && isString(symbol[i])) {\n        s[i] = +symbol[i];\n      } else {\n        s[i] = symbol[i];\n      }\n    }\n\n    return s;\n  };\n\n  _proto._getSymbol = function _getSymbol() {\n    return this._symbol;\n  };\n\n  _proto._setExternSymbol = function _setExternSymbol(symbol) {\n    this._eventSymbolProperties = symbol;\n\n    if (!this._symbol) {\n      delete this._textDesc;\n    }\n\n    this._externSymbol = this._prepareSymbol(symbol);\n    this.onSymbolChanged();\n    return this;\n  };\n\n  _proto._getInternalSymbol = function _getInternalSymbol() {\n    if (this._symbol) {\n      return this._symbol;\n    } else if (this._externSymbol) {\n      return this._externSymbol;\n    } else if (this.options['symbol']) {\n      return this.options['symbol'];\n    }\n\n    return null;\n  };\n\n  _proto._getPrjExtent = function _getPrjExtent() {\n    var p = this._getProjection();\n\n    this._verifyProjection();\n\n    if (!this._extent && p) {\n      this._extent = this._computePrjExtent(p);\n    }\n\n    return this._extent;\n  };\n\n  _proto._unbind = function _unbind() {\n    var layer = this.getLayer();\n\n    if (!layer) {\n      return;\n    }\n\n    if (this._animPlayer) {\n      this._animPlayer.finish();\n    }\n\n    this._unbindMenu();\n\n    this._unbindInfoWindow();\n\n    if (this.isEditing()) {\n      this.endEdit();\n    }\n\n    this._removePainter();\n\n    if (this.onRemove) {\n      this.onRemove();\n    }\n\n    if (layer.onRemoveGeometry) {\n      layer.onRemoveGeometry(this);\n    }\n\n    delete this._layer;\n    delete this._internalId;\n    delete this._extent;\n  };\n\n  _proto._getInternalId = function _getInternalId() {\n    return this._internalId;\n  };\n\n  _proto._setInternalId = function _setInternalId(id) {\n    this._internalId = id;\n  };\n\n  _proto._getMeasurer = function _getMeasurer() {\n    if (this._getProjection()) {\n      return this._getProjection();\n    }\n\n    return SpatialReference.getProjectionInstance(this.options['defaultProjection']);\n  };\n\n  _proto._getProjection = function _getProjection() {\n    var map = this.getMap();\n\n    if (map) {\n      return map.getProjection();\n    }\n\n    return null;\n  };\n\n  _proto._verifyProjection = function _verifyProjection() {\n    var projection = this._getProjection();\n\n    if (this._projCode && projection && this._projCode !== projection.code) {\n      this._clearProjection();\n    }\n\n    this._projCode = projection ? projection.code : this._projCode;\n  };\n\n  _proto._getExternalResources = function _getExternalResources() {\n    var symbol = this._getInternalSymbol();\n\n    return getExternalResources(symbol);\n  };\n\n  _proto._getPainter = function _getPainter() {\n    var layer = this.getLayer();\n\n    if (!this._painter && layer) {\n      if (GEOMETRY_COLLECTION_TYPES.indexOf(this.type) !== -1) {\n        if (layer.constructor.getCollectionPainterClass) {\n          var clazz = layer.constructor.getCollectionPainterClass();\n\n          if (clazz) {\n            this._painter = new clazz(this);\n          }\n        }\n      } else if (layer.constructor.getPainterClass) {\n        var _clazz = layer.constructor.getPainterClass();\n\n        if (_clazz) {\n          this._painter = new _clazz(this);\n        }\n      }\n    }\n\n    return this._painter;\n  };\n\n  _proto._getMaskPainter = function _getMaskPainter() {\n    if (this._maskPainter) {\n      return this._maskPainter;\n    }\n\n    this._maskPainter = this.getGeometries && this.getGeometries() ? new CollectionPainter(this, true) : new Painter(this);\n    return this._maskPainter;\n  };\n\n  _proto._removePainter = function _removePainter() {\n    if (this._painter) {\n      this._painter.remove();\n    }\n\n    delete this._painter;\n  };\n\n  _proto._paint = function _paint(extent) {\n    if (this._painter) {\n      if (this._dirtyCoords) {\n        delete this._dirtyCoords;\n\n        var projection = this._getProjection();\n\n        if (projection) {\n          this._pcenter = projection.project(this._coordinates);\n\n          this._clearCache();\n        }\n      }\n\n      this._painter.paint(extent);\n    }\n  };\n\n  _proto._clearCache = function _clearCache() {\n    delete this._extent;\n    delete this._extent2d;\n  };\n\n  _proto._clearProjection = function _clearProjection() {\n    delete this._extent;\n    delete this._extent2d;\n  };\n\n  _proto._repaint = function _repaint() {\n    if (this._painter) {\n      this._painter.repaint();\n    }\n  };\n\n  _proto.onHide = function onHide() {\n    this.closeMenu();\n    this.closeInfoWindow();\n  };\n\n  _proto.onShapeChanged = function onShapeChanged() {\n    this._clearCache();\n\n    this._repaint();\n\n    this._fireEvent('shapechange');\n  };\n\n  _proto.onPositionChanged = function onPositionChanged() {\n    this._clearCache();\n\n    this._repaint();\n\n    this._fireEvent('positionchange');\n  };\n\n  _proto.onSymbolChanged = function onSymbolChanged() {\n    if (this._painter) {\n      this._painter.refreshSymbol();\n    }\n\n    var e = {};\n\n    if (this._eventSymbolProperties) {\n      e.properties = extend({}, this._eventSymbolProperties);\n      delete this._eventSymbolProperties;\n    } else {\n      delete this._textDesc;\n    }\n\n    this._genSizeSymbol();\n\n    this._fireEvent('symbolchange', e);\n  };\n\n  _proto._genSizeSymbol = function _genSizeSymbol() {\n    var symbol = this._getInternalSymbol();\n\n    if (!symbol) {\n      delete this._sizeSymbol;\n      return;\n    }\n\n    if (Array.isArray(symbol)) {\n      this._sizeSymbol = [];\n      var dynamicSize = false;\n\n      for (var i = 0; i < symbol.length; i++) {\n        var s = this._sizeSymbol[i] = this._getSizeSymbol(symbol[i]);\n\n        if (!dynamicSize && s && s._dynamic) {\n          dynamicSize = true;\n        }\n      }\n\n      this._sizeSymbol._dynamic = dynamicSize;\n    } else {\n      this._sizeSymbol = this._getSizeSymbol(symbol);\n    }\n  };\n\n  _proto._getSizeSymbol = function _getSizeSymbol(symbol) {\n    var symbolSize = loadGeoSymbol({\n      lineWidth: symbol['lineWidth'],\n      lineDx: symbol['lineDx'],\n      lineDy: symbol['lineDy']\n    }, this);\n\n    if (isFunctionDefinition(symbol['lineWidth']) || isFunctionDefinition(symbol['lineDx']) || isFunctionDefinition(symbol['lineDy'])) {\n      symbolSize._dynamic = true;\n    }\n\n    return symbolSize;\n  };\n\n  _proto._getCompiledSymbol = function _getCompiledSymbol() {\n    if (this._compiledSymbol) {\n      return this._compiledSymbol;\n    }\n\n    this._compiledSymbol = loadGeoSymbol(this._getInternalSymbol(), this);\n    return this._compiledSymbol;\n  };\n\n  _proto.onConfig = function onConfig(conf) {\n    var properties;\n\n    if (conf['properties']) {\n      properties = conf['properties'];\n      delete conf['properties'];\n    }\n\n    var needRepaint = false;\n\n    for (var p in conf) {\n      if (conf.hasOwnProperty(p)) {\n        var prefix = p.slice(0, 5);\n\n        if (prefix === 'arrow' || prefix === 'smoot') {\n          needRepaint = true;\n          break;\n        }\n      }\n    }\n\n    if (properties) {\n      this.setProperties(properties);\n\n      this._repaint();\n    } else if (needRepaint) {\n      this._repaint();\n    }\n  };\n\n  _proto._setParent = function _setParent(geometry) {\n    if (geometry) {\n      this._parent = geometry;\n    }\n  };\n\n  _proto._getParent = function _getParent() {\n    return this._parent;\n  };\n\n  _proto._fireEvent = function _fireEvent(eventName, param) {\n    if (this._silence) {\n      return;\n    }\n\n    if (this.getLayer() && this.getLayer()._onGeometryEvent) {\n      if (!param) {\n        param = {};\n      }\n\n      param['type'] = eventName;\n      param['target'] = this;\n\n      this.getLayer()._onGeometryEvent(param);\n    }\n\n    this.fire(eventName, param);\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    return {\n      'feature': this.toGeoJSON(options)\n    };\n  };\n\n  _proto._exportGraphicOptions = function _exportGraphicOptions(options) {\n    var json = {};\n\n    if (isNil(options['options']) || options['options']) {\n      json['options'] = this.config();\n    }\n\n    if (isNil(options['symbol']) || options['symbol']) {\n      json['symbol'] = this.getSymbol();\n    }\n\n    if (isNil(options['infoWindow']) || options['infoWindow']) {\n      if (this._infoWinOptions) {\n        json['infoWindow'] = this._infoWinOptions;\n      }\n    }\n\n    return json;\n  };\n\n  _proto._exportGeoJSONGeometry = function _exportGeoJSONGeometry() {\n    var points = this.getCoordinates();\n    var coordinates = Coordinate.toNumberArrays(points);\n    return {\n      'type': this.getType(),\n      'coordinates': coordinates\n    };\n  };\n\n  _proto._exportProperties = function _exportProperties() {\n    var properties = null;\n    var geoProperties = this.getProperties();\n\n    if (!isNil(geoProperties)) {\n      if (isObject(geoProperties)) {\n        properties = extend({}, geoProperties);\n      } else {\n        properties = geoProperties;\n      }\n    }\n\n    return properties;\n  };\n\n  _proto.getAltitude = function getAltitude() {\n    var layer = this.getLayer();\n\n    if (!layer) {\n      return 0;\n    }\n\n    var layerOpts = layer.options,\n        properties = this.getProperties();\n    var altitude = layerOpts['enableAltitude'] ? properties ? properties[layerOpts['altitudeProperty']] : 0 : 0;\n    var layerAltitude = layer.getAltitude ? layer.getAltitude() : 0;\n\n    if (Array.isArray(altitude)) {\n      return altitude.map(function (alt) {\n        return alt + layerAltitude;\n      });\n    }\n\n    return altitude + layerAltitude;\n  };\n\n  _proto._genMinMaxAlt = function _genMinMaxAlt() {\n    var _this2 = this;\n\n    var altitude = this.getAltitude();\n\n    if (Array.isArray(altitude)) {\n      this._minAlt = Number.MAX_VALUE;\n      this._maxAlt = Number.MIN_VALUE;\n      altitude.forEach(function (alt) {\n        var a = alt;\n\n        if (a < _this2._minAlt) {\n          _this2._minAlt = a;\n        }\n\n        if (a > _this2._maxAlt) {\n          _this2._maxAlt = a;\n        }\n      });\n    } else {\n      this._minAlt = this._maxAlt = altitude;\n    }\n  };\n\n  _proto.getMinAltitude = function getMinAltitude() {\n    if (this._minAlt === undefined) {\n      this._genMinMaxAlt();\n    }\n\n    if (!this._minAlt) {\n      return 0;\n    }\n\n    return this._minAlt;\n  };\n\n  _proto.getMaxAltitude = function getMaxAltitude() {\n    if (this._maxAlt === undefined) {\n      this._genMinMaxAlt();\n    }\n\n    if (!this._maxAlt) {\n      return 0;\n    }\n\n    return this._maxAlt;\n  };\n\n  return Geometry;\n}(JSONAble(Eventable(Handlerable(Class))));\n\nGeometry.mergeOptions(options);\n\nvar options$1 = {\n  'attribution': null,\n  'minZoom': null,\n  'maxZoom': null,\n  'visible': true,\n  'opacity': 1,\n  'globalCompositeOperation': null,\n  'renderer': 'canvas',\n  'debugOutline': '#0f0',\n  'cssFilter': null,\n  'forceRenderOnMoving': false,\n  'forceRenderOnZooming': false,\n  'forceRenderOnRotating': false,\n  'collision': false,\n  'collisionScope': 'layer',\n  'hitDetect': function () {\n    return !Browser$1.mobile;\n  }()\n};\n\nvar Layer = function (_JSONAble) {\n  _inheritsLoose(Layer, _JSONAble);\n\n  function Layer(id, options) {\n    var _this;\n\n    var canvas;\n\n    if (options) {\n      canvas = options.canvas;\n      delete options.canvas;\n    }\n\n    _this = _JSONAble.call(this, options) || this;\n    _this._canvas = canvas;\n\n    _this.setId(id);\n\n    if (options) {\n      _this.setZIndex(options.zIndex);\n\n      if (options.mask) {\n        _this.setMask(Geometry.fromJSON(options.mask));\n      }\n    }\n\n    return _this;\n  }\n\n  var _proto = Layer.prototype;\n\n  _proto.load = function load() {\n    if (!this.getMap()) {\n      return this;\n    }\n\n    if (this.onLoad()) {\n      this._initRenderer();\n\n      var zIndex = this.getZIndex();\n\n      if (!isNil(zIndex)) {\n        this._renderer.setZIndex(zIndex);\n\n        if (!this.isCanvasRender()) {\n          this._renderer.render();\n        }\n      }\n\n      this.onLoadEnd();\n    }\n\n    return this;\n  };\n\n  _proto.getId = function getId() {\n    return this._id;\n  };\n\n  _proto.setId = function setId(id) {\n    var old = this._id;\n\n    if (!isNil(id)) {\n      id = id + '';\n    }\n\n    this._id = id;\n    this.fire('idchange', {\n      'old': old,\n      'new': id\n    });\n    return this;\n  };\n\n  _proto.addTo = function addTo(map) {\n    map.addLayer(this);\n    return this;\n  };\n\n  _proto.setZIndex = function setZIndex(zIndex) {\n    this._zIndex = zIndex;\n\n    if (isNil(zIndex)) {\n      delete this.options['zIndex'];\n    } else {\n      this.options.zIndex = zIndex;\n    }\n\n    if (this.map) {\n      this.map._sortLayersByZIndex();\n    }\n\n    if (this._renderer) {\n      this._renderer.setZIndex(zIndex);\n    }\n\n    return this;\n  };\n\n  _proto.getZIndex = function getZIndex() {\n    return this._zIndex || 0;\n  };\n\n  _proto.getMinZoom = function getMinZoom() {\n    var map = this.getMap();\n    var minZoom = this.options['minZoom'];\n    return map ? Math.max(map.getMinZoom(), minZoom || 0) : minZoom;\n  };\n\n  _proto.getMaxZoom = function getMaxZoom() {\n    var map = this.getMap();\n    var maxZoom = this.options['maxZoom'];\n    return map ? Math.min(map.getMaxZoom(), isNil(maxZoom) ? Infinity : maxZoom) : maxZoom;\n  };\n\n  _proto.getOpacity = function getOpacity() {\n    return this.options['opacity'];\n  };\n\n  _proto.setOpacity = function setOpacity(op) {\n    this.config('opacity', op);\n    return this;\n  };\n\n  _proto.isCanvasRender = function isCanvasRender() {\n    var renderer = this._getRenderer();\n\n    return renderer && renderer instanceof CanvasRenderer;\n  };\n\n  _proto.getMap = function getMap() {\n    if (this.map) {\n      return this.map;\n    }\n\n    return null;\n  };\n\n  _proto.getProjection = function getProjection() {\n    var map = this.getMap();\n    return map ? map.getProjection() : null;\n  };\n\n  _proto.bringToFront = function bringToFront() {\n    var layers = this._getLayerList();\n\n    if (!layers.length) {\n      return this;\n    }\n\n    var topLayer = layers[layers.length - 1];\n\n    if (layers.length === 1 || topLayer === this) {\n      return this;\n    }\n\n    var max = topLayer.getZIndex();\n    this.setZIndex(max + 1);\n    return this;\n  };\n\n  _proto.bringToBack = function bringToBack() {\n    var layers = this._getLayerList();\n\n    if (!layers.length) {\n      return this;\n    }\n\n    var bottomLayer = layers[0];\n\n    if (layers.length === 1 || bottomLayer === this) {\n      return this;\n    }\n\n    var min = bottomLayer.getZIndex();\n    this.setZIndex(min - 1);\n    return this;\n  };\n\n  _proto.show = function show() {\n    var _this2 = this;\n\n    if (!this.options['visible']) {\n      this.options['visible'] = true;\n      var renderer = this.getRenderer();\n\n      if (renderer) {\n        renderer.show();\n      }\n\n      var map = this.getMap();\n\n      if (renderer && map) {\n        map.once('renderend', function () {\n          _this2.fire('show');\n        });\n      } else {\n        this.fire('show');\n      }\n    }\n\n    return this;\n  };\n\n  _proto.hide = function hide() {\n    var _this3 = this;\n\n    if (this.options['visible']) {\n      this.options['visible'] = false;\n      var renderer = this.getRenderer();\n\n      if (renderer) {\n        renderer.hide();\n      }\n\n      var map = this.getMap();\n\n      if (renderer && map) {\n        map.once('renderend', function () {\n          _this3.fire('hide');\n        });\n      } else {\n        this.fire('hide');\n      }\n    }\n\n    return this;\n  };\n\n  _proto.isVisible = function isVisible() {\n    if (isNumber(this.options['opacity']) && this.options['opacity'] <= 0) {\n      return false;\n    }\n\n    var map = this.getMap();\n\n    if (map) {\n      var zoom = map.getZoom();\n\n      if (!isNil(this.options['maxZoom']) && this.options['maxZoom'] < zoom || !isNil(this.options['minZoom']) && this.options['minZoom'] > zoom) {\n        return false;\n      }\n    }\n\n    if (isNil(this.options['visible'])) {\n      this.options['visible'] = true;\n    }\n\n    return this.options['visible'];\n  };\n\n  _proto.remove = function remove() {\n    if (this.map) {\n      this.map.removeLayer(this);\n    }\n\n    return this;\n  };\n\n  _proto.getMask = function getMask() {\n    return this._mask;\n  };\n\n  _proto.setMask = function setMask(mask) {\n    if (!(mask.type === 'Point' && mask._isVectorMarker() || mask.type === 'Polygon' || mask.type === 'MultiPolygon')) {\n      throw new Error('Mask for a layer must be a marker with vector marker symbol or a Polygon(MultiPolygon).');\n    }\n\n    mask._bindLayer(this);\n\n    if (mask.type === 'Point') {\n      mask.updateSymbol({\n        'markerLineColor': 'rgba(0, 0, 0, 0)',\n        'markerFillOpacity': 0\n      });\n    } else {\n      mask.setSymbol({\n        'lineColor': 'rgba(0, 0, 0, 0)',\n        'polygonOpacity': 0\n      });\n    }\n\n    this._mask = mask;\n    this.options.mask = mask.toJSON();\n\n    if (!this.getMap() || this.getMap().isZooming()) {\n      return this;\n    }\n\n    var renderer = this._getRenderer();\n\n    if (renderer && renderer.setToRedraw) {\n      this._getRenderer().setToRedraw();\n    }\n\n    return this;\n  };\n\n  _proto.removeMask = function removeMask() {\n    delete this._mask;\n    delete this.options.mask;\n\n    if (!this.getMap() || this.getMap().isZooming()) {\n      return this;\n    }\n\n    var renderer = this._getRenderer();\n\n    if (renderer && renderer.setToRedraw) {\n      this._getRenderer().setToRedraw();\n    }\n\n    return this;\n  };\n\n  _proto.onLoad = function onLoad() {\n    return true;\n  };\n\n  _proto.onLoadEnd = function onLoadEnd() {};\n\n  _proto.isLoaded = function isLoaded() {\n    return !!this._loaded;\n  };\n\n  _proto.getCollisionIndex = function getCollisionIndex() {\n    if (this.options['collisionScope'] === 'layer') {\n      if (!this._collisionIndex) {\n        this._collisionIndex = new CollisionIndex();\n      }\n\n      return this._collisionIndex;\n    }\n\n    var map = this.getMap();\n\n    if (!map) {\n      return null;\n    }\n\n    return map.getCollisionIndex();\n  };\n\n  _proto.clearCollisionIndex = function clearCollisionIndex() {\n    if (this.options['collisionScope'] === 'layer' && this._collisionIndex) {\n      this._collisionIndex.clear();\n    }\n\n    return this;\n  };\n\n  _proto.getRenderer = function getRenderer() {\n    return this._getRenderer();\n  };\n\n  _proto.onConfig = function onConfig(conf) {\n    if (isNumber(conf['opacity']) || conf['cssFilter']) {\n      var renderer = this.getRenderer();\n\n      if (renderer) {\n        renderer.setToRedraw();\n      }\n    }\n  };\n\n  _proto.onAdd = function onAdd() {};\n\n  _proto.onRendererCreate = function onRendererCreate() {};\n\n  _proto.onCanvasCreate = function onCanvasCreate() {};\n\n  _proto.onRemove = function onRemove() {};\n\n  _proto._bindMap = function _bindMap(map, zIndex) {\n    if (!map) {\n      return;\n    }\n\n    this.map = map;\n\n    if (!isNil(zIndex)) {\n      this.setZIndex(zIndex);\n    }\n\n    this._switchEvents('on', this);\n\n    this.onAdd();\n    this.fire('add');\n  };\n\n  _proto._initRenderer = function _initRenderer() {\n    var renderer = this.options['renderer'];\n\n    if (!this.constructor.getRendererClass) {\n      return;\n    }\n\n    var clazz = this.constructor.getRendererClass(renderer);\n\n    if (!clazz) {\n      throw new Error('Invalid renderer for Layer(' + this.getId() + '):' + renderer);\n    }\n\n    this._renderer = new clazz(this);\n    this._renderer.layer = this;\n\n    this._renderer.setZIndex(this.getZIndex());\n\n    this._switchEvents('on', this._renderer);\n\n    if (this._renderer.onAdd) {\n      this._renderer.onAdd();\n    }\n\n    this.onRendererCreate();\n    this.fire('renderercreate', {\n      'renderer': this._renderer\n    });\n  };\n\n  _proto._doRemove = function _doRemove() {\n    this._loaded = false;\n    this.onRemove();\n\n    this._switchEvents('off', this);\n\n    if (this._renderer) {\n      this._switchEvents('off', this._renderer);\n\n      this._renderer.remove();\n\n      delete this._renderer;\n    }\n\n    delete this.map;\n    delete this._collisionIndex;\n  };\n\n  _proto._switchEvents = function _switchEvents(to, emitter) {\n    if (emitter && emitter.getEvents) {\n      this.getMap()[to](emitter.getEvents(), emitter);\n    }\n  };\n\n  _proto._getRenderer = function _getRenderer() {\n    return this._renderer;\n  };\n\n  _proto._getLayerList = function _getLayerList() {\n    if (!this.map) {\n      return [];\n    }\n\n    return this.map._layers;\n  };\n\n  _proto._getMask2DExtent = function _getMask2DExtent() {\n    if (!this._mask || !this.getMap()) {\n      return null;\n    }\n\n    var painter = this._mask._getMaskPainter();\n\n    if (!painter) {\n      return null;\n    }\n\n    return painter.get2DExtent();\n  };\n\n  return Layer;\n}(JSONAble(Eventable(Renderable(Class))));\n\nLayer.mergeOptions(options$1);\nvar fire = Layer.prototype.fire;\n\nLayer.prototype.fire = function (eventType, param) {\n  if (eventType === 'layerload') {\n    this._loaded = true;\n  }\n\n  if (this.map) {\n    if (!param) {\n      param = {};\n    }\n\n    param['type'] = eventType;\n    param['target'] = this;\n\n    this.map._onLayerEvent(param);\n  }\n\n  return fire.apply(this, arguments);\n};\n\nvar TEMP_COORD = new Coordinate(0, 0);\nvar options$2 = {\n  'maxVisualPitch': 70,\n  'maxPitch': 80,\n  'centerCross': false,\n  'zoomInCenter': false,\n  'zoomOrigin': null,\n  'zoomAnimation': function () {\n    return !IS_NODE;\n  }(),\n  'zoomAnimationDuration': 330,\n  'panAnimation': function () {\n    return !IS_NODE;\n  }(),\n  'panAnimationDuration': 600,\n  'rotateAnimation': function () {\n    return !IS_NODE;\n  }(),\n  'zoomable': true,\n  'enableInfoWindow': true,\n  'hitDetect': function () {\n    return !Browser$1.mobile;\n  }(),\n  'hitDetectLimit': 5,\n  'fpsOnInteracting': 25,\n  'layerCanvasLimitOnInteracting': -1,\n  'maxZoom': null,\n  'minZoom': null,\n  'maxExtent': null,\n  'fixCenterOnResize': true,\n  'checkSize': true,\n  'checkSizeInterval': 1000,\n  'renderer': 'canvas',\n  'cascadePitches': [10, 60],\n  'renderable': true\n};\n\nvar Map$1 = function (_Handlerable) {\n  _inheritsLoose(Map, _Handlerable);\n\n  function Map(container, options) {\n    var _this;\n\n    if (!options) {\n      throw new Error('Invalid options when creating map.');\n    }\n\n    if (!options['center']) {\n      throw new Error('Invalid center when creating map.');\n    }\n\n    var opts = extend({}, options);\n    var zoom = opts['zoom'];\n    delete opts['zoom'];\n    var center = new Coordinate(opts['center']);\n    delete opts['center'];\n    var baseLayer = opts['baseLayer'];\n    delete opts['baseLayer'];\n    var layers = opts['layers'];\n    delete opts['layers'];\n    _this = _Handlerable.call(this, opts) || this;\n    _this.VERSION = Map.VERSION;\n    Object.defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), 'id', {\n      value: UID(),\n      writable: false\n    });\n    _this._loaded = false;\n\n    _this._initContainer(container);\n\n    _this._panels = {};\n    _this._baseLayer = null;\n    _this._layers = [];\n    _this._zoomLevel = zoom;\n    _this._center = center;\n\n    _this.setSpatialReference(opts['spatialReference'] || opts['view']);\n\n    _this._mapViewPoint = new Point(0, 0);\n\n    _this._initRenderer();\n\n    _this._updateMapSize(_this._getContainerDomSize());\n\n    if (baseLayer) {\n      _this.setBaseLayer(baseLayer);\n    }\n\n    if (layers) {\n      _this.addLayer(layers);\n    }\n\n    _this.setMaxExtent(opts['maxExtent']);\n\n    _this._Load();\n\n    return _this;\n  }\n\n  Map.addOnLoadHook = function addOnLoadHook(fn) {\n    var args = Array.prototype.slice.call(arguments, 1);\n    var onload = typeof fn === 'function' ? fn : function () {\n      this[fn].apply(this, args);\n    };\n    this.prototype._onLoadHooks = this.prototype._onLoadHooks || [];\n\n    this.prototype._onLoadHooks.push(onload);\n\n    return this;\n  };\n\n  var _proto = Map.prototype;\n\n  _proto.isLoaded = function isLoaded() {\n    return !!this._loaded;\n  };\n\n  _proto.getContainer = function getContainer() {\n    return this._containerDOM;\n  };\n\n  _proto.getSpatialReference = function getSpatialReference() {\n    return this._spatialReference;\n  };\n\n  _proto.setSpatialReference = function setSpatialReference(ref) {\n    var oldRef = this.options['spatialReference'];\n\n    if (this._loaded && SpatialReference.equals(oldRef, ref)) {\n      return this;\n    }\n\n    this._updateSpatialReference(ref, oldRef);\n\n    return this;\n  };\n\n  _proto._updateSpatialReference = function _updateSpatialReference(ref, oldRef) {\n    if (isString(ref)) {\n      ref = SpatialReference.getPreset(ref);\n    }\n\n    ref = extend({}, ref);\n    this._center = this.getCenter();\n    this.options['spatialReference'] = ref;\n    this._spatialReference = new SpatialReference(ref);\n\n    if (this.options['spatialReference'] && isFunction(this.options['spatialReference']['projection'])) {\n      var projection = this._spatialReference.getProjection();\n\n      this.options['spatialReference']['projection'] = projection['code'];\n    }\n\n    this._resetMapStatus();\n\n    this._fireEvent('spatialreferencechange', {\n      'old': oldRef,\n      'new': extend({}, this.options['spatialReference'])\n    });\n\n    return this;\n  };\n\n  _proto.onConfig = function onConfig(conf) {\n    var ref = conf['spatialReference'] || conf['view'];\n\n    if (!isNil(ref)) {\n      this._updateSpatialReference(ref, null);\n    }\n\n    return this;\n  };\n\n  _proto.getProjection = function getProjection() {\n    if (!this._spatialReference) {\n      return null;\n    }\n\n    return this._spatialReference.getProjection();\n  };\n\n  _proto.getFullExtent = function getFullExtent() {\n    if (!this._spatialReference) {\n      return null;\n    }\n\n    return this._spatialReference.getFullExtent();\n  };\n\n  _proto.setCursor = function setCursor(cursor) {\n    delete this._cursor;\n\n    this._trySetCursor(cursor);\n\n    this._cursor = cursor;\n    return this;\n  };\n\n  _proto.resetCursor = function resetCursor() {\n    return this.setCursor(null);\n  };\n\n  _proto.getCenter = function getCenter() {\n    if (!this._loaded || !this._prjCenter) {\n      return this._center;\n    }\n\n    var projection = this.getProjection();\n    return projection.unproject(this._prjCenter);\n  };\n\n  _proto.setCenter = function setCenter(center) {\n    if (!center) {\n      return this;\n    }\n\n    center = new Coordinate(center);\n    var projection = this.getProjection();\n    var pcenter = projection.project(center);\n\n    if (!this._verifyExtent(pcenter)) {\n      return this;\n    }\n\n    if (!this._loaded) {\n      this._center = center;\n      return this;\n    }\n\n    this.onMoveStart();\n\n    this._setPrjCenter(pcenter);\n\n    this.onMoveEnd(this._parseEventFromCoord(this.getCenter()));\n    return this;\n  };\n\n  _proto.getSize = function getSize() {\n    if (isNil(this.width) || isNil(this.height)) {\n      return this._getContainerDomSize();\n    }\n\n    return new Size(this.width, this.height);\n  };\n\n  _proto.getContainerExtent = function getContainerExtent() {\n    var visualHeight = this.height;\n    var pitch = this.getPitch(),\n        maxVisualPitch = this.options['maxVisualPitch'];\n\n    if (maxVisualPitch && pitch > maxVisualPitch) {\n      visualHeight = this._getVisualHeight(maxVisualPitch);\n    }\n\n    return new PointExtent(0, this.height - visualHeight, this.width, this.height);\n  };\n\n  _proto._getVisualHeight = function _getVisualHeight(visualPitch) {\n    visualPitch = visualPitch || 1E-2;\n    var pitch = (90 - this.getPitch()) * Math.PI / 180;\n    var fov = this.getFov() * Math.PI / 180;\n    visualPitch *= Math.PI / 180;\n    var cameraToCenter = this.cameraCenterDistance / this.getGLScale();\n    var tanB = Math.tan(fov / 2);\n    var tanP = Math.tan(visualPitch);\n    var visualDistance = cameraToCenter * tanB / (1 / tanP - tanB) / Math.sin(visualPitch);\n    var x = cameraToCenter * (Math.sin(pitch) * visualDistance / (cameraToCenter + Math.cos(pitch) * visualDistance));\n    return this.height / 2 + x;\n  };\n\n  _proto.getExtent = function getExtent() {\n    return this._pointToExtent(this._get2DExtent());\n  };\n\n  _proto.getProjExtent = function getProjExtent() {\n    var extent2D = this._get2DExtent();\n\n    return new Extent(this._pointToPrj(extent2D.getMin()), this._pointToPrj(extent2D.getMax()));\n  };\n\n  _proto.getPrjExtent = function getPrjExtent() {\n    return this.getProjExtent();\n  };\n\n  _proto.getMaxExtent = function getMaxExtent() {\n    if (!this.options['maxExtent']) {\n      return null;\n    }\n\n    return new Extent(this.options['maxExtent'], this.getProjection());\n  };\n\n  _proto.setMaxExtent = function setMaxExtent(extent) {\n    if (extent) {\n      var maxExt = new Extent(extent, this.getProjection());\n      this.options['maxExtent'] = maxExt;\n      var projection = this.getProjection();\n      this._prjMaxExtent = maxExt.convertTo(function (c) {\n        return projection.project(c);\n      });\n\n      if (!this._verifyExtent(this._getPrjCenter())) {\n        if (this._loaded) {\n          this._panTo(this._prjMaxExtent.getCenter());\n        } else {\n          this._center = projection.unproject(this._prjMaxExtent.getCenter());\n        }\n      }\n    } else {\n      delete this.options['maxExtent'];\n      delete this._prjMaxExtent;\n    }\n\n    return this;\n  };\n\n  _proto.getZoom = function getZoom() {\n    return this._zoomLevel;\n  };\n\n  _proto.getZoomForScale = function getZoomForScale(scale, fromZoom, isFraction) {\n    var zoom = this.getZoom();\n\n    if (isNil(fromZoom)) {\n      fromZoom = zoom;\n    }\n\n    if (scale === 1 && fromZoom === zoom) {\n      return zoom;\n    }\n\n    var res = this._getResolution(fromZoom),\n        targetRes = res / scale;\n\n    var scaleZoom = this.getZoomFromRes(targetRes);\n\n    if (isFraction) {\n      return scaleZoom;\n    } else {\n      var delta = 1E-6;\n      return this.getSpatialReference().getZoomDirection() < 0 ? Math.ceil(scaleZoom - delta) : Math.floor(scaleZoom + delta);\n    }\n  };\n\n  _proto.getZoomFromRes = function getZoomFromRes(res) {\n    var resolutions = this._getResolutions(),\n        minRes = this._getResolution(this.getMinZoom()),\n        maxRes = this._getResolution(this.getMaxZoom());\n\n    if (minRes <= maxRes) {\n      if (res <= minRes) {\n        return this.getMinZoom();\n      } else if (res >= maxRes) {\n        return this.getMaxZoom();\n      }\n    } else if (res >= minRes) {\n      return this.getMinZoom();\n    } else if (res <= maxRes) {\n      return this.getMaxZoom();\n    }\n\n    var l = resolutions.length;\n\n    for (var i = 0; i < l - 1; i++) {\n      if (!resolutions[i]) {\n        continue;\n      }\n\n      var gap = resolutions[i + 1] - resolutions[i];\n      var test = res - resolutions[i];\n\n      if (sign(gap) === sign(test) && Math.abs(gap) >= Math.abs(test)) {\n        return i + test / gap;\n      }\n    }\n\n    return l - 1;\n  };\n\n  _proto.setZoom = function setZoom(zoom, options) {\n    if (options === void 0) {\n      options = {\n        'animation': true\n      };\n    }\n\n    if (isNaN(zoom) || isNil(zoom)) {\n      return this;\n    }\n\n    zoom = +zoom;\n\n    if (this._loaded && this.options['zoomAnimation'] && options['animation']) {\n      this._zoomAnimation(zoom);\n    } else {\n      this._zoom(zoom);\n    }\n\n    return this;\n  };\n\n  _proto.getMaxZoom = function getMaxZoom() {\n    if (!isNil(this.options['maxZoom'])) {\n      return this.options['maxZoom'];\n    }\n\n    return this.getMaxNativeZoom();\n  };\n\n  _proto.setMaxZoom = function setMaxZoom(maxZoom) {\n    var viewMaxZoom = this.getMaxNativeZoom();\n\n    if (maxZoom > viewMaxZoom) {\n      maxZoom = viewMaxZoom;\n    }\n\n    if (maxZoom !== null && maxZoom < this._zoomLevel) {\n      this.setZoom(maxZoom);\n      maxZoom = +maxZoom;\n    }\n\n    this.options['maxZoom'] = maxZoom;\n    return this;\n  };\n\n  _proto.getMinZoom = function getMinZoom() {\n    if (!isNil(this.options['minZoom'])) {\n      return this.options['minZoom'];\n    }\n\n    return this._spatialReference.getMinZoom();\n  };\n\n  _proto.setMinZoom = function setMinZoom(minZoom) {\n    if (minZoom !== null) {\n      minZoom = +minZoom;\n\n      var viewMinZoom = this._spatialReference.getMinZoom();\n\n      if (minZoom < viewMinZoom) {\n        minZoom = viewMinZoom;\n      }\n\n      if (minZoom > this._zoomLevel) {\n        this.setZoom(minZoom);\n      }\n    }\n\n    this.options['minZoom'] = minZoom;\n    return this;\n  };\n\n  _proto.getMaxNativeZoom = function getMaxNativeZoom() {\n    var ref = this.getSpatialReference();\n\n    if (!ref) {\n      return null;\n    }\n\n    return ref.getMaxZoom();\n  };\n\n  _proto.getGLRes = function getGLRes() {\n    if (this._glRes) {\n      return this._glRes;\n    }\n\n    var fullExtent = this.getSpatialReference().getFullExtent();\n    this._glRes = (fullExtent.right - fullExtent.left) / Math.pow(2, 19);\n    return this._glRes;\n  };\n\n  _proto.getGLScale = function getGLScale(zoom) {\n    if (isNil(zoom)) {\n      zoom = this.getZoom();\n    }\n\n    return this._getResolution(zoom) / this.getGLRes();\n  };\n\n  _proto.zoomIn = function zoomIn() {\n    return this.setZoom(this.getZoom() + 1);\n  };\n\n  _proto.zoomOut = function zoomOut() {\n    return this.setZoom(this.getZoom() - 1);\n  };\n\n  _proto.isZooming = function isZooming() {\n    return !!this._zooming;\n  };\n\n  _proto.isInteracting = function isInteracting() {\n    return this.isZooming() || this.isMoving() || this.isRotating();\n  };\n\n  _proto.setCenterAndZoom = function setCenterAndZoom(center, zoom) {\n    if (!isNil(zoom) && this._zoomLevel !== zoom) {\n      this.setCenter(center);\n      this.setZoom(zoom, {\n        animation: false\n      });\n    } else {\n      this.setCenter(center);\n    }\n\n    return this;\n  };\n\n  _proto.getFitZoom = function getFitZoom(extent, isFraction) {\n    var _this2 = this;\n\n    if (!extent || !(extent instanceof Extent)) {\n      return this._zoomLevel;\n    }\n\n    if (extent['xmin'] === extent['xmax'] && extent['ymin'] === extent['ymax']) {\n      return this.getMaxZoom();\n    }\n\n    var size = this.getSize();\n    var containerExtent = extent.convertTo(function (p) {\n      return _this2.coordToPoint(p);\n    });\n    var w = containerExtent.getWidth(),\n        h = containerExtent.getHeight();\n    var scaleX = size['width'] / w,\n        scaleY = size['height'] / h;\n    var scale = this.getSpatialReference().getZoomDirection() < 0 ? Math.max(scaleX, scaleY) : Math.min(scaleX, scaleY);\n    var zoom = this.getZoomForScale(scale, null, isFraction);\n    return zoom;\n  };\n\n  _proto.getView = function getView() {\n    return {\n      'center': this.getCenter().toArray(),\n      'zoom': this.getZoom(),\n      'pitch': this.getPitch(),\n      'bearing': this.getBearing()\n    };\n  };\n\n  _proto.setView = function setView(view) {\n    if (!view) {\n      return this;\n    }\n\n    if (view['center']) {\n      this.setCenter(view['center']);\n    }\n\n    if (view['zoom'] !== null && !isNaN(+view['zoom'])) {\n      this.setZoom(+view['zoom'], {\n        'animation': false\n      });\n    }\n\n    if (view['pitch'] !== null && !isNaN(+view['pitch'])) {\n      this.setPitch(+view['pitch']);\n    }\n\n    if (view['pitch'] !== null && !isNaN(+view['bearing'])) {\n      this.setBearing(+view['bearing']);\n    }\n\n    return this;\n  };\n\n  _proto.getResolution = function getResolution(zoom) {\n    return this._getResolution(zoom);\n  };\n\n  _proto.getScale = function getScale(zoom) {\n    var z = isNil(zoom) ? this.getZoom() : zoom;\n\n    var max = this._getResolution(this.getMaxNativeZoom()),\n        res = this._getResolution(z);\n\n    return res / max;\n  };\n\n  _proto.fitExtent = function fitExtent(extent, zoomOffset, options, step) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (!extent) {\n      return this;\n    }\n\n    extent = new Extent(extent, this.getProjection());\n    var zoom = this.getFitZoom(extent) + (zoomOffset || 0);\n    var center = extent.getCenter();\n    if (typeof options['animation'] === 'undefined' || options['animation']) return this._animateTo({\n      center: center,\n      zoom: zoom\n    }, {\n      'duration': options['duration'] || this.options['zoomAnimationDuration'],\n      'easing': options['easing'] || 'out'\n    }, step);else return this.setCenterAndZoom(center, zoom);\n  };\n\n  _proto.getBaseLayer = function getBaseLayer() {\n    return this._baseLayer;\n  };\n\n  _proto.setBaseLayer = function setBaseLayer(baseLayer) {\n    var isChange = false;\n\n    if (this._baseLayer) {\n      isChange = true;\n\n      this._fireEvent('baselayerchangestart');\n\n      this._baseLayer.remove();\n    }\n\n    if (!baseLayer) {\n      delete this._baseLayer;\n\n      this._fireEvent('baselayerchangeend');\n\n      this._fireEvent('setbaselayer');\n\n      return this;\n    }\n\n    this._baseLayer = baseLayer;\n\n    baseLayer._bindMap(this, -1);\n\n    function onbaseLayerload() {\n      this._fireEvent('baselayerload');\n\n      if (isChange) {\n        isChange = false;\n\n        this._fireEvent('baselayerchangeend');\n      }\n    }\n\n    this._baseLayer.on('layerload', onbaseLayerload, this);\n\n    if (this._loaded) {\n      this._baseLayer.load();\n    }\n\n    this._fireEvent('setbaselayer');\n\n    return this;\n  };\n\n  _proto.removeBaseLayer = function removeBaseLayer() {\n    if (this._baseLayer) {\n      this._baseLayer.remove();\n\n      delete this._baseLayer;\n\n      this._fireEvent('baselayerremove');\n    }\n\n    return this;\n  };\n\n  _proto.getLayers = function getLayers(filter) {\n    return this._getLayers(function (layer) {\n      if (layer === this._baseLayer || layer.getId().indexOf(INTERNAL_LAYER_PREFIX) >= 0) {\n        return false;\n      }\n\n      if (filter) {\n        return filter(layer);\n      }\n\n      return true;\n    });\n  };\n\n  _proto.getLayer = function getLayer(id) {\n    if (!id) {\n      return null;\n    }\n\n    var layer = this._layerCache ? this._layerCache[id] : null;\n\n    if (layer) {\n      return layer;\n    }\n\n    var baseLayer = this.getBaseLayer();\n\n    if (baseLayer && baseLayer.getId() === id) {\n      return baseLayer;\n    }\n\n    return null;\n  };\n\n  _proto.addLayer = function addLayer(layers) {\n    if (!layers) {\n      return this;\n    }\n\n    if (!Array.isArray(layers)) {\n      layers = Array.prototype.slice.call(arguments, 0);\n      return this.addLayer(layers);\n    }\n\n    if (!this._layerCache) {\n      this._layerCache = {};\n    }\n\n    var mapLayers = this._layers;\n\n    for (var i = 0, len = layers.length; i < len; i++) {\n      var layer = layers[i];\n      var id = layer.getId();\n\n      if (isNil(id)) {\n        throw new Error('Invalid id for the layer: ' + id);\n      }\n\n      if (layer.getMap() === this) {\n        continue;\n      }\n\n      if (this._layerCache[id]) {\n        throw new Error('Duplicate layer id in the map: ' + id);\n      }\n\n      this._layerCache[id] = layer;\n\n      layer._bindMap(this);\n\n      mapLayers.push(layer);\n\n      if (this._loaded) {\n        layer.load();\n      }\n    }\n\n    this._sortLayersByZIndex();\n\n    this._fireEvent('addlayer', {\n      'layers': layers\n    });\n\n    return this;\n  };\n\n  _proto.removeLayer = function removeLayer(layers) {\n    if (!layers) {\n      return this;\n    }\n\n    if (!Array.isArray(layers)) {\n      return this.removeLayer([layers]);\n    }\n\n    var removed = [];\n\n    for (var i = 0, len = layers.length; i < len; i++) {\n      var layer = layers[i];\n\n      if (!(layer instanceof Layer)) {\n        layer = this.getLayer(layer);\n      }\n\n      if (!layer) {\n        continue;\n      }\n\n      var map = layer.getMap();\n\n      if (!map || map !== this) {\n        continue;\n      }\n\n      removed.push(layer);\n\n      this._removeLayer(layer, this._layers);\n\n      if (this._loaded) {\n        layer._doRemove();\n      }\n\n      var id = layer.getId();\n\n      if (this._layerCache) {\n        delete this._layerCache[id];\n      }\n    }\n\n    if (removed.length > 0) {\n      var renderer = this.getRenderer();\n\n      if (renderer) {\n        renderer.setLayerCanvasUpdated();\n      }\n\n      this.once('frameend', function () {\n        removed.forEach(function (layer) {\n          layer.fire('remove');\n        });\n      });\n    }\n\n    this._fireEvent('removelayer', {\n      'layers': layers\n    });\n\n    return this;\n  };\n\n  _proto.sortLayers = function sortLayers(layers) {\n    if (!layers || !Array.isArray(layers)) {\n      return this;\n    }\n\n    var layersToOrder = [];\n    var minZ = Number.MAX_VALUE;\n\n    for (var i = 0, l = layers.length; i < l; i++) {\n      var layer = layers[i];\n\n      if (isString(layers[i])) {\n        layer = this.getLayer(layer);\n      }\n\n      if (!(layer instanceof Layer) || !layer.getMap() || layer.getMap() !== this) {\n        throw new Error('It must be a layer added to this map to order.');\n      }\n\n      if (layer.getZIndex() < minZ) {\n        minZ = layer.getZIndex();\n      }\n\n      layersToOrder.push(layer);\n    }\n\n    for (var _i = 0, _l = layersToOrder.length; _i < _l; _i++) {\n      layersToOrder[_i].setZIndex(minZ + _i);\n    }\n\n    return this;\n  };\n\n  _proto.toDataURL = function toDataURL(options) {\n    if (!options) {\n      options = {};\n    }\n\n    var mimeType = options['mimeType'];\n\n    if (!mimeType) {\n      mimeType = 'image/png';\n    }\n\n    var save = options['save'];\n\n    var renderer = this._getRenderer();\n\n    if (renderer && renderer.toDataURL) {\n      var file = options['fileName'];\n\n      if (!file) {\n        file = 'export';\n      }\n\n      var dataURL = renderer.toDataURL(mimeType, options.quality || 0.92);\n\n      if (save && dataURL) {\n        var imgURL;\n\n        if (typeof Blob !== 'undefined' && typeof atob !== 'undefined') {\n          var blob = b64toBlob(dataURL.replace(/^data:image\\/(png|jpeg|jpg|webp);base64,/, ''), mimeType);\n          imgURL = URL.createObjectURL(blob);\n        } else {\n          imgURL = dataURL;\n        }\n\n        var dlLink = document.createElement('a');\n        dlLink.download = file;\n        dlLink.href = imgURL;\n        document.body.appendChild(dlLink);\n        dlLink.click();\n        document.body.removeChild(dlLink);\n      }\n\n      return dataURL;\n    }\n\n    return null;\n  };\n\n  _proto.coordToPoint = function coordToPoint(coordinate, zoom, out) {\n    return this.coordinateToPoint(coordinate, zoom, out);\n  };\n\n  _proto.coordToPointAtRes = function coordToPointAtRes(coordinate, res, out) {\n    return this.coordinateToPointAtRes(coordinate, res, out);\n  };\n\n  _proto.pointToCoord = function pointToCoord(point, zoom, out) {\n    return this.pointToCoordinate(point, zoom, out);\n  };\n\n  _proto.pointAtResToCoord = function pointAtResToCoord(point, res, out) {\n    return this.pointAtResToCoordinate(point, res, out);\n  };\n\n  _proto.coordToViewPoint = function coordToViewPoint(coordinate, out, altitude) {\n    return this.coordinateToViewPoint(coordinate, out, altitude);\n  };\n\n  _proto.viewPointToCoord = function viewPointToCoord(viewPoint, out) {\n    return this.viewPointToCoordinate(viewPoint, out);\n  };\n\n  _proto.coordToContainerPoint = function coordToContainerPoint(coordinate, zoom, out) {\n    return this.coordinateToContainerPoint(coordinate, zoom, out);\n  };\n\n  _proto.containerPointToCoord = function containerPointToCoord(containerPoint, out) {\n    return this.containerPointToCoordinate(containerPoint, out);\n  };\n\n  _proto.containerPointToViewPoint = function containerPointToViewPoint(containerPoint, out) {\n    if (out) {\n      out.set(containerPoint.x, containerPoint.y);\n    } else {\n      out = containerPoint.copy();\n    }\n\n    return out._sub(this.getViewPoint());\n  };\n\n  _proto.viewPointToContainerPoint = function viewPointToContainerPoint(viewPoint, out) {\n    if (out) {\n      out.set(viewPoint.x, viewPoint.y);\n    } else {\n      out = viewPoint.copy();\n    }\n\n    return out._add(this.getViewPoint());\n  };\n\n  _proto.checkSize = function checkSize(force) {\n    var justStart = now() - this._initTime < 1500 && this.width === 0 || this.height === 0;\n\n    var watched = this._getContainerDomSize(),\n        oldHeight = this.height,\n        oldWidth = this.width;\n\n    if (!force && watched['width'] === oldWidth && watched['height'] === oldHeight) {\n      return this;\n    }\n\n    computeDomPosition(this._containerDOM);\n    var center = this.getCenter();\n\n    if (!this.options['fixCenterOnResize']) {\n      var vh = this._getVisualHeight(this.getPitch());\n\n      var nwCP = new Point(0, this.height - vh);\n\n      var nwCoord = this._containerPointToPrj(nwCP);\n\n      this._updateMapSize(watched);\n\n      var vhAfter = this._getVisualHeight(this.getPitch());\n\n      var nwCPAfter = new Point(0, this.height - vhAfter);\n\n      this._setPrjCoordAtContainerPoint(nwCoord, nwCPAfter);\n\n      this._mapViewCoord = this._getPrjCenter();\n    } else {\n      this._updateMapSize(watched);\n    }\n\n    var hided = watched['width'] === 0 || watched['height'] === 0 || oldWidth === 0 || oldHeight === 0;\n\n    if (justStart || hided) {\n      this._eventSilence = true;\n      this.setCenter(center);\n      delete this._eventSilence;\n    }\n\n    this._fireEvent('resize');\n\n    return this;\n  };\n\n  _proto.locate = function locate(coordinate, dx, dy) {\n    return this.getProjection()._locate(new Coordinate(coordinate), dx, dy);\n  };\n\n  _proto.getMainPanel = function getMainPanel() {\n    return this._getRenderer().getMainPanel();\n  };\n\n  _proto.getPanels = function getPanels() {\n    return this._panels;\n  };\n\n  _proto.remove = function remove() {\n    var _this3 = this;\n\n    if (this.isRemoved()) {\n      return this;\n    }\n\n    this._fireEvent('removestart');\n\n    this._removeDomEvents();\n\n    this._clearHandlers();\n\n    this.removeBaseLayer();\n    var layers = this.getLayers();\n\n    for (var i = 0; i < layers.length; i++) {\n      layers[i].remove();\n    }\n\n    if (this._getRenderer()) {\n      this._getRenderer().remove();\n    }\n\n    if (this._containerDOM.childNodes && this._containerDOM.childNodes.length > 0) {\n      Array.prototype.slice.call(this._containerDOM.childNodes, 0).filter(function (node) {\n        return node.className === 'maptalks-wrapper';\n      }).forEach(function (node) {\n        return _this3._containerDOM.removeChild(node);\n      });\n    }\n\n    delete this._panels;\n    delete this._containerDOM;\n    delete this.renderer;\n\n    this._fireEvent('removeend');\n\n    this._clearAllListeners();\n\n    if (Browser$1.removeDPRListening) {\n      Browser$1.removeDPRListening(this);\n    }\n\n    return this;\n  };\n\n  _proto.isRemoved = function isRemoved() {\n    return !this._containerDOM;\n  };\n\n  _proto.isMoving = function isMoving() {\n    return !!this._moving;\n  };\n\n  _proto.onMoveStart = function onMoveStart(param) {\n    if (this._mapAnimPlayer) {\n      this._stopAnim(this._mapAnimPlayer);\n    }\n\n    var prjCenter = this._getPrjCenter();\n\n    if (!this._originCenter || this._verifyExtent(prjCenter)) {\n      this._originCenter = prjCenter;\n    }\n\n    this._moving = true;\n\n    this._trySetCursor('move');\n\n    this._fireEvent('movestart', this._parseEvent(param ? param['domEvent'] : null, 'movestart'));\n  };\n\n  _proto.onMoving = function onMoving(param) {\n    this._fireEvent('moving', this._parseEvent(param ? param['domEvent'] : null, 'moving'));\n  };\n\n  _proto.onMoveEnd = function onMoveEnd(param) {\n    this._moving = false;\n\n    this._trySetCursor('default');\n\n    this._fireEvent('moveend', param && param['domEvent'] ? this._parseEvent(param['domEvent'], 'moveend') : param);\n\n    if (!this._verifyExtent(this._getPrjCenter()) && this._originCenter) {\n      var moveTo = this._originCenter;\n\n      this._panTo(moveTo);\n    }\n  };\n\n  _proto.onDragRotateStart = function onDragRotateStart(param) {\n    this._dragRotating = true;\n\n    this._fireEvent('dragrotatestart', this._parseEvent(param ? param['domEvent'] : null, 'dragrotatestart'));\n  };\n\n  _proto.onDragRotating = function onDragRotating(param) {\n    this._fireEvent('dragrotating', this._parseEvent(param ? param['domEvent'] : null, 'dragrotating'));\n  };\n\n  _proto.onDragRotateEnd = function onDragRotateEnd(param) {\n    this._dragRotating = false;\n\n    this._fireEvent('dragrotateend', this._parseEvent(param ? param['domEvent'] : null, 'dragrotateend'));\n  };\n\n  _proto.isDragRotating = function isDragRotating() {\n    return !!this._dragRotating;\n  };\n\n  _proto.isOffscreen = function isOffscreen(box, viewportPadding) {\n    if (viewportPadding === void 0) {\n      viewportPadding = 0;\n    }\n\n    var width = this.width,\n        height = this.height;\n    var screenRightBoundary = width + viewportPadding;\n    var screenBottomBoundary = height + viewportPadding;\n    var xmin = box.xmin,\n        ymin = box.ymin,\n        xmax = box.xmax,\n        ymax = box.ymax;\n\n    if (Array.isArray(box)) {\n      xmin = box[0];\n      ymin = box[1];\n      xmax = box[2];\n      ymax = box[3];\n    }\n\n    return xmax < viewportPadding || xmin >= screenRightBoundary || ymax < viewportPadding || ymin > screenBottomBoundary;\n  };\n\n  _proto.getRenderer = function getRenderer() {\n    return this._getRenderer();\n  };\n\n  _proto.getDevicePixelRatio = function getDevicePixelRatio() {\n    return this.options['devicePixelRatio'] || Browser$1.devicePixelRatio || 1;\n  };\n\n  _proto.setDevicePixelRatio = function setDevicePixelRatio(dpr) {\n    if (isNumber(dpr) && dpr > 0 && dpr !== this.options['devicePixelRatio']) {\n      this.options['devicePixelRatio'] = dpr;\n      this.checkSize(true);\n    }\n\n    return this;\n  };\n\n  _proto._initContainer = function _initContainer(container) {\n    if (isString(container)) {\n      this._containerDOM = document.getElementById(container);\n\n      if (!this._containerDOM) {\n        throw new Error('Invalid container when creating map: \\'' + container + '\\'');\n      }\n    } else {\n      this._containerDOM = container;\n\n      if (IS_NODE) {\n        this.CanvasClass = this._containerDOM.constructor;\n      }\n    }\n\n    if (this._containerDOM.childNodes && this._containerDOM.childNodes.length > 0) {\n      if (this._containerDOM.childNodes[0].className === 'maptalks-wrapper') {\n        throw new Error('Container is already loaded with another map instance, use map.remove() to clear it.');\n      }\n    }\n  };\n\n  _proto._trySetCursor = function _trySetCursor(cursor) {\n    if (!this._cursor && !this._priorityCursor) {\n      if (!cursor) {\n        cursor = 'default';\n      }\n\n      this._setCursorToPanel(cursor);\n    }\n\n    return this;\n  };\n\n  _proto._setPriorityCursor = function _setPriorityCursor(cursor) {\n    if (!cursor) {\n      var hasCursor = false;\n\n      if (this._priorityCursor) {\n        hasCursor = true;\n      }\n\n      delete this._priorityCursor;\n\n      if (hasCursor) {\n        this.setCursor(this._cursor);\n      }\n    } else {\n      this._priorityCursor = cursor;\n\n      this._setCursorToPanel(cursor);\n    }\n\n    return this;\n  };\n\n  _proto._setCursorToPanel = function _setCursorToPanel(cursor) {\n    var panel = this.getMainPanel();\n\n    if (panel && panel.style && panel.style.cursor !== cursor) {\n      panel.style.cursor = cursor;\n    }\n  };\n\n  _proto._removeLayer = function _removeLayer(layer, layerList) {\n    if (!layer || !layerList) {\n      return;\n    }\n\n    var index = layerList.indexOf(layer);\n\n    if (index > -1) {\n      layerList.splice(index, 1);\n    }\n  };\n\n  _proto._sortLayersByZIndex = function _sortLayersByZIndex() {\n    if (!this._layers) {\n      return;\n    }\n\n    for (var i = 0, l = this._layers.length; i < l; i++) {\n      this._layers[i]._order = i;\n\n      if (this._layers[i].sortLayersByZIndex) {\n        this._layers[i].sortLayersByZIndex();\n      }\n    }\n\n    this._layers.sort(function (a, b) {\n      var c = a.getZIndex() - b.getZIndex();\n\n      if (c === 0) {\n        return a._order - b._order;\n      }\n\n      return c;\n    });\n  };\n\n  _proto._fireEvent = function _fireEvent(eventName, param) {\n    if (this._eventSilence) {\n      return;\n    }\n\n    this.fire('_' + eventName, param);\n    this.fire(eventName, param);\n  };\n\n  _proto._Load = function _Load() {\n    this._resetMapStatus();\n\n    if (this.options['pitch']) {\n      this.setPitch(this.options['pitch']);\n      delete this.options['pitch'];\n    }\n\n    if (this.options['bearing']) {\n      this.setBearing(this.options['bearing']);\n      delete this.options['bearing'];\n    }\n\n    delete this._glRes;\n\n    this._loadAllLayers();\n\n    this._getRenderer().onLoad();\n\n    this._loaded = true;\n\n    this._callOnLoadHooks();\n\n    this._initTime = now();\n  };\n\n  _proto._initRenderer = function _initRenderer() {\n    var renderer = this.options['renderer'];\n    var clazz = Map.getRendererClass(renderer);\n    this._renderer = new clazz(this);\n\n    this._renderer.load();\n  };\n\n  _proto._getRenderer = function _getRenderer() {\n    return this._renderer;\n  };\n\n  _proto._loadAllLayers = function _loadAllLayers() {\n    function loadLayer(layer) {\n      if (layer) {\n        layer.load();\n      }\n    }\n\n    if (this._baseLayer) {\n      this._baseLayer.load();\n    }\n\n    this._eachLayer(loadLayer, this.getLayers());\n  };\n\n  _proto._getLayers = function _getLayers(filter) {\n    var layers = this._baseLayer ? [this._baseLayer].concat(this._layers) : this._layers;\n    var result = [];\n\n    for (var i = 0; i < layers.length; i++) {\n      if (!filter || filter.call(this, layers[i])) {\n        result.push(layers[i]);\n      }\n    }\n\n    return result;\n  };\n\n  _proto._eachLayer = function _eachLayer(fn) {\n    if (arguments.length < 2) {\n      return;\n    }\n\n    var layerLists = Array.prototype.slice.call(arguments, 1);\n\n    if (layerLists && !Array.isArray(layerLists)) {\n      layerLists = [layerLists];\n    }\n\n    var layers = [];\n\n    for (var i = 0, len = layerLists.length; i < len; i++) {\n      layers = layers.concat(layerLists[i]);\n    }\n\n    for (var j = 0, jlen = layers.length; j < jlen; j++) {\n      fn.call(fn, layers[j]);\n    }\n  };\n\n  _proto._onLayerEvent = function _onLayerEvent(param) {\n    if (!param) {\n      return;\n    }\n\n    if (param['type'] === 'idchange') {\n      delete this._layerCache[param['old']];\n      this._layerCache[param['new']] = param['target'];\n    }\n  };\n\n  _proto._resetMapStatus = function _resetMapStatus() {\n    var maxZoom = this.getMaxZoom(),\n        minZoom = this.getMinZoom();\n\n    var viewMaxZoom = this._spatialReference.getMaxZoom(),\n        viewMinZoom = this._spatialReference.getMinZoom();\n\n    if (isNil(maxZoom) || maxZoom === -1 || maxZoom > viewMaxZoom) {\n      this.setMaxZoom(viewMaxZoom);\n    }\n\n    if (isNil(minZoom) || minZoom === -1 || minZoom < viewMinZoom) {\n      this.setMinZoom(viewMinZoom);\n    }\n\n    maxZoom = this.getMaxZoom();\n    minZoom = this.getMinZoom();\n\n    if (maxZoom < minZoom) {\n      this.setMaxZoom(minZoom);\n    }\n\n    if (isNil(this._zoomLevel) || this._zoomLevel > maxZoom) {\n      this._zoomLevel = maxZoom;\n    }\n\n    if (this._zoomLevel < minZoom) {\n      this._zoomLevel = minZoom;\n    }\n\n    delete this._prjCenter;\n    var projection = this.getProjection();\n    this._prjCenter = projection.project(this._center);\n\n    this._calcMatrices();\n\n    var renderer = this._getRenderer();\n\n    if (renderer) {\n      renderer.resetContainer();\n    }\n  };\n\n  _proto._getContainerDomSize = function _getContainerDomSize() {\n    if (!this._containerDOM) {\n      return null;\n    }\n\n    var containerDOM = this._containerDOM;\n    var width, height;\n\n    if (this._containerDomContentRect) {\n      width = this._containerDomContentRect.width;\n      height = this._containerDomContentRect.height;\n      return new Size(width, height);\n    }\n\n    if (!isNil(containerDOM.width) && !isNil(containerDOM.height)) {\n      width = containerDOM.width;\n      height = containerDOM.height;\n      var dpr = this.getDevicePixelRatio();\n\n      if (dpr !== 1 && containerDOM['layer']) {\n        width /= dpr;\n        height /= dpr;\n      }\n    } else if (!isNil(containerDOM.clientWidth) && !isNil(containerDOM.clientHeight)) {\n      width = parseInt(containerDOM.clientWidth, 0);\n      height = parseInt(containerDOM.clientHeight, 0);\n    } else {\n      throw new Error('can not get size of container');\n    }\n\n    return new Size(width, height);\n  };\n\n  _proto._updateMapSize = function _updateMapSize(mSize) {\n    this.width = mSize['width'];\n    this.height = mSize['height'];\n\n    this._getRenderer().updateMapSize(mSize);\n\n    this._calcMatrices();\n\n    return this;\n  };\n\n  _proto._getPrjCenter = function _getPrjCenter() {\n    return this._prjCenter;\n  };\n\n  _proto._setPrjCenter = function _setPrjCenter(pcenter) {\n    this._prjCenter = pcenter;\n\n    if (this.isInteracting() && !this.isMoving()) {\n      this._mapViewCoord = pcenter;\n    }\n\n    this._calcMatrices();\n  };\n\n  _proto._setPrjCoordAtContainerPoint = function _setPrjCoordAtContainerPoint(coordinate, point) {\n    if (point.x === this.width / 2 && point.y === this.height / 2) {\n      return this;\n    }\n\n    var t = this._containerPointToPoint(point)._sub(this._prjToPoint(this._getPrjCenter()));\n\n    var pcenter = this._pointToPrj(this._prjToPoint(coordinate).sub(t));\n\n    this._setPrjCenter(pcenter);\n\n    return this;\n  };\n\n  _proto._verifyExtent = function _verifyExtent(prjCenter) {\n    if (!prjCenter) {\n      return false;\n    }\n\n    var maxExt = this._prjMaxExtent;\n\n    if (!maxExt) {\n      return true;\n    }\n\n    return maxExt.contains(prjCenter);\n  };\n\n  _proto._offsetCenterByPixel = function _offsetCenterByPixel(pixel) {\n    var pos = new Point(this.width / 2 - pixel.x, this.height / 2 - pixel.y);\n\n    var pCenter = this._containerPointToPrj(pos);\n\n    this._setPrjCenter(pCenter);\n\n    return pCenter;\n  };\n\n  _proto.offsetPlatform = function offsetPlatform(offset) {\n    if (!offset) {\n      return this._mapViewPoint;\n    } else {\n      this._getRenderer().offsetPlatform(offset);\n\n      this._mapViewCoord = this._getPrjCenter();\n      this._mapViewPoint = this._mapViewPoint.add(offset);\n      return this;\n    }\n  };\n\n  _proto.getViewPoint = function getViewPoint() {\n    var offset = this._getViewPointFrameOffset();\n\n    var panelOffset = this.offsetPlatform();\n\n    if (offset) {\n      panelOffset = panelOffset.add(offset);\n    }\n\n    return panelOffset;\n  };\n\n  _proto._resetMapViewPoint = function _resetMapViewPoint() {\n    this._mapViewPoint = new Point(0, 0);\n    this._mapViewCoord = this._getPrjCenter();\n  };\n\n  _proto._getResolution = function _getResolution(zoom) {\n    if ((zoom === undefined || zoom === this._zoomLevel) && this._mapRes !== undefined) {\n      return this._mapRes;\n    }\n\n    if (isNil(zoom)) {\n      zoom = this._zoomLevel;\n    }\n\n    return this._spatialReference.getResolution(zoom);\n  };\n\n  _proto._getResolutions = function _getResolutions() {\n    return this._spatialReference.getResolutions();\n  };\n\n  _proto._prjToPoint = function _prjToPoint(pCoord, zoom, out) {\n    zoom = isNil(zoom) ? this.getZoom() : zoom;\n\n    var res = this._getResolution(zoom);\n\n    return this._prjToPointAtRes(pCoord, res, out);\n  };\n\n  _proto._prjToPointAtRes = function _prjToPointAtRes(pCoord, res, out) {\n    return this._spatialReference.getTransformation().transform(pCoord, res, out);\n  };\n\n  _proto._prjsToPointsAtRes = function _prjsToPointsAtRes(pCoords, res, resultPoints) {\n    if (resultPoints === void 0) {\n      resultPoints = [];\n    }\n\n    var transformation = this._spatialReference.getTransformation();\n\n    var pts = [];\n\n    for (var i = 0, len = pCoords.length; i < len; i++) {\n      var pt = transformation.transform(pCoords[i], res, resultPoints[i]);\n      pts.push(pt);\n    }\n\n    return pts;\n  };\n\n  _proto._pointToPrj = function _pointToPrj(point, zoom, out) {\n    zoom = isNil(zoom) ? this.getZoom() : zoom;\n\n    var res = this._getResolution(zoom);\n\n    return this._pointToPrjAtRes(point, res, out);\n  };\n\n  _proto._pointToPrjAtRes = function _pointToPrjAtRes(point, res, out) {\n    return this._spatialReference.getTransformation().untransform(point, res, out);\n  };\n\n  _proto._pointToPoint = function _pointToPoint(point, zoom, out) {\n    if (!isNil(zoom)) {\n      return this._pointAtResToPoint(point, this._getResolution(zoom), out);\n    }\n\n    if (out) {\n      out.x = point.x;\n      out.y = point.y;\n    } else {\n      out = point.copy();\n    }\n\n    return out;\n  };\n\n  _proto._pointAtResToPoint = function _pointAtResToPoint(point, res, out) {\n    if (out) {\n      out.x = point.x;\n      out.y = point.y;\n    } else {\n      out = point.copy();\n    }\n\n    return out._multi(res / this._getResolution());\n  };\n\n  _proto._pointToPointAtRes = function _pointToPointAtRes(point, res, out) {\n    if (out) {\n      out.x = point.x;\n      out.y = point.y;\n    } else {\n      out = point.copy();\n    }\n\n    return out._multi(this._getResolution() / res);\n  };\n\n  _proto._containerPointToPrj = function _containerPointToPrj(containerPoint, out) {\n    return this._pointToPrj(this._containerPointToPoint(containerPoint, undefined, out), undefined, out);\n  };\n\n  _proto._callOnLoadHooks = function _callOnLoadHooks() {\n    var proto = Map.prototype;\n\n    if (!proto._onLoadHooks) {\n      return;\n    }\n\n    for (var i = 0, l = proto._onLoadHooks.length; i < l; i++) {\n      proto._onLoadHooks[i].call(this);\n    }\n  };\n\n  return Map;\n}(Handlerable(Eventable(Renderable(Class))));\n\nMap$1.include({\n  coordinateToPoint: function coordinateToPoint(coordinate, zoom, out) {\n    var res = this._getResolution(zoom);\n\n    return this.coordinateToPointAtRes(coordinate, res, out);\n  },\n  coordinateToPointAtRes: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (coordinate, res, out) {\n      var prjCoord = this.getProjection().project(coordinate, COORD);\n      return this._prjToPointAtRes(prjCoord, res, out);\n    };\n  }(),\n  pointToCoordinate: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (point, zoom, out) {\n      var prjCoord = this._pointToPrj(point, zoom, COORD);\n\n      return this.getProjection().unproject(prjCoord, out);\n    };\n  }(),\n  pointAtResToCoordinate: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (point, res, out) {\n      var prjCoord = this._pointToPrjAtRes(point, res, COORD);\n\n      return this.getProjection().unproject(prjCoord, out);\n    };\n  }(),\n  coordinateToViewPoint: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (coordinate, out, altitude) {\n      return this._prjToViewPoint(this.getProjection().project(coordinate, COORD), out, altitude);\n    };\n  }(),\n  viewPointToCoordinate: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (viewPoint, out) {\n      return this.getProjection().unproject(this._viewPointToPrj(viewPoint, COORD), out);\n    };\n  }(),\n  coordinateToContainerPoint: function coordinateToContainerPoint(coordinate, zoom, out) {\n    var res = this._getResolution(zoom);\n\n    return this.coordinateToContainerPointAtRes(coordinate, res, out);\n  },\n  coordinateToContainerPointAtRes: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (coordinate, res, out) {\n      var pCoordinate = this.getProjection().project(coordinate, COORD);\n      return this._prjToContainerPointAtRes(pCoordinate, res, out);\n    };\n  }(),\n  coordinatesToContainerPoints: function coordinatesToContainerPoints(coordinates, zoom) {\n    var res = this._getResolution(zoom);\n\n    return this.coordinatesToContainerPointsAtRes(coordinates, res);\n  },\n  coordinatesToContainerPointsAtRes: function () {\n    return function (coordinates, resolution) {\n      var pts = [];\n\n      var transformation = this._spatialReference.getTransformation();\n\n      var res = resolution / this._getResolution();\n\n      var projection = this.getProjection();\n      var prjOut = new Coordinate(0, 0);\n      var isTransforming = this.isTransforming();\n\n      var centerPoint = this._prjToPoint(this._getPrjCenter(), undefined, TEMP_COORD);\n\n      for (var i = 0, len = coordinates.length; i < len; i++) {\n        var pCoordinate = projection.project(coordinates[i], prjOut);\n        var point = transformation.transform(pCoordinate, resolution);\n        point = point._multi(res);\n\n        this._toContainerPoint(point, isTransforming, res, 0, centerPoint);\n\n        pts.push(point);\n      }\n\n      return pts;\n    };\n  }(),\n  containerPointToCoordinate: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (containerPoint, out) {\n      var pCoordinate = this._containerPointToPrj(containerPoint, COORD);\n\n      return this.getProjection().unproject(pCoordinate, out);\n    };\n  }(),\n  containerToExtent: function () {\n    var POINT0 = new Point(0, 0);\n    var POINT1 = new Point(0, 0);\n    return function (containerExtent) {\n      var extent2D = new PointExtent(this._containerPointToPoint(containerExtent.getMin(POINT0), undefined, POINT0), this._containerPointToPoint(containerExtent.getMax(POINT1), undefined, POINT1));\n      return this._pointToExtent(extent2D);\n    };\n  }(),\n  distanceToPixel: function () {\n    var POINT0 = new Point(0, 0);\n    var POINT1 = new Point(0, 0);\n    return function (xDist, yDist, zoom) {\n      var projection = this.getProjection();\n\n      if (!projection) {\n        return null;\n      }\n\n      var scale = this.getScale() / this.getScale(zoom);\n      var center = this.getCenter(),\n          target = projection.locate(center, xDist, yDist);\n      var p0 = this.coordToContainerPoint(center, undefined, POINT0),\n          p1 = this.coordToContainerPoint(target, undefined, POINT1);\n\n      p1._sub(p0)._multi(scale)._abs();\n\n      return new Size(p1.x, p1.y);\n    };\n  }(),\n  distanceToPoint: function distanceToPoint(xDist, yDist, zoom, paramCenter) {\n    var res = this._getResolution(zoom);\n\n    return this.distanceToPointAtRes(xDist, yDist, res, paramCenter);\n  },\n  distanceToPointAtRes: function () {\n    var POINT = new Point(0, 0);\n    return function (xDist, yDist, res, paramCenter) {\n      var projection = this.getProjection();\n\n      if (!projection) {\n        return null;\n      }\n\n      var center = paramCenter || this.getCenter(),\n          target = projection.locate(center, xDist, yDist);\n      var p0 = this.coordToPointAtRes(center, res, POINT),\n          p1 = this.coordToPointAtRes(target, res);\n\n      p1._sub(p0)._abs();\n\n      return p1;\n    };\n  }(),\n  pixelToDistance: function () {\n    var COORD0 = new Coordinate(0, 0);\n    var COORD1 = new Coordinate(0, 0);\n    return function (width, height) {\n      var projection = this.getProjection();\n\n      if (!projection) {\n        return null;\n      }\n\n      var fullExt = this.getFullExtent();\n      var d = fullExt['top'] > fullExt['bottom'] ? -1 : 1;\n      var target = COORD0.set(this.width / 2 + width, this.height / 2 + d * height);\n      var coord = this.containerPointToCoord(target, COORD1);\n      return projection.measureLength(this.getCenter(), coord);\n    };\n  }(),\n  pointToDistance: function pointToDistance(dx, dy, zoom) {\n    var res = this.getResolution(zoom);\n    return this.pointAtResToDistance(dx, dy, res);\n  },\n  pointAtResToDistance: function () {\n    var POINT = new Point(0, 0);\n    var COORD = new Coordinate(0, 0);\n    return function (dx, dy, res) {\n      var projection = this.getProjection();\n\n      if (!projection) {\n        return null;\n      }\n\n      var c = this._prjToPointAtRes(this._getPrjCenter(), res, POINT);\n\n      c._add(dx, dy);\n\n      var target = this.pointAtResToCoord(c, res, COORD);\n      return projection.measureLength(this.getCenter(), target);\n    };\n  }(),\n  locateByPoint: function () {\n    var POINT = new Point(0, 0);\n    return function (coordinate, px, py) {\n      var point = this.coordToContainerPoint(coordinate, undefined, POINT);\n      return this.containerPointToCoord(point._add(px, py));\n    };\n  }(),\n  _get2DExtent: function _get2DExtent(zoom, out) {\n    var cached;\n\n    if ((zoom === undefined || zoom === this._zoomLevel) && this._mapExtent2D) {\n      cached = this._mapExtent2D;\n    }\n\n    if (cached) {\n      if (out) {\n        out.set(cached['xmin'], cached['ymin'], cached['xmax'], cached['ymax']);\n        return out;\n      }\n\n      return cached.copy();\n    }\n\n    var res = this._getResolution(zoom);\n\n    return this._get2DExtentAtRes(res, out);\n  },\n  _get2DExtentAtRes: function () {\n    var POINT = new Point(0, 0);\n    return function (res, out) {\n      var _this4 = this;\n\n      if (res === this._mapGlRes && this._mapGlExtent2D) {\n        return this._mapGlExtent2D;\n      }\n\n      var cExtent = this.getContainerExtent();\n      return cExtent.convertTo(function (c) {\n        return _this4._containerPointToPointAtRes(c, res, POINT);\n      }, out);\n    };\n  }(),\n  _pointToExtent: function () {\n    var COORD0 = new Coordinate(0, 0);\n    var COORD1 = new Coordinate(0, 0);\n    return function (extent2D) {\n      var min2d = extent2D.getMin(),\n          max2d = extent2D.getMax();\n      var fullExtent = this.getFullExtent();\n\n      var _ref = !fullExtent || fullExtent.left <= fullExtent.right ? [min2d.x, max2d.x] : [max2d.x, min2d.x],\n          minx = _ref[0],\n          maxx = _ref[1];\n\n      var _ref2 = !fullExtent || fullExtent.top > fullExtent.bottom ? [max2d.y, min2d.y] : [min2d.y, max2d.y],\n          miny = _ref2[0],\n          maxy = _ref2[1];\n\n      var min = min2d.set(minx, maxy);\n      var max = max2d.set(maxx, miny);\n      return new Extent(this.pointToCoord(min, undefined, COORD0), this.pointToCoord(max, undefined, COORD1), this.getProjection());\n    };\n  }(),\n  _getViewPointFrameOffset: function () {\n    var POINT = new Point(0, 0);\n    return function () {\n      if (this.isZooming()) {\n        return null;\n      }\n\n      var pcenter = this._getPrjCenter();\n\n      if (this._mapViewCoord && !this._mapViewCoord.equals(pcenter)) {\n        return this._prjToContainerPoint(this._mapViewCoord)._sub(this._prjToContainerPoint(pcenter, undefined, POINT));\n      }\n\n      return null;\n    };\n  }(),\n  _viewPointToPrj: function () {\n    var POINT = new Point(0, 0);\n    return function (viewPoint, out) {\n      return this._containerPointToPrj(this.viewPointToContainerPoint(viewPoint, POINT), out);\n    };\n  }(),\n  _prjToContainerPoint: function _prjToContainerPoint(pCoordinate, zoom, out, altitude) {\n    var res = this._getResolution(zoom);\n\n    return this._prjToContainerPointAtRes(pCoordinate, res, out, altitude);\n  },\n  _prjToContainerPointAtRes: function () {\n    var POINT = new Point(0, 0);\n    return function (pCoordinate, res, out, altitude) {\n      return this._pointAtResToContainerPoint(this._prjToPointAtRes(pCoordinate, res, POINT), res, altitude || 0, out);\n    };\n  }(),\n  _prjToViewPoint: function () {\n    var POINT = new Point(0, 0);\n    return function (pCoordinate, out, altitude) {\n      var containerPoint = this._prjToContainerPoint(pCoordinate, undefined, POINT, altitude);\n\n      return this.containerPointToViewPoint(containerPoint, out);\n    };\n  }(),\n  _viewPointToPoint: function () {\n    var POINT = new Point(0, 0);\n    return function (viewPoint, zoom, out) {\n      return this._containerPointToPoint(this.viewPointToContainerPoint(viewPoint, POINT), zoom, out);\n    };\n  }(),\n  _pointToViewPoint: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (point, zoom, out) {\n      return this._prjToViewPoint(this._pointToPrj(point, zoom, COORD), out);\n    };\n  }()\n});\nMap$1.mergeOptions(options$2);\n\nvar MapDoubleClickZoomHandler = function (_Handler) {\n  _inheritsLoose(MapDoubleClickZoomHandler, _Handler);\n\n  function MapDoubleClickZoomHandler() {\n    return _Handler.apply(this, arguments) || this;\n  }\n\n  var _proto = MapDoubleClickZoomHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    if (!this.target) {\n      return;\n    }\n\n    this.target.on('_dblclick', this._onDoubleClick, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    if (!this.target) {\n      return;\n    }\n\n    this.target.off('_dblclick', this._onDoubleClick, this);\n  };\n\n  _proto._onDoubleClick = function _onDoubleClick(param) {\n    var map = this.target;\n\n    if (map.options['doubleClickZoom']) {\n      var oldZoom = map.getZoom(),\n          zoom = param['domEvent']['shiftKey'] ? Math.ceil(oldZoom) - 1 : Math.floor(oldZoom) + 1;\n\n      map._zoomAnimation(zoom, param['containerPoint']);\n    }\n  };\n\n  return MapDoubleClickZoomHandler;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'doubleClickZoom': true\n});\nMap$1.addOnLoadHook('addHandler', 'doubleClickZoom', MapDoubleClickZoomHandler);\n\nvar MapDragHandler = function (_Handler) {\n  _inheritsLoose(MapDragHandler, _Handler);\n\n  function MapDragHandler() {\n    return _Handler.apply(this, arguments) || this;\n  }\n\n  var _proto = MapDragHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    var map = this.target;\n\n    if (!map) {\n      return;\n    }\n\n    var dom = map._panels.mapWrapper || map._containerDOM;\n    this._dragHandler = new DragHandler(dom, {\n      'cancelOn': this._cancelOn.bind(this),\n      'rightclick': true\n    });\n\n    this._dragHandler.on('mousedown', this._onMouseDown, this).on('dragstart', this._onDragStart, this).on('dragging', this._onDragging, this).on('dragend', this._onDragEnd, this).enable();\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    this._dragHandler.off('mousedown', this._onMouseDown, this).off('dragstart', this._onDragStart, this).off('dragging', this._onDragging, this).off('dragend', this._onDragEnd, this);\n\n    this._dragHandler.remove();\n\n    delete this._dragHandler;\n  };\n\n  _proto._cancelOn = function _cancelOn(domEvent) {\n    if (this.target.isZooming() || this._ignore(domEvent)) {\n      return true;\n    }\n\n    return false;\n  };\n\n  _proto._ignore = function _ignore(param) {\n    if (!param) {\n      return false;\n    }\n\n    if (param.domEvent) {\n      param = param.domEvent;\n    }\n\n    return this.target._ignoreEvent(param);\n  };\n\n  _proto._onMouseDown = function _onMouseDown(param) {\n    delete this.startDragTime;\n    delete this._mode;\n\n    if (param.domEvent.button === 2 || param.domEvent.ctrlKey) {\n      if (this.target.options['dragRotate'] || this.target.options['dragPitch']) {\n        this._mode = 'rotatePitch';\n      }\n    } else if (this.target.options['dragPan']) {\n      this._mode = 'move';\n    }\n\n    this.target._stopAnim(this.target._mapAnimPlayer);\n\n    preventDefault(param['domEvent']);\n  };\n\n  _proto._onDragStart = function _onDragStart(param) {\n    this.startDragTime = now();\n\n    if (this._mode === 'move') {\n      this._moveStart(param);\n    } else if (this._mode === 'rotatePitch') {\n      this._rotateStart(param);\n    }\n  };\n\n  _proto._onDragging = function _onDragging(param) {\n    var map = this.target;\n\n    if (map._isEventOutMap(param['domEvent'])) {\n      return;\n    }\n\n    if (this._mode === 'move') {\n      this._moving(param);\n    } else if (this._mode === 'rotatePitch') {\n      this._rotating(param);\n    }\n  };\n\n  _proto._onDragEnd = function _onDragEnd(param) {\n    if (this._mode === 'move') {\n      this._moveEnd(param);\n    } else if (this._mode === 'rotatePitch') {\n      this._rotateEnd(param);\n    }\n\n    delete this.startDragTime;\n    delete this.startBearing;\n  };\n\n  _proto._start = function _start(param) {\n    this.preX = param['mousePos'].x;\n    this.preY = param['mousePos'].y;\n    this.startX = this.preX;\n    this.startY = this.preY;\n    this._startPrjCenter = this.target._getPrjCenter().copy();\n  };\n\n  _proto._moveStart = function _moveStart(param) {\n    this._start(param);\n\n    var map = this.target;\n    map.onMoveStart(param);\n    var p = getEventContainerPoint(map._getActualEvent(param.domEvent), map.getContainer());\n    this.startPrjCoord = map._containerPointToPrj(p);\n  };\n\n  _proto._moving = function _moving(param) {\n    if (!this.startDragTime) {\n      return;\n    }\n\n    var map = this.target;\n    var p = getEventContainerPoint(map._getActualEvent(param.domEvent), map.getContainer());\n\n    map._setPrjCoordAtContainerPoint(this.startPrjCoord, p);\n\n    map.onMoving(param);\n  };\n\n  _proto._moveEnd = function _moveEnd(param) {\n    if (!this.startDragTime) {\n      return;\n    }\n\n    var isTouch = param.domEvent.type === 'touchend';\n    var map = this.target;\n    var t = now() - this.startDragTime;\n    var mx = param['mousePos'].x,\n        my = param['mousePos'].y;\n    var dx = mx - this.startX;\n    var dy = my - this.startY;\n\n    var currentCenter = map._getPrjCenter();\n\n    var dxy = currentCenter.sub(this._startPrjCenter);\n\n    this._clear();\n\n    if (map.options['panAnimation'] && !param.interupted && map._verifyExtent(map._getPrjCenter()) && t < 280 && Math.abs(dy) + Math.abs(dx) > 5) {\n      t = 5 * t;\n      var dscale = isTouch ? 5 : 2.8;\n      var targetPrjCoord = currentCenter.add(dxy._multi(dscale));\n      var targetCoord = map.getProjection().unproject(targetPrjCoord);\n      map.panTo(targetCoord, {\n        'duration': isTouch ? t * 3 : t * 2,\n        'easing': 'outExpo'\n      });\n    } else {\n      map.onMoveEnd(param);\n    }\n  };\n\n  _proto._rotateStart = function _rotateStart(param) {\n    this._start(param);\n\n    delete this._rotateMode;\n    this.startBearing = this.target.getBearing();\n    this.target.onDragRotateStart(param);\n    this._db = 0;\n  };\n\n  _proto._rotating = function _rotating(param) {\n    var map = this.target;\n    var mx = param['mousePos'].x,\n        my = param['mousePos'].y;\n    var prePitch = map.getPitch(),\n        preBearing = map.getBearing();\n    var dx = Math.abs(mx - this.preX),\n        dy = Math.abs(my - this.preY);\n\n    if (!this._rotateMode) {\n      if (map.options['dragRotatePitch']) {\n        this._rotateMode = 'rotate_pitch';\n      } else if (dx > dy) {\n        this._rotateMode = 'rotate';\n      } else if (dx < dy) {\n        this._rotateMode = 'pitch';\n      } else {\n        this._rotateMode = 'rotate';\n      }\n    }\n\n    if (this._rotateMode === 'pitch' && prePitch === 0 && dy < 10) {\n      return;\n    }\n\n    if (this._rotateMode.indexOf('rotate') >= 0 && map.options['dragRotate']) {\n      var db = 0;\n\n      if (map.options['dragPitch'] || dx > dy) {\n        db = -0.6 * (this.preX - mx);\n      } else if (mx > map.width / 2) {\n        db = 0.6 * (this.preY - my);\n      } else {\n        db = -0.6 * (this.preY - my);\n      }\n\n      var bearing = map.getBearing() + db;\n      this._db = this._db || 0;\n      this._db += db;\n\n      map._setBearing(bearing);\n    }\n\n    if (this._rotateMode.indexOf('pitch') >= 0 && map.options['dragPitch']) {\n      map._setPitch(map.getPitch() + (this.preY - my) * 0.4);\n    }\n\n    this.preX = mx;\n    this.preY = my;\n\n    if (map.getBearing() !== preBearing || map.getPitch() !== prePitch) {\n      map.onDragRotating(param);\n    }\n  };\n\n  _proto._rotateEnd = function _rotateEnd(param) {\n    var map = this.target;\n    var bearing = map.getBearing();\n\n    this._clear();\n\n    var t = now() - this.startDragTime;\n    map.onDragRotateEnd(param);\n\n    if (map.options['rotateAnimation'] && Math.abs(bearing - this.startBearing) > 20 && (this._rotateMode === 'rotate' || this._rotateMode === 'rotate_pitch') && !param.interupted && t < 400) {\n      var _bearing = map.getBearing();\n\n      map._animateTo({\n        'bearing': _bearing + this._db / 1.5\n      }, {\n        'easing': 'outQuint',\n        'duration': 1600\n      });\n    }\n  };\n\n  _proto._clear = function _clear() {\n    delete this.startPrjCoord;\n    delete this.preX;\n    delete this.preY;\n    delete this.startX;\n    delete this.startY;\n  };\n\n  return MapDragHandler;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'draggable': true,\n  'dragPan': true,\n  'dragRotatePitch': true,\n  'dragRotate': true,\n  'dragPitch': true\n});\nMap$1.addOnLoadHook('addHandler', 'draggable', MapDragHandler);\n\nvar EVENTS = 'mousedown ' + 'mouseup ' + 'mousemove ' + 'click ' + 'dblclick ' + 'contextmenu ' + 'touchstart ' + 'touchmove ' + 'touchend';\n\nvar MapGeometryEventsHandler = function (_Handler) {\n  _inheritsLoose(MapGeometryEventsHandler, _Handler);\n\n  function MapGeometryEventsHandler() {\n    return _Handler.apply(this, arguments) || this;\n  }\n\n  var _proto = MapGeometryEventsHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    var map = this.target;\n    var dom = map._panels.allLayers || map._containerDOM;\n    on(dom, EVENTS, this._identifyGeometryEvents, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    var map = this.target;\n    var dom = map._panels.allLayers || map._containerDOM;\n    off(dom, EVENTS, this._identifyGeometryEvents, this);\n  };\n\n  _proto._identifyGeometryEvents = function _identifyGeometryEvents(domEvent, type) {\n    var map = this.target;\n\n    if (map.isInteracting() || map._ignoreEvent(domEvent)) {\n      return;\n    }\n\n    var oneMoreEvent = null;\n    var eventType = type || domEvent.type;\n    var isMousedown = eventType === 'mousedown' || eventType === 'touchstart' && domEvent.touches && domEvent.touches.length === 1;\n\n    if (isMousedown) {\n      this._mouseDownTime = now();\n    } else if ((eventType === 'click' || eventType === 'touchend') && this._mouseDownTime) {\n      var downTime = this._mouseDownTime;\n      delete this._mouseDownTime;\n      var time = now();\n\n      if (time - downTime > 300) {\n        if (eventType === 'click') {\n          return;\n        }\n      } else if (eventType === 'touchend') {\n        oneMoreEvent = 'click';\n      }\n    }\n\n    var actual = domEvent.touches && domEvent.touches.length > 0 ? domEvent.touches[0] : domEvent.changedTouches && domEvent.changedTouches.length > 0 ? domEvent.changedTouches[0] : domEvent;\n\n    if (!actual) {\n      return;\n    }\n\n    var containerPoint = getEventContainerPoint(actual, map._containerDOM);\n\n    if (eventType === 'touchstart') {\n      preventDefault(domEvent);\n    }\n\n    var geometryCursorStyle = null;\n    var tops = this.target.getRenderer().getTopElements();\n    var topOnlyEvent = isMousedown && domEvent.button !== 2;\n\n    for (var i = 0; i < tops.length; i++) {\n      if (tops[i].hitTest(containerPoint)) {\n        var cursor = tops[i].options['cursor'];\n\n        if (cursor) {\n          geometryCursorStyle = cursor;\n        }\n\n        if (topOnlyEvent || tops[i].events && tops[i].events.indexOf(eventType) >= 0) {\n          var e = {\n            target: map,\n            type: eventType,\n            domEvent: domEvent,\n            containerPoint: containerPoint\n          };\n\n          if (topOnlyEvent) {\n            map._setPriorityCursor(geometryCursorStyle);\n\n            tops[i].mousedown(e);\n            return;\n          } else {\n            tops[i].onEvent(e);\n          }\n        }\n      }\n    }\n\n    var layers = map._getLayers(function (layer) {\n      if (layer.identify && layer.options['geometryEvents']) {\n        return true;\n      }\n\n      return false;\n    });\n\n    map._setPriorityCursor(geometryCursorStyle);\n\n    if (!layers.length) {\n      return;\n    }\n\n    var identifyOptions = {\n      'includeInternals': true,\n      'filter': function filter(geometry) {\n        if (!(geometry instanceof Geometry)) {\n          return false;\n        }\n\n        var eventToFire = geometry._getEventTypeToFire(domEvent);\n\n        if (eventType === 'mousemove') {\n          if (!geometryCursorStyle && geometry.options['cursor']) {\n            geometryCursorStyle = geometry.options['cursor'];\n          }\n\n          if (!geometry.listens('mousemove') && !geometry.listens('mouseover') && !geometry.listens('mouseenter')) {\n            return false;\n          }\n        } else if (!geometry.listens(eventToFire) && !geometry.listens(oneMoreEvent)) {\n          return false;\n        }\n\n        return true;\n      },\n      'count': 1,\n      'containerPoint': containerPoint,\n      'onlyVisible': map.options['onlyVisibleGeometryEvents'],\n      'layers': layers\n    };\n    var callback = fireGeometryEvent.bind(this);\n\n    if (eventType === 'mousemove' || eventType === 'touchmove') {\n      this._queryIdentifyTimeout = map.getRenderer().callInNextFrame(function () {\n        if (map.isInteracting()) {\n          return;\n        }\n\n        map.identifyAtPoint(identifyOptions, callback);\n      });\n    } else {\n      map.identifyAtPoint(identifyOptions, callback);\n    }\n\n    function fireGeometryEvent(geometries) {\n      var propagation = true;\n\n      if (eventType === 'mousemove') {\n        var geoMap = {};\n\n        if (geometries.length > 0) {\n          for (var _i = geometries.length - 1; _i >= 0; _i--) {\n            var geo = geometries[_i];\n\n            if (!(geo instanceof Geometry)) {\n              continue;\n            }\n\n            var iid = geo._getInternalId();\n\n            geoMap[iid] = geo;\n\n            geo._onEvent(domEvent);\n\n            if (!this._prevOverGeos || !this._prevOverGeos.geomap[iid]) {\n              geo._onEvent(domEvent, 'mouseenter');\n            }\n\n            propagation = geo._onEvent(domEvent, 'mouseover');\n          }\n        }\n\n        map._setPriorityCursor(geometryCursorStyle);\n\n        var oldTargets = this._prevOverGeos && this._prevOverGeos.geos;\n        this._prevOverGeos = {\n          'geos': geometries,\n          'geomap': geoMap\n        };\n\n        if (oldTargets && oldTargets.length > 0) {\n          for (var _i2 = oldTargets.length - 1; _i2 >= 0; _i2--) {\n            var oldTarget = oldTargets[_i2];\n\n            if (!(oldTarget instanceof Geometry)) {\n              continue;\n            }\n\n            var oldTargetId = oldTargets[_i2]._getInternalId();\n\n            if (!geoMap[oldTargetId]) {\n              propagation = oldTarget._onEvent(domEvent, 'mouseout');\n            }\n          }\n        }\n      } else {\n        if (!geometries || !geometries.length) {\n          return;\n        }\n\n        for (var _i3 = geometries.length - 1; _i3 >= 0; _i3--) {\n          if (!(geometries[_i3] instanceof Geometry)) {\n            continue;\n          }\n\n          propagation = geometries[_i3]._onEvent(domEvent);\n\n          if (oneMoreEvent) {\n            geometries[_i3]._onEvent(domEvent, oneMoreEvent);\n          }\n\n          break;\n        }\n      }\n\n      if (propagation === false) {\n        stopPropagation(domEvent);\n      }\n    }\n  };\n\n  return MapGeometryEventsHandler;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'geometryEvents': true,\n  'onlyVisibleGeometryEvents': true\n});\nMap$1.addOnLoadHook('addHandler', 'geometryEvents', MapGeometryEventsHandler);\n\nvar wheelZoomDelta = 4.000244140625;\nvar defaultZoomRate = 1 / 100;\nvar wheelZoomRate = 1 / 450;\nvar maxScalePerFrame = 2;\n\nvar MapScrollWheelZoomHandler = function (_Handler) {\n  _inheritsLoose(MapScrollWheelZoomHandler, _Handler);\n\n  function MapScrollWheelZoomHandler(target) {\n    var _this;\n\n    _this = _Handler.call(this, target) || this;\n    _this._thisScrollZoom = _this._scrollZoom.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this._wheelZoomRate = wheelZoomRate;\n    _this._defaultZoomRate = defaultZoomRate;\n    _this._delta = 0;\n    return _this;\n  }\n\n  var _proto = MapScrollWheelZoomHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    addDomEvent(this.target._containerDOM, 'wheel', this._onWheelScroll, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    removeDomEvent(this.target._containerDOM, 'wheel', this._onWheelScroll);\n  };\n\n  _proto._onWheelScroll = function _onWheelScroll(evt) {\n    preventDefault(evt);\n    stopPropagation(evt);\n    var map = this.target;\n\n    if (map._ignoreEvent(evt) || !map.options['zoomable']) {\n      return false;\n    }\n\n    var container = map._containerDOM;\n\n    var origin = map._checkZoomOrigin(getEventContainerPoint(evt, container));\n\n    if (map.options['seamlessZoom']) {\n      if (!this._zooming) {\n        this._trackPadSuspect = 0;\n        this._ensureTrackpad = false;\n      }\n\n      return this._seamless(evt, origin);\n    } else {\n      return this._interval(evt, origin);\n    }\n  };\n\n  _proto._seamless = function _seamless(evt, origin) {\n    var value = evt.deltaMode === window.WheelEvent.DOM_DELTA_LINE ? evt.deltaY * 60 : evt.deltaY;\n\n    if (value % wheelZoomDelta !== 0) {\n      if (!this._ensureTrackpad) {\n        if (Math.abs(value) < 60) {\n          this._trackPadSuspect++;\n        } else {\n          this._trackPadSuspect = 0;\n        }\n\n        if (this._trackPadSuspect >= 2) {\n          this._ensureTrackpad = true;\n        }\n      }\n\n      if (this._ensureTrackpad) {\n        value *= 14;\n      }\n    }\n\n    if (evt.shiftKey && value) value = value / 4;\n    this._lastWheelEvent = evt;\n    this._delta -= value;\n\n    if (!this._zooming && this._delta) {\n      var map = this.target;\n      this._zoomOrigin = origin;\n      map.onZoomStart(null, origin);\n    }\n\n    this._start();\n  };\n\n  _proto._start = function _start() {\n    if (!this._delta) return;\n    this._zooming = true;\n    var map = this.target;\n\n    if (!this._active) {\n      map.getRenderer().callInNextFrame(this._thisScrollZoom);\n      this._active = true;\n    }\n  };\n\n  _proto._scrollZoom = function _scrollZoom() {\n    var _this2 = this;\n\n    this._active = false;\n\n    if (!this._delta) {\n      return;\n    }\n\n    var zoomRate = Math.abs(this._delta) > wheelZoomDelta ? this._wheelZoomRate : this._defaultZoomRate;\n    var scale = maxScalePerFrame / (1 + Math.exp(-Math.abs(this._delta * zoomRate)));\n\n    if (this._delta < 0 && scale !== 0) {\n      scale = 1 / scale;\n    }\n\n    var map = this.target;\n    var zoom = map.getZoom();\n    var targetZoom = map.getZoomForScale(scale, zoom, true);\n    this._delta = 0;\n    map.onZooming(targetZoom, this._zoomOrigin);\n\n    if (this._timeout) {\n      clearTimeout(this._timeout);\n    }\n\n    this._timeout = setTimeout(function () {\n      _this2._zooming = false;\n      delete _this2._timeout;\n      map.onZoomEnd(map.getZoom(), _this2._zoomOrigin);\n    }, 210);\n  };\n\n  _proto._interval = function _interval(evt, origin) {\n    var _this3 = this;\n\n    var map = this.target;\n\n    if (this._zooming) {\n      this._requesting++;\n      return false;\n    }\n\n    this._requesting = 0;\n    var levelValue = (evt.deltaY ? evt.deltaY * -1 : evt.wheelDelta ? evt.wheelDelta : evt.detail) > 0 ? 1 : -1;\n\n    if (evt.detail) {\n      levelValue *= -1;\n    }\n\n    var zoom = map.getZoom();\n    var nextZoom = zoom + levelValue;\n    nextZoom = map._checkZoom(levelValue > 0 ? Math.ceil(nextZoom) : Math.floor(nextZoom));\n\n    if (nextZoom === zoom) {\n      return false;\n    }\n\n    this._zooming = true;\n\n    if (!this._delta) {\n      map.onZoomStart(null, origin);\n      this._origin = origin;\n      this._delta = levelValue;\n      this._startZoom = map.getZoom();\n    }\n\n    var duration = 90;\n\n    map._animateTo({\n      'zoom': nextZoom - this._delta * 1 / 2,\n      'around': this._origin\n    }, {\n      'continueOnViewChanged': true,\n      'easing': 'linear',\n      'duration': duration,\n      'wheelZoom': true\n    }, function (frame) {\n      if (frame.state.playState !== 'finished') {\n        if (frame.state.playState !== 'running') {\n          delete _this3._zooming;\n          delete _this3._requesting;\n        }\n\n        return;\n      }\n\n      if (_this3._requesting < 1 || Math.abs(nextZoom - _this3._startZoom) > 2 || nextZoom === map.getMaxZoom() || nextZoom === map.getMinZoom()) {\n        map._animateTo({\n          'zoom': nextZoom,\n          'around': _this3._origin\n        }, {\n          'continueOnViewChanged': true,\n          'duration': 100\n        }, function (frame) {\n          if (frame.state.playState !== 'running') {\n            delete _this3._zooming;\n            delete _this3._requesting;\n          }\n        });\n\n        delete _this3._startZoom;\n        delete _this3._origin;\n        delete _this3._delta;\n        _this3._requesting = 0;\n      } else if (!isNil(_this3._requesting)) {\n        delete _this3._zooming;\n\n        _this3._onWheelScroll(evt);\n      }\n    });\n\n    return false;\n  };\n\n  return MapScrollWheelZoomHandler;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'scrollWheelZoom': true,\n  'seamlessZoom': true\n});\nMap$1.addOnLoadHook('addHandler', 'scrollWheelZoom', MapScrollWheelZoomHandler);\n\nvar MapTouchZoomHandler = function (_Handler) {\n  _inheritsLoose(MapTouchZoomHandler, _Handler);\n\n  function MapTouchZoomHandler() {\n    return _Handler.apply(this, arguments) || this;\n  }\n\n  var _proto = MapTouchZoomHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    addDomEvent(this.target.getContainer(), 'touchstart', this._onTouchStart, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    removeDomEvent(this.target.getContainer(), 'touchstart', this._onTouchStart);\n  };\n\n  _proto._onTouchStart = function _onTouchStart(event) {\n    var map = this.target;\n\n    if (!event.touches || event.touches.length < 2) {\n      return;\n    }\n\n    var container = map.getContainer();\n    var p1 = getEventContainerPoint(event.touches[0], container),\n        p2 = getEventContainerPoint(event.touches[1], container);\n    this.preY = p1.y;\n    this._startP1 = p1;\n    this._startP2 = p2;\n    this._startDist = p1.distanceTo(p2);\n    this._startVector = p1.sub(p2);\n    this._startZoom = map.getZoom();\n    this._startBearing = map.getBearing();\n    off(document, 'touchmove', this._onTouchMove, this);\n    off(document, 'touchend', this._onTouchEnd, this);\n    addDomEvent(document, 'touchmove', this._onTouchMove, this);\n    addDomEvent(document, 'touchend', this._onTouchEnd, this);\n    preventDefault(event);\n\n    map._fireEvent('touchactstart');\n  };\n\n  _proto._onTouchMove = function _onTouchMove(event) {\n    var map = this.target;\n\n    if (!event.touches || event.touches.length < 2) {\n      return;\n    }\n\n    var container = map.getContainer(),\n        p1 = getEventContainerPoint(event.touches[0], container),\n        p2 = getEventContainerPoint(event.touches[1], container),\n        d1 = p1.sub(this._startP1),\n        d2 = p2.sub(this._startP2),\n        vector = p1.sub(p2),\n        scale = p1.distanceTo(p2) / this._startDist,\n        bearing = vector.angleWith(this._startVector) * 180 / Math.PI,\n        preY = this.preY || p1.y,\n        pitch = (preY - p1.y) * 0.4;\n\n    this.preY = p1.y;\n    var param = {\n      'domEvent': event,\n      'mousePos': [p1, p2]\n    };\n\n    if (!this.mode) {\n      if (map.options['touchRotate'] && Math.abs(bearing) > 8) {\n        this.mode = map.options['touchZoomRotate'] ? 'rotate_zoom' : 'rotate';\n      } else if (map.options['touchPitch'] && d1.y * d2.y > 0 && Math.abs(d1.y) > 10 && Math.abs(d2.y) > 10) {\n        this.mode = 'pitch';\n      } else if (map.options['zoomable'] && map.options['touchZoom'] && Math.abs(1 - scale) > 0.15) {\n        this.mode = map.options['touchZoomRotate'] && map.options['touchRotate'] ? 'rotate_zoom' : 'zoom';\n      }\n\n      this._startTouching(param);\n    }\n\n    if (this.mode === 'zoom' || this.mode === 'rotate_zoom') {\n      this._scale = scale;\n      var res = map._getResolution(this._startZoom) / scale;\n      var zoom = map.getZoomFromRes(res);\n      map.onZooming(zoom, this._Origin);\n    }\n\n    if (this.mode === 'rotate' || this.mode === 'rotate_zoom') {\n      map._setBearing(this._startBearing + bearing);\n\n      map.onDragRotating(param);\n    } else if (this.mode === 'pitch') {\n      map._setPitch(map.getPitch() + pitch);\n\n      map.onDragRotating(param);\n    }\n\n    map._fireEvent('touchactinging');\n  };\n\n  _proto._startTouching = function _startTouching(param) {\n    var map = this.target;\n\n    if (this.mode === 'zoom' || this.mode === 'rotate_zoom') {\n      var size = map.getSize();\n      this._Origin = new Point(size['width'] / 2, size['height'] / 2);\n      map.onZoomStart(null, this._Origin);\n    }\n\n    if (this.mode === 'rotate' || this.mode === 'pitch' || this.mode === 'rotate_zoom') {\n      map.onDragRotateStart(param);\n    }\n  };\n\n  _proto._onTouchEnd = function _onTouchEnd(event) {\n    delete this.preY;\n    var map = this.target;\n    off(document, 'touchmove', this._onTouchMove, this);\n    off(document, 'touchend', this._onTouchEnd, this);\n\n    if (this.mode === 'zoom' || this.mode === 'rotate_zoom') {\n      var scale = this._scale;\n      var res = map._getResolution(this._startZoom) / scale;\n      var zoom = map.getZoomFromRes(res);\n      map.onZoomEnd(zoom, this._Origin);\n    }\n\n    if (this.mode === 'pitch' || this.mode === 'rotate' || this.mode === 'rotate_zoom') {\n      map.onDragRotateEnd({\n        'domEvent': event\n      });\n    }\n\n    delete this.mode;\n\n    map._fireEvent('touchactend');\n  };\n\n  return MapTouchZoomHandler;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'touchGesture': true,\n  'touchZoom': true,\n  'touchPitch': true,\n  'touchRotate': true,\n  'touchZoomRotate': false\n});\nMap$1.addOnLoadHook('addHandler', 'touchGesture', MapTouchZoomHandler);\n\nvar KEY = '__anim_player';\nvar Easing = {\n  outExpo: function outExpo(x) {\n    return x === 1 ? 1 : 1 - Math.pow(2, -10 * x);\n  },\n  outQuint: function outQuint(x) {\n    return 1 - Math.pow(1 - x, 5);\n  },\n  in: function _in(t) {\n    return Math.pow(t, 2);\n  },\n  out: function out(t) {\n    return 1 - Easing.in(1 - t);\n  },\n  inAndOut: function inAndOut(t) {\n    return 3 * t * t - 2 * t * t * t;\n  },\n  linear: function linear(t) {\n    return t;\n  },\n  upAndDown: function upAndDown(t) {\n    if (t < 0.5) {\n      return Easing.inAndOut(2 * t);\n    } else {\n      return 1 - Easing.inAndOut(2 * (t - 0.5));\n    }\n  }\n};\n\nvar Frame = function Frame(state, styles) {\n  this.state = state;\n  this.styles = styles;\n};\n\nvar Player = function Player(animation, options, onFrame, target) {\n  this._animation = animation;\n  this.options = options;\n  this._onFrame = onFrame;\n  this.playState = 'idle';\n  this.ready = true;\n  this.finished = false;\n  this.target = target;\n};\n\nvar Animation = {\n  speed: {\n    'slow': 2000,\n    'normal': 1000,\n    'fast': 500\n  },\n  _resolveStyles: function _resolveStyles(styles) {\n    if (!styles) {\n      return null;\n    }\n\n    function resolveChild(child) {\n      if (!Array.isArray(child)) {\n        return Animation._resolveStyles(child);\n      }\n\n      var start = [],\n          d = [],\n          dest = [];\n\n      for (var i = 0; i < child.length; i++) {\n        var _styles = Animation._resolveStyles(child[i]);\n\n        if (_styles) {\n          start.push(_styles[0]);\n          d.push(_styles[1]);\n          dest.push(_styles[2]);\n        }\n      }\n\n      if (!start.length) {\n        return null;\n      } else {\n        return [start, d, dest];\n      }\n    }\n\n    function resolveVal(val) {\n      var values = val;\n      var clazz;\n\n      if (!Array.isArray(val)) {\n        if (isNumber(val)) {\n          values = [0, val];\n        } else if (val instanceof Point || val instanceof Coordinate) {\n          clazz = val.constructor;\n          values = [new clazz(0, 0), val];\n        } else {\n          values = [val, val];\n        }\n      }\n\n      var v1 = values[0],\n          v2 = values[1];\n\n      if (isNumber(v1) && isNumber(v2)) {\n        if (v1 === v2) {\n          return null;\n        }\n\n        return [v1, v2 - v1, v2];\n      } else if (Array.isArray(v1) && isNumber(v1[0]) || v1 instanceof Coordinate || v1 instanceof Point) {\n        if (Array.isArray(v1)) {\n          v1 = new Coordinate(v1);\n          v2 = new Coordinate(v2);\n        } else {\n          clazz = v1.constructor;\n          v1 = new clazz(v1);\n          v2 = new clazz(v2);\n        }\n\n        if (v1.equals(v2)) {\n          return null;\n        }\n\n        return [v1, v2.sub(v1), v2];\n      } else {\n        return [v1, v2, v2];\n      }\n    }\n\n    function isChild(val) {\n      if (!Array.isArray(val) && val.constructor === Object) {\n        return true;\n      } else if (Array.isArray(val) && val[0].constructor === Object) {\n        return true;\n      }\n\n      return false;\n    }\n\n    var d = {},\n        start = {},\n        dest = {};\n\n    for (var p in styles) {\n      if (styles.hasOwnProperty(p)) {\n        var values = styles[p];\n\n        if (!values) {\n          continue;\n        } else if (Array.isArray(values)) {\n          if (isNil(values[0]) || isNil(values[1])) {\n            continue;\n          }\n        }\n\n        var childStyles = void 0;\n\n        if (isChild(values)) {\n          childStyles = resolveChild(values);\n        } else {\n          childStyles = resolveVal(values);\n        }\n\n        if (childStyles) {\n          start[p] = childStyles[0];\n          d[p] = childStyles[1];\n          dest[p] = childStyles[2];\n        }\n      }\n    }\n\n    return [start, d, dest];\n  },\n  framing: function framing(styles, options) {\n    if (!options) {\n      options = {};\n    }\n\n    var easing = options['easing'] ? Easing[options['easing']] : Easing.linear;\n\n    if (!easing) {\n      easing = Easing.linear;\n    }\n\n    var dStyles, startStyles, destStyles;\n    styles = Animation._resolveStyles(styles);\n\n    if (styles) {\n      startStyles = styles[0];\n      dStyles = styles[1];\n      destStyles = styles[2];\n    }\n\n    var deltaStyles = function deltaStyles(delta, _startStyles, _dStyles) {\n      if (!_startStyles || !_dStyles) {\n        return null;\n      }\n\n      var result = {};\n\n      for (var p in _dStyles) {\n        if (_dStyles.hasOwnProperty(p)) {\n          if (_startStyles[p] === destStyles[p]) {\n            result[p] = _startStyles[p];\n            continue;\n          }\n\n          var s = _startStyles[p],\n              d = _dStyles[p];\n\n          if (isNumber(d)) {\n            result[p] = s + delta * d;\n          } else if (Array.isArray(d)) {\n            var children = [];\n\n            for (var i = 0; i < d.length; i++) {\n              children.push(deltaStyles(delta, s[i], d[i]));\n            }\n\n            result[p] = children;\n          } else {\n            var clazz = d.constructor;\n\n            if (clazz === Object) {\n              result[p] = deltaStyles(delta, s, d);\n            } else if (s instanceof Point || s instanceof Coordinate) {\n              result[p] = s.add(d.multi(delta));\n            } else {\n              result[p] = d;\n            }\n          }\n        }\n      }\n\n      return result;\n    };\n\n    return function (elapsed, duration) {\n      var state, d;\n\n      if (elapsed < 0) {\n        state = {\n          'playState': 'idle',\n          'delta': 0\n        };\n        d = startStyles;\n      } else if (elapsed < duration) {\n        var delta = easing(elapsed / duration);\n        state = {\n          'playState': 'running',\n          'delta': delta\n        };\n        d = deltaStyles(delta, startStyles, dStyles);\n      } else {\n        state = {\n          'playState': 'finished',\n          'delta': 1\n        };\n        d = destStyles;\n      }\n\n      state['startStyles'] = startStyles;\n      state['destStyles'] = destStyles;\n      state['progress'] = elapsed;\n      state['remainingMs'] = duration - elapsed;\n      return new Frame(state, d);\n    };\n  },\n  _requestAnimFrame: function _requestAnimFrame(fn) {\n    if (!this._frameQueue) {\n      this._frameQueue = [];\n    }\n\n    this._frameQueue.push(fn);\n\n    this._a();\n  },\n  _a: function _a() {\n    if (!this._animationFrameId) {\n      this._animationFrameId = requestAnimFrame(Animation._frameFn);\n    }\n  },\n  _run: function _run() {\n    if (this._frameQueue.length) {\n      var running = this._frameQueue;\n      this._frameQueue = [];\n\n      for (var i = 0, len = running.length; i < len; i++) {\n        running[i]();\n      }\n\n      if (this._frameQueue.length) {\n        this._animationFrameId = requestAnimFrame(Animation._frameFn);\n      } else {\n        delete this._animationFrameId;\n      }\n    }\n  },\n  animate: function animate(styles, options, step, target) {\n    if (!options) {\n      options = {};\n    }\n\n    var animation = Animation.framing(styles, options);\n    var player = new Player(animation, options, step, target);\n    return player;\n  }\n};\nAnimation._frameFn = Animation._run.bind(Animation);\nextend(Player.prototype, {\n  _prepare: function _prepare() {\n    var options = this.options;\n    var duration = options['speed'] || options['duration'];\n\n    if (isString(duration)) {\n      duration = Animation.speed[duration];\n\n      if (!duration) {\n        duration = +duration;\n      }\n    }\n\n    if (!duration) {\n      duration = Animation.speed['normal'];\n    }\n\n    this.duration = duration;\n    this._framer = options['framer'] || Animation._requestAnimFrame.bind(Animation);\n  },\n  play: function play() {\n    if (this.playState !== 'idle' && this.playState !== 'paused' || this.target && this.target[KEY]) {\n      return this;\n    }\n\n    if (this.target) {\n      this.target[KEY] = 1;\n    }\n\n    if (this.playState === 'idle') {\n      this.currentTime = 0;\n\n      this._prepare();\n    }\n\n    var t = now();\n\n    if (!this.startTime) {\n      var options = this.options;\n      this.startTime = options['startTime'] ? options['startTime'] : t;\n    }\n\n    this._playStartTime = Math.max(t, this.startTime);\n\n    if (this.playState === 'paused') {\n      this._playStartTime -= this.currentTime;\n    }\n\n    this.playState = 'running';\n\n    this._run();\n\n    return this;\n  },\n  pause: function pause() {\n    if (this.playState === 'paused') {\n      return this;\n    }\n\n    this.playState = 'paused';\n\n    this._run();\n\n    return this;\n  },\n  cancel: function cancel() {\n    if (this.playState === 'idle') {\n      return this;\n    }\n\n    this.playState = 'idle';\n    this.finished = false;\n\n    this._run();\n\n    return this;\n  },\n  finish: function finish() {\n    if (this.playState === 'finished') {\n      return this;\n    }\n\n    this.playState = 'finished';\n    this.finished = true;\n\n    this._run();\n\n    return this;\n  },\n  reverse: function reverse() {},\n  _run: function _run() {\n    var _this = this;\n\n    var onFrame = this._onFrame;\n    var t = now();\n    var elapsed = t - this._playStartTime;\n\n    if (this.options['repeat'] && elapsed >= this.duration) {\n      this._playStartTime = t;\n      elapsed = 0;\n    }\n\n    if (this.playState !== 'running') {\n      if (this.target) {\n        delete this.target[KEY];\n      }\n\n      if (onFrame) {\n        if (this.playState === 'finished') {\n          elapsed = this.duration;\n        } else if (this.playState === 'idle') {\n          elapsed = 0;\n        }\n\n        var _frame = this._animation(elapsed, this.duration);\n\n        _frame.state.playState = this.playState;\n        onFrame(_frame);\n      }\n\n      return;\n    }\n\n    var frame = this._animation(elapsed, this.duration);\n\n    this.playState = frame.state['playState'];\n\n    if (this.playState !== 'running' && this.target) {\n      delete this.target[KEY];\n    }\n\n    if (this.playState === 'idle') {\n      if (this.startTime > t) {\n        setTimeout(this._run.bind(this), this.startTime - t);\n      }\n    } else if (this.playState === 'running') {\n      this._framer(function () {\n        if (_this.playState !== 'running') {\n          return;\n        }\n\n        _this.currentTime = elapsed;\n\n        if (onFrame) {\n          onFrame(frame);\n        }\n\n        _this._run();\n      });\n    } else if (this.playState === 'finished') {\n      this.finished = true;\n\n      if (onFrame) {\n        onFrame(frame);\n      }\n    }\n  }\n});\n\nvar Animation$1 = /*#__PURE__*/Object.freeze({\n  Animation: Animation,\n  Easing: Easing,\n  Player: Player,\n  Frame: Frame\n});\n\nvar options$3 = {\n  'smoothness': 0,\n  'enableClip': true,\n  'enableSimplify': true,\n  'simplifyTolerance': 2,\n  'symbol': {\n    'lineColor': '#000',\n    'lineWidth': 2,\n    'lineOpacity': 1,\n    'polygonFill': '#fff',\n    'polygonOpacity': 1,\n    'opacity': 1\n  }\n};\n\nvar Path = function (_Geometry) {\n  _inheritsLoose(Path, _Geometry);\n\n  function Path() {\n    return _Geometry.apply(this, arguments) || this;\n  }\n\n  var _proto = Path.prototype;\n\n  _proto.animateShow = function animateShow(options, cb) {\n    var _this = this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (this._showPlayer) {\n      this._showPlayer.finish();\n    }\n\n    if (isFunction(options)) {\n      options = {};\n      cb = options;\n    }\n\n    var coordinates = this.getCoordinates();\n\n    if (coordinates.length === 0) {\n      return this;\n    }\n\n    this._animIdx = 0;\n    this._animLenSoFar = 0;\n    this.show();\n    var isPolygon = !!this.getShell;\n    var animCoords = isPolygon ? this.getShell().concat(this.getShell()[0]) : coordinates;\n\n    var projection = this._getProjection();\n\n    var prjAnimCoords = projection.projectCoords(animCoords);\n    this._prjAniShowCenter = this._getPrjExtent().getCenter();\n    this._aniShowCenter = projection.unproject(this._prjAniShowCenter);\n    var duration = options['duration'] || 1000,\n        easing = options['easing'] || 'out';\n    this.setCoordinates([]);\n    var length = 0;\n\n    if (prjAnimCoords.length) {\n      prjAnimCoords[0]._distance = 0;\n    }\n\n    for (var i = 1; i < prjAnimCoords.length; i++) {\n      var distance = prjAnimCoords[i].distanceTo(prjAnimCoords[i - 1]);\n      prjAnimCoords[i]._distance = distance;\n      length += distance;\n    }\n\n    this._tempCoord = new Coordinate(0, 0);\n    this._tempPrjCoord = new Point(0, 0);\n    var player = this._showPlayer = Animation.animate({\n      't': duration\n    }, {\n      'duration': duration,\n      'easing': easing\n    }, function (frame) {\n      if (!_this.getMap()) {\n        if (player.playState !== 'finished') {\n          player.finish();\n\n          if (cb) {\n            var _coordinates = _this.getCoordinates();\n\n            cb(frame, _coordinates[_coordinates.length - 1]);\n          }\n        }\n\n        return;\n      }\n\n      var currentCoord = _this._drawAnimShowFrame(frame.styles.t, duration, length, animCoords, prjAnimCoords);\n\n      if (frame.state.playState === 'finished') {\n        delete _this._showPlayer;\n        delete _this._aniShowCenter;\n        delete _this._prjAniShowCenter;\n        delete _this._animIdx;\n        delete _this._animLenSoFar;\n        delete _this._animTailRatio;\n        delete _this._tempCoord;\n        delete _this._tempPrjCoord;\n\n        _this.setCoordinates(coordinates);\n      }\n\n      if (cb) {\n        cb(frame, currentCoord);\n      }\n    }, this);\n    player.play();\n    return player;\n  };\n\n  _proto._drawAnimShowFrame = function _drawAnimShowFrame(t, duration, length, coordinates, prjCoords) {\n    if (t === 0) {\n      return coordinates[0];\n    }\n\n    var targetLength = t / duration * length;\n    var segLen = 0;\n    var i, l;\n\n    for (i = this._animIdx + 1, l = prjCoords.length; i < l; i++) {\n      segLen = prjCoords[i]._distance;\n\n      if (this._animLenSoFar + segLen > targetLength) {\n        break;\n      }\n\n      this._animLenSoFar += segLen;\n    }\n\n    this._animIdx = i - 1;\n\n    if (this._animIdx >= l - 1) {\n      this.setCoordinates(coordinates);\n      return coordinates[coordinates.length - 1];\n    }\n\n    var idx = this._animIdx;\n    var p1 = prjCoords[idx],\n        p2 = prjCoords[idx + 1],\n        span = targetLength - this._animLenSoFar,\n        r = span / segLen;\n    this._animTailRatio = r;\n    var x = p1.x + (p2.x - p1.x) * r,\n        y = p1.y + (p2.y - p1.y) * r;\n    this._tempPrjCoord.x = x;\n    this._tempPrjCoord.y = y;\n    var lastCoord = this._tempPrjCoord;\n    var c1 = coordinates[idx],\n        c2 = coordinates[idx + 1];\n    var cx = c1.x + (c2.x - c1.x) * r,\n        cy = c1.y + (c2.y - c1.y) * r;\n    this._tempCoord.x = cx;\n    this._tempCoord.y = cy;\n    var targetCoord = this._tempCoord;\n    var isPolygon = !!this.getShell;\n\n    if (!isPolygon && this.options['smoothness'] > 0) {\n      var animCoords = coordinates.slice(0, this._animIdx + 3);\n      this.setCoordinates(animCoords);\n      var prjAnimCoords = prjCoords.slice(0, this._animIdx + 3);\n\n      this._setPrjCoordinates(prjAnimCoords);\n    } else {\n      var _animCoords = coordinates.slice(0, this._animIdx + 1);\n\n      _animCoords.push(targetCoord);\n\n      var _prjAnimCoords = prjCoords.slice(0, this._animIdx + 1);\n\n      _prjAnimCoords.push(lastCoord);\n\n      if (isPolygon) {\n        this.setCoordinates([this._aniShowCenter].concat(_animCoords));\n\n        this._setPrjCoordinates([this._prjAniShowCenter].concat(_prjAnimCoords));\n      } else {\n        this.setCoordinates(_animCoords);\n\n        this._setPrjCoordinates(_prjAnimCoords);\n      }\n    }\n\n    return targetCoord;\n  };\n\n  _proto._getCenterInExtent = function _getCenterInExtent(extent, coordinates, clipFn) {\n    var meExtent = this.getExtent();\n\n    if (!extent.intersects(meExtent)) {\n      return null;\n    }\n\n    var clipped = clipFn(coordinates, extent);\n\n    if (clipped.length === 0) {\n      return null;\n    }\n\n    var sumx = 0,\n        sumy = 0,\n        counter = 0;\n    clipped.forEach(function (part) {\n      if (Array.isArray(part)) {\n        part.forEach(function (c) {\n          if (c.point) {\n            c = c.point;\n          }\n\n          sumx += c.x;\n          sumy += c.y;\n          counter++;\n        });\n      } else {\n        if (part.point) {\n          part = part.point;\n        }\n\n        sumx += part.x;\n        sumy += part.y;\n        counter++;\n      }\n    });\n\n    var c = new Coordinate(sumx, sumy)._multi(1 / counter);\n\n    c.count = counter;\n    return c;\n  };\n\n  _proto._getPath2DPoints = function _getPath2DPoints(prjCoords, disableSimplify, res) {\n    if (!isArrayHasData(prjCoords)) {\n      return [];\n    }\n\n    var map = this.getMap(),\n        isSimplify = !disableSimplify && this._shouldSimplify(),\n        tolerance = this.options['simplifyTolerance'] * map._getResolution(),\n        isMulti = Array.isArray(prjCoords[0]);\n\n    delete this._simplified;\n\n    if (isSimplify && !isMulti) {\n      var count = prjCoords.length;\n      prjCoords = simplify(prjCoords, tolerance, false);\n      this._simplified = prjCoords.length < count;\n    }\n\n    if (!res) {\n      res = map._getResolution();\n    }\n\n    if (!Array.isArray(prjCoords)) {\n      return map._prjToPointAtRes(prjCoords, res);\n    } else {\n      var resultPoints = [];\n      var glPointKey = '_glPt';\n\n      if (!Array.isArray(prjCoords[0])) {\n        resultPoints = getPointsResultPts(prjCoords, glPointKey);\n        return map._prjsToPointsAtRes(prjCoords, res, resultPoints);\n      }\n\n      var pts = [];\n\n      for (var i = 0, len = prjCoords.length; i < len; i++) {\n        var prjCoord = prjCoords[i];\n        resultPoints = getPointsResultPts(prjCoord, glPointKey);\n\n        var pt = map._prjsToPointsAtRes(prjCoord, res, resultPoints);\n\n        pts.push(pt);\n      }\n\n      return pts;\n    }\n  };\n\n  _proto._shouldSimplify = function _shouldSimplify() {\n    var layer = this.getLayer(),\n        properties = this.getProperties();\n    var hasAltitude = properties && layer.options['enableAltitude'] && !isNil(properties[layer.options['altitudeProperty']]) && properties[layer.options['altitudeProperty']] !== 0;\n    return layer && layer.options['enableSimplify'] && !hasAltitude && this.options['enableSimplify'] && !this._showPlayer;\n  };\n\n  _proto._setPrjCoordinates = function _setPrjCoordinates(prjPoints) {\n    this._prjCoords = prjPoints;\n    this.onShapeChanged();\n  };\n\n  _proto._getPrjCoordinates = function _getPrjCoordinates() {\n    this._verifyProjection();\n\n    if (!this._prjCoords && this._getProjection()) {\n      this._prjCoords = this._projectCoords(this._coordinates);\n    }\n\n    return this._prjCoords;\n  };\n\n  _proto._updateCache = function _updateCache() {\n    this._clearCache();\n\n    var projection = this._getProjection();\n\n    if (!projection) {\n      return;\n    }\n\n    if (this._prjCoords) {\n      this._coordinates = this._unprojectCoords(this._getPrjCoordinates());\n    }\n  };\n\n  _proto._clearProjection = function _clearProjection() {\n    this._prjCoords = null;\n\n    _Geometry.prototype._clearProjection.call(this);\n  };\n\n  _proto._projectCoords = function _projectCoords(points) {\n    var projection = this._getProjection();\n\n    if (projection) {\n      return projection.projectCoords(points);\n    }\n\n    return [];\n  };\n\n  _proto._unprojectCoords = function _unprojectCoords(prjPoints) {\n    var projection = this._getProjection();\n\n    if (projection) {\n      return projection.unprojectCoords(prjPoints);\n    }\n\n    return [];\n  };\n\n  _proto._computeCenter = function _computeCenter() {\n    var ring = this._coordinates;\n\n    if (!isArrayHasData(ring)) {\n      return null;\n    }\n\n    var sumx = 0,\n        sumy = 0,\n        counter = 0;\n    var size = ring.length;\n\n    for (var i = 0; i < size; i++) {\n      if (ring[i]) {\n        if (isNumber(ring[i].x) && isNumber(ring[i].y)) {\n          sumx += ring[i].x;\n          sumy += ring[i].y;\n          counter++;\n        }\n      }\n    }\n\n    return new Coordinate(sumx / counter, sumy / counter);\n  };\n\n  _proto._computeExtent = function _computeExtent() {\n    var shell = this._coordinates;\n\n    if (!isArrayHasData(shell)) {\n      return null;\n    }\n\n    var rings = [shell];\n\n    if (this.hasHoles && this.hasHoles()) {\n      rings.push.apply(rings, this.getHoles());\n    }\n\n    return this._coords2Extent(rings, this._getProjection());\n  };\n\n  _proto._computePrjExtent = function _computePrjExtent() {\n    var coords = [this._getPrjCoordinates()];\n\n    if (this.hasHoles && this.hasHoles()) {\n      coords.push.apply(coords, this._getPrjHoles());\n    }\n\n    return this._coords2Extent(coords);\n  };\n\n  _proto._get2DLength = function _get2DLength() {\n    var vertexes = this._getPath2DPoints(this._getPrjCoordinates(), true);\n\n    var len = 0;\n\n    for (var i = 1, l = vertexes.length; i < l; i++) {\n      len += vertexes[i].distanceTo(vertexes[i - 1]);\n    }\n\n    return len;\n  };\n\n  _proto._hitTestTolerance = function _hitTestTolerance() {\n    var symbol = this._getInternalSymbol();\n\n    var w;\n\n    if (Array.isArray(symbol)) {\n      w = 0;\n\n      for (var i = 0; i < symbol.length; i++) {\n        if (isNumber(symbol[i]['lineWidth'])) {\n          if (symbol[i]['lineWidth'] > w) {\n            w = symbol[i]['lineWidth'];\n          }\n        }\n      }\n    } else {\n      w = symbol['lineWidth'];\n    }\n\n    return isNumber(w) ? w / 2 : 1.5;\n  };\n\n  _proto._coords2Extent = function _coords2Extent(coords, proj) {\n    if (!coords || coords.length === 0 || Array.isArray(coords[0]) && coords[0].length === 0) {\n      return null;\n    }\n\n    var result = new Extent(proj);\n\n    for (var i = 0, l = coords.length; i < l; i++) {\n      for (var j = 0, ll = coords[i].length; j < ll; j++) {\n        result._combine(coords[i][j]);\n      }\n    }\n\n    return result;\n  };\n\n  return Path;\n}(Geometry);\n\nPath.mergeOptions(options$3);\n\nvar JSON_TYPE = 'Polygon';\n\nvar Polygon = function (_Path) {\n  _inheritsLoose(Polygon, _Path);\n\n  function Polygon(coordinates, opts) {\n    var _this;\n\n    _this = _Path.call(this, opts) || this;\n    _this.type = 'Polygon';\n\n    if (coordinates) {\n      _this.setCoordinates(coordinates);\n    }\n\n    return _this;\n  }\n\n  var _proto = Polygon.prototype;\n\n  _proto.getOutline = function getOutline() {\n    var painter = this._getPainter();\n\n    if (!painter) {\n      return null;\n    }\n\n    var extent = this.getExtent();\n    return new Polygon(extent.toArray(), {\n      symbol: {\n        'lineWidth': 1,\n        'lineColor': '6b707b'\n      }\n    });\n  };\n\n  _proto.setCoordinates = function setCoordinates(coordinates) {\n    if (!coordinates) {\n      this._coordinates = null;\n      this._holes = null;\n\n      this._projectRings();\n\n      return this;\n    }\n\n    var rings = Coordinate.toCoordinates(coordinates);\n    var len = rings.length;\n\n    if (!Array.isArray(rings[0])) {\n      this._coordinates = this._trimRing(rings);\n    } else {\n      this._coordinates = this._trimRing(rings[0]);\n\n      if (len > 1) {\n        var holes = [];\n\n        for (var i = 1; i < len; i++) {\n          if (!rings[i]) {\n            continue;\n          }\n\n          holes.push(this._trimRing(rings[i]));\n        }\n\n        this._holes = holes;\n      }\n    }\n\n    this._projectRings();\n\n    return this;\n  };\n\n  _proto.getCoordinates = function getCoordinates() {\n    if (!this._coordinates) {\n      return [];\n    }\n\n    var holes = this.getHoles();\n    var rings = [this._copyAndCloseRing(this._coordinates)];\n\n    for (var i = 0, l = holes.length; i < l; i++) {\n      rings.push(this._copyAndCloseRing(holes[i]));\n    }\n\n    return rings;\n  };\n\n  _proto.getCenterInExtent = function getCenterInExtent(extent) {\n    return this._getCenterInExtent(extent, this.getShell(), clipPolygon);\n  };\n\n  _proto.getShell = function getShell() {\n    return this._coordinates || [];\n  };\n\n  _proto.getHoles = function getHoles() {\n    return this._holes || [];\n  };\n\n  _proto.hasHoles = function hasHoles() {\n    return this.getHoles().length > 0;\n  };\n\n  _proto._projectRings = function _projectRings() {\n    if (!this.getMap()) {\n      this.onShapeChanged();\n      return;\n    }\n\n    this._prjCoords = this._projectCoords(this._coordinates);\n    this._prjHoles = this._projectCoords(this._holes);\n    this.onShapeChanged();\n  };\n\n  _proto._setPrjCoordinates = function _setPrjCoordinates(prjCoords) {\n    this._prjCoords = prjCoords;\n    this.onShapeChanged();\n  };\n\n  _proto._cleanRing = function _cleanRing(ring) {\n    for (var i = ring.length - 1; i >= 0; i--) {\n      if (!ring[i]) {\n        ring.splice(i, 1);\n      }\n    }\n  };\n\n  _proto._checkRing = function _checkRing(ring) {\n    this._cleanRing(ring);\n\n    if (!ring || !isArrayHasData(ring)) {\n      return false;\n    }\n\n    var lastPoint = ring[ring.length - 1];\n    var isClose = true;\n\n    if (ring[0].x !== lastPoint.x || ring[0].y !== lastPoint.y) {\n      isClose = false;\n    }\n\n    return isClose;\n  };\n\n  _proto._trimRing = function _trimRing(ring) {\n    var isClose = this._checkRing(ring);\n\n    if (isArrayHasData(ring) && isClose) {\n      ring.splice(ring.length - 1, 1);\n    }\n\n    return ring;\n  };\n\n  _proto._copyAndCloseRing = function _copyAndCloseRing(ring) {\n    ring = ring.slice(0);\n\n    var isClose = this._checkRing(ring);\n\n    if (isArrayHasData(ring) && !isClose) {\n      ring.push(ring[0].copy());\n      return ring;\n    } else {\n      return ring;\n    }\n  };\n\n  _proto._getPrjShell = function _getPrjShell() {\n    if (this.getJSONType() === JSON_TYPE) {\n      return this._getPrjCoordinates();\n    }\n\n    this._verifyProjection();\n\n    if (this._getProjection() && !this._prjShell) {\n      this._prjShell = this._projectCoords(this.getShell());\n    }\n\n    return this._prjShell;\n  };\n\n  _proto._getPrjHoles = function _getPrjHoles() {\n    var projection = this._getProjection();\n\n    this._verifyProjection();\n\n    if (projection && !this._prjHoles) {\n      this._prjHoles = this._projectCoords(this.getHoles());\n    }\n\n    return this._prjHoles;\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength(measurer) {\n    var rings = this.getCoordinates();\n\n    if (!isArrayHasData(rings)) {\n      return 0;\n    }\n\n    var result = 0;\n\n    for (var i = 0, len = rings.length; i < len; i++) {\n      result += measurer.measureLength(rings[i]);\n    }\n\n    return result;\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea(measurer) {\n    var rings = this.getCoordinates();\n\n    if (!isArrayHasData(rings)) {\n      return 0;\n    }\n\n    var result = measurer.measureArea(rings[0]);\n\n    for (var i = 1, len = rings.length; i < len; i++) {\n      result -= measurer.measureArea(rings[i]);\n    }\n\n    return result;\n  };\n\n  _proto._updateCache = function _updateCache() {\n    _Path.prototype._updateCache.call(this);\n\n    if (this._prjHoles) {\n      this._holes = this._unprojectCoords(this._getPrjHoles());\n    }\n  };\n\n  _proto._clearCache = function _clearCache() {\n    delete this._prjShell;\n    return _Path.prototype._clearCache.call(this);\n  };\n\n  _proto._clearProjection = function _clearProjection() {\n    if (this._prjHoles) {\n      this._prjHoles = null;\n    }\n\n    if (this._prjShell) {\n      this._prjShell = null;\n    }\n\n    _Path.prototype._clearProjection.call(this);\n  };\n\n  return Polygon;\n}(Path);\n\nPolygon.registerJSONType(JSON_TYPE);\n\nfunction CenterMixin (Base) {\n  return function (_Base) {\n    _inheritsLoose(_class, _Base);\n\n    function _class() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    var _proto = _class.prototype;\n\n    _proto.getCoordinates = function getCoordinates() {\n      return this._coordinates;\n    };\n\n    _proto.setCoordinates = function setCoordinates(coordinates) {\n      var center = coordinates instanceof Coordinate ? coordinates : new Coordinate(coordinates);\n\n      if (center.equals(this._coordinates)) {\n        return this;\n      }\n\n      this._coordinates = center;\n\n      if (!this.getMap()) {\n        this._dirtyCoords = true;\n        this.onPositionChanged();\n        return this;\n      }\n\n      var projection = this._getProjection();\n\n      this._setPrjCoordinates(projection.project(this._coordinates));\n\n      return this;\n    };\n\n    _proto._getCenter2DPoint = function _getCenter2DPoint(res) {\n      var map = this.getMap();\n\n      if (!map) {\n        return null;\n      }\n\n      var pcenter = this._getPrjCoordinates();\n\n      if (!pcenter) {\n        return null;\n      }\n\n      if (!res) {\n        res = map._getResolution();\n      }\n\n      return map._prjToPointAtRes(pcenter, res);\n    };\n\n    _proto._getPrjCoordinates = function _getPrjCoordinates() {\n      var projection = this._getProjection();\n\n      this._verifyProjection();\n\n      if (!this._pcenter && projection) {\n        if (this._coordinates) {\n          this._pcenter = projection.project(this._coordinates);\n        }\n      }\n\n      return this._pcenter;\n    };\n\n    _proto._setPrjCoordinates = function _setPrjCoordinates(pcenter) {\n      this._pcenter = pcenter;\n      this.onPositionChanged();\n    };\n\n    _proto._updateCache = function _updateCache() {\n      this._clearCache();\n\n      var projection = this._getProjection();\n\n      if (this._pcenter && projection) {\n        this._coordinates = projection.unproject(this._pcenter);\n      }\n    };\n\n    _proto._clearProjection = function _clearProjection() {\n      this._pcenter = null;\n\n      _Base.prototype._clearProjection.call(this);\n    };\n\n    _proto._computeCenter = function _computeCenter() {\n      return this._coordinates ? this._coordinates.copy() : null;\n    };\n\n    return _class;\n  }(Base);\n}\n\nvar TEMP_EXTENT$3 = new PointExtent();\nvar options$4 = {\n  'symbol': {\n    'markerType': 'path',\n    'markerPath': [{\n      'path': 'M8 23l0 0 0 0 0 0 0 0 0 0c-4,-5 -8,-10 -8,-14 0,-5 4,-9 8,-9l0 0 0 0c4,0 8,4 8,9 0,4 -4,9 -8,14z M3,9 a5,5 0,1,0,0,-0.9Z',\n      'fill': '#DE3333'\n    }],\n    'markerPathWidth': 16,\n    'markerPathHeight': 23,\n    'markerWidth': 24,\n    'markerHeight': 34\n  },\n  'hitTestForEvent': false\n};\n\nvar Marker = function (_CenterMixin) {\n  _inheritsLoose(Marker, _CenterMixin);\n\n  function Marker(coordinates, opts) {\n    var _this;\n\n    _this = _CenterMixin.call(this, opts) || this;\n    _this.type = 'Point';\n\n    if (coordinates) {\n      _this.setCoordinates(coordinates);\n    }\n\n    return _this;\n  }\n\n  var _proto = Marker.prototype;\n\n  _proto.getOutline = function getOutline() {\n    var coord = this.getCoordinates();\n    var extent = this.getContainerExtent();\n    var anchor = this.getMap().coordToContainerPoint(coord);\n    return new Marker(coord, {\n      'symbol': {\n        'markerType': 'square',\n        'markerWidth': extent.getWidth(),\n        'markerHeight': extent.getHeight(),\n        'markerLineWidth': 1,\n        'markerLineColor': '6b707b',\n        'markerFill': 'rgba(0, 0, 0, 0)',\n        'markerDx': extent.xmin - (anchor.x - extent.getWidth() / 2),\n        'markerDy': extent.ymin - (anchor.y - extent.getHeight() / 2)\n      }\n    });\n  };\n\n  _proto.setSymbol = function setSymbol() {\n    var _CenterMixin$prototyp;\n\n    delete this._fixedExtent;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return (_CenterMixin$prototyp = _CenterMixin.prototype.setSymbol).call.apply(_CenterMixin$prototyp, [this].concat(args));\n  };\n\n  _proto._getSizeSymbol = function _getSizeSymbol(symbol) {\n    var s = {};\n    var dynamic = false;\n    var dynamicSize = false;\n\n    for (var i = 0; i < DYNAMIC_SYMBOL_PROPS.length; i++) {\n      var v = symbol[DYNAMIC_SYMBOL_PROPS[i]];\n\n      if (isNil(v)) {\n        continue;\n      }\n\n      if (!dynamic && isFunctionDefinition(v)) {\n        dynamic = true;\n        dynamicSize = true;\n      }\n\n      s[DYNAMIC_SYMBOL_PROPS[i]] = v;\n    }\n\n    for (var _i = 0; _i < SIZE_SYMBOL_PROPS.length; _i++) {\n      var _v = symbol[SIZE_SYMBOL_PROPS[_i]];\n\n      if (isNil(_v)) {\n        continue;\n      }\n\n      if (!dynamic && isFunctionDefinition(_v)) {\n        dynamic = true;\n      }\n\n      s[SIZE_SYMBOL_PROPS[_i]] = _v;\n    }\n\n    var sizeSymbol;\n\n    if (dynamic) {\n      sizeSymbol = loadGeoSymbol(s, this);\n\n      if (dynamicSize) {\n        sizeSymbol._dynamic = true;\n      }\n    } else {\n      sizeSymbol = s;\n    }\n\n    return sizeSymbol;\n  };\n\n  _proto._setExternSymbol = function _setExternSymbol(symbol) {\n    if (!this._symbol) {\n      delete this._fixedExtent;\n    }\n\n    return _CenterMixin.prototype._setExternSymbol.call(this, symbol);\n  };\n\n  _proto._isDynamicSize = function _isDynamicSize() {\n    return this._sizeSymbol && this._sizeSymbol._dynamic;\n  };\n\n  _proto._getFixedExtent = function _getFixedExtent() {\n    if (this._fixedExtent && !this._isDynamicSize()) {\n      return this._fixedExtent;\n    }\n\n    this._fixedExtent = this._fixedExtent || new PointExtent();\n\n    this._fixedExtent.set(null, null, null, null);\n\n    var symbol = this._sizeSymbol;\n\n    if (!symbol) {\n      return this._fixedExtent;\n    }\n\n    var renderer = this.getLayer() && this.getLayer().getRenderer();\n    var resources = renderer && renderer.resources;\n    var textDesc = this.getTextDesc();\n\n    if (Array.isArray(symbol)) {\n      TEMP_EXTENT$3.set(0, 0, 0, 0);\n\n      for (var i = 0; i < symbol.length; i++) {\n        if (!symbol[i]) {\n          continue;\n        }\n\n        this._fixedExtent._combine(getMarkerFixedExtent(TEMP_EXTENT$3, symbol[i], resources, textDesc && textDesc[i]));\n      }\n    } else {\n      this._fixedExtent = getMarkerFixedExtent(this._fixedExtent, symbol, resources, textDesc);\n    }\n\n    return this._fixedExtent;\n  };\n\n  _proto._isVectorMarker = function _isVectorMarker() {\n    var symbol = this._getInternalSymbol();\n\n    if (Array.isArray(symbol)) {\n      return false;\n    }\n\n    return isVectorSymbol(symbol);\n  };\n\n  _proto._canEdit = function _canEdit() {\n    var symbol = this._getInternalSymbol();\n\n    if (Array.isArray(symbol)) {\n      return false;\n    }\n\n    return isVectorSymbol(symbol) || isPathSymbol(symbol) || isImageSymbol(symbol);\n  };\n\n  _proto._containsPoint = function _containsPoint(point, t) {\n    var extent = this.getContainerExtent();\n\n    if (t) {\n      extent = extent.expand(t);\n    }\n\n    if (extent.contains(point)) {\n      if (this.options['hitTestForEvent']) {\n        return _CenterMixin.prototype._containsPoint.call(this, point, t);\n      } else {\n        return true;\n      }\n    } else {\n      return false;\n    }\n  };\n\n  _proto._computeExtent = function _computeExtent() {\n    return computeExtent.call(this, 'getCenter');\n  };\n\n  _proto._computePrjExtent = function _computePrjExtent() {\n    return computeExtent.call(this, '_getPrjCoordinates');\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength() {\n    return 0;\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea() {\n    return 0;\n  };\n\n  _proto._getSprite = function _getSprite(resources, canvasClass) {\n    if (this._getPainter()) {\n      return this._getPainter().getSprite(resources, canvasClass);\n    }\n\n    return new Painter(this).getSprite(resources, canvasClass);\n  };\n\n  return Marker;\n}(CenterMixin(Geometry));\n\nMarker.mergeOptions(options$4);\nMarker.registerJSONType('Marker');\n\nfunction computeExtent(fn) {\n  var coordinates = this[fn]();\n\n  if (!coordinates) {\n    return null;\n  }\n\n  return new Extent(coordinates, coordinates, this._getProjection());\n}\n\nvar options$5 = {\n  'arrowStyle': null,\n  'arrowPlacement': 'vertex-last'\n};\n\nvar LineString = function (_Path) {\n  _inheritsLoose(LineString, _Path);\n\n  function LineString(coordinates, options) {\n    var _this;\n\n    _this = _Path.call(this, options) || this;\n    _this.type = 'LineString';\n\n    if (coordinates) {\n      _this.setCoordinates(coordinates);\n    }\n\n    return _this;\n  }\n\n  var _proto = LineString.prototype;\n\n  _proto.getOutline = function getOutline() {\n    return Polygon.prototype.getOutline.call(this);\n  };\n\n  _proto.setCoordinates = function setCoordinates(coordinates) {\n    if (!coordinates) {\n      this._coordinates = null;\n\n      this._setPrjCoordinates(null);\n\n      return this;\n    }\n\n    this._coordinates = Coordinate.toCoordinates(coordinates);\n\n    if (this.getMap()) {\n      this._setPrjCoordinates(this._projectCoords(this._coordinates));\n    } else {\n      this.onShapeChanged();\n    }\n\n    return this;\n  };\n\n  _proto.getCoordinates = function getCoordinates() {\n    return this._coordinates || [];\n  };\n\n  _proto.getCenterInExtent = function getCenterInExtent(extent) {\n    return this._getCenterInExtent(extent, this.getCoordinates(), clipLine);\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength(measurer) {\n    return measurer.measureLength(this.getCoordinates());\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea() {\n    return 0;\n  };\n\n  return LineString;\n}(Path);\n\nLineString.mergeOptions(options$5);\nLineString.registerJSONType('LineString');\n\nvar TEMP_EXTENT$4 = new PointExtent();\n\nvar GeometryCollection = function (_Geometry) {\n  _inheritsLoose(GeometryCollection, _Geometry);\n\n  function GeometryCollection(geometries, opts) {\n    var _this;\n\n    _this = _Geometry.call(this, opts) || this;\n    _this.type = 'GeometryCollection';\n\n    _this.setGeometries(geometries);\n\n    return _this;\n  }\n\n  var _proto = GeometryCollection.prototype;\n\n  _proto.getContainerExtent = function getContainerExtent(out) {\n    var extent = out || new PointExtent();\n    this.forEach(function (geo) {\n      extent._combine(geo.getContainerExtent(TEMP_EXTENT$4));\n    });\n    return extent;\n  };\n\n  _proto.setGeometries = function setGeometries(_geometries) {\n    var geometries = this._checkGeometries(_geometries || []);\n\n    var symbol = this._getSymbol();\n\n    var options = this.config();\n\n    for (var i = geometries.length - 1; i >= 0; i--) {\n      geometries[i]._initOptions(options);\n\n      geometries[i]._setParent(this);\n\n      geometries[i]._setEventParent(this);\n\n      if (symbol) {\n        geometries[i].setSymbol(symbol);\n      }\n    }\n\n    this._geometries = geometries;\n\n    if (this.getLayer()) {\n      this._bindGeometriesToLayer();\n\n      this.onShapeChanged();\n    }\n\n    return this;\n  };\n\n  _proto.getGeometries = function getGeometries() {\n    return this._geometries || [];\n  };\n\n  _proto.forEach = function forEach(fn, context) {\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (!geometries[i]) {\n        continue;\n      }\n\n      if (!context) {\n        fn(geometries[i], i);\n      } else {\n        fn.call(context, geometries[i], i);\n      }\n    }\n\n    return this;\n  };\n\n  _proto.filter = function filter(fn, context) {\n    if (!fn) {\n      return new GeometryCollection();\n    }\n\n    var selected = [];\n    var isFn = isFunction(fn);\n    var filter = isFn ? fn : createFilter(fn);\n    this.forEach(function (geometry) {\n      var g = isFn ? geometry : getFilterFeature(geometry);\n\n      if (context ? filter.call(context, g) : filter(g)) {\n        selected.push(geometry);\n      }\n    }, this);\n    return new GeometryCollection(selected);\n  };\n\n  _proto.translate = function translate(offset) {\n    if (!offset) {\n      return this;\n    }\n\n    if (this.isEmpty()) {\n      return this;\n    }\n\n    var args = arguments;\n    this.forEach(function (geometry) {\n      if (geometry && geometry.translate) {\n        geometry.translate.apply(geometry, args);\n      }\n    });\n    return this;\n  };\n\n  _proto.isEmpty = function isEmpty$$1() {\n    return !isArrayHasData(this.getGeometries());\n  };\n\n  _proto.remove = function remove() {\n    this.forEach(function (geometry) {\n      geometry._unbind();\n    });\n    return Geometry.prototype.remove.apply(this, arguments);\n  };\n\n  _proto.show = function show() {\n    this.options['visible'] = true;\n    this.forEach(function (geometry) {\n      geometry.show();\n    });\n    return this;\n  };\n\n  _proto.hide = function hide() {\n    this.options['visible'] = false;\n    this.forEach(function (geometry) {\n      geometry.hide();\n    });\n    return this;\n  };\n\n  _proto.onConfig = function onConfig(config) {\n    this.forEach(function (geometry) {\n      geometry.config(config);\n    });\n  };\n\n  _proto.getSymbol = function getSymbol() {\n    var s = _Geometry.prototype.getSymbol.call(this);\n\n    if (!s) {\n      var symbols = [];\n      var is = false;\n      this.forEach(function (g) {\n        var symbol = g.getSymbol();\n\n        if (symbol && !is) {\n          is = true;\n        }\n\n        symbols.push(g.getSymbol());\n      });\n\n      if (is) {\n        s = {\n          'children': symbols\n        };\n      }\n    }\n\n    return s;\n  };\n\n  _proto.setSymbol = function setSymbol(s) {\n    if (s && s['children']) {\n      this._symbol = null;\n      this.forEach(function (g, i) {\n        g.setSymbol(s['children'][i]);\n      });\n    } else {\n      var symbol = this._prepareSymbol(s);\n\n      this._symbol = symbol;\n      this.forEach(function (g) {\n        g.setSymbol(symbol);\n      });\n    }\n\n    this.onSymbolChanged();\n    return this;\n  };\n\n  _proto._setExternSymbol = function _setExternSymbol(symbol) {\n    symbol = this._prepareSymbol(symbol);\n    this._externSymbol = symbol;\n    this.forEach(function (geometry) {\n      geometry._setExternSymbol(symbol);\n    });\n    this.onSymbolChanged();\n    return this;\n  };\n\n  _proto._bindLayer = function _bindLayer() {\n    _Geometry.prototype._bindLayer.apply(this, arguments);\n\n    this._bindGeometriesToLayer();\n  };\n\n  _proto._bindGeometriesToLayer = function _bindGeometriesToLayer() {\n    var layer = this.getLayer();\n    this.forEach(function (geometry) {\n      geometry._bindLayer(layer);\n    });\n  };\n\n  _proto._checkGeometries = function _checkGeometries(geometries) {\n    var invalidGeoError = 'The geometry added to collection is invalid.';\n\n    if (geometries && !Array.isArray(geometries)) {\n      if (geometries instanceof Geometry) {\n        return [geometries];\n      } else {\n        throw new Error(invalidGeoError);\n      }\n    } else {\n      for (var i = 0, l = geometries.length; i < l; i++) {\n        if (!this._checkGeo(geometries[i])) {\n          throw new Error(invalidGeoError + ' Index: ' + i);\n        }\n      }\n\n      return geometries;\n    }\n  };\n\n  _proto._checkGeo = function _checkGeo(geo) {\n    return geo instanceof Geometry;\n  };\n\n  _proto._updateCache = function _updateCache() {\n    this._clearCache();\n\n    if (this.isEmpty()) {\n      return;\n    }\n\n    this.forEach(function (geometry) {\n      if (geometry && geometry._updateCache) {\n        geometry._updateCache();\n      }\n    });\n  };\n\n  _proto._removePainter = function _removePainter() {\n    if (this._painter) {\n      this._painter.remove();\n    }\n\n    delete this._painter;\n    this.forEach(function (geometry) {\n      geometry._removePainter();\n    });\n  };\n\n  _proto._computeCenter = function _computeCenter(projection) {\n    if (!projection || this.isEmpty()) {\n      return null;\n    }\n\n    var sumX = 0,\n        sumY = 0,\n        counter = 0;\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (!geometries[i]) {\n        continue;\n      }\n\n      var center = geometries[i]._computeCenter(projection);\n\n      if (center) {\n        sumX += center.x;\n        sumY += center.y;\n        counter++;\n      }\n    }\n\n    if (counter === 0) {\n      return null;\n    }\n\n    return new Coordinate(sumX / counter, sumY / counter);\n  };\n\n  _proto._containsPoint = function _containsPoint(point, t) {\n    if (this.isEmpty()) {\n      return false;\n    }\n\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (geometries[i]._containsPoint(point, t)) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  _proto._computeExtent = function _computeExtent(projection) {\n    return computeExtent$1.call(this, projection, '_computeExtent');\n  };\n\n  _proto._computePrjExtent = function _computePrjExtent(projection) {\n    return computeExtent$1.call(this, projection, '_computePrjExtent');\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength(projection) {\n    if (!projection || this.isEmpty()) {\n      return 0;\n    }\n\n    var geometries = this.getGeometries();\n    var result = 0;\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (!geometries[i]) {\n        continue;\n      }\n\n      result += geometries[i]._computeGeodesicLength(projection);\n    }\n\n    return result;\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea(projection) {\n    if (!projection || this.isEmpty()) {\n      return 0;\n    }\n\n    var geometries = this.getGeometries();\n    var result = 0;\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (!geometries[i]) {\n        continue;\n      }\n\n      result += geometries[i]._computeGeodesicArea(projection);\n    }\n\n    return result;\n  };\n\n  _proto._exportGeoJSONGeometry = function _exportGeoJSONGeometry() {\n    var children = [];\n\n    if (!this.isEmpty()) {\n      var geometries = this.getGeometries();\n\n      for (var i = 0, l = geometries.length; i < l; i++) {\n        if (!geometries[i]) {\n          continue;\n        }\n\n        children.push(geometries[i]._exportGeoJSONGeometry());\n      }\n    }\n\n    return {\n      'type': 'GeometryCollection',\n      'geometries': children\n    };\n  };\n\n  _proto._clearProjection = function _clearProjection() {\n    if (this.isEmpty()) {\n      return;\n    }\n\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (!geometries[i]) {\n        continue;\n      }\n\n      geometries[i]._clearProjection();\n    }\n  };\n\n  _proto._getConnectPoints = function _getConnectPoints() {\n    var extent = this.getExtent();\n    var anchors = [new Coordinate(extent.xmin, extent.ymax), new Coordinate(extent.xmax, extent.ymin), new Coordinate(extent.xmin, extent.ymin), new Coordinate(extent.xmax, extent.ymax)];\n    return anchors;\n  };\n\n  _proto._getExternalResources = function _getExternalResources() {\n    if (this.isEmpty()) {\n      return [];\n    }\n\n    var geometries = this.getGeometries(),\n        resources = [];\n    var cache = {};\n    var symbol, res, key;\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (!geometries[i]) {\n        continue;\n      }\n\n      symbol = geometries[i]._getInternalSymbol();\n      res = getExternalResources(symbol);\n\n      for (var ii = 0, ll = res.length; ii < ll; ii++) {\n        key = res[ii].join();\n\n        if (!cache[key]) {\n          resources.push(res[ii]);\n          cache[key] = 1;\n        }\n      }\n    }\n\n    return resources;\n  };\n\n  _proto.startEdit = function startEdit(opts) {\n    var _this2 = this;\n\n    if (this.isEmpty()) {\n      return this;\n    }\n\n    if (!opts) {\n      opts = {};\n    }\n\n    if (opts['symbol']) {\n      this._originalSymbol = this.getSymbol();\n      this.setSymbol(opts['symbol']);\n    }\n\n    this._draggbleBeforeEdit = this.options['draggable'];\n    this.config('draggable', false);\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      geometries[i].startEdit(opts);\n    }\n\n    this._editing = true;\n    this.hide();\n    setTimeout(function () {\n      _this2.fire('editstart');\n    }, 1);\n    return this;\n  };\n\n  _proto.endEdit = function endEdit() {\n    if (this.isEmpty()) {\n      return this;\n    }\n\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      geometries[i].endEdit();\n    }\n\n    if (this._originalSymbol) {\n      this.setSymbol(this._originalSymbol);\n      delete this._originalSymbol;\n    }\n\n    this._editing = false;\n    this.show();\n    this.config('draggable', this._draggbleBeforeEdit);\n    this.fire('editend');\n    return this;\n  };\n\n  _proto.isEditing = function isEditing() {\n    if (!this._editing) {\n      return false;\n    }\n\n    return true;\n  };\n\n  return GeometryCollection;\n}(Geometry);\n\nGeometryCollection.registerJSONType('GeometryCollection');\n\nfunction computeExtent$1(projection, fn) {\n  if (this.isEmpty()) {\n    return null;\n  }\n\n  var extent = new Extent();\n  var geometries = this.getGeometries();\n\n  for (var i = 0, l = geometries.length; i < l; i++) {\n    if (!geometries[i]) {\n      continue;\n    }\n\n    var e = geometries[i][fn](projection);\n\n    if (e) {\n      extent._combine(e);\n    }\n  }\n\n  return extent;\n}\n\nvar MultiGeometry = function (_GeometryCollection) {\n  _inheritsLoose(MultiGeometry, _GeometryCollection);\n\n  function MultiGeometry(geoType, type, data, options) {\n    var _this;\n\n    _this = _GeometryCollection.call(this, null, options) || this;\n    _this.GeometryType = geoType;\n    _this.type = type;\n\n    _this._initData(data);\n\n    return _this;\n  }\n\n  var _proto = MultiGeometry.prototype;\n\n  _proto.getCoordinates = function getCoordinates() {\n    var coordinates = [];\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      var child = geometries[i];\n      coordinates.push(child.getShell && child.getJSONType() !== 'Polygon' ? [child.getShell()] : child.getCoordinates());\n    }\n\n    return coordinates;\n  };\n\n  _proto.setCoordinates = function setCoordinates(coordinates) {\n    coordinates = coordinates || [];\n    var geometries = [];\n\n    for (var i = 0, l = coordinates.length; i < l; i++) {\n      var g = new this.GeometryType(coordinates[i], this.config());\n      geometries.push(g);\n    }\n\n    this.setGeometries(geometries);\n    return this;\n  };\n\n  _proto._initData = function _initData(data) {\n    data = data || [];\n\n    if (data.length) {\n      if (data[0] instanceof this.GeometryType) {\n        this.setGeometries(data);\n      } else {\n        this.setCoordinates(data);\n      }\n    }\n  };\n\n  _proto._checkGeo = function _checkGeo(geo) {\n    return geo instanceof this.GeometryType;\n  };\n\n  _proto._exportGeoJSONGeometry = function _exportGeoJSONGeometry() {\n    var points = this.getCoordinates();\n    var coordinates = Coordinate.toNumberArrays(points);\n    return {\n      'type': this.getType(),\n      'coordinates': coordinates\n    };\n  };\n\n  return MultiGeometry;\n}(GeometryCollection);\n\nvar MultiPoint = function (_MultiGeometry) {\n  _inheritsLoose(MultiPoint, _MultiGeometry);\n\n  function MultiPoint(data, opts) {\n    return _MultiGeometry.call(this, Marker, 'MultiPoint', data, opts) || this;\n  }\n\n  var _proto = MultiPoint.prototype;\n\n  _proto.findClosest = function findClosest(coordinate) {\n    if (!coordinate) {\n      return null;\n    }\n\n    var coords = this.getCoordinates();\n    var hit = null;\n    var max = Infinity;\n    coords.forEach(function (c) {\n      var dist = distanceTo(c, coordinate);\n\n      if (dist < max) {\n        hit = c;\n        max = dist;\n      }\n    });\n    return hit;\n  };\n\n  return MultiPoint;\n}(MultiGeometry);\n\nMultiPoint.registerJSONType('MultiPoint');\n\nfunction distanceTo(p0, p1) {\n  var x = p1.x - p0.x,\n      y = p1.y - p0.y;\n  return Math.sqrt(x * x + y * y);\n}\n\nvar MultiPath = function (_MultiGeometry) {\n  _inheritsLoose(MultiPath, _MultiGeometry);\n\n  function MultiPath() {\n    return _MultiGeometry.apply(this, arguments) || this;\n  }\n\n  var _proto = MultiPath.prototype;\n\n  _proto.getCenterInExtent = function getCenterInExtent(extent) {\n    var children = this.getGeometries();\n    var sumx = 0,\n        sumy = 0,\n        counter = 0;\n    children.forEach(function (l) {\n      var c = l.getCenterInExtent(extent);\n\n      if (c) {\n        sumx += c.x * c.count;\n        sumy += c.y * c.count;\n        counter += c.count;\n      }\n    });\n\n    if (counter === 0) {\n      return null;\n    }\n\n    return new Coordinate(sumx, sumy)._multi(1 / counter);\n  };\n\n  return MultiPath;\n}(MultiGeometry);\n\nvar MultiLineString = function (_MultiPath) {\n  _inheritsLoose(MultiLineString, _MultiPath);\n\n  function MultiLineString(data, options) {\n    return _MultiPath.call(this, LineString, 'MultiLineString', data, options) || this;\n  }\n\n  return MultiLineString;\n}(MultiPath);\n\nMultiLineString.registerJSONType('MultiLineString');\n\nvar MultiPolygon = function (_MultiPath) {\n  _inheritsLoose(MultiPolygon, _MultiPath);\n\n  function MultiPolygon(data, opts) {\n    return _MultiPath.call(this, Polygon, 'MultiPolygon', data, opts) || this;\n  }\n\n  return MultiPolygon;\n}(MultiPath);\n\nMultiPolygon.registerJSONType('MultiPolygon');\n\nvar types$1 = {\n  'Marker': Marker,\n  'LineString': LineString,\n  'Polygon': Polygon,\n  'MultiPoint': MultiPoint,\n  'MultiLineString': MultiLineString,\n  'MultiPolygon': MultiPolygon\n};\nvar GeoJSON = {\n  toGeometry: function toGeometry(geoJSON, foreachFn) {\n    if (isString(geoJSON)) {\n      geoJSON = parseJSON(geoJSON);\n    }\n\n    if (Array.isArray(geoJSON)) {\n      var resultGeos = [];\n\n      for (var i = 0, len = geoJSON.length; i < len; i++) {\n        var geo = GeoJSON._convert(geoJSON[i], foreachFn);\n\n        if (Array.isArray(geo)) {\n          pushIn(resultGeos, geo);\n        } else {\n          resultGeos.push(geo);\n        }\n      }\n\n      return resultGeos;\n    } else {\n      var resultGeo = GeoJSON._convert(geoJSON, foreachFn);\n\n      return resultGeo;\n    }\n  },\n  _convert: function _convert(json, foreachFn) {\n    if (!json || isNil(json['type'])) {\n      return null;\n    }\n\n    var type = json['type'];\n\n    if (type === 'Feature') {\n      var g = json['geometry'];\n\n      var geometry = GeoJSON._convert(g);\n\n      if (!geometry) {\n        return null;\n      }\n\n      geometry.setId(json['id']);\n      geometry.setProperties(json['properties']);\n\n      if (foreachFn) {\n        foreachFn(geometry);\n      }\n\n      return geometry;\n    } else if (type === 'FeatureCollection') {\n      var features = json['features'];\n\n      if (!features) {\n        return null;\n      }\n\n      return GeoJSON.toGeometry(features, foreachFn);\n    } else if (['Point', 'LineString', 'Polygon', 'MultiPoint', 'MultiLineString', 'MultiPolygon'].indexOf(type) >= 0) {\n      var clazz = type === 'Point' ? 'Marker' : type;\n      var result = new types$1[clazz](json['coordinates']);\n\n      if (foreachFn) {\n        foreachFn(result);\n      }\n\n      return result;\n    } else if (type === 'GeometryCollection') {\n      var geometries = json['geometries'];\n\n      if (!isArrayHasData(geometries)) {\n        var _result2 = new GeometryCollection();\n\n        if (foreachFn) {\n          foreachFn(_result2);\n        }\n\n        return _result2;\n      }\n\n      var mGeos = [];\n      var size = geometries.length;\n\n      for (var i = 0; i < size; i++) {\n        mGeos.push(GeoJSON._convert(geometries[i]));\n      }\n\n      var _result = new GeometryCollection(mGeos);\n\n      if (foreachFn) {\n        foreachFn(_result);\n      }\n\n      return _result;\n    }\n\n    return null;\n  }\n};\n\nvar options$6 = {\n  'numberOfShellPoints': 60\n};\n\nvar Circle = function (_CenterMixin) {\n  _inheritsLoose(Circle, _CenterMixin);\n\n  Circle.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var circle = new Circle(json['coordinates'], json['radius'], json['options']);\n    circle.setProperties(feature['properties']);\n    return circle;\n  };\n\n  function Circle(coordinates, radius, opts) {\n    var _this;\n\n    _this = _CenterMixin.call(this, null, opts) || this;\n\n    if (coordinates) {\n      _this.setCoordinates(coordinates);\n    }\n\n    _this._radius = radius;\n    return _this;\n  }\n\n  var _proto = Circle.prototype;\n\n  _proto.getRadius = function getRadius() {\n    return this._radius;\n  };\n\n  _proto.setRadius = function setRadius(radius) {\n    this._radius = radius;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getShell = function getShell() {\n    var measurer = this._getMeasurer(),\n        center = this.getCoordinates(),\n        numberOfPoints = this.options['numberOfShellPoints'],\n        radius = this.getRadius();\n\n    var shell = [];\n    var rad, dx, dy;\n\n    for (var i = 0, len = numberOfPoints - 1; i < len; i++) {\n      rad = 360 * i / len * Math.PI / 180;\n      dx = radius * Math.cos(rad);\n      dy = radius * Math.sin(rad);\n      var vertex = measurer.locate(center, dx, dy);\n      shell.push(vertex);\n    }\n\n    shell.push(shell[0]);\n    return shell;\n  };\n\n  _proto.getHoles = function getHoles() {\n    return [];\n  };\n\n  _proto.animateShow = function animateShow() {\n    return this.show();\n  };\n\n  _proto._containsPoint = function _containsPoint(point, tolerance) {\n    var map = this.getMap();\n\n    if (map.getPitch()) {\n      return _CenterMixin.prototype._containsPoint.call(this, point, tolerance);\n    }\n\n    var center = map._pointToContainerPoint(this._getCenter2DPoint()),\n        size = this.getSize(),\n        t = isNil(tolerance) ? this._hitTestTolerance() : tolerance,\n        se = center.add(size.width / 2, size.height / 2);\n\n    return withInEllipse(point, center, se, t);\n  };\n\n  _proto._computePrjExtent = function _computePrjExtent(projection) {\n    var minmax = this._getMinMax(projection);\n\n    if (!minmax) {\n      return null;\n    }\n\n    var pcenter = this._getPrjCoordinates();\n\n    var pminmax = minmax.map(function (c) {\n      return projection.project(c);\n    });\n    var leftx = pminmax[0].x - pcenter.x;\n    var rightx = pminmax[1].x - pcenter.x;\n    var topy = pminmax[2].y - pcenter.y;\n    var bottomy = pminmax[3].y - pcenter.y;\n    return new Extent(pcenter.add(leftx, topy), pcenter.add(rightx, bottomy));\n  };\n\n  _proto._computeExtent = function _computeExtent(measurer) {\n    var minmax = this._getMinMax(measurer);\n\n    if (!minmax) {\n      return null;\n    }\n\n    return new Extent(minmax[0].x, minmax[2].y, minmax[1].x, minmax[3].y, this._getProjection());\n  };\n\n  _proto._getMinMax = function _getMinMax(measurer) {\n    if (!measurer || !this._coordinates || isNil(this._radius)) {\n      return null;\n    }\n\n    var radius = this._radius;\n    var p1 = measurer.locate(this._coordinates, -radius, 0),\n        p2 = measurer.locate(this._coordinates, radius, 0),\n        p3 = measurer.locate(this._coordinates, 0, radius),\n        p4 = measurer.locate(this._coordinates, 0, -radius);\n    return [p1, p2, p3, p4];\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength() {\n    if (isNil(this._radius)) {\n      return 0;\n    }\n\n    return Math.PI * 2 * this._radius;\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea() {\n    if (isNil(this._radius)) {\n      return 0;\n    }\n\n    return Math.PI * Math.pow(this._radius, 2);\n  };\n\n  _proto._exportGeoJSONGeometry = function _exportGeoJSONGeometry() {\n    var coordinates = Coordinate.toNumberArrays([this.getShell()]);\n    return {\n      'type': 'Polygon',\n      'coordinates': coordinates\n    };\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    var center = this.getCenter();\n    var opts = extend({}, options);\n    opts.geometry = false;\n    var feature = this.toGeoJSON(opts);\n    feature['geometry'] = {\n      'type': 'Polygon'\n    };\n    return {\n      'feature': feature,\n      'subType': 'Circle',\n      'coordinates': [center.x, center.y],\n      'radius': this.getRadius()\n    };\n  };\n\n  return Circle;\n}(CenterMixin(Polygon));\n\nCircle.mergeOptions(options$6);\nCircle.registerJSONType('Circle');\n\nvar options$7 = {\n  'numberOfShellPoints': 80\n};\n\nvar Ellipse = function (_CenterMixin) {\n  _inheritsLoose(Ellipse, _CenterMixin);\n\n  Ellipse.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var ellipse = new Ellipse(json['coordinates'], json['width'], json['height'], json['options']);\n    ellipse.setProperties(feature['properties']);\n    return ellipse;\n  };\n\n  function Ellipse(coordinates, width, height, opts) {\n    var _this;\n\n    _this = _CenterMixin.call(this, null, opts) || this;\n\n    if (coordinates) {\n      _this.setCoordinates(coordinates);\n    }\n\n    _this.width = width;\n    _this.height = height;\n    return _this;\n  }\n\n  var _proto = Ellipse.prototype;\n\n  _proto.getWidth = function getWidth() {\n    return this.width;\n  };\n\n  _proto.setWidth = function setWidth(width) {\n    this.width = width;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getHeight = function getHeight() {\n    return this.height;\n  };\n\n  _proto.setHeight = function setHeight(height) {\n    this.height = height;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getShell = function getShell() {\n    var measurer = this._getMeasurer(),\n        center = this.getCoordinates(),\n        numberOfPoints = this.options['numberOfShellPoints'],\n        width = this.getWidth(),\n        height = this.getHeight();\n\n    var shell = [];\n    var s = Math.pow(width / 2, 2) * Math.pow(height / 2, 2),\n        sx = Math.pow(width / 2, 2),\n        sy = Math.pow(height / 2, 2);\n    var deg, rad, dx, dy;\n\n    for (var i = 0; i < numberOfPoints; i++) {\n      deg = 360 * i / numberOfPoints;\n      rad = deg * Math.PI / 180;\n      dx = Math.sqrt(s / (sx * Math.pow(Math.tan(rad), 2) + sy));\n      dy = Math.sqrt(s / (sy * Math.pow(1 / Math.tan(rad), 2) + sx));\n\n      if (deg > 90 && deg < 270) {\n        dx *= -1;\n      }\n\n      if (deg > 180 && deg < 360) {\n        dy *= -1;\n      }\n\n      var vertex = measurer.locate(center, dx, dy);\n      shell.push(vertex);\n    }\n\n    return shell;\n  };\n\n  _proto.getHoles = function getHoles() {\n    return [];\n  };\n\n  _proto.animateShow = function animateShow() {\n    return this.show();\n  };\n\n  _proto._containsPoint = function _containsPoint(point, tolerance) {\n    var map = this.getMap();\n\n    if (map.isTransforming()) {\n      return _CenterMixin.prototype._containsPoint.call(this, point, tolerance);\n    }\n\n    var projection = map.getProjection();\n\n    var t = isNil(tolerance) ? this._hitTestTolerance() : tolerance,\n        pps = projection.projectCoords([this._coordinates, map.locate(this._coordinates, this.getWidth() / 2, this.getHeight() / 2)]),\n        p0 = map._prjToContainerPoint(pps[0]),\n        p1 = map._prjToContainerPoint(pps[1]);\n\n    return withInEllipse(point, p0, p1, t);\n  };\n\n  _proto._computePrjExtent = function _computePrjExtent() {\n    return Circle.prototype._computePrjExtent.apply(this, arguments);\n  };\n\n  _proto._computeExtent = function _computeExtent() {\n    return Circle.prototype._computeExtent.apply(this, arguments);\n  };\n\n  _proto._getMinMax = function _getMinMax(measurer) {\n    if (!measurer || !this._coordinates || isNil(this.width) || isNil(this.height)) {\n      return null;\n    }\n\n    var width = this.getWidth(),\n        height = this.getHeight();\n    var p1 = measurer.locate(this._coordinates, -width / 2, 0),\n        p2 = measurer.locate(this._coordinates, width / 2, 0),\n        p3 = measurer.locate(this._coordinates, 0, -height / 2),\n        p4 = measurer.locate(this._coordinates, 0, height / 2);\n    return [p1, p2, p3, p4];\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength() {\n    if (isNil(this.width) || isNil(this.height)) {\n      return 0;\n    }\n\n    var longer = this.width > this.height ? this.width : this.height;\n    return 2 * Math.PI * longer / 2 - 4 * Math.abs(this.width - this.height);\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea() {\n    if (isNil(this.width) || isNil(this.height)) {\n      return 0;\n    }\n\n    return Math.PI * this.width * this.height / 4;\n  };\n\n  _proto._exportGeoJSONGeometry = function _exportGeoJSONGeometry() {\n    var coordinates = Coordinate.toNumberArrays([this.getShell()]);\n    return {\n      'type': 'Polygon',\n      'coordinates': coordinates\n    };\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    var opts = extend({}, options);\n    var center = this.getCenter();\n    opts.geometry = false;\n    var feature = this.toGeoJSON(opts);\n    feature['geometry'] = {\n      'type': 'Polygon'\n    };\n    return {\n      'feature': feature,\n      'subType': 'Ellipse',\n      'coordinates': [center.x, center.y],\n      'width': this.getWidth(),\n      'height': this.getHeight()\n    };\n  };\n\n  return Ellipse;\n}(CenterMixin(Polygon));\n\nEllipse.mergeOptions(options$7);\nEllipse.registerJSONType('Ellipse');\n\nvar Rectangle = function (_Polygon) {\n  _inheritsLoose(Rectangle, _Polygon);\n\n  Rectangle.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var rect = new Rectangle(json['coordinates'], json['width'], json['height'], json['options']);\n    rect.setProperties(feature['properties']);\n    return rect;\n  };\n\n  function Rectangle(coordinates, width, height, opts) {\n    var _this;\n\n    _this = _Polygon.call(this, null, opts) || this;\n\n    if (coordinates) {\n      _this.setCoordinates(coordinates);\n    }\n\n    _this._width = width;\n    _this._height = height;\n    return _this;\n  }\n\n  var _proto = Rectangle.prototype;\n\n  _proto.getCoordinates = function getCoordinates() {\n    return this._coordinates;\n  };\n\n  _proto.setCoordinates = function setCoordinates(nw) {\n    this._coordinates = nw instanceof Coordinate ? nw : new Coordinate(nw);\n\n    if (!this._coordinates || !this.getMap()) {\n      this.onPositionChanged();\n      return this;\n    }\n\n    var projection = this._getProjection();\n\n    this._setPrjCoordinates(projection.project(this._coordinates));\n\n    return this;\n  };\n\n  _proto.getWidth = function getWidth() {\n    return this._width;\n  };\n\n  _proto.setWidth = function setWidth(width) {\n    this._width = width;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getHeight = function getHeight() {\n    return this._height;\n  };\n\n  _proto.setHeight = function setHeight(height) {\n    this._height = height;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getShell = function getShell() {\n    var measurer = this._getMeasurer();\n\n    var nw = this._coordinates;\n    var map = this.getMap();\n    var sx = 1,\n        sy = -1;\n\n    if (map) {\n      var fExt = map.getFullExtent();\n\n      if (fExt['left'] > fExt['right']) {\n        sx = -1;\n      }\n\n      if (fExt['bottom'] > fExt['top']) {\n        sy = 1;\n      }\n    }\n\n    var points = [];\n    points.push(nw);\n    points.push(measurer.locate(nw, sx * this._width, 0));\n    points.push(measurer.locate(nw, sx * this._width, sy * this._height));\n    points.push(measurer.locate(nw, 0, sy * this._height));\n    points.push(nw);\n    return points;\n  };\n\n  _proto.getHoles = function getHoles() {\n    return [];\n  };\n\n  _proto.animateShow = function animateShow() {\n    return this.show();\n  };\n\n  _proto._getPrjCoordinates = function _getPrjCoordinates() {\n    var projection = this._getProjection();\n\n    this._verifyProjection();\n\n    if (!this._pnw && projection) {\n      if (this._coordinates) {\n        this._pnw = projection.project(this._coordinates);\n      }\n    }\n\n    return this._pnw;\n  };\n\n  _proto._setPrjCoordinates = function _setPrjCoordinates(pnw) {\n    this._pnw = pnw;\n    this.onPositionChanged();\n  };\n\n  _proto._getPrjShell = function _getPrjShell() {\n    var shell = _Polygon.prototype._getPrjShell.call(this);\n\n    var projection = this._getProjection();\n\n    if (!projection.isSphere()) {\n      return shell;\n    }\n\n    var sphereExtent = projection.getSphereExtent(),\n        sx = sphereExtent.sx,\n        sy = sphereExtent.sy;\n\n    var circum = this._getProjection().getCircum();\n\n    var nw = shell[0];\n\n    for (var i = 1, l = shell.length; i < l; i++) {\n      var p = shell[i];\n      var dx = 0,\n          dy = 0;\n\n      if (sx * (nw.x - p.x) > 0) {\n        dx = circum.x * sx;\n      }\n\n      if (sy * (nw.y - p.y) < 0) {\n        dy = circum.y * sy;\n      }\n\n      shell[i]._add(dx, dy);\n    }\n\n    return shell;\n  };\n\n  _proto._updateCache = function _updateCache() {\n    this._clearCache();\n\n    var projection = this._getProjection();\n\n    if (this._pnw && projection) {\n      this._coordinates = projection.unproject(this._pnw);\n    }\n  };\n\n  _proto._clearProjection = function _clearProjection() {\n    this._pnw = null;\n\n    _Polygon.prototype._clearProjection.call(this);\n  };\n\n  _proto._computeCenter = function _computeCenter(measurer) {\n    return measurer.locate(this._coordinates, this._width / 2, -this._height / 2);\n  };\n\n  _proto._containsPoint = function _containsPoint(point, tolerance) {\n    var map = this.getMap();\n\n    if (map.isTransforming()) {\n      return _Polygon.prototype._containsPoint.call(this, point, tolerance);\n    }\n\n    var t = isNil(tolerance) ? this._hitTestTolerance() : tolerance,\n        r = map._getResolution() * t;\n\n    var extent = this._getPrjExtent().expand(r);\n\n    var p = map._containerPointToPrj(point);\n\n    return extent.contains(p);\n  };\n\n  _proto._computePrjExtent = function _computePrjExtent(projection) {\n    var se = this._getSouthEast(projection);\n\n    if (!se) {\n      return null;\n    }\n\n    var prjs = projection.projectCoords([new Coordinate(this._coordinates.x, se.y), new Coordinate(se.x, this._coordinates.y)]);\n    return new Extent(prjs[0], prjs[1]);\n  };\n\n  _proto._computeExtent = function _computeExtent(measurer) {\n    var se = this._getSouthEast(measurer);\n\n    if (!se) {\n      return null;\n    }\n\n    return new Extent(this._coordinates, se, this._getProjection());\n  };\n\n  _proto._getSouthEast = function _getSouthEast(measurer) {\n    if (!measurer || !this._coordinates || isNil(this._width) || isNil(this._height)) {\n      return null;\n    }\n\n    var width = this.getWidth(),\n        height = this.getHeight();\n    var w = width,\n        h = -height;\n\n    if (measurer.fullExtent) {\n      var fullExtent = measurer.fullExtent,\n          sx = fullExtent.right > fullExtent.left ? 1 : -1,\n          sy = fullExtent.top > fullExtent.bottom ? 1 : -1;\n      w *= sx;\n      h *= sy;\n    }\n\n    var rightPoint = measurer.locate(this._coordinates, w, 0);\n    var bottomPoint = measurer.locate(this._coordinates, 0, h);\n    rightPoint.y = bottomPoint.y;\n    return rightPoint;\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength() {\n    if (isNil(this._width) || isNil(this._height)) {\n      return 0;\n    }\n\n    return 2 * (this._width + this._height);\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea() {\n    if (isNil(this._width) || isNil(this._height)) {\n      return 0;\n    }\n\n    return this._width * this._height;\n  };\n\n  _proto._exportGeoJSONGeometry = function _exportGeoJSONGeometry() {\n    var coordinates = Coordinate.toNumberArrays([this.getShell()]);\n    return {\n      'type': 'Polygon',\n      'coordinates': coordinates\n    };\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    var opts = extend({}, options);\n    var nw = this.getCoordinates();\n    opts.geometry = false;\n    var feature = this.toGeoJSON(opts);\n    feature['geometry'] = {\n      'type': 'Polygon'\n    };\n    return {\n      'feature': feature,\n      'subType': 'Rectangle',\n      'coordinates': [nw.x, nw.y],\n      'width': this.getWidth(),\n      'height': this.getHeight()\n    };\n  };\n\n  return Rectangle;\n}(Polygon);\n\nRectangle.registerJSONType('Rectangle');\n\nvar options$8 = {\n  'numberOfShellPoints': 60\n};\n\nvar Sector = function (_Circle) {\n  _inheritsLoose(Sector, _Circle);\n\n  Sector.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var sector = new Sector(json['coordinates'], json['radius'], json['startAngle'], json['endAngle'], json['options']);\n    sector.setProperties(feature['properties']);\n    return sector;\n  };\n\n  function Sector(coordinates, radius, startAngle, endAngle, opts) {\n    var _this;\n\n    _this = _Circle.call(this, coordinates, radius, opts) || this;\n    _this.startAngle = startAngle;\n    _this.endAngle = endAngle;\n    return _this;\n  }\n\n  var _proto = Sector.prototype;\n\n  _proto.getStartAngle = function getStartAngle() {\n    return this.startAngle;\n  };\n\n  _proto.setStartAngle = function setStartAngle(startAngle) {\n    this.startAngle = startAngle;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getEndAngle = function getEndAngle() {\n    return this.endAngle;\n  };\n\n  _proto.setEndAngle = function setEndAngle(endAngle) {\n    this.endAngle = endAngle;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getShell = function getShell() {\n    var measurer = this._getMeasurer(),\n        center = this.getCoordinates(),\n        numberOfPoints = this.options['numberOfShellPoints'] - 2,\n        radius = this.getRadius(),\n        shell = [center.copy()],\n        startAngle = this.getStartAngle(),\n        angle = this.getEndAngle() - startAngle;\n\n    var rad, dx, dy;\n\n    for (var i = 0; i < numberOfPoints; i++) {\n      rad = (angle * i / (numberOfPoints - 1) + startAngle) * Math.PI / 180;\n      dx = radius * Math.cos(rad);\n      dy = radius * Math.sin(rad);\n      var vertex = measurer.locate(center, dx, dy);\n      shell.push(vertex);\n    }\n\n    shell.push(center.copy());\n    return shell;\n  };\n\n  _proto._containsPoint = function _containsPoint(point, tolerance) {\n    var map = this.getMap();\n\n    if (map.isTransforming()) {\n      return _Circle.prototype._containsPoint.call(this, point, tolerance);\n    }\n\n    var center = map._pointToContainerPoint(this._getCenter2DPoint()),\n        t = isNil(tolerance) ? this._hitTestTolerance() : tolerance,\n        size = this.getSize(),\n        pc = center,\n        pp = point,\n        x = pp.x - pc.x,\n        y = pc.y - pp.y,\n        atan2 = Math.atan2(y, x),\n        angle = atan2 < 0 ? (atan2 + 2 * Math.PI) * 360 / (2 * Math.PI) : atan2 * 360 / (2 * Math.PI);\n\n    var sAngle = this.startAngle % 360,\n        eAngle = this.endAngle % 360;\n    var between = false;\n\n    if (sAngle > eAngle) {\n      between = !(angle > eAngle && angle < sAngle);\n    } else {\n      between = angle >= sAngle && angle <= eAngle;\n    }\n\n    return pp.distanceTo(pc) <= size.width / 2 + t && between;\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength() {\n    if (isNil(this._radius)) {\n      return 0;\n    }\n\n    return Math.PI * 2 * this._radius * Math.abs(this.startAngle - this.endAngle) / 360 + 2 * this._radius;\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea() {\n    if (isNil(this._radius)) {\n      return 0;\n    }\n\n    return Math.PI * Math.pow(this._radius, 2) * Math.abs(this.startAngle - this.endAngle) / 360;\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    var opts = extend({}, options);\n    var center = this.getCenter();\n    opts.geometry = false;\n    var feature = this.toGeoJSON(opts);\n    feature['geometry'] = {\n      'type': 'Polygon'\n    };\n    return {\n      'feature': feature,\n      'subType': 'Sector',\n      'coordinates': [center.x, center.y],\n      'radius': this.getRadius(),\n      'startAngle': this.getStartAngle(),\n      'endAngle': this.getEndAngle()\n    };\n  };\n\n  return Sector;\n}(Circle);\n\nSector.mergeOptions(options$8);\nSector.registerJSONType('Sector');\n\nvar options$9 = {\n  'enableSimplify': false,\n  'enableClip': false\n};\n\nvar Curve = function (_LineString) {\n  _inheritsLoose(Curve, _LineString);\n\n  function Curve() {\n    return _LineString.apply(this, arguments) || this;\n  }\n\n  var _proto = Curve.prototype;\n\n  _proto._arc = function _arc(ctx, points, lineOpacity) {\n    var degree = this.options['arcDegree'] * Math.PI / 180;\n\n    for (var i = 1, l = points.length; i < l; i++) {\n      var c = Canvas._arcBetween(ctx, points[i - 1], points[i], degree);\n\n      var ctrlPoint = [points[i - 1].x + points[i].x - c[0], points[i - 1].y + points[i].y - c[1]];\n      points[i - 1].nextCtrlPoint = ctrlPoint;\n      points[i].prevCtrlPoint = ctrlPoint;\n\n      Canvas._stroke(ctx, lineOpacity);\n    }\n  };\n\n  _proto._quadraticCurve = function _quadraticCurve(ctx, points) {\n    if (points.length <= 2) {\n      Canvas._path(ctx, points);\n\n      return;\n    }\n\n    var i, l;\n\n    for (i = 2, l = points.length; i < l; i += 2) {\n      ctx.quadraticCurveTo(points[i - 1].x, points[i - 1].y, points[i].x, points[i].y);\n    }\n\n    i -= 1;\n\n    if (i < l) {\n      for (; i < l; i++) {\n        ctx.lineTo(points[i].x, points[i].y);\n      }\n    }\n  };\n\n  _proto._bezierCurve = function _bezierCurve(ctx, points) {\n    if (points.length <= 3) {\n      Canvas._path(ctx, points);\n\n      return;\n    }\n\n    var i, l;\n\n    for (i = 1, l = points.length; i + 2 < l; i += 3) {\n      ctx.bezierCurveTo(points[i].x, points[i].y, points[i + 1].x, points[i + 1].y, points[i + 2].x, points[i + 2].y);\n    }\n\n    if (i < l) {\n      for (; i < l; i++) {\n        ctx.lineTo(points[i].x, points[i].y);\n      }\n    }\n  };\n\n  _proto._getCurveArrowPoints = function _getCurveArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance, step) {\n    var l = segments.length;\n    var i;\n\n    for (i = step; i < l; i += step) {\n      var arrow = this._getArrowShape(segments[i - 1], segments[i], lineWidth, arrowStyle, tolerance);\n\n      if (arrow) {\n        arrows.push(arrow);\n      }\n    }\n\n    i -= step;\n\n    if (i < l - 1) {\n      for (i += 1; i < l; i++) {\n        var _arrow = this._getArrowShape(segments[i - 1], segments[i], lineWidth, arrowStyle, tolerance);\n\n        if (_arrow) {\n          arrows.push(_arrow);\n        }\n      }\n    }\n  };\n\n  return Curve;\n}(LineString);\n\nCurve.mergeOptions(options$9);\n\nvar options$a = {\n  'arcDegree': 90\n};\n\nvar ArcCurve = function (_Curve) {\n  _inheritsLoose(ArcCurve, _Curve);\n\n  function ArcCurve() {\n    return _Curve.apply(this, arguments) || this;\n  }\n\n  var _proto = ArcCurve.prototype;\n\n  _proto._toJSON = function _toJSON(options) {\n    return {\n      'feature': this.toGeoJSON(options),\n      'subType': 'ArcCurve'\n    };\n  };\n\n  _proto._paintOn = function _paintOn(ctx, points, lineOpacity) {\n    ctx.beginPath();\n\n    this._arc(ctx, points, lineOpacity);\n\n    Canvas._stroke(ctx, lineOpacity);\n\n    this._paintArrow(ctx, points, lineOpacity);\n  };\n\n  ArcCurve.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var arc = new ArcCurve(feature['geometry']['coordinates'], json['options']);\n    arc.setProperties(feature['properties']);\n    return arc;\n  };\n\n  return ArcCurve;\n}(Curve);\n\nArcCurve.registerJSONType('ArcCurve');\nArcCurve.mergeOptions(options$a);\n\nvar CubicBezierCurve = function (_Curve) {\n  _inheritsLoose(CubicBezierCurve, _Curve);\n\n  function CubicBezierCurve() {\n    return _Curve.apply(this, arguments) || this;\n  }\n\n  CubicBezierCurve.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var curve = new CubicBezierCurve(feature['geometry']['coordinates'], json['options']);\n    curve.setProperties(feature['properties']);\n    return curve;\n  };\n\n  var _proto = CubicBezierCurve.prototype;\n\n  _proto._toJSON = function _toJSON(options) {\n    return {\n      'feature': this.toGeoJSON(options),\n      'subType': 'CubicBezierCurve'\n    };\n  };\n\n  _proto._paintOn = function _paintOn(ctx, points, lineOpacity) {\n    ctx.beginPath();\n    ctx.moveTo(points[0].x, points[0].y);\n\n    this._bezierCurve(ctx, points);\n\n    Canvas._stroke(ctx, lineOpacity);\n\n    this._paintArrow(ctx, points, lineOpacity);\n  };\n\n  _proto._getArrowPoints = function _getArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance) {\n    return this._getCurveArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance, 3);\n  };\n\n  return CubicBezierCurve;\n}(Curve);\n\nCubicBezierCurve.registerJSONType('CubicBezierCurve');\n\nvar QuadBezierCurve = function (_Curve) {\n  _inheritsLoose(QuadBezierCurve, _Curve);\n\n  function QuadBezierCurve() {\n    return _Curve.apply(this, arguments) || this;\n  }\n\n  QuadBezierCurve.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var curve = new QuadBezierCurve(feature['geometry']['coordinates'], json['options']);\n    curve.setProperties(feature['properties']);\n    return curve;\n  };\n\n  var _proto = QuadBezierCurve.prototype;\n\n  _proto._toJSON = function _toJSON(options) {\n    return {\n      'feature': this.toGeoJSON(options),\n      'subType': 'QuadBezierCurve'\n    };\n  };\n\n  _proto._paintOn = function _paintOn(ctx, points, lineOpacity) {\n    ctx.beginPath();\n    ctx.moveTo(points[0].x, points[0].y);\n\n    this._quadraticCurve(ctx, points, lineOpacity);\n\n    Canvas._stroke(ctx, lineOpacity);\n\n    this._paintArrow(ctx, points, lineOpacity);\n  };\n\n  _proto._getArrowPoints = function _getArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance) {\n    return this._getCurveArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance, 2);\n  };\n\n  return QuadBezierCurve;\n}(Curve);\n\nQuadBezierCurve.registerJSONType('QuadBezierCurve');\n\nvar defaultSymbol$1 = {\n  'textFaceName': 'monospace',\n  'textSize': 12,\n  'textLineSpacing': 8,\n  'textWrapCharacter': '\\n',\n  'textHorizontalAlignment': 'middle',\n  'textVerticalAlignment': 'middle'\n};\nvar defaultBoxSymbol = {\n  'markerType': 'square',\n  'markerLineColor': '#000',\n  'markerLineWidth': 2,\n  'markerLineOpacity': 1,\n  'markerFill': '#fff',\n  'markerOpacity': 1\n};\n\nvar TextMarker = function (_Marker) {\n  _inheritsLoose(TextMarker, _Marker);\n\n  function TextMarker() {\n    return _Marker.apply(this, arguments) || this;\n  }\n\n  var _proto = TextMarker.prototype;\n\n  _proto.getContent = function getContent() {\n    return this._content;\n  };\n\n  _proto.setContent = function setContent(content) {\n    var old = this._content;\n    this._content = escapeSpecialChars(content);\n\n    this._refresh();\n\n    this._fireEvent('contentchange', {\n      'old': old,\n      'new': content\n    });\n\n    return this;\n  };\n\n  _proto.onAdd = function onAdd() {\n    this._refresh();\n  };\n\n  _proto.toJSON = function toJSON() {\n    var json = _Marker.prototype.toJSON.call(this);\n\n    delete json['symbol'];\n    return json;\n  };\n\n  _proto.setSymbol = function setSymbol(symbol) {\n    if (this._refreshing || !symbol) {\n      return _Marker.prototype.setSymbol.call(this, symbol);\n    }\n\n    var s = this._parseSymbol(symbol);\n\n    if (this.setTextStyle) {\n      var style = this.getTextStyle() || {};\n      style.symbol = s[0];\n      this.setTextStyle(style);\n    } else if (this.setTextSymbol) {\n      this.setTextSymbol(s[0]);\n    }\n\n    if (this.setBoxStyle) {\n      var _style = this.getBoxStyle() || {};\n\n      _style.symbol = s[1];\n      this.setBoxStyle(_style);\n    } else if (this.setBoxSymbol) {\n      this.setBoxSymbol(s[1]);\n    }\n\n    return this;\n  };\n\n  _proto._parseSymbol = function _parseSymbol(symbol) {\n    var t = {};\n    var b = {};\n\n    for (var p in symbol) {\n      if (hasOwn(symbol, p)) {\n        if (p.indexOf('text') === 0) {\n          t[p] = symbol[p];\n        } else {\n          b[p] = symbol[p];\n        }\n      }\n    }\n\n    return [t, b];\n  };\n\n  _proto._getTextSize = function _getTextSize(symbol) {\n    return splitTextToRow(this._content, symbol)['size'];\n  };\n\n  _proto._getInternalSymbol = function _getInternalSymbol() {\n    return this._symbol;\n  };\n\n  _proto._getDefaultTextSymbol = function _getDefaultTextSymbol() {\n    return extend({}, defaultSymbol$1);\n  };\n\n  _proto._getDefaultBoxSymbol = function _getDefaultBoxSymbol() {\n    return extend({}, defaultBoxSymbol);\n  };\n\n  _proto._getDefaultPadding = function _getDefaultPadding() {\n    return [12, 8];\n  };\n\n  return TextMarker;\n}(Marker);\n\nvar options$b = {\n  'textStyle': {\n    'wrap': true,\n    'padding': [12, 8],\n    'verticalAlignment': 'middle',\n    'horizontalAlignment': 'middle'\n  },\n  'boxSymbol': null\n};\n\nvar TextBox = function (_TextMarker) {\n  _inheritsLoose(TextBox, _TextMarker);\n\n  function TextBox(content, coordinates, width, height, options) {\n    var _this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    _this = _TextMarker.call(this, coordinates, options) || this;\n    _this._content = escapeSpecialChars(content);\n    _this._width = isNil(width) ? 100 : width;\n    _this._height = isNil(height) ? 40 : height;\n\n    if (options.boxSymbol) {\n      _this.setBoxSymbol(options.boxSymbol);\n    }\n\n    if (options.textStyle) {\n      _this.setTextStyle(options.textStyle);\n    }\n\n    _this._refresh();\n\n    return _this;\n  }\n\n  var _proto = TextBox.prototype;\n\n  _proto.getWidth = function getWidth() {\n    return this._width;\n  };\n\n  _proto.setWidth = function setWidth(width) {\n    this._width = width;\n\n    this._refresh();\n\n    return this;\n  };\n\n  _proto.getHeight = function getHeight() {\n    return this._height;\n  };\n\n  _proto.setHeight = function setHeight(height) {\n    this._height = height;\n\n    this._refresh();\n\n    return this;\n  };\n\n  _proto.getBoxSymbol = function getBoxSymbol() {\n    return extend({}, this.options.boxSymbol);\n  };\n\n  _proto.setBoxSymbol = function setBoxSymbol(symbol) {\n    this.options.boxSymbol = symbol ? extend({}, symbol) : symbol;\n\n    if (this.getSymbol()) {\n      this._refresh();\n    }\n\n    return this;\n  };\n\n  _proto.getTextStyle = function getTextStyle() {\n    if (!this.options.textStyle) {\n      return null;\n    }\n\n    return extend({}, this.options.textStyle);\n  };\n\n  _proto.setTextStyle = function setTextStyle(style) {\n    this.options.textStyle = style ? extend({}, style) : style;\n\n    if (this.getSymbol()) {\n      this._refresh();\n    }\n\n    return this;\n  };\n\n  TextBox.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var textBox = new TextBox(json['content'], feature['geometry']['coordinates'], json['width'], json['height'], json['options']);\n    textBox.setProperties(feature['properties']);\n    textBox.setId(feature['id']);\n\n    if (json['symbol']) {\n      textBox.setSymbol(json['symbol']);\n    }\n\n    return textBox;\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    return {\n      'feature': this.toGeoJSON(options),\n      'width': this.getWidth(),\n      'height': this.getHeight(),\n      'subType': 'TextBox',\n      'content': this._content\n    };\n  };\n\n  _proto._refresh = function _refresh() {\n    var textStyle = this.getTextStyle() || {},\n        padding = textStyle['padding'] || [12, 8],\n        maxWidth = this._width - 2 * padding[0],\n        maxHeight = this._height - 2 * padding[1];\n    var symbol = extend({}, textStyle.symbol || this._getDefaultTextSymbol(), this.options.boxSymbol || this._getDefaultBoxSymbol(), {\n      'textName': this._content,\n      'markerWidth': this._width,\n      'markerHeight': this._height,\n      'textHorizontalAlignment': 'middle',\n      'textVerticalAlignment': 'middle',\n      'textMaxWidth': maxWidth,\n      'textMaxHeight': maxHeight\n    });\n\n    if (textStyle['wrap'] && !symbol['textWrapWidth']) {\n      symbol['textWrapWidth'] = maxWidth;\n    }\n\n    var hAlign = textStyle['horizontalAlignment'];\n    symbol['textDx'] = symbol['markerDx'] || 0;\n    var offsetX = symbol['markerWidth'] / 2 - padding[0];\n\n    if (hAlign === 'left') {\n      symbol['textHorizontalAlignment'] = 'right';\n      symbol['textDx'] = symbol['textDx'] - offsetX;\n    } else if (hAlign === 'right') {\n      symbol['textHorizontalAlignment'] = 'left';\n      symbol['textDx'] = symbol['textDx'] + offsetX;\n    }\n\n    var vAlign = textStyle['verticalAlignment'];\n    symbol['textDy'] = symbol['markerDy'] || 0;\n    var offsetY = symbol['markerHeight'] / 2 - padding[1];\n\n    if (vAlign === 'top') {\n      symbol['textVerticalAlignment'] = 'bottom';\n      symbol['textDy'] -= offsetY;\n    } else if (vAlign === 'bottom') {\n      symbol['textVerticalAlignment'] = 'top';\n      symbol['textDy'] += offsetY;\n    }\n\n    this._refreshing = true;\n    this.updateSymbol(symbol);\n    delete this._refreshing;\n  };\n\n  return TextBox;\n}(TextMarker);\n\nTextBox.mergeOptions(options$b);\nTextBox.registerJSONType('TextBox');\n\nvar options$c = {\n  'boxStyle': null,\n  textSymbol: null\n};\n\nvar Label = function (_TextMarker) {\n  _inheritsLoose(Label, _TextMarker);\n\n  function Label(content, coordinates, options) {\n    var _this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    _this = _TextMarker.call(this, coordinates, options) || this;\n\n    if (options.textSymbol) {\n      _this.setTextSymbol(options.textSymbol);\n    }\n\n    if (options.boxStyle) {\n      _this.setBoxStyle(options.boxStyle);\n    }\n\n    _this._content = escapeSpecialChars(content);\n\n    _this._refresh();\n\n    return _this;\n  }\n\n  var _proto = Label.prototype;\n\n  _proto.getBoxStyle = function getBoxStyle() {\n    if (!this.options.boxStyle) {\n      return null;\n    }\n\n    return extend({}, this.options.boxStyle);\n  };\n\n  _proto.setBoxStyle = function setBoxStyle(style) {\n    this.options.boxStyle = style ? extend({}, style) : style;\n\n    this._refresh();\n\n    return this;\n  };\n\n  _proto.getTextSymbol = function getTextSymbol() {\n    return extend({}, this._getDefaultTextSymbol(), this.options.textSymbol);\n  };\n\n  _proto.setTextSymbol = function setTextSymbol(symbol) {\n    this.options.textSymbol = symbol ? extend({}, symbol) : symbol;\n\n    this._refresh();\n\n    return this;\n  };\n\n  Label.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var label = new Label(json['content'], feature['geometry']['coordinates'], json['options']);\n    label.setProperties(feature['properties']);\n    label.setId(feature['id']);\n\n    if (json['symbol']) {\n      label.setSymbol(json['symbol']);\n    }\n\n    return label;\n  };\n\n  _proto._canEdit = function _canEdit() {\n    return false;\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    return {\n      'feature': this.toGeoJSON(options),\n      'subType': 'Label',\n      'content': this._content\n    };\n  };\n\n  _proto._refresh = function _refresh() {\n    var symbol = extend({}, this.getTextSymbol(), {\n      'textName': this._content\n    });\n    var boxStyle = this.getBoxStyle();\n\n    if (boxStyle) {\n      extend(symbol, boxStyle.symbol);\n\n      var sizes = this._getBoxSize(symbol),\n          textSize = sizes[1],\n          padding = boxStyle['padding'] || this._getDefaultPadding();\n\n      var boxSize = sizes[0];\n      symbol['markerWidth'] = boxSize['width'];\n      symbol['markerHeight'] = boxSize['height'];\n\n      var dx = symbol['textDx'] || 0,\n          dy = symbol['textDy'] || 0,\n          textAlignPoint = getAlignPoint(textSize, symbol['textHorizontalAlignment'], symbol['textVerticalAlignment'])._add(dx, dy);\n\n      var hAlign = boxStyle['horizontalAlignment'] || 'middle';\n      symbol['markerDx'] = textAlignPoint.x;\n\n      if (hAlign === 'left') {\n        symbol['markerDx'] += symbol['markerWidth'] / 2 - padding[0];\n      } else if (hAlign === 'right') {\n        symbol['markerDx'] -= symbol['markerWidth'] / 2 - textSize['width'] - padding[0];\n      } else {\n        symbol['markerDx'] += textSize['width'] / 2;\n      }\n\n      var vAlign = boxStyle['verticalAlignment'] || 'middle';\n      symbol['markerDy'] = textAlignPoint.y;\n\n      if (vAlign === 'top') {\n        symbol['markerDy'] += symbol['markerHeight'] / 2 - padding[1];\n      } else if (vAlign === 'bottom') {\n        symbol['markerDy'] -= symbol['markerHeight'] / 2 - textSize['height'] - padding[1];\n      } else {\n        symbol['markerDy'] += textSize['height'] / 2;\n      }\n    }\n\n    this._refreshing = true;\n    this.updateSymbol(symbol);\n    delete this._refreshing;\n  };\n\n  _proto._getBoxSize = function _getBoxSize(symbol) {\n    if (!symbol['markerType']) {\n      symbol['markerType'] = 'square';\n    }\n\n    var boxStyle = this.getBoxStyle();\n\n    var size = this._getTextSize(symbol);\n\n    var width, height;\n\n    var padding = boxStyle['padding'] || this._getDefaultPadding();\n\n    width = size['width'] + padding[0] * 2;\n    height = size['height'] + padding[1] * 2;\n\n    if (boxStyle['minWidth']) {\n      if (!width || width < boxStyle['minWidth']) {\n        width = boxStyle['minWidth'];\n      }\n    }\n\n    if (boxStyle['minHeight']) {\n      if (!height || height < boxStyle['minHeight']) {\n        height = boxStyle['minHeight'];\n      }\n    }\n\n    return [new Size(width, height), size];\n  };\n\n  return Label;\n}(TextMarker);\n\nLabel.mergeOptions(options$c);\nLabel.registerJSONType('Label');\n\nvar Connectable = function Connectable(Base) {\n  return function (_Base) {\n    _inheritsLoose(_class, _Base);\n\n    function _class() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    _class._hasConnectors = function _hasConnectors(geometry) {\n      return !isNil(geometry.__connectors) && geometry.__connectors.length > 0;\n    };\n\n    _class._getConnectors = function _getConnectors(geometry) {\n      return geometry.__connectors;\n    };\n\n    var _proto = _class.prototype;\n\n    _proto.getConnectSource = function getConnectSource() {\n      return this._connSource;\n    };\n\n    _proto.setConnectSource = function setConnectSource(src) {\n      var target = this._connTarget;\n      this.onRemove();\n      this._connSource = src;\n      this._connTarget = target;\n      this.onAdd();\n      return this;\n    };\n\n    _proto.getConnectTarget = function getConnectTarget() {\n      return this._connTarget;\n    };\n\n    _proto.setConnectTarget = function setConnectTarget(target) {\n      var src = this._connSource;\n      this.onRemove();\n      this._connSource = src;\n      this._connTarget = target;\n\n      this._updateCoordinates();\n\n      this._registerEvents();\n\n      return this;\n    };\n\n    _proto._updateCoordinates = function _updateCoordinates() {\n      var map = this.getMap();\n\n      if (!map && this._connSource) {\n        map = this._connSource.getMap();\n      }\n\n      if (!map && this._connTarget) {\n        map = this._connTarget.getMap();\n      }\n\n      if (!map) {\n        return;\n      }\n\n      if (!this._connSource || !this._connTarget) {\n        return;\n      }\n\n      var srcPoints = this._connSource._getConnectPoints();\n\n      var targetPoints = this._connTarget._getConnectPoints();\n\n      var minDist = 0;\n      var oldCoordinates = this.getCoordinates();\n      var c1, c2;\n\n      for (var i = 0, len = srcPoints.length; i < len; i++) {\n        var p1 = srcPoints[i];\n\n        for (var j = 0, length = targetPoints.length; j < length; j++) {\n          var p2 = targetPoints[j];\n          var dist = map.computeLength(p1, p2);\n\n          if (i === 0 && j === 0) {\n            c1 = p1;\n            c2 = p2;\n            minDist = dist;\n          } else if (dist < minDist) {\n            c1 = p1;\n            c2 = p2;\n          }\n        }\n      }\n\n      if (!isArrayHasData(oldCoordinates) || !oldCoordinates[0].equals(c1) || !oldCoordinates[1].equals(c2)) {\n        this.setCoordinates([c1, c2]);\n      }\n    };\n\n    _proto.onAdd = function onAdd() {\n      this._registerEvents();\n\n      this._updateCoordinates();\n    };\n\n    _proto.onRemove = function onRemove() {\n      if (this._connSource) {\n        if (this._connSource.__connectors) {\n          removeFromArray(this, this._connSource.__connectors);\n        }\n\n        this._connSource.off('dragging positionchange', this._updateCoordinates, this).off('remove', this.onRemove, this);\n\n        this._connSource.off('dragstart mousedown mouseover', this._showConnect, this);\n\n        this._connSource.off('dragend mouseup mouseout', this.hide, this);\n\n        this._connSource.off('show', this._showConnect, this).off('hide', this.hide, this);\n\n        delete this._connSource;\n      }\n\n      if (this._connTarget) {\n        removeFromArray(this, this._connTarget.__connectors);\n\n        this._connTarget.off('dragging positionchange', this._updateCoordinates, this).off('remove', this.onRemove, this);\n\n        this._connTarget.off('show', this._showConnect, this).off('hide', this.hide, this);\n\n        delete this._connTarget;\n      }\n\n      if (!(this._connSource instanceof Geometry) || !(this._connTarget instanceof Geometry)) {\n        var map = this.getMap();\n\n        if (map) {\n          map.off('movestart moving moveend zoomstart zooming zoomend rotate pitch fovchange spatialreferencechange', this._updateCoordinates, this);\n        }\n      }\n    };\n\n    _proto._showConnect = function _showConnect() {\n      if (!this._connSource || !this._connTarget) {\n        return;\n      }\n\n      if (this._connSource.isVisible() && this._connTarget.isVisible()) {\n        this._updateCoordinates();\n\n        this.show();\n      }\n    };\n\n    _proto._registerEvents = function _registerEvents() {\n      if (!this._connSource || !this._connTarget) {\n        return;\n      }\n\n      if (!this._connSource.__connectors) {\n        this._connSource.__connectors = [];\n      }\n\n      if (!this._connTarget.__connectors) {\n        this._connTarget.__connectors = [];\n      }\n\n      this._connSource.__connectors.push(this);\n\n      this._connTarget.__connectors.push(this);\n\n      this._connSource.on('dragging positionchange', this._updateCoordinates, this).on('remove', this.remove, this);\n\n      this._connTarget.on('dragging positionchange', this._updateCoordinates, this).on('remove', this.remove, this);\n\n      this._connSource.on('show', this._showConnect, this).on('hide', this.hide, this);\n\n      this._connTarget.on('show', this._showConnect, this).on('hide', this.hide, this);\n\n      var trigger = this.options['showOn'];\n      this.hide();\n\n      if (trigger === 'moving') {\n        this._connSource.on('dragstart', this._showConnect, this).on('dragend', this.hide, this);\n\n        this._connTarget.on('dragstart', this._showConnect, this).on('dragend', this.hide, this);\n      } else if (trigger === 'click') {\n        this._connSource.on('mousedown', this._showConnect, this).on('mouseup', this.hide, this);\n\n        this._connTarget.on('mousedown', this._showConnect, this).on('mouseup', this.hide, this);\n      } else if (trigger === 'mouseover') {\n        this._connSource.on('mouseover', this._showConnect, this).on('mouseout', this.hide, this);\n\n        this._connTarget.on('mouseover', this._showConnect, this).on('mouseout', this.hide, this);\n      } else {\n        this._showConnect();\n      }\n\n      if (!(this._connSource instanceof Geometry) || !(this._connTarget instanceof Geometry)) {\n        var map = this.getMap();\n\n        if (map) {\n          map.on('movestart moving moveend zoomstart zooming zoomend rotate pitch fovchange spatialreferencechange', this._updateCoordinates, this);\n        }\n      }\n    };\n\n    return _class;\n  }(Base);\n};\n\nvar options$d = {\n  showOn: 'always'\n};\n\nvar ConnectorLine = function (_Connectable) {\n  _inheritsLoose(ConnectorLine, _Connectable);\n\n  function ConnectorLine(src, target, options) {\n    var _this;\n\n    _this = _Connectable.call(this, null, options) || this;\n\n    if (arguments.length === 1) {\n      options = src;\n      src = null;\n      target = null;\n    }\n\n    _this._connSource = src;\n    _this._connTarget = target;\n    return _this;\n  }\n\n  return ConnectorLine;\n}(Connectable(LineString));\n\nConnectorLine.mergeOptions(options$d);\nConnectorLine.registerJSONType('ConnectorLine');\n\nvar ArcConnectorLine = function (_Connectable2) {\n  _inheritsLoose(ArcConnectorLine, _Connectable2);\n\n  function ArcConnectorLine(src, target, options) {\n    var _this2;\n\n    _this2 = _Connectable2.call(this, null, options) || this;\n\n    if (arguments.length === 1) {\n      options = src;\n      src = null;\n      target = null;\n    }\n\n    _this2._connSource = src;\n    _this2._connTarget = target;\n    return _this2;\n  }\n\n  return ArcConnectorLine;\n}(Connectable(ArcCurve));\n\nArcConnectorLine.mergeOptions(options$d);\nArcConnectorLine.registerJSONType('ArcConnectorLine');\n\nvar options$e = {\n  'drawImmediate': false\n};\n\nvar OverlayLayer = function (_Layer) {\n  _inheritsLoose(OverlayLayer, _Layer);\n\n  function OverlayLayer(id, geometries, options) {\n    var _this;\n\n    if (geometries && !(geometries instanceof Geometry) && !Array.isArray(geometries) && GEOJSON_TYPES.indexOf(geometries.type) < 0) {\n      options = geometries;\n      geometries = null;\n    }\n\n    _this = _Layer.call(this, id, options) || this;\n    _this._maxZIndex = 0;\n    _this._minZIndex = 0;\n\n    _this._initCache();\n\n    if (geometries) {\n      _this.addGeometry(geometries);\n    }\n\n    var style = _this.options['style'];\n\n    if (style) {\n      _this.setStyle(style);\n    }\n\n    return _this;\n  }\n\n  var _proto = OverlayLayer.prototype;\n\n  _proto.getGeometryById = function getGeometryById(id) {\n    if (isNil(id) || id === '') {\n      return null;\n    }\n\n    if (!this._geoMap[id]) {\n      return null;\n    }\n\n    return this._geoMap[id];\n  };\n\n  _proto.getGeometries = function getGeometries(filter, context) {\n    if (!filter) {\n      return this._geoList.slice(0);\n    }\n\n    var result = [];\n    var geometry, filtered;\n\n    for (var i = 0, l = this._geoList.length; i < l; i++) {\n      geometry = this._geoList[i];\n\n      if (context) {\n        filtered = filter.call(context, geometry);\n      } else {\n        filtered = filter(geometry);\n      }\n\n      if (filtered) {\n        result.push(geometry);\n      }\n    }\n\n    return result;\n  };\n\n  _proto.getFirstGeometry = function getFirstGeometry() {\n    if (!this._geoList.length) {\n      return null;\n    }\n\n    return this._geoList[0];\n  };\n\n  _proto.getLastGeometry = function getLastGeometry() {\n    var len = this._geoList.length;\n\n    if (len === 0) {\n      return null;\n    }\n\n    return this._geoList[len - 1];\n  };\n\n  _proto.getCount = function getCount() {\n    return this._geoList.length;\n  };\n\n  _proto.getExtent = function getExtent() {\n    if (this.getCount() === 0) {\n      return null;\n    }\n\n    var extent = new Extent(this.getProjection());\n    this.forEach(function (g) {\n      extent._combine(g.getExtent());\n    });\n    return extent;\n  };\n\n  _proto.forEach = function forEach(fn, context) {\n    var copyOnWrite = this._geoList.slice(0);\n\n    for (var i = 0, l = copyOnWrite.length; i < l; i++) {\n      if (!context) {\n        fn(copyOnWrite[i], i);\n      } else {\n        fn.call(context, copyOnWrite[i], i);\n      }\n    }\n\n    return this;\n  };\n\n  _proto.filter = function filter(fn, context) {\n    var selected = [];\n    var isFn = isFunction(fn);\n    var filter = isFn ? fn : createFilter(fn);\n    this.forEach(function (geometry) {\n      var g = isFn ? geometry : getFilterFeature(geometry);\n\n      if (context ? filter.call(context, g) : filter(g)) {\n        selected.push(geometry);\n      }\n    }, this);\n    return selected;\n  };\n\n  _proto.isEmpty = function isEmpty$$1() {\n    return !this._geoList.length;\n  };\n\n  _proto.addGeometry = function addGeometry(geometries, fitView) {\n    if (!geometries) {\n      return this;\n    }\n\n    if (geometries.type === 'FeatureCollection') {\n      return this.addGeometry(GeoJSON.toGeometry(geometries), fitView);\n    } else if (!Array.isArray(geometries)) {\n      var count = arguments.length;\n      var last = arguments[count - 1];\n      geometries = Array.prototype.slice.call(arguments, 0, count - 1);\n      fitView = last;\n\n      if (last && isObject(last) && ('type' in last || last instanceof Geometry)) {\n        geometries.push(last);\n        fitView = false;\n      }\n\n      return this.addGeometry(geometries, fitView);\n    } else if (geometries.length === 0) {\n      return this;\n    }\n\n    this._initCache();\n\n    var extent;\n\n    if (fitView) {\n      extent = new Extent();\n    }\n\n    this._toSort = this._maxZIndex > 0;\n    var geos = [];\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      var geo = geometries[i];\n\n      if (!geo) {\n        throw new Error('Invalid geometry to add to layer(' + this.getId() + ') at index:' + i);\n      }\n\n      if (!(geo instanceof Geometry)) {\n        geo = Geometry.fromJSON(geo);\n\n        if (Array.isArray(geo)) {\n          for (var ii = 0, ll = geo.length; ii < ll; ii++) {\n            this._add(geo[ii], extent, i);\n\n            geos.push(geo[ii]);\n          }\n        }\n      }\n\n      if (!Array.isArray(geo)) {\n        this._add(geo, extent, i);\n\n        geos.push(geo);\n      }\n    }\n\n    var map = this.getMap();\n\n    if (map) {\n      this._getRenderer().onGeometryAdd(geos);\n\n      if (extent && !isNil(extent.xmin)) {\n        var center = extent.getCenter();\n        var z = map.getFitZoom(extent);\n\n        if (isObject(fitView)) {\n          var step = isFunction(fitView.step) ? fitView.step : function () {\n            return undefined;\n          };\n          map.animateTo({\n            center: center,\n            zoom: z\n          }, extend({\n            duration: map.options.zoomAnimationDuration,\n            easing: 'out'\n          }, fitView), step);\n        } else if (fitView === true) {\n          map.setCenterAndZoom(center, z);\n        }\n      }\n    }\n\n    this.fire('addgeo', {\n      'geometries': geometries\n    });\n    return this;\n  };\n\n  _proto.getGeoMinZIndex = function getGeoMinZIndex() {\n    return this._minZIndex;\n  };\n\n  _proto.getGeoMaxZIndex = function getGeoMaxZIndex() {\n    return this._maxZIndex;\n  };\n\n  _proto._add = function _add(geo, extent, i) {\n    if (!this._toSort) {\n      this._toSort = geo.getZIndex() !== 0;\n    }\n\n    this._updateZIndex(geo.getZIndex());\n\n    var geoId = geo.getId();\n\n    if (!isNil(geoId)) {\n      if (!isNil(this._geoMap[geoId])) {\n        throw new Error('Duplicate geometry id in layer(' + this.getId() + '):' + geoId + ', at index:' + i);\n      }\n\n      this._geoMap[geoId] = geo;\n    }\n\n    var internalId = UID();\n\n    geo._setInternalId(internalId);\n\n    this._geoList.push(geo);\n\n    this.onAddGeometry(geo);\n\n    geo._bindLayer(this);\n\n    if (geo.onAdd) {\n      geo.onAdd();\n    }\n\n    if (extent) {\n      extent._combine(geo.getExtent());\n    }\n\n    geo._fireEvent('add', {\n      'layer': this\n    });\n\n    if (this._cookedStyles) {\n      this._styleGeometry(geo);\n    }\n  };\n\n  _proto.removeGeometry = function removeGeometry(geometries) {\n    if (!Array.isArray(geometries)) {\n      return this.removeGeometry([geometries]);\n    }\n\n    for (var i = geometries.length - 1; i >= 0; i--) {\n      if (!(geometries[i] instanceof Geometry)) {\n        geometries[i] = this.getGeometryById(geometries[i]);\n      }\n\n      if (!geometries[i] || this !== geometries[i].getLayer()) continue;\n      geometries[i].remove();\n    }\n\n    this.fire('removegeo', {\n      'geometries': geometries\n    });\n    return this;\n  };\n\n  _proto.clear = function clear() {\n    this._clearing = true;\n    this.forEach(function (geo) {\n      geo.remove();\n    });\n    this._geoMap = {};\n    var old = this._geoList;\n    this._geoList = [];\n\n    var renderer = this._getRenderer();\n\n    if (renderer) {\n      renderer.onGeometryRemove(old);\n\n      if (renderer.clearImageData) {\n        renderer.clearImageData();\n      }\n    }\n\n    this._clearing = false;\n    this.fire('clear');\n    return this;\n  };\n\n  _proto.onRemoveGeometry = function onRemoveGeometry(geometry) {\n    if (!geometry || this._clearing) {\n      return;\n    }\n\n    if (this !== geometry.getLayer()) {\n      return;\n    }\n\n    var internalId = geometry._getInternalId();\n\n    if (isNil(internalId)) {\n      return;\n    }\n\n    var geoId = geometry.getId();\n\n    if (!isNil(geoId)) {\n      delete this._geoMap[geoId];\n    }\n\n    var idx = this._findInList(geometry);\n\n    if (idx >= 0) {\n      this._geoList.splice(idx, 1);\n    }\n\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryRemove([geometry]);\n    }\n  };\n\n  _proto.getStyle = function getStyle() {\n    if (!this.options['style']) {\n      return null;\n    }\n\n    return this.options['style'];\n  };\n\n  _proto.setStyle = function setStyle(style) {\n    this.options.style = style;\n    style = parseStyleRootPath(style);\n    this._cookedStyles = compileStyle(style);\n    this.forEach(function (geometry) {\n      this._styleGeometry(geometry);\n    }, this);\n    this.fire('setstyle', {\n      'style': style\n    });\n    return this;\n  };\n\n  _proto._styleGeometry = function _styleGeometry(geometry) {\n    if (!this._cookedStyles) {\n      return false;\n    }\n\n    var g = getFilterFeature(geometry);\n\n    for (var i = 0, len = this._cookedStyles.length; i < len; i++) {\n      if (this._cookedStyles[i]['filter'](g) === true) {\n        geometry._setExternSymbol(this._cookedStyles[i]['symbol']);\n\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  _proto.removeStyle = function removeStyle() {\n    if (!this.options.style) {\n      return this;\n    }\n\n    delete this.options.style;\n    delete this._cookedStyles;\n    this.forEach(function (geometry) {\n      geometry._setExternSymbol(null);\n    }, this);\n    this.fire('removestyle');\n    return this;\n  };\n\n  _proto.onAddGeometry = function onAddGeometry(geo) {\n    var style = this.getStyle();\n\n    if (style) {\n      this._styleGeometry(geo);\n    }\n  };\n\n  _proto.hide = function hide() {\n    for (var i = 0, l = this._geoList.length; i < l; i++) {\n      this._geoList[i].onHide();\n    }\n\n    return Layer.prototype.hide.call(this);\n  };\n\n  _proto._initCache = function _initCache() {\n    if (!this._geoList) {\n      this._geoList = [];\n      this._geoMap = {};\n    }\n  };\n\n  _proto._updateZIndex = function _updateZIndex() {\n    for (var _len = arguments.length, zIndex = new Array(_len), _key = 0; _key < _len; _key++) {\n      zIndex[_key] = arguments[_key];\n    }\n\n    this._maxZIndex = Math.max(this._maxZIndex, Math.max.apply(Math, zIndex));\n    this._minZIndex = Math.min(this._minZIndex, Math.min.apply(Math, zIndex));\n  };\n\n  _proto._sortGeometries = function _sortGeometries() {\n    var _this2 = this;\n\n    if (!this._toSort) {\n      return;\n    }\n\n    this._maxZIndex = 0;\n    this._minZIndex = 0;\n\n    this._geoList.sort(function (a, b) {\n      _this2._updateZIndex(a.getZIndex(), b.getZIndex());\n\n      return _this2._compare(a, b);\n    });\n\n    this._toSort = false;\n  };\n\n  _proto._compare = function _compare(a, b) {\n    if (a.getZIndex() === b.getZIndex()) {\n      return a._getInternalId() - b._getInternalId();\n    }\n\n    return a.getZIndex() - b.getZIndex();\n  };\n\n  _proto._findInList = function _findInList(geo) {\n    var len = this._geoList.length;\n\n    if (len === 0) {\n      return -1;\n    }\n\n    this._sortGeometries();\n\n    var low = 0,\n        high = len - 1,\n        middle;\n\n    while (low <= high) {\n      middle = Math.floor((low + high) / 2);\n\n      if (this._geoList[middle] === geo) {\n        return middle;\n      } else if (this._compare(this._geoList[middle], geo) > 0) {\n        high = middle - 1;\n      } else {\n        low = middle + 1;\n      }\n    }\n\n    return -1;\n  };\n\n  _proto._onGeometryEvent = function _onGeometryEvent(param) {\n    if (!param || !param['target']) {\n      return;\n    }\n\n    var type = param['type'];\n\n    if (type === 'idchange') {\n      this._onGeometryIdChange(param);\n    } else if (type === 'zindexchange') {\n      this._onGeometryZIndexChange(param);\n    } else if (type === 'positionchange') {\n      this._onGeometryPositionChange(param);\n    } else if (type === 'shapechange') {\n      this._onGeometryShapeChange(param);\n    } else if (type === 'symbolchange') {\n      this._onGeometrySymbolChange(param);\n    } else if (type === 'show') {\n      this._onGeometryShow(param);\n    } else if (type === 'hide') {\n      this._onGeometryHide(param);\n    } else if (type === 'propertieschange') {\n      this._onGeometryPropertiesChange(param);\n    }\n  };\n\n  _proto._onGeometryIdChange = function _onGeometryIdChange(param) {\n    if (param['new'] === param['old']) {\n      if (this._geoMap[param['old']] && this._geoMap[param['old']] === param['target']) {\n        return;\n      }\n    }\n\n    if (!isNil(param['new'])) {\n      if (this._geoMap[param['new']]) {\n        throw new Error('Duplicate geometry id in layer(' + this.getId() + '):' + param['new']);\n      }\n\n      this._geoMap[param['new']] = param['target'];\n    }\n\n    if (!isNil(param['old']) && param['new'] !== param['old']) {\n      delete this._geoMap[param['old']];\n    }\n  };\n\n  _proto._onGeometryZIndexChange = function _onGeometryZIndexChange(param) {\n    if (param['old'] !== param['new']) {\n      this._updateZIndex(param['new']);\n\n      this._toSort = true;\n\n      if (this._getRenderer()) {\n        this._getRenderer().onGeometryZIndexChange(param);\n      }\n    }\n  };\n\n  _proto._onGeometryPositionChange = function _onGeometryPositionChange(param) {\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryPositionChange(param);\n    }\n  };\n\n  _proto._onGeometryShapeChange = function _onGeometryShapeChange(param) {\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryShapeChange(param);\n    }\n  };\n\n  _proto._onGeometrySymbolChange = function _onGeometrySymbolChange(param) {\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometrySymbolChange(param);\n    }\n  };\n\n  _proto._onGeometryShow = function _onGeometryShow(param) {\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryShow(param);\n    }\n  };\n\n  _proto._onGeometryHide = function _onGeometryHide(param) {\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryHide(param);\n    }\n  };\n\n  _proto._onGeometryPropertiesChange = function _onGeometryPropertiesChange(param) {\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryPropertiesChange(param);\n    }\n  };\n\n  return OverlayLayer;\n}(Layer);\n\nOverlayLayer.mergeOptions(options$e);\n\nvar TEMP_EXTENT$5 = new PointExtent();\nvar options$f = {\n  'debug': false,\n  'enableSimplify': true,\n  'geometryEvents': true,\n  'defaultIconSize': [20, 20],\n  'cacheVectorOnCanvas': true,\n  'cacheSvgOnCanvas': Browser$1.gecko,\n  'enableAltitude': false,\n  'altitudeProperty': 'altitude',\n  'drawAltitude': false,\n  'sortByDistanceToCamera': false,\n  'roundPoint': false,\n  'altitude': 0,\n  'clipBBoxBufferSize': 3\n};\n\nvar VectorLayer = function (_OverlayLayer) {\n  _inheritsLoose(VectorLayer, _OverlayLayer);\n\n  function VectorLayer(id, geometries, options) {\n    return _OverlayLayer.call(this, id, geometries, options) || this;\n  }\n\n  var _proto = VectorLayer.prototype;\n\n  _proto.onConfig = function onConfig(conf) {\n    _OverlayLayer.prototype.onConfig.call(this, conf);\n\n    if (conf['enableAltitude'] || conf['drawAltitude'] || conf['altitudeProperty']) {\n      var renderer = this.getRenderer();\n\n      if (renderer && renderer.setToRedraw) {\n        renderer.setToRedraw();\n      }\n    }\n  };\n\n  _proto.identify = function identify(coordinate, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var renderer = this.getRenderer();\n\n    if (!(coordinate instanceof Coordinate)) {\n      coordinate = new Coordinate(coordinate);\n    }\n\n    var cp = this.getMap().coordToContainerPoint(coordinate);\n\n    if (options['onlyVisible'] && renderer && renderer.identifyAtPoint) {\n      return renderer.identifyAtPoint(cp, options);\n    }\n\n    return this._hitGeos(this._geoList, cp, options);\n  };\n\n  _proto.identifyAtPoint = function identifyAtPoint(point, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var renderer = this.getRenderer();\n\n    if (!(point instanceof Point)) {\n      point = new Point(point);\n    }\n\n    if (options['onlyVisible'] && renderer && renderer.identifyAtPoint) {\n      return renderer.identifyAtPoint(point, options);\n    }\n\n    return this._hitGeos(this._geoList, point, options);\n  };\n\n  _proto._hitGeos = function _hitGeos(geometries, cp, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var filter = options['filter'],\n        tolerance = options['tolerance'],\n        hits = [];\n    var map = this.getMap();\n    var renderer = this.getRenderer();\n    var imageData = renderer && renderer.getImageData && renderer.getImageData();\n\n    if (imageData) {\n      var r = map.getDevicePixelRatio();\n      imageData.r = r;\n      var x = Math.round(cp.x * r),\n          y = Math.round(cp.y * r);\n      var idx = y * imageData.width * 4 + x * 4;\n\n      if (imageData.data[idx + 3] === 0) {\n        return hits;\n      }\n    }\n\n    for (var i = geometries.length - 1; i >= 0; i--) {\n      var geo = geometries[i];\n\n      if (!geo || !geo.isVisible() || !geo._getPainter() || !geo.options['interactive']) {\n        continue;\n      }\n\n      if (!(geo instanceof LineString) || !geo._getArrowStyle() && !(geo instanceof Curve)) {\n        var extent = geo.getContainerExtent(TEMP_EXTENT$5);\n\n        if (tolerance) {\n          extent = extent._expand(tolerance);\n        }\n\n        if (!extent || !extent.contains(cp)) {\n          continue;\n        }\n      }\n\n      if (geo._containsPoint(cp, tolerance) && (!filter || filter(geo))) {\n        hits.push(geo);\n\n        if (options['count']) {\n          if (hits.length >= options['count']) {\n            break;\n          }\n        }\n      }\n    }\n\n    return hits;\n  };\n\n  _proto.getAltitude = function getAltitude() {\n    return this.options['altitude'] || 0;\n  };\n\n  _proto.toJSON = function toJSON(options) {\n    if (!options) {\n      options = {};\n    }\n\n    var profile = {\n      'type': this.getJSONType(),\n      'id': this.getId(),\n      'options': this.config()\n    };\n\n    if (isNil(options['geometries']) || options['geometries']) {\n      var clipExtent;\n\n      if (options['clipExtent']) {\n        var map = this.getMap();\n        var projection = map ? map.getProjection() : null;\n        clipExtent = new Extent(options['clipExtent'], projection);\n      }\n\n      var geoJSONs = [];\n      var geometries = this.getGeometries();\n\n      for (var i = 0, len = geometries.length; i < len; i++) {\n        var geo = geometries[i];\n        var geoExt = geo.getExtent();\n\n        if (!geoExt || clipExtent && !clipExtent.intersects(geoExt)) {\n          continue;\n        }\n\n        var json = geo.toJSON(options['geometries']);\n        geoJSONs.push(json);\n      }\n\n      profile['geometries'] = geoJSONs;\n    }\n\n    return profile;\n  };\n\n  VectorLayer.fromJSON = function fromJSON(json) {\n    if (!json || json['type'] !== 'VectorLayer') {\n      return null;\n    }\n\n    var layer = new VectorLayer(json['id'], json['options']);\n    var geoJSONs = json['geometries'];\n    var geometries = [];\n\n    for (var i = 0; i < geoJSONs.length; i++) {\n      var geo = Geometry.fromJSON(geoJSONs[i]);\n\n      if (geo) {\n        geometries.push(geo);\n      }\n    }\n\n    layer.addGeometry(geometries);\n    return layer;\n  };\n\n  VectorLayer.getPainterClass = function getPainterClass() {\n    return Painter;\n  };\n\n  VectorLayer.getCollectionPainterClass = function getCollectionPainterClass() {\n    return CollectionPainter;\n  };\n\n  return VectorLayer;\n}(OverlayLayer);\n\nVectorLayer.mergeOptions(options$f);\nVectorLayer.registerJSONType('VectorLayer');\n\nvar key = '_map_tool';\n\nvar MapTool = function (_Eventable) {\n  _inheritsLoose(MapTool, _Eventable);\n\n  function MapTool() {\n    return _Eventable.apply(this, arguments) || this;\n  }\n\n  var _proto = MapTool.prototype;\n\n  _proto.addTo = function addTo(map) {\n    if (!map) {\n      return this;\n    }\n\n    this._map = map;\n\n    if (map[key]) {\n      map[key].disable();\n    }\n\n    if (this.onAdd) {\n      this.onAdd();\n    }\n\n    this.enable();\n    map[key] = this;\n\n    this._fireEvent('add');\n\n    return this;\n  };\n\n  _proto.getMap = function getMap() {\n    return this._map;\n  };\n\n  _proto.enable = function enable() {\n    var map = this._map;\n\n    if (!map || this._enabled) {\n      return this;\n    }\n\n    this._enabled = true;\n\n    this._switchEvents('off');\n\n    this._registerEvents();\n\n    if (this.onEnable) {\n      this.onEnable();\n    }\n\n    this._fireEvent('enable');\n\n    return this;\n  };\n\n  _proto.disable = function disable() {\n    if (!this._enabled || !this._map) {\n      return this;\n    }\n\n    this._enabled = false;\n\n    this._switchEvents('off');\n\n    if (this.onDisable) {\n      this.onDisable();\n    }\n\n    this._fireEvent('disable');\n\n    return this;\n  };\n\n  _proto.isEnabled = function isEnabled() {\n    if (!this._enabled) {\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto.remove = function remove() {\n    if (!this._map) {\n      return this;\n    }\n\n    this.disable();\n\n    if (this._map) {\n      delete this._map[key];\n      delete this._map;\n    }\n\n    this._fireEvent('remove');\n\n    return this;\n  };\n\n  _proto._registerEvents = function _registerEvents() {\n    this._switchEvents('on');\n  };\n\n  _proto._switchEvents = function _switchEvents(to) {\n    var events = this.getEvents();\n\n    if (events) {\n      this._map[to](events, this);\n    }\n  };\n\n  _proto._fireEvent = function _fireEvent(eventName, param) {\n    if (!param) {\n      param = {};\n    }\n\n    this.fire(eventName, param);\n  };\n\n  return MapTool;\n}(Eventable(Class));\n\nvar options$g = {\n  'symbol': {\n    'lineColor': '#000',\n    'lineWidth': 2,\n    'lineOpacity': 1,\n    'polygonFill': '#fff',\n    'polygonOpacity': 0.3\n  },\n  'doubleClickZoom': false,\n  'mode': null,\n  'once': false,\n  'autoPanAtEdge': false,\n  'ignoreMouseleave': true,\n  'blockGeometryEvents': false\n};\nvar registeredMode = {};\n\nvar DrawTool = function (_MapTool) {\n  _inheritsLoose(DrawTool, _MapTool);\n\n  DrawTool.registerMode = function registerMode(name, modeAction) {\n    registeredMode[name.toLowerCase()] = modeAction;\n  };\n\n  DrawTool.getRegisterMode = function getRegisterMode(name) {\n    return registeredMode[name.toLowerCase()];\n  };\n\n  function DrawTool(options) {\n    var _this;\n\n    _this = _MapTool.call(this, options) || this;\n\n    _this._checkMode();\n\n    _this._events = {\n      'click': _this._clickHandler,\n      'mousemove touchmove': _this._mouseMoveHandler,\n      'dblclick': _this._doubleClickHandler,\n      'mousedown touchstart': _this._mouseDownHandler,\n      'mouseup touchend': _this._mouseUpHandler,\n      'mousemove': _this._mouseMoveHandler,\n      'mousedown': _this._mouseDownHandler,\n      'mouseup': _this._mouseUpHandler\n    };\n    return _this;\n  }\n\n  var _proto = DrawTool.prototype;\n\n  _proto.getMode = function getMode() {\n    if (this.options['mode']) {\n      return this.options['mode'].toLowerCase();\n    }\n\n    return null;\n  };\n\n  _proto.setMode = function setMode(mode) {\n    if (this._geometry) {\n      this._geometry.remove();\n\n      delete this._geometry;\n    }\n\n    this._clearStage();\n\n    this._switchEvents('off');\n\n    this.options['mode'] = mode;\n\n    this._checkMode();\n\n    if (this.isEnabled()) {\n      this._switchEvents('on');\n\n      this._restoreMapCfg();\n\n      this._saveMapCfg();\n    }\n\n    return this;\n  };\n\n  _proto.getSymbol = function getSymbol() {\n    var symbol = this.options['symbol'];\n\n    if (symbol) {\n      return extendSymbol(symbol);\n    } else {\n      return extendSymbol(this.options['symbol']);\n    }\n  };\n\n  _proto.setSymbol = function setSymbol(symbol) {\n    if (!symbol) {\n      return this;\n    }\n\n    this.options['symbol'] = symbol;\n\n    if (this._geometry) {\n      this._geometry.setSymbol(symbol);\n    }\n\n    return this;\n  };\n\n  _proto.getCurrentGeometry = function getCurrentGeometry() {\n    return this._geometry;\n  };\n\n  _proto.onAdd = function onAdd() {\n    this._checkMode();\n  };\n\n  _proto.onEnable = function onEnable() {\n    this._saveMapCfg();\n\n    this._drawToolLayer = this._getDrawLayer();\n\n    this._clearStage();\n\n    this._loadResources();\n\n    var map = this.getMap();\n\n    if (this.options['autoPanAtEdge']) {\n      this._mapAutoPanAtEdge = map.options['autoPanAtEdge'];\n\n      if (!this._mapAutoPanAtEdge) {\n        map.config({\n          autoPanAtEdge: true\n        });\n      }\n    }\n\n    this._geometryEvents = map.options['geometryEvents'];\n\n    if (this.options['blockGeometryEvents']) {\n      map.config('geometryEvents', false);\n    }\n\n    return this;\n  };\n\n  _proto.onDisable = function onDisable() {\n    var map = this.getMap();\n\n    this._restoreMapCfg();\n\n    this.endDraw();\n\n    if (this._map) {\n      map.removeLayer(this._getDrawLayer());\n\n      if (this.options['autoPanAtEdge']) {\n        if (!this._mapAutoPanAtEdge) {\n          map.config({\n            autoPanAtEdge: false\n          });\n        }\n      }\n    }\n\n    if (this.options['blockGeometryEvents']) {\n      map.config('geometryEvents', this._geometryEvents);\n    }\n\n    return this;\n  };\n\n  _proto.undo = function undo() {\n    var registerMode = this._getRegisterMode();\n\n    var action = registerMode.action;\n\n    if (!this._shouldRecordHistory(action) || !this._historyPointer) {\n      return this;\n    }\n\n    var coords = this._clickCoords.slice(0, --this._historyPointer);\n\n    registerMode.update(this.getMap().getProjection(), coords, this._geometry);\n    return this;\n  };\n\n  _proto.redo = function redo() {\n    var registerMode = this._getRegisterMode();\n\n    var action = registerMode.action;\n\n    if (!this._shouldRecordHistory(action) || isNil(this._historyPointer) || this._historyPointer === this._clickCoords.length) {\n      return this;\n    }\n\n    var coords = this._clickCoords.slice(0, ++this._historyPointer);\n\n    registerMode.update(this.getMap().getProjection(), coords, this._geometry);\n    return this;\n  };\n\n  _proto._shouldRecordHistory = function _shouldRecordHistory(actions) {\n    return Array.isArray(actions) && actions[0] === 'click' && actions[1] === 'mousemove' && actions[2] === 'dblclick';\n  };\n\n  _proto._checkMode = function _checkMode() {\n    this._getRegisterMode();\n  };\n\n  _proto._saveMapCfg = function _saveMapCfg() {\n    var map = this.getMap();\n    this._mapDoubleClickZoom = map.options['doubleClickZoom'];\n    map.config({\n      'doubleClickZoom': this.options['doubleClickZoom']\n    });\n\n    var actions = this._getRegisterMode()['action'];\n\n    var dragging = false;\n\n    for (var i = 0; i < actions.length; i++) {\n      if (actions[i].indexOf('mousedown') >= 0 || actions[i].indexOf('touchstart') >= 0) {\n        dragging = true;\n        break;\n      }\n    }\n\n    if (dragging) {\n      var _map = this.getMap();\n\n      this._mapDraggable = _map.options['draggable'];\n\n      _map.config({\n        'draggable': false\n      });\n    }\n  };\n\n  _proto._restoreMapCfg = function _restoreMapCfg() {\n    var map = this.getMap();\n    map.config({\n      'doubleClickZoom': this._mapDoubleClickZoom\n    });\n\n    if (!isNil(this._mapDraggable)) {\n      map.config('draggable', this._mapDraggable);\n    }\n\n    delete this._mapDraggable;\n    delete this._mapDoubleClickZoom;\n  };\n\n  _proto._loadResources = function _loadResources() {\n    var symbol = this.getSymbol();\n    var resources = getExternalResources(symbol);\n\n    if (resources.length > 0) {\n      this._drawToolLayer._getRenderer().loadResources(resources);\n    }\n  };\n\n  _proto._getProjection = function _getProjection() {\n    return this._map.getProjection();\n  };\n\n  _proto._getRegisterMode = function _getRegisterMode() {\n    var mode = this.getMode();\n    var registerMode = DrawTool.getRegisterMode(mode);\n\n    if (!registerMode) {\n      throw new Error(mode + ' is not a valid mode of DrawTool.');\n    }\n\n    return registerMode;\n  };\n\n  _proto.getEvents = function getEvents() {\n    var action = this._getRegisterMode()['action'];\n\n    var _events = {};\n\n    if (Array.isArray(action)) {\n      for (var i = 0; i < action.length; i++) {\n        _events[action[i]] = this._events[action[i]];\n      }\n\n      return _events;\n    }\n\n    return null;\n  };\n\n  _proto._mouseDownHandler = function _mouseDownHandler(event) {\n    this._createGeometry(event);\n  };\n\n  _proto._mouseUpHandler = function _mouseUpHandler(event) {\n    this.endDraw(event);\n  };\n\n  _proto._clickHandler = function _clickHandler(event) {\n    var registerMode = this._getRegisterMode();\n\n    if (this._clickCoords && this._clickCoords.length) {\n      var len = this._clickCoords.length;\n\n      var prjCoord = this.getMap()._pointToPrj(event['point2d']);\n\n      if (this._clickCoords[len - 1].equals(prjCoord)) {\n        return;\n      }\n    }\n\n    if (!this._geometry) {\n      this._createGeometry(event);\n    } else {\n      var _prjCoord = this.getMap()._pointToPrj(event['point2d']);\n\n      if (!isNil(this._historyPointer)) {\n        this._clickCoords = this._clickCoords.slice(0, this._historyPointer);\n      }\n\n      this._clickCoords.push(_prjCoord);\n\n      this._historyPointer = this._clickCoords.length;\n      event.drawTool = this;\n      registerMode['update'](this.getMap().getProjection(), this._clickCoords, this._geometry, event);\n\n      if (this._clickCoords.length <= 1) {\n        this._fireEvent('drawstart', event);\n      } else {\n        this._fireEvent('drawvertex', event);\n      }\n\n      if (registerMode['clickLimit'] && registerMode['clickLimit'] === this._historyPointer) {\n        this.endDraw(event);\n      }\n    }\n  };\n\n  _proto._createGeometry = function _createGeometry(event) {\n    var mode = this.getMode();\n\n    var registerMode = this._getRegisterMode();\n\n    var prjCoord = this.getMap()._pointToPrj(event['point2d']);\n\n    var symbol = this.getSymbol();\n\n    if (!this._geometry) {\n      this._clickCoords = [prjCoord];\n      event.drawTool = this;\n      this._geometry = registerMode['create'](this.getMap().getProjection(), this._clickCoords, event);\n\n      if (symbol && mode !== 'point') {\n        this._geometry.setSymbol(symbol);\n      } else if (this.options.hasOwnProperty('symbol')) {\n        this._geometry.setSymbol(this.options['symbol']);\n      }\n\n      this._addGeometryToStage(this._geometry);\n\n      this._fireEvent('drawstart', event);\n    }\n\n    if (mode === 'point') {\n      this.endDraw(event);\n    }\n  };\n\n  _proto._mouseMoveHandler = function _mouseMoveHandler(event) {\n    var map = this.getMap();\n\n    if (!this._geometry || !map || map.isInteracting()) {\n      return;\n    }\n\n    var containerPoint = this._getMouseContainerPoint(event);\n\n    if (!this._isValidContainerPoint(containerPoint)) {\n      return;\n    }\n\n    var prjCoord = this.getMap()._pointToPrj(event['point2d']);\n\n    var projection = map.getProjection();\n    event.drawTool = this;\n\n    var registerMode = this._getRegisterMode();\n\n    if (this._shouldRecordHistory(registerMode.action)) {\n      var path = this._clickCoords.slice(0, this._historyPointer);\n\n      if (path && path.length > 0 && prjCoord.equals(path[path.length - 1])) {\n        return;\n      }\n\n      registerMode['update'](projection, path.concat([prjCoord]), this._geometry, event);\n    } else {\n      registerMode['update'](projection, prjCoord, this._geometry, event);\n    }\n\n    this._fireEvent('mousemove', event);\n  };\n\n  _proto._doubleClickHandler = function _doubleClickHandler(event) {\n    if (!this._geometry) {\n      return;\n    }\n\n    var containerPoint = this._getMouseContainerPoint(event);\n\n    if (!this._isValidContainerPoint(containerPoint)) {\n      return;\n    }\n\n    var registerMode = this._getRegisterMode();\n\n    var clickCoords = this._clickCoords;\n\n    if (clickCoords.length < 2) {\n      return;\n    }\n\n    var mode = this.getMode();\n\n    if (mode && mode.indexOf('polygon') > -1 && clickCoords.length < 3) {\n      return;\n    }\n\n    var projection = this.getMap().getProjection();\n    var path = [clickCoords[0]];\n\n    for (var i = 1, len = clickCoords.length; i < len; i++) {\n      if (clickCoords[i].x !== clickCoords[i - 1].x || clickCoords[i].y !== clickCoords[i - 1].y) {\n        path.push(clickCoords[i]);\n      }\n    }\n\n    if (path.length < 2 || this._geometry && this._geometry instanceof Polygon && path.length < 3) {\n      return;\n    }\n\n    event.drawTool = this;\n    registerMode['update'](projection, path, this._geometry, event);\n    this.endDraw(event);\n  };\n\n  _proto._addGeometryToStage = function _addGeometryToStage(geometry) {\n    var drawLayer = this._getDrawLayer();\n\n    drawLayer.addGeometry(geometry);\n  };\n\n  _proto.endDraw = function endDraw(param) {\n    if (!this._geometry || this._ending) {\n      return this;\n    }\n\n    this._ending = true;\n    var geometry = this._geometry;\n\n    this._clearStage();\n\n    param = param || {};\n    this._geometry = geometry;\n\n    this._fireEvent('drawend', param);\n\n    delete this._geometry;\n\n    if (this.options['once']) {\n      this.disable();\n    }\n\n    delete this._ending;\n    delete this._historyPointer;\n    return this;\n  };\n\n  _proto._clearStage = function _clearStage() {\n    this._getDrawLayer().clear();\n\n    delete this._geometry;\n    delete this._clickCoords;\n  };\n\n  _proto._getMouseContainerPoint = function _getMouseContainerPoint(event) {\n    var action = this._getRegisterMode()['action'];\n\n    if (action[0].indexOf('mousedown') >= 0 || action[0].indexOf('touchstart') >= 0) {\n      stopPropagation(event['domEvent']);\n    }\n\n    return event['containerPoint'];\n  };\n\n  _proto._isValidContainerPoint = function _isValidContainerPoint(containerPoint) {\n    var mapSize = this._map.getSize();\n\n    var w = mapSize['width'],\n        h = mapSize['height'];\n\n    if (containerPoint.x < 0 || containerPoint.y < 0) {\n      return false;\n    } else if (containerPoint.x > w || containerPoint.y > h) {\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto._getDrawLayer = function _getDrawLayer() {\n    var drawLayerId = INTERNAL_LAYER_PREFIX + 'drawtool';\n\n    var drawToolLayer = this._map.getLayer(drawLayerId);\n\n    if (!drawToolLayer) {\n      drawToolLayer = new VectorLayer(drawLayerId, {\n        'enableSimplify': false\n      });\n\n      this._map.addLayer(drawToolLayer);\n    }\n\n    return drawToolLayer;\n  };\n\n  _proto._fireEvent = function _fireEvent(eventName, param) {\n    if (!param) {\n      param = {};\n    }\n\n    if (this._geometry) {\n      param['geometry'] = this._getRegisterMode()['generate'](this._geometry, {\n        drawTool: this\n      });\n    }\n\n    MapTool.prototype._fireEvent.call(this, eventName, param);\n  };\n\n  return DrawTool;\n}(MapTool);\n\nDrawTool.mergeOptions(options$g);\n\nvar MapBoxZoomHander = function (_Handler) {\n  _inheritsLoose(MapBoxZoomHander, _Handler);\n\n  function MapBoxZoomHander(target) {\n    var _this;\n\n    _this = _Handler.call(this, target) || this;\n    _this.drawTool = new DrawTool({\n      'mode': 'boxZoom',\n      'ignoreMouseleave': false\n    });\n    return _this;\n  }\n\n  var _proto = MapBoxZoomHander.prototype;\n\n  _proto.addHooks = function addHooks() {\n    this.target.on('_mousedown', this._onMouseDown, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    this.target.off('_mousedown', this._onMouseDown, this);\n\n    if (this.drawTool.isEnabled()) {\n      this.drawTool.remove();\n    }\n  };\n\n  _proto._onMouseDown = function _onMouseDown(param) {\n    if (!this.target.options['boxZoom']) {\n      return;\n    }\n\n    if (param.domEvent.shiftKey) {\n      this.drawTool.setSymbol(this.target.options['boxZoomSymbol']).on('drawend', this._boxZoom, this).addTo(this.target);\n    }\n  };\n\n  _proto._boxZoom = function _boxZoom(param) {\n    var map = this.target;\n    this.drawTool.remove();\n    var geometry = param.geometry,\n        center = geometry.getCenter(),\n        symbol = geometry.getSymbol(),\n        w = symbol.markerWidth,\n        h = symbol.markerHeight;\n    var extent = new Extent(center, map.locateByPoint(center, w, h), map.getProjection());\n    var zoom = map.getFitZoom(extent);\n\n    map._animateTo({\n      center: extent.getCenter(),\n      zoom: zoom\n    });\n  };\n\n  return MapBoxZoomHander;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'boxZoom': true,\n  'boxZoomSymbol': {\n    'markerType': 'rectangle',\n    'markerLineWidth': 3,\n    'markerLineColor': '#1bbc9b',\n    'markerLineDasharray': [10, 5],\n    'markerFillOpacity': 0.1,\n    'markerFill': '#1bbc9b',\n    'markerWidth': 1,\n    'markerHeight': 1\n  }\n});\nMap$1.addOnLoadHook('addHandler', 'boxZoom', MapBoxZoomHander);\n\nvar PANOFFSET = 30;\n\nvar MapAutoPanAtEdgeHandler = function (_Handler) {\n  _inheritsLoose(MapAutoPanAtEdgeHandler, _Handler);\n\n  function MapAutoPanAtEdgeHandler() {\n    return _Handler.apply(this, arguments) || this;\n  }\n\n  var _proto = MapAutoPanAtEdgeHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    if (!this.target) {\n      return;\n    }\n\n    this.target.on('_mousemove', this._onMouseMove, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    if (!this.target) {\n      return;\n    }\n\n    this.target.off('_mousemove', this._onMouseMove, this);\n  };\n\n  _proto._onMouseMove = function _onMouseMove(event) {\n    var map = this.target;\n\n    if (map.options['autoPanAtEdge']) {\n      var containerPoint = event.containerPoint;\n      var containerExtent = map.getContainerExtent();\n\n      if (containerExtent) {\n        var x = containerPoint.x,\n            y = containerPoint.y;\n        var xmax = containerExtent.xmax,\n            ymax = containerExtent.ymax;\n        var p;\n\n        if (x < PANOFFSET) {\n          p = [Math.abs(x - PANOFFSET), 0];\n        }\n\n        if (y < PANOFFSET) {\n          p = [0, Math.abs(y - PANOFFSET)];\n        }\n\n        if (x + PANOFFSET > xmax) {\n          p = [-Math.abs(x + PANOFFSET - xmax), 0];\n        }\n\n        if (y + PANOFFSET > ymax) {\n          p = [0, -Math.abs(y + PANOFFSET - ymax)];\n        }\n\n        if (p) {\n          map.panBy(p, {\n            duration: 1\n          });\n        }\n      }\n    }\n  };\n\n  return MapAutoPanAtEdgeHandler;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'autoPanAtEdge': false\n});\nMap$1.addOnLoadHook('addHandler', 'autoPanAtEdge', MapAutoPanAtEdgeHandler);\n\nMap$1.include({\n  animateTo: function animateTo(view, options, step) {\n    var _this = this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (isFunction(options)) {\n      step = options;\n      options = {};\n    }\n\n    var projection = this.getProjection(),\n        currView = this.getView(),\n        props = {};\n    var empty = true;\n\n    for (var p in view) {\n      if (hasOwn(view, p) && !isNil(view[p]) && (p === 'prjCenter' || !isNil(currView[p]))) {\n        empty = false;\n\n        if (p === 'center') {\n          var from = new Coordinate(currView[p]).toFixed(7),\n              to = new Coordinate(view[p]).toFixed(7);\n\n          if (!from.equals(to)) {\n            props['center'] = [from, to];\n          }\n        } else if (p === 'prjCenter') {\n          var _from = new Coordinate(this._getPrjCenter());\n\n          var _to = new Coordinate(view[p]);\n\n          if (!_from.equals(_to)) {\n            props['prjCenter'] = [_from, _to];\n          }\n        } else if (currView[p] !== view[p] && p !== 'around') {\n          props[p] = [currView[p], view[p]];\n        }\n      }\n    }\n\n    if (empty) {\n      return null;\n    }\n\n    if (this._animPlayer) {\n      if (this._isInternalAnimation) {\n        if (this._animPlayer.playState === 'running') {\n          this._animPlayer.pause();\n\n          this._prevAnimPlayer = this._animPlayer;\n        }\n      } else {\n        delete this._prevAnimPlayer;\n\n        this._stopAnim(this._animPlayer);\n      }\n    }\n\n    var zoomOrigin = view['around'] || new Point(this.width / 2, this.height / 2);\n\n    var renderer = this._getRenderer(),\n        framer = function framer(fn) {\n      renderer.callInNextFrame(fn);\n    };\n\n    var player = this._animPlayer = Animation.animate(props, {\n      'easing': options['easing'] || 'out',\n      'duration': options['duration'] || this.options['zoomAnimationDuration'],\n      'framer': framer\n    }, function (frame) {\n      if (_this.isRemoved()) {\n        player.finish();\n        return;\n      }\n\n      if (player.playState === 'running') {\n        if (frame.styles['center']) {\n          var center = frame.styles['center'];\n\n          _this._setPrjCenter(projection.project(center));\n\n          _this.onMoving(_this._parseEventFromCoord(_this.getCenter()));\n        } else if (frame.styles['prjCenter']) {\n          var _center = frame.styles['prjCenter'];\n\n          _this._setPrjCenter(_center);\n\n          _this.onMoving(_this._parseEventFromCoord(_this.getCenter()));\n        }\n\n        if (!isNil(frame.styles['zoom'])) {\n          _this.onZooming(frame.styles['zoom'], zoomOrigin);\n        }\n\n        if (!isNil(frame.styles['pitch'])) {\n          _this._setPitch(frame.styles['pitch']);\n        }\n\n        if (!isNil(frame.styles['bearing'])) {\n          _this._setBearing(frame.styles['bearing']);\n        }\n\n        _this._fireEvent('animating');\n      } else if (player.playState !== 'paused' || player === _this._mapAnimPlayer) {\n        if (!player._interupted) {\n          if (props['center']) {\n            _this._setPrjCenter(projection.project(props['center'][1]));\n          } else if (props['prjCenter']) {\n            _this._setPrjCenter(props['prjCenter'][1]);\n          }\n\n          if (!isNil(props['pitch'])) {\n            _this._setPitch(props['pitch'][1]);\n          }\n\n          if (!isNil(props['bearing'])) {\n            _this._setBearing(props['bearing'][1]);\n          }\n        }\n\n        _this._endAnim(player, props, zoomOrigin, options);\n      }\n\n      if (step) {\n        step(frame);\n      }\n    }, this);\n\n    this._startAnim(props, zoomOrigin);\n\n    return player;\n  },\n  _animateTo: function _animateTo(view, options, step) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (this._mapAnimPlayer) {\n      this._stopAnim(this._mapAnimPlayer);\n    }\n\n    this._isInternalAnimation = true;\n    this._mapAnimPlayer = this.animateTo(view, options, step);\n    delete this._isInternalAnimation;\n    return this._mapAnimPlayer;\n  },\n  flyTo: function flyTo(view, options, step) {\n    var _this2 = this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (this._animPlayer) {\n      if (this._isInternalAnimation) {\n        if (this._animPlayer.playState === 'running') {\n          this._animPlayer.pause();\n\n          this._prevAnimPlayer = this._animPlayer;\n        }\n      } else {\n        delete this._prevAnimPlayer;\n\n        this._stopAnim(this._animPlayer);\n      }\n    }\n\n    if (isFunction(options)) {\n      step = options;\n      options = {};\n    }\n\n    options = extend({\n      curve: 1.42\n    }, options);\n    var map = this;\n\n    function zoomScale(z0, z1) {\n      return map.getResolution(z1) / map.getResolution(z0);\n    }\n\n    var zoomOrigin = view['around'] || new Point(this.width / 2, this.height / 2);\n    var minZoom = this.getMinZoom();\n    var maxZoom = this.getMaxZoom();\n    var projection = this.getProjection();\n    var currView = this.getView();\n    var startZoom = currView.zoom;\n    var startBearing = currView.bearing;\n    var startPitch = currView.pitch;\n    var zoom = 'zoom' in view ? clamp(+view.zoom, minZoom, maxZoom) : startZoom;\n    var bearing = 'bearing' in view ? +view.bearing : startBearing;\n    var pitch = 'pitch' in view ? +view.pitch : startPitch;\n    var center = projection.project(view.center && new Coordinate(view.center) || this.getCenter());\n    var scale = zoomScale(zoom, startZoom);\n    var from = projection.project(this.getCenter());\n    var delta = center.sub(from);\n    var rho = options.curve;\n    var w0 = Math.max(this.width, this.height),\n        w1 = w0 / scale,\n        u1 = delta.mag();\n\n    if ('minZoom' in options) {\n      var animMinZoom = clamp(Math.min(options.minZoom, startZoom, zoom), minZoom, maxZoom);\n      var wMax = w0 / zoomScale(animMinZoom, startZoom);\n      rho = Math.sqrt(wMax / u1 * 2);\n    }\n\n    var rho2 = rho * rho;\n\n    function r(i) {\n      var b = (w1 * w1 - w0 * w0 + (i ? -1 : 1) * rho2 * rho2 * u1 * u1) / (2 * (i ? w1 : w0) * rho2 * u1);\n      return Math.log(Math.sqrt(b * b + 1) - b);\n    }\n\n    function sinh(n) {\n      return (Math.exp(n) - Math.exp(-n)) / 2;\n    }\n\n    function cosh(n) {\n      return (Math.exp(n) + Math.exp(-n)) / 2;\n    }\n\n    function tanh(n) {\n      return sinh(n) / cosh(n);\n    }\n\n    var r0 = r(0);\n\n    var w = function w(s) {\n      return cosh(r0) / cosh(r0 + rho * s);\n    };\n\n    var u = function u(s) {\n      return w0 * ((cosh(r0) * tanh(r0 + rho * s) - sinh(r0)) / rho2) / u1;\n    };\n\n    var S = (r(1) - r0) / rho;\n\n    if (Math.abs(u1) < 0.000001 || !isFinite(S)) {\n      if (Math.abs(w0 - w1) < 0.000001) return this.animateTo(view, options, step);\n      var k = w1 < w0 ? -1 : 1;\n      S = Math.abs(Math.log(w1 / w0)) / rho;\n\n      u = function u() {\n        return 0;\n      };\n\n      w = function w(s) {\n        return Math.exp(k * rho * s);\n      };\n    }\n\n    var renderer = this._getRenderer();\n\n    var framer = function framer(fn) {\n      renderer.callInNextFrame(fn);\n    };\n\n    var player = this._animPlayer = Animation.animate({\n      k: [0, 1]\n    }, {\n      'easing': options['easing'] || 'out',\n      'duration': options['duration'] || 8,\n      'framer': framer\n    }, function (frame) {\n      if (_this2.isRemoved()) {\n        player.finish();\n        return;\n      }\n\n      var k = frame.styles.k;\n      var s = k * S;\n      var scale = 1 / w(s);\n      var props = {};\n\n      if (view.center) {\n        var newCenter = k === 1 ? center : from.add(delta.multi(u(s)));\n        props.prjCenter = [center, newCenter];\n      }\n\n      if (startZoom !== zoom) {\n        var newZoom = k === 1 ? zoom : _this2.getZoomForScale(scale, startZoom, true);\n        props.zoom = [startZoom, newZoom];\n      }\n\n      if (startPitch !== pitch) {\n        var newPitch = interpolate$2(startPitch, pitch, k);\n        props.pitch = [pitch, newPitch];\n      }\n\n      if (startBearing !== bearing) {\n        var newBearing = interpolate$2(startBearing, bearing, k);\n        props.bearing = [bearing, newBearing];\n      }\n\n      if (player.playState === 'running') {\n        if (props['prjCenter']) {\n          var _center2 = props['prjCenter'];\n\n          _this2._setPrjCenter(_center2[1]);\n\n          _this2.onMoving(_this2._parseEventFromCoord(_this2.getCenter()));\n        }\n\n        if (props['zoom']) {\n          _this2.onZooming(props['zoom'][1], zoomOrigin);\n        }\n\n        if (props['pitch']) {\n          _this2._setPitch(props['pitch'][1]);\n        }\n\n        if (props['bearing']) {\n          _this2._setBearing(props['bearing'][1]);\n        }\n\n        _this2._fireEvent('animating');\n      } else if (player.playState !== 'paused' || player === _this2._mapAnimPlayer) {\n        if (!player._interupted) {\n          if (props['prjCenter']) {\n            _this2._setPrjCenter(props['prjCenter'][1]);\n          }\n\n          if (props['pitch']) {\n            _this2._setPitch(props['pitch'][1]);\n          }\n\n          if (props['bearing']) {\n            _this2._setBearing(props['bearing'][1]);\n          }\n        }\n\n        _this2._endAnim(player, props, zoomOrigin, options);\n      }\n\n      if (step) {\n        step(frame);\n      }\n    });\n\n    this._startAnim({\n      center: view.center,\n      zoom: view.zoom !== startZoom,\n      pitch: pitch !== startPitch,\n      bearing: bearing !== startBearing\n    }, zoomOrigin);\n\n    return this;\n  },\n  isAnimating: function isAnimating() {\n    return !!this._animPlayer;\n  },\n  isRotating: function isRotating() {\n    return this.isDragRotating() || !!this._animRotating;\n  },\n  _endAnim: function _endAnim(player, props, zoomOrigin, options) {\n    delete this._animRotating;\n    var evtType = player._interupted ? 'animateinterrupted' : 'animateend';\n\n    if (player === this._animPlayer) {\n      delete this._animPlayer;\n    }\n\n    if (player === this._mapAnimPlayer) {\n      delete this._mapAnimPlayer;\n    }\n\n    if (props['center']) {\n      var endCoord;\n\n      if (player._interupted) {\n        endCoord = this.getCenter();\n      } else {\n        endCoord = props['center'][1];\n      }\n\n      this.onMoveEnd(this._parseEventFromCoord(endCoord));\n    } else if (props['prjCenter']) {\n      var _endCoord;\n\n      if (player._interupted) {\n        _endCoord = this._getPrjCenter();\n      } else {\n        _endCoord = props['prjCenter'][1];\n      }\n\n      var event = this._parseEventFromCoord(this.getProjection().unproject(_endCoord));\n\n      event['point2d'] = this._prjToPoint(_endCoord);\n      this.onMoveEnd(event);\n    }\n\n    if (!isNil(props['zoom'])) {\n      if (player._interupted) {\n        this.onZoomEnd(this.getZoom(), zoomOrigin);\n      } else if (!options['wheelZoom']) {\n        this.onZoomEnd(props['zoom'][1], zoomOrigin);\n      } else {\n        this.onZooming(props['zoom'][1], zoomOrigin);\n      }\n    }\n\n    if (evtType) {\n      this._fireEvent(evtType);\n    }\n\n    if (!isNil(props['pitch']) && !this.getPitch()) {\n      this.getRenderer().setToRedraw();\n    }\n\n    if (!options['wheelZoom']) {\n      this._resumePrev(player);\n    }\n  },\n  _startAnim: function _startAnim(props, zoomOrigin) {\n    if (!this._animPlayer) {\n      return;\n    }\n\n    if (props['center']) {\n      this.onMoveStart();\n    }\n\n    if (props['zoom'] && !this.isZooming()) {\n      this.onZoomStart(props['zoom'][1], zoomOrigin);\n    }\n\n    if (props['pitch'] || props['bearing']) {\n      this._animRotating = true;\n    }\n\n    this._fireEvent('animatestart');\n\n    this._animPlayer.play();\n  },\n  _stopAnim: function _stopAnim(player) {\n    if (!player) {\n      return;\n    }\n\n    delete this._animRotating;\n\n    if (player.playState !== 'finished') {\n      player._interupted = true;\n      player.cancel();\n    }\n\n    if (player === this._animPlayer) {\n      delete this._animPlayer;\n    }\n\n    if (player === this._mapAnimPlayer) {\n      delete this._mapAnimPlayer;\n    }\n  },\n  _resumePrev: function _resumePrev(player) {\n    if (!this._prevAnimPlayer) {\n      return;\n    }\n\n    var prevPlayer = this._prevAnimPlayer;\n\n    if (prevPlayer.playState !== 'paused') {\n      delete this._prevAnimPlayer;\n    }\n\n    if (player !== prevPlayer) {\n      this._animPlayer = prevPlayer;\n      prevPlayer.play();\n    }\n  }\n});\n\nfunction interpolate$2(a, b, t) {\n  return a * (1 - t) + b * t;\n}\n\nvar events = 'mousedown ' + 'mouseup ' + 'mouseover ' + 'mouseout ' + 'mouseenter ' + 'mouseleave ' + 'mousemove ' + 'click ' + 'dblclick ' + 'contextmenu ' + 'keypress ' + 'touchstart ' + 'touchmove ' + 'touchend ';\nvar CLICK_TIME_THRESHOLD = 300;\nMap$1.include({\n  _registerDomEvents: function _registerDomEvents() {\n    var dom = this._panels.mapWrapper || this._containerDOM;\n    addDomEvent(dom, events, this._handleDOMEvent, this);\n  },\n  _removeDomEvents: function _removeDomEvents() {\n    var dom = this._panels.mapWrapper || this._containerDOM;\n    removeDomEvent(dom, events, this._handleDOMEvent, this);\n  },\n  _handleDOMEvent: function _handleDOMEvent(e) {\n    var type = e.type;\n    var isMouseDown = type === 'mousedown' || type === 'touchstart' && (!e.touches || e.touches.length === 1);\n\n    if (isMouseDown) {\n      this._domMouseDownTime = now();\n      this._domMouseDownView = this.getView();\n    }\n\n    var isRotating = type === 'contextmenu' && isRotatingMap(this);\n\n    if (type === 'contextmenu') {\n      preventDefault(e);\n      var downTime = this._domMouseDownTime;\n      var time = now();\n\n      if (time - downTime <= CLICK_TIME_THRESHOLD && !isRotating) {\n        this._fireDOMEvent(this, e, 'dom:' + e.type);\n      }\n    } else {\n      this._fireDOMEvent(this, e, 'dom:' + e.type);\n    }\n\n    if (this._ignoreEvent(e)) {\n      return;\n    }\n\n    var mimicClick = false;\n\n    if (isMouseDown) {\n      this._mouseDownTime = now();\n    } else if (type === 'click' || type === 'touchend' || type === 'contextmenu') {\n      if (!this._mouseDownTime) {\n        return;\n      } else {\n        var _downTime = this._mouseDownTime;\n        delete this._mouseDownTime;\n\n        var _time = now();\n\n        if (_time - _downTime > CLICK_TIME_THRESHOLD) {\n          if (type === 'click' || type === 'contextmenu') {\n            return;\n          }\n        } else if (type === 'contextmenu') {\n          if (isRotating) {\n            return;\n          }\n        } else if (type === 'touchend') {\n          mimicClick = true;\n        }\n      }\n    }\n\n    var mimicEvent;\n\n    if (mimicClick) {\n      if (this._clickTime && now() - this._clickTime <= CLICK_TIME_THRESHOLD) {\n        delete this._clickTime;\n        mimicEvent = 'dblclick';\n\n        this._fireDOMEvent(this, e, 'dom:dblclick');\n      } else {\n        this._clickTime = now();\n        mimicEvent = 'click';\n\n        this._fireDOMEvent(this, e, 'dom:click');\n      }\n    }\n\n    if (this._ignoreEvent(e)) {\n      return;\n    }\n\n    this._fireDOMEvent(this, e, type);\n\n    if (mimicEvent) {\n      this._fireDOMEvent(this, e, mimicEvent);\n    }\n  },\n  _ignoreEvent: function _ignoreEvent(domEvent) {\n    if (!domEvent || !this._panels.control) {\n      return false;\n    }\n\n    if (this._isEventOutMap(domEvent)) {\n      return true;\n    }\n\n    var target = domEvent.srcElement || domEvent.target;\n    var preTarget;\n\n    if (target) {\n      while (target && target !== this._containerDOM) {\n        if (target.className && target.className.indexOf && (target.className.indexOf('maptalks-control') >= 0 || target.className.indexOf('maptalks-ui') >= 0 && preTarget && !preTarget['eventsPropagation'])) {\n          return true;\n        }\n\n        preTarget = target;\n        target = target.parentNode;\n      }\n    }\n\n    return false;\n  },\n  _isEventOutMap: function _isEventOutMap(domEvent) {\n    if (this.getPitch() > this.options['maxVisualPitch']) {\n      var actualEvent = this._getActualEvent(domEvent);\n\n      var eventPos = getEventContainerPoint(actualEvent, this._containerDOM);\n\n      if (!this.getContainerExtent().contains(eventPos)) {\n        return true;\n      }\n    }\n\n    return false;\n  },\n  _parseEvent: function _parseEvent(e, type) {\n    if (!e) {\n      return null;\n    }\n\n    var eventParam = {\n      'domEvent': e\n    };\n\n    if (type !== 'keypress') {\n      var actual = this._getActualEvent(e);\n\n      if (actual) {\n        var containerPoint = getEventContainerPoint(actual, this._containerDOM);\n        eventParam = extend(eventParam, {\n          'containerPoint': containerPoint,\n          'viewPoint': this.containerPointToViewPoint(containerPoint)\n        });\n        var maxVisualPitch = this.options['maxVisualPitch'];\n\n        if (this.getPitch() <= maxVisualPitch || containerPoint.y >= this.height - this._getVisualHeight(maxVisualPitch)) {\n          eventParam = extend(eventParam, {\n            'coordinate': this.containerPointToCoord(containerPoint),\n            'point2d': this._containerPointToPoint(containerPoint)\n          });\n        }\n      }\n    }\n\n    return eventParam;\n  },\n  _parseEventFromCoord: function _parseEventFromCoord(coord) {\n    var containerPoint = this.coordToContainerPoint(coord),\n        viewPoint = this.containerPointToViewPoint(containerPoint);\n    var e = {\n      'coordinate': coord,\n      'containerPoint': containerPoint,\n      'viewPoint': viewPoint,\n      'point2d': this.coordToPoint(coord)\n    };\n    return e;\n  },\n  _getActualEvent: function _getActualEvent(e) {\n    return e.touches && e.touches.length > 0 ? e.touches[0] : e.changedTouches && e.changedTouches.length > 0 ? e.changedTouches[0] : e;\n  },\n  _fireDOMEvent: function _fireDOMEvent(target, e, type) {\n    if (this.isRemoved()) {\n      return;\n    }\n\n    var eventParam = this._parseEvent(e, type);\n\n    this._fireEvent(type, eventParam);\n  }\n});\nMap$1.addOnLoadHook('_registerDomEvents');\n\nfunction isRotatingMap(map) {\n  if (!map._domMouseDownView) {\n    return true;\n  }\n\n  var view = map.getView(),\n      mouseDownView = map._domMouseDownView;\n  return view.bearing !== mouseDownView.bearing || view.pitch !== mouseDownView.pitch;\n}\n\nMap$1.include({\n  isFullScreen: function isFullScreen() {\n    return !!(document.webkitIsFullScreen || document.mozFullScreen || document.msFullscreenElement || document.fullscreenElement);\n  },\n  requestFullScreen: function requestFullScreen(dom) {\n    this._fireEvent('fullscreenstart');\n\n    this._requestFullScreen(dom || this._containerDOM);\n\n    this._fireEvent('fullscreenend');\n\n    return this;\n  },\n  cancelFullScreen: function cancelFullScreen() {\n    this._cancelFullScreen();\n\n    this._fireEvent('cancelfullscreen');\n\n    return this;\n  },\n  _requestFullScreen: function _requestFullScreen(dom) {\n    if (dom.requestFullscreen) {\n      dom.requestFullscreen();\n    } else if (dom.mozRequestFullScreen) {\n      dom.mozRequestFullScreen();\n    } else if (dom.webkitRequestFullScreen) {\n      dom.webkitRequestFullScreen();\n    } else if (dom.msRequestFullScreen) {\n      dom.msRequestFullScreen();\n    } else {\n      var features = 'fullscreen=1,status=no,resizable=yes,top=0,left=0,scrollbars=no,' + 'titlebar=no,menubar=no,location=no,toolbar=no,z-look=yes,' + 'width=' + (screen.availWidth - 8) + ',height=' + (screen.availHeight - 45);\n      var newWin = window.open(location.href, '_blank', features);\n\n      if (newWin !== null) {\n        window.opener = null;\n        window.close();\n      }\n    }\n  },\n  _cancelFullScreen: function _cancelFullScreen() {\n    if (document.exitFullscreen) {\n      document.exitFullscreen();\n    } else if (document.mozCancelFullScreen) {\n      document.mozCancelFullScreen();\n    } else if (document.webkitCancelFullScreen) {\n      document.webkitCancelFullScreen();\n    } else {\n      var features = 'fullscreen=no,status=yes,resizable=yes,scrollbars=no,' + 'titlebar=no,menubar=yes,location=yes,toolbar=yes,z-look=yes';\n      var newWin = window.open(location.href, '_blank', features);\n\n      if (newWin !== null) {\n        window.opener = null;\n        window.close();\n      }\n    }\n  }\n});\n\nMap$1.include({\n  panTo: function panTo(coordinate, options, step) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (!coordinate) {\n      return this;\n    }\n\n    if (isFunction(options)) {\n      step = options;\n      options = {};\n    }\n\n    coordinate = new Coordinate(coordinate);\n\n    if (typeof options['animation'] === 'undefined' || options['animation']) {\n      var prjCoord = this.getProjection().project(coordinate);\n      return this._panAnimation(prjCoord, options['duration'], step);\n    } else {\n      this.setCenter(coordinate);\n    }\n\n    return this;\n  },\n  _panTo: function _panTo(prjCoord, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (typeof options['animation'] === 'undefined' || options['animation']) {\n      return this._panAnimation(prjCoord, options['duration']);\n    } else {\n      this.onMoveStart();\n\n      this._setPrjCenter(prjCoord);\n\n      this.onMoveEnd(this._parseEventFromCoord(this.getCenter()));\n      return this;\n    }\n  },\n  panBy: function panBy(offset, options, step) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (!offset) {\n      return this;\n    }\n\n    if (isFunction(options)) {\n      step = options;\n      options = {};\n    }\n\n    offset = new Point(offset);\n    var containerExtent = this.getContainerExtent();\n    var ymin = containerExtent.ymin;\n\n    if (ymin > 0 && offset.y > 30) {\n      var y = offset.y;\n      offset.y = 30;\n      offset.x = offset.x * 30 / y;\n      console.warn('offset is limited to panBy when pitch is above maxPitch');\n    }\n\n    this.onMoveStart();\n\n    if (typeof options['animation'] === 'undefined' || options['animation']) {\n      offset = offset.multi(-1);\n\n      var target = this._containerPointToPrj(new Point(this.width / 2 + offset.x, this.height / 2 + offset.y));\n\n      this._panAnimation(target, options['duration'], step);\n    } else {\n      this._offsetCenterByPixel(offset);\n\n      this.onMoveEnd(this._parseEventFromCoord(this.getCenter()));\n    }\n\n    return this;\n  },\n  _panAnimation: function _panAnimation(target, t, cb) {\n    return this._animateTo({\n      'prjCenter': target\n    }, {\n      'duration': t || this.options['panAnimationDuration']\n    }, cb);\n  }\n});\n\nGeometry.fromJSON = function (json) {\n  if (Array.isArray(json)) {\n    var result = [];\n\n    for (var i = 0, len = json.length; i < len; i++) {\n      var c = Geometry.fromJSON(json[i]);\n\n      if (Array.isArray(json)) {\n        result = result.concat(c);\n      } else {\n        result.push(c);\n      }\n    }\n\n    return result;\n  }\n\n  if (json && !json['feature']) {\n    return GeoJSON.toGeometry(json);\n  }\n\n  var geometry;\n\n  if (json['subType']) {\n    geometry = Geometry.getJSONClass(json['subType']).fromJSON(json);\n\n    if (!isNil(json['feature']['id'])) {\n      geometry.setId(json['feature']['id']);\n    }\n  } else {\n    geometry = GeoJSON.toGeometry(json['feature']);\n\n    if (json['options']) {\n      geometry.config(json['options']);\n    }\n  }\n\n  if (json['symbol']) {\n    geometry.setSymbol(json['symbol']);\n  }\n\n  if (json['infoWindow']) {\n    geometry.setInfoWindow(json['infoWindow']);\n  }\n\n  return geometry;\n};\n\nLayer.fromJSON = function (layerJSON) {\n  if (!layerJSON) {\n    return null;\n  }\n\n  var layerType = layerJSON['type'];\n  var clazz = Layer.getJSONClass(layerType);\n\n  if (!clazz || !clazz.fromJSON) {\n    throw new Error('unsupported layer type:' + layerType);\n  }\n\n  return clazz.fromJSON(layerJSON);\n};\n\nMap$1.include({\n  'JSON_VERSION': '1.0',\n  toJSON: function toJSON(options) {\n    if (!options) {\n      options = {};\n    }\n\n    var json = {\n      'jsonVersion': this['JSON_VERSION'],\n      'version': this.VERSION,\n      'extent': this.getExtent().toJSON()\n    };\n    json['options'] = this.config();\n    json['options']['center'] = this.getCenter();\n    json['options']['zoom'] = this.getZoom();\n    json['options']['bearing'] = this.getBearing();\n    json['options']['pitch'] = this.getPitch();\n    var baseLayer = this.getBaseLayer();\n\n    if ((isNil(options['baseLayer']) || options['baseLayer']) && baseLayer) {\n      json['baseLayer'] = baseLayer.toJSON(options['baseLayer']);\n    }\n\n    var extraLayerOptions = {};\n\n    if (options['clipExtent']) {\n      if (options['clipExtent'] === true) {\n        extraLayerOptions['clipExtent'] = this.getExtent();\n      } else {\n        extraLayerOptions['clipExtent'] = options['clipExtent'];\n      }\n    }\n\n    var layersJSON = [];\n\n    if (isNil(options['layers']) || options['layers'] && !Array.isArray(options['layers'])) {\n      var layers = this.getLayers();\n\n      for (var i = 0, len = layers.length; i < len; i++) {\n        if (!layers[i].toJSON) {\n          continue;\n        }\n\n        var opts = extend({}, isObject(options['layers']) ? options['layers'] : {}, extraLayerOptions);\n        layersJSON.push(layers[i].toJSON(opts));\n      }\n\n      json['layers'] = layersJSON;\n    } else if (isArrayHasData(options['layers'])) {\n      var _layers = options['layers'];\n\n      for (var _i = 0; _i < _layers.length; _i++) {\n        var exportOption = _layers[_i];\n        var layer = this.getLayer(exportOption['id']);\n\n        if (!layer.toJSON) {\n          continue;\n        }\n\n        var _opts = extend({}, exportOption['options'], extraLayerOptions);\n\n        layersJSON.push(layer.toJSON(_opts));\n      }\n\n      json['layers'] = layersJSON;\n    } else {\n      json['layers'] = [];\n    }\n\n    return json;\n  }\n});\n\nMap$1.fromJSON = function (container, profile, options) {\n  if (!container || !profile) {\n    return null;\n  }\n\n  if (!options) {\n    options = {};\n  }\n\n  var map = new Map$1(container, profile['options']);\n\n  if (isNil(options['baseLayer']) || options['baseLayer']) {\n    var baseLayer = Layer.fromJSON(profile['baseLayer']);\n\n    if (baseLayer) {\n      map.setBaseLayer(baseLayer);\n    }\n  }\n\n  if (isNil(options['layers']) || options['layers']) {\n    var layers = [];\n    var layerJSONs = profile['layers'];\n\n    for (var i = 0; i < layerJSONs.length; i++) {\n      var layer = Layer.fromJSON(layerJSONs[i]);\n      layers.push(layer);\n    }\n\n    map.addLayer(layers);\n  }\n\n  return map;\n};\n\nMap$1.include({\n  computeLength: function computeLength(coord1, coord2) {\n    if (!this.getProjection()) {\n      return null;\n    }\n\n    var p1 = new Coordinate(coord1),\n        p2 = new Coordinate(coord2);\n\n    if (p1.equals(p2)) {\n      return 0;\n    }\n\n    return this.getProjection().measureLength(p1, p2);\n  },\n  computeGeometryLength: function computeGeometryLength(geometry) {\n    return geometry._computeGeodesicLength(this.getProjection());\n  },\n  computeGeometryArea: function computeGeometryArea(geometry) {\n    return geometry._computeGeodesicArea(this.getProjection());\n  },\n  identify: function identify(opts, callback) {\n    opts = opts || {};\n    var coordinate = new Coordinate(opts['coordinate']);\n    return this._identify(opts, callback, function (layer) {\n      return layer.identify(coordinate, opts);\n    });\n  },\n  identifyAtPoint: function identifyAtPoint(opts, callback) {\n    opts = opts || {};\n    var containerPoint = new Point(opts['containerPoint']);\n    var coordinate = this.containerPointToCoord(containerPoint);\n    return this._identify(opts, callback, function (layer) {\n      if (layer.identifyAtPoint) {\n        return layer.identifyAtPoint(containerPoint, opts);\n      } else if (coordinate) {\n        return layer.identify(coordinate, opts);\n      } else {\n        return [];\n      }\n    });\n  },\n  _identify: function _identify(opts, callback, fn) {\n    var reqLayers = opts['layers'];\n\n    if (!isArrayHasData(reqLayers)) {\n      return this;\n    }\n\n    var layers = [];\n\n    for (var i = 0, len = reqLayers.length; i < len; i++) {\n      if (isString(reqLayers[i])) {\n        layers.push(this.getLayer(reqLayers[i]));\n      } else {\n        layers.push(reqLayers[i]);\n      }\n    }\n\n    var hits = [];\n\n    for (var _i = layers.length - 1; _i >= 0; _i--) {\n      if (opts['count'] && hits.length >= opts['count']) {\n        break;\n      }\n\n      var layer = layers[_i];\n\n      if (!layer || !layer.getMap() || !opts['includeInvisible'] && !layer.isVisible() || !opts['includeInternals'] && layer.getId().indexOf(INTERNAL_LAYER_PREFIX) >= 0) {\n        continue;\n      }\n\n      var layerHits = fn(layer);\n\n      if (layerHits) {\n        if (Array.isArray(layerHits)) {\n          pushIn(hits, layerHits);\n        } else {\n          hits.push(layerHits);\n        }\n      }\n    }\n\n    callback.call(this, hits);\n    return this;\n  }\n});\n\nMap$1.include({\n  _zoom: function _zoom(nextZoom, origin) {\n    if (!this.options['zoomable'] || this.isZooming()) {\n      return;\n    }\n\n    origin = this._checkZoomOrigin(origin);\n    nextZoom = this._checkZoom(nextZoom);\n    this.onZoomStart(nextZoom, origin);\n    this._frameZoom = this.getZoom();\n    this.onZoomEnd(nextZoom, origin);\n  },\n  _zoomAnimation: function _zoomAnimation(nextZoom, origin, startScale) {\n    if (!this.options['zoomable'] || this.isZooming()) {\n      return;\n    }\n\n    nextZoom = this._checkZoom(nextZoom);\n\n    if (this.getZoom() === nextZoom) {\n      return;\n    }\n\n    origin = this._checkZoomOrigin(origin);\n\n    this._startZoomAnim(nextZoom, origin, startScale);\n  },\n  _checkZoomOrigin: function _checkZoomOrigin(origin) {\n    if (!origin || this.options['zoomInCenter']) {\n      origin = new Point(this.width / 2, this.height / 2);\n    }\n\n    if (this.options['zoomOrigin']) {\n      origin = new Point(this.options['zoomOrigin']);\n    }\n\n    return origin;\n  },\n  _startZoomAnim: function _startZoomAnim(nextZoom, origin, startScale) {\n    if (isNil(startScale)) {\n      startScale = 1;\n    }\n\n    var endScale = this._getResolution(this._startZoomVal) / this._getResolution(nextZoom);\n\n    var duration = this.options['zoomAnimationDuration'] * Math.abs(endScale - startScale) / Math.abs(endScale - 1);\n    this._frameZoom = this._startZoomVal;\n\n    this._animateTo({\n      'zoom': nextZoom,\n      'around': origin\n    }, {\n      'continueOnViewChanged': true,\n      'duration': duration\n    });\n  },\n  onZoomStart: function onZoomStart(nextZoom, origin) {\n    if (!this.options['zoomable'] || this.isZooming()) {\n      return;\n    }\n\n    if (this._mapAnimPlayer) {\n      this._stopAnim(this._mapAnimPlayer);\n    }\n\n    this._zooming = true;\n    this._startZoomVal = this.getZoom();\n    this._startZoomCoord = this._containerPointToPrj(origin);\n\n    this._fireEvent('zoomstart', {\n      'from': this._startZoomVal,\n      'to': nextZoom\n    });\n  },\n  onZooming: function onZooming(nextZoom, origin, startScale) {\n    if (!this.options['zoomable']) {\n      return;\n    }\n\n    var frameZoom = this._frameZoom;\n\n    if (frameZoom === nextZoom) {\n      return;\n    }\n\n    if (isNil(startScale)) {\n      startScale = 1;\n    }\n\n    this._zoomTo(nextZoom, origin);\n\n    var res = this.getResolution(nextZoom),\n        fromRes = this.getResolution(this._startZoomVal),\n        scale = fromRes / res / startScale,\n        startPoint = this._prjToContainerPoint(this._startZoomCoord, this._startZoomVal);\n\n    var offset = this.getViewPoint();\n\n    if (!this.isRotating() && !startPoint.equals(origin) && scale !== 1) {\n      var pitch = this.getPitch();\n\n      var originOffset = startPoint._sub(origin)._multi(1 / (1 - scale));\n\n      if (pitch) {\n        originOffset.y /= Math.cos(pitch * Math.PI / 180);\n      }\n\n      origin = origin.add(originOffset);\n    }\n\n    var matrix = {\n      'view': [scale, 0, 0, scale, (origin.x - offset.x) * (1 - scale), (origin.y - offset.y) * (1 - scale)]\n    };\n    var dpr = this.getDevicePixelRatio();\n\n    if (dpr !== 1) {\n      origin = origin.multi(dpr);\n    }\n\n    matrix['container'] = [scale, 0, 0, scale, origin.x * (1 - scale), origin.y * (1 - scale)];\n\n    this._fireEvent('zooming', {\n      'from': this._startZoomVal,\n      'to': nextZoom,\n      'origin': origin,\n      'matrix': matrix\n    });\n\n    this._frameZoom = nextZoom;\n  },\n  onZoomEnd: function onZoomEnd(nextZoom, origin) {\n    if (!this.options['zoomable']) {\n      return;\n    }\n\n    var startZoomVal = this._startZoomVal;\n\n    this._zoomTo(nextZoom, origin);\n\n    this._zooming = false;\n\n    this._getRenderer().onZoomEnd();\n\n    this._fireEvent('zoomend', {\n      'from': startZoomVal,\n      'to': nextZoom\n    });\n\n    if (!this._verifyExtent(this._getPrjCenter())) {\n      this._panTo(this._prjMaxExtent.getCenter());\n    }\n  },\n  _zoomTo: function _zoomTo(nextZoom, origin) {\n    this._zoomLevel = nextZoom;\n\n    this._calcMatrices();\n\n    if (origin) {\n      this._setPrjCoordAtContainerPoint(this._startZoomCoord, origin);\n    }\n  },\n  _checkZoom: function _checkZoom(nextZoom) {\n    var maxZoom = this.getMaxZoom(),\n        minZoom = this.getMinZoom();\n\n    if (nextZoom < minZoom) {\n      nextZoom = minZoom;\n    }\n\n    if (nextZoom > maxZoom) {\n      nextZoom = maxZoom;\n    }\n\n    return nextZoom;\n  }\n});\n\nfunction perspective(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf = 1 / (near - far);\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 2 * far * near * nf;\n  out[15] = 0;\n  return out;\n}\nfunction translate(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2],\n      a00,\n      a01,\n      a02,\n      a03,\n      a10,\n      a11,\n      a12,\n      a13,\n      a20,\n      a21,\n      a22,\n      a23;\n\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n\n  return out;\n}\nfunction scale(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\nfunction rotateX(out, a, rad) {\n  var s = Math.sin(rad),\n      c = Math.cos(rad),\n      a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7],\n      a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n\n  if (a !== out) {\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\nfunction rotateZ(out, a, rad) {\n  var s = Math.sin(rad),\n      c = Math.cos(rad),\n      a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3],\n      a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n\n  if (a !== out) {\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\nfunction multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3],\n      a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7],\n      a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11],\n      a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\nfunction invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3],\n      a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7],\n      a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11],\n      a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15],\n      b00 = a00 * a11 - a01 * a10,\n      b01 = a00 * a12 - a02 * a10,\n      b02 = a00 * a13 - a03 * a10,\n      b03 = a01 * a12 - a02 * a11,\n      b04 = a01 * a13 - a03 * a11,\n      b05 = a02 * a13 - a03 * a12,\n      b06 = a20 * a31 - a21 * a30,\n      b07 = a20 * a32 - a22 * a30,\n      b08 = a20 * a33 - a23 * a30,\n      b09 = a21 * a32 - a22 * a31,\n      b10 = a21 * a33 - a23 * a31,\n      b11 = a22 * a33 - a23 * a32,\n      det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\nfunction identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\nfunction copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n\nfunction set$2(out, x, y, z) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\nfunction add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\nfunction subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\nfunction length(a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  return Math.sqrt(x * x + y * y + z * z);\n}\nfunction normalize(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var len = x * x + y * y + z * z;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    out[0] = a[0] * len;\n    out[1] = a[1] * len;\n    out[2] = a[2] * len;\n  }\n\n  return out;\n}\nfunction dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\nfunction scale$1(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\nfunction cross(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      bx = b[0],\n      by = b[1],\n      bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\nfunction distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return Math.hypot ? Math.hypot(x, y, z) : hypot(x, y, z);\n}\nfunction transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  w = w || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n  return out;\n}\n\nfunction hypot() {\n  var y = 0;\n  var i = arguments.length;\n\n  while (i--) {\n    y += arguments[i] * arguments[i];\n  }\n\n  return Math.sqrt(y);\n}\n\nfunction applyMatrix(out, v, e) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  var w = 1 / (e[3] * x + e[7] * y + e[11] * z + e[15]);\n  out[0] = (e[0] * x + e[4] * y + e[8] * z + e[12]) * w;\n  out[1] = (e[1] * x + e[5] * y + e[9] * z + e[13]) * w;\n  out[2] = (e[2] * x + e[6] * y + e[10] * z + e[14]) * w;\n  return out;\n}\nfunction matrixToQuaternion(out, te) {\n  var m11 = te[0],\n      m12 = te[4],\n      m13 = te[8],\n      m21 = te[1],\n      m22 = te[5],\n      m23 = te[9],\n      m31 = te[2],\n      m32 = te[6],\n      m33 = te[10],\n      trace = m11 + m22 + m33;\n  var s;\n\n  if (trace > 0) {\n    s = 0.5 / Math.sqrt(trace + 1.0);\n    out.w = 0.25 / s;\n    out.x = (m32 - m23) * s;\n    out.y = (m13 - m31) * s;\n    out.z = (m21 - m12) * s;\n  } else if (m11 > m22 && m11 > m33) {\n    s = 2.0 * Math.sqrt(1.0 + m11 - m22 - m33);\n    out.w = (m32 - m23) / s;\n    out.x = 0.25 * s;\n    out.y = (m12 + m21) / s;\n    out.z = (m13 + m31) / s;\n  } else if (m22 > m33) {\n    s = 2.0 * Math.sqrt(1.0 + m22 - m11 - m33);\n    out.w = (m13 - m31) / s;\n    out.x = (m12 + m21) / s;\n    out.y = 0.25 * s;\n    out.z = (m23 + m32) / s;\n  } else {\n    s = 2.0 * Math.sqrt(1.0 + m33 - m11 - m22);\n    out.w = (m21 - m12) / s;\n    out.x = (m13 + m31) / s;\n    out.y = (m23 + m32) / s;\n    out.z = 0.25 * s;\n  }\n\n  return this;\n}\nfunction quaternionToMatrix(out, q) {\n  var te = out;\n  var x = q.x,\n      y = q.y,\n      z = q.z,\n      w = q.w;\n  var x2 = x + x,\n      y2 = y + y,\n      z2 = z + z;\n  var xx = x * x2,\n      xy = x * y2,\n      xz = x * z2;\n  var yy = y * y2,\n      yz = y * z2,\n      zz = z * z2;\n  var wx = w * x2,\n      wy = w * y2,\n      wz = w * z2;\n  te[0] = 1 - (yy + zz);\n  te[4] = xy - wz;\n  te[8] = xz + wy;\n  te[1] = xy + wz;\n  te[5] = 1 - (xx + zz);\n  te[9] = yz - wx;\n  te[2] = xz - wy;\n  te[6] = yz + wx;\n  te[10] = 1 - (xx + yy);\n  te[3] = 0;\n  te[7] = 0;\n  te[11] = 0;\n  te[12] = 0;\n  te[13] = 0;\n  te[14] = 0;\n  te[15] = 1;\n  return te;\n}\nfunction setPosition(out, v) {\n  var te = out;\n  te[12] = v[0];\n  te[13] = v[1];\n  te[14] = v[2];\n  return out;\n}\nfunction lookAt(te, eye, target, up) {\n  var x = [0, 0, 0];\n  var y = [0, 0, 0];\n  var z = [0, 0, 0];\n  subtract(z, eye, target);\n\n  if (length(z) === 0) {\n    z[2] = 1;\n  }\n\n  normalize(z, z);\n  cross(x, up, z);\n\n  if (length(z) === 0) {\n    if (Math.abs(up[2]) === 1) {\n      z[0] += 0.0001;\n    } else {\n      z[2] += 0.0001;\n    }\n\n    normalize(z, z);\n    cross(x, up, z);\n  }\n\n  normalize(x, x);\n  cross(y, z, x);\n  te[0] = x[0];\n  te[4] = y[0];\n  te[8] = z[0];\n  te[1] = x[1];\n  te[5] = y[1];\n  te[9] = z[1];\n  te[2] = x[2];\n  te[6] = y[2];\n  te[10] = z[2];\n  return te;\n}\n\nvar RADIAN$1 = Math.PI / 180;\nvar DEFAULT_FOV = 0.6435011087932844;\nvar TEMP_COORD$1 = new Coordinate(0, 0);\nMap$1.include({\n  getFov: function getFov() {\n    if (!this._fov) {\n      this._fov = DEFAULT_FOV;\n    }\n\n    return this._fov / RADIAN$1;\n  },\n  setFov: function setFov(fov) {\n    if (this.isZooming()) {\n      return this;\n    }\n\n    fov = Math.max(0.01, Math.min(60, fov));\n    if (this._fov === fov) return this;\n    var from = this.getFov();\n    this._fov = fov * RADIAN$1;\n\n    this._calcMatrices();\n\n    this._renderLayers();\n\n    this._fireEvent('fovchange', {\n      'from': from,\n      'to': this.getFov()\n    });\n\n    return this;\n  },\n  getBearing: function getBearing() {\n    if (!this._angle) {\n      return 0;\n    }\n\n    return -this._angle / RADIAN$1;\n  },\n  setBearing: function setBearing(bearing) {\n    if (this._mapAnimPlayer) {\n      this._stopAnim(this._mapAnimPlayer);\n    }\n\n    return this._setBearing(bearing);\n  },\n  _setBearing: function _setBearing(bearing) {\n    if (Browser$1.ie9) {\n      throw new Error('map can\\'t rotate in IE9.');\n    }\n\n    var b = -wrap(bearing, -180, 180) * RADIAN$1;\n    if (this._angle === b) return this;\n    var from = this.getBearing();\n\n    this._fireEvent('rotatestart', {\n      'from': from,\n      'to': b\n    });\n\n    this._angle = b;\n\n    this._calcMatrices();\n\n    this._renderLayers();\n\n    this._fireEvent('rotate', {\n      'from': from,\n      'to': b\n    });\n\n    this._fireEvent('rotateend', {\n      'from': from,\n      'to': b\n    });\n\n    return this;\n  },\n  getPitch: function getPitch() {\n    if (!this._pitch) {\n      return 0;\n    }\n\n    return this._pitch / Math.PI * 180;\n  },\n  setPitch: function setPitch(pitch) {\n    if (this._mapAnimPlayer) {\n      this._stopAnim(this._mapAnimPlayer);\n    }\n\n    return this._setPitch(pitch);\n  },\n  _setPitch: function _setPitch(pitch) {\n    if (Browser$1.ie9) {\n      throw new Error('map can\\'t tilt in IE9.');\n    }\n\n    var p = clamp(pitch, 0, this.options['maxPitch']) * RADIAN$1;\n    if (this._pitch === p) return this;\n    var from = this.getPitch();\n\n    this._fireEvent('pitchstart', {\n      'from': from,\n      'to': p\n    });\n\n    this._pitch = p;\n\n    this._calcMatrices();\n\n    this._renderLayers();\n\n    this._fireEvent('pitch', {\n      'from': from,\n      'to': p\n    });\n\n    this._fireEvent('pitchend', {\n      'from': from,\n      'to': p\n    });\n\n    return this;\n  },\n  isTransforming: function isTransforming() {\n    return !!(this._pitch || this._angle);\n  },\n  getFrustumAltitude: function getFrustumAltitude() {\n    return this._frustumAltitude;\n  },\n  _calcFrustumAltitude: function _calcFrustumAltitude() {\n    var pitch = 90 - this.getPitch();\n    var fov = this.getFov() / 2;\n    var cameraAlt = this.cameraPosition ? this.cameraPosition[2] : 0;\n\n    if (fov <= pitch) {\n      return cameraAlt;\n    }\n\n    fov = Math.PI * fov / 180;\n    var d1 = new Point(this.cameraPosition).distanceTo(new Point(this.cameraLookAt)),\n        d2 = cameraAlt * Math.tan(fov * 2);\n    var d = Math.tan(fov) * (d1 + d2);\n    return cameraAlt + d;\n  },\n  _pointToContainerPoint: function _pointToContainerPoint(point, zoom, altitude, out) {\n    if (altitude === void 0) {\n      altitude = 0;\n    }\n\n    var res = this._getResolution(zoom);\n\n    return this._pointAtResToContainerPoint(point, res, altitude, out);\n  },\n  _pointAtResToContainerPoint: function _pointAtResToContainerPoint(point, res, altitude, out) {\n    if (altitude === void 0) {\n      altitude = 0;\n    }\n\n    if (!out) {\n      out = new Point(0, 0);\n    }\n\n    point = this._pointAtResToPoint(point, res, out);\n    var isTransforming = this.isTransforming();\n\n    var scale$$1 = res / this._getResolution();\n\n    var centerPoint;\n\n    if (!isTransforming && !altitude) {\n      centerPoint = this._prjToPoint(this._getPrjCenter(), undefined, TEMP_COORD$1);\n    }\n\n    this._toContainerPoint(out, isTransforming, scale$$1, altitude, centerPoint);\n\n    return out;\n  },\n  _pointsAtResToContainerPoints: function _pointsAtResToContainerPoints(points, targetRes, altitudes, resultPoints) {\n    if (altitudes === void 0) {\n      altitudes = [];\n    }\n\n    if (resultPoints === void 0) {\n      resultPoints = [];\n    }\n\n    var pitch = this.getPitch(),\n        bearing = this.getBearing();\n\n    if (pitch === 0 && bearing === 0) {\n      var _this$_get2DExtent = this._get2DExtent(),\n          xmin = _this$_get2DExtent.xmin,\n          ymin = _this$_get2DExtent.ymin,\n          xmax = _this$_get2DExtent.xmax,\n          ymax = _this$_get2DExtent.ymax;\n\n      if (xmax > xmin && ymax > ymin) {\n        var _res = targetRes / this._getResolution();\n\n        var _this$getSize = this.getSize(),\n            width = _this$getSize.width,\n            height = _this$getSize.height;\n\n        var dxPerPixel = (xmax - xmin) / width,\n            dyPerPixel = (ymax - ymin) / height;\n\n        for (var i = 0, len = points.length; i < len; i++) {\n          if (!points[i]) {\n            resultPoints[i] = null;\n            continue;\n          }\n\n          var pt = resultPoints[i];\n          pt.x = points[i].x;\n          pt.y = points[i].y;\n\n          pt._multi(_res);\n\n          pt.x = (pt.x - xmin) * dxPerPixel;\n          pt.y = height - (pt.y - ymin) * dyPerPixel;\n        }\n\n        return resultPoints;\n      }\n    }\n\n    var altitudeIsArray = Array.isArray(altitudes);\n    var isTransforming = this.isTransforming();\n\n    var res = targetRes / this._getResolution();\n\n    var centerPoint = this._prjToPoint(this._getPrjCenter(), undefined, TEMP_COORD$1);\n\n    for (var _i = 0, _len = points.length; _i < _len; _i++) {\n      if (!points[_i]) {\n        resultPoints[_i] = null;\n        continue;\n      }\n\n      var _pt = resultPoints[_i];\n      _pt.x = points[_i].x;\n      _pt.y = points[_i].y;\n\n      _pt._multi(res);\n\n      var altitude = altitudeIsArray ? altitudes[_i] || 0 : altitudes;\n\n      this._toContainerPoint(_pt, isTransforming, res, altitude, centerPoint);\n    }\n\n    return resultPoints;\n  },\n  _toContainerPoint: function () {\n    var a = [0, 0, 0];\n    return function (out, isTransforming, res, altitude, centerPoint) {\n      var w2 = this.width / 2,\n          h2 = this.height / 2;\n\n      if (isTransforming || altitude) {\n        altitude *= res;\n        var _scale = this._glScale;\n        set$2(a, out.x * _scale, out.y * _scale, altitude * _scale);\n\n        var t = this._projIfBehindCamera(a, this.cameraPosition, this.cameraForward);\n\n        applyMatrix(t, t, this.projViewMatrix);\n        out.x = t[0] * w2 + w2;\n        out.y = -(t[1] * h2) + h2;\n      } else {\n        out._sub(centerPoint.x, centerPoint.y);\n\n        out.set(out.x, -out.y);\n\n        out._add(w2, h2);\n      }\n    };\n  }(),\n  _projIfBehindCamera: function () {\n    var vectorFromCam = new Array(3);\n    var proj = new Array(3);\n    var sub = new Array(3);\n    return function (position, cameraPos, camForward) {\n      subtract(vectorFromCam, position, cameraPos);\n      var camNormDot = dot(camForward, vectorFromCam);\n\n      if (camNormDot <= 0) {\n        scale$1(proj, camForward, camNormDot * 1.01);\n        add(position, cameraPos, subtract(sub, vectorFromCam, proj));\n      }\n\n      return position;\n    };\n  }(),\n  _containerPointToPoint: function _containerPointToPoint(p, zoom, out) {\n    var res = this._getResolution(zoom);\n\n    return this._containerPointToPointAtRes(p, res, out);\n  },\n  _containerPointToPointAtRes: function () {\n    var cp = [0, 0, 0],\n        coord0 = [0, 0, 0, 1],\n        coord1 = [0, 0, 0, 1];\n    return function (p, res, out) {\n      if (this.isTransforming()) {\n        var w2 = this.width / 2 || 1,\n            h2 = this.height / 2 || 1;\n        set$2(cp, (p.x - w2) / w2, (h2 - p.y) / h2, 0);\n        set$2(coord0, cp[0], cp[1], 0);\n        set$2(coord1, cp[0], cp[1], 1);\n        coord0[3] = coord1[3] = 1;\n        applyMatrix(coord0, coord0, this.projViewMatrixInverse);\n        applyMatrix(coord1, coord1, this.projViewMatrixInverse);\n        var x0 = coord0[0];\n        var x1 = coord1[0];\n        var y0 = coord0[1];\n        var y1 = coord1[1];\n        var z0 = coord0[2];\n        var z1 = coord1[2];\n        var t = z0 === z1 ? 0 : (0 - z0) / (z1 - z0);\n\n        var _x = interpolate(x0, x1, t);\n\n        var _y = interpolate(y0, y1, t);\n\n        if (out) {\n          out.x = _x;\n          out.y = _y;\n        } else {\n          out = new Point(_x, _y);\n        }\n\n        out._multi(1 / this._glScale);\n\n        return this._getResolution() === res ? out : this._pointToPointAtRes(out, res, out);\n      }\n\n      var centerPoint = this._prjToPointAtRes(this._getPrjCenter(), res, out),\n          scale$$1 = this._getResolution() / res;\n\n      var x = scale$$1 * (p.x - this.width / 2),\n          y = scale$$1 * (p.y - this.height / 2);\n      return centerPoint._add(x, -y);\n    };\n  }(),\n  _calcMatrices: function () {\n    var m1 = createMat4();\n    return function () {\n      delete this._mapRes;\n      delete this._mapGlRes;\n      delete this._mapExtent2D;\n      delete this._mapGlExtent2D;\n      var size = this.getSize();\n      var w = size.width || 1,\n          h = size.height || 1;\n      this._glScale = this.getGLScale();\n\n      var worldMatrix = this._getCameraWorldMatrix();\n\n      var fov = this.getFov() * Math.PI / 180;\n\n      var farZ = this._getCameraFar(fov, this.getPitch());\n\n      this.cameraFar = farZ;\n      this.cameraNear = this.cameraCenterDistance / 20;\n      var projMatrix = this.projMatrix || createMat4();\n      perspective(projMatrix, fov, w / h, this.cameraNear, farZ);\n      this.projMatrix = projMatrix;\n      this.viewMatrix = invert(this.viewMatrix || createMat4(), worldMatrix);\n      this.projViewMatrix = multiply(this.projViewMatrix || createMat4(), projMatrix, this.viewMatrix);\n\n      this._calcCascadeMatrixes();\n\n      this.projViewMatrixInverse = multiply(this.projViewMatrixInverse || createMat4(), worldMatrix, invert(m1, projMatrix));\n      this.domCssMatrix = this._calcDomMatrix();\n      this._frustumAltitude = this._calcFrustumAltitude();\n      this._mapRes = this._getResolution();\n      this._mapGlRes = this.getGLRes();\n      this._mapExtent2D = this._get2DExtent();\n      this._mapGlExtent2D = this._get2DExtentAtRes(this._mapGlRes);\n    };\n  }(),\n  _getCameraFar: function _getCameraFar(fov, pitch) {\n    var cameraCenterDistance = this.cameraCenterDistance = distance(this.cameraPosition, this.cameraLookAt);\n    var farZ = cameraCenterDistance;\n    var y = 4 * cameraCenterDistance;\n\n    if (pitch > 0) {\n      pitch = pitch * Math.PI / 180;\n\n      if (2 / Math.PI - pitch > fov / 2) {\n        var tanFov = Math.tan(fov / 2);\n        var tanP = Math.tan(pitch);\n        y = Math.max(cameraCenterDistance * tanFov / (1 / tanP - tanFov), y);\n      }\n    }\n\n    farZ += y;\n    return farZ + 1.0;\n  },\n  _calcCascadeMatrixes: function () {\n    var projMatrix = createMat4();\n\n    function cal(curPitch, pitch, out) {\n      var w = this.width;\n      var h = this.height;\n      var fov = this.getFov() * Math.PI / 180;\n\n      var farZ = this._getCameraFar(fov, pitch);\n\n      var cameraCenterDistance = this.cameraCenterDistance;\n      farZ = cameraCenterDistance + (farZ - cameraCenterDistance) / Math.cos((90 - pitch) * Math.PI / 180) * Math.cos((90 - curPitch) * Math.PI / 180);\n      perspective(projMatrix, fov, w / h, 0.1, farZ);\n      var viewMatrix = this.viewMatrix;\n      return multiply(out, projMatrix, viewMatrix);\n    }\n\n    return function () {\n      var pitch = this.getPitch();\n      var cascadePitch0 = this.options['cascadePitches'][0];\n      var cascadePitch1 = this.options['cascadePitches'][1];\n      var projViewMatrix0 = this.cascadeFrustumMatrix0 = this.cascadeFrustumMatrix0 || createMat4();\n      var projViewMatrix1 = this.cascadeFrustumMatrix1 = this.cascadeFrustumMatrix1 || createMat4();\n\n      if (pitch > cascadePitch0) {\n        cal.call(this, pitch, cascadePitch0, projViewMatrix0);\n      } else {\n        copy(this.cascadeFrustumMatrix0, this.projViewMatrix);\n      }\n\n      if (pitch > cascadePitch1) {\n        cal.call(this, pitch, cascadePitch1, projViewMatrix1);\n      } else {\n        copy(this.cascadeFrustumMatrix1, this.cascadeFrustumMatrix0);\n      }\n    };\n  }(),\n  _calcDomMatrix: function () {\n    var m = createMat4(),\n        m1 = createMat4(),\n        minusY = [1, -1, 1],\n        arr = [0, 0, 0];\n    return function () {\n      var width = this.width || 1;\n      var height = this.height || 1;\n      var cameraToCenterDistance = 0.5 / Math.tan(this._fov / 2) * height;\n      scale(m, this.projMatrix, minusY);\n      translate(m, m, set$2(arr, 0, 0, -cameraToCenterDistance));\n\n      if (this._pitch) {\n        rotateX(m, m, this._pitch);\n      }\n\n      if (this._angle) {\n        rotateZ(m, m, this._angle);\n      }\n\n      identity(m1);\n      scale(m1, m1, set$2(arr, width / 2, -height / 2, 1));\n      return multiply(this.domCssMatrix || createMat4(), m1, m);\n    };\n  }(),\n  _getFovZ: function _getFovZ(zoom) {\n    var scale$$1 = this.getGLScale(zoom);\n\n    var ratio = this._getFovRatio();\n\n    return scale$$1 * (this.height || 1) / 2 / ratio;\n  },\n  _getCameraWorldMatrix: function () {\n    var q = {};\n    return function () {\n      var glRes = this.getGLRes();\n\n      var center2D = this._prjToPointAtRes(this._prjCenter, glRes);\n\n      this.cameraLookAt = set$2(this.cameraLookAt || [0, 0, 0], center2D.x, center2D.y, 0);\n      var pitch = this.getPitch() * RADIAN$1;\n      var bearing = this.getBearing() * RADIAN$1;\n\n      var z = this._getFovZ();\n\n      var cz = z * Math.cos(pitch);\n      var dist = Math.sin(pitch) * z;\n      var cx = center2D.x - dist * Math.sin(bearing);\n      var cy = center2D.y - dist * Math.cos(bearing);\n      this.cameraPosition = set$2(this.cameraPosition || [0, 0, 0], cx, cy, cz);\n      this.cameraToCenterDistance = distance(this.cameraPosition, this.cameraLookAt);\n      var d = dist || 1;\n      var up = this.cameraUp = set$2(this.cameraUp || [0, 0, 0], Math.sin(bearing) * d, Math.cos(bearing) * d, 0);\n      var m = this.cameraWorldMatrix = this.cameraWorldMatrix || createMat4();\n      lookAt(m, this.cameraPosition, this.cameraLookAt, up);\n      var cameraForward = this.cameraForward || [0, 0, 0];\n      subtract(cameraForward, this.cameraLookAt, this.cameraPosition);\n      this.cameraForward = normalize(cameraForward, cameraForward);\n      matrixToQuaternion(q, m);\n      quaternionToMatrix(m, q);\n      setPosition(m, this.cameraPosition);\n      return m;\n    };\n  }(),\n  _getFovRatio: function _getFovRatio() {\n    var fov = this.getFov();\n    return Math.tan(fov / 2 * RADIAN$1);\n  },\n  _renderLayers: function _renderLayers() {\n    if (this.isInteracting()) {\n      return;\n    }\n\n    var layers = this._getLayers();\n\n    layers.forEach(function (layer) {\n      if (!layer) {\n        return;\n      }\n\n      var renderer = layer._getRenderer();\n\n      if (renderer && renderer.setToRedraw) {\n        renderer.setToRedraw();\n      }\n    });\n  }\n});\n\nfunction createMat4() {\n  return identity(new Array(16));\n}\n\nMap$1.include({\n  _onViewChange: function _onViewChange(view) {\n    if (!this._viewHistory) {\n      this._viewHistory = [];\n      this._viewHistoryPointer = 0;\n    }\n\n    var old = this._getCurrentView();\n\n    for (var i = this._viewHistory.length - 1; i >= 0; i--) {\n      if (equalMapView(view, this._viewHistory[i])) {\n        this._viewHistoryPointer = i;\n\n        this._fireViewChange(old, view);\n\n        return;\n      }\n    }\n\n    if (this._viewHistoryPointer < this._viewHistory.length - 1) {\n      this._viewHistory.splice(this._viewHistoryPointer + 1);\n    }\n\n    this._viewHistory.push(view);\n\n    var count = this.options['viewHistoryCount'];\n\n    if (count > 0 && this._viewHistory.length > count) {\n      this._viewHistory.splice(0, this._viewHistory.length - count);\n    }\n\n    this._viewHistoryPointer = this._viewHistory.length - 1;\n\n    this._fireViewChange(old, view);\n  },\n  zoomToPreviousView: function zoomToPreviousView(options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (!this.hasPreviousView()) {\n      return null;\n    }\n\n    var view = this._viewHistory[--this._viewHistoryPointer];\n\n    this._zoomToView(view, options);\n\n    return view;\n  },\n  hasPreviousView: function hasPreviousView() {\n    if (!this._viewHistory || this._viewHistoryPointer === 0) {\n      return false;\n    }\n\n    return true;\n  },\n  zoomToNextView: function zoomToNextView(options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (!this.hasNextView()) {\n      return null;\n    }\n\n    var view = this._viewHistory[++this._viewHistoryPointer];\n\n    this._zoomToView(view, options);\n\n    return view;\n  },\n  hasNextView: function hasNextView() {\n    if (!this._viewHistory || this._viewHistoryPointer === this._viewHistory.length - 1) {\n      return false;\n    }\n\n    return true;\n  },\n  _zoomToView: function _zoomToView(view, options) {\n    var _this = this;\n\n    var old = this.getView();\n\n    if (options['animation']) {\n      this._animateTo(view, {\n        'duration': options['duration']\n      }, function (frame) {\n        if (frame.state.playState === 'finished') {\n          _this._fireViewChange(old, view);\n        }\n      });\n    } else {\n      this.setView(view);\n\n      this._fireViewChange(old, view);\n    }\n  },\n  getViewHistory: function getViewHistory() {\n    return this._viewHistory;\n  },\n  _fireViewChange: function _fireViewChange(old, view) {\n    this._fireEvent('viewchange', {\n      'old': old,\n      'new': view\n    });\n  },\n  _getCurrentView: function _getCurrentView() {\n    if (!this._viewHistory) {\n      return null;\n    }\n\n    return this._viewHistory[this._viewHistoryPointer];\n  }\n});\nMap$1.mergeOptions({\n  'viewHistory': true,\n  'viewHistoryCount': 10\n});\n\nMap$1.include({\n  getCollisionIndex: function getCollisionIndex() {\n    if (!this._collisionIndex) {\n      this.createCollisionIndex();\n    }\n\n    return this._collisionIndex || this.createCollisionIndex();\n  },\n  createCollisionIndex: function createCollisionIndex() {\n    this.clearCollisionIndex();\n    this._collisionIndex = new CollisionIndex();\n    return this._collisionIndex;\n  },\n  clearCollisionIndex: function clearCollisionIndex() {\n    this.collisionFrameTime = 0;\n\n    if (this._collisionIndex) {\n      this._collisionIndex.clear();\n    }\n\n    return this;\n  }\n});\n\nvar options$h = {\n  'mode': 'LineString',\n  'language': 'zh-CN',\n  'metric': true,\n  'imperial': false,\n  'symbol': {\n    'lineColor': '#000',\n    'lineWidth': 3,\n    'lineOpacity': 1\n  },\n  'vertexSymbol': {\n    'markerType': 'ellipse',\n    'markerFill': '#fff',\n    'markerLineColor': '#000',\n    'markerLineWidth': 3,\n    'markerWidth': 11,\n    'markerHeight': 11\n  },\n  'labelOptions': {\n    'textSymbol': {\n      'textFaceName': 'monospace',\n      'textLineSpacing': 1,\n      'textHorizontalAlignment': 'right',\n      'textDx': 15\n    },\n    'boxStyle': {\n      'padding': [6, 2],\n      'symbol': {\n        'markerType': 'square',\n        'markerFill': '#fff',\n        'markerFillOpacity': 0.9,\n        'markerLineColor': '#b4b3b3'\n      }\n    }\n  },\n  'clearButtonSymbol': [{\n    'markerType': 'square',\n    'markerFill': '#fff',\n    'markerLineColor': '#b4b3b3',\n    'markerLineWidth': 2,\n    'markerWidth': 15,\n    'markerHeight': 15,\n    'markerDx': 20\n  }, {\n    'markerType': 'x',\n    'markerWidth': 10,\n    'markerHeight': 10,\n    'markerDx': 20\n  }]\n};\n\nvar DistanceTool = function (_DrawTool) {\n  _inheritsLoose(DistanceTool, _DrawTool);\n\n  function DistanceTool(options) {\n    var _this;\n\n    _this = _DrawTool.call(this, options) || this;\n\n    _this.on('enable', _this._afterEnable, _assertThisInitialized(_assertThisInitialized(_this))).on('disable', _this._afterDisable, _assertThisInitialized(_assertThisInitialized(_this)));\n\n    _this._measureLayers = [];\n    return _this;\n  }\n\n  var _proto = DistanceTool.prototype;\n\n  _proto.clear = function clear() {\n    if (isArrayHasData(this._measureLayers)) {\n      for (var i = 0; i < this._measureLayers.length; i++) {\n        this._measureLayers[i].remove();\n      }\n    }\n\n    delete this._lastMeasure;\n    delete this._lastVertex;\n    this._measureLayers = [];\n    return this;\n  };\n\n  _proto.getMeasureLayers = function getMeasureLayers() {\n    return this._measureLayers;\n  };\n\n  _proto.getLastMeasure = function getLastMeasure() {\n    if (!this._lastMeasure) {\n      return 0;\n    }\n\n    return this._lastMeasure;\n  };\n\n  _proto.undo = function undo() {\n    _DrawTool.prototype.undo.call(this);\n\n    var pointer = this._historyPointer;\n\n    if (pointer !== this._vertexes.length) {\n      for (var i = pointer; i < this._vertexes.length; i++) {\n        if (this._vertexes[i].label) {\n          this._vertexes[i].label.remove();\n        }\n\n        this._vertexes[i].marker.remove();\n      }\n    }\n\n    return this;\n  };\n\n  _proto.redo = function redo() {\n    _DrawTool.prototype.redo.call(this);\n\n    var i = this._historyPointer - 1;\n\n    if (this._vertexes[i]) {\n      if (!this._vertexes[i].marker.getLayer()) {\n        if (this._vertexes[i].label) {\n          this._vertexes[i].label.addTo(this._measureMarkerLayer);\n        }\n\n        this._vertexes[i].marker.addTo(this._measureMarkerLayer);\n      }\n    }\n\n    return this;\n  };\n\n  _proto._measure = function _measure(toMeasure) {\n    var map = this.getMap();\n    var length;\n\n    if (toMeasure instanceof Geometry) {\n      length = map.computeGeometryLength(toMeasure);\n    } else if (Array.isArray(toMeasure)) {\n      length = map.getProjection().measureLength(toMeasure);\n    }\n\n    this._lastMeasure = length;\n    var units;\n\n    if (this.options['language'] === 'zh-CN') {\n      units = [' 米', ' 公里', ' 英尺', ' 英里'];\n    } else {\n      units = [' m', ' km', ' feet', ' mile'];\n    }\n\n    var content = '';\n\n    if (this.options['metric']) {\n      content += length < 1000 ? length.toFixed(0) + units[0] : (length / 1000).toFixed(2) + units[1];\n    }\n\n    if (this.options['imperial']) {\n      length *= 3.2808399;\n\n      if (content.length > 0) {\n        content += '\\n';\n      }\n\n      content += length < 5280 ? length.toFixed(0) + units[2] : (length / 5280).toFixed(2) + units[3];\n    }\n\n    return content;\n  };\n\n  _proto._registerMeasureEvents = function _registerMeasureEvents() {\n    this.on('drawstart', this._msOnDrawStart, this).on('drawvertex', this._msOnDrawVertex, this).on('mousemove', this._msOnMouseMove, this).on('drawend', this._msOnDrawEnd, this);\n  };\n\n  _proto._afterEnable = function _afterEnable() {\n    this._registerMeasureEvents();\n  };\n\n  _proto._afterDisable = function _afterDisable() {\n    this.off('drawstart', this._msOnDrawStart, this).off('drawvertex', this._msOnDrawVertex, this).off('mousemove', this._msOnMouseMove, this).off('drawend', this._msOnDrawEnd, this);\n  };\n\n  _proto._msOnDrawStart = function _msOnDrawStart(param) {\n    var map = this.getMap();\n\n    var prjCoord = map._pointToPrj(param['point2d']);\n\n    var uid = UID();\n    var layerId = 'distancetool_' + uid;\n    var markerLayerId = 'distancetool_markers_' + uid;\n\n    if (!map.getLayer(layerId)) {\n      this._measureLineLayer = new VectorLayer(layerId).addTo(map);\n      this._measureMarkerLayer = new VectorLayer(markerLayerId).addTo(map);\n    } else {\n      this._measureLineLayer = map.getLayer(layerId);\n      this._measureMarkerLayer = map.getLayer(markerLayerId);\n    }\n\n    this._measureLayers.push(this._measureLineLayer);\n\n    this._measureLayers.push(this._measureMarkerLayer);\n\n    var marker = new Marker(param['coordinate'], {\n      'symbol': this.options['vertexSymbol']\n    });\n\n    marker._setPrjCoordinates(prjCoord);\n\n    var content = this.options['language'] === 'zh-CN' ? '起点' : 'start';\n    var startLabel = new Label(content, param['coordinate'], this.options['labelOptions']);\n\n    startLabel._setPrjCoordinates(prjCoord);\n\n    this._lastVertex = startLabel;\n\n    this._addVertexMarker(marker, startLabel);\n  };\n\n  _proto._msOnMouseMove = function _msOnMouseMove(param) {\n    var ms = this._measure(this._msGetCoordsToMeasure(param));\n\n    if (!this._tailMarker) {\n      var symbol = extendSymbol(this.options['vertexSymbol']);\n      symbol['markerWidth'] /= 2;\n      symbol['markerHeight'] /= 2;\n      this._tailMarker = new Marker(param['coordinate'], {\n        'symbol': symbol\n      }).addTo(this._measureMarkerLayer);\n      this._tailLabel = new Label(ms, param['coordinate'], this.options['labelOptions']).addTo(this._measureMarkerLayer);\n    }\n\n    var prjCoords = this._geometry._getPrjCoordinates();\n\n    var lastCoord = prjCoords[prjCoords.length - 1];\n\n    this._tailMarker.setCoordinates(param['coordinate']);\n\n    this._tailMarker._setPrjCoordinates(lastCoord);\n\n    this._tailLabel.setContent(ms);\n\n    this._tailLabel.setCoordinates(param['coordinate']);\n\n    this._tailLabel._setPrjCoordinates(lastCoord);\n  };\n\n  _proto._msGetCoordsToMeasure = function _msGetCoordsToMeasure(param) {\n    return param['geometry'].getCoordinates().concat([param['coordinate']]);\n  };\n\n  _proto._msOnDrawVertex = function _msOnDrawVertex(param) {\n    var prjCoords = this._geometry._getPrjCoordinates();\n\n    var lastCoord = prjCoords[prjCoords.length - 1];\n    var geometry = param['geometry'];\n    var marker = new Marker(param['coordinate'], {\n      'symbol': this.options['vertexSymbol']\n    });\n\n    var length = this._measure(geometry);\n\n    var vertexLabel = new Label(length, param['coordinate'], this.options['labelOptions']);\n\n    this._addVertexMarker(marker, vertexLabel);\n\n    vertexLabel._setPrjCoordinates(lastCoord);\n\n    marker._setPrjCoordinates(lastCoord);\n\n    this._lastVertex = vertexLabel;\n  };\n\n  _proto._addVertexMarker = function _addVertexMarker(marker, vertexLabel) {\n    if (!this._vertexes) {\n      this._vertexes = [];\n    }\n\n    if (this._historyPointer !== undefined && this._vertexes.length > this._historyPointer - 1) {\n      this._vertexes.length = this._historyPointer - 1;\n    }\n\n    this._vertexes.push({\n      label: vertexLabel,\n      marker: marker\n    });\n\n    this._measureMarkerLayer.addGeometry(marker);\n\n    if (vertexLabel) {\n      this._measureMarkerLayer.addGeometry(vertexLabel);\n    }\n  };\n\n  _proto._msOnDrawEnd = function _msOnDrawEnd(param) {\n    this._clearTailMarker();\n\n    if (param['geometry']._getPrjCoordinates().length < 2) {\n      this._lastMeasure = 0;\n\n      this._clearMeasureLayers();\n\n      return;\n    }\n\n    var size = this._lastVertex.getSize();\n\n    if (!size) {\n      size = new Size(10, 10);\n    }\n\n    this._addClearMarker(this._lastVertex.getCoordinates(), this._lastVertex._getPrjCoordinates(), size['width']);\n\n    var geo = param['geometry'].copy();\n\n    geo._setPrjCoordinates(param['geometry']._getPrjCoordinates());\n\n    geo.addTo(this._measureLineLayer);\n    this._lastMeasure = geo.getLength();\n  };\n\n  _proto._addClearMarker = function _addClearMarker(coordinates, prjCoord, dx) {\n    var symbol = this.options['clearButtonSymbol'];\n    var dxSymbol = {\n      'markerDx': (symbol['markerDx'] || 0) + dx,\n      'textDx': (symbol['textDx'] || 0) + dx\n    };\n\n    if (Array.isArray(symbol)) {\n      dxSymbol = symbol.map(function (s) {\n        if (s) {\n          return {\n            'markerDx': (s['markerDx'] || 0) + dx,\n            'textDx': (s['textDx'] || 0) + dx\n          };\n        }\n\n        return null;\n      });\n    }\n\n    symbol = extendSymbol(symbol, dxSymbol);\n    var endMarker = new Marker(coordinates, {\n      'symbol': symbol\n    });\n    var measureLineLayer = this._measureLineLayer,\n        measureMarkerLayer = this._measureMarkerLayer;\n    endMarker.on('click', function () {\n      measureLineLayer.remove();\n      measureMarkerLayer.remove();\n      return false;\n    }, this);\n    endMarker.addTo(this._measureMarkerLayer);\n\n    endMarker._setPrjCoordinates(prjCoord);\n  };\n\n  _proto._clearTailMarker = function _clearTailMarker() {\n    if (this._tailMarker) {\n      this._tailMarker.remove();\n\n      delete this._tailMarker;\n    }\n\n    if (this._tailLabel) {\n      this._tailLabel.remove();\n\n      delete this._tailLabel;\n    }\n  };\n\n  _proto._clearMeasureLayers = function _clearMeasureLayers() {\n    this._measureLineLayer.remove();\n\n    this._measureMarkerLayer.remove();\n  };\n\n  return DistanceTool;\n}(DrawTool);\n\nDistanceTool.mergeOptions(options$h);\n\nvar options$i = {\n  'mode': 'Polygon',\n  'symbol': {\n    'lineColor': '#000000',\n    'lineWidth': 2,\n    'lineOpacity': 1,\n    'lineDasharray': '',\n    'polygonFill': '#ffffff',\n    'polygonOpacity': 0.5\n  }\n};\n\nvar AreaTool = function (_DistanceTool) {\n  _inheritsLoose(AreaTool, _DistanceTool);\n\n  function AreaTool(options) {\n    var _this;\n\n    _this = _DistanceTool.call(this, options) || this;\n\n    _this.on('enable', _this._afterEnable, _assertThisInitialized(_assertThisInitialized(_this))).on('disable', _this._afterDisable, _assertThisInitialized(_assertThisInitialized(_this)));\n\n    _this._measureLayers = [];\n    return _this;\n  }\n\n  var _proto = AreaTool.prototype;\n\n  _proto._measure = function _measure(toMeasure) {\n    var map = this.getMap();\n    var area;\n\n    if (toMeasure instanceof Geometry) {\n      area = map.computeGeometryArea(toMeasure);\n    } else if (Array.isArray(toMeasure)) {\n      area = map.getProjection().measureArea(toMeasure);\n    }\n\n    this._lastMeasure = area;\n    var units;\n\n    if (this.options['language'] === 'zh-CN') {\n      units = [' 平方米', ' 平方公里', ' 平方英尺', ' 平方英里'];\n    } else {\n      units = [' sq.m', ' sq.km', ' sq.ft', ' sq.mi'];\n    }\n\n    var content = '';\n\n    if (this.options['metric']) {\n      content += area < 1E6 ? area.toFixed(0) + units[0] : (area / 1E6).toFixed(2) + units[1];\n    }\n\n    if (this.options['imperial']) {\n      area *= 3.2808399;\n\n      if (content.length > 0) {\n        content += '\\n';\n      }\n\n      var sqmi = 5280 * 5280;\n      content += area < sqmi ? area.toFixed(0) + units[2] : (area / sqmi).toFixed(2) + units[3];\n    }\n\n    return content;\n  };\n\n  _proto._msGetCoordsToMeasure = function _msGetCoordsToMeasure(param) {\n    return param['geometry'].getShell().concat([param['coordinate']]);\n  };\n\n  _proto._msOnDrawVertex = function _msOnDrawVertex(param) {\n    var prjCoord = this.getMap()._pointToPrj(param['point2d']);\n\n    var vertexMarker = new Marker(param['coordinate'], {\n      'symbol': this.options['vertexSymbol']\n    });\n\n    vertexMarker._setPrjCoordinates(prjCoord);\n\n    this._measure(param['geometry']);\n\n    this._lastVertex = vertexMarker;\n\n    this._addVertexMarker(vertexMarker);\n  };\n\n  _proto._msOnDrawEnd = function _msOnDrawEnd(param) {\n    this._clearTailMarker();\n\n    var prjCoord;\n\n    if (param['point2d']) {\n      prjCoord = this.getMap()._pointToPrj(param['point2d']);\n    } else {\n      var prjCoords = param['geometry']._getPrjCoordinates();\n\n      prjCoords = prjCoords.slice(0, prjCoords.length - 1);\n\n      param['geometry']._setPrjCoordinates(prjCoords);\n\n      prjCoord = prjCoords[prjCoords.length - 1];\n    }\n\n    if (param['geometry']._getPrjCoordinates().length < 3) {\n      this._lastMeasure = 0;\n\n      this._clearMeasureLayers();\n\n      return;\n    }\n\n    var ms = this._measure(param['geometry']);\n\n    var projection = this.getMap().getProjection();\n    var coord = projection.unproject(prjCoord);\n    var endLabel = new Label(ms, coord, this.options['labelOptions']).addTo(this._measureMarkerLayer);\n\n    endLabel._setPrjCoordinates(prjCoord);\n\n    var size = endLabel.getSize();\n\n    if (!size) {\n      size = new Size(10, 10);\n    }\n\n    this._addClearMarker(coord, prjCoord, size['width']);\n\n    var geo = param['geometry'].copy();\n\n    geo._setPrjCoordinates(param['geometry']._getPrjCoordinates());\n\n    geo.addTo(this._measureLineLayer);\n    this._lastMeasure = geo.getArea();\n  };\n\n  return AreaTool;\n}(DistanceTool);\n\nAreaTool.mergeOptions(options$i);\n\nvar circleHooks = {\n  'create': function create(projection, prjCoord) {\n    var center = projection.unproject(prjCoord[0]);\n    var circle = new Circle(center, 0);\n\n    circle._setPrjCoordinates(prjCoord[0]);\n\n    return circle;\n  },\n  'update': function update(projection, prjPath, geometry) {\n    var map = geometry.getMap();\n    var prjCoord = Array.isArray(prjPath) ? prjPath[prjPath.length - 1] : prjPath;\n    var nextCoord = projection.unproject(prjCoord);\n    var radius = map.computeLength(geometry.getCenter(), nextCoord);\n    geometry.setRadius(radius);\n  },\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n};\nDrawTool.registerMode('circle', extend({\n  'clickLimit': 2,\n  'action': ['click', 'mousemove', 'click']\n}, circleHooks));\nDrawTool.registerMode('freeHandCircle', extend({\n  'action': ['mousedown touchstart', 'mousemove touchmove', 'mouseup touchend']\n}, circleHooks));\nvar ellipseHooks = {\n  'create': function create(projection, prjCoord) {\n    var center = projection.unproject(prjCoord[0]);\n    var ellipse = new Ellipse(center, 0, 0);\n\n    ellipse._setPrjCoordinates(prjCoord[0]);\n\n    return ellipse;\n  },\n  'update': function update(projection, prjPath, geometry) {\n    var map = geometry.getMap();\n    var center = geometry.getCenter();\n    var prjCoord = Array.isArray(prjPath) ? prjPath[prjPath.length - 1] : prjPath;\n    var nextCoord = projection.unproject(prjCoord);\n    var rx = map.computeLength(center, new Coordinate({\n      x: nextCoord.x,\n      y: center.y\n    }));\n    var ry = map.computeLength(center, new Coordinate({\n      x: center.x,\n      y: nextCoord.y\n    }));\n    geometry.setWidth(rx * 2);\n    geometry.setHeight(ry * 2);\n  },\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n};\nDrawTool.registerMode('ellipse', extend({\n  'clickLimit': 2,\n  'action': ['click', 'mousemove', 'click']\n}, ellipseHooks));\nDrawTool.registerMode('freeHandEllipse', extend({\n  'action': ['mousedown touchstart', 'mousemove touchmove', 'mouseup touchend']\n}, ellipseHooks));\nvar rectangleHooks = {\n  'create': function create(projection, prjCoords) {\n    var rect = new Polygon([]);\n    rect._firstClick = prjCoords[0];\n    return rect;\n  },\n  'update': function update(projection, prjCoords, geometry, param) {\n    var map = geometry.getMap();\n    var containerPoint = param['containerPoint'];\n\n    var firstClick = map._prjToContainerPoint(geometry._firstClick);\n\n    var ring = [[firstClick.x, firstClick.y], [containerPoint.x, firstClick.y], [containerPoint.x, containerPoint.y], [firstClick.x, containerPoint.y]];\n    geometry.setCoordinates(ring.map(function (c) {\n      return map.containerPointToCoord(new Point(c));\n    }));\n\n    geometry._setPrjCoordinates(ring.map(function (c) {\n      return map._containerPointToPrj(new Point(c));\n    }));\n  },\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n};\nDrawTool.registerMode('rectangle', extend({\n  'clickLimit': 2,\n  'action': ['click', 'mousemove', 'click']\n}, rectangleHooks));\nDrawTool.registerMode('freeHandRectangle', extend({\n  'action': ['mousedown touchstart', 'mousemove touchmove', 'mouseup touchend']\n}, rectangleHooks));\nDrawTool.registerMode('point', {\n  'clickLimit': 1,\n  'action': ['click'],\n  'create': function create(projection, prjCoord) {\n    var center = projection.unproject(prjCoord[0]);\n    var marker = new Marker(center);\n\n    marker._setPrjCoordinates(prjCoord[0]);\n\n    return marker;\n  },\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n});\nvar polygonHooks = {\n  'create': function create(projection, prjPath) {\n    var path = prjPath.map(function (c) {\n      return projection.unproject(c);\n    });\n    var line = new LineString(path);\n\n    line._setPrjCoordinates(prjPath);\n\n    return line;\n  },\n  'update': function update(projection, path, geometry) {\n    var symbol = geometry.getSymbol();\n    var prjCoords;\n\n    if (Array.isArray(path)) {\n      prjCoords = path;\n    } else {\n      prjCoords = geometry._getPrjCoordinates();\n      prjCoords.push(path);\n    }\n\n    var coordinates = prjCoords.map(function (c) {\n      return projection.unproject(c);\n    });\n    geometry.setCoordinates(coordinates);\n\n    geometry._setPrjCoordinates(prjCoords);\n\n    var layer = geometry.getLayer();\n\n    if (layer) {\n      var polygon = layer.getGeometryById('polygon');\n\n      if (!polygon && prjCoords.length >= 3) {\n        polygon = new Polygon([coordinates], {\n          'id': 'polygon'\n        });\n\n        if (symbol) {\n          var pSymbol = extendSymbol(symbol, {\n            'lineOpacity': 0\n          });\n          polygon.setSymbol(pSymbol);\n        }\n\n        polygon.addTo(layer);\n      }\n\n      if (polygon) {\n        polygon._setPrjCoordinates(prjCoords);\n      }\n    }\n  },\n  'generate': function generate(geometry) {\n    var polygon = new Polygon(geometry.getCoordinates(), {\n      'symbol': geometry.getSymbol()\n    });\n\n    polygon._setPrjCoordinates(geometry._getPrjCoordinates());\n\n    polygon._projCode = geometry._projCode;\n    return polygon;\n  }\n};\nDrawTool.registerMode('polygon', extend({\n  'action': ['click', 'mousemove', 'dblclick']\n}, polygonHooks));\nDrawTool.registerMode('freeHandPolygon', extend({\n  'action': ['mousedown touchstart', 'mousemove touchmove', 'mouseup touchend']\n}, polygonHooks));\nvar lineStringHooks = {\n  'create': function create(projection, prjPath) {\n    var path = prjPath.map(function (c) {\n      return projection.unproject(c);\n    });\n    var line = new LineString(path);\n\n    line._setPrjCoordinates(prjPath);\n\n    return line;\n  },\n  'update': function update(projection, prjPath, geometry) {\n    var prjCoords;\n\n    if (Array.isArray(prjPath)) {\n      prjCoords = prjPath;\n    } else {\n      prjCoords = geometry._getPrjCoordinates();\n      prjCoords.push(prjPath);\n    }\n\n    var path = prjCoords.map(function (c) {\n      return projection.unproject(c);\n    });\n    geometry.setCoordinates(path);\n\n    geometry._setPrjCoordinates(prjCoords);\n  },\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n};\nDrawTool.registerMode('linestring', extend({\n  'action': ['click', 'mousemove', 'dblclick']\n}, lineStringHooks));\nDrawTool.registerMode('freeHandLinestring', extend({\n  'action': ['mousedown touchstart', 'mousemove touchmove', 'mouseup touchend']\n}, lineStringHooks));\nDrawTool.registerMode('arccurve', {\n  'action': ['click', 'mousemove', 'dblclick'],\n  'create': function create(projection, prjPath) {\n    var path = prjPath.map(function (c) {\n      return projection.unproject(c);\n    });\n    var arc = new ArcCurve(path);\n\n    arc._setPrjCoordinates(prjPath);\n\n    return arc;\n  },\n  'update': lineStringHooks.update,\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n});\nDrawTool.registerMode('quadbeziercurve', {\n  'action': ['click', 'mousemove', 'dblclick'],\n  'create': function create(projection, prjPath) {\n    var path = prjPath.map(function (c) {\n      return projection.unproject(c);\n    });\n    var curve = new QuadBezierCurve(path);\n\n    curve._setPrjCoordinates(prjPath);\n\n    return curve;\n  },\n  'update': lineStringHooks.update,\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n});\nDrawTool.registerMode('cubicbeziercurve', {\n  'action': ['click', 'mousemove', 'dblclick'],\n  'create': function create(projection, prjPath) {\n    var path = prjPath.map(function (c) {\n      return projection.unproject(c);\n    });\n    var curve = new CubicBezierCurve(path);\n\n    curve._setPrjCoordinates(prjPath);\n\n    return curve;\n  },\n  'update': lineStringHooks.update,\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n});\nDrawTool.registerMode('boxZoom', {\n  'action': ['mousedown', 'mousemove', 'mouseup'],\n  'create': function create(projection, prjCoord) {\n    prjCoord = prjCoord[0];\n    var center = projection.unproject(prjCoord);\n    var marker = new Marker(center);\n    marker._firstClick = prjCoord;\n    return marker;\n  },\n  'update': function update(projection, prjCoord, geometry, param) {\n    var map = geometry.getMap();\n\n    var p1 = map._prjToContainerPoint(geometry._firstClick),\n        p2 = param['containerPoint'];\n\n    prjCoord = map._containerPointToPrj(new Coordinate(Math.min(p1.x, p2.x), Math.min(p1.y, p2.y)));\n    var center = projection.unproject(prjCoord);\n\n    geometry.setCoordinates(center)._setPrjCoordinates(prjCoord);\n\n    geometry.updateSymbol({\n      markerWidth: Math.abs(p1.x - p2.x),\n      markerHeight: Math.abs(p1.y - p2.y)\n    });\n  },\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n});\n\nfunction parse(arcConf) {\n  var tileInfo = arcConf['tileInfo'],\n      tileSize = [tileInfo['cols'], tileInfo['rows']],\n      resolutions = [],\n      lods = tileInfo['lods'];\n\n  for (var i = 0, len = lods.length; i < len; i++) {\n    resolutions.push(lods[i]['resolution']);\n  }\n\n  var fullExtent = arcConf['fullExtent'],\n      origin = tileInfo['origin'],\n      tileSystem = [1, -1, origin['x'], origin['y']];\n  delete fullExtent['spatialReference'];\n  return {\n    'spatialReference': {\n      'resolutions': resolutions,\n      'fullExtent': fullExtent\n    },\n    'tileSystem': tileSystem,\n    'tileSize': tileSize\n  };\n}\n\nSpatialReference.loadArcgis = function (url, cb, options) {\n  if (options === void 0) {\n    options = {\n      'jsonp': true\n    };\n  }\n\n  if (isString(url) && url.substring(0, 1) !== '{') {\n    Ajax.getJSON(url, function (err, json) {\n      if (err) {\n        cb(err);\n        return;\n      }\n\n      var spatialRef = parse(json);\n      cb(null, spatialRef);\n    }, options);\n  } else {\n    if (isString(url)) {\n      url = parseJSON(url);\n    }\n\n    var spatialRef = parse(url);\n    cb(null, spatialRef);\n  }\n\n  return this;\n};\n\nfunction getProjectionCode(code) {\n  var newcode = '';\n  var codeArray = code.split('');\n\n  for (var len = codeArray.length, i = len - 1; i >= 0; i--) {\n    if (!isNaN(codeArray[i])) {\n      newcode = codeArray[i] + newcode;\n    } else {\n      break;\n    }\n  }\n\n  return newcode;\n}\n\nfunction getProjection(projection) {\n  var prj = projection.indexOf('EPSG') > -1 ? projection : 'EPSG:' + projection;\n  prj = strReplace(prj, [['4490', '4326'], ['102100', '3857'], ['900913', '3857']]);\n  return prj;\n}\n\nfunction strReplace(str, repArray) {\n  if (repArray === void 0) {\n    repArray = [];\n  }\n\n  repArray.forEach(function (rep) {\n    var template = rep[0],\n        value = rep[1];\n    str = str.replace(template, value);\n  });\n  return str;\n}\n\nfunction getTransformValue(options) {\n  var projection = options.projection,\n      isArcgis = options.isArcgis,\n      isGeoServer = options.isGeoServer,\n      isSuperMap = options.isSuperMap;\n  var transformValue = 0.0002645833333333333;\n\n  if (isArcgis || isGeoServer || isSuperMap) {\n    transformValue = 0.00028;\n  }\n\n  if (projection && projection.indexOf('4326') > -1) {\n    transformValue = 2.3767925226029154e-9;\n\n    if (isArcgis || isSuperMap) {\n      transformValue = 2.518101729011901e-9;\n    }\n\n    if (isGeoServer) {\n      transformValue = 2.51528279553466e-9;\n    }\n  }\n\n  return transformValue;\n}\n\nfunction getTileMatrixSet(TileMatrixSets, TileMatrixSetLink) {\n  for (var i = 0; i < TileMatrixSets.length; i++) {\n    var TileMatrixSet = TileMatrixSets[i];\n    TileMatrixSet = TileMatrixSet.getElementsByTagName('ows:Identifier')[0];\n\n    if (TileMatrixSet) {\n      if (TileMatrixSet.textContent === TileMatrixSetLink) {\n        return TileMatrixSets[i];\n      }\n    }\n  }\n\n  return null;\n}\n\nfunction parseWMTSXML(str, requestUrl, options) {\n  if (options.isArcgis == null) {\n    options.isArcgis = str.indexOf('arcgis') > -1;\n  }\n\n  if (options.isSuperMap == null) {\n    options.isSuperMap = str.indexOf('supermap') > -1;\n  }\n\n  var parser = new DOMParser();\n  var xmlDoc = parser.parseFromString(str, 'text/xml');\n  var content = xmlDoc.querySelectorAll('Contents')[0];\n\n  if (!content) {\n    return [];\n  }\n\n  var layers = content.getElementsByTagName('Layer');\n\n  if (!layers.length) {\n    return [];\n  }\n\n  var TileMatrixSets = [];\n\n  for (var i = 0, len = content.childNodes.length; i < len; i++) {\n    if (content.childNodes[i].nodeName === 'TileMatrixSet') {\n      TileMatrixSets.push(content.childNodes[i]);\n    }\n  }\n\n  if (!TileMatrixSets.length) {\n    return [];\n  }\n\n  var result = [];\n\n  for (var _i = 0, _len = layers.length; _i < _len; _i++) {\n    var layer = layers[_i];\n    var style = layer.querySelectorAll('Style')[0];\n\n    if (style) {\n      style = style.getElementsByTagName('ows:Identifier')[0];\n\n      if (style) {\n        style = style.textContent;\n      }\n    }\n\n    var layerName = layer.getElementsByTagName('ows:Identifier')[0];\n\n    if (layerName) {\n      layerName = layerName.textContent;\n    }\n\n    var tileMatrixSetLinks = layer.getElementsByTagName('TileMatrixSetLink');\n\n    if (tileMatrixSetLinks.length === 0) {\n      continue;\n    }\n\n    for (var j = 0, len1 = tileMatrixSetLinks.length; j < len1; j++) {\n      var tileMatrixSetLink = tileMatrixSetLinks[j];\n      tileMatrixSetLink = tileMatrixSetLink.getElementsByTagName('TileMatrixSet')[0];\n\n      if (tileMatrixSetLink) {\n        tileMatrixSetLink = tileMatrixSetLink.textContent;\n      }\n\n      var tileMatrixSet = getTileMatrixSet(TileMatrixSets, tileMatrixSetLink);\n\n      if (!tileMatrixSet) {\n        continue;\n      }\n\n      var resourceURL = layer.querySelectorAll('ResourceURL')[0];\n      var url = '';\n\n      if (resourceURL) {\n        url = resourceURL.attributes.template.value;\n      }\n\n      var _parseTileMatrixSet = parseTileMatrixSet(tileMatrixSet, options),\n          resolutions = _parseTileMatrixSet.resolutions,\n          tileSize = _parseTileMatrixSet.tileSize,\n          tileSystem = _parseTileMatrixSet.tileSystem,\n          projection = _parseTileMatrixSet.projection,\n          TileMatrixSet = _parseTileMatrixSet.TileMatrixSet,\n          isGeoServer = _parseTileMatrixSet.isGeoServer,\n          levelStr = _parseTileMatrixSet.levelStr;\n\n      if (!url.length) {\n        url = requestUrl.substr(0, requestUrl.lastIndexOf('?'));\n        url += '?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER={LAYER}&STYLE={Style}&TILEMATRIXSET={TileMatrixSet}&FORMAT={tiles}&TILEMATRIX={TileMatrix}&TILEROW={TileRow}&TILECOL={TileCol}';\n      }\n\n      var urlTemplate = strReplace(url, [['{LAYER}', layerName], ['{Layer}', layerName], ['{layer}', layerName], ['{STYLE}', style], ['{Style}', style], ['{style}', style], ['{TileMatrixSet}', TileMatrixSet], ['{TileMatrix}', isGeoServer ? levelStr + \":{z}\" : '{z}'], ['{TileRow}', '{y}'], ['{TileCol}', '{x}'], ['{tiles}', isGeoServer ? 'image/png' : 'tiles']]);\n      result.push({\n        tileSize: tileSize,\n        tileSystem: tileSystem,\n        spatialReference: {\n          resolutions: resolutions,\n          projection: projection\n        },\n        urlTemplate: urlTemplate,\n        info: {\n          layerName: layerName,\n          TileMatrixSet: TileMatrixSet,\n          style: style,\n          tileSize: tileSize,\n          tileSystem: tileSystem,\n          resolutions: resolutions,\n          projection: projection,\n          urlTemplate: urlTemplate\n        }\n      });\n    }\n  }\n\n  return result;\n}\n\nfunction parseTileMatrixSet(TileMatrixSet, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var TileMatrixs = TileMatrixSet.getElementsByTagName('TileMatrix');\n  var resolutions = [],\n      tileSystem = [],\n      tileSize = [];\n  var projection,\n      tset,\n      isGeoServer = false,\n      levelStr;\n\n  if (!projection) {\n    var supportedCRS = TileMatrixSet.getElementsByTagName('ows:SupportedCRS')[0];\n\n    if (supportedCRS) {\n      projection = supportedCRS.textContent;\n      projection = projection.split('EPSG')[1];\n      projection = getProjectionCode(projection);\n      projection = getProjection(projection);\n    }\n  }\n\n  if (!tset) {\n    tset = TileMatrixSet.getElementsByTagName('ows:Identifier')[0];\n\n    if (tset) {\n      tset = tset.textContent;\n    }\n  }\n\n  options.projection = projection;\n  var minLevel = Infinity;\n\n  for (var index = 0; index < TileMatrixs.length; index++) {\n    var TileMatrix = TileMatrixs[index];\n    var level = TileMatrix.getElementsByTagName('ows:Identifier')[0].textContent;\n\n    if (isNaN(parseInt(level))) {\n      levelStr = level.substr(0, level.lastIndexOf(':'));\n      level = level.split(':');\n      level = level[level.length - 1];\n      level = parseInt(level);\n      isGeoServer = true;\n      options.isGeoServer = true;\n    } else {\n      level = parseInt(level);\n    }\n\n    minLevel = Math.min(minLevel, level);\n    var ScaleDenominator = TileMatrix.getElementsByTagName('ScaleDenominator')[0].textContent;\n    var TopLeftCorner = TileMatrix.getElementsByTagName('TopLeftCorner')[0].textContent;\n    var TileWidth = TileMatrix.getElementsByTagName('TileWidth')[0].textContent;\n    var TileHeight = TileMatrix.getElementsByTagName('TileHeight')[0].textContent;\n\n    if (tileSize.length === 0) {\n      tileSize.push(parseInt(TileWidth), parseInt(TileHeight));\n    }\n\n    if (tileSystem.length === 0) {\n      var _TopLeftCorner$split$ = TopLeftCorner.split(' ').filter(function (s) {\n        return s !== '';\n      }).map(function (v) {\n        return parseFloat(v);\n      }),\n          x = _TopLeftCorner$split$[0],\n          y = _TopLeftCorner$split$[1];\n\n      if (x > 0) {\n        tileSystem.push(1, -1, y, x);\n      } else {\n        tileSystem.push(1, -1, x, y);\n      }\n    }\n\n    var transformValue = getTransformValue(options);\n    var res = parseFloat(ScaleDenominator) * transformValue;\n    resolutions.push(res);\n  }\n\n  if (minLevel > 0) {\n    var _res = resolutions[0];\n\n    for (var i = minLevel - 1; i >= 0; i--) {\n      _res = _res * 2;\n      resolutions.splice(0, 0, _res);\n    }\n  }\n\n  return {\n    resolutions: resolutions,\n    tileSize: tileSize,\n    tileSystem: tileSystem,\n    projection: projection,\n    TileMatrixSet: tset,\n    isGeoServer: isGeoServer,\n    levelStr: levelStr\n  };\n}\n\nSpatialReference.loadWMTS = function (url, cb, options) {\n  if (options === void 0) {\n    options = {\n      'jsonp': true\n    };\n  }\n\n  if (isString(url)) {\n    Ajax.get(url, function (err, xml) {\n      if (err) {\n        cb(err);\n        return;\n      }\n\n      var layers = parseWMTSXML(xml, url, options);\n      cb(null, layers);\n    }, options);\n  }\n\n  return this;\n};\n\nvar options$j = {\n  'eventsPropagation': false,\n  'eventsToStop': null,\n  'dx': 0,\n  'dy': 0,\n  'autoPan': false,\n  'autoPanDuration': 600,\n  'single': true,\n  'animation': 'scale',\n  'animationOnHide': false,\n  'animationDuration': 500,\n  'pitchWithMap': false,\n  'rotateWithMap': false,\n  'visible': true,\n  'roundPoint': false\n};\n\nvar UIComponent = function (_Eventable) {\n  _inheritsLoose(UIComponent, _Eventable);\n\n  function UIComponent(options) {\n    return _Eventable.call(this, options) || this;\n  }\n\n  var _proto = UIComponent.prototype;\n\n  _proto.addTo = function addTo(owner) {\n    this._owner = owner;\n\n    this._switchEvents('on');\n\n    if (this.onAdd) {\n      this.onAdd();\n    }\n\n    this.fire('add');\n    return this;\n  };\n\n  _proto.getMap = function getMap() {\n    if (!this._owner) {\n      return null;\n    }\n\n    if (this._owner.getBaseLayer) {\n      return this._owner;\n    }\n\n    return this._owner.getMap();\n  };\n\n  _proto.show = function show(coordinate) {\n    var map = this.getMap();\n\n    if (!map) {\n      return this;\n    }\n\n    this.options['visible'] = true;\n    coordinate = coordinate || this._coordinate || this._owner.getCenter();\n    var visible = this.isVisible();\n    this.fire('showstart');\n\n    var container = this._getUIContainer();\n\n    this._coordinate = coordinate;\n\n    this._removePrevDOM();\n\n    if (!this._mapEventsOn) {\n      this._switchMapEvents('on');\n    }\n\n    var dom = this.__uiDOM = this.buildOn(map);\n    dom['eventsPropagation'] = this.options['eventsPropagation'];\n\n    this._observerDomSize(dom);\n\n    if (!dom) {\n      this.fire('showend');\n      return this;\n    }\n\n    this._measureSize(dom);\n\n    if (this._singleton()) {\n      dom._uiComponent = this;\n      map[this._uiDomKey()] = dom;\n    }\n\n    this._setPosition();\n\n    dom.style[TRANSITION] = null;\n    container.appendChild(dom);\n\n    var anim = this._getAnimation();\n\n    if (visible) {\n      anim.ok = false;\n    }\n\n    if (anim.ok) {\n      if (anim.fade) {\n        dom.style.opacity = 0;\n      }\n\n      if (anim.scale) {\n        if (this.getTransformOrigin) {\n          var origin = this.getTransformOrigin();\n          dom.style[TRANSFORMORIGIN] = origin;\n        }\n\n        dom.style[TRANSFORM] = this._toCSSTranslate(this._pos) + ' scale(0)';\n      }\n    }\n\n    if (!this.isSupportZoomFilter()) {\n      dom.style.display = '';\n    }\n\n    if (this.options['eventsToStop']) {\n      on(dom, this.options['eventsToStop'], stopPropagation);\n    }\n\n    if (this.options['autoPan']) {\n      this._autoPan();\n    }\n\n    var transition = anim.transition;\n\n    if (anim.ok && transition) {\n      dom.offsetHeight;\n\n      if (transition) {\n        dom.style[TRANSITION] = transition;\n      }\n\n      if (anim.fade) {\n        dom.style.opacity = 1;\n      }\n\n      if (anim.scale) {\n        dom.style[TRANSFORM] = this._toCSSTranslate(this._pos) + ' scale(1)';\n      }\n    }\n\n    this.fire('showend');\n    return this;\n  };\n\n  _proto.hide = function hide() {\n    var _this = this;\n\n    if (!this.getDOM()) {\n      return this;\n    }\n\n    this.options['visible'] = false;\n\n    var anim = this._getAnimation(),\n        dom = this.getDOM();\n\n    if (!this.options['animationOnHide']) {\n      anim.ok = false;\n    }\n\n    if (!anim.ok) {\n      dom.style.display = 'none';\n      this.fire('hide');\n    } else {\n      dom.offsetHeight;\n      dom.style[TRANSITION] = anim.transition;\n      setTimeout(function () {\n        dom.style.display = 'none';\n\n        _this.fire('hide');\n      }, this.options['animationDuration']);\n    }\n\n    if (anim.fade) {\n      dom.style.opacity = 0;\n    }\n\n    if (anim.scale) {\n      dom.style[TRANSFORM] = this._toCSSTranslate(this._pos) + ' scale(0)';\n    }\n\n    this._switchMapEvents('off');\n\n    return this;\n  };\n\n  _proto.isVisible = function isVisible() {\n    if (!this.options['visible']) {\n      return false;\n    }\n\n    var dom = this.getDOM();\n    return this.getMap() && dom && dom.parentNode && dom.style.display !== 'none';\n  };\n\n  _proto.remove = function remove() {\n    delete this._mapEventsOn;\n\n    if (!this._owner) {\n      return this;\n    }\n\n    this.hide();\n\n    this._switchEvents('off');\n\n    if (this.onRemove) {\n      this.onRemove();\n    }\n\n    if (!this._singleton() && this.__uiDOM) {\n      this._removePrevDOM();\n    }\n\n    delete this._owner;\n    this.fire('remove');\n    return this;\n  };\n\n  _proto.getSize = function getSize() {\n    if (this._domContentRect && this._size) {\n      this._size.width = this._domContentRect.width;\n      this._size.height = this._domContentRect.height;\n    }\n\n    if (this._size) {\n      return this._size.copy();\n    } else {\n      return null;\n    }\n  };\n\n  _proto.getOwner = function getOwner() {\n    return this._owner;\n  };\n\n  _proto.getDOM = function getDOM() {\n    return this.__uiDOM;\n  };\n\n  _proto._roundPoint = function _roundPoint(point) {\n    if (this.options.roundPoint) {\n      point = point._round();\n    }\n\n    return point;\n  };\n\n  _proto.getPosition = function getPosition() {\n    if (!this.getMap()) {\n      return null;\n    }\n\n    var p = this._roundPoint(this._getViewPoint());\n\n    if (this.getOffset) {\n      var o = this._roundPoint(this.getOffset());\n\n      if (o) {\n        p._add(o);\n      }\n    }\n\n    return p;\n  };\n\n  _proto._getAnimation = function _getAnimation() {\n    var anim = {\n      'fade': false,\n      'scale': false\n    };\n    var animations = this.options['animation'] ? this.options['animation'].split(',') : [];\n\n    for (var i = 0; i < animations.length; i++) {\n      var trimed = trim(animations[i]);\n\n      if (trimed === 'fade') {\n        anim.fade = true;\n      } else if (trimed === 'scale') {\n        anim.scale = true;\n      }\n    }\n\n    var transition = null;\n\n    if (anim.fade) {\n      transition = 'opacity ' + this.options['animationDuration'] + 'ms';\n    }\n\n    if (anim.scale) {\n      transition = transition ? transition + ',' : '';\n      transition += TRANSFORM + ' ' + this.options['animationDuration'] + 'ms';\n    }\n\n    anim.transition = transition;\n    anim.ok = transition !== null;\n    return anim;\n  };\n\n  _proto._getViewPoint = function _getViewPoint() {\n    var alt = 0;\n\n    if (this._owner && this._owner.getAltitude) {\n      var altitude = this._owner.getAltitude();\n\n      if (altitude > 0) {\n        alt = this._meterToPoint(this._coordinate, altitude);\n      }\n    }\n\n    return this.getMap().coordToViewPoint(this._coordinate, undefined, alt)._add(this.options['dx'], this.options['dy']);\n  };\n\n  _proto._meterToPoint = function _meterToPoint(center, altitude) {\n    var map = this.getMap();\n    return map.distanceToPoint(altitude, 0, undefined, center).x * sign(altitude);\n  };\n\n  _proto._autoPan = function _autoPan() {\n    var map = this.getMap(),\n        dom = this.getDOM();\n\n    if (map.isMoving()) {\n      return;\n    }\n\n    var point = this._getViewPoint()._round();\n\n    var mapWidth = map.width;\n    var mapHeight = map.height;\n    var containerPoint0 = map.viewPointToContainerPoint(point);\n    var offset = this.getOffset();\n    var containerPoint = containerPoint0.add(offset);\n\n    var prjCoord = map._viewPointToPrj(point);\n\n    var domWidth = parseInt(dom.clientWidth);\n    var domHeight = parseInt(dom.clientHeight);\n    var margin = 50;\n    var left = 0,\n        top = 0;\n\n    if (containerPoint.x < 0) {\n      left = -containerPoint.x + margin;\n    } else if (containerPoint.x + domWidth > mapWidth) {\n      left = -(containerPoint.x + domWidth - mapWidth) - margin;\n    }\n\n    if (containerPoint.y < 0) {\n      top = -containerPoint.y + margin;\n    } else if (containerPoint.y + domHeight > mapHeight) {\n      top = mapHeight - (containerPoint.y + domHeight) - margin;\n    }\n\n    if (top !== 0 || left !== 0) {\n      var newContainerPoint = containerPoint0.add(left, top);\n\n      var t = map._containerPointToPoint(newContainerPoint)._sub(map._prjToPoint(map._getPrjCenter()));\n\n      var target = map._pointToPrj(map._prjToPoint(prjCoord).sub(t));\n\n      map._panAnimation(target);\n    }\n  };\n\n  _proto._measureSize = function _measureSize(dom) {\n    var container = this._getUIContainer();\n\n    dom.style.position = 'absolute';\n    dom.style.left = -99999 + 'px';\n    var anchor = dom.style.bottom ? 'bottom' : 'top';\n    dom.style[anchor] = -99999 + 'px';\n    dom.style.display = '';\n    container.appendChild(dom);\n    this._size = new Size(dom.clientWidth, dom.clientHeight);\n    dom.style.display = 'none';\n    dom.style.left = '0px';\n    dom.style[anchor] = '0px';\n    return this._size;\n  };\n\n  _proto._removePrevDOM = function _removePrevDOM() {\n    if (this.onDomRemove) {\n      this.onDomRemove();\n    }\n\n    var eventsToStop = this.options['eventsToStop'];\n\n    if (this._singleton()) {\n      var map = this.getMap(),\n          key = this._uiDomKey();\n\n      if (map[key]) {\n        if (eventsToStop) {\n          off(map[key], eventsToStop, stopPropagation);\n        }\n\n        removeDomNode(map[key]);\n\n        if (map[key]._uiComponent && !this.hideDom) {\n          map[key]._uiComponent._switchMapEvents('off');\n        }\n\n        delete map[key];\n      }\n\n      delete this.__uiDOM;\n    } else if (this.__uiDOM) {\n      if (eventsToStop) {\n        off(this.__uiDOM, eventsToStop, stopPropagation);\n      }\n\n      removeDomNode(this.__uiDOM);\n      delete this.__uiDOM;\n    }\n\n    if (this._resizeObserver) {\n      this._resizeObserver.disconnect();\n\n      delete this._resizeObserver;\n      delete this._domContentRect;\n    }\n  };\n\n  _proto._uiDomKey = function _uiDomKey() {\n    return '__ui_' + this._getClassName();\n  };\n\n  _proto._singleton = function _singleton() {\n    return this.options['single'];\n  };\n\n  _proto._getUIContainer = function _getUIContainer() {\n    return this.getMap()._panels['ui'];\n  };\n\n  _proto._getClassName = function _getClassName() {\n    return 'UIComponent';\n  };\n\n  _proto._switchMapEvents = function _switchMapEvents(to) {\n    var map = this.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    this._mapEventsOn = to === 'on';\n\n    var events = this._getDefaultEvents();\n\n    if (this.getEvents) {\n      extend(events, this.getEvents());\n    }\n\n    if (events) {\n      for (var p in events) {\n        if (events.hasOwnProperty(p)) {\n          map[to](p, events[p], this);\n        }\n      }\n    }\n  };\n\n  _proto._switchEvents = function _switchEvents(to) {\n    var ownerEvents = this._getOwnerEvents();\n\n    if (this._owner) {\n      for (var p in ownerEvents) {\n        if (ownerEvents.hasOwnProperty(p)) {\n          this._owner[to](p, ownerEvents[p], this);\n        }\n      }\n    }\n  };\n\n  _proto._getDefaultEvents = function _getDefaultEvents() {\n    return {\n      'zooming rotate pitch': this.onEvent,\n      'zoomend': this.onZoomEnd,\n      'moving': this.onMoving,\n      'resize': this.onResize\n    };\n  };\n\n  _proto._getOwnerEvents = function _getOwnerEvents() {\n    var events = {};\n\n    if (this._owner && this._owner instanceof Geometry) {\n      events.positionchange = this.onGeometryPositionChange;\n      events.symbolchange = this.onGeometryPositionChange;\n    }\n\n    if (this.getOwnerEvents) {\n      extend(events, this.getOwnerEvents());\n    }\n\n    return events;\n  };\n\n  _proto.onGeometryPositionChange = function onGeometryPositionChange(param) {\n    if (this._owner && this.isVisible()) {\n      this.show(param['target'].getCenter());\n    }\n  };\n\n  _proto.onMoving = function onMoving() {\n    if (this.isVisible() && this.getMap().isTransforming()) {\n      this._updatePosition();\n    }\n  };\n\n  _proto.onEvent = function onEvent() {\n    if (this.isVisible()) {\n      this._updatePosition();\n    }\n  };\n\n  _proto.onZoomEnd = function onZoomEnd() {\n    if (this.isVisible()) {\n      this._setPosition();\n    }\n  };\n\n  _proto.onResize = function onResize() {\n    if (this.isVisible()) {\n      this._setPosition();\n    }\n  };\n\n  _proto.onDomSizeChange = function onDomSizeChange() {\n    if (this.isVisible()) {\n      this._setPosition();\n    }\n  };\n\n  _proto._updatePosition = function _updatePosition() {\n    var renderer = this.getMap()._getRenderer();\n\n    renderer.callInNextFrame(this._setPosition.bind(this));\n  };\n\n  _proto._setPosition = function _setPosition() {\n    var dom = this.getDOM();\n    if (!dom) return;\n    dom.style[TRANSITION] = null;\n    var p = this.getPosition();\n    this._pos = p;\n    dom.style[TRANSFORM] = this._toCSSTranslate(p) + ' scale(1)';\n  };\n\n  _proto._toCSSTranslate = function _toCSSTranslate(p) {\n    if (!p) {\n      return '';\n    }\n\n    if (Browser$1.any3d) {\n      var map = this.getMap(),\n          bearing = map ? map.getBearing() : 0,\n          pitch = map ? map.getPitch() : 0;\n      var r = '';\n\n      if (this.options['pitchWithMap'] && pitch) {\n        r += \" rotateX(\" + Math.round(pitch) + \"deg)\";\n      }\n\n      if (this.options['rotateWithMap'] && bearing) {\n        r += \" rotateZ(\" + Math.round(-bearing) + \"deg)\";\n      }\n\n      return 'translate3d(' + p.x + 'px,' + p.y + 'px, 0px)' + r;\n    } else {\n      return 'translate(' + p.x + 'px,' + p.y + 'px)';\n    }\n  };\n\n  _proto._observerDomSize = function _observerDomSize(dom) {\n    var _this2 = this;\n\n    if (!dom || !Browser$1.resizeObserver || this._resizeObserver) {\n      return this;\n    }\n\n    this._resizeObserver = new ResizeObserver(function (entries) {\n      if (entries.length) {\n        _this2._domContentRect = entries[0].contentRect;\n      } else {\n        delete _this2._domContentRect;\n      }\n\n      if (_this2.onDomSizeChange) {\n        _this2.onDomSizeChange();\n      }\n    });\n\n    this._resizeObserver.observe(dom);\n\n    return this;\n  };\n\n  _proto.isSupportZoomFilter = function isSupportZoomFilter() {\n    return false;\n  };\n\n  UIComponent.isSupport = function isSupport(owner) {\n    if (owner && isFunction(owner.on) && isFunction(owner.off) && isFunction(owner.getCenter)) {\n      return true;\n    }\n\n    return false;\n  };\n\n  return UIComponent;\n}(Eventable(Class));\n\nUIComponent.mergeOptions(options$j);\n\nvar options$k = {\n  'containerClass': null,\n  'eventsPropagation': true,\n  'draggable': false,\n  'single': false,\n  'content': null,\n  'altitude': 0,\n  'minZoom': 0,\n  'maxZoom': null\n};\nvar domEvents = 'mousedown ' + 'mouseup ' + 'mouseenter ' + 'mouseover ' + 'mouseout ' + 'mousemove ' + 'click ' + 'dblclick ' + 'contextmenu ' + 'keypress ' + 'touchstart ' + 'touchmove ' + 'touchend';\n\nvar UIMarker = function (_Handlerable) {\n  _inheritsLoose(UIMarker, _Handlerable);\n\n  function UIMarker(coordinate, options) {\n    var _this;\n\n    _this = _Handlerable.call(this, options) || this;\n    _this._markerCoord = new Coordinate(coordinate);\n    return _this;\n  }\n\n  var _proto = UIMarker.prototype;\n\n  _proto._getClassName = function _getClassName() {\n    return 'UIMarker';\n  };\n\n  _proto.setCoordinates = function setCoordinates(coordinates) {\n    this._markerCoord = coordinates;\n    this.fire('positionchange');\n\n    if (this.isVisible()) {\n      this._coordinate = this._markerCoord;\n\n      this._setPosition();\n    }\n\n    return this;\n  };\n\n  _proto.getCoordinates = function getCoordinates() {\n    return this._markerCoord;\n  };\n\n  _proto.getCenter = function getCenter() {\n    return this.getCoordinates();\n  };\n\n  _proto.getAltitude = function getAltitude() {\n    return this.options.altitude || 0;\n  };\n\n  _proto.setContent = function setContent(content) {\n    var old = this.options['content'];\n    this.options['content'] = content;\n    this.fire('contentchange', {\n      'old': old,\n      'new': content\n    });\n\n    if (this.isVisible()) {\n      this.show();\n    }\n\n    return this;\n  };\n\n  _proto.getContent = function getContent() {\n    return this.options['content'];\n  };\n\n  _proto.onAdd = function onAdd() {\n    this.show();\n  };\n\n  _proto.show = function show() {\n    return _Handlerable.prototype.show.call(this, this._markerCoord);\n  };\n\n  _proto.flash = function flash$$1(interval, count, cb, context) {\n    return flash.call(this, interval, count, cb, context);\n  };\n\n  _proto.buildOn = function buildOn() {\n    var dom;\n\n    if (isString(this.options['content'])) {\n      dom = createEl('div');\n      dom.innerHTML = this.options['content'];\n    } else {\n      dom = this.options['content'];\n    }\n\n    if (this.options['containerClass']) {\n      dom.className = this.options['containerClass'];\n    }\n\n    this._registerDOMEvents(dom);\n\n    return dom;\n  };\n\n  _proto.getOffset = function getOffset() {\n    var size = this.getSize();\n    return new Point(-size.width / 2, -size.height / 2);\n  };\n\n  _proto.getTransformOrigin = function getTransformOrigin() {\n    return 'center center';\n  };\n\n  _proto.onDomRemove = function onDomRemove() {\n    var dom = this.getDOM();\n\n    this._removeDOMEvents(dom);\n  };\n\n  _proto.isDragging = function isDragging() {\n    if (this['draggable']) {\n      return this['draggable'].isDragging();\n    }\n\n    return false;\n  };\n\n  _proto._registerDOMEvents = function _registerDOMEvents(dom) {\n    on(dom, domEvents, this._onDomEvents, this);\n  };\n\n  _proto._onDomEvents = function _onDomEvents(e) {\n    var event = this.getMap()._parseEvent(e, e.type);\n\n    this.fire(e.type, event);\n  };\n\n  _proto._removeDOMEvents = function _removeDOMEvents(dom) {\n    off(dom, domEvents, this._onDomEvents, this);\n  };\n\n  _proto._getConnectPoints = function _getConnectPoints() {\n    var map = this.getMap();\n    var containerPoint = map.coordToContainerPoint(this.getCoordinates());\n    var size = this.getSize(),\n        width = size.width,\n        height = size.height;\n    var anchors = [map.containerPointToCoordinate(containerPoint.add(-width / 2, 0)), map.containerPointToCoordinate(containerPoint.add(width / 2, 0)), map.containerPointToCoordinate(containerPoint.add(0, height / 2)), map.containerPointToCoordinate(containerPoint.add(0, -height / 2))];\n    return anchors;\n  };\n\n  _proto._getViewPoint = function _getViewPoint() {\n    var alt = 0;\n\n    if (this._owner) {\n      var altitude = this.getAltitude();\n\n      if (altitude > 0) {\n        alt = this._meterToPoint(this._coordinate, altitude);\n      }\n    }\n\n    return this.getMap().coordToViewPoint(this._coordinate, undefined, alt)._add(this.options['dx'], this.options['dy']);\n  };\n\n  _proto._getDefaultEvents = function _getDefaultEvents() {\n    return extend({}, _Handlerable.prototype._getDefaultEvents.call(this), {\n      'zooming zoomend': this.onZoomFilter\n    });\n  };\n\n  _proto._setPosition = function _setPosition() {\n    this.onZoomFilter();\n\n    _Handlerable.prototype._setPosition.call(this);\n  };\n\n  _proto.onZoomFilter = function onZoomFilter() {\n    var dom = this.getDOM();\n    if (!dom) return;\n\n    if (!this.isVisible() && dom.style.display !== 'none') {\n      dom.style.display = 'none';\n    } else if (this.isVisible() && dom.style.display === 'none') {\n      dom.style.display = '';\n    }\n  };\n\n  _proto.isVisible = function isVisible() {\n    var map = this.getMap();\n\n    if (!map) {\n      return false;\n    }\n\n    if (!this.options['visible']) {\n      return false;\n    }\n\n    var zoom = map.getZoom();\n    var _this$options = this.options,\n        minZoom = _this$options.minZoom,\n        maxZoom = _this$options.maxZoom;\n\n    if (!isNil(minZoom) && zoom < minZoom || !isNil(maxZoom) && zoom > maxZoom) {\n      return false;\n    }\n\n    var dom = this.getDOM();\n    return dom && true;\n  };\n\n  _proto.isSupportZoomFilter = function isSupportZoomFilter() {\n    return true;\n  };\n\n  return UIMarker;\n}(Handlerable(UIComponent));\n\nUIMarker.mergeOptions(options$k);\nvar EVENTS$1 = Browser$1.touch ? 'touchstart mousedown' : 'mousedown';\n\nvar UIMarkerDragHandler = function (_Handler) {\n  _inheritsLoose(UIMarkerDragHandler, _Handler);\n\n  function UIMarkerDragHandler(target) {\n    return _Handler.call(this, target) || this;\n  }\n\n  var _proto2 = UIMarkerDragHandler.prototype;\n\n  _proto2.addHooks = function addHooks() {\n    this.target.on(EVENTS$1, this._startDrag, this);\n  };\n\n  _proto2.removeHooks = function removeHooks() {\n    this.target.off(EVENTS$1, this._startDrag, this);\n  };\n\n  _proto2._startDrag = function _startDrag(param) {\n    var domEvent = param['domEvent'];\n\n    if (domEvent.touches && domEvent.touches.length > 1 || domEvent.button === 2) {\n      return;\n    }\n\n    if (this.isDragging()) {\n      return;\n    }\n\n    this.target.on('click', this._endDrag, this);\n    this._lastCoord = param['coordinate'];\n    this._lastPoint = param['containerPoint'];\n\n    this._prepareDragHandler();\n\n    this._dragHandler.onMouseDown(param['domEvent']);\n\n    this.target.fire('dragstart', param);\n  };\n\n  _proto2._prepareDragHandler = function _prepareDragHandler() {\n    this._dragHandler = new DragHandler(this.target.getDOM(), {\n      'cancelOn': this._cancelOn.bind(this),\n      'ignoreMouseleave': true\n    });\n\n    this._dragHandler.on('mousedown', this._onMouseDown, this);\n\n    this._dragHandler.on('dragging', this._dragging, this);\n\n    this._dragHandler.on('mouseup', this._endDrag, this);\n\n    this._dragHandler.enable();\n  };\n\n  _proto2._cancelOn = function _cancelOn(domEvent) {\n    var target = domEvent.srcElement || domEvent.target,\n        tagName = target.tagName.toLowerCase();\n\n    if (tagName === 'button' || tagName === 'input' || tagName === 'select' || tagName === 'option' || tagName === 'textarea') {\n      return true;\n    }\n\n    return false;\n  };\n\n  _proto2._onMouseDown = function _onMouseDown(param) {\n    stopPropagation(param['domEvent']);\n  };\n\n  _proto2._dragging = function _dragging(param) {\n    var target = this.target,\n        map = target.getMap(),\n        eventParam = map._parseEvent(param['domEvent']),\n        domEvent = eventParam['domEvent'];\n\n    if (domEvent.touches && domEvent.touches.length > 1) {\n      return;\n    }\n\n    if (!this._isDragging) {\n      this._isDragging = true;\n      return;\n    }\n\n    var coord = eventParam['coordinate'],\n        point = eventParam['containerPoint'];\n\n    if (!this._lastCoord) {\n      this._lastCoord = coord;\n    }\n\n    if (!this._lastPoint) {\n      this._lastPoint = point;\n    }\n\n    var coordOffset = coord.sub(this._lastCoord),\n        pointOffset = point.sub(this._lastPoint);\n    this._lastCoord = coord;\n    this._lastPoint = point;\n    this.target.setCoordinates(this.target.getCoordinates().add(coordOffset));\n    eventParam['coordOffset'] = coordOffset;\n    eventParam['pointOffset'] = pointOffset;\n    target.fire('dragging', eventParam);\n  };\n\n  _proto2._endDrag = function _endDrag(param) {\n    var target = this.target,\n        map = target.getMap();\n\n    if (this._dragHandler) {\n      target.off('click', this._endDrag, this);\n\n      this._dragHandler.disable();\n\n      delete this._dragHandler;\n    }\n\n    delete this._lastCoord;\n    delete this._lastPoint;\n    this._isDragging = false;\n\n    if (!map) {\n      return;\n    }\n\n    var eventParam = map._parseEvent(param['domEvent']);\n\n    target.fire('dragend', eventParam);\n  };\n\n  _proto2.isDragging = function isDragging() {\n    if (!this._isDragging) {\n      return false;\n    }\n\n    return true;\n  };\n\n  return UIMarkerDragHandler;\n}(Handler$1);\n\nUIMarker.addInitHook('addHandler', 'draggable', UIMarkerDragHandler);\n\nvar PROPERTY_PATTERN = /\\{ *([\\w_]+) *\\}/g;\nvar options$l = {\n  'containerClass': 'maptalks-msgBox',\n  'autoPan': true,\n  'autoCloseOn': null,\n  'autoOpenOn': 'click',\n  'width': 'auto',\n  'minHeight': 120,\n  'custom': false,\n  'title': null,\n  'content': null,\n  'enableTemplate': false\n};\nvar EMPTY_SIZE = new Size(0, 0);\n\nvar InfoWindow = function (_UIComponent) {\n  _inheritsLoose(InfoWindow, _UIComponent);\n\n  function InfoWindow() {\n    return _UIComponent.apply(this, arguments) || this;\n  }\n\n  var _proto = InfoWindow.prototype;\n\n  _proto._getClassName = function _getClassName() {\n    return 'InfoWindow';\n  };\n\n  _proto.addTo = function addTo(owner) {\n    if (owner instanceof Geometry) {\n      if (owner.getInfoWindow() && owner.getInfoWindow() !== this) {\n        owner.removeInfoWindow();\n      }\n\n      owner._infoWindow = this;\n    }\n\n    return _UIComponent.prototype.addTo.call(this, owner);\n  };\n\n  _proto.setContent = function setContent(content) {\n    var old = this.options['content'];\n    this.options['content'] = content;\n    this.fire('contentchange', {\n      'old': old,\n      'new': content\n    });\n\n    if (this.isVisible()) {\n      this.show(this._coordinate);\n    }\n\n    return this;\n  };\n\n  _proto.getContent = function getContent() {\n    return this.options['content'];\n  };\n\n  _proto.setTitle = function setTitle(title) {\n    var old = title;\n    this.options['title'] = title;\n    this.fire('contentchange', {\n      'old': old,\n      'new': title\n    });\n\n    if (this.isVisible()) {\n      this.show(this._coordinate);\n    }\n\n    return this;\n  };\n\n  _proto.getTitle = function getTitle() {\n    return this.options['title'];\n  };\n\n  _proto.buildOn = function buildOn() {\n    if (this.options['custom']) {\n      if (isString(this.options['content'])) {\n        var _dom = createEl('div');\n\n        _dom.innerHTML = this.options['content'];\n\n        this._replaceTemplate(_dom);\n\n        return _dom;\n      } else {\n        this._replaceTemplate(this.options['content']);\n\n        return this.options['content'];\n      }\n    }\n\n    var dom = createEl('div');\n\n    if (this.options['containerClass']) {\n      dom.className = this.options['containerClass'];\n    }\n\n    var width = this._getWindowWidth();\n\n    dom.style.width = isNumber(width) ? width + 'px' : 'auto';\n    dom.style.bottom = '0px';\n    var content = '<em class=\"maptalks-ico\"></em>';\n\n    if (this.options['title']) {\n      content += '<h2>' + this.options['title'] + '</h2>';\n    }\n\n    content += '<a href=\"javascript:void(0);\" class=\"maptalks-close\"></a><div class=\"maptalks-msgContent\"></div>';\n    dom.innerHTML = content;\n\n    this._replaceTemplate(dom);\n\n    var msgContent = dom.querySelector('.maptalks-msgContent');\n\n    if (isString(this.options['content'])) {\n      msgContent.innerHTML = this.options['content'];\n    } else {\n      msgContent.appendChild(this.options['content']);\n    }\n\n    this._onCloseBtnClick = this.hide.bind(this);\n    var closeBtn = dom.querySelector('.maptalks-close');\n    addDomEvent(closeBtn, 'click touchend', this._onCloseBtnClick);\n\n    this._replaceTemplate(msgContent);\n\n    return dom;\n  };\n\n  _proto._replaceTemplate = function _replaceTemplate(dom) {\n    if (this.options['enableTemplate'] && this._owner && this._owner.getProperties && dom && dom.innerHTML) {\n      var properties = this._owner.getProperties() || {};\n\n      if (isObject(properties)) {\n        var html = dom.innerHTML;\n        dom.innerHTML = html.replace(PROPERTY_PATTERN, function (str, key) {\n          return properties[key];\n        });\n      }\n    }\n\n    return this;\n  };\n\n  _proto.getTransformOrigin = function getTransformOrigin() {\n    var size = this.getSize();\n    return size.width / 2 + 'px bottom';\n  };\n\n  _proto.getOffset = function getOffset() {\n    var size = this.getSize();\n    var o = new Point(-size['width'] / 2, 0);\n\n    if (!this.options['custom']) {\n      o._sub(4, 12);\n    } else {\n      o._sub(0, size['height']);\n    }\n\n    var owner = this.getOwner();\n\n    if (owner instanceof Marker || owner instanceof MultiPoint) {\n      var painter, markerSize;\n\n      if (owner instanceof Marker) {\n        painter = owner._getPainter();\n        markerSize = owner.getSize();\n      } else {\n        var children = owner.getGeometries();\n\n        if (!children || !children.length) {\n          return o;\n        }\n\n        painter = children[0]._getPainter();\n        markerSize = children[0].getSize();\n      }\n\n      if (!markerSize) {\n        markerSize = EMPTY_SIZE;\n      }\n\n      if (painter) {\n        var fixExtent = painter.getFixedExtent();\n\n        o._add(fixExtent.xmax - markerSize.width / 2, fixExtent.ymin);\n      } else {\n        o._add(0, -markerSize.height);\n      }\n    }\n\n    return o;\n  };\n\n  _proto.show = function show(coordinate) {\n    if (!this.getMap()) {\n      return this;\n    }\n\n    if (!this.getMap().options['enableInfoWindow']) {\n      return this;\n    }\n\n    return _UIComponent.prototype.show.call(this, coordinate);\n  };\n\n  _proto.getEvents = function getEvents() {\n    if (!this.options['autoCloseOn']) {\n      return null;\n    }\n\n    var events = {};\n    events[this.options['autoCloseOn']] = this.hide;\n    return events;\n  };\n\n  _proto.getOwnerEvents = function getOwnerEvents() {\n    var owner = this.getOwner();\n\n    if (!this.options['autoOpenOn'] || !owner) {\n      return null;\n    }\n\n    var events = {};\n    events[this.options['autoOpenOn']] = this._onAutoOpen;\n    return events;\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.onDomRemove();\n  };\n\n  _proto.onDomRemove = function onDomRemove() {\n    if (this._onCloseBtnClick) {\n      var dom = this.getDOM();\n      var closeBtn = dom.childNodes[2];\n      removeDomEvent(closeBtn, 'click touchend', this._onCloseBtnClick);\n      delete this._onCloseBtnClick;\n    }\n  };\n\n  _proto._onAutoOpen = function _onAutoOpen(e) {\n    var _this = this;\n\n    var owner = this.getOwner();\n    setTimeout(function () {\n      if (owner instanceof Marker || owner instanceof UIComponent) {\n        _this.show(owner.getCoordinates());\n      } else if (owner instanceof MultiPoint) {\n        _this.show(owner.findClosest(e.coordinate));\n      } else if (owner instanceof LineString || owner instanceof MultiLineString) {\n        if (_this.getMap().getScale() >= 8) {\n          e.coordinate = _this._rectifyMouseCoordinte(owner, e.coordinate);\n        }\n\n        _this.show(e.coordinate);\n      } else {\n        _this.show(e.coordinate);\n      }\n    }, 1);\n  };\n\n  _proto._rectifyMouseCoordinte = function _rectifyMouseCoordinte(owner, mouseCoordinate) {\n    var _this2 = this;\n\n    if (owner instanceof LineString) {\n      return this._rectifyLineStringMouseCoordinate(owner, mouseCoordinate).coordinate;\n    } else if (owner instanceof MultiLineString) {\n      return owner.getGeometries().map(function (lineString) {\n        return _this2._rectifyLineStringMouseCoordinate(lineString, mouseCoordinate);\n      }).sort(function (a, b) {\n        return a.dis - b.dis;\n      })[0].coordinate;\n    }\n\n    return mouseCoordinate;\n  };\n\n  _proto._rectifyLineStringMouseCoordinate = function _rectifyLineStringMouseCoordinate(lineString, mouseCoordinate) {\n    var _this3 = this;\n\n    var pts = lineString.getCoordinates().map(function (coordinate) {\n      return _this3.getMap().coordToContainerPoint(coordinate);\n    });\n    var mousePt = this.getMap().coordToContainerPoint(mouseCoordinate);\n    var minDis = Infinity,\n        coordinateIndex = -1;\n\n    for (var i = 0, len = pts.length; i < len; i++) {\n      var pt = pts[i];\n      var dis = mousePt.distanceTo(pt);\n\n      if (dis < minDis) {\n        minDis = dis;\n        coordinateIndex = i;\n      }\n    }\n\n    var filterPts = [];\n\n    if (coordinateIndex === 0) {\n      filterPts.push(pts[0], pts[1]);\n    } else if (coordinateIndex === pts.length - 1) {\n      filterPts.push(pts[coordinateIndex - 1], pts[coordinateIndex]);\n    } else {\n      filterPts.push(pts[coordinateIndex - 1], pts[coordinateIndex], pts[coordinateIndex + 1]);\n    }\n\n    var xys = [];\n\n    var _this$getMap$getSize = this.getMap().getSize(),\n        width = _this$getMap$getSize.width,\n        height = _this$getMap$getSize.height;\n\n    for (var _i = 0, _len = filterPts.length - 1; _i < _len; _i++) {\n      var pt1 = filterPts[_i],\n          pt2 = filterPts[_i + 1];\n\n      if (pt1.x === pt2.x) {\n        var miny = Math.max(0, Math.min(pt1.y, pt2.y));\n        var maxy = Math.min(height, Math.max(pt1.y, pt2.y));\n\n        for (var y = miny; y <= maxy; y++) {\n          xys.push(new Point(pt1.x, y));\n        }\n      } else {\n        var k = (pt2.y - pt1.y) / (pt2.x - pt1.x);\n        var minx = Math.max(0, Math.min(pt1.x, pt2.x));\n        var maxx = Math.min(width, Math.max(pt1.x, pt2.x));\n\n        for (var x = minx; x <= maxx; x++) {\n          var _y = k * (x - pt1.x) + pt1.y;\n\n          xys.push(new Point(x, _y));\n        }\n      }\n    }\n\n    var minPtDis = Infinity,\n        ptIndex = -1;\n\n    for (var _i2 = 0, _len2 = xys.length; _i2 < _len2; _i2++) {\n      var _pt = xys[_i2];\n\n      var _dis = mousePt.distanceTo(_pt);\n\n      if (_dis < minPtDis) {\n        minPtDis = _dis;\n        ptIndex = _i2;\n      }\n    }\n\n    return {\n      dis: minPtDis,\n      coordinate: ptIndex < 0 ? mouseCoordinate : this.getMap().containerPointToCoord(xys[ptIndex])\n    };\n  };\n\n  _proto._getWindowWidth = function _getWindowWidth() {\n    var defaultWidth = options$l.width;\n    var width = this.options['width'];\n\n    if (!width) {\n      width = defaultWidth;\n    }\n\n    return width;\n  };\n\n  return InfoWindow;\n}(UIComponent);\n\nInfoWindow.mergeOptions(options$l);\n\nvar HIDEDOMEVENTS = 'remove hide shapechange positionchange dragend animatestart';\nvar options$m = {\n  'width': 0,\n  'height': 0,\n  'animation': 'fade',\n  'containerClass': 'maptalks-tooltip',\n  'showTimeout': 400\n};\n\nvar ToolTip = function (_UIComponent) {\n  _inheritsLoose(ToolTip, _UIComponent);\n\n  var _proto = ToolTip.prototype;\n\n  _proto._getClassName = function _getClassName() {\n    return 'ToolTip';\n  };\n\n  function ToolTip(content, options) {\n    var _this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    _this = _UIComponent.call(this, options) || this;\n    _this._content = content;\n    return _this;\n  }\n\n  _proto.addTo = function addTo(owner) {\n    if (ToolTip.isSupport(owner)) {\n      owner.on('mousemove', this.onMouseMove, this);\n      owner.on('mouseout', this.onMouseOut, this);\n      owner.on(HIDEDOMEVENTS, this.hideDom, this);\n      return _UIComponent.prototype.addTo.call(this, owner);\n    } else {\n      throw new Error('Invalid geometry or UIMarker the tooltip is added to.');\n    }\n  };\n\n  _proto.setStyle = function setStyle$$1(cssName) {\n    this.options.containerClass = cssName;\n    return this;\n  };\n\n  _proto.getStyle = function getStyle() {\n    return this.options.containerClass;\n  };\n\n  _proto.getContent = function getContent() {\n    return this._content;\n  };\n\n  _proto.buildOn = function buildOn() {\n    var dom = createEl('div');\n    var options = this.options || {};\n\n    if (options.height) {\n      dom.style.height = options.height + 'px';\n    }\n\n    if (options.width) {\n      dom.style.width = options.width + 'px';\n    }\n\n    var cssName = options.containerClass || options.cssName;\n\n    if (!cssName && options.height) {\n      dom.style.lineHeight = options.height + 'px';\n    }\n\n    dom.innerHTML = \"<div class=\\\"\" + cssName + \"\\\">\" + this._content + \"</div>\";\n    return dom;\n  };\n\n  _proto.onMouseOut = function onMouseOut() {\n    clearTimeout(this._timeout);\n\n    if (this.isVisible()) {\n      this._removePrevDOM();\n    }\n\n    this._switchMapEvents('off');\n  };\n\n  _proto.onMouseMove = function onMouseMove(e) {\n    var _this2 = this;\n\n    clearTimeout(this._timeout);\n    var map = this.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    var coord = map.locateByPoint(e.coordinate, -5, 25);\n\n    if (this.options['showTimeout'] === 0) {\n      this.show(coord);\n    } else {\n      this._timeout = setTimeout(function () {\n        if (map) {\n          _this2.show(coord);\n        }\n      }, this.options['showTimeout']);\n    }\n  };\n\n  _proto.onRemove = function onRemove() {\n    clearTimeout(this._timeout);\n\n    if (this._owner) {\n      this._owner.off('mouseover', this.onMouseOver, this);\n\n      this._owner.off('mouseout', this.onMouseOut, this);\n\n      this._owner.off(HIDEDOMEVENTS, this.hideDom, this);\n    }\n  };\n\n  _proto.hideDom = function hideDom() {\n    return this.hide();\n  };\n\n  _proto.onEvent = function onEvent() {\n    _UIComponent.prototype.onEvent.call(this);\n\n    this.hideDom();\n    return this;\n  };\n\n  _proto._getViewPoint = function _getViewPoint() {\n    return this.getMap().coordToViewPoint(this._coordinate, undefined, 0)._add(this.options['dx'], this.options['dy']);\n  };\n\n  return ToolTip;\n}(UIComponent);\n\nToolTip.mergeOptions(options$m);\n\nvar defaultOptions = {\n  'containerClass': 'maptalks-menu',\n  'animation': null,\n  'animationDelay': 10,\n  'animationOnHide': false,\n  'autoPan': false,\n  'width': 160,\n  'maxHeight': 0,\n  'custom': false,\n  'items': []\n};\n\nvar Menu = function (_UIComponent) {\n  _inheritsLoose(Menu, _UIComponent);\n\n  function Menu(options) {\n    return _UIComponent.call(this, options) || this;\n  }\n\n  var _proto = Menu.prototype;\n\n  _proto._getClassName = function _getClassName() {\n    return 'Menu';\n  };\n\n  _proto.addTo = function addTo(owner) {\n    if (owner._menu && owner._menu !== this) {\n      owner.removeMenu();\n    }\n\n    owner._menu = this;\n    this._owner = owner;\n    return UIComponent.prototype.addTo.apply(this, arguments);\n  };\n\n  _proto.setItems = function setItems(items) {\n    this.options['items'] = items;\n    return this;\n  };\n\n  _proto.getItems = function getItems() {\n    return this.options['items'] || [];\n  };\n\n  _proto.buildOn = function buildOn() {\n    if (this.options['custom']) {\n      if (isString(this.options['items'])) {\n        var container = createEl('div');\n        container.innerHTML = this.options['items'];\n        return container;\n      } else {\n        return this.options['items'];\n      }\n    } else {\n      var dom = createEl('div');\n\n      if (this.options['containerClass']) {\n        addClass(dom, this.options['containerClass']);\n      }\n\n      dom.style.width = this._getMenuWidth() + 'px';\n\n      var menuItems = this._createMenuItemDom();\n\n      dom.appendChild(menuItems);\n      on(dom, 'contextmenu', preventDefault);\n      return dom;\n    }\n  };\n\n  _proto.getOffset = function getOffset() {\n    if (!this.getMap()) {\n      return null;\n    }\n\n    var mapSize = this.getMap().getSize(),\n        p = this.getMap().viewPointToContainerPoint(this._getViewPoint()),\n        size = this.getSize();\n    var dx = 0,\n        dy = 0;\n\n    if (p.x + size['width'] > mapSize['width']) {\n      dx = -size['width'];\n    }\n\n    if (p.y + size['height'] > mapSize['height']) {\n      dy = -size['height'];\n    }\n\n    return new Point(dx, dy);\n  };\n\n  _proto.getTransformOrigin = function getTransformOrigin() {\n    var p = this.getOffset()._multi(-1);\n\n    return p.x + 'px ' + p.y + 'px';\n  };\n\n  _proto.getEvents = function getEvents() {\n    return {\n      '_zoomstart _zoomend _movestart _dblclick _click': this._removePrevDOM\n    };\n  };\n\n  _proto._createMenuItemDom = function _createMenuItemDom() {\n    var me = this;\n    var map = this.getMap();\n    var ul = createEl('ul');\n    addClass(ul, 'maptalks-menu-items');\n    var items = this.getItems();\n\n    function onMenuClick(index) {\n      return function (e) {\n        var param = map._parseEvent(e, 'click');\n\n        param['target'] = me;\n        param['owner'] = me._owner;\n        param['index'] = index;\n\n        var result = this._callback(param);\n\n        if (result === false) {\n          return;\n        }\n\n        me.hide();\n\n        if (me._owner) {\n          me._owner.fire('closemenu');\n        }\n      };\n    }\n\n    var item, itemDOM;\n\n    for (var i = 0, len = items.length; i < len; i++) {\n      item = items[i];\n\n      if (item === '-' || item === '_') {\n        itemDOM = createEl('li');\n        addClass(itemDOM, 'maptalks-menu-splitter');\n      } else {\n        itemDOM = createEl('li');\n        var itemTitle = item['item'];\n\n        if (isFunction(itemTitle)) {\n          itemTitle = itemTitle({\n            'owner': this._owner,\n            'index': i\n          });\n        }\n\n        itemDOM.innerHTML = itemTitle;\n        itemDOM._callback = item['click'];\n        on(itemDOM, 'click', onMenuClick(i));\n      }\n\n      ul.appendChild(itemDOM);\n    }\n\n    var maxHeight = this.options['maxHeight'] || 0;\n\n    if (maxHeight > 0) {\n      setStyle(ul, 'max-height: ' + maxHeight + 'px; overflow-y: auto;');\n    }\n\n    return ul;\n  };\n\n  _proto._getMenuWidth = function _getMenuWidth() {\n    var defaultWidth = 160;\n    var width = this.options['width'] || defaultWidth;\n    return width;\n  };\n\n  return Menu;\n}(UIComponent);\n\nMenu.mergeOptions(defaultOptions);\n\nvar Menuable = {\n  setMenu: function setMenu(options) {\n    this._menuOptions = options;\n\n    if (this._menu) {\n      this._menu.setOptions(options);\n    } else {\n      this.on('contextmenu', this._defaultOpenMenu, this);\n    }\n\n    return this;\n  },\n  getMenu: function getMenu() {\n    return this._menu;\n  },\n  openMenu: function openMenu(coordinate) {\n    var map = this instanceof Map$1 ? this : this.getMap();\n\n    if (!coordinate) {\n      coordinate = this.getCenter();\n    }\n\n    if (!this._menu) {\n      if (this._menuOptions && map) {\n        this._bindMenu();\n\n        this._menu.show(coordinate);\n      }\n    } else {\n      this._menu.show(coordinate);\n    }\n\n    this.fire('openmenu', {\n      coordinate: coordinate\n    });\n    return this;\n  },\n  setMenuItems: function setMenuItems(items) {\n    if (!this._menuOptions) {\n      this._menuOptions = {};\n    }\n\n    if (Array.isArray(items)) {\n      this._menuOptions['custom'] = false;\n    }\n\n    this._menuOptions['items'] = items;\n    this.setMenu(this._menuOptions);\n    return this;\n  },\n  getMenuItems: function getMenuItems() {\n    if (this._menu) {\n      return this._menu.getItems();\n    } else if (this._menuOptions) {\n      return this._menuOptions['items'] || [];\n    }\n\n    return [];\n  },\n  closeMenu: function closeMenu() {\n    if (this._menu) {\n      this._menu.hide();\n    }\n\n    this.fire('closemenu', {});\n    return this;\n  },\n  removeMenu: function removeMenu() {\n    this.off('contextmenu', this._defaultOpenMenu, this);\n\n    this._unbindMenu();\n\n    delete this._menuOptions;\n    this.fire('removemenu', {});\n    return this;\n  },\n  _bindMenu: function _bindMenu() {\n    if (!this._menuOptions) {\n      return this;\n    }\n\n    this._menu = new Menu(this._menuOptions);\n\n    this._menu.addTo(this);\n\n    return this;\n  },\n  _unbindMenu: function _unbindMenu() {\n    if (this._menu) {\n      this.closeMenu();\n\n      this._menu.remove();\n\n      delete this._menu;\n    }\n\n    return this;\n  },\n  _defaultOpenMenu: function _defaultOpenMenu(param) {\n    this.openMenu(param['coordinate']);\n    return false;\n  }\n};\nMap$1.include(Menuable);\nGeometry.include(Menuable);\n\n\n\nvar index$4 = /*#__PURE__*/Object.freeze({\n  UIComponent: UIComponent,\n  UIMarker: UIMarker,\n  InfoWindow: InfoWindow,\n  ToolTip: ToolTip,\n  Menuable: Menuable,\n  Menu: Menu\n});\n\nvar Control = function (_Eventable) {\n  _inheritsLoose(Control, _Eventable);\n\n  function Control(options) {\n    if (options && options['position'] && !isString(options['position'])) {\n      options['position'] = extend({}, options['position']);\n    }\n\n    return _Eventable.call(this, options) || this;\n  }\n\n  var _proto = Control.prototype;\n\n  _proto.addTo = function addTo(map) {\n    this.remove();\n\n    if (!map.options['control']) {\n      return this;\n    }\n\n    this._map = map;\n    var controlContainer = map._panels.control;\n    this.__ctrlContainer = createEl('div');\n    setStyle(this.__ctrlContainer, 'position:absolute;overflow:visible;');\n    this.update();\n    controlContainer.appendChild(this.__ctrlContainer);\n\n    if (this.onAdd) {\n      this.onAdd();\n    }\n\n    this.fire('add', {\n      'dom': controlContainer\n    });\n    return this;\n  };\n\n  _proto.update = function update() {\n    this.__ctrlContainer.innerHTML = '';\n    this._controlDom = this.buildOn(this.getMap());\n\n    if (this._controlDom) {\n      this._updatePosition();\n\n      this.__ctrlContainer.appendChild(this._controlDom);\n    }\n\n    return this;\n  };\n\n  _proto.getMap = function getMap() {\n    return this._map;\n  };\n\n  _proto.getPosition = function getPosition() {\n    return extend({}, this._parse(this.options['position']));\n  };\n\n  _proto.setPosition = function setPosition(position) {\n    if (isString(position)) {\n      this.options['position'] = position;\n    } else {\n      this.options['position'] = extend({}, position);\n    }\n\n    this._updatePosition();\n\n    return this;\n  };\n\n  _proto.getContainerPoint = function getContainerPoint() {\n    var position = this.getPosition();\n    var size = this.getMap().getSize();\n    var x, y;\n\n    if (!isNil(position['left'])) {\n      x = parseInt(position['left']);\n    } else if (!isNil(position['right'])) {\n      x = size['width'] - parseInt(position['right']);\n    }\n\n    if (!isNil(position['top'])) {\n      y = parseInt(position['top']);\n    } else if (!isNil(position['bottom'])) {\n      y = size['height'] - parseInt(position['bottom']);\n    }\n\n    return new Point(x, y);\n  };\n\n  _proto.getContainer = function getContainer() {\n    return this.__ctrlContainer;\n  };\n\n  _proto.getDOM = function getDOM() {\n    return this._controlDom;\n  };\n\n  _proto.show = function show() {\n    this.__ctrlContainer.style.display = '';\n    return this;\n  };\n\n  _proto.hide = function hide() {\n    this.__ctrlContainer.style.display = 'none';\n    return this;\n  };\n\n  _proto.isVisible = function isVisible() {\n    return this.__ctrlContainer && this.__ctrlContainer.style.display === '';\n  };\n\n  _proto.remove = function remove() {\n    if (!this._map) {\n      return this;\n    }\n\n    removeDomNode(this.__ctrlContainer);\n\n    if (this.onRemove) {\n      this.onRemove();\n    }\n\n    delete this._map;\n    delete this.__ctrlContainer;\n    delete this._controlDom;\n    this.fire('remove');\n    return this;\n  };\n\n  _proto._parse = function _parse(position) {\n    var p = position;\n\n    if (isString(position)) {\n      p = Control['positions'][p];\n    }\n\n    return p;\n  };\n\n  _proto._updatePosition = function _updatePosition() {\n    var position = this.getPosition();\n\n    if (!position) {\n      position = {\n        'top': 20,\n        'left': 20\n      };\n    }\n\n    for (var p in position) {\n      if (position.hasOwnProperty(p)) {\n        position[p] = parseInt(position[p]);\n        this.__ctrlContainer.style[p] = position[p] + 'px';\n      }\n    }\n\n    this.fire('positionchange', {\n      'position': extend({}, position)\n    });\n  };\n\n  return Control;\n}(Eventable(Class));\n\nControl.positions = {\n  'top-left': {\n    'top': 20,\n    'left': 20\n  },\n  'top-right': {\n    'top': 20,\n    'right': 20\n  },\n  'bottom-left': {\n    'bottom': 20,\n    'left': 20\n  },\n  'bottom-right': {\n    'bottom': 20,\n    'right': 20\n  }\n};\nMap$1.mergeOptions({\n  'control': true\n});\nMap$1.include({\n  addControl: function addControl(control) {\n    if (this._containerDOM.getContext) {\n      return this;\n    }\n\n    control.addTo(this);\n    return this;\n  },\n  removeControl: function removeControl(control) {\n    if (!control || control.getMap() !== this) {\n      return this;\n    }\n\n    control.remove();\n    return this;\n  }\n});\n\nvar options$n = {\n  'position': {\n    'bottom': 0,\n    'left': 0\n  },\n  'content': '<a href=\"http://maptalks.org\" target=\"_blank\">maptalks</a>'\n};\nvar layerEvents = 'addlayer removelayer setbaselayer baselayerremove';\n\nvar Attribution = function (_Control) {\n  _inheritsLoose(Attribution, _Control);\n\n  function Attribution() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = Attribution.prototype;\n\n  _proto.buildOn = function buildOn() {\n    this._attributionContainer = createEl('div');\n    this._attributionContainer.className = 'maptalks-attribution';\n\n    this._update();\n\n    return this._attributionContainer;\n  };\n\n  _proto.onAdd = function onAdd() {\n    this.getMap().on(layerEvents, this._update, this);\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.getMap().off(layerEvents, this._update, this);\n  };\n\n  _proto._update = function _update() {\n    var map = this.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    var attributions = map._getLayers(function (layer) {\n      return layer.options['attribution'];\n    }).reverse().map(function (layer) {\n      return layer.options['attribution'];\n    });\n\n    var content = this.options['content'] + (attributions.length > 0 ? ' - ' + attributions.join(', ') : '');\n    this._attributionContainer.innerHTML = '<span style=\"padding:0px 4px\">' + content + '</span>';\n  };\n\n  return Attribution;\n}(Control);\n\nAttribution.mergeOptions(options$n);\nMap$1.mergeOptions({\n  'attribution': true\n});\nMap$1.addOnLoadHook(function () {\n  var a = this.options['attribution'] || this.options['attributionControl'];\n\n  if (a) {\n    this.attributionControl = new Attribution(a);\n    this.addControl(this.attributionControl);\n  }\n});\n\nvar options$o = {\n  'position': 'top-right',\n  'baseTitle': 'Base Layers',\n  'overlayTitle': 'Layers',\n  'excludeLayers': [],\n  'containerClass': 'maptalks-layer-switcher'\n};\n\nvar LayerSwitcher = function (_Control) {\n  _inheritsLoose(LayerSwitcher, _Control);\n\n  function LayerSwitcher() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = LayerSwitcher.prototype;\n\n  _proto.buildOn = function buildOn() {\n    var container = this.container = createEl('div', this.options['containerClass']),\n        panel = this.panel = createEl('div', 'panel'),\n        button = this.button = createEl('button');\n    container.appendChild(button);\n    container.appendChild(panel);\n    return container;\n  };\n\n  _proto.onAdd = function onAdd() {\n    on(this.button, 'mouseover', this._show, this);\n    on(this.panel, 'mouseleave', this._hide, this);\n    on(this.getMap(), 'click', this._hide, this);\n  };\n\n  _proto.onRemove = function onRemove() {\n    if (this.panel) {\n      off(this.button, 'mouseover', this._show, this);\n      off(this.panel, 'mouseleave', this._hide, this);\n      off(this.getMap(), 'click', this._hide, this);\n      removeDomNode(this.panel);\n      removeDomNode(this.button);\n      delete this.panel;\n      delete this.button;\n      delete this.container;\n    }\n  };\n\n  _proto._show = function _show() {\n    if (!hasClass(this.container, 'shown')) {\n      addClass(this.container, 'shown');\n\n      this._createPanel();\n    }\n  };\n\n  _proto._hide = function _hide(e) {\n    if (!this.panel.contains(e.toElement || e.relatedTarget)) {\n      setClass(this.container, this.options['containerClass']);\n    }\n  };\n\n  _proto._createPanel = function _createPanel() {\n    this.panel.innerHTML = '';\n    var ul = createEl('ul');\n    this.panel.appendChild(ul);\n\n    this._renderLayers(this.getMap(), ul);\n  };\n\n  _proto._renderLayers = function _renderLayers(map, elm) {\n    var base = map.getBaseLayer(),\n        layers = map.getLayers(),\n        len = layers.length;\n\n    if (base) {\n      var baseLayers = base.layers || [base],\n          li = createEl('li', 'group'),\n          ul = createEl('ul'),\n          label = createEl('label');\n      label.innerHTML = this.options['baseTitle'];\n      li.appendChild(label);\n\n      for (var i = 0, _len = baseLayers.length; i < _len; i++) {\n        var layer = baseLayers[i];\n\n        if (this._isExcluded(layer)) {\n          ul.appendChild(this._renderLayer(baseLayers[i], true));\n          li.appendChild(ul);\n          elm.appendChild(li);\n        }\n      }\n    }\n\n    if (len) {\n      var _li = createEl('li', 'group'),\n          _ul = createEl('ul'),\n          _label = createEl('label');\n\n      _label.innerHTML = this.options['overlayTitle'];\n\n      _li.appendChild(_label);\n\n      for (var _i = 0; _i < len; _i++) {\n        var _layer = layers[_i];\n\n        if (this._isExcluded(_layer)) {\n          _ul.appendChild(this._renderLayer(_layer));\n        }\n      }\n\n      _li.appendChild(_ul);\n\n      elm.appendChild(_li);\n    }\n  };\n\n  _proto._isExcluded = function _isExcluded(layer) {\n    var id = layer.getId(),\n        excludeLayers = this.options['excludeLayers'];\n    return !(excludeLayers.length && excludeLayers.indexOf(id) >= 0);\n  };\n\n  _proto._renderLayer = function _renderLayer(layer, isBase) {\n    var _this = this;\n\n    var li = createEl('li', 'layer'),\n        label = createEl('label'),\n        input = createEl('input'),\n        map = this.getMap();\n    var visible = layer.options['visible'];\n    layer.options['visible'] = true;\n    var enabled = layer.isVisible();\n    layer.options['visible'] = visible;\n    li.className = 'layer';\n\n    if (isBase) {\n      input.type = 'radio';\n      input.name = 'base';\n    } else {\n      input.type = 'checkbox';\n    }\n\n    input.checked = visible && enabled;\n\n    if (!enabled) {\n      input.setAttribute('disabled', 'disabled');\n    }\n\n    input.onchange = function (e) {\n      if (e.target.type === 'radio') {\n        var baseLayer = map.getBaseLayer(),\n            baseLayers = baseLayer.layers;\n\n        if (baseLayers) {\n          for (var i = 0, len = baseLayers.length; i < len; i++) {\n            var _baseLayer = baseLayers[i];\n\n            _baseLayer[_baseLayer === layer ? 'show' : 'hide']();\n          }\n        } else if (!baseLayer.isVisible()) {\n          baseLayer.show();\n        }\n\n        map._fireEvent('setbaselayer');\n      } else {\n        layer[e.target.checked ? 'show' : 'hide']();\n      }\n\n      _this.fire('layerchange', {\n        target: layer\n      });\n    };\n\n    li.appendChild(input);\n    label.innerHTML = layer.getId();\n    li.appendChild(label);\n    return li;\n  };\n\n  return LayerSwitcher;\n}(Control);\n\nLayerSwitcher.mergeOptions(options$o);\nMap$1.mergeOptions({\n  'layerSwitcherControl': false\n});\nMap$1.addOnLoadHook(function () {\n  if (this.options['layerSwitcherControl']) {\n    this.layerSwitcherControl = new LayerSwitcher(this.options['layerSwitcherControl']);\n    this.addControl(this.layerSwitcherControl);\n  }\n});\n\nvar options$p = {\n  'level': 4,\n  'position': {\n    'right': 1,\n    'bottom': 1\n  },\n  'size': [300, 200],\n  'maximize': true,\n  'symbol': {\n    'lineWidth': 3,\n    'lineColor': '#1bbc9b',\n    'polygonFill': '#1bbc9b',\n    'polygonOpacity': 0.4\n  },\n  'containerClass': 'maptalks-overview',\n  'buttonClass': 'maptalks-overview-button'\n};\n\nvar Overview = function (_Control) {\n  _inheritsLoose(Overview, _Control);\n\n  function Overview() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = Overview.prototype;\n\n  _proto.buildOn = function buildOn() {\n    var size = this.options['size'];\n\n    if (!this.options['maximize']) {\n      size = [0, 0];\n    }\n\n    var container = createEl('div');\n    var mapContainer = this.mapContainer = createEl('div');\n    mapContainer.style.width = size[0] + 'px';\n    mapContainer.style.height = size[1] + 'px';\n    mapContainer.className = this.options['containerClass'];\n    var button = this.button = createEl('div');\n    button.className = this.options['buttonClass'];\n    container.appendChild(mapContainer);\n    container.appendChild(button);\n    return container;\n  };\n\n  _proto.onAdd = function onAdd() {\n    if (this.options['maximize']) {\n      this._createOverview();\n    }\n\n    this.getMap().on('resize moving zooming rotate dragrotating viewchange', this._update, this).on('setbaselayer', this._updateBaseLayer, this).on('spatialreferencechange', this._updateSpatialReference, this);\n    on(this.button, 'click', this._onButtonClick, this);\n\n    this._updateButtonText();\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.getMap().off('resize moving zooming rotate dragrotating viewchange', this._update, this).off('setbaselayer', this._updateBaseLayer, this).off('spatialreferencechange', this._updateSpatialReference, this);\n\n    if (this._overview) {\n      this._overview.remove();\n\n      delete this._overview;\n      delete this._perspective;\n    }\n\n    off(this.button, 'click', this._onButtonClick, this);\n  };\n\n  _proto.maxmize = function maxmize() {\n    var size = this.options['size'];\n    var dom = this.mapContainer;\n    dom.style.width = size[0] + 'px';\n    dom.style.height = size[1] + 'px';\n\n    this._createOverview();\n\n    return this;\n  };\n\n  _proto.minimize = function minimize() {\n    if (this._overview) {\n      this._overview.remove();\n    }\n\n    delete this._overview;\n    delete this._perspective;\n    var dom = this.mapContainer;\n    dom.style.width = 0 + 'px';\n    dom.style.height = 0 + 'px';\n    return this;\n  };\n\n  _proto.getOverviewMap = function getOverviewMap() {\n    return this._overview;\n  };\n\n  _proto._onButtonClick = function _onButtonClick() {\n    if (!this._overview) {\n      this.maxmize();\n    } else {\n      this.minimize();\n    }\n\n    this._updateButtonText();\n  };\n\n  _proto._updateButtonText = function _updateButtonText() {\n    if (this._overview) {\n      this.button.innerHTML = '-';\n    } else {\n      this.button.innerHTML = '+';\n    }\n  };\n\n  _proto._createOverview = function _createOverview() {\n    var map = this.getMap(),\n        dom = this.mapContainer;\n    var options = map.config();\n    extend(options, {\n      'center': map.getCenter(),\n      'zoom': this._getOverviewZoom(),\n      'zoomAnimationDuration': 150,\n      'pitch': 0,\n      'bearing': 0,\n      'scrollWheelZoom': false,\n      'checkSize': false,\n      'doubleClickZoom': false,\n      'touchZoom': false,\n      'control': false,\n      'draggable': false,\n      'maxExtent': null\n    });\n    this._overview = new Map$1(dom, options);\n\n    this._updateBaseLayer();\n\n    this._perspective = new Polygon(this._getPerspectiveCoords(), {\n      'draggable': true,\n      'cursor': 'move',\n      'symbol': this.options['symbol']\n    }).on('dragend', this._onDragEnd, this);\n    new VectorLayer('perspective_layer', this._perspective).addTo(this._overview);\n    this.fire('load');\n  };\n\n  _proto._getOverviewZoom = function _getOverviewZoom() {\n    var map = this.getMap(),\n        zoom = map.getZoom(),\n        minZoom = map.getMinZoom(),\n        level = this.options['level'];\n\n    if (level > 0) {\n      for (var i = level; i > 0; i--) {\n        if (zoom - i >= minZoom) {\n          return zoom - i;\n        }\n      }\n    } else {\n      for (var _i = level; _i < 0; _i++) {\n        if (zoom - _i >= minZoom) {\n          return zoom - _i;\n        }\n      }\n    }\n\n    return zoom;\n  };\n\n  _proto._onDragEnd = function _onDragEnd() {\n    var center = this._perspective.getCenter();\n\n    this._overview.setCenter(center);\n\n    this.getMap().panTo(center);\n  };\n\n  _proto._getPerspectiveCoords = function _getPerspectiveCoords() {\n    var map = this.getMap();\n    return map.getContainerExtent().toArray().map(function (c) {\n      return map.containerPointToCoordinate(c);\n    });\n  };\n\n  _proto._update = function _update() {\n    if (!this._overview) {\n      return;\n    }\n\n    computeDomPosition(this._overview._containerDOM);\n\n    var coords = this._getPerspectiveCoords();\n\n    this._perspective.setCoordinates(coords);\n\n    this._overview.setCenterAndZoom(this.getMap().getCenter(), this._getOverviewZoom());\n  };\n\n  _proto._updateSpatialReference = function _updateSpatialReference() {\n    if (!this._overview) {\n      return;\n    }\n\n    var map = this.getMap();\n    var spatialRef = map.options['spatialReference'];\n\n    this._overview.setSpatialReference(spatialRef);\n  };\n\n  _proto._updateBaseLayer = function _updateBaseLayer() {\n    if (!this._overview) {\n      return;\n    }\n\n    var map = this.getMap(),\n        baseLayer = map.getBaseLayer();\n\n    if (!baseLayer) {\n      this._overview.setBaseLayer(null);\n\n      return;\n    }\n\n    var layers = baseLayer.layers;\n    var showIndex = 0;\n\n    if (layers) {\n      for (var i = 0, l = layers.length; i < l; i++) {\n        var _layer = layers[i];\n\n        if (_layer.isVisible()) {\n          showIndex = i;\n          break;\n        }\n      }\n    }\n\n    var json = baseLayer.toJSON();\n    var options = null;\n\n    if (layers) {\n      options = json.layers[showIndex].options;\n      options.visible = true;\n    } else {\n      options = json.options;\n    }\n\n    this._overview.setMinZoom(options.minZoom || null).setMaxZoom(options.maxZoom || null);\n\n    delete options.minZoom;\n    delete options.maxZoom;\n    delete json.options.canvas;\n    json.options.visible = true;\n    json.options.renderer = 'canvas';\n    var layer = Layer.fromJSON(json);\n\n    for (var p in baseLayer) {\n      if (isFunction(baseLayer[p]) && baseLayer.hasOwnProperty(p) && baseLayer[p] !== baseLayer.constructor.prototype[p]) {\n        layer[p] = baseLayer[p];\n      }\n    }\n\n    this._overview.setBaseLayer(layer);\n  };\n\n  return Overview;\n}(Control);\n\nOverview.mergeOptions(options$p);\nMap$1.mergeOptions({\n  'overviewControl': false\n});\nMap$1.addOnLoadHook(function () {\n  if (this.options['overviewControl']) {\n    this.overviewControl = new Overview(this.options['overviewControl']);\n    this.addControl(this.overviewControl);\n  }\n});\n\nvar options$q = {\n  'position': 'top-right',\n  'draggable': true,\n  'custom': false,\n  'content': '',\n  'closeButton': true\n};\n\nvar Panel = function (_Control) {\n  _inheritsLoose(Panel, _Control);\n\n  function Panel() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = Panel.prototype;\n\n  _proto.buildOn = function buildOn() {\n    var dom;\n\n    if (this.options['custom']) {\n      if (isString(this.options['content'])) {\n        dom = createEl('div');\n        dom.innerHTML = this.options['content'];\n      } else {\n        dom = this.options['content'];\n      }\n    } else {\n      dom = createEl('div', 'maptalks-panel');\n\n      if (this.options['closeButton']) {\n        var closeButton = createEl('a', 'maptalks-close');\n        closeButton.href = 'javascript:;';\n\n        closeButton.onclick = function () {\n          dom.style.display = 'none';\n        };\n\n        dom.appendChild(closeButton);\n      }\n\n      var panelContent = createEl('div', 'maptalks-panel-content');\n      panelContent.innerHTML = this.options['content'];\n      dom.appendChild(panelContent);\n    }\n\n    this.draggable = new DragHandler(dom, {\n      'cancelOn': this._cancelOn.bind(this),\n      'ignoreMouseleave': true\n    });\n    this.draggable.on('dragstart', this._onDragStart, this).on('dragging', this._onDragging, this).on('dragend', this._onDragEnd, this);\n\n    if (this.options['draggable']) {\n      this.draggable.enable();\n    }\n\n    return dom;\n  };\n\n  _proto.update = function update() {\n    if (this.draggable) {\n      this.draggable.disable();\n      delete this.draggable;\n    }\n\n    return Control.prototype.update.call(this);\n  };\n\n  _proto.setContent = function setContent(content) {\n    var old = this.options['content'];\n    this.options['content'] = content;\n    this.fire('contentchange', {\n      'old': old,\n      'new': content\n    });\n\n    if (this.isVisible()) {\n      this.update();\n    }\n\n    return this;\n  };\n\n  _proto.getContent = function getContent() {\n    return this.options['content'];\n  };\n\n  _proto._cancelOn = function _cancelOn(domEvent) {\n    var target = domEvent.srcElement || domEvent.target,\n        tagName = target.tagName.toLowerCase();\n\n    if (tagName === 'button' || tagName === 'input' || tagName === 'select' || tagName === 'option' || tagName === 'textarea') {\n      return true;\n    }\n\n    return false;\n  };\n\n  _proto._onDragStart = function _onDragStart(param) {\n    this._startPos = param['mousePos'];\n    this._startPosition = extend({}, this.getPosition());\n    this.fire('dragstart', param);\n  };\n\n  _proto._onDragging = function _onDragging(param) {\n    var pos = param['mousePos'];\n    var offset = pos.sub(this._startPos);\n    var startPosition = this._startPosition;\n    var position = this.getPosition();\n\n    if (!isNil(position['top'])) {\n      position['top'] = parseInt(startPosition['top']) + offset.y;\n    }\n\n    if (!isNil(position['bottom'])) {\n      position['bottom'] = parseInt(startPosition['bottom']) - offset.y;\n    }\n\n    if (!isNil(position['left'])) {\n      position['left'] = parseInt(startPosition['left']) + offset.x;\n    }\n\n    if (!isNil(position['right'])) {\n      position['right'] = parseInt(startPosition['right']) - offset.x;\n    }\n\n    this.setPosition(position);\n    this.fire('dragging', param);\n  };\n\n  _proto._onDragEnd = function _onDragEnd(param) {\n    delete this._startPos;\n    delete this._startPosition;\n    this.fire('dragend', param);\n  };\n\n  _proto._getConnectPoints = function _getConnectPoints() {\n    var map = this.getMap();\n    var containerPoint = this.getContainerPoint();\n    var dom = this.getDOM(),\n        width = parseInt(dom.clientWidth),\n        height = parseInt(dom.clientHeight);\n    var anchors = [map.containerPointToCoordinate(containerPoint.add(width / 2, 0)), map.containerPointToCoordinate(containerPoint.add(width, height / 2)), map.containerPointToCoordinate(containerPoint.add(width / 2, height)), map.containerPointToCoordinate(containerPoint.add(0, height / 2))];\n    return anchors;\n  };\n\n  return Panel;\n}(Control);\n\nPanel.mergeOptions(options$q);\n\nvar options$r = {\n  'position': 'bottom-left',\n  'maxWidth': 100,\n  'metric': true,\n  'imperial': false,\n  'containerClass': null\n};\n\nvar Scale = function (_Control) {\n  _inheritsLoose(Scale, _Control);\n\n  function Scale() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = Scale.prototype;\n\n  _proto.buildOn = function buildOn(map) {\n    this._map = map;\n    this._scaleContainer = createEl('div', this.options['containerClass']);\n\n    this._addScales();\n\n    map.on('zoomend', this._update, this);\n\n    if (this._map._loaded) {\n      this._update();\n    }\n\n    return this._scaleContainer;\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.getMap().off('zoomend', this._update, this);\n  };\n\n  _proto._addScales = function _addScales() {\n    var css = 'border: 2px solid #000000;border-top: none;line-height: 1.1;padding: 0px;' + 'color: #000000;font-size: 11px;text-align:center;white-space: nowrap;overflow: hidden' + ';-moz-box-sizing: content-box;box-sizing: content-box;background: #fff; background: rgba(255, 255, 255, 0);';\n\n    if (this.options['metric']) {\n      this._mScale = createElOn('div', this.options['containerClass'] ? null : css, this._scaleContainer);\n    }\n\n    if (this.options['imperial']) {\n      this._iScale = createElOn('div', this.options['containerClass'] ? null : css, this._scaleContainer);\n    }\n  };\n\n  _proto._update = function _update() {\n    var map = this._map;\n    var maxMeters = map.pixelToDistance(this.options['maxWidth'], 0);\n\n    this._updateScales(maxMeters);\n  };\n\n  _proto._updateScales = function _updateScales(maxMeters) {\n    if (this.options['metric'] && maxMeters) {\n      this._updateMetric(maxMeters);\n    }\n\n    if (this.options['imperial'] && maxMeters) {\n      this._updateImperial(maxMeters);\n    }\n  };\n\n  _proto._updateMetric = function _updateMetric(maxMeters) {\n    var meters = this._getRoundNum(maxMeters),\n        label = meters < 1000 ? meters + ' m' : meters / 1000 + ' km';\n\n    this._updateScale(this._mScale, label, meters / maxMeters);\n  };\n\n  _proto._updateImperial = function _updateImperial(maxMeters) {\n    var maxFeet = maxMeters * 3.2808399;\n    var maxMiles, miles, feet;\n\n    if (maxFeet > 5280) {\n      maxMiles = maxFeet / 5280;\n      miles = this._getRoundNum(maxMiles);\n\n      this._updateScale(this._iScale, miles + ' mile', miles / maxMiles);\n    } else {\n      feet = this._getRoundNum(maxFeet);\n\n      this._updateScale(this._iScale, feet + ' feet', feet / maxFeet);\n    }\n  };\n\n  _proto._updateScale = function _updateScale(scale, text, ratio) {\n    scale['style']['width'] = Math.round(this.options['maxWidth'] * ratio) + 'px';\n    scale['innerHTML'] = text;\n  };\n\n  _proto._getRoundNum = function _getRoundNum(num) {\n    var pow10 = Math.pow(10, (Math.floor(num) + '').length - 1);\n    var d = num / pow10;\n    d = d >= 10 ? 10 : d >= 5 ? 5 : d >= 3 ? 3 : d >= 2 ? 2 : 1;\n    return pow10 * d;\n  };\n\n  return Scale;\n}(Control);\n\nScale.mergeOptions(options$r);\nMap$1.mergeOptions({\n  'scaleControl': false\n});\nMap$1.addOnLoadHook(function () {\n  if (this.options['scaleControl']) {\n    this.scaleControl = new Scale(this.options['scaleControl']);\n    this.addControl(this.scaleControl);\n  }\n});\n\nvar options$s = {\n  'height': 28,\n  'vertical': false,\n  'position': 'top-right',\n  'reverseMenu': false,\n  'items': {}\n};\n\nvar Toolbar = function (_Control) {\n  _inheritsLoose(Toolbar, _Control);\n\n  function Toolbar() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = Toolbar.prototype;\n\n  _proto.buildOn = function buildOn(map) {\n    this._map = map;\n    var dom = createEl('div');\n    var ul = createEl('ul', 'maptalks-toolbar-hx');\n    dom.appendChild(ul);\n\n    if (this.options['vertical']) {\n      addClass(dom, 'maptalks-toolbar-vertical');\n    } else {\n      addClass(dom, 'maptalks-toolbar-horizonal');\n    }\n\n    var me = this;\n\n    function onButtonClick(fn, index, childIndex, targetDom) {\n      var item = me._getItems()[index];\n\n      return function (e) {\n        stopPropagation(e);\n        return fn({\n          'target': item,\n          'index': index,\n          'childIndex': childIndex,\n          'dom': targetDom\n        });\n      };\n    }\n\n    var items = this.options['items'];\n\n    if (isArrayHasData(items)) {\n      for (var i = 0, len = items.length; i < len; i++) {\n        var item = items[i];\n        var li = createEl('li');\n\n        if (this.options['height'] !== 28) {\n          li.style.lineHeight = this.options['height'] + 'px';\n        }\n\n        li.style.height = this.options['height'] + 'px';\n        li.style.cursor = 'pointer';\n\n        if (isHTML(item['item'])) {\n          li.style.textAlign = 'center';\n          var itemSize = measureDom('div', item['item']);\n          li.innerHTML = '<div style=\"margin-top:' + (this.options['height'] - itemSize['height']) / 2 + 'px;\">' + item['item'] + '</div>';\n        } else {\n          li.innerHTML = item['item'];\n        }\n\n        if (item['click']) {\n          on(li, 'click', onButtonClick(item['click'], i, null, li));\n        }\n\n        if (isArrayHasData(item['children'])) {\n          var dropMenu = this._createDropMenu(i);\n\n          li.appendChild(dropMenu);\n          li._menu = dropMenu;\n          on(li, 'mouseover', function () {\n            this._menu.style.display = '';\n          });\n          on(li, 'mouseout', function () {\n            this._menu.style.display = 'none';\n          });\n        }\n\n        ul.appendChild(li);\n      }\n    }\n\n    return dom;\n  };\n\n  _proto._createDropMenu = function _createDropMenu(index) {\n    var me = this;\n\n    function onButtonClick(fn, index, childIndex) {\n      var item = me._getItems()[index]['children'][childIndex];\n\n      return function (e) {\n        stopPropagation(e);\n        return fn({\n          'target': item,\n          'index': index,\n          'childIndex': childIndex\n        });\n      };\n    }\n\n    var menuDom = createEl('div', 'maptalks-dropMenu'),\n        items = this._getItems(),\n        len = items.length,\n        menuUL = createEl('ul'),\n        children = items[index]['children'];\n\n    if (index === len - 1 && children) {\n      menuDom.style.cssText = 'right: 0px;';\n      menuUL.style.cssText = 'right: 0px;position: absolute;';\n\n      if (this.options['reverseMenu']) {\n        menuUL.style.bottom = 0;\n      }\n    }\n\n    menuDom.appendChild(createEl('em', 'maptalks-ico'));\n    var liWidth = 0;\n\n    for (var i = 0, l = children.length; i < l; i++) {\n      var size = stringLength(children[i]['item'], '12px');\n\n      if (size.width > liWidth) {\n        liWidth = size.width;\n      }\n    }\n\n    for (var _i = 0, _l = children.length; _i < _l; _i++) {\n      var child = children[_i];\n      var li = createEl('li');\n      li.innerHTML = '<a href=\"javascript:;\">' + child['item'] + '</a>';\n      li.style.cursor = 'pointer';\n      li.style.width = liWidth + 24 + 'px';\n      on(li.childNodes[0], 'click', onButtonClick(child['click'], index, _i));\n      menuUL.appendChild(li);\n    }\n\n    if (this.options['vertical']) {\n      var width = liWidth < 95 ? 95 : liWidth;\n\n      if (this.options['reverseMenu']) {\n        menuDom.style.right = -(width + 10 * 2) + 'px';\n      } else {\n        menuDom.style.left = -(width + 10 * 2) + 'px';\n      }\n    } else if (this.options['reverseMenu']) {\n      menuDom.style.bottom = '28px';\n    } else {\n      menuDom.style.top = '28px';\n    }\n\n    menuDom.appendChild(menuUL);\n    menuDom.style.display = 'none';\n    return menuDom;\n  };\n\n  _proto._getItems = function _getItems() {\n    return this.options['items'] || [];\n  };\n\n  return Toolbar;\n}(Control);\n\nToolbar.mergeOptions(options$s);\n\nvar options$t = {\n  'position': 'top-left',\n  'slider': true,\n  'zoomLevel': true,\n  'seamless': false\n};\nvar UNIT = 10;\n\nvar Zoom = function (_Control) {\n  _inheritsLoose(Zoom, _Control);\n\n  function Zoom() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = Zoom.prototype;\n\n  _proto.buildOn = function buildOn(map) {\n    var options = this.options;\n    var dom = createEl('div', 'maptalks-zoom');\n\n    if (options['zoomLevel']) {\n      var levelDOM = createEl('span', 'maptalks-zoom-zoomlevel');\n      dom.appendChild(levelDOM);\n      this._levelDOM = levelDOM;\n    }\n\n    var zoomDOM = createEl('div', 'maptalks-zoom-slider');\n    var zoomInButton = createEl('a', 'maptalks-zoom-zoomin');\n    zoomInButton.href = 'javascript:;';\n    zoomInButton.innerHTML = '+';\n    zoomDOM.appendChild(zoomInButton);\n    this._zoomInButton = zoomInButton;\n\n    if (options['slider']) {\n      var box = createEl('div', 'maptalks-zoom-slider-box');\n      var ruler = createEl('div', 'maptalks-zoom-slider-ruler');\n      var reading = createEl('span', 'maptalks-zoom-slider-reading');\n      var dot = createEl('span', 'maptalks-zoom-slider-dot');\n      ruler.appendChild(reading);\n      box.appendChild(ruler);\n      box.appendChild(dot);\n      zoomDOM.appendChild(box);\n      this._sliderBox = box;\n      this._sliderRuler = ruler;\n      this._sliderReading = reading;\n      this._sliderDot = dot;\n    }\n\n    var zoomOutButton = createEl('a', 'maptalks-zoom-zoomout');\n    zoomOutButton.href = 'javascript:;';\n    zoomOutButton.innerHTML = '-';\n    zoomDOM.appendChild(zoomOutButton);\n    this._zoomOutButton = zoomOutButton;\n    dom.appendChild(zoomDOM);\n    map.on('_zoomend _zooming _zoomstart _spatialreferencechange', this._update, this);\n\n    this._update();\n\n    this._registerDomEvents();\n\n    return dom;\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.getMap().off('_zoomend _zooming _zoomstart _spatialreferencechange', this._update, this);\n\n    if (this._zoomInButton) {\n      off(this._zoomInButton, 'click', this._onZoomInClick, this);\n    }\n\n    if (this._zoomOutButton) {\n      off(this._zoomOutButton, 'click', this._onZoomOutClick, this);\n    }\n\n    if (this._sliderRuler) {\n      off(this._sliderRuler, 'click', this._onClickRuler, this);\n      this.dotDragger.disable();\n      delete this.dotDragger;\n    }\n  };\n\n  _proto._update = function _update() {\n    var map = this.getMap();\n\n    if (this._sliderBox) {\n      var totalRange = (map.getMaxZoom() - map.getMinZoom()) * UNIT;\n      this._sliderBox.style.height = totalRange + 16 + 'px';\n      this._sliderRuler.style.height = totalRange + 8 + 'px';\n      this._sliderRuler.style.cursor = 'pointer';\n      var zoomRange = (map.getMaxZoom() - map.getZoom()) * UNIT;\n      this._sliderReading.style.height = (map.getZoom() - map.getMinZoom() + 1) * UNIT + 'px';\n      this._sliderDot.style.top = zoomRange + 'px';\n    }\n\n    this._updateText();\n  };\n\n  _proto._updateText = function _updateText() {\n    if (this._levelDOM) {\n      var map = this.getMap();\n      var zoom = map.getZoom();\n\n      if (!isInteger(zoom)) {\n        zoom = Math.floor(zoom * 10) / 10;\n      }\n\n      this._levelDOM.innerHTML = zoom;\n    }\n  };\n\n  _proto._registerDomEvents = function _registerDomEvents() {\n    if (this._zoomInButton) {\n      on(this._zoomInButton, 'click', this._onZoomInClick, this);\n    }\n\n    if (this._zoomOutButton) {\n      on(this._zoomOutButton, 'click', this._onZoomOutClick, this);\n    }\n\n    if (this._sliderRuler) {\n      on(this._sliderRuler, 'click', this._onClickRuler, this);\n      this.dotDragger = new DragHandler(this._sliderDot, {\n        'ignoreMouseleave': true\n      });\n      this.dotDragger.on('dragstart', this._onDotDragstart, this).on('dragging dragend', this._onDotDrag, this).enable();\n    }\n  };\n\n  _proto._onZoomInClick = function _onZoomInClick(e) {\n    preventDefault(e);\n    this.getMap().zoomIn();\n  };\n\n  _proto._onZoomOutClick = function _onZoomOutClick(e) {\n    preventDefault(e);\n    this.getMap().zoomOut();\n  };\n\n  _proto._onClickRuler = function _onClickRuler(e) {\n    preventDefault(e);\n    var map = this.getMap(),\n        point = getEventContainerPoint(e, this._sliderRuler),\n        h = point.y;\n    var maxZoom = map.getMaxZoom(),\n        zoom = Math.floor(maxZoom - h / UNIT);\n    map.setZoom(zoom);\n  };\n\n  _proto._onDotDragstart = function _onDotDragstart(e) {\n    preventDefault(e.domEvent);\n\n    var map = this.getMap(),\n        origin = map.getSize().toPoint()._multi(1 / 2);\n\n    map.onZoomStart(map.getZoom(), origin);\n  };\n\n  _proto._onDotDrag = function _onDotDrag(e) {\n    preventDefault(e.domEvent);\n\n    var map = this.getMap(),\n        origin = map.getSize().toPoint()._multi(1 / 2),\n        point = getEventContainerPoint(e.domEvent, this._sliderRuler),\n        maxZoom = map.getMaxZoom(),\n        minZoom = map.getMinZoom();\n\n    var top = point.y,\n        z = maxZoom - top / UNIT;\n\n    if (maxZoom < z) {\n      z = maxZoom;\n      top = 0;\n    } else if (minZoom > z) {\n      z = minZoom;\n      top = (maxZoom - minZoom) * UNIT;\n    }\n\n    if (e.type === 'dragging') {\n      map.onZooming(z, origin, 1);\n    } else if (e.type === 'dragend') {\n      if (this.options['seamless']) {\n        map.onZoomEnd(z, origin);\n      } else {\n        map.onZoomEnd(Math.round(z), origin);\n      }\n    }\n\n    this._sliderDot.style.top = top + 'px';\n    this._sliderReading.style.height = (map.getZoom() - minZoom + 1) * UNIT + 'px';\n\n    this._updateText();\n  };\n\n  return Zoom;\n}(Control);\n\nZoom.mergeOptions(options$t);\nMap$1.mergeOptions({\n  'zoomControl': false\n});\nMap$1.addOnLoadHook(function () {\n  if (this.options['zoomControl']) {\n    this.zoomControl = new Zoom(this.options['zoomControl']);\n    this.addControl(this.zoomControl);\n  }\n});\n\n\n\nvar index$5 = /*#__PURE__*/Object.freeze({\n  Control: Control,\n  Attribution: Attribution,\n  LayerSwitcher: LayerSwitcher,\n  Overview: Overview,\n  Panel: Panel,\n  Scale: Scale,\n  Toolbar: Toolbar,\n  Zoom: Zoom\n});\n\nvar TileSystem = function () {\n  function TileSystem(sx, sy, ox, oy) {\n    if (Array.isArray(sx)) {\n      this.scale = {\n        x: sx[0],\n        y: sx[1]\n      };\n      this.origin = {\n        x: sx[2],\n        y: sx[3]\n      };\n    } else {\n      this.scale = {\n        x: sx,\n        y: sy\n      };\n      this.origin = {\n        x: ox,\n        y: oy\n      };\n    }\n  }\n\n  TileSystem.getDefault = function getDefault(projection) {\n    if (projection['code'].toLowerCase() === 'baidu') {\n      return 'baidu';\n    } else if (projection['code'].toLowerCase() === 'EPSG:4326'.toLowerCase()) {\n      return 'tms-global-geodetic';\n    } else if (projection['code'].toLowerCase() === 'identity') {\n      return [1, -1, 0, 0];\n    } else {\n      return 'web-mercator';\n    }\n  };\n\n  return TileSystem;\n}();\n\nvar semiCircum = 6378137 * Math.PI;\nextend(TileSystem, {\n  'web-mercator': new TileSystem([1, -1, -semiCircum, semiCircum]),\n  'tms-global-mercator': new TileSystem([1, 1, -semiCircum, -semiCircum]),\n  'tms-global-geodetic': new TileSystem([1, 1, -180, -90]),\n  'baidu': new TileSystem([1, 1, 0, 0])\n});\n\nvar TileConfig = function () {\n  function TileConfig(map, tileSystem, fullExtent, tileSize) {\n    this.map = map;\n    this.tileSize = tileSize;\n    this.fullExtent = fullExtent;\n    this.prepareTileInfo(tileSystem, fullExtent);\n    this._xScale = fullExtent['right'] >= fullExtent['left'] ? 1 : -1;\n    this._yScale = fullExtent['top'] >= fullExtent['bottom'] ? 1 : -1;\n    var glRes = map.getGLRes();\n    this._pointOrigin = map._prjToPointAtRes(new Point(this.tileSystem['origin']), glRes);\n    this._glRes = glRes;\n  }\n\n  var _proto = TileConfig.prototype;\n\n  _proto.prepareTileInfo = function prepareTileInfo(tileSystem, fullExtent) {\n    if (isString(tileSystem)) {\n      tileSystem = TileSystem[tileSystem.toLowerCase()];\n    } else if (Array.isArray(tileSystem)) {\n      tileSystem = new TileSystem(tileSystem);\n    }\n\n    if (!tileSystem) {\n      throw new Error('Invalid TileSystem');\n    }\n\n    this.tileSystem = tileSystem;\n    var a = fullExtent['right'] > fullExtent['left'] ? 1 : -1,\n        b = fullExtent['top'] > fullExtent['bottom'] ? -1 : 1,\n        c = tileSystem['origin']['x'],\n        d = tileSystem['origin']['y'];\n    this.transformation = new Transformation([a, b, c, d]);\n  };\n\n  _proto._getTileNum = function _getTileNum(point, res) {\n    var tileSystem = this.tileSystem,\n        tileSize = this['tileSize'],\n        delta = 1E-7;\n    var tileX = Math.floor(delta * tileSystem['scale']['x'] + point.x / (tileSize['width'] * res));\n    var tileY = Math.ceil(delta * tileSystem['scale']['y'] + point.y / (tileSize['height'] * res));\n    return {\n      'x': tileSystem['scale']['x'] * tileX,\n      'y': tileSystem['scale']['y'] * tileY\n    };\n  };\n\n  _proto.getTileIndex = function getTileIndex(pCoord, res, repeatWorld) {\n    var tileSystem = this.tileSystem;\n    var point = this.transformation.transform(pCoord, 1);\n\n    var tileIndex = this._getTileNum(point, res);\n\n    if (tileSystem['scale']['x'] < 0) {\n      tileIndex['x'] -= 1;\n    }\n\n    if (tileSystem['scale']['y'] > 0) {\n      tileIndex['y'] -= 1;\n    }\n\n    return this.getNeighorTileIndex(tileIndex['x'], tileIndex['y'], 0, 0, res, repeatWorld);\n  };\n\n  _proto.getNeighorTileIndex = function getNeighorTileIndex(tileX, tileY, offsetX, offsetY, res, repeatWorld) {\n    var tileSystem = this.tileSystem;\n    var x = tileX + tileSystem['scale']['x'] * offsetX;\n    var y = tileY - tileSystem['scale']['y'] * offsetY;\n    var out = false;\n    var idx = x;\n    var idy = y;\n\n    var ext = this._getTileFullIndex(res);\n\n    if (repeatWorld) {\n      if (repeatWorld === true || repeatWorld === 'x') {\n        if (ext['xmax'] === ext['xmin']) {\n          x = ext['xmin'];\n        } else if (x < ext['xmin']) {\n          x = ext['xmax'] - (ext['xmin'] - x) % (ext['xmax'] - ext['xmin']);\n\n          if (x === ext['xmax']) {\n            x = ext['xmin'];\n          }\n        } else if (x >= ext['xmax']) {\n          x = ext['xmin'] + (x - ext['xmin']) % (ext['xmax'] - ext['xmin']);\n        }\n      }\n\n      if (repeatWorld === true || repeatWorld === 'y') {\n        if (ext['ymax'] === ext['ymin']) {\n          y = ext['ymin'];\n        } else if (y >= ext['ymax']) {\n          y = ext['ymin'] + (y - ext['ymin']) % (ext['ymax'] - ext['ymin']);\n        } else if (y < ext['ymin']) {\n          y = ext['ymax'] - (ext['ymin'] - y) % (ext['ymax'] - ext['ymin']);\n\n          if (y === ext['ymax']) {\n            y = ext['ymin'];\n          }\n        }\n      }\n    }\n\n    if (x < ext['xmin'] || x > ext['xmax'] || y > ext['ymax'] || y < ext['ymin']) {\n      out = true;\n    }\n\n    return {\n      'x': x,\n      'y': y,\n      'idx': idx,\n      'idy': idy,\n      out: out\n    };\n  };\n\n  _proto._getTileFullIndex = function _getTileFullIndex(res) {\n    if (!this._tileFullIndex) {\n      this._tileFullIndex = {};\n    }\n\n    if (this._tileFullIndex[res]) {\n      return this._tileFullIndex[res];\n    }\n\n    var ext = this.fullExtent;\n    var transformation = this.transformation;\n\n    var nwIndex = this._getTileNum(transformation.transform(new Coordinate(ext['left'], ext['top']), 1), res);\n\n    var seIndex = this._getTileNum(transformation.transform(new Coordinate(ext['right'], ext['bottom']), 1), res);\n\n    var tileSystem = this.tileSystem;\n\n    if (tileSystem['scale']['x'] < 0) {\n      nwIndex.x -= 1;\n      seIndex.x -= 1;\n    }\n\n    if (tileSystem['scale']['y'] > 0) {\n      nwIndex.y -= 1;\n      seIndex.y -= 1;\n    }\n\n    this._tileFullIndex[res] = new Extent(nwIndex, seIndex);\n    return this._tileFullIndex[res];\n  };\n\n  _proto.getTilePrjNW = function getTilePrjNW(tileX, tileY, res) {\n    var tileSystem = this.tileSystem;\n    var tileSize = this['tileSize'];\n    var y = tileSystem['origin']['y'] + this._yScale * tileSystem['scale']['y'] * (tileY + (tileSystem['scale']['y'] === 1 ? 1 : 0)) * res * tileSize['height'];\n    var x = tileSystem['origin']['x'] + this._xScale * tileSystem['scale']['x'] * (tileX + (tileSystem['scale']['x'] === 1 ? 0 : 1)) * res * tileSize['width'];\n    return new Coordinate(x, y);\n  };\n\n  _proto.getTilePointNW = function getTilePointNW(tileX, tileY, res) {\n    var scale = this._glRes / res;\n    var tileSystem = this.tileSystem;\n    var tileSize = this['tileSize'];\n    var y = this._pointOrigin.y * scale + this._yScale * tileSystem['scale']['y'] * (tileY + (tileSystem['scale']['y'] === 1 ? 1 : 0)) * tileSize['height'];\n    var x = this._pointOrigin.x * scale + this._xScale * tileSystem['scale']['x'] * (tileX + (tileSystem['scale']['x'] === 1 ? 0 : 1)) * tileSize['width'];\n    return new Point(x, y);\n  };\n\n  _proto.getTilePrjSE = function getTilePrjSE(tileX, tileY, res) {\n    var tileSystem = this.tileSystem;\n    var tileSize = this['tileSize'];\n    var y = tileSystem['origin']['y'] + this._yScale * tileSystem['scale']['y'] * (tileY + (tileSystem['scale']['y'] === 1 ? 0 : 1)) * res * tileSize['height'];\n    var x = tileSystem['origin']['x'] + this._xScale * tileSystem['scale']['x'] * (tileX + (tileSystem['scale']['x'] === 1 ? 1 : 0)) * res * tileSize['width'];\n    return new Coordinate(x, y);\n  };\n\n  _proto.getTilePointSE = function getTilePointSE(tileX, tileY, res) {\n    var scale = this._glRes / res;\n    var tileSystem = this.tileSystem;\n    var tileSize = this['tileSize'];\n    var y = this._pointOrigin.y * scale + this._yScale * tileSystem['scale']['y'] * (tileY + (tileSystem['scale']['y'] === 1 ? 0 : 1)) * tileSize['height'];\n    var x = this._pointOrigin.x * scale + this._xScale * tileSystem['scale']['x'] * (tileX + (tileSystem['scale']['x'] === 1 ? 1 : 0)) * tileSize['width'];\n    return new Point(x, y);\n  };\n\n  _proto.getTilePrjExtent = function getTilePrjExtent(tileX, tileY, res) {\n    var nw = this.getTilePrjNW(tileX, tileY, res),\n        se = this.getTilePrjSE(tileX, tileY, res);\n    return new Extent(nw, se);\n  };\n\n  return TileConfig;\n}();\n\nvar DEFAULT_MAXERROR = 1;\nvar TEMP_POINT = new Point(0, 0);\nvar MAX_ROOT_NODES = 32;\nvar isSetAvailable = typeof Set !== 'undefined';\n\nvar TileHashset = function () {\n  function TileHashset() {\n    this._table = isSetAvailable ? new Set() : {};\n  }\n\n  var _proto = TileHashset.prototype;\n\n  _proto.add = function add$$1(key) {\n    if (isSetAvailable) {\n      this._table.add(key);\n    } else {\n      this._table[key] = true;\n    }\n  };\n\n  _proto.has = function has(key) {\n    if (isSetAvailable) {\n      return this._table.has(key);\n    } else {\n      return this._table[key];\n    }\n  };\n\n  _proto.reset = function reset() {\n    if (isSetAvailable) {\n      this._table.clear();\n    } else {\n      this._table = {};\n    }\n  };\n\n  return TileHashset;\n}();\n\nvar options$u = {\n  'urlTemplate': null,\n  'subdomains': null,\n  'errorUrl': null,\n  'repeatWorld': true,\n  'background': true,\n  'backgroundZoomDiff': 6,\n  'loadingLimitOnInteracting': 3,\n  'tileRetryCount': 0,\n  'placeholder': false,\n  'crossOrigin': null,\n  'tileSize': [256, 256],\n  'offset': [0, 0],\n  'tileSystem': null,\n  'fadeAnimation': !IS_NODE,\n  'debug': false,\n  'spatialReference': null,\n  'maxCacheSize': 256,\n  'renderer': function () {\n    return Browser$1.webgl ? 'gl' : 'canvas';\n  }(),\n  'clipByPitch': true,\n  'maxAvailableZoom': null,\n  'cascadeTiles': true,\n  'zoomOffset': 0,\n  'pyramidMode': 1,\n  'decodeImageInWorker': false\n};\nvar URL_PATTERN$1 = /\\{ *([\\w_]+) *\\}/g;\nvar TEMP_POINT0$4 = new Point(0, 0);\nvar TEMP_POINT1$1 = new Point(0, 0);\nvar TEMP_POINT2$1 = new Point(0, 0);\nvar TEMP_POINT3$1 = new Point(0, 0);\nvar TEMP_POINT4 = new Point(0, 0);\nvar TEMP_POINT6 = new Point(0, 0);\nvar TILE_BOX = [[0, 0, 0], [0, 0, 0]];\nvar TILE_MIN = [0, 0, 0];\nvar TILE_MAX = [0, 0, 0];\nvar ARR3 = [];\n\nvar TileLayer = function (_Layer) {\n  _inheritsLoose(TileLayer, _Layer);\n\n  function TileLayer() {\n    return _Layer.apply(this, arguments) || this;\n  }\n\n  TileLayer.fromJSON = function fromJSON(layerJSON) {\n    if (!layerJSON || layerJSON['type'] !== 'TileLayer') {\n      return null;\n    }\n\n    return new TileLayer(layerJSON['id'], layerJSON['options']);\n  };\n\n  var _proto2 = TileLayer.prototype;\n\n  _proto2.getTileSize = function getTileSize() {\n    if (this._tileSize) {\n      return this._tileSize;\n    }\n\n    var size = this.options['tileSize'];\n\n    if (isNumber(size)) {\n      size = [size, size];\n    }\n\n    this._tileSize = new Size(size);\n    return this._tileSize;\n  };\n\n  _proto2.getTiles = function getTiles(z, parentLayer) {\n    this._coordCache = {};\n    var sr = this.getSpatialReference();\n\n    if (!this._disablePyramid && !this._hasOwnSR && this.options['pyramidMode'] && sr && sr.isPyramid()) {\n      return this._getPyramidTiles(z, parentLayer);\n    } else {\n      return this._getCascadeTiles(z, parentLayer);\n    }\n  };\n\n  _proto2._getTileFullExtent = function _getTileFullExtent() {\n    if (this._tileFullExtent) {\n      return this._tileFullExtent;\n    }\n\n    var sr = this.getSpatialReference();\n    var fullExtent = sr.getFullExtent();\n    var res = sr.getResolution(0);\n    var map = this.getMap();\n    this._tileFullExtent = fullExtent.convertTo(function (c) {\n      return map._prjToPointAtRes(c, res, TEMP_POINT);\n    });\n    return this._tileFullExtent;\n  };\n\n  _proto2._getRootNodes = function _getRootNodes(offset0) {\n    var map = this.getMap();\n\n    if (this._rootNodes) {\n      var _this$_rootNodes = this._rootNodes,\n          _tiles = _this$_rootNodes.tiles,\n          mapWidth = _this$_rootNodes.mapWidth,\n          mapHeight = _this$_rootNodes.mapHeight;\n\n      if (map.width !== mapWidth || map.height !== mapHeight) {\n        var _error = this._getRootError();\n\n        for (var i = 0; i < _tiles.length; i++) {\n          _tiles[i].error = _error;\n        }\n\n        this._rootNodes.mapWidth = map.width;\n        this._rootNodes.mapHeight = map.height;\n      }\n\n      for (var _i = 0; _i < _tiles.length; _i++) {\n        _tiles[_i].offset[0] = offset0[0];\n        _tiles[_i].offset[1] = offset0[1];\n      }\n\n      return this._rootNodes;\n    }\n\n    var sr = this.getSpatialReference();\n    var res = sr.getResolution(0);\n\n    var tileConfig = this._getTileConfig();\n\n    var fullExtent = sr.getFullExtent();\n    var _tileConfig$tileSyste = tileConfig.tileSystem,\n        origin = _tileConfig$tileSyste.origin,\n        scale = _tileConfig$tileSyste.scale;\n    var extent000 = tileConfig.getTilePrjExtent(0, 0, res);\n    var w = extent000.getWidth();\n    var h = extent000.getHeight();\n    var delta = 1E-5;\n    var left = Math.abs((origin.x - fullExtent.left) / w);\n    left = Math.ceil(left - delta);\n    var right = Math.abs((fullExtent.right - origin.x) / w);\n    right = Math.ceil(right - delta);\n    var top = Math.ceil(Math.abs(fullExtent.top - origin.y) / h);\n    top = Math.ceil(top - delta);\n    var bottom = Math.ceil(Math.abs(fullExtent.bottom - origin.y) / h);\n    bottom = Math.ceil(bottom - delta);\n\n    if ((right + left) * (bottom + top) > MAX_ROOT_NODES) {\n      return {\n        status: 0,\n        error: 'Too many root nodes'\n      };\n    }\n\n    var error = this._getRootError();\n\n    var tiles = [];\n    var z = 0;\n\n    for (var _i2 = -left; _i2 < right; _i2++) {\n      for (var j = -top; j < bottom; j++) {\n        var y = scale.y < 0 ? j : -(j + 1);\n        tiles.push({\n          x: _i2,\n          y: y,\n          z: z,\n          idx: _i2,\n          idy: y,\n          extent2d: tileConfig.getTilePrjExtent(_i2, y, res).convertTo(function (c) {\n            return map._prjToPointAtRes(c, res, TEMP_POINT);\n          }),\n          id: this._getTileId(_i2, y, z),\n          url: this.getTileUrl(_i2, y, z + this.options['zoomOffset']),\n          offset: [0, 0],\n          error: error\n        });\n      }\n    }\n\n    this._rootNodes = {\n      status: 1,\n      tiles: tiles,\n      mapWidth: map.width,\n      mapHeight: map.height\n    };\n    return this._getRootNodes(offset0);\n  };\n\n  _proto2._getRootError = function _getRootError() {\n    var map = this.getMap();\n    var fov = toRadian(map.getFov());\n    var aspectRatio = map.width / map.height;\n    var cameraZ = map.cameraPosition[2];\n    var heightZ = cameraZ * Math.tan(0.5 * fov);\n    var widthZ = heightZ * aspectRatio;\n    var diagonalZ = Math.sqrt(cameraZ * cameraZ + heightZ * heightZ + widthZ * widthZ);\n\n    var fov0 = map._getFovZ(0);\n\n    var error = fov0 * (diagonalZ / cameraZ);\n    var sr = this.getSpatialReference();\n    var res = sr.getResolution(0);\n    return error * res / map.getResolution(0);\n  };\n\n  _proto2._getPyramidTiles = function _getPyramidTiles(z, layer) {\n    var map = this.getMap();\n\n    if (isNaN(+z)) {\n      z = this._getTileZoom(map.getZoom());\n    }\n\n    var sr = this.getSpatialReference();\n    var maxZoom = Math.min(z, this.getMaxZoom());\n    var projectionView = map.projViewMatrix;\n\n    var fullExtent = this._getTileFullExtent();\n\n    var offset0 = this._getTileOffset(0);\n\n    var queue;\n\n    if (this.options['repeatWorld']) {\n      var mapContainerExtent = map.getContainerExtent();\n\n      var mapExtent2D = this._convertToExtent2d(mapContainerExtent);\n\n      var scale = sr.getResolution(0) / map.getResolution();\n\n      if (!mapExtent2D.within(fullExtent.copy()._scale(scale))) {\n        var pitch = map.getPitch();\n        var cascadePitch1 = map.options['cascadePitches'][1];\n        var visualHeight1 = Math.floor(map._getVisualHeight(cascadePitch1));\n        var visualContainerExtent = pitch <= cascadePitch1 ? mapContainerExtent : new PointExtent(0, map.height - visualHeight1, map.width, map.height);\n        this._visitedTiles = new TileHashset();\n\n        var tileGrid = this._getTiles(0, visualContainerExtent, 2, layer && layer.getRenderer(), true);\n\n        var error = this._getRootError();\n\n        tileGrid.tiles.forEach(function (t) {\n          t.error = error;\n        });\n        queue = tileGrid.tiles;\n      } else {\n        var rootNodes = this._getRootNodes(offset0);\n\n        if (rootNodes.status !== 1) {\n          console.warn(rootNodes.error);\n          this._disablePyramid = true;\n          return this.getTiles(z, layer);\n        }\n\n        queue = rootNodes.tiles.concat();\n      }\n    } else {\n      var _rootNodes = this._getRootNodes(offset0);\n\n      if (_rootNodes.status !== 1) {\n        console.warn(_rootNodes.error);\n        this._disablePyramid = true;\n        return this.getTiles(z, layer);\n      }\n\n      queue = _rootNodes.tiles.concat();\n    }\n\n    var glRes = map.getGLRes();\n    var offsets = {\n      0: offset0\n    };\n    var extent = new PointExtent();\n    var tiles = [];\n\n    while (queue.length > 0) {\n      var node = queue.pop();\n\n      if (node.z === maxZoom) {\n        extent._combine(node.extent2d);\n\n        tiles.push(node);\n        continue;\n      }\n\n      if (!offsets[node.z + 1]) {\n        offsets[node.z + 1] = this._getTileOffset(node.z + 1);\n      }\n\n      this._splitNode(node, projectionView, queue, tiles, extent, maxZoom, offsets[node.z + 1], layer && layer.getRenderer(), glRes);\n    }\n\n    return {\n      tileGrids: [{\n        extent: extent,\n        count: tiles.length,\n        tiles: tiles,\n        offset: [0, 0],\n        zoom: z\n      }],\n      count: tiles.length\n    };\n  };\n\n  _proto2._splitNode = function _splitNode(node, projectionView, queue, tiles, gridExtent, maxZoom, offset, parentRenderer, glRes) {\n    var tileSystem = this._getTileConfig().tileSystem;\n\n    var scaleY = tileSystem.scale.y;\n    var z = node.z + 1;\n    var sr = this.getSpatialReference();\n    var x = node.x,\n        y = node.y,\n        extent2d = node.extent2d,\n        idx = node.idx,\n        idy = node.idy;\n    var childScale = 2;\n    var width = extent2d.getWidth() / 2 * childScale;\n    var height = extent2d.getHeight() / 2 * childScale;\n    var minx = extent2d.xmin * childScale;\n    var maxy = extent2d.ymax * childScale;\n    var miny = extent2d.ymin * childScale;\n    var renderer = parentRenderer || this.getRenderer();\n    var hasCurrentIn = false;\n    var children = [];\n    var glScale = sr.getResolution(z) / glRes;\n\n    for (var i = 0; i < 4; i++) {\n      var dx = i % 2;\n      var dy = i >> 1;\n      var childX = (x << 1) + dx;\n      var childY = (y << 1) + dy;\n      var childIdx = (idx << 1) + dx;\n      var childIdy = (idy << 1) + dy;\n\n      var tileId = this._getTileId(childIdx, childIdy, z);\n\n      var cached = renderer.isTileCachedOrLoading(tileId);\n      var extent = void 0;\n\n      if (!cached) {\n        if (scaleY < 0) {\n          var nwx = minx + dx * width;\n          var nwy = maxy - dy * height;\n          extent = new PointExtent(nwx, nwy - height, nwx + width, nwy);\n        } else {\n          var swx = minx + dx * width;\n          var swy = miny + dy * height;\n          extent = new PointExtent(swx, swy, swx + width, swy + height);\n        }\n      }\n\n      var childNode = cached && cached.info;\n\n      if (!childNode) {\n        childNode = {\n          x: childX,\n          y: childY,\n          idx: childIdx,\n          idy: childIdy,\n          z: z,\n          extent2d: extent,\n          error: node.error / 2,\n          id: tileId,\n          url: this.getTileUrl(childX, childY, z + this.options['zoomOffset']),\n          offset: offset\n        };\n\n        if (parentRenderer) {\n          childNode['layer'] = this.getId();\n        }\n      }\n\n      childNode.error = node.error / 2;\n      childNode.offset[0] = offset[0];\n      childNode.offset[1] = offset[1];\n\n      var visible = this._isTileVisible(childNode, projectionView, glScale, maxZoom, offset);\n\n      if (visible === 1) {\n        hasCurrentIn = true;\n      } else if (visible === -1) {\n        continue;\n      } else if (visible === 0 && z !== maxZoom) {\n        tiles.push(node);\n\n        gridExtent._combine(node.extent2d);\n\n        return;\n      }\n\n      children.push(childNode);\n    }\n\n    if (z === maxZoom) {\n      if (hasCurrentIn) {\n        queue.push.apply(queue, children);\n      } else {\n        tiles.push(node);\n\n        gridExtent._combine(node.extent2d);\n      }\n    } else {\n      queue.push.apply(queue, children);\n    }\n  };\n\n  _proto2._isTileVisible = function _isTileVisible(node, projectionView, glScale, maxZoom, offset) {\n    if (node.z === 0) {\n      return 1;\n    }\n\n    if (!this._isTileInFrustum(node, projectionView, glScale, offset)) {\n        return -1;\n      }\n\n    var maxError = this.options['maxError'];\n\n    if (isNil(maxError)) {\n      maxError = DEFAULT_MAXERROR;\n    }\n\n    var error = this._getScreenSpaceError(node, glScale, maxZoom, offset);\n\n    return error >= maxError ? 1 : 0;\n  };\n\n  _proto2._isTileInFrustum = function _isTileInFrustum(node, projectionView, glScale, offset) {\n    var _node$extent2d = node.extent2d,\n        xmin = _node$extent2d.xmin,\n        ymin = _node$extent2d.ymin,\n        xmax = _node$extent2d.xmax,\n        ymax = _node$extent2d.ymax;\n    TILE_BOX[0][0] = (xmin - offset[0]) * glScale;\n    TILE_BOX[0][1] = (ymin - offset[1]) * glScale;\n    TILE_BOX[1][0] = (xmax - offset[0]) * glScale;\n    TILE_BOX[1][1] = (ymax - offset[1]) * glScale;\n    return intersectsBox(projectionView, TILE_BOX);\n  };\n\n  _proto2._getScreenSpaceError = function _getScreenSpaceError(node, glScale, maxZoom, offset) {\n    var geometricError = node.error;\n    var map = this.getMap();\n    var _node$extent2d2 = node.extent2d,\n        xmin = _node$extent2d2.xmin,\n        ymin = _node$extent2d2.ymin,\n        xmax = _node$extent2d2.xmax,\n        ymax = _node$extent2d2.ymax;\n    TILE_MIN[0] = (xmin - offset[0]) * glScale;\n    TILE_MIN[1] = (ymin - offset[1]) * glScale;\n    TILE_MAX[0] = (xmax - offset[0]) * glScale;\n    TILE_MAX[1] = (ymax - offset[1]) * glScale;\n    var distanceToCamera = distanceToRect(TILE_MIN, TILE_MAX, map.cameraPosition);\n    var distance$$1 = Math.max(Math.abs(distanceToCamera), 1E-7);\n    var gap = Math.abs(node.z - maxZoom);\n    var r;\n\n    if (map.height < 1000) {\n      r = 1;\n    } else {\n      r = gap <= 1 ? 1 : gap <= 2 ? 0.7 : 0.605;\n    }\n\n    var error = geometricError * r / distance$$1;\n    return error;\n  };\n\n  _proto2._getCascadeTiles = function _getCascadeTiles(z, parentLayer) {\n    var map = this.getMap();\n    var pitch = map.getPitch();\n    var parentRenderer = parentLayer && parentLayer.getRenderer();\n    var mapExtent = map.getContainerExtent();\n    var tileGrids = [];\n    var count = 0;\n    var minZoom = this.getMinZoom();\n    var cascadePitch0 = map.options['cascadePitches'][0];\n    var cascadePitch1 = map.options['cascadePitches'][1];\n    var visualHeight1 = Math.floor(map._getVisualHeight(cascadePitch1));\n    var tileZoom = isNil(z) ? this._getTileZoom(map.getZoom()) : z;\n    this._visitedTiles = new TileHashset();\n\n    if (!isNil(z) || !this.options['cascadeTiles'] || pitch <= cascadePitch0 || !isNil(minZoom) && tileZoom <= minZoom) {\n      var containerExtent = pitch <= cascadePitch1 ? mapExtent : new PointExtent(0, map.height - visualHeight1, map.width, map.height);\n\n      var _currentTiles = this._getTiles(tileZoom, containerExtent, 2, parentRenderer);\n\n      if (_currentTiles) {\n        count += _currentTiles.tiles.length;\n        tileGrids.push(_currentTiles);\n      }\n\n      return {\n        tileGrids: tileGrids,\n        count: count\n      };\n    }\n\n    var visualHeight0 = Math.floor(map._getVisualHeight(cascadePitch0));\n    var extent0 = new PointExtent(0, map.height - visualHeight0, map.width, map.height);\n\n    var currentTiles = this._getTiles(tileZoom, extent0, 0, parentRenderer);\n\n    count += currentTiles ? currentTiles.tiles.length : 0;\n    tileGrids.push(currentTiles);\n    var cascadeHeight = extent0.ymin;\n    var d = map.getSpatialReference().getZoomDirection();\n    var cascadeLevels = d;\n    var cascadeTiles1;\n\n    if (pitch > cascadePitch1) {\n      if (tileZoom - cascadeLevels <= minZoom) {\n        cascadeLevels = 0;\n      }\n\n      var extent1 = new PointExtent(0, map.height - visualHeight1, map.width, cascadeHeight);\n      cascadeTiles1 = this._getTiles(tileZoom - cascadeLevels, extent1, 1, parentRenderer);\n      count += cascadeTiles1 ? cascadeTiles1.tiles.length : 0;\n      cascadeHeight = extent1.ymin;\n      cascadeLevels += 4 * d;\n    }\n\n    var cascadeTiles2;\n\n    if (tileZoom - cascadeLevels >= minZoom) {\n      var extent2 = new PointExtent(0, mapExtent.ymin, map.width, cascadeHeight);\n      cascadeTiles2 = this._getTiles(tileZoom - cascadeLevels, extent2, 2, parentRenderer);\n      count += cascadeTiles2 ? cascadeTiles2.tiles.length : 0;\n      tileGrids.push(cascadeTiles2);\n    }\n\n    if (cascadeTiles1 && cascadeTiles2) {\n      tileGrids[1] = cascadeTiles2;\n      tileGrids[2] = cascadeTiles1;\n    }\n\n    return {\n      tileGrids: tileGrids,\n      count: count\n    };\n  };\n\n  _proto2.getTileUrl = function getTileUrl(x, y, z) {\n    var urlTemplate = this.options['urlTemplate'];\n    var domain = '';\n\n    if (this.options['subdomains']) {\n      var subdomains = this.options['subdomains'];\n\n      if (isArrayHasData(subdomains)) {\n        var length$$1 = subdomains.length;\n        var s = (x + y) % length$$1;\n\n        if (s < 0) {\n          s = 0;\n        }\n\n        domain = subdomains[s];\n      }\n    }\n\n    if (isFunction(urlTemplate)) {\n      return urlTemplate(x, y, z, domain);\n    }\n\n    var data = {\n      'x': x,\n      'y': y,\n      'z': z,\n      's': domain\n    };\n\n    if (this.options.token) {\n      data.token = this.options.token;\n    }\n\n    return urlTemplate.replace(URL_PATTERN$1, function (str, key) {\n      var value = data[key];\n\n      if (value === undefined) {\n        throw new Error('No value provided for variable ' + str);\n      } else if (typeof value === 'function') {\n        value = value(data);\n      }\n\n      return value;\n    });\n  };\n\n  _proto2.clear = function clear() {\n    if (this._renderer) {\n      this._renderer.clear();\n    }\n\n    this.fire('clear');\n    return this;\n  };\n\n  _proto2.toJSON = function toJSON() {\n    var profile = {\n      'type': this.getJSONType(),\n      'id': this.getId(),\n      'options': this.config()\n    };\n    return profile;\n  };\n\n  _proto2.getSpatialReference = function getSpatialReference() {\n    var map = this.getMap();\n\n    if (map && (!this.options['spatialReference'] || SpatialReference.equals(this.options['spatialReference'], map.options['spatialReference']))) {\n      return map.getSpatialReference();\n    }\n\n    if (this._sr) {\n      return this._sr;\n    }\n\n    var config = this.options['spatialReference'];\n\n    if (isString(config)) {\n      config = SpatialReference.getPreset(config);\n\n      if (!config) {\n        throw new Error(\"Unsupported spatial reference: \" + this.options['spatialReference'] + \", possible values: \" + SpatialReference.getAllPresets().join());\n      }\n    }\n\n    this._sr = new SpatialReference(config);\n    this._srMinZoom = this._sr.getMinZoom();\n    this._srMaxZoom = this._sr.getMaxZoom();\n    this._hasOwnSR = this._sr.toJSON().projection !== map.getSpatialReference().toJSON().projection;\n    return this._sr;\n  };\n\n  _proto2.getMinZoom = function getMinZoom() {\n    var sr = this.getSpatialReference();\n\n    if (sr !== this.getMap().getSpatialReference()) {\n      return Math.max(_Layer.prototype.getMinZoom.call(this), this._srMinZoom);\n    }\n\n    return _Layer.prototype.getMinZoom.call(this);\n  };\n\n  _proto2.getMaxZoom = function getMaxZoom() {\n    var sr = this.getSpatialReference();\n\n    if (sr !== this.getMap().getSpatialReference()) {\n      return Math.min(_Layer.prototype.getMaxZoom.call(this), this._srMaxZoom);\n    }\n\n    return _Layer.prototype.getMaxZoom.call(this);\n  };\n\n  _proto2._getTileZoom = function _getTileZoom(zoom) {\n    if (!this._hasOwnSR) {\n      var res0 = this.getMap().getResolution(zoom);\n      var res1 = this.getSpatialReference().getResolution(zoom);\n      var dz = Math.log(res1 / res0) * Math.LOG2E;\n      zoom += dz;\n    }\n\n    var maxZoom = this.options['maxAvailableZoom'];\n\n    if (!isNil(maxZoom) && zoom > maxZoom) {\n      zoom = maxZoom;\n    }\n\n    if (!isInteger(zoom)) {\n      zoom = Math.round(zoom);\n    }\n\n    zoom = Math.max(0, zoom);\n    return zoom;\n  };\n\n  _proto2._getTiles = function _getTiles(tileZoom, containerExtent, cascadeLevel, parentRenderer, ignoreMinZoom) {\n    var map = this.getMap();\n    var z = tileZoom;\n    var frustumMatrix = map.projViewMatrix;\n\n    if (cascadeLevel < 2) {\n      if (cascadeLevel === 0) {\n        z -= 1;\n      }\n\n      frustumMatrix = cascadeLevel === 0 ? map.cascadeFrustumMatrix0 : cascadeLevel === 1 ? map.cascadeFrustumMatrix1 : map.projViewMatrix;\n    }\n\n    var zoom = z + this.options['zoomOffset'];\n\n    var offset = this._getTileOffset(zoom),\n        hasOffset = offset[0] || offset[1];\n\n    var emptyGrid = {\n      'zoom': z,\n      'extent': null,\n      'offset': offset,\n      'tiles': []\n    };\n\n    if (zoom < 0) {\n      return emptyGrid;\n    }\n\n    if (!map || !this.isVisible() || !map.width || !map.height) {\n      return emptyGrid;\n    }\n\n    if (!ignoreMinZoom) {\n      var minZoom = this.getMinZoom(),\n          maxZoom = this.getMaxZoom();\n\n      if (!isNil(minZoom) && z < minZoom || !isNil(maxZoom) && z > maxZoom) {\n        return emptyGrid;\n      }\n    }\n\n    var tileConfig = this._getTileConfig();\n\n    if (!tileConfig) {\n      return emptyGrid;\n    }\n\n    var tileOffsets = {\n      zoom: offset\n    };\n    var sr = this.getSpatialReference();\n    var res = sr.getResolution(zoom);\n    var glScale;\n\n    if (this._hasOwnSR) {\n      glScale = map.getGLScale(z);\n    } else {\n      glScale = res / map.getGLRes();\n    }\n\n    var repeatWorld = !this._hasOwnSR && this.options['repeatWorld'];\n\n    var extent2d = this._convertToExtent2d(containerExtent);\n\n    var maskExtent = this._getMask2DExtent();\n\n    if (maskExtent) {\n      var intersection = maskExtent.intersection(extent2d);\n\n      if (!intersection) {\n        return emptyGrid;\n      }\n\n      containerExtent = intersection.convertTo(function (c) {\n        return map._pointToContainerPoint(c, undefined, 0, TEMP_POINT);\n      });\n    }\n\n    var prjCenter = map._containerPointToPrj(containerExtent.getCenter(), TEMP_POINT0$4);\n\n    var centerPoint = map._prjToPoint(prjCenter, zoom, TEMP_POINT1$1);\n\n    var c;\n\n    if (hasOffset) {\n      c = this._project(map._pointToPrj(centerPoint._add(offset), zoom, TEMP_POINT1$1), TEMP_POINT1$1);\n    } else {\n      c = this._project(prjCenter, TEMP_POINT1$1);\n    }\n\n    var extentScale = map.getGLScale() / map.getGLScale(zoom);\n    TEMP_POINT2$1.x = extent2d.xmin * extentScale;\n    TEMP_POINT2$1.y = extent2d.ymax * extentScale;\n    TEMP_POINT3$1.x = extent2d.xmax * extentScale;\n    TEMP_POINT3$1.y = extent2d.ymin * extentScale;\n\n    var pmin = this._project(map._pointToPrj(TEMP_POINT2$1._add(offset), zoom, TEMP_POINT2$1), TEMP_POINT2$1);\n\n    var pmax = this._project(map._pointToPrj(TEMP_POINT3$1._add(offset), zoom, TEMP_POINT3$1), TEMP_POINT3$1);\n\n    var centerTile = tileConfig.getTileIndex(c, res, repeatWorld);\n    var ltTile = tileConfig.getTileIndex(pmin, res, repeatWorld);\n    var rbTile = tileConfig.getTileIndex(pmax, res, repeatWorld);\n    var top = Math.ceil(Math.abs(centerTile.idy - ltTile.idy)),\n        left = Math.ceil(Math.abs(centerTile.idx - ltTile.idx)),\n        bottom = Math.ceil(Math.abs(centerTile.idy - rbTile.idy)),\n        right = Math.ceil(Math.abs(centerTile.idx - rbTile.idx));\n    var allCount = (top + bottom + 1) * (left + right + 1);\n    var tileSize = this.getTileSize();\n\n    var renderer = this.getRenderer() || parentRenderer,\n        scale = this._getTileConfig().tileSystem.scale;\n\n    var tiles = [],\n        extent = new PointExtent();\n    var tilePoint = new Point(0, 0);\n\n    for (var i = -top; i <= bottom; i++) {\n      var j = -left;\n      var leftVisitEnd = -Infinity;\n      var rightVisitEnd = false;\n\n      while (j >= leftVisitEnd && j <= right) {\n        var idx = tileConfig.getNeighorTileIndex(centerTile.idx, centerTile.idy, j, i, res, repeatWorld);\n\n        if (leftVisitEnd === -Infinity) {\n          j++;\n        } else {\n          j--;\n        }\n\n        var tileId = this._getTileId(idx.idx, idx.idy, z);\n\n        if (idx.out || this._visitedTiles && this._visitedTiles.has(tileId)) {\n          continue;\n        }\n\n        var tileInfo = renderer && renderer.isTileCachedOrLoading(tileId);\n\n        if (tileInfo) {\n          tileInfo = tileInfo.info;\n        }\n\n        var p = void 0;\n\n        if (tileInfo) {\n          var _tileInfo = tileInfo,\n              _extent2d = _tileInfo.extent2d;\n          tilePoint.set(_extent2d.xmin, _extent2d.ymax);\n          p = tilePoint;\n        } else if (!this._hasOwnSR) {\n          p = tileConfig.getTilePointNW(idx.x, idx.y, res);\n        } else {\n          var pnw = tileConfig.getTilePrjNW(idx.x, idx.y, res);\n          p = map._prjToPoint(this._unproject(pnw, TEMP_POINT3$1), z);\n        }\n\n        var width = void 0,\n            height = void 0;\n\n        if (!this._hasOwnSR) {\n          width = tileSize.width;\n          height = tileSize.height;\n        } else {\n          var pp = void 0;\n\n          if (!this._hasOwnSR) {\n            pp = tileConfig.getTilePointSE(idx.x, idx.y, res);\n          } else {\n            var pse = tileConfig.getTilePrjSE(idx.x, idx.y, res);\n            pp = map._prjToPoint(this._unproject(pse, TEMP_POINT3$1), z, TEMP_POINT3$1);\n          }\n\n          width = Math.ceil(Math.abs(pp.x - p.x));\n          height = Math.ceil(Math.abs(pp.y - p.y));\n        }\n\n        var dx = scale.x * (idx.idx - idx.x) * width,\n            dy = scale.y * (idx.idy - idx.y) * height;\n\n        if (!tileInfo && (dx || dy)) {\n          p._add(dx, dy);\n        }\n\n        var tileExtent = tileInfo && tileInfo.extent2d || new PointExtent(p.x, p.y - height, p.x + width, p.y);\n\n        if (allCount <= 4 || rightVisitEnd || this._isTileInExtent(frustumMatrix, tileExtent, offset, glScale)) {\n          if (this._visitedTiles && cascadeLevel === 0) {\n            this._visitedTiles.add(tileId);\n          }\n\n          if (cascadeLevel === 0) {\n            this._splitTiles(frustumMatrix, tiles, renderer, idx, z + 1, tileExtent, dx, dy, tileOffsets, parentRenderer);\n\n            extent._combine(tileExtent);\n          } else {\n            if (!tileInfo) {\n              tileInfo = {\n                'z': z,\n                'x': idx.x,\n                'y': idx.y,\n                'idx': idx.idx,\n                'idy': idx.idy,\n                'extent2d': tileExtent,\n                'offset': offset,\n                'id': tileId,\n                'url': this.getTileUrl(idx.x, idx.y, z)\n              };\n\n              if (parentRenderer) {\n                tileInfo['layer'] = this.getId();\n              }\n            } else {\n              tileInfo.offset[0] = offset[0];\n              tileInfo.offset[1] = offset[1];\n            }\n\n            tiles.push(tileInfo);\n\n            extent._combine(tileExtent);\n          }\n\n          if (leftVisitEnd === -Infinity) {\n            leftVisitEnd = j;\n            j = right;\n          } else if (!rightVisitEnd) {\n            rightVisitEnd = true;\n          }\n        }\n      }\n    }\n\n    if (tiles.length) {\n      var center = map._containerPointToPoint(containerExtent.getCenter(), z, TEMP_POINT)._add(offset);\n\n      var point0 = new Point(0, 0);\n      var point1 = new Point(0, 0);\n      tiles.sort(function (a, b) {\n        point0.set((a.extent2d.xmin + a.extent2d.xmax) / 2, (a.extent2d.ymin + a.extent2d.ymax) / 2);\n        point1.set((b.extent2d.xmin + b.extent2d.xmax) / 2, (b.extent2d.ymin + b.extent2d.ymax) / 2);\n        return point0.distanceTo(center) - point1.distanceTo(center);\n      });\n    }\n\n    return {\n      'offset': offset,\n      'zoom': tileZoom,\n      'extent': extent,\n      'tiles': tiles\n    };\n  };\n\n  _proto2._convertToExtent2d = function _convertToExtent2d(containerExtent) {\n    var _this = this;\n\n    var map = this.getMap();\n    return containerExtent.convertTo(function (c) {\n      var result;\n\n      if (c.y > 0 && c.y < map.height) {\n        var key = (c.x === 0 ? 0 : 1) + c.y;\n\n        if (!_this._coordCache[key]) {\n          _this._coordCache[key] = map._containerPointToPoint(c);\n        }\n\n        result = _this._coordCache[key];\n      }\n\n      result = map._containerPointToPoint(c, undefined, TEMP_POINT);\n      return result;\n    });\n  };\n\n  _proto2._splitTiles = function _splitTiles(frustumMatrix, tiles, renderer, tileIdx, z, tileExtent, dx, dy, tileOffsets, parentRenderer) {\n    var yOrder = this._getTileConfig().tileSystem.scale.y;\n\n    var glScale = this.getMap().getGLScale(z);\n    var corner = TEMP_POINT4.set(tileExtent.xmin * 2, yOrder < 0 ? tileExtent.ymax * 2 : tileExtent.ymin * 2);\n    var w = tileExtent.getWidth();\n    var h = tileExtent.getHeight();\n    var idx = tileIdx.idx * 2;\n    var idy = tileIdx.idy * 2;\n    var x = tileIdx.x * 2;\n    var y = tileIdx.y * 2;\n\n    var tile = this._checkAndAddTile(frustumMatrix, renderer, idx, idy, x, y, z, 0, 0, w, h, corner, glScale, tileOffsets, parentRenderer);\n\n    if (tile) tiles.push(tile);\n    tile = this._checkAndAddTile(frustumMatrix, renderer, idx, idy, x, y, z, 0, 1, w, h, corner, glScale, tileOffsets, parentRenderer);\n    if (tile) tiles.push(tile);\n    tile = this._checkAndAddTile(frustumMatrix, renderer, idx, idy, x, y, z, 1, 0, w, h, corner, glScale, tileOffsets, parentRenderer);\n    if (tile) tiles.push(tile);\n    tile = this._checkAndAddTile(frustumMatrix, renderer, idx, idy, x, y, z, 1, 1, w, h, corner, glScale, tileOffsets, parentRenderer);\n    if (tile) tiles.push(tile);\n  };\n\n  _proto2._checkAndAddTile = function _checkAndAddTile(frustumMatrix, renderer, idx, idy, x, y, z, i, j, w, h, corner, glScale, tileOffsets, parentRenderer) {\n    var tileId = this._getTileId(idx + i, idy + j, z);\n\n    if (this._visitedTiles && this._visitedTiles.has(tileId)) {\n      return null;\n    }\n\n    var offset = tileOffsets[z];\n\n    if (!offset) {\n      offset = tileOffsets[z] = this._getTileOffset(z);\n    }\n\n    var yOrder = this._getTileConfig().tileSystem.scale.y;\n\n    var childExtent = new PointExtent(corner.x + i * w, corner.y + yOrder * j * h, corner.x + (i + 1) * w, corner.y + yOrder * (j + 1) * h);\n\n    if (!this._isSplittedTileInExtent(frustumMatrix, childExtent, offset, glScale)) {\n      return null;\n    }\n\n    var tileInfo = renderer && renderer.isTileCachedOrLoading(tileId);\n\n    if (!tileInfo) {\n      tileInfo = {\n        'z': z,\n        'x': x + i,\n        'y': y + j,\n        'extent2d': childExtent,\n        'id': tileId,\n        'offset': offset,\n        'url': this.getTileUrl(x + i, y + j, z + this.options['zoomOffset'])\n      };\n\n      if (parentRenderer) {\n        tileInfo['layer'] = this.getId();\n      }\n    } else {\n      tileInfo = tileInfo.info;\n    }\n\n    return tileInfo;\n  };\n\n  _proto2._getTileOffset = function _getTileOffset(z) {\n    var offset = this.options['offset'];\n\n    if (isFunction(offset)) {\n      offset = offset(z);\n    }\n\n    return offset;\n  };\n\n  _proto2._getTileId = function _getTileId(x, y, zoom, id) {\n    return (id || this.getId()) + \"_\" + y + \"_\" + x + \"_\" + zoom;\n  };\n\n  _proto2._project = function _project(pcoord, out) {\n    if (this._hasOwnSR) {\n      var map = this.getMap();\n      var mapProjection = map.getProjection();\n      var projection = this.getSpatialReference().getProjection();\n      return projection.project(mapProjection.unproject(pcoord, out), out);\n    } else {\n      return pcoord;\n    }\n  };\n\n  _proto2._unproject = function _unproject(pcoord, out) {\n    if (this._hasOwnSR) {\n      var map = this.getMap();\n      var sr = this.getSpatialReference();\n      var mapProjection = map.getProjection();\n      var projection = sr.getProjection();\n      return mapProjection.project(projection.unproject(pcoord, out), out);\n    } else {\n      return pcoord;\n    }\n  };\n\n  _proto2._initTileConfig = function _initTileConfig() {\n    var map = this.getMap(),\n        tileSize = this.getTileSize();\n    var sr = this.getSpatialReference();\n    var projection = sr.getProjection(),\n        fullExtent = sr.getFullExtent();\n    this._defaultTileConfig = new TileConfig(map, TileSystem.getDefault(projection), fullExtent, tileSize);\n\n    if (this.options.hasOwnProperty('tileSystem')) {\n      this._tileConfig = new TileConfig(map, this.options['tileSystem'], fullExtent, tileSize);\n    }\n\n    delete this._rootNodes;\n    delete this._tileFullExtent;\n    delete this._disablePyramid;\n  };\n\n  _proto2._getTileConfig = function _getTileConfig() {\n    if (!this._defaultTileConfig) {\n      this._initTileConfig();\n    }\n\n    return this._tileConfig || this._defaultTileConfig;\n  };\n\n  _proto2._bindMap = function _bindMap(map) {\n    var baseLayer = map.getBaseLayer();\n\n    if (baseLayer === this) {\n      if (!baseLayer.options.hasOwnProperty('forceRenderOnMoving')) {\n        this.config({\n          'forceRenderOnMoving': true\n        });\n      }\n    }\n\n    this._onSpatialReferenceChange();\n\n    return _Layer.prototype._bindMap.apply(this, arguments);\n  };\n\n  _proto2._isTileInExtent = function _isTileInExtent(frustumMatrix, tileExtent, offset, glScale) {\n    var map = this.getMap();\n    var matrix;\n\n    if (frustumMatrix !== map.projViewMatrix) {\n      var tileCenter = tileExtent.getCenter(TEMP_POINT6)._sub(offset[0], offset[1])._multi(glScale);\n\n      set$2(ARR3, tileCenter.x, tileCenter.y, 0);\n      var ndc = transformMat4(ARR3, ARR3, map.projViewMatrix);\n      matrix = ndc[1] < 0 ? map.projViewMatrix : frustumMatrix;\n    } else {\n      matrix = map.projViewMatrix;\n    }\n\n    TILE_BOX[0][0] = (tileExtent.xmin - offset[0]) * glScale;\n    TILE_BOX[0][1] = (tileExtent.ymin - offset[1]) * glScale;\n    TILE_BOX[1][0] = (tileExtent.xmax - offset[0]) * glScale;\n    TILE_BOX[1][1] = (tileExtent.ymax - offset[1]) * glScale;\n    return intersectsBox(matrix, TILE_BOX);\n  };\n\n  _proto2._isSplittedTileInExtent = function _isSplittedTileInExtent(frustumMatrix, tileExtent, offset, glScale) {\n    var map = this.getMap();\n    TILE_BOX[0][0] = (tileExtent.xmin - offset[0]) * glScale;\n    TILE_BOX[0][1] = (tileExtent.ymin - offset[1]) * glScale;\n    TILE_BOX[1][0] = (tileExtent.xmax - offset[0]) * glScale;\n    TILE_BOX[1][1] = (tileExtent.ymax - offset[1]) * glScale;\n    return intersectsBox(map.projViewMatrix, TILE_BOX);\n  };\n\n  _proto2.getEvents = function getEvents() {\n    return {\n      'spatialreferencechange': this._onSpatialReferenceChange\n    };\n  };\n\n  _proto2._onSpatialReferenceChange = function _onSpatialReferenceChange() {\n    delete this._tileConfig;\n    delete this._defaultTileConfig;\n    delete this._sr;\n    delete this._srMinZoom;\n    delete this._hasOwnSR;\n    var renderer = this.getRenderer();\n\n    if (renderer) {\n      renderer.clear();\n    }\n  };\n\n  return TileLayer;\n}(Layer);\n\nTileLayer.registerJSONType('TileLayer');\nTileLayer.mergeOptions(options$u);\n\nfunction distanceToRect(min, max, xyz) {\n  var dx = Math.max(min[0] - xyz[0], 0, xyz[0] - max[0]);\n  var dy = Math.max(min[1] - xyz[1], 0, xyz[1] - max[1]);\n  var dz = Math.max(min[2] - xyz[2], 0, xyz[2] - max[2]);\n  return Math.sqrt(dx * dx + dy * dy + dz * dz);\n}\n\nvar workerSource = \"\\nfunction (exports) {\\n    exports.onmessage = function (msg, postResponse) {\\n        var url = msg.data.url;\\n        var fetchOptions = msg.data.fetchOptions;\\n        requestImageOffscreen(url, function (err, data) {\\n            var buffers = [];\\n            if (data && data.data && data.data.buffer) {\\n                buffers.push(data.data.buffer);\\n            }\\n            postResponse(err, data, buffers);\\n        }, fetchOptions);\\n    };\\n\\n    var offCanvas, offCtx;\\n    function requestImageOffscreen(url, cb, fetchOptions) {\\n        if (!offCanvas) {\\n            offCanvas = new OffscreenCanvas(2, 2);\\n            offCtx = offCanvas.getContext('2d');\\n        }\\n        fetch(url, fetchOptions ? fetchOptions : {})\\n            .then(response => response.blob())\\n            .then(blob => createImageBitmap(blob))\\n            .then(bitmap => {\\n                var { width, height } = bitmap;\\n                offCanvas.width = width;\\n                offCanvas.height = height;\\n                offCtx.drawImage(bitmap, 0, 0);\\n                bitmap.close();\\n                var imgData = offCtx.getImageData(0, 0, width, height);\\n                // debugger\\n                cb(null, { width, height, data: new Uint8Array(imgData.data) });\\n            }).catch(err => {\\n                console.warn('error when loading tile:', url);\\n                console.warn(err);\\n                cb(err);\\n            });\\n    }\\n}\";\n\nfunction registerWorkerSource() {\n  if (!Browser$1.decodeImageInWorker) {\n    return;\n  }\n\n  registerWorkerAdapter(imageFetchWorkerKey, function () {\n    return workerSource;\n  });\n}\n\nregisterWorkerSource();\n\nvar options$v = {\n  'maxCacheSize': 1024\n};\nvar DEFAULT_TILESIZE = new Size(256, 256);\n\nvar GroupTileLayer = function (_TileLayer) {\n  _inheritsLoose(GroupTileLayer, _TileLayer);\n\n  GroupTileLayer.fromJSON = function fromJSON(layerJSON) {\n    if (!layerJSON || layerJSON['type'] !== 'GroupTileLayer') {\n      return null;\n    }\n\n    var layers = layerJSON['layers'].map(function (json) {\n      return Layer.fromJSON(json);\n    });\n    return new GroupTileLayer(layerJSON['id'], layers, layerJSON['options']);\n  };\n\n  function GroupTileLayer(id, layers, options) {\n    var _this;\n\n    _this = _TileLayer.call(this, id, options) || this;\n    _this.layers = layers || [];\n\n    _this._checkChildren();\n\n    _this.layerMap = {};\n    _this._groupChildren = [];\n    return _this;\n  }\n\n  var _proto = GroupTileLayer.prototype;\n\n  _proto.getLayers = function getLayers() {\n    return this.layers;\n  };\n\n  _proto.toJSON = function toJSON() {\n    var profile = {\n      'type': this.getJSONType(),\n      'id': this.getId(),\n      'layers': this.layers.map(function (layer) {\n        return layer.toJSON();\n      }),\n      'options': this.config()\n    };\n    return profile;\n  };\n\n  _proto.getTileSize = function getTileSize(id) {\n    var layer = this.getLayer(id);\n\n    if (!layer) {\n      return DEFAULT_TILESIZE;\n    }\n\n    return layer.getTileSize();\n  };\n\n  _proto.getTiles = function getTiles(z, parentLayer) {\n    var layers = this.layers;\n    var tiles = [];\n    var count = 0;\n\n    for (var i = 0, l = layers.length; i < l; i++) {\n      var layer = layers[i];\n\n      if (!layer.options['visible']) {\n        continue;\n      }\n\n      var childGrid = layer.getTiles(z, parentLayer || this);\n\n      if (!childGrid || childGrid.count === 0) {\n        continue;\n      }\n\n      count += childGrid.count;\n      pushIn(tiles, childGrid.tileGrids);\n    }\n\n    return {\n      count: count,\n      tileGrids: tiles\n    };\n  };\n\n  _proto.onAdd = function onAdd() {\n    var _this2 = this;\n\n    var map = this.getMap();\n    this.layers.forEach(function (layer) {\n      _this2.layerMap[layer.getId()] = layer;\n\n      if (layer.getChildLayer) {\n        _this2._groupChildren.push(layer);\n      }\n\n      layer._bindMap(map);\n\n      layer.on('show hide', _this2._onLayerShowHide, _this2);\n    });\n\n    _TileLayer.prototype.onAdd.call(this);\n  };\n\n  _proto.onRemove = function onRemove() {\n    var _this3 = this;\n\n    this.layers.forEach(function (layer) {\n      layer._doRemove();\n\n      layer.off('show hide', _this3._onLayerShowHide, _this3);\n    });\n    this.layerMap = {};\n    this._groupChildren = [];\n\n    _TileLayer.prototype.onRemove.call(this);\n  };\n\n  _proto.getLayer = function getLayer(id) {\n    return this.getChildLayer(id);\n  };\n\n  _proto.getChildLayer = function getChildLayer(id) {\n    var layer = this.layerMap[id];\n\n    if (layer) {\n      return layer;\n    }\n\n    for (var i = 0; i < this._groupChildren.length; i++) {\n      var child = this._groupChildren[i].getChildLayer(id);\n\n      if (child) {\n        return child;\n      }\n    }\n\n    return null;\n  };\n\n  _proto._onLayerShowHide = function _onLayerShowHide() {\n    var renderer = this.getRenderer();\n\n    if (renderer) {\n      renderer.setToRedraw();\n    }\n  };\n\n  _proto.isVisible = function isVisible() {\n    if (!_TileLayer.prototype.isVisible.call(this)) {\n      return false;\n    }\n\n    var children = this.layers;\n\n    for (var i = 0, l = children.length; i < l; i++) {\n      if (children[i].isVisible()) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  _proto._checkChildren = function _checkChildren() {\n    var _this4 = this;\n\n    var ids = {};\n    this.layers.forEach(function (layer) {\n      var layerId = layer.getId();\n\n      if (ids[layerId]) {\n        throw new Error(\"Duplicate child layer id (\" + layerId + \") in the GroupTileLayer (\" + _this4.getId() + \")\");\n      } else {\n        ids[layerId] = 1;\n      }\n    });\n  };\n\n  return GroupTileLayer;\n}(TileLayer);\n\nGroupTileLayer.registerJSONType('GroupTileLayer');\nGroupTileLayer.mergeOptions(options$v);\n\nvar options$w = {\n  crs: null,\n  uppercase: false,\n  detectRetina: false\n};\nvar defaultWmsParams = {\n  service: 'WMS',\n  request: 'GetMap',\n  layers: '',\n  styles: '',\n  format: 'image/jpeg',\n  transparent: false,\n  version: '1.1.1'\n};\n\nvar WMSTileLayer = function (_TileLayer) {\n  _inheritsLoose(WMSTileLayer, _TileLayer);\n\n  function WMSTileLayer(id, options) {\n    var _this;\n\n    _this = _TileLayer.call(this, id) || this;\n    var wmsParams = extend({}, defaultWmsParams);\n\n    for (var p in options) {\n      if (!(p in _this.options)) {\n        wmsParams[p] = options[p];\n      }\n    }\n\n    _this.setOptions(options);\n\n    _this.setZIndex(options.zIndex);\n\n    var tileSize = _this.getTileSize();\n\n    wmsParams.width = tileSize.width;\n    wmsParams.height = tileSize.height;\n    _this.wmsParams = wmsParams;\n    _this._wmsVersion = parseFloat(wmsParams.version);\n    return _this;\n  }\n\n  var _proto = WMSTileLayer.prototype;\n\n  _proto.onAdd = function onAdd() {\n    var dpr = this.getMap().getDevicePixelRatio();\n    var r = options$w.detectRetina ? dpr : 1;\n    this.wmsParams.width *= r;\n    this.wmsParams.height *= r;\n    var crs = this.options.crs || this.getMap().getProjection().code;\n    var projectionKey = this._wmsVersion >= 1.3 ? 'crs' : 'srs';\n    this.wmsParams[projectionKey] = crs;\n\n    _TileLayer.prototype.onAdd.call(this);\n  };\n\n  _proto.getTileUrl = function getTileUrl(x, y, z) {\n    var res = this.getSpatialReference().getResolution(z),\n        tileConfig = this._getTileConfig(),\n        tileExtent = tileConfig.getTilePrjExtent(x, y, res);\n\n    var max = tileExtent.getMax(),\n        min = tileExtent.getMin();\n    var bbox = (this._wmsVersion >= 1.3 && this.wmsParams.crs === 'EPSG:4326' ? [min.y, min.x, max.y, max.x] : [min.x, min.y, max.x, max.y]).join(',');\n\n    var url = _TileLayer.prototype.getTileUrl.call(this, x, y, z);\n\n    return url + getParamString(this.wmsParams, url, this.options.uppercase) + (this.options.uppercase ? '&BBOX=' : '&bbox=') + bbox;\n  };\n\n  _proto.toJSON = function toJSON() {\n    return {\n      'type': 'WMSTileLayer',\n      'id': this.getId(),\n      'options': this.config()\n    };\n  };\n\n  WMSTileLayer.fromJSON = function fromJSON(layerJSON) {\n    if (!layerJSON || layerJSON['type'] !== 'WMSTileLayer') {\n      return null;\n    }\n\n    return new WMSTileLayer(layerJSON['id'], layerJSON['options']);\n  };\n\n  return WMSTileLayer;\n}(TileLayer);\n\nWMSTileLayer.registerJSONType('WMSTileLayer');\nWMSTileLayer.mergeOptions(options$w);\nfunction getParamString(obj, existingUrl, uppercase) {\n  var params = [];\n\n  for (var i in obj) {\n    params.push(encodeURIComponent(uppercase ? i.toUpperCase() : i) + '=' + encodeURIComponent(obj[i]));\n  }\n\n  return (!existingUrl || existingUrl.indexOf('?') === -1 ? '?' : '&') + params.join('&');\n}\n\nvar CanvasTileLayer = function (_TileLayer) {\n  _inheritsLoose(CanvasTileLayer, _TileLayer);\n\n  function CanvasTileLayer(id, options) {\n    var _this;\n\n    _this = _TileLayer.call(this, id, options) || this;\n\n    if (!_this.options.hasOwnProperty('forceRenderOnMoving')) {\n      _this.options['forceRenderOnMoving'] = false;\n    }\n\n    return _this;\n  }\n\n  var _proto = CanvasTileLayer.prototype;\n\n  _proto.drawTile = function drawTile() {};\n\n  _proto.toJSON = function toJSON() {\n    return {\n      'type': 'CanvasTileLayer',\n      'id': this.getId(),\n      'options': this.config()\n    };\n  };\n\n  CanvasTileLayer.fromJSON = function fromJSON(layerJSON) {\n    if (!layerJSON || layerJSON['type'] !== 'CanvasTileLayer') {\n      return null;\n    }\n\n    return new CanvasTileLayer(layerJSON['id'], layerJSON['options']);\n  };\n\n  return CanvasTileLayer;\n}(TileLayer);\n\nCanvasTileLayer.registerJSONType('CanvasTileLayer');\n\nfunction createGLContext(canvas, options) {\n  var attributes = {\n    'alpha': true,\n    'stencil': true,\n    'preserveDrawingBuffer': true,\n    'antialias': false\n  };\n  var names = ['webgl', 'experimental-webgl'];\n  var context = null;\n\n  for (var i = 0; i < names.length; ++i) {\n    try {\n      context = canvas.getContext(names[i], options || attributes);\n    } catch (e) {}\n\n    if (context) {\n      break;\n    }\n  }\n\n  return context;\n}\nfunction compileShader(gl, type, source) {\n  var shader = gl.createShader(type);\n  gl.shaderSource(shader, source);\n  gl.compileShader(shader);\n  var compiled = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\n\n  if (!compiled) {\n    var error = gl.getShaderInfoLog(shader);\n    gl.deleteShader(shader);\n    throw new Error('Failed to compile shader: ' + error);\n  }\n\n  return shader;\n}\nfunction createProgram(gl, vert, frag) {\n  var vertexShader = compileShader(gl, gl.VERTEX_SHADER, vert);\n  var fragmentShader = compileShader(gl, gl.FRAGMENT_SHADER, frag);\n\n  if (!vertexShader || !fragmentShader) {\n    return null;\n  }\n\n  var program = gl.createProgram();\n\n  if (!program) {\n    return null;\n  }\n\n  gl.attachShader(program, vertexShader);\n  gl.attachShader(program, fragmentShader);\n  gl.linkProgram(program);\n  return {\n    program: program,\n    vertexShader: vertexShader,\n    fragmentShader: fragmentShader\n  };\n}\nfunction enableVertexAttrib(gl, program, attributes) {\n  if (Array.isArray(attributes[0])) {\n    var FSIZE = Float32Array.BYTES_PER_ELEMENT;\n    var STRIDE = 0;\n\n    for (var i = 0; i < attributes.length; i++) {\n      STRIDE += attributes[i][1] || 0;\n    }\n\n    var offset = 0;\n\n    for (var _i = 0; _i < attributes.length; _i++) {\n      var attr = gl.getAttribLocation(program, attributes[_i][0]);\n\n      if (attr < 0) {\n        throw new Error('Failed to get the storage location of ' + attributes[_i][0]);\n      }\n\n      gl.vertexAttribPointer(attr, attributes[_i][1], gl[attributes[_i][2] || 'FLOAT'], false, FSIZE * STRIDE, FSIZE * offset);\n      offset += attributes[_i][1] || 0;\n      gl.enableVertexAttribArray(attr);\n    }\n  } else {\n    var _attr = gl.getAttribLocation(program, attributes[0]);\n\n    gl.vertexAttribPointer(_attr, attributes[1], gl[attributes[2] || 'FLOAT'], false, 0, 0);\n    gl.enableVertexAttribArray(_attr);\n  }\n}\n\nvar shaders = {\n  'vertexShader': \"\\n        attribute vec2 a_position;\\n\\n        attribute vec2 a_texCoord;\\n\\n        uniform mat4 u_matrix;\\n\\n        varying vec2 v_texCoord;\\n\\n        void main() {\\n            gl_Position = u_matrix * vec4(a_position, 0., 1.);\\n\\n            v_texCoord = a_texCoord;\\n        }\\n    \",\n  'fragmentShader': \"\\n        precision mediump float;\\n\\n        uniform sampler2D u_image;\\n\\n        uniform float u_opacity;\\n        uniform float u_debug_line;\\n\\n        varying vec2 v_texCoord;\\n\\n        void main() {\\n            if (u_debug_line == 1.) {\\n                gl_FragColor = vec4(0., 1., 0., 1.);\\n            } else {\\n                gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;\\n            }\\n        }\\n    \"\n};\nvar v2 = [0, 0],\n    v3 = [0, 0, 0],\n    arr16 = new Array(16);\nvar DEBUG_POINT = new Point(20, 20);\n\nvar ImageGLRenderable = function ImageGLRenderable(Base) {\n  var renderable = function (_Base) {\n    _inheritsLoose(renderable, _Base);\n\n    function renderable() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    var _proto = renderable.prototype;\n\n    _proto.drawGLImage = function drawGLImage(image, x, y, w, h, scale$$1, opacity, debug) {\n      if (this.gl.program !== this.program) {\n        this.useProgram(this.program);\n      }\n\n      var gl = this.gl;\n      this.loadTexture(image);\n      v3[0] = x || 0;\n      v3[1] = y || 0;\n      var uMatrix = identity(arr16);\n      translate(uMatrix, uMatrix, v3);\n      scale(uMatrix, uMatrix, [scale$$1, scale$$1, 1]);\n      multiply(uMatrix, this.getMap().projViewMatrix, uMatrix);\n      gl.uniformMatrix4fv(this.program['u_matrix'], false, uMatrix);\n      gl.uniform1f(this.program['u_opacity'], opacity);\n      gl.uniform1f(this.program['u_debug_line'], 0);\n      var glBuffer = image.glBuffer;\n\n      if (glBuffer && (glBuffer.width !== w || glBuffer.height !== h)) {\n        this.saveImageBuffer(glBuffer);\n        delete image.glBuffer;\n      }\n\n      if (!image.glBuffer) {\n        image.glBuffer = this.bufferTileData(0, 0, w, h);\n      } else {\n        gl.bindBuffer(gl.ARRAY_BUFFER, glBuffer);\n      }\n\n      v2[0] = 'a_position';\n      v2[1] = 2;\n      v2[2] = image.glBuffer.type;\n      this.enableVertexAttrib(v2);\n      gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n\n      if (debug) {\n        this.drawDebug(uMatrix, v2, 0, 0, w, h, debug);\n      }\n    };\n\n    _proto.drawDebug = function drawDebug(uMatrix, attrib, x, y, w, h, debugInfo) {\n      var gl = this.gl;\n      gl.bindBuffer(gl.ARRAY_BUFFER, this._debugBuffer);\n      this.enableVertexAttrib(['a_position', 2, 'FLOAT']);\n      gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([x, y, x + w, y, x + w, y - h, x, y - h, x, y]), gl.DYNAMIC_DRAW);\n      gl.uniformMatrix4fv(this.program['u_matrix'], false, uMatrix);\n      gl.uniform1f(this.program['u_debug_line'], 1);\n      gl.drawArrays(gl.LINE_STRIP, 0, 5);\n      var canvas = this._debugInfoCanvas;\n\n      if (!canvas) {\n        var dpr = this.getMap().getDevicePixelRatio() > 1 ? 2 : 1;\n        canvas = this._debugInfoCanvas = document.createElement('canvas');\n        canvas.width = 256 * dpr;\n        canvas.height = 32 * dpr;\n\n        var _ctx = canvas.getContext('2d');\n\n        _ctx.font = '20px monospace';\n\n        _ctx.scale(dpr, dpr);\n      }\n\n      var ctx = canvas.getContext('2d');\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n      var color = this.layer.options['debugOutline'];\n      Canvas.fillText(ctx, debugInfo, DEBUG_POINT, color);\n      this.loadTexture(canvas);\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, canvas);\n      w = 256;\n      h = 32;\n      var x1 = x;\n      var x2 = x + w;\n      var y1 = y;\n      var y2 = y - h;\n      gl.bufferData(gl.ARRAY_BUFFER, this.set8(x1, y1, x1, y2, x2, y1, x2, y2), gl.DYNAMIC_DRAW);\n      gl.uniform1f(this.program['u_debug_line'], 0);\n      gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n    };\n\n    _proto.bufferTileData = function bufferTileData(x, y, w, h, buffer) {\n      var x1 = x;\n      var x2 = x + w;\n      var y1 = y;\n      var y2 = y - h;\n      var data;\n\n      if (isInteger(x1) && isInteger(x2) && isInteger(y1) && isInteger(y2)) {\n        data = this.set8Int(x1, y1, x1, y2, x2, y1, x2, y2);\n      } else {\n        data = this.set8(x1, y1, x1, y2, x2, y1, x2, y2);\n      }\n\n      var glBuffer = this.loadImageBuffer(data, buffer);\n      glBuffer.width = w;\n      glBuffer.height = h;\n      glBuffer.type = data instanceof Int16Array ? 'SHORT' : 'FLOAT';\n      return glBuffer;\n    };\n\n    _proto.drawTinImage = function drawTinImage(image, vertices, texCoords, indices, opacity) {\n      var gl = this.gl;\n      this.loadTexture(image);\n      gl.uniformMatrix4fv(this.program['u_matrix'], false, this.getMap().projViewMatrix);\n      gl.uniform1f(this.program['u_opacity'], opacity);\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.posBuffer);\n      this.enableVertexAttrib(['a_position', 3]);\n      gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.DYNAMIC_DRAW);\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.texBuffer);\n      this.enableVertexAttrib(['a_texCoord', 2]);\n      gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(texCoords), gl.DYNAMIC_DRAW);\n      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(indices), gl.DYNAMIC_DRAW);\n      gl.drawElements(gl.TRIANGLES, indices.length, gl.UNSIGNED_SHORT, 0);\n    };\n\n    _proto.createCanvas2 = function createCanvas2() {\n      this.canvas2 = Canvas.createCanvas(this.canvas.width, this.canvas.height);\n    };\n\n    _proto.createGLContext = function createGLContext$$1() {\n      if (this.canvas.gl && this.canvas.gl.wrap) {\n        this.gl = this.canvas.gl.wrap();\n      } else {\n        this.gl = createGLContext(this.canvas2 || this.canvas, this.layer.options['glOptions']);\n      }\n\n      var gl = this.gl;\n      gl.clearColor(0.0, 0.0, 0.0, 0.0);\n      gl.disable(gl.DEPTH_TEST);\n      gl.enable(gl.STENCIL_TEST);\n      gl.enable(gl.BLEND);\n      gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\n      this.program = this.createProgram(shaders['vertexShader'], this.layer.options['fragmentShader'] || shaders['fragmentShader']);\n      this._debugBuffer = this.createBuffer();\n      this.useProgram(this.program);\n      this.texBuffer = this.createBuffer();\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.texBuffer);\n      this.enableVertexAttrib(['a_texCoord', 2, 'UNSIGNED_BYTE']);\n      gl.bufferData(gl.ARRAY_BUFFER, new Uint8Array([0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 1.0, 1.0]), gl.STATIC_DRAW);\n      this.enableSampler('u_image');\n      gl.activeTexture(gl['TEXTURE0']);\n      gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true);\n    };\n\n    _proto.resizeGLCanvas = function resizeGLCanvas() {\n      if (this.gl) {\n        this.gl.viewport(0, 0, this.canvas.width, this.canvas.height);\n      }\n\n      if (!this.canvas2) {\n        return;\n      }\n\n      if (this.canvas2.width !== this.canvas.width || this.canvas2.height !== this.canvas.height) {\n        this.canvas2.width = this.canvas.width;\n        this.canvas2.height = this.canvas.height;\n      }\n    };\n\n    _proto.clearGLCanvas = function clearGLCanvas() {\n      if (this.gl) {\n        this.gl.clear(this.gl.COLOR_BUFFER_BIT | this.gl.STENCIL_BUFFER_BIT);\n      }\n    };\n\n    _proto.disposeImage = function disposeImage(image) {\n      if (!image) {\n        return;\n      }\n\n      if (image.texture) {\n        this.saveTexture(image.texture);\n      }\n\n      if (image.glBuffer) {\n        this.saveImageBuffer(image.glBuffer);\n      }\n\n      delete image.texture;\n      delete image.glBuffer;\n    };\n\n    _proto._createTexture = function _createTexture(image) {\n      var gl = this.gl;\n      var texture = this.getTexture() || gl.createTexture();\n      gl.bindTexture(gl.TEXTURE_2D, texture);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, image);\n\n      if (isInteger(log2(image.width)) && isInteger(log2(image.width))) {\n        gl.generateMipmap(gl.TEXTURE_2D);\n      }\n\n      return texture;\n    };\n\n    _proto.getTexture = function getTexture() {\n      if (!this._textures) {\n        this._textures = [];\n      }\n\n      var textures = this._textures;\n      return textures && textures.length > 0 ? textures.pop() : null;\n    };\n\n    _proto.saveTexture = function saveTexture(texture) {\n      this._textures.push(texture);\n    };\n\n    _proto.loadTexture = function loadTexture(image) {\n      var gl = this.gl;\n      var texture = image.texture;\n\n      if (!texture) {\n        texture = this._createTexture(image);\n        image.texture = texture;\n      }\n\n      gl.bindTexture(gl.TEXTURE_2D, texture);\n      return texture;\n    };\n\n    _proto.getImageBuffer = function getImageBuffer() {\n      if (!this._imageBuffers) {\n        this._imageBuffers = [];\n      }\n\n      var imageBuffers = this._imageBuffers;\n      return imageBuffers && imageBuffers.length > 0 ? imageBuffers.pop() : null;\n    };\n\n    _proto.saveImageBuffer = function saveImageBuffer(buffer) {\n      if (!this._imageBuffers) {\n        this._imageBuffers = [];\n      }\n\n      this._imageBuffers.push(buffer);\n    };\n\n    _proto.loadImageBuffer = function loadImageBuffer(data, glBuffer) {\n      var gl = this.gl;\n      var buffer = glBuffer || this.createImageBuffer();\n      gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n      gl.bufferData(gl.ARRAY_BUFFER, data, gl.STATIC_DRAW);\n      return buffer;\n    };\n\n    _proto.createImageBuffer = function createImageBuffer() {\n      return this.getImageBuffer() || this.createBuffer();\n    };\n\n    _proto.removeGLCanvas = function removeGLCanvas() {\n      var gl = this.gl;\n\n      if (!gl) {\n        return;\n      }\n\n      if (this._debugBuffer) {\n        gl.deleteBuffer(this._debugBuffer);\n        delete this._debugBuffer;\n      }\n\n      if (this._buffers) {\n        this._buffers.forEach(function (b) {\n          gl.deleteBuffer(b);\n        });\n\n        delete this._buffers;\n      }\n\n      if (this._textures) {\n        this._textures.forEach(function (t) {\n          return gl.deleteTexture(t);\n        });\n\n        delete this._textures;\n      }\n\n      if (this._debugInfoCanvas) {\n        var texture = this._debugInfoCanvas.texture;\n\n        if (texture) {\n          gl.deleteTexture(texture);\n        }\n\n        delete this._debugInfoCanvas.texture;\n        delete this._debugInfoCanvas;\n      }\n\n      var program = gl.program;\n      gl.deleteShader(program.fragmentShader);\n      gl.deleteShader(program.vertexShader);\n      gl.deleteProgram(program);\n      delete this.gl;\n      delete this.canvas2;\n    };\n\n    _proto.createBuffer = function createBuffer() {\n      var gl = this.gl;\n      var buffer = gl.createBuffer();\n\n      if (!buffer) {\n        throw new Error('Failed to create the buffer object');\n      }\n\n      if (!this._buffers) {\n        this._buffers = [];\n      }\n\n      this._buffers.push(buffer);\n\n      return buffer;\n    };\n\n    _proto.enableVertexAttrib = function enableVertexAttrib$$1(attributes) {\n      enableVertexAttrib(this.gl, this.gl.program, attributes);\n    };\n\n    _proto.createProgram = function createProgram$$1(vert, frag) {\n      var gl = this.gl;\n\n      var _createProgram2 = createProgram(gl, vert, frag),\n          program = _createProgram2.program,\n          vertexShader = _createProgram2.vertexShader,\n          fragmentShader = _createProgram2.fragmentShader;\n\n      var numUniforms = gl.getProgramParameter(program, 0x8B86);\n      var activeUniforms = [];\n\n      for (var i = 0; i < numUniforms; ++i) {\n        var info = gl.getActiveUniform(program, i);\n        activeUniforms.push(info.name);\n      }\n\n      program.vertexShader = vertexShader;\n      program.fragmentShader = fragmentShader;\n\n      this._initUniforms(program, activeUniforms);\n\n      return program;\n    };\n\n    _proto.useProgram = function useProgram(program) {\n      var gl = this.gl;\n      gl.useProgram(program);\n      gl.program = program;\n      return this;\n    };\n\n    _proto.enableSampler = function enableSampler(sampler, texIdx) {\n      var gl = this.gl;\n\n      var uSampler = this._getUniform(gl.program, sampler);\n\n      if (!texIdx) {\n        texIdx = 0;\n      }\n\n      gl.uniform1i(uSampler, texIdx);\n      return uSampler;\n    };\n\n    _proto._initUniforms = function _initUniforms(program, uniforms) {\n      for (var i = 0; i < uniforms.length; i++) {\n        var name = uniforms[i];\n        var uniform = uniforms[i];\n        var b = name.indexOf('[');\n\n        if (b >= 0) {\n          name = name.substring(0, b);\n\n          if (!IS_NODE) {\n            uniform = uniform.substring(0, b);\n          }\n        }\n\n        program[name] = this._getUniform(program, uniform);\n      }\n    };\n\n    _proto._getUniform = function _getUniform(program, uniformName) {\n      var gl = this.gl;\n      var uniform = gl.getUniformLocation(program, uniformName);\n\n      if (!uniform) {\n        throw new Error('Failed to get the storage location of ' + uniformName);\n      }\n\n      return uniform;\n    };\n\n    return renderable;\n  }(Base);\n\n  extend(renderable.prototype, {\n    set8: function () {\n      var out = Browser$1.ie9 ? null : new Float32Array(8);\n      return function (a0, a1, a2, a3, a4, a5, a6, a7) {\n        out[0] = a0;\n        out[1] = a1;\n        out[2] = a2;\n        out[3] = a3;\n        out[4] = a4;\n        out[5] = a5;\n        out[6] = a6;\n        out[7] = a7;\n        return out;\n      };\n    }(),\n    set8Int: function () {\n      var out = Browser$1.ie9 ? null : new Int16Array(8);\n      return function (a0, a1, a2, a3, a4, a5, a6, a7) {\n        out[0] = a0;\n        out[1] = a1;\n        out[2] = a2;\n        out[3] = a3;\n        out[4] = a4;\n        out[5] = a5;\n        out[6] = a6;\n        out[7] = a7;\n        return out;\n      };\n    }()\n  });\n  return renderable;\n};\n\nvar options$x = {\n  renderer: Browser$1.webgl ? 'gl' : 'canvas',\n  crossOrigin: null\n};\nvar TEMP_POINT$1 = new Point(0, 0);\n\nvar ImageLayer = function (_Layer) {\n  _inheritsLoose(ImageLayer, _Layer);\n\n  function ImageLayer(id, images, options) {\n    var _this;\n\n    if (images && !Array.isArray(images) && !images.url) {\n      options = images;\n      images = null;\n    }\n\n    _this = _Layer.call(this, id, options) || this;\n    _this._images = images;\n    return _this;\n  }\n\n  var _proto = ImageLayer.prototype;\n\n  _proto.onAdd = function onAdd() {\n    this._prepareImages(this._images);\n  };\n\n  _proto.setImages = function setImages(images) {\n    this._images = images;\n\n    this._prepareImages(images);\n\n    return this;\n  };\n\n  _proto.getImages = function getImages() {\n    return this._images;\n  };\n\n  _proto._prepareImages = function _prepareImages(images) {\n    images = images || [];\n\n    if (!Array.isArray(images)) {\n      images = [images];\n    }\n\n    var map = this.getMap();\n    var glRes = map.getGLRes();\n    this._imageData = images.map(function (img) {\n      var extent = new Extent(img.extent);\n      return extend({}, img, {\n        extent: extent,\n        extent2d: extent.convertTo(function (c) {\n          return map.coordToPointAtRes(c, glRes);\n        })\n      });\n    });\n    this._images = images;\n    var renderer = this.getRenderer();\n\n    if (renderer) {\n      renderer.refreshImages();\n    }\n  };\n\n  return ImageLayer;\n}(Layer);\n\nImageLayer.mergeOptions(options$x);\nvar EMPTY_ARRAY$1 = [];\nvar ImageLayerCanvasRenderer = function (_CanvasRenderer) {\n  _inheritsLoose(ImageLayerCanvasRenderer, _CanvasRenderer);\n\n  function ImageLayerCanvasRenderer() {\n    return _CanvasRenderer.apply(this, arguments) || this;\n  }\n\n  var _proto2 = ImageLayerCanvasRenderer.prototype;\n\n  _proto2.isDrawable = function isDrawable() {\n    if (this.getMap().getPitch()) {\n      if (console) {\n        console.warn('ImageLayer with canvas renderer can\\'t be pitched, use gl renderer (\\'renderer\\' : \\'gl\\') instead.');\n      }\n\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto2.checkResources = function checkResources() {\n    var _this2 = this;\n\n    if (this._imageLoaded) {\n      return EMPTY_ARRAY$1;\n    }\n\n    var layer = this.layer;\n\n    var urls = layer._imageData.map(function (img) {\n      return [img.url, null, null];\n    });\n\n    if (this.resources) {\n      var unloaded = [];\n      var resources = new ResourceCache();\n      urls.forEach(function (url) {\n        if (_this2.resources.isResourceLoaded(url)) {\n          var img = _this2.resources.getImage(url);\n\n          resources.addResource(url, img);\n        } else {\n          unloaded.push(url);\n        }\n      });\n      this.resources.forEach(function (url, res) {\n        if (!resources.isResourceLoaded(url)) {\n          _this2.retireImage(res.image);\n        }\n      });\n      this.resources = resources;\n      urls = unloaded;\n    }\n\n    this._imageLoaded = true;\n    return urls;\n  };\n\n  _proto2.retireImage = function retireImage(image) {\n    if (image.close) {\n      image.close();\n    }\n  };\n\n  _proto2.refreshImages = function refreshImages() {\n    this._imageLoaded = false;\n    this.setToRedraw();\n  };\n\n  _proto2.draw = function draw() {\n    if (!this.isDrawable()) {\n      return;\n    }\n\n    this.prepareCanvas();\n    this._painted = false;\n\n    this._drawImages();\n\n    this.completeRender();\n  };\n\n  _proto2._drawImages = function _drawImages() {\n    var imgData = this.layer._imageData;\n    var map = this.getMap();\n\n    var mapExtent = map._get2DExtentAtRes(map.getGLRes());\n\n    if (imgData && imgData.length) {\n      for (var i = 0; i < imgData.length; i++) {\n        var extent = imgData[i].extent2d;\n        var image = this.resources && this.resources.getImage(imgData[i].url);\n\n        if (image && mapExtent.intersects(extent)) {\n          this._painted = true;\n\n          this._drawImage(image, extent, imgData[i].opacity || 1);\n        }\n      }\n    }\n  };\n\n  _proto2._drawImage = function _drawImage(image, extent, opacity) {\n    var globalAlpha = 0;\n    var ctx = this.context;\n\n    if (opacity < 1) {\n      globalAlpha = ctx.globalAlpha;\n      ctx.globalAlpha = opacity;\n    }\n\n    var map = this.getMap();\n    var nw = TEMP_POINT$1.set(extent.xmin, extent.ymax);\n\n    var point = map._pointAtResToContainerPoint(nw, map.getGLRes());\n\n    var x = point.x,\n        y = point.y;\n    var bearing = map.getBearing();\n\n    if (bearing) {\n      ctx.save();\n      ctx.translate(x, y);\n\n      if (bearing) {\n        ctx.rotate(-bearing * Math.PI / 180);\n      }\n\n      x = y = 0;\n    }\n\n    var scale = map.getGLScale();\n    ctx.drawImage(image, x, y, extent.getWidth() / scale, extent.getHeight() / scale);\n\n    if (bearing) {\n      ctx.restore();\n    }\n\n    if (globalAlpha) {\n      ctx.globalAlpha = globalAlpha;\n    }\n  };\n\n  _proto2.drawOnInteracting = function drawOnInteracting() {\n    this.draw();\n  };\n\n  return ImageLayerCanvasRenderer;\n}(CanvasRenderer);\nvar ImageLayerGLRenderer = function (_ImageGLRenderable) {\n  _inheritsLoose(ImageLayerGLRenderer, _ImageGLRenderable);\n\n  function ImageLayerGLRenderer() {\n    return _ImageGLRenderable.apply(this, arguments) || this;\n  }\n\n  var _proto3 = ImageLayerGLRenderer.prototype;\n\n  _proto3.isDrawable = function isDrawable() {\n    return true;\n  };\n\n  _proto3._drawImage = function _drawImage(image, extent, opacity) {\n    this.drawGLImage(image, extent.xmin, extent.ymax, extent.getWidth(), extent.getHeight(), 1, opacity);\n  };\n\n  _proto3.createContext = function createContext() {\n    this.createGLContext();\n  };\n\n  _proto3.resizeCanvas = function resizeCanvas(canvasSize) {\n    if (!this.canvas) {\n      return;\n    }\n\n    _ImageGLRenderable.prototype.resizeCanvas.call(this, canvasSize);\n\n    this.resizeGLCanvas();\n  };\n\n  _proto3.clearCanvas = function clearCanvas() {\n    if (!this.canvas) {\n      return;\n    }\n\n    _ImageGLRenderable.prototype.clearCanvas.call(this);\n\n    this.clearGLCanvas();\n  };\n\n  _proto3.retireImage = function retireImage(image) {\n    if (image.close) {\n      image.close();\n    }\n\n    this.disposeImage(image);\n  };\n\n  _proto3.onRemove = function onRemove() {\n    this.removeGLCanvas();\n\n    _ImageGLRenderable.prototype.onRemove.call(this);\n  };\n\n  return ImageLayerGLRenderer;\n}(ImageGLRenderable(ImageLayerCanvasRenderer));\nImageLayer.registerRenderer('canvas', ImageLayerCanvasRenderer);\nImageLayer.registerRenderer('gl', ImageLayerGLRenderer);\n\nvar CanvasLayerRenderer = function (_CanvasRenderer) {\n  _inheritsLoose(CanvasLayerRenderer, _CanvasRenderer);\n\n  function CanvasLayerRenderer() {\n    return _CanvasRenderer.apply(this, arguments) || this;\n  }\n\n  var _proto = CanvasLayerRenderer.prototype;\n\n  _proto.getPrepareParams = function getPrepareParams() {\n    return [];\n  };\n\n  _proto.getDrawParams = function getDrawParams() {\n    return [];\n  };\n\n  _proto.onCanvasCreate = function onCanvasCreate() {\n    if (this.canvas && this.layer.options['doubleBuffer']) {\n      this.buffer = Canvas.createCanvas(this.canvas.width, this.canvas.height, this.getMap().CanvasClass);\n    }\n  };\n\n  _proto.needToRedraw = function needToRedraw() {\n    if (this.layer.options['animation']) {\n      return true;\n    }\n\n    var map = this.getMap();\n\n    if (map.isInteracting() && !this.layer.drawOnInteracting) {\n      return false;\n    }\n\n    return _CanvasRenderer.prototype.needToRedraw.call(this);\n  };\n\n  _proto.draw = function draw() {\n    this.prepareCanvas();\n    this.prepareDrawContext();\n\n    this._drawLayer.apply(this, arguments);\n  };\n\n  _proto.drawOnInteracting = function drawOnInteracting() {\n    this._drawLayerOnInteracting.apply(this, arguments);\n  };\n\n  _proto.getCanvasImage = function getCanvasImage() {\n    var canvasImg = _CanvasRenderer.prototype.getCanvasImage.call(this);\n\n    if (canvasImg && canvasImg.image && this.layer.options['doubleBuffer']) {\n      var canvas = canvasImg.image;\n\n      if (this.buffer.width !== canvas.width || this.buffer.height !== canvas.height) {\n        this.buffer.width = canvas.width;\n        this.buffer.height = canvas.height;\n      }\n\n      var bufferContext = this.buffer.getContext('2d');\n      var prevent = this.layer.doubleBuffer(bufferContext, this.context);\n\n      if (prevent === undefined || prevent) {\n        Canvas.image(bufferContext, canvas, 0, 0);\n        canvasImg.image = this.buffer;\n      }\n    }\n\n    return canvasImg;\n  };\n\n  _proto.remove = function remove() {\n    delete this._drawContext;\n    return _CanvasRenderer.prototype.remove.call(this);\n  };\n\n  _proto.onZoomStart = function onZoomStart(param) {\n    this.layer.onZoomStart(param);\n\n    _CanvasRenderer.prototype.onZoomStart.call(this, param);\n  };\n\n  _proto.onZooming = function onZooming(param) {\n    this.layer.onZooming(param);\n\n    _CanvasRenderer.prototype.onZooming.call(this, param);\n  };\n\n  _proto.onZoomEnd = function onZoomEnd(param) {\n    this.layer.onZoomEnd(param);\n\n    _CanvasRenderer.prototype.onZoomEnd.call(this, param);\n  };\n\n  _proto.onMoveStart = function onMoveStart(param) {\n    this.layer.onMoveStart(param);\n\n    _CanvasRenderer.prototype.onMoveStart.call(this, param);\n  };\n\n  _proto.onMoving = function onMoving(param) {\n    this.layer.onMoving(param);\n\n    _CanvasRenderer.prototype.onMoving.call(this, param);\n  };\n\n  _proto.onMoveEnd = function onMoveEnd(param) {\n    this.layer.onMoveEnd(param);\n\n    _CanvasRenderer.prototype.onMoveEnd.call(this, param);\n  };\n\n  _proto.onResize = function onResize(param) {\n    this.layer.onResize(param);\n\n    _CanvasRenderer.prototype.onResize.call(this, param);\n  };\n\n  _proto.prepareDrawContext = function prepareDrawContext() {\n    if (!this._predrawed) {\n      var params = ensureParams(this.getPrepareParams());\n      this._drawContext = this.layer.prepareToDraw.apply(this.layer, [this.context].concat(params));\n\n      if (!this._drawContext) {\n        this._drawContext = [];\n      }\n\n      if (!Array.isArray(this._drawContext)) {\n        this._drawContext = [this._drawContext];\n      }\n\n      this._predrawed = true;\n    }\n  };\n\n  _proto._prepareDrawParams = function _prepareDrawParams() {\n    if (!this.getMap()) {\n      return null;\n    }\n\n    var view = this.getViewExtent();\n\n    if (view['maskExtent'] && !view['extent'].intersects(view['maskExtent'])) {\n      this.completeRender();\n      return null;\n    }\n\n    var args = [this.context, view];\n    var params = ensureParams(this.getDrawParams());\n    args.push.apply(args, params);\n    args.push.apply(args, this._drawContext);\n    return args;\n  };\n\n  _proto._drawLayer = function _drawLayer() {\n    var params = this._prepareDrawParams();\n\n    if (!params) {\n      return;\n    }\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    this.layer.draw.apply(this.layer, params.concat(args));\n    this.completeRender();\n  };\n\n  _proto._drawLayerOnInteracting = function _drawLayerOnInteracting() {\n    if (!this.layer.drawOnInteracting) {\n      return;\n    }\n\n    var params = this._prepareDrawParams();\n\n    if (!params) {\n      return;\n    }\n\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n\n    this.layer.drawOnInteracting.apply(this.layer, params.concat(args));\n    this.completeRender();\n  };\n\n  return CanvasLayerRenderer;\n}(CanvasRenderer);\n\nfunction ensureParams(params) {\n  if (!params) {\n    params = [];\n  }\n\n  if (!Array.isArray(params)) {\n    params = [params];\n  }\n\n  return params;\n}\n\nvar options$y = {\n  'doubleBuffer': false,\n  'animation': false\n};\n\nvar CanvasLayer = function (_Layer) {\n  _inheritsLoose(CanvasLayer, _Layer);\n\n  function CanvasLayer() {\n    return _Layer.apply(this, arguments) || this;\n  }\n\n  var _proto = CanvasLayer.prototype;\n\n  _proto.isCanvasRender = function isCanvasRender() {\n    return true;\n  };\n\n  _proto.prepareToDraw = function prepareToDraw() {};\n\n  _proto.draw = function draw() {};\n\n  _proto.redraw = function redraw() {\n    if (this._getRenderer()) {\n      this._getRenderer().setToRedraw();\n    }\n\n    return this;\n  };\n\n  _proto.play = function play() {\n    this.config('animation', true);\n    return this;\n  };\n\n  _proto.pause = function pause() {\n    this.config('animation', false);\n    return this;\n  };\n\n  _proto.isPlaying = function isPlaying() {\n    return this.options['animation'];\n  };\n\n  _proto.clearCanvas = function clearCanvas() {\n    if (this._getRenderer()) {\n      this._getRenderer().clearCanvas();\n    }\n\n    return this;\n  };\n\n  _proto.requestMapToRender = function requestMapToRender() {\n    if (this._getRenderer()) {\n      this._getRenderer().requestMapToRender();\n    }\n\n    return this;\n  };\n\n  _proto.completeRender = function completeRender() {\n    if (this._getRenderer()) {\n      this._getRenderer().completeRender();\n    }\n\n    return this;\n  };\n\n  _proto.onCanvasCreate = function onCanvasCreate() {\n    return this;\n  };\n\n  _proto.onZoomStart = function onZoomStart() {};\n\n  _proto.onZooming = function onZooming() {};\n\n  _proto.onZoomEnd = function onZoomEnd() {};\n\n  _proto.onMoveStart = function onMoveStart() {};\n\n  _proto.onMoving = function onMoving() {};\n\n  _proto.onMoveEnd = function onMoveEnd() {};\n\n  _proto.onResize = function onResize() {};\n\n  _proto.doubleBuffer = function doubleBuffer(bufferContext) {\n    bufferContext.clearRect(0, 0, bufferContext.canvas.width, bufferContext.canvas.height);\n    return this;\n  };\n\n  return CanvasLayer;\n}(Layer);\n\nCanvasLayer.mergeOptions(options$y);\nCanvasLayer.registerRenderer('canvas', CanvasLayerRenderer);\n\nvar TEMP_POINT$2 = new Point(0, 0);\nvar options$z = {\n  'animation': true\n};\n\nvar ParticleLayer = function (_CanvasLayer) {\n  _inheritsLoose(ParticleLayer, _CanvasLayer);\n\n  function ParticleLayer() {\n    return _CanvasLayer.apply(this, arguments) || this;\n  }\n\n  var _proto = ParticleLayer.prototype;\n\n  _proto.getParticles = function getParticles() {};\n\n  _proto.draw = function draw(context, view) {\n    var points = this.getParticles(now());\n\n    if (!points || points.length === 0) {\n      var renderer = this._getRenderer();\n\n      if (renderer) {\n        this._getRenderer()._shouldClear = true;\n      }\n\n      return;\n    }\n\n    var map = this.getMap();\n    var extent = view.extent;\n\n    if (view.maskExtent) {\n      extent = view.extent.intersection(view.maskExtent);\n    }\n\n    extent = extent.convertTo(function (c) {\n      return map._pointToContainerPoint(c, undefined, 0, TEMP_POINT$2);\n    });\n    var e = 2 * Math.PI;\n\n    for (var i = 0, l = points.length; i < l; i++) {\n      var pos = points[i].point;\n\n      if (extent.contains(pos)) {\n        var color = points[i].color || this.options['lineColor'] || '#fff',\n            r = points[i].r;\n\n        if (context.fillStyle !== color) {\n          context.fillStyle = color;\n        }\n\n        if (r <= 2) {\n          context.fillRect(pos.x - r / 2, pos.y - r / 2, r, r);\n        } else {\n          context.beginPath();\n          context.arc(pos.x, pos.y, r / 2, 0, e);\n          context.fill();\n        }\n      }\n    }\n\n    this._fillCanvas(context);\n  };\n\n  _proto._fillCanvas = function _fillCanvas(context) {\n    var g = context.globalCompositeOperation;\n    context.globalCompositeOperation = 'destination-out';\n    var trail = this.options['trail'] || 30;\n    context.fillStyle = 'rgba(0, 0, 0, ' + 1 / trail + ')';\n    context.fillRect(0, 0, context.canvas.width, context.canvas.height);\n    context.globalCompositeOperation = g;\n  };\n\n  return ParticleLayer;\n}(CanvasLayer);\n\nParticleLayer.mergeOptions(options$z);\nParticleLayer.registerRenderer('canvas', function (_CanvasLayerRenderer) {\n  _inheritsLoose(_class, _CanvasLayerRenderer);\n\n  function _class() {\n    return _CanvasLayerRenderer.apply(this, arguments) || this;\n  }\n\n  var _proto2 = _class.prototype;\n\n  _proto2.draw = function draw() {\n    if (!this.canvas || !this.layer.options['animation'] || this._shouldClear) {\n      this.prepareCanvas();\n      this._shouldClear = false;\n    }\n\n    this.prepareDrawContext();\n\n    this._drawLayer();\n  };\n\n  _proto2.drawOnInteracting = function drawOnInteracting() {\n    this.draw();\n    this._shouldClear = false;\n  };\n\n  _proto2.onSkipDrawOnInteracting = function onSkipDrawOnInteracting() {\n    this._shouldClear = true;\n  };\n\n  return _class;\n}(CanvasLayerRenderer));\n\nvar resources = new ResourceCache();\nvar prevX, prevY;\n\nvar EditHandle = function (_Eventable) {\n  _inheritsLoose(EditHandle, _Eventable);\n\n  function EditHandle(target, map, options) {\n    var _this;\n\n    _this = _Eventable.call(this, options) || this;\n    _this.target = target;\n    target.once('remove', _this.delete, _assertThisInitialized(_assertThisInitialized(_this)));\n    var symbol = _this.options['symbol'];\n    var lineWidth = symbol['markerLineWidth'] || 1;\n    _this.w = symbol['markerWidth'] + lineWidth;\n    _this.h = symbol['markerHeight'] + lineWidth;\n    _this.dx = symbol['markerDx'] || 0;\n    _this.dy = symbol['markerDy'] || 0;\n    _this.opacity = isNil(symbol['opacity']) ? 1 : symbol['opacity'];\n    _this.map = map;\n    _this.events = options.events;\n\n    _this._fetchImage();\n\n    _this.addTo(map);\n\n    return _this;\n  }\n\n  var _proto = EditHandle.prototype;\n\n  _proto.getCursor = function getCursor() {\n    return this.options['cursor'] || 'default';\n  };\n\n  _proto._fetchImage = function _fetchImage() {\n    var map = this.map;\n    var symbol = this.options.symbol;\n    var markerFile = symbol.markerFile;\n    this.url = markerFile || getSymbolHash(symbol);\n    var img = resources.getImage(this.url);\n\n    if (!img) {\n      var w = this.w;\n      var h = this.h;\n\n      if (markerFile) {\n        img = new Image();\n\n        img.onload = function () {\n          var renderer = map.getRenderer();\n\n          if (renderer) {\n            renderer.setToRedraw();\n          }\n        };\n\n        img.src = this.url;\n      } else {\n        var canvas = document.createElement('canvas');\n        canvas.width = w;\n        canvas.height = h;\n        var ctx = canvas.getContext('2d');\n        img = drawVectorMarker(ctx, {\n          x: w / 2,\n          y: h / 2\n        }, symbol, resources);\n      }\n\n      resources.addResource([this.url, w, h], img);\n    }\n\n    resources.login(this.url);\n    this._img = img;\n  };\n\n  _proto.setContainerPoint = function setContainerPoint(cp) {\n    this._point = cp;\n\n    this._point._sub(this.w / 2, this.h / 2);\n  };\n\n  _proto.getContainerPoint = function getContainerPoint() {\n    return this._point.add(this.w / 2, this.h / 2);\n  };\n\n  _proto.offset = function offset(p) {\n    this._point._add(p);\n  };\n\n  _proto.render = function render(ctx) {\n    if (!this._img) {\n      return false;\n    }\n\n    var map = this.map;\n    var _this$_point = this._point,\n        x = _this$_point.x,\n        y = _this$_point.y;\n    var w = this.w;\n    var h = this.h;\n\n    if (x + w > 0 && x < map.width && y + h > 0 && y < map.height) {\n      var dpr = map.getDevicePixelRatio();\n      ctx.globalAlpha = this.opacity;\n      ctx.drawImage(this._img, Math.round((x + this.dx) * dpr) + this.dx, Math.round((y + this.dy) * dpr), Math.round(w * dpr), Math.round(h * dpr));\n      return true;\n    }\n\n    return false;\n  };\n\n  _proto.delete = function _delete() {\n    if (this.map) {\n      var renderer = this.map.getRenderer();\n\n      if (renderer) {\n        renderer.removeTopElement(this);\n      }\n    }\n\n    resources.logout(this.url);\n\n    if (this._dragger) {\n      this._dragger.disable();\n\n      delete this._dragger;\n    }\n\n    delete this.map;\n  };\n\n  _proto.hitTest = function hitTest(p) {\n    var w = this.w;\n    var h = this.h;\n    var x = this._point.x + this.dx;\n    var y = this._point.y + this.dy;\n    return p.x >= x && p.x <= x + w && p.y >= y && p.y <= y + h;\n  };\n\n  _proto.addTo = function addTo(map) {\n    this.map = map;\n    var renderer = map.getRenderer();\n    renderer.addTopElement(this);\n  };\n\n  _proto.onEvent = function onEvent(e) {\n    this.fire(e.type, e);\n  };\n\n  _proto.mousedown = function mousedown(e) {\n    var map = e.target;\n    var cursor = this.options['cursor'];\n\n    if (cursor) {\n      map.setCursor(cursor);\n    }\n\n    this.onDragstart(e);\n  };\n\n  _proto.onDragstart = function onDragstart(e) {\n    var containerPoint = e.containerPoint,\n        map = e.target;\n    var dom = map._panels.mapWrapper || map._containerDOM;\n    var dragHandler = this._dragger = new DragHandler(dom);\n    dragHandler.on('dragging', this.onDragging, this).on('mouseup', this.onDragend, this).enable();\n    dragHandler.type = 'handle';\n    dragHandler.onMouseDown(e['domEvent']);\n    prevX = containerPoint.x;\n    prevY = containerPoint.y;\n    this.fire('dragstart', {\n      containerPoint: containerPoint\n    });\n  };\n\n  _proto.onDragging = function onDragging(e) {\n    if (!this._dragger) {\n      return;\n    }\n\n    var activeMap = this.map;\n    var containerPoint = getEventContainerPoint(e.domEvent, activeMap._containerDOM);\n    var offset = {\n      x: containerPoint.x - prevX,\n      y: containerPoint.y - prevY\n    };\n    var prevCoord = activeMap.containerPointToCoord(new Point(prevX, prevY));\n    var currentCoord = activeMap.containerPointToCoord(containerPoint);\n    prevX = containerPoint.x;\n    prevY = containerPoint.y;\n    this.offset(offset);\n    this.fire('dragging', {\n      containerPoint: containerPoint,\n      coordOffset: currentCoord._sub(prevCoord)\n    });\n  };\n\n  _proto.onDragend = function onDragend(e) {\n    if (!this._dragger) {\n      return;\n    }\n\n    var map = this.map;\n    map.resetCursor();\n    var containerPoint = getEventContainerPoint(e.domEvent, map._containerDOM);\n    var offset = {\n      x: containerPoint.x - prevX,\n      y: containerPoint.y - prevY\n    };\n    this.offset(offset);\n\n    this._dragger.disable();\n\n    delete this._dragger;\n    this.fire('dragend', {\n      containerPoint: containerPoint\n    });\n  };\n\n  return EditHandle;\n}(Eventable(Class));\n\nvar EditOutline = function () {\n  function EditOutline(target, map) {\n    this.target = target;\n    target.once('remove', this.delete, this);\n    this.map = map;\n    this.addTo(map);\n  }\n\n  var _proto = EditOutline.prototype;\n\n  _proto.setPoints = function setPoints(points) {\n    this.points = points;\n    var allX = points.map(function (p) {\n      return p.x;\n    });\n    var allY = points.map(function (p) {\n      return p.y;\n    });\n    this.xmin = Math.min.apply(Math, allX);\n    this.xmax = Math.max.apply(Math, allX);\n    this.ymin = Math.min.apply(Math, allY);\n    this.ymax = Math.max.apply(Math, allY);\n  };\n\n  _proto.hitTest = function hitTest() {\n    return false;\n  };\n\n  _proto.render = function render(ctx) {\n    var map = this.map;\n\n    if (this.xmax <= 0 || this.xmin >= map.width || this.ymax <= 0 || this.ymin >= map.height) {\n      return;\n    }\n\n    var dpr = map.getDevicePixelRatio();\n    var padding = 0.5;\n\n    function c(v) {\n      return Math.round(v) * dpr + padding;\n    }\n\n    ctx.lineWidth = 1;\n    ctx.strokeStyle = '#000';\n    ctx.globalAlpha = 1;\n    ctx.beginPath();\n    var points = this.points;\n    ctx.moveTo(c(points[0].x), c(points[0].y));\n\n    for (var i = 1; i < this.points.length; i++) {\n      ctx.lineTo(c(points[i].x), c(points[i].y));\n    }\n\n    ctx.closePath();\n    ctx.stroke();\n  };\n\n  _proto.addTo = function addTo(map) {\n    this.map = map;\n    var renderer = map.getRenderer();\n    renderer.addTopElement(this);\n  };\n\n  _proto.delete = function _delete() {\n    if (this.map) {\n      var renderer = this.map.getRenderer();\n\n      if (renderer) {\n        renderer.removeTopElement(this);\n      }\n    }\n  };\n\n  return EditOutline;\n}();\n\nvar EDIT_STAGE_LAYER_PREFIX = INTERNAL_LAYER_PREFIX + '_edit_stage_';\n\nfunction createHandleSymbol(markerType, opacity) {\n  return {\n    'markerType': markerType,\n    'markerFill': '#fff',\n    'markerLineColor': '#000',\n    'markerLineWidth': 2,\n    'markerWidth': 10,\n    'markerHeight': 10,\n    'opacity': opacity\n  };\n}\n\nvar options$A = {\n  'fixAspectRatio': false,\n  'symbol': null,\n  'removeVertexOn': 'contextmenu',\n  'centerHandleSymbol': createHandleSymbol('ellipse', 1),\n  'vertexHandleSymbol': createHandleSymbol('square', 1),\n  'newVertexHandleSymbol': createHandleSymbol('square', 0.4)\n};\n\nvar GeometryEditor = function (_Eventable) {\n  _inheritsLoose(GeometryEditor, _Eventable);\n\n  function GeometryEditor(geometry, opts) {\n    var _this;\n\n    _this = _Eventable.call(this, opts) || this;\n    _this._geometry = geometry;\n\n    if (!_this._geometry) {\n      return _assertThisInitialized(_this);\n    }\n\n    return _this;\n  }\n\n  var _proto = GeometryEditor.prototype;\n\n  _proto.getMap = function getMap() {\n    return this._geometry.getMap();\n  };\n\n  _proto.prepare = function prepare() {\n    var map = this.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    map.on('drawtopstart', this._refresh, this);\n\n    if (this.options['symbol']) {\n      this._originalSymbol = this._geometry.getSymbol();\n\n      this._geometry.setSymbol(this.options['symbol']);\n    }\n\n    this._prepareEditStageLayer();\n  };\n\n  _proto._prepareEditStageLayer = function _prepareEditStageLayer() {\n    var layer = this._geometry.getLayer();\n\n    if (layer.options['renderer'] !== 'canvas') {\n      return;\n    }\n\n    var map = this.getMap();\n    var uid = UID();\n    var shadowId = EDIT_STAGE_LAYER_PREFIX + uid + '_shadow';\n    this._shadowLayer = map.getLayer(shadowId);\n\n    if (!this._shadowLayer) {\n      var LayerType = layer.constructor;\n      this._shadowLayer = new LayerType(shadowId);\n      map.addLayer(this._shadowLayer);\n    }\n  };\n\n  _proto.start = function start() {\n    if (!this._geometry || !this._geometry.getMap() || this._geometry.editing) {\n      return;\n    }\n\n    this.editing = true;\n    this.prepare();\n    var geometry = this._geometry;\n    var shadow;\n\n    var layer = this._geometry.getLayer();\n\n    var needShadow = layer.options['renderer'] === 'canvas';\n    this._geometryDraggble = geometry.options['draggable'];\n\n    if (needShadow) {\n      geometry.config('draggable', false);\n      shadow = geometry.copy();\n      shadow.setSymbol(geometry._getInternalSymbol());\n      shadow.copyEventListeners(geometry);\n\n      if (geometry._getParent()) {\n        shadow.copyEventListeners(geometry._getParent());\n      }\n\n      shadow._setEventTarget(geometry);\n\n      shadow.setId(null).config({\n        'draggable': false\n      });\n      this._shadow = shadow;\n      geometry.hide();\n    } else if (geometry instanceof Marker) {\n      geometry.config('draggable', true);\n    }\n\n    this._switchGeometryEvents('on');\n\n    if (geometry instanceof Marker || geometry instanceof Circle || geometry instanceof Rectangle || geometry instanceof Ellipse) {\n      this._createOrRefreshOutline();\n    }\n\n    if (this._shadowLayer) {\n      this._shadowLayer.bringToFront().addGeometry(shadow);\n    }\n\n    if (!(geometry instanceof Marker)) {\n      this._createCenterHandle();\n    } else if (shadow) {\n      shadow.config('draggable', true);\n      shadow.on('dragend', this._onMarkerDragEnd, this);\n    }\n\n    if (geometry instanceof Marker && this.options['resize'] !== false) {\n      this.createMarkerEditor();\n    } else if (geometry instanceof Circle) {\n      this.createCircleEditor();\n    } else if (geometry instanceof Rectangle) {\n      this.createEllipseOrRectEditor();\n    } else if (geometry instanceof Ellipse) {\n      this.createEllipseOrRectEditor();\n    } else if (geometry instanceof Sector) ; else if (geometry instanceof Polygon || geometry instanceof LineString) {\n      this.createPolygonEditor();\n    }\n  };\n\n  _proto.stop = function stop() {\n    delete this._history;\n    delete this._historyPointer;\n    delete this._editOutline;\n\n    this._switchGeometryEvents('off');\n\n    var map = this.getMap();\n\n    if (!map) {\n      this.fire('remove');\n      return;\n    }\n\n    this._geometry.config('draggable', this._geometryDraggble);\n\n    if (this._shadow) {\n      delete this._shadow;\n      delete this._geometryDraggble;\n\n      this._geometry.show();\n    }\n\n    if (this._shadowLayer) {\n      this._shadowLayer.remove();\n\n      delete this._shadowLayer;\n    }\n\n    this._refreshHooks = [];\n\n    if (this.options['symbol']) {\n      this._geometry.setSymbol(this._originalSymbol);\n\n      delete this._originalSymbol;\n    }\n\n    this.editing = false;\n    this.fire('remove');\n  };\n\n  _proto.isEditing = function isEditing() {\n    if (isNil(this.editing)) {\n      return false;\n    }\n\n    return this.editing;\n  };\n\n  _proto._getGeometryEvents = function _getGeometryEvents() {\n    return {\n      'symbolchange': this._onGeoSymbolChange,\n      'dragstart': this._onDragStart,\n      'dragend': this._onDragEnd,\n      'positionchange shapechange': this._exeAndReset\n    };\n  };\n\n  _proto._switchGeometryEvents = function _switchGeometryEvents(oper) {\n    if (this._geometry) {\n      var events = this._getGeometryEvents();\n\n      for (var p in events) {\n        this._geometry[oper](p, events[p], this);\n      }\n    }\n  };\n\n  _proto._onGeoSymbolChange = function _onGeoSymbolChange(param) {\n    if (this._shadow) {\n      this._shadow.setSymbol(param.target._getInternalSymbol());\n    }\n  };\n\n  _proto._onMarkerDragEnd = function _onMarkerDragEnd() {\n    this._update('setCoordinates', this._shadow.getCoordinates().toArray());\n  };\n\n  _proto._createOrRefreshOutline = function _createOrRefreshOutline() {\n    var geometry = this._geometry;\n    var outline = this._editOutline;\n\n    if (!outline) {\n      this._editOutline = new EditOutline(this, this.getMap());\n\n      this._addRefreshHook(this._createOrRefreshOutline);\n    }\n\n    var points = this._editOutline.points;\n\n    if (geometry instanceof Marker) {\n      this._editOutline.setPoints(geometry.getContainerExtent().toArray(points));\n    } else {\n      var map = this.getMap();\n\n      var extent = geometry._getPrjExtent();\n\n      points = extent.toArray(points);\n      points.forEach(function (c) {\n        return map._prjToContainerPoint(c, null, c);\n      });\n\n      this._editOutline.setPoints(points);\n    }\n\n    return outline;\n  };\n\n  _proto._createCenterHandle = function _createCenterHandle() {\n    var _this2 = this;\n\n    var map = this.getMap();\n    var symbol = this.options['centerHandleSymbol'];\n\n    if (this._geometry instanceof LineString) {\n      symbol['markerDx'] = 5;\n    }\n\n    var shadow;\n    var cointainerPoint = map.coordToContainerPoint(this._geometry.getCenter());\n    var handle = this.createHandle(cointainerPoint, {\n      'symbol': symbol,\n      'cursor': 'move',\n      onDown: function onDown() {\n        if (_this2._shadow) {\n          shadow = _this2._shadow.copy();\n\n          var _symbol = lowerSymbolOpacity(shadow._getInternalSymbol(), 0.5);\n\n          shadow.setSymbol(_symbol).addTo(_this2._geometry.getLayer());\n        }\n      },\n      onMove: function onMove(param) {\n        var offset = param['coordOffset'];\n\n        if (shadow) {\n          shadow.translate(offset);\n        } else {\n          _this2._geometry.translate(offset);\n        }\n      },\n      onUp: function onUp() {\n        var geo = shadow || _this2._geometry;\n\n        _this2._update('setCoordinates', Coordinate.toNumberArrays(geo.getCoordinates()));\n\n        if (shadow) {\n          shadow.remove();\n        }\n      }\n    });\n\n    this._addRefreshHook(function () {\n      var center = _this2._geometry.getCenter();\n\n      handle.setContainerPoint(map.coordToContainerPoint(center));\n    });\n  };\n\n  _proto._createHandleInstance = function _createHandleInstance(containerPoint, opts) {\n    var map = this.getMap();\n    var symbol = loadFunctionTypes(opts['symbol'], function () {\n      return [map.getZoom(), {\n        '{bearing}': map.getBearing(),\n        '{pitch}': map.getPitch(),\n        '{zoom}': map.getZoom()\n      }];\n    });\n    var removeVertexOn = this.options['removeVertexOn'];\n    var handle = new EditHandle(this, map, {\n      symbol: symbol,\n      cursor: opts['cursor'],\n      events: removeVertexOn\n    });\n    handle.setContainerPoint(containerPoint);\n    return handle;\n  };\n\n  _proto.createHandle = function createHandle(containerPoint, opts) {\n    if (!opts) {\n      opts = {};\n    }\n\n    var handle = this._createHandleInstance(containerPoint, opts);\n\n    var me = this;\n\n    function onHandleDragstart(param) {\n      this._updating = true;\n\n      if (opts.onDown) {\n        this._geometry.fire('handledragstart');\n\n        opts.onDown.call(me, param['containerPoint'], param);\n      }\n\n      return false;\n    }\n\n    function onHandleDragging(param) {\n      me._hideContext();\n\n      if (opts.onMove) {\n        this._geometry.fire('handledragging');\n\n        opts.onMove.call(me, param);\n      }\n\n      return false;\n    }\n\n    function onHandleDragEnd(ev) {\n      if (opts.onUp) {\n        this._geometry.fire('handledragend');\n\n        opts.onUp.call(me, ev);\n      }\n\n      this._updating = false;\n      return false;\n    }\n\n    handle.on('dragstart', onHandleDragstart, this);\n    handle.on('dragging', onHandleDragging, this);\n    handle.on('dragend', onHandleDragEnd, this);\n\n    if (opts.onRefresh) {\n      handle.refresh = opts.onRefresh;\n    }\n\n    return handle;\n  };\n\n  _proto._createResizeHandles = function _createResizeHandles(blackList, onHandleMove, onHandleUp) {\n    var _this3 = this;\n\n    var cursors = ['nw-resize', 'n-resize', 'ne-resize', 'w-resize', 'e-resize', 'sw-resize', 's-resize', 'se-resize'];\n    var axis = [null, 'y', null, 'x', 'x', null, 'y', null];\n    var geometry = this._geometry;\n    var isMarker = geometry instanceof Marker;\n\n    function getResizeAnchors() {\n      if (isMarker) {\n        var _ext = geometry.getContainerExtent();\n\n        return [new Point(_ext['xmin'], _ext['ymin']), new Point((_ext['xmax'] + _ext['xmin']) / 2, _ext['ymin']), new Point(_ext['xmax'], _ext['ymin']), new Point(_ext['xmin'], (_ext['ymin'] + _ext['ymax']) / 2), new Point(_ext['xmax'], (_ext['ymin'] + _ext['ymax']) / 2), new Point(_ext['xmin'], _ext['ymax']), new Point((_ext['xmax'] + _ext['xmin']) / 2, _ext['ymax']), new Point(_ext['xmax'], _ext['ymax'])];\n      }\n\n      var ext = geometry._getPrjExtent();\n\n      return [new Point(ext['xmin'], ext['ymax']), new Point((ext['xmax'] + ext['xmin']) / 2, ext['ymax']), new Point(ext['xmax'], ext['ymax']), new Point(ext['xmin'], (ext['ymax'] + ext['ymin']) / 2), new Point(ext['xmax'], (ext['ymax'] + ext['ymin']) / 2), new Point(ext['xmin'], ext['ymin']), new Point((ext['xmax'] + ext['xmin']) / 2, ext['ymin']), new Point(ext['xmax'], ext['ymin'])];\n    }\n\n    if (!blackList) {\n      blackList = [];\n    }\n\n    var me = this;\n    var resizeHandles = [],\n        anchorIndexes = {},\n        map = this.getMap(),\n        handleSymbol = this.options['vertexHandleSymbol'];\n\n    var fnLocateHandles = function fnLocateHandles() {\n      var anchors = getResizeAnchors();\n\n      var _loop = function _loop(i) {\n        if (Array.isArray(blackList)) {\n          var isBlack = blackList.some(function (ele) {\n            return ele === i;\n          });\n\n          if (isBlack) {\n            return \"continue\";\n          }\n        }\n\n        var anchor = anchors[i],\n            point = isMarker ? anchor : map._prjToContainerPoint(anchor);\n\n        if (resizeHandles.length < anchors.length - blackList.length) {\n          var handle = _this3.createHandle(point, {\n            'symbol': handleSymbol,\n            'cursor': cursors[i],\n            'axis': axis[i],\n            onMove: function (_index) {\n              return function (e) {\n                me._updating = true;\n                onHandleMove(e.containerPoint, _index);\n                geometry.fire('resizing');\n              };\n            }(i),\n            onUp: function onUp() {\n              me._updating = false;\n              onHandleUp();\n            }\n          });\n\n          anchorIndexes[i] = resizeHandles.length;\n          resizeHandles.push(handle);\n        } else {\n          resizeHandles[anchorIndexes[i]].setContainerPoint(point);\n        }\n      };\n\n      for (var i = 0; i < anchors.length; i++) {\n        var _ret = _loop(i);\n\n        if (_ret === \"continue\") continue;\n      }\n    };\n\n    fnLocateHandles();\n\n    this._addRefreshHook(fnLocateHandles);\n\n    return resizeHandles;\n  };\n\n  _proto.createMarkerEditor = function createMarkerEditor() {\n    var _this4 = this;\n\n    var geometryToEdit = this._shadow || this._geometry,\n        map = this.getMap();\n\n    if (!geometryToEdit._canEdit()) {\n      if (console) {\n        console.warn('A marker can\\'t be resized with symbol:', geometryToEdit.getSymbol());\n      }\n\n      return;\n    }\n\n    if (!this._history) {\n      this._recordHistory(getUpdates());\n    }\n\n    var symbol = geometryToEdit._getInternalSymbol();\n\n    var dxdy = new Point(0, 0);\n\n    if (isNumber(symbol['markerDx'])) {\n      dxdy.x = symbol['markerDx'];\n    }\n\n    if (isNumber(symbol['markerDy'])) {\n      dxdy.y = symbol['markerDy'];\n    }\n\n    var blackList = null;\n    var verticalAnchor = 'middle';\n    var horizontalAnchor = 'middle';\n\n    if (VectorMarkerSymbolizer.test(symbol)) {\n      var type = symbol['markerType'];\n\n      if (type === 'pin' || type === 'pie' || type === 'bar') {\n        blackList = [5, 6, 7];\n        verticalAnchor = 'bottom';\n      } else if (type === 'rectangle') {\n        blackList = [0, 1, 2, 3, 5];\n        verticalAnchor = 'top';\n        horizontalAnchor = 'left';\n      }\n    } else if (ImageMarkerSymbolizer.test(symbol) || VectorPathMarkerSymbolizer.test(symbol)) {\n      verticalAnchor = 'bottom';\n      blackList = [5, 6, 7];\n    }\n\n    var resizeAbilities = [2, 1, 2, 0, 0, 2, 1, 2];\n    var aspectRatio;\n\n    if (this.options['fixAspectRatio']) {\n      var size = geometryToEdit.getSize();\n      aspectRatio = size.width / size.height;\n    }\n\n    var resizeHandles = this._createResizeHandles(blackList, function (containerPoint, i) {\n      if (blackList && blackList.indexOf(i) >= 0) {\n        var newCoordinates = map.containerPointToCoordinate(containerPoint.sub(dxdy));\n        var coordinates = geometryToEdit.getCoordinates();\n        newCoordinates.x = coordinates.x;\n        geometryToEdit.setCoordinates(newCoordinates);\n\n        _this4._updateCoordFromShadow(true);\n\n        var mirrorHandle = resizeHandles[resizeHandles.length - 1 - i];\n        var mirror = mirrorHandle.getContainerPoint();\n        containerPoint = mirror;\n      }\n\n      var viewCenter = map.coordToContainerPoint(geometryToEdit.getCoordinates()).add(dxdy),\n          symbol = geometryToEdit._getInternalSymbol();\n\n      var wh = containerPoint.sub(viewCenter);\n\n      if (verticalAnchor === 'bottom' && containerPoint.y > viewCenter.y) {\n        wh.y = 0;\n      }\n\n      var vr = verticalAnchor === 'middle' ? 2 : 1;\n      var hr = horizontalAnchor === 'left' ? 1 : 2;\n      var width = Math.abs(wh.x) * hr,\n          height = Math.abs(wh.y) * vr;\n\n      if (aspectRatio) {\n        width = Math.max(width, height * aspectRatio);\n        height = width / aspectRatio;\n      }\n\n      var ability = resizeAbilities[i];\n\n      if (!(geometryToEdit instanceof TextBox)) {\n        if (aspectRatio || ability === 0 || ability === 2) {\n          symbol['markerWidth'] = Math.min(width, _this4._geometry.options['maxMarkerWidth'] || Infinity);\n        }\n\n        if (aspectRatio || ability === 1 || ability === 2) {\n          symbol['markerHeight'] = Math.min(height, _this4._geometry.options['maxMarkerHeight'] || Infinity);\n        }\n\n        geometryToEdit.setSymbol(symbol);\n\n        if (geometryToEdit !== _this4._geometry) {\n          _this4._geometry.setSymbol(symbol);\n        }\n      } else {\n        if (aspectRatio || ability === 0 || ability === 2) {\n          geometryToEdit.setWidth(width);\n\n          if (geometryToEdit !== _this4._geometry) {\n            _this4._geometry.setWidth(width);\n          }\n        }\n\n        if (aspectRatio || ability === 1 || ability === 2) {\n          geometryToEdit.setHeight(height);\n\n          if (geometryToEdit !== _this4._geometry) {\n            _this4._geometry.setHeight(height);\n          }\n        }\n      }\n    }, function () {\n      _this4._update(getUpdates());\n    });\n\n    function getUpdates() {\n      var updates = [['setCoordinates', geometryToEdit.getCoordinates().toArray()]];\n\n      if (geometryToEdit instanceof TextBox) {\n        updates.push(['setWidth', geometryToEdit.getWidth()]);\n        updates.push(['setHeight', geometryToEdit.getHeight()]);\n      } else {\n        updates.push(['setSymbol', geometryToEdit.getSymbol()]);\n      }\n\n      return updates;\n    }\n  };\n\n  _proto.createCircleEditor = function createCircleEditor() {\n    var _this5 = this;\n\n    var geo = this._shadow || this._geometry;\n    var map = this.getMap();\n\n    if (!this._history) {\n      this._recordHistory([['setCoordinates', geo.getCoordinates().toArray()], ['setRadius', geo.getRadius()]]);\n    }\n\n    this._createResizeHandles(null, function (handleContainerPoint) {\n      var center = geo.getCenter();\n      var mouseCoordinate = map.containerPointToCoord(handleContainerPoint);\n      var wline = new LineString([[center.x, center.y], [mouseCoordinate.x, center.y]]);\n      var hline = new LineString([[center.x, center.y], [center.x, mouseCoordinate.y]]);\n      var r = Math.max(map.computeGeometryLength(wline), map.computeGeometryLength(hline));\n      geo.setRadius(r);\n\n      if (geo !== _this5._geometry) {\n        _this5._geometry.setRadius(r);\n      }\n    }, function () {\n      _this5._update('setRadius', geo.getRadius());\n    });\n  };\n\n  _proto.createEllipseOrRectEditor = function createEllipseOrRectEditor() {\n    var _this6 = this;\n\n    var resizeAbilities = [2, 1, 2, 0, 0, 2, 1, 2];\n    var geometryToEdit = this._shadow || this._geometry;\n\n    if (!this._history) {\n      this._recordHistory(getUpdates());\n    }\n\n    var map = this.getMap();\n    var isRect = this._geometry instanceof Rectangle;\n    var aspectRatio;\n\n    if (this.options['fixAspectRatio']) {\n      aspectRatio = geometryToEdit.getWidth() / geometryToEdit.getHeight();\n    }\n\n    var resizeHandles = this._createResizeHandles(null, function (mouseContainerPoint, i) {\n      var r = isRect ? 1 : 2;\n      var pointSub, w, h;\n      var handle = resizeHandles[i];\n      var targetPoint = handle.getContainerPoint();\n      var ability = resizeAbilities[i];\n\n      if (isRect) {\n        var mirror = resizeHandles[7 - i];\n        var mirrorContainerPoint = mirror.getContainerPoint();\n        pointSub = targetPoint.sub(mirrorContainerPoint);\n        var absSub = pointSub.abs();\n        w = map.pixelToDistance(absSub.x, 0);\n        h = map.pixelToDistance(0, absSub.y);\n        var size = geometryToEdit.getSize();\n        var geoCoord = geometryToEdit.getCoordinates();\n        var width = geometryToEdit.getWidth();\n        var height = geometryToEdit.getHeight();\n        var mouseCoordinate = map.containerPointToCoord(mouseContainerPoint);\n        var mirrorCoordinate = map.containerPointToCoord(mirrorContainerPoint);\n        var wline = new LineString([[mirrorCoordinate.x, mirrorCoordinate.y], [mouseCoordinate.x, mirrorCoordinate.y]]);\n        var hline = new LineString([[mirrorCoordinate.x, mirrorCoordinate.y], [mirrorCoordinate.x, mouseCoordinate.y]]);\n        w = map.computeGeometryLength(wline);\n        h = map.computeGeometryLength(hline);\n\n        if (ability === 0) {\n          if (aspectRatio) {\n            absSub.y = absSub.x / aspectRatio;\n            size.height = Math.abs(absSub.y);\n            h = w / aspectRatio;\n          }\n\n          targetPoint.y = mirrorContainerPoint.y - size.height / 2;\n          mouseCoordinate.y = geoCoord.y;\n\n          if (i === 4) {\n            mouseCoordinate.x = Math.min(mouseCoordinate.x, geoCoord.x);\n          } else {\n            var mirrorCoord = map.locate(geoCoord, width, 0);\n            mouseCoordinate.x = map.locate(new Coordinate(mirrorCoord.x, mouseCoordinate.y), -w, 0).x;\n          }\n        } else if (ability === 1) {\n          if (aspectRatio) {\n            absSub.x = absSub.y * aspectRatio;\n            size.width = Math.abs(absSub.x);\n            w = h * aspectRatio;\n          }\n\n          targetPoint.x = mirrorContainerPoint.x - size.width / 2;\n          mouseCoordinate.x = geoCoord.x;\n          mouseCoordinate.y = Math.max(mouseCoordinate.y, mirrorCoordinate.y);\n        } else {\n          if (aspectRatio) {\n            if (w > h * aspectRatio) {\n              h = w / aspectRatio;\n              targetPoint.y = mirrorContainerPoint.y + absSub.x * sign(pointSub.y) / aspectRatio;\n            } else {\n              w = h * aspectRatio;\n              targetPoint.x = mirrorContainerPoint.x + absSub.y * sign(pointSub.x) * aspectRatio;\n            }\n          }\n\n          if (i === 0 || i === 5) {\n            var _mirrorCoord = i === 0 ? map.locate(geoCoord, width, 0) : map.locate(geoCoord, width, -height);\n\n            mouseCoordinate.x = map.locate(new Coordinate(_mirrorCoord.x, mouseCoordinate.y), -w, 0).x;\n          } else {\n            mouseCoordinate.x = Math.min(mouseCoordinate.x, mirrorCoordinate.x);\n          }\n\n          mouseCoordinate.y = Math.max(mouseCoordinate.y, mirrorCoordinate.y);\n        }\n\n        geometryToEdit.setCoordinates(mouseCoordinate);\n\n        _this6._updateCoordFromShadow(true);\n      } else {\n        var center = geometryToEdit.getCenter();\n\n        var _mouseCoordinate = map.containerPointToCoord(targetPoint);\n\n        var _wline = new LineString([[center.x, center.y], [_mouseCoordinate.x, center.y]]);\n\n        var _hline = new LineString([[center.x, center.y], [center.x, _mouseCoordinate.y]]);\n\n        w = map.computeGeometryLength(_wline);\n        h = map.computeGeometryLength(_hline);\n\n        if (aspectRatio) {\n          w = Math.max(w, h * aspectRatio);\n          h = w / aspectRatio;\n        }\n      }\n\n      if (aspectRatio || ability === 0 || ability === 2) {\n        geometryToEdit.setWidth(w * r);\n\n        if (geometryToEdit !== _this6._geometry) {\n          _this6._geometry.setWidth(w * r);\n        }\n      }\n\n      if (aspectRatio || ability === 1 || ability === 2) {\n        geometryToEdit.setHeight(h * r);\n\n        if (geometryToEdit !== _this6._geometry) {\n          _this6._geometry.setHeight(h * r);\n        }\n      }\n    }, function () {\n      _this6._update(getUpdates());\n    });\n\n    function getUpdates() {\n      return [['setCoordinates', geometryToEdit.getCoordinates().toArray()], ['setWidth', geometryToEdit.getWidth()], ['setHeight', geometryToEdit.getHeight()]];\n    }\n  };\n\n  _proto.createPolygonEditor = function createPolygonEditor() {\n    var map = this.getMap(),\n        geoToEdit = this._shadow || this._geometry,\n        me = this;\n\n    if (!this._history) {\n      this._recordHistory('setCoordinates', Coordinate.toNumberArrays(geoToEdit.getCoordinates()));\n    }\n\n    var verticeLimit = geoToEdit instanceof Polygon ? 3 : 2;\n    var propertyOfVertexIndex = 'maptalks--editor-vertex-index';\n    var vertexHandles = {\n      0: []\n    },\n        newVertexHandles = {\n      0: []\n    };\n\n    function getVertexCoordinates(ringIndex) {\n      if (ringIndex === void 0) {\n        ringIndex = 0;\n      }\n\n      if (geoToEdit instanceof Polygon) {\n        var coordinates = geoToEdit.getCoordinates()[ringIndex] || [];\n        return coordinates.slice(0, coordinates.length - 1);\n      } else {\n        return geoToEdit.getCoordinates();\n      }\n    }\n\n    function getVertexPrjCoordinates(ringIndex) {\n      if (ringIndex === void 0) {\n        ringIndex = 0;\n      }\n\n      if (ringIndex === 0) {\n        return geoToEdit._getPrjCoordinates();\n      }\n\n      return geoToEdit._getPrjHoles()[ringIndex - 1];\n    }\n\n    function onVertexAddOrRemove() {\n      for (var ringIndex in vertexHandles) {\n        for (var i = vertexHandles[ringIndex].length - 1; i >= 0; i--) {\n          vertexHandles[ringIndex][i][propertyOfVertexIndex] = i;\n        }\n\n        for (var _i = newVertexHandles[ringIndex].length - 1; _i >= 0; _i--) {\n          newVertexHandles[ringIndex][_i][propertyOfVertexIndex] = _i;\n        }\n      }\n\n      me._updateCoordFromShadow();\n    }\n\n    function removeVertex(param) {\n      me._updating = true;\n      var handle = param['target'],\n          index = handle[propertyOfVertexIndex];\n      var ringIndex = isNumber(handle._ringIndex) ? handle._ringIndex : 0;\n      var prjCoordinates = getVertexPrjCoordinates(ringIndex);\n\n      if (prjCoordinates.length <= verticeLimit) {\n        return;\n      }\n\n      var isEnd = geoToEdit instanceof LineString && (index === 0 || index === prjCoordinates.length - 1);\n      prjCoordinates.splice(index, 1);\n\n      if (ringIndex > 0) {\n        geoToEdit._prjHoles[ringIndex - 1] = prjCoordinates;\n      } else {\n        geoToEdit._setPrjCoordinates(prjCoordinates);\n      }\n\n      geoToEdit._updateCache();\n\n      vertexHandles[ringIndex].splice(index, 1)[0].delete();\n\n      if (index < newVertexHandles[ringIndex].length) {\n        newVertexHandles[ringIndex].splice(index, 1)[0].delete();\n      }\n\n      var nextIndex;\n\n      if (index === 0) {\n        nextIndex = newVertexHandles[ringIndex].length - 1;\n      } else {\n        nextIndex = index - 1;\n      }\n\n      newVertexHandles[ringIndex].splice(nextIndex, 1)[0].delete();\n\n      if (!isEnd) {\n        newVertexHandles[ringIndex].splice(nextIndex, 0, createNewVertexHandle.call(me, nextIndex, ringIndex));\n      }\n\n      onVertexAddOrRemove();\n      me._updating = false;\n    }\n\n    function moveVertexHandle(handleConatainerPoint, index, ringIndex) {\n      if (ringIndex === void 0) {\n        ringIndex = 0;\n      }\n\n      var vertice = getVertexPrjCoordinates(ringIndex);\n\n      var nVertex = map._containerPointToPrj(handleConatainerPoint.sub(getDxDy()));\n\n      var pVertex = vertice[index];\n      pVertex.x = nVertex.x;\n      pVertex.y = nVertex.y;\n\n      geoToEdit._updateCache();\n\n      geoToEdit.onShapeChanged();\n\n      me._updateCoordFromShadow(true);\n\n      var nextIndex;\n\n      if (index === 0) {\n        nextIndex = newVertexHandles[ringIndex].length - 1;\n      } else {\n        nextIndex = index - 1;\n      }\n\n      if (newVertexHandles[ringIndex][index]) {\n        newVertexHandles[ringIndex][index].refresh();\n      }\n\n      if (newVertexHandles[ringIndex][nextIndex]) {\n        newVertexHandles[ringIndex][nextIndex].refresh();\n      }\n    }\n\n    var hanldeDxdy = new Point(0, 0);\n\n    function getDxDy() {\n      var compiledSymbol = geoToEdit._getCompiledSymbol();\n\n      hanldeDxdy.x = compiledSymbol.lineDx || 0;\n      hanldeDxdy.y = compiledSymbol.lineDy || 0;\n      return hanldeDxdy;\n    }\n\n    function createVertexHandle(index, ringIndex) {\n      if (ringIndex === void 0) {\n        ringIndex = 0;\n      }\n\n      var vertex = getVertexCoordinates(ringIndex)[index];\n      var handle = me.createHandle(map.coordToContainerPoint(vertex)._add(getDxDy()), {\n        'symbol': me.options['vertexHandleSymbol'],\n        'cursor': 'pointer',\n        'axis': null,\n        onMove: function onMove() {\n          moveVertexHandle(handle.getContainerPoint(), handle[propertyOfVertexIndex], ringIndex);\n        },\n        onRefresh: function onRefresh() {\n          vertex = getVertexCoordinates(ringIndex)[handle[propertyOfVertexIndex]];\n          var containerPoint = map.coordToContainerPoint(vertex);\n          handle.setContainerPoint(containerPoint._add(getDxDy()));\n        },\n        onUp: function onUp() {\n          me._updateCoordFromShadow();\n        },\n        onDown: function onDown(param, e) {\n          if (e && e.domEvent && e.domEvent.button === 2) {\n            return;\n          }\n        }\n      });\n      handle[propertyOfVertexIndex] = index;\n      handle._ringIndex = ringIndex;\n      handle.on(me.options['removeVertexOn'], removeVertex);\n      return handle;\n    }\n\n    var pauseRefresh = false;\n\n    function createNewVertexHandle(index, ringIndex) {\n      if (ringIndex === void 0) {\n        ringIndex = 0;\n      }\n\n      var vertexCoordinates = getVertexCoordinates(ringIndex);\n      var nextVertex;\n\n      if (index + 1 >= vertexCoordinates.length) {\n        nextVertex = vertexCoordinates[0];\n      } else {\n        nextVertex = vertexCoordinates[index + 1];\n      }\n\n      var vertex = vertexCoordinates[index].add(nextVertex).multi(1 / 2);\n      var handle = me.createHandle(vertex, {\n        'symbol': me.options['newVertexHandleSymbol'],\n        'cursor': 'pointer',\n        'axis': null,\n        onDown: function onDown(param, e) {\n          if (e && e.domEvent && e.domEvent.button === 2) {\n            return;\n          }\n\n          var prjCoordinates = getVertexPrjCoordinates(ringIndex);\n          var vertexIndex = handle[propertyOfVertexIndex];\n          var cp = handle.getContainerPoint();\n\n          var pVertex = map._containerPointToPrj(cp);\n\n          prjCoordinates.splice(vertexIndex + 1, 0, pVertex);\n\n          if (ringIndex > 0) {\n            geoToEdit._prjHoles[ringIndex - 1] = prjCoordinates;\n          } else {\n            geoToEdit._setPrjCoordinates(prjCoordinates);\n          }\n\n          geoToEdit._updateCache();\n\n          handle.opacity = 1;\n          newVertexHandles[ringIndex].splice(vertexIndex, 0, createNewVertexHandle.call(me, vertexIndex, ringIndex), createNewVertexHandle.call(me, vertexIndex + 1, ringIndex));\n          pauseRefresh = true;\n        },\n        onMove: function onMove() {\n          moveVertexHandle(handle.getContainerPoint(), handle[propertyOfVertexIndex] + 1, ringIndex);\n        },\n        onUp: function onUp(e) {\n          if (e && e.domEvent && e.domEvent.button === 2) {\n            pauseRefresh = false;\n            return;\n          }\n\n          var vertexIndex = handle[propertyOfVertexIndex];\n          removeFromArray(handle, newVertexHandles[ringIndex]);\n          handle.delete();\n          vertexHandles[ringIndex].splice(vertexIndex + 1, 0, createVertexHandle.call(me, vertexIndex + 1, ringIndex));\n          onVertexAddOrRemove();\n\n          me._updateCoordFromShadow();\n\n          pauseRefresh = false;\n        },\n        onRefresh: function onRefresh(i) {\n          vertexCoordinates = getVertexCoordinates(i);\n          var vertexIndex = handle[propertyOfVertexIndex];\n          var nextIndex;\n\n          if (vertexIndex === vertexCoordinates.length - 1) {\n            nextIndex = 0;\n          } else {\n            nextIndex = vertexIndex + 1;\n          }\n\n          var refreshVertex = vertexCoordinates[vertexIndex].add(vertexCoordinates[nextIndex]).multi(1 / 2);\n          var containerPoint = map.coordToContainerPoint(refreshVertex);\n          handle.setContainerPoint(containerPoint._add(getDxDy()));\n        }\n      });\n      handle[propertyOfVertexIndex] = index;\n      return handle;\n    }\n\n    if (geoToEdit instanceof Polygon) {\n      var rings = geoToEdit.getHoles().length + 1;\n\n      for (var ringIndex = 0; ringIndex < rings; ringIndex++) {\n        vertexHandles[ringIndex] = [];\n        newVertexHandles[ringIndex] = [];\n        var vertexCoordinates = getVertexCoordinates(ringIndex);\n\n        for (var i = 0, len = vertexCoordinates.length; i < len; i++) {\n          vertexHandles[ringIndex].push(createVertexHandle.call(this, i, ringIndex));\n\n          if (i < len - 1) {\n            newVertexHandles[ringIndex].push(createNewVertexHandle.call(this, i, ringIndex));\n          }\n        }\n\n        newVertexHandles[ringIndex].push(createNewVertexHandle.call(this, vertexCoordinates.length - 1, ringIndex));\n      }\n    } else {\n      var _ringIndex = 0;\n\n      var _vertexCoordinates = getVertexCoordinates(_ringIndex);\n\n      for (var _i2 = 0, _len = _vertexCoordinates.length; _i2 < _len; _i2++) {\n        vertexHandles[_ringIndex].push(createVertexHandle.call(this, _i2, _ringIndex));\n\n        if (_i2 < _len - 1) {\n          newVertexHandles[_ringIndex].push(createNewVertexHandle.call(this, _i2, _ringIndex));\n        }\n      }\n    }\n\n    this._addRefreshHook(function () {\n      if (pauseRefresh) {\n        return;\n      }\n\n      for (var _ringIndex2 in newVertexHandles) {\n        for (var _i3 = newVertexHandles[_ringIndex2].length - 1; _i3 >= 0; _i3--) {\n          newVertexHandles[_ringIndex2][_i3].refresh(_ringIndex2);\n        }\n      }\n\n      for (var _ringIndex3 in vertexHandles) {\n        for (var _i4 = vertexHandles[_ringIndex3].length - 1; _i4 >= 0; _i4--) {\n          vertexHandles[_ringIndex3][_i4].refresh(_ringIndex3);\n        }\n      }\n    });\n  };\n\n  _proto._refresh = function _refresh() {\n    if (this._refreshHooks) {\n      for (var i = this._refreshHooks.length - 1; i >= 0; i--) {\n        this._refreshHooks[i].call(this);\n      }\n    }\n  };\n\n  _proto._hideContext = function _hideContext() {\n    if (this._geometry) {\n      this._geometry.closeMenu();\n\n      this._geometry.closeInfoWindow();\n    }\n  };\n\n  _proto._addRefreshHook = function _addRefreshHook(fn) {\n    if (!fn) {\n      return;\n    }\n\n    if (!this._refreshHooks) {\n      this._refreshHooks = [];\n    }\n\n    this._refreshHooks.push(fn);\n  };\n\n  _proto._update = function _update(method) {\n    for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key = 1; _key < _len2; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    this._exeHistory([method, args]);\n\n    this._recordHistory.apply(this, [method].concat(args));\n  };\n\n  _proto._updateCoordFromShadow = function _updateCoordFromShadow(ignoreRecord) {\n    var geoToEdit = this._shadow || this._geometry;\n    var coords = geoToEdit.getCoordinates();\n    var geo = this._geometry;\n    var updating = this._updating;\n    this._updating = true;\n    geo.setCoordinates(coords);\n\n    if (!ignoreRecord) {\n      this._recordHistory('setCoordinates', Coordinate.toNumberArrays(geo.getCoordinates()));\n    }\n\n    this._updating = updating;\n  };\n\n  _proto._recordHistory = function _recordHistory(method) {\n    if (!this._history) {\n      this._history = [];\n      this._historyPointer = 0;\n    }\n\n    for (var _len3 = arguments.length, args = new Array(_len3 > 1 ? _len3 - 1 : 0), _key2 = 1; _key2 < _len3; _key2++) {\n      args[_key2 - 1] = arguments[_key2];\n    }\n\n    if (this._history.length) {\n      var lastOperation = this._history[this._history.length - 1];\n\n      if (lastOperation[0] === method && JSON.stringify(lastOperation[1]) === JSON.stringify(args)) {\n        return;\n      }\n    }\n\n    if (this._historyPointer < this._history.length - 1) {\n      this._history.splice(this._historyPointer + 1);\n    }\n\n    this._history.push([method, args]);\n\n    this._historyPointer = this._history.length - 1;\n\n    this._geometry.fire('editrecord');\n  };\n\n  _proto.cancel = function cancel() {\n    if (!this._history || this._historyPointer === 0) {\n      return this;\n    }\n\n    this._historyPointer = 0;\n    var record = this._history[0];\n\n    this._exeAndReset(record);\n\n    return this;\n  };\n\n  _proto.undo = function undo() {\n    if (!this._history || this._historyPointer === 0) {\n      return this;\n    }\n\n    var record = this._history[--this._historyPointer];\n\n    this._exeAndReset(record);\n\n    return this;\n  };\n\n  _proto.redo = function redo() {\n    if (!this._history || this._historyPointer === this._history.length - 1) {\n      return this;\n    }\n\n    var record = this._history[++this._historyPointer];\n\n    this._exeAndReset(record);\n\n    return this;\n  };\n\n  _proto._exeAndReset = function _exeAndReset(record) {\n    if (this._updating) {\n      return;\n    }\n\n    this._exeHistory(record);\n\n    var history = this._history,\n        pointer = this._historyPointer;\n    this.stop();\n    this._history = history;\n    this._historyPointer = pointer;\n    this.start();\n  };\n\n  _proto._onDragStart = function _onDragStart() {\n    this._updating = true;\n  };\n\n  _proto._onDragEnd = function _onDragEnd() {\n    this._updating = false;\n  };\n\n  _proto._exeHistory = function _exeHistory(record) {\n    if (!Array.isArray(record)) {\n      return;\n    }\n\n    var updating = this._updating;\n    this._updating = true;\n    var geoToEdit = this._shadow || this._geometry;\n    var geo = this._geometry;\n\n    if (Array.isArray(record[0])) {\n      record[0].forEach(function (o) {\n        var m = o[0],\n            args = o.slice(1);\n        geoToEdit[m].apply(geoToEdit, args);\n\n        if (geoToEdit !== geo) {\n          geo[m].apply(geo, args);\n        }\n      });\n    } else {\n      geoToEdit[record[0]].apply(geoToEdit, record[1]);\n\n      if (geoToEdit !== geo) {\n        geo[record[0]].apply(geo, record[1]);\n      }\n    }\n\n    this._updating = updating;\n  };\n\n  return GeometryEditor;\n}(Eventable(Class));\n\nGeometryEditor.mergeOptions(options$A);\n\nvar TextEditable = {\n  startEditText: function startEditText() {\n    if (!this.getMap()) {\n      return this;\n    }\n\n    this.hide();\n    this.endEditText();\n\n    this._prepareEditor();\n\n    this._fireEvent('edittextstart');\n\n    return this;\n  },\n  endEditText: function endEditText() {\n    if (this._textEditor) {\n      var html = this._textEditor.innerHTML;\n      html = html.replace(/<p>/ig, '').replace(/<\\/p>/ig, '<br/>');\n      this._textEditor.innerHTML = html;\n\n      var content = this._textEditor.innerText.replace(/[\\r\\n]+$/gi, '');\n\n      this.setContent(content);\n      off(this._textEditor, 'mousedown dblclick', stopPropagation);\n      this.getMap().off('mousedown', this.endEditText, this);\n\n      this._editUIMarker.remove();\n\n      delete this._editUIMarker;\n      this._textEditor.onkeyup = null;\n      delete this._textEditor;\n      this.show();\n\n      this._fireEvent('edittextend');\n    }\n\n    return this;\n  },\n  isEditingText: function isEditingText() {\n    if (this._textEditor) {\n      return true;\n    }\n\n    return false;\n  },\n  getTextEditor: function getTextEditor() {\n    return this._editUIMarker;\n  },\n  _prepareEditor: function _prepareEditor() {\n    var map = this.getMap();\n\n    var editContainer = this._createEditor();\n\n    this._textEditor = editContainer;\n    map.on('mousedown', this.endEditText, this);\n\n    var offset = this._getEditorOffset();\n\n    this._editUIMarker = new UIMarker(this.getCoordinates(), {\n      'animation': null,\n      'content': editContainer,\n      'dx': offset.dx,\n      'dy': offset.dy\n    }).addTo(map);\n\n    this._setCursorToLast(this._textEditor);\n  },\n  _getEditorOffset: function _getEditorOffset() {\n    var symbol = this._getInternalSymbol() || {};\n    var dx = 0,\n        dy = 0;\n    var textAlign = symbol['textHorizontalAlignment'];\n\n    if (textAlign === 'middle' || isNil(textAlign)) {\n      dx = (symbol['textDx'] || 0) - 2;\n      dy = (symbol['textDy'] || 0) - 2;\n    } else {\n      dx = (symbol['markerDx'] || 0) - 2;\n      dy = (symbol['markerDy'] || 0) - 2;\n    }\n\n    return {\n      'dx': dx,\n      'dy': dy\n    };\n  },\n  _createEditor: function _createEditor() {\n    var content = this.getContent();\n    var labelSize = this.getSize(),\n        symbol = this._getInternalSymbol() || {},\n        width = labelSize.width,\n        textColor = symbol['textFill'] || '#000000',\n        textSize = symbol['textSize'] || 12,\n        height = labelSize.height,\n        lineColor = symbol['markerLineColor'] || '#000',\n        fill = symbol['markerFill'] || '#3398CC',\n        spacing = symbol['textLineSpacing'] || 0;\n    var editor = createEl('div');\n    editor.contentEditable = true;\n    editor.style.cssText = \"background:\" + fill + \"; border:1px solid \" + lineColor + \";\\n            color:\" + textColor + \";font-size:\" + textSize + \"px;width:\" + (width - 2) + \"px;height:\" + (height - 2) + \"px;margin: auto;\\n            line-height:\" + (textSize + spacing) + \"px;outline: 0; padding:0; margin:0;word-wrap: break-word;\\n            overflow: hidden;-webkit-user-modify: read-write-plaintext-only;\";\n    editor.innerText = content;\n    on(editor, 'mousedown dblclick', stopPropagation);\n\n    editor.onkeyup = function (event) {\n      var h = editor.style.height || 0;\n\n      if (event.keyCode === 13) {\n        editor.style.height = parseInt(h) + textSize / 2 + 'px';\n      }\n    };\n\n    return editor;\n  },\n  _setCursorToLast: function _setCursorToLast(obj) {\n    var range;\n\n    if (window.getSelection) {\n      obj.focus();\n      range = window.getSelection();\n      range.selectAllChildren(obj);\n      range.collapseToEnd();\n    } else if (document.selection) {\n      range = document.selection.createRange();\n      range.moveToElementText(obj);\n      range.collapse(false);\n      range.select();\n    }\n  }\n};\nTextMarker.include(TextEditable);\n\nGeometry.include({\n  animate: function animate(styles, options, step) {\n    var _this = this;\n\n    if (this._animPlayer) {\n      this._animPlayer.finish();\n    }\n\n    if (isFunction(options)) {\n      step = options;\n    }\n\n    if (!options) {\n      options = {};\n    }\n\n    var map = this.getMap(),\n        projection = this._getProjection(),\n        stylesToAnimate = this._prepareAnimationStyles(styles);\n\n    var preTranslate;\n    var isFocusing = options['focus'];\n    delete this._animationStarted;\n\n    if (map) {\n      var renderer = map._getRenderer();\n\n      var framer = function framer(fn) {\n        renderer.callInNextFrame(fn);\n      };\n\n      options['framer'] = framer;\n    }\n\n    var player = Animation.animate(stylesToAnimate, options, function (frame) {\n      if (map && map.isRemoved()) {\n        player.finish();\n        return;\n      }\n\n      if (map && !_this._animationStarted && isFocusing) {\n        map.onMoveStart();\n      }\n\n      var styles = frame.styles;\n\n      for (var p in styles) {\n        if (p !== 'symbol' && p !== 'translate' && styles.hasOwnProperty(p)) {\n          var fnName = 'set' + p[0].toUpperCase() + p.slice(1);\n\n          _this[fnName](styles[p]);\n        }\n      }\n\n      var translate = styles['translate'];\n\n      if (translate) {\n        var toTranslate = translate;\n\n        if (preTranslate) {\n          toTranslate = translate.sub(preTranslate);\n        }\n\n        preTranslate = translate;\n\n        _this.translate(toTranslate);\n      }\n\n      var dSymbol = styles['symbol'];\n\n      if (dSymbol) {\n        var symbol = _this.getSymbol() || {};\n\n        _this.setSymbol(extendSymbol(symbol, dSymbol));\n      }\n\n      if (map && isFocusing) {\n        var pcenter = projection.project(_this.getCenter());\n\n        map._setPrjCenter(pcenter);\n\n        var e = map._parseEventFromCoord(projection.unproject(pcenter));\n\n        if (player.playState !== 'running') {\n          map.onMoveEnd(e);\n        } else {\n          map.onMoving(e);\n        }\n      }\n\n      _this._fireAnimateEvent(player.playState);\n\n      if (step) {\n        step(frame);\n      }\n    }, this);\n    this._animPlayer = player;\n    return this._animPlayer.play();\n  },\n  _prepareAnimationStyles: function _prepareAnimationStyles(styles) {\n    var symbol = this._getInternalSymbol();\n\n    var stylesToAnimate = {};\n\n    for (var p in styles) {\n      if (styles.hasOwnProperty(p)) {\n        var v = styles[p];\n\n        if (p !== 'translate' && p !== 'symbol') {\n          var fnName = 'get' + p[0].toUpperCase() + p.substring(1);\n          var current = this[fnName]();\n          stylesToAnimate[p] = [current, v];\n        } else if (p === 'symbol') {\n          var symbolToAnimate = void 0;\n\n          if (Array.isArray(styles['symbol'])) {\n            if (!Array.isArray(symbol)) {\n              throw new Error('geometry\\'symbol isn\\'t a composite symbol, while the symbol in styles is.');\n            }\n\n            symbolToAnimate = [];\n            var symbolInStyles = styles['symbol'];\n\n            for (var i = 0; i < symbolInStyles.length; i++) {\n              if (!symbolInStyles[i]) {\n                symbolToAnimate.push(null);\n                continue;\n              }\n\n              var a = {};\n\n              for (var sp in symbolInStyles[i]) {\n                if (symbolInStyles[i].hasOwnProperty(sp)) {\n                  a[sp] = [symbol[i][sp], symbolInStyles[i][sp]];\n                }\n              }\n\n              symbolToAnimate.push(a);\n            }\n          } else {\n            if (Array.isArray(symbol)) {\n              throw new Error('geometry\\'symbol is a composite symbol, while the symbol in styles isn\\'t.');\n            }\n\n            symbolToAnimate = {};\n\n            for (var _sp in v) {\n              if (v.hasOwnProperty(_sp)) {\n                symbolToAnimate[_sp] = [symbol[_sp], v[_sp]];\n              }\n            }\n          }\n\n          stylesToAnimate['symbol'] = symbolToAnimate;\n        } else if (p === 'translate') {\n          stylesToAnimate['translate'] = new Coordinate(v);\n        }\n      }\n    }\n\n    return stylesToAnimate;\n  },\n  _fireAnimateEvent: function _fireAnimateEvent(playState) {\n    if (playState === 'finished') {\n      delete this._animationStarted;\n\n      this._fireEvent('animateend');\n    } else if (playState === 'running') {\n      if (this._animationStarted) {\n        this._fireEvent('animating');\n      } else {\n        this._fireEvent('animatestart');\n\n        this._animationStarted = true;\n      }\n    }\n  }\n});\n\nvar DRAG_STAGE_LAYER_ID = INTERNAL_LAYER_PREFIX + '_drag_stage';\nvar EVENTS$2 = Browser$1.touch ? 'touchstart mousedown' : 'mousedown';\n\nvar GeometryDragHandler = function (_Handler) {\n  _inheritsLoose(GeometryDragHandler, _Handler);\n\n  function GeometryDragHandler(target) {\n    return _Handler.call(this, target) || this;\n  }\n\n  var _proto = GeometryDragHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    this.target.on(EVENTS$2, this._startDrag, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    this._endDrag();\n\n    this.target.off(EVENTS$2, this._startDrag, this);\n    delete this.container;\n  };\n\n  _proto._prepareDragHandler = function _prepareDragHandler() {\n    this._dragHandler = new DragHandler(this.container);\n\n    this._dragHandler.on('dragging', this._dragging, this).on('mouseup', this._endDrag, this).enable();\n  };\n\n  _proto._prepareShadow = function _prepareShadow() {\n    var _this = this;\n\n    var target = this.target;\n    var needShadow = target.getLayer().options['renderer'] === 'canvas';\n\n    if (!needShadow) {\n      return;\n    }\n\n    this._prepareDragStageLayer();\n\n    if (this._shadow) {\n      this._shadow.remove();\n    }\n\n    var shadow = this._shadow = target.copy();\n\n    if (shadow.getGeometries) {\n      var shadows = shadow.getGeometries();\n      var geos = target.getGeometries();\n      shadows.forEach(function (g, i) {\n        _this._updateShadowSymbol(g, geos[i]);\n      });\n    } else {\n      this._updateShadowSymbol(shadow, target);\n    }\n\n    shadow.setId(null);\n\n    this._prepareShadowConnectors();\n  };\n\n  _proto._updateShadowSymbol = function _updateShadowSymbol(shadow, target) {\n    shadow.setSymbol(target._getInternalSymbol());\n\n    if (target.options['dragShadow']) {\n      var symbol = lowerSymbolOpacity(shadow._getInternalSymbol(), 0.5);\n      shadow.setSymbol(symbol);\n    }\n  };\n\n  _proto._prepareShadowConnectors = function _prepareShadowConnectors() {\n    var target = this.target;\n    var shadow = this._shadow;\n\n    var resources = this._dragStageLayer._getRenderer().resources;\n\n    var shadowConnectors = [];\n\n    if (ConnectorLine._hasConnectors(target)) {\n      var connectors = ConnectorLine._getConnectors(target);\n\n      for (var i = 0, l = connectors.length; i < l; i++) {\n        var targetConn = connectors[i];\n\n        var connOptions = targetConn.config(),\n            connSymbol = targetConn._getInternalSymbol();\n\n        connOptions['symbol'] = lowerSymbolOpacity(connSymbol, 0.5);\n        var conn = void 0;\n\n        if (targetConn.getConnectSource() === target) {\n          conn = new targetConn.constructor(shadow, targetConn.getConnectTarget(), connOptions);\n        } else {\n          conn = new targetConn.constructor(targetConn.getConnectSource(), shadow, connOptions);\n        }\n\n        shadowConnectors.push(conn);\n\n        if (targetConn.getLayer() && targetConn.getLayer()._getRenderer()) {\n          resources.merge(targetConn.getLayer()._getRenderer().resources);\n        }\n      }\n    }\n\n    this._shadowConnectors = shadowConnectors;\n    shadowConnectors.push(shadow);\n\n    this._dragStageLayer.bringToFront().addGeometry(shadowConnectors);\n  };\n\n  _proto._onTargetUpdated = function _onTargetUpdated() {\n    if (this._shadow) {\n      this._shadow.setSymbol(this.target._getSymbol());\n    }\n  };\n\n  _proto._prepareDragStageLayer = function _prepareDragStageLayer() {\n    var map = this.target.getMap(),\n        layer = this.target.getLayer();\n    this._dragStageLayer = map.getLayer(DRAG_STAGE_LAYER_ID);\n\n    if (!this._dragStageLayer) {\n      this._dragStageLayer = new VectorLayer(DRAG_STAGE_LAYER_ID, {\n        enableAltitude: layer.options['enableAltitude'],\n        altitudeProperty: layer.options['altitudeProperty']\n      });\n      map.addLayer(this._dragStageLayer);\n    }\n\n    var resources = new ResourceCache();\n    resources.merge(layer._getRenderer().resources);\n    this._dragStageLayer._getRenderer().resources = resources;\n  };\n\n  _proto._startDrag = function _startDrag(param) {\n    var map = this.target.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    var parent = this.target._getParent();\n\n    if (parent) {\n      return;\n    }\n\n    if (this.isDragging()) {\n      return;\n    }\n\n    var domEvent = param['domEvent'];\n\n    if (domEvent.touches && domEvent.touches.length > 1 || domEvent.button === 2) {\n      return;\n    }\n\n    this.container = map._panels.mapWrapper || map._containerDOM;\n    this.target.on('click', this._endDrag, this);\n    this._lastCoord = this._correctCoord(param['coordinate']);\n    this._lastPoint = param['containerPoint'];\n\n    this._prepareDragHandler();\n\n    this._dragHandler.onMouseDown(param['domEvent']);\n\n    on(this.container, 'mouseleave', this._endDrag, this);\n    this._startParam = param;\n    this._moved = false;\n    return;\n  };\n\n  _proto._dragging = function _dragging(param) {\n    var target = this.target;\n\n    var map = target.getMap(),\n        e = map._parseEvent(param['domEvent']);\n\n    var domEvent = e['domEvent'];\n\n    if (domEvent.touches && domEvent.touches.length > 1) {\n      return;\n    }\n\n    if (!this._moved) {\n      this._moved = true;\n      target.on('symbolchange', this._onTargetUpdated, this);\n      this._isDragging = true;\n\n      this._prepareShadow();\n\n      if (this._shadow) {\n        if (!target.options['dragShadow']) {\n          target.hide();\n        }\n\n        this._shadow._fireEvent('dragstart', e);\n      }\n\n      this.target._fireEvent('dragstart', this._startParam || e);\n\n      delete this._startParam;\n      return;\n    }\n\n    var geo = this._shadow || target;\n    var axis = geo.options['dragOnAxis'],\n        dragOnScreenAxis = geo.options['dragOnScreenAxis'],\n        point = e['containerPoint'];\n    var coord = e['coordinate'];\n    this._lastPoint = this._lastPoint || point;\n    this._lastCoord = this._lastCoord || coord;\n\n    if (dragOnScreenAxis) {\n      if (axis === 'x') {\n        point.y = this._lastPoint.y;\n      } else if (axis === 'y') {\n        point.x = this._lastPoint.x;\n      }\n\n      coord = map.containerPointToCoord(point);\n    } else {\n      coord = this._correctCoord(coord);\n    }\n\n    var pointOffset = point.sub(this._lastPoint);\n    var coordOffset = coord.sub(this._lastCoord);\n\n    if (!dragOnScreenAxis) {\n      if (axis === 'x') {\n        pointOffset.y = coordOffset.y = 0;\n      } else if (axis === 'y') {\n        pointOffset.x = coordOffset.x = 0;\n      }\n    }\n\n    this._lastPoint = point;\n    this._lastCoord = coord;\n    geo.translate(coordOffset);\n\n    if (geo !== target && !target.options['dragShadow']) {\n      target.translate(coordOffset);\n    }\n\n    e['coordOffset'] = coordOffset;\n    e['pointOffset'] = pointOffset;\n\n    geo._fireEvent('dragging', e);\n\n    if (geo !== target) {\n      target._fireEvent('dragging', e);\n    }\n  };\n\n  _proto._endDrag = function _endDrag(param) {\n    if (this._dragHandler) {\n      this._dragHandler.disable();\n\n      delete this._dragHandler;\n    }\n\n    if (this.container) {\n      off(this.container, 'mouseleave', this._endDrag, this);\n    }\n\n    if (!this.target) {\n      return;\n    }\n\n    var target = this.target;\n    target.off('click', this._endDrag, this);\n    target.off('symbolchange', this._onTargetUpdated, this);\n    delete this._lastCoord;\n    delete this._lastPoint;\n    this._isDragging = false;\n    var map = target.getMap();\n\n    if (this.enabled() && map) {\n      var e = map._parseEvent(param ? param['domEvent'] : null);\n\n      this._updateTargetAndRemoveShadow(e);\n\n      if (this._moved) {\n        target._fireEvent('dragend', e);\n      }\n    }\n  };\n\n  _proto.isDragging = function isDragging() {\n    if (!this._isDragging) {\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto._updateTargetAndRemoveShadow = function _updateTargetAndRemoveShadow(eventParam) {\n    if (!this._shadow) {\n      return;\n    }\n\n    var target = this.target,\n        map = target.getMap();\n\n    if (!target.options['dragShadow']) {\n      target.show();\n    }\n\n    var shadow = this._shadow;\n\n    if (shadow) {\n      if (target.options['dragShadow']) {\n        if (target.getGeometries) {\n          var shadows = shadow.getGeometries();\n          var geos = target.getGeometries();\n          shadows.forEach(function (g, i) {\n            geos[i].setCoordinates(shadows[i].getCoordinates());\n          });\n        } else {\n          target.setCoordinates(shadow.getCoordinates());\n        }\n      }\n\n      shadow._fireEvent('dragend', eventParam);\n\n      shadow.remove();\n      delete this._shadow;\n    }\n\n    if (this._shadowConnectors) {\n      map.getLayer(DRAG_STAGE_LAYER_ID).removeGeometry(this._shadowConnectors);\n      delete this._shadowConnectors;\n    }\n\n    if (this._dragStageLayer) {\n      this._dragStageLayer._getRenderer().resources = new ResourceCache();\n\n      this._dragStageLayer.remove();\n    }\n  };\n\n  _proto._correctCoord = function _correctCoord(coord) {\n    var map = this.target.getMap();\n\n    if (!map.getPitch()) {\n      return coord;\n    }\n\n    var target = this.target;\n\n    if (!target.getMinAltitude()) {\n      return coord;\n    }\n\n    var alt = (target.getMinAltitude() + target.getMaxAltitude()) / 2;\n    return map.locateByPoint(coord, 0, -alt);\n  };\n\n  return GeometryDragHandler;\n}(Handler$1);\n\nGeometry.mergeOptions({\n  'draggable': false,\n  'dragShadow': true,\n  'dragOnAxis': null,\n  'dragOnScreenAxis': false\n});\nGeometry.addInitHook('addHandler', 'draggable', GeometryDragHandler);\nGeometry.include({\n  isDragging: function isDragging() {\n    if (this._getParent()) {\n      return this._getParent().isDragging();\n    }\n\n    if (this['draggable']) {\n      return this['draggable'].isDragging();\n    }\n\n    return false;\n  }\n});\n\nGeometry.include({\n  startEdit: function startEdit(opts) {\n    if (!this.getMap() || !this.options['editable']) {\n      return this;\n    }\n\n    this.endEdit();\n    this._editor = new GeometryEditor(this, opts);\n\n    this._editor.start();\n\n    this.fire('editstart');\n    return this;\n  },\n  endEdit: function endEdit() {\n    if (this._editor) {\n      this._editor.stop();\n\n      delete this._editor;\n      this.fire('editend');\n    }\n\n    return this;\n  },\n  redoEdit: function redoEdit() {\n    if (!this.isEditing()) {\n      return this;\n    }\n\n    this._editor.redo();\n\n    this.fire('redoedit');\n    return this;\n  },\n  undoEdit: function undoEdit() {\n    if (!this.isEditing()) {\n      return this;\n    }\n\n    this._editor.undo();\n\n    this.fire('undoedit');\n    return this;\n  },\n  cancelEdit: function cancelEdit() {\n    if (!this.isEditing()) {\n      return this;\n    }\n\n    this._editor.cancel();\n\n    this.fire('canceledit');\n    return this;\n  },\n  isEditing: function isEditing() {\n    if (this._editor) {\n      return this._editor.isEditing();\n    }\n\n    return false;\n  }\n});\n\nGeometry.include({\n  _onEvent: function _onEvent(event, type) {\n    if (!this.getMap()) {\n      return;\n    }\n\n    var eventType = type || this._getEventTypeToFire(event);\n\n    if (eventType === 'contextmenu' && this.listens('contextmenu')) {\n      stopPropagation(event);\n      preventDefault(event);\n    }\n\n    var params = this._getEventParams(event);\n\n    this._fireEvent(eventType, params);\n  },\n  _getEventTypeToFire: function _getEventTypeToFire(domEvent) {\n    return domEvent.type;\n  },\n  _getEventParams: function _getEventParams(e) {\n    var map = this.getMap();\n    var eventParam = {\n      'domEvent': e\n    };\n    var actual = e.touches && e.touches.length > 0 ? e.touches[0] : e.changedTouches && e.changedTouches.length > 0 ? e.changedTouches[0] : e;\n\n    if (actual) {\n      var containerPoint = getEventContainerPoint(actual, map._containerDOM);\n      eventParam['coordinate'] = map.containerPointToCoordinate(containerPoint);\n      eventParam['containerPoint'] = containerPoint;\n      eventParam['viewPoint'] = map.containerPointToViewPoint(containerPoint);\n      eventParam['pont2d'] = map._containerPointToPoint(containerPoint);\n    }\n\n    return eventParam;\n  }\n});\n\nGeometry.include({\n  setInfoWindow: function setInfoWindow(options) {\n    this.removeInfoWindow();\n\n    if (options instanceof InfoWindow) {\n      this._infoWindow = options;\n      this._infoWinOptions = extend({}, this._infoWindow.options);\n\n      this._infoWindow.addTo(this);\n\n      return this;\n    }\n\n    this._infoWinOptions = extend({}, options);\n\n    if (this._infoWindow) {\n      this._infoWindow.setOptions(options);\n    } else if (this.getMap()) {\n      this._bindInfoWindow();\n    }\n\n    return this;\n  },\n  getInfoWindow: function getInfoWindow() {\n    if (!this._infoWindow) {\n      return null;\n    }\n\n    return this._infoWindow;\n  },\n  openInfoWindow: function openInfoWindow(coordinate) {\n    if (!this.getMap()) {\n      return this;\n    }\n\n    if (!coordinate) {\n      coordinate = this.getCenter();\n    }\n\n    if (!this._infoWindow) {\n      if (this._infoWinOptions && this.getMap()) {\n        this._bindInfoWindow();\n\n        this._infoWindow.show(coordinate);\n      }\n    } else {\n      this._infoWindow.show(coordinate);\n    }\n\n    return this;\n  },\n  closeInfoWindow: function closeInfoWindow() {\n    if (this._infoWindow) {\n      this._infoWindow.hide();\n    }\n\n    return this;\n  },\n  removeInfoWindow: function removeInfoWindow() {\n    this._unbindInfoWindow();\n\n    delete this._infoWinOptions;\n    delete this._infoWindow;\n    return this;\n  },\n  _bindInfoWindow: function _bindInfoWindow() {\n    var options = this._infoWinOptions;\n\n    if (!options) {\n      return this;\n    }\n\n    this._infoWindow = new InfoWindow(options);\n\n    this._infoWindow.addTo(this);\n\n    return this;\n  },\n  _unbindInfoWindow: function _unbindInfoWindow() {\n    if (this._infoWindow) {\n      this.closeInfoWindow();\n\n      this._infoWindow.remove();\n\n      delete this._infoWindow;\n    }\n\n    return this;\n  }\n});\n\nvar TILE_POINT = new Point(0, 0);\nvar TEMP_POINT$3 = new Point(0, 0);\nvar TEMP_POINT1$2 = new Point(0, 0);\nvar TEMP_POINT2$2 = new Point(0, 0);\nvar EMPTY_ARRAY$2 = [];\n\nvar TileWorkerConnection = function (_Actor) {\n  _inheritsLoose(TileWorkerConnection, _Actor);\n\n  function TileWorkerConnection() {\n    return _Actor.call(this, imageFetchWorkerKey) || this;\n  }\n\n  var _proto = TileWorkerConnection.prototype;\n\n  _proto.checkUrl = function checkUrl(url) {\n    if (!url || !isString(url)) {\n      return url;\n    }\n\n    return getAbsoluteURL(url);\n  };\n\n  _proto.fetchImage = function fetchImage(url, workerId, cb, fetchOptions) {\n    url = this.checkUrl(url);\n    var data = {\n      url: url,\n      fetchOptions: fetchOptions\n    };\n    this.send(data, EMPTY_ARRAY$2, cb, workerId);\n  };\n\n  return TileWorkerConnection;\n}(Actor);\n\nvar BLANK_IMAGE = new Image();\n\nvar TileLayerCanvasRenderer = function (_CanvasRenderer) {\n  _inheritsLoose(TileLayerCanvasRenderer, _CanvasRenderer);\n\n  function TileLayerCanvasRenderer(layer) {\n    var _this;\n\n    _this = _CanvasRenderer.call(this, layer) || this;\n    _this.tilesInView = {};\n    _this.tilesLoading = {};\n    _this._parentTiles = [];\n    _this._childTiles = [];\n    _this.tileCache = new LRUCache(layer.options['maxCacheSize'], _this.deleteTile.bind(_assertThisInitialized(_assertThisInitialized(_this))));\n\n    if (Browser$1.decodeImageInWorker && _this.layer.options['decodeImageInWorker']) {\n      _this._tileImageWorkerConn = new TileWorkerConnection();\n    }\n\n    return _this;\n  }\n\n  var _proto2 = TileLayerCanvasRenderer.prototype;\n\n  _proto2.getCurrentTileZoom = function getCurrentTileZoom() {\n    return this._tileZoom;\n  };\n\n  _proto2.draw = function draw() {\n    var map = this.getMap();\n\n    if (!this.isDrawable()) {\n      return;\n    }\n\n    var mask2DExtent = this.prepareCanvas();\n\n    if (mask2DExtent) {\n      if (!mask2DExtent.intersects(this.canvasExtent2D)) {\n        this.completeRender();\n        return;\n      }\n    }\n\n    var layer = this.layer;\n    var tileGrids = layer.getTiles().tileGrids;\n\n    if (!tileGrids || !tileGrids.length) {\n      this.completeRender();\n      return;\n    }\n\n    var count = tileGrids.reduce(function (acc, curr) {\n      return acc + (curr && curr.tiles && curr.tiles.length || 0);\n    }, 0);\n\n    if (count >= this.tileCache.max / 2) {\n      this.tileCache.setMaxSize(count * 2 + 1);\n    }\n\n    var loadingCount = 0;\n    var loading = false;\n    var checkedTiles = {};\n    var tiles = [],\n        parentTiles = [],\n        parentKeys = {},\n        childTiles = [],\n        childKeys = {},\n        placeholders = [],\n        placeholderKeys = {};\n    var tileQueue = {};\n\n    var preLoadingCount = this._markTiles(),\n        loadingLimit = this._getLoadLimit();\n\n    var l = tileGrids.length;\n    this._tileZoom = tileGrids[0]['zoom'];\n\n    for (var i = 0; i < l; i++) {\n      var tileGrid = tileGrids[i];\n      var allTiles = tileGrid['tiles'];\n\n      var placeholder = this._generatePlaceHolder(tileGrid.zoom);\n\n      for (var _i = 0, _l = allTiles.length; _i < _l; _i++) {\n        var tile = allTiles[_i],\n            tileId = tile['id'];\n        var tileLoading = false;\n\n        if (this._isLoadingTile(tileId)) {\n          tileLoading = loading = true;\n          this.tilesLoading[tileId].current = true;\n        } else {\n          var cached = this._getCachedTile(tileId);\n\n          if (cached) {\n            if (cached.image && this.getTileOpacity(cached.image) < 1) {\n              tileLoading = loading = true;\n            }\n\n            tiles.push(cached);\n          } else {\n            tileLoading = loading = true;\n            var hitLimit = loadingLimit && loadingCount + preLoadingCount[0] > loadingLimit;\n\n            if (!hitLimit && (!map.isInteracting() || map.isMoving() || map.isRotating())) {\n              loadingCount++;\n              var key = tileId;\n              tileQueue[key] = tile;\n            }\n          }\n        }\n\n        if (!tileLoading) continue;\n\n        if (checkedTiles[tileId]) {\n          continue;\n        }\n\n        checkedTiles[tileId] = 1;\n\n        if (placeholder && !placeholderKeys[tileId]) {\n          tile.cache = false;\n          placeholders.push({\n            image: placeholder,\n            info: tile\n          });\n          placeholderKeys[tileId] = 1;\n        }\n\n        var parentTile = this._findParentTile(tile);\n\n        if (parentTile) {\n          var parentId = parentTile.info.id;\n\n          if (parentKeys[parentId] === undefined) {\n            parentKeys[parentId] = parentTiles.length;\n            parentTiles.push(parentTile);\n          }\n        } else if (!parentTiles.length) {\n          var children = this._findChildTiles(tile);\n\n          if (children.length) {\n            children.forEach(function (c) {\n              if (!childKeys[c.info.id]) {\n                childTiles.push(c);\n                childKeys[c.info.id] = 1;\n              }\n            });\n          }\n        }\n      }\n    }\n\n    if (parentTiles.length) {\n      childTiles.length = 0;\n      this._childTiles.length = 0;\n    }\n\n    this._drawTiles(tiles, parentTiles, childTiles, placeholders);\n\n    if (!loadingCount) {\n      if (!loading) {\n        if (!map.isAnimating() && (this._parentTiles.length || this._childTiles.length)) {\n          this._parentTiles = [];\n          this._childTiles = [];\n          this.setToRedraw();\n        }\n\n        this.completeRender();\n      }\n    } else {\n      this.loadTileQueue(tileQueue);\n    }\n\n    this._retireTiles();\n  };\n\n  _proto2.isTileCachedOrLoading = function isTileCachedOrLoading(tileId) {\n    return this.tileCache.get(tileId) || this.tilesInView[tileId] || this.tilesLoading[tileId];\n  };\n\n  _proto2._drawTiles = function _drawTiles(tiles, parentTiles, childTiles, placeholders) {\n    var _this2 = this;\n\n    if (parentTiles.length) {\n      parentTiles.sort(function (t1, t2) {\n        return Math.abs(t2.info.z - _this2._tileZoom) - Math.abs(t1.info.z - _this2._tileZoom);\n      });\n      this._parentTiles = parentTiles;\n    }\n\n    if (childTiles.length) {\n      this._childTiles = childTiles;\n    }\n\n    var context = {\n      tiles: tiles,\n      parentTiles: this._parentTiles,\n      childTiles: this._childTiles\n    };\n    this.onDrawTileStart(context);\n\n    this._parentTiles.forEach(function (t) {\n      return _this2._drawTileAndCache(t);\n    });\n\n    this._childTiles.forEach(function (t) {\n      return _this2._drawTile(t.info, t.image);\n    });\n\n    placeholders.forEach(function (t) {\n      return _this2._drawTile(t.info, t.image);\n    });\n    var layer = this.layer,\n        map = this.getMap();\n\n    if (!layer.options['cascadeTiles'] || map.getPitch() <= map.options['cascadePitches'][0]) {\n      tiles.forEach(function (t) {\n        return _this2._drawTileAndCache(t);\n      });\n    } else {\n      this.writeZoomStencil();\n      var started = false;\n\n      for (var i = 0, l = tiles.length; i < l; i++) {\n        if (tiles[i].info.z !== this._tileZoom) {\n          if (!started) {\n            this.startZoomStencilTest();\n            started = true;\n          } else {\n            this.resumeZoomStencilTest();\n          }\n        } else if (started) {\n          this.pauseZoomStencilTest();\n        }\n\n        this._drawTileAndCache(tiles[i]);\n      }\n\n      this.endZoomStencilTest();\n    }\n\n    this.onDrawTileEnd(context);\n  };\n\n  _proto2.writeZoomStencil = function writeZoomStencil() {};\n\n  _proto2.startZoomStencilTest = function startZoomStencilTest() {};\n\n  _proto2.endZoomStencilTest = function endZoomStencilTest() {};\n\n  _proto2.pauseZoomStencilTest = function pauseZoomStencilTest() {};\n\n  _proto2.resumeZoomStencilTest = function resumeZoomStencilTest() {};\n\n  _proto2.onDrawTileStart = function onDrawTileStart() {};\n\n  _proto2.onDrawTileEnd = function onDrawTileEnd() {};\n\n  _proto2._drawTile = function _drawTile(info, image) {\n    if (image) {\n      this.drawTile(info, image);\n    }\n  };\n\n  _proto2._drawTileAndCache = function _drawTileAndCache(tile) {\n    tile.current = true;\n    this.tilesInView[tile.info.id] = tile;\n\n    this._drawTile(tile.info, tile.image);\n\n    this.tileCache.add(tile.info.id, tile);\n  };\n\n  _proto2.drawOnInteracting = function drawOnInteracting() {\n    this.draw();\n  };\n\n  _proto2.needToRedraw = function needToRedraw() {\n    var map = this.getMap();\n\n    if (map.getPitch()) {\n      return _CanvasRenderer.prototype.needToRedraw.call(this);\n    }\n\n    if (map.isRotating() || map.isZooming()) {\n      return true;\n    }\n\n    if (map.isMoving()) {\n      return !!this.layer.options['forceRenderOnMoving'];\n    }\n\n    return _CanvasRenderer.prototype.needToRedraw.call(this);\n  };\n\n  _proto2.hitDetect = function hitDetect() {\n    return false;\n  };\n\n  _proto2._getLoadLimit = function _getLoadLimit() {\n    if (this.getMap().isInteracting()) {\n      return this.layer.options['loadingLimitOnInteracting'];\n    }\n\n    return 0;\n  };\n\n  _proto2.isDrawable = function isDrawable() {\n    if (this.getMap().getPitch()) {\n      if (console) {\n        console.warn('TileLayer with canvas renderer can\\'t be pitched, use gl renderer (\\'renderer\\' : \\'gl\\') instead.');\n      }\n\n      this.clear();\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto2.clear = function clear() {\n    this._retireTiles(true);\n\n    this.tileCache.reset();\n    this.tilesInView = {};\n    this.tilesLoading = {};\n    this._parentTiles = [];\n    this._childTiles = [];\n\n    _CanvasRenderer.prototype.clear.call(this);\n  };\n\n  _proto2._isLoadingTile = function _isLoadingTile(tileId) {\n    return !!this.tilesLoading[tileId];\n  };\n\n  _proto2.clipCanvas = function clipCanvas(context) {\n    return _CanvasRenderer.prototype.clipCanvas.call(this, context);\n  };\n\n  _proto2._clipByPitch = function _clipByPitch(ctx) {\n    var map = this.getMap();\n\n    if (map.getPitch() <= map.options['maxVisualPitch']) {\n      return false;\n    }\n\n    if (!this.layer.options['clipByPitch']) {\n      return false;\n    }\n\n    var clipExtent = map.getContainerExtent();\n    var r = map.getDevicePixelRatio();\n    ctx.save();\n    ctx.strokeStyle = 'rgba(0, 0, 0, 0)';\n    ctx.beginPath();\n    ctx.rect(0, Math.ceil(clipExtent.ymin) * r, Math.ceil(clipExtent.getWidth()) * r, Math.ceil(clipExtent.getHeight()) * r);\n    ctx.stroke();\n    ctx.clip();\n    return true;\n  };\n\n  _proto2.loadTileQueue = function loadTileQueue(tileQueue) {\n    for (var p in tileQueue) {\n      if (tileQueue.hasOwnProperty(p)) {\n        var tile = tileQueue[p];\n        var tileImage = this.loadTile(tile);\n\n        if (tileImage.loadTime === undefined) {\n          this.tilesLoading[tile['id']] = {\n            image: tileImage,\n            current: true,\n            info: tile\n          };\n        }\n      }\n    }\n  };\n\n  _proto2.loadTile = function loadTile(tile) {\n    var tileImage;\n\n    if (this._tileImageWorkerConn && this.loadTileImage === this.constructor.prototype.loadTileImage) {\n      tileImage = {};\n\n      this._fetchImage(tileImage, tile);\n    } else {\n      var tileSize = this.layer.getTileSize(tile.layer);\n      tileImage = new Image();\n      tileImage.width = tileSize['width'];\n      tileImage.height = tileSize['height'];\n      tileImage.onload = this.onTileLoad.bind(this, tileImage, tile);\n      tileImage.onerror = this.onTileError.bind(this, tileImage, tile);\n      this.loadTileImage(tileImage, tile['url']);\n    }\n\n    return tileImage;\n  };\n\n  _proto2._fetchImage = function _fetchImage(image, tile) {\n    var _this3 = this;\n\n    if (image instanceof Image) {\n      image.src = tile.url;\n    } else {\n      var x = tile.x,\n          y = tile.y;\n\n      var workerId = Math.abs(x + y) % this._tileImageWorkerConn.workers.length;\n\n      this._tileImageWorkerConn.fetchImage(tile.url, workerId, function (err, data) {\n        if (err) {\n          _this3.onTileError(image, tile, err);\n        } else {\n          getImageBitMap(data, function (bitmap) {\n            _this3.onTileLoad(bitmap, tile);\n          });\n        }\n      }, this.layer.options['fetchOptions'] || {\n        referrer: document.location.href,\n        headers: {\n          accept: 'image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8'\n        }\n      });\n    }\n  };\n\n  _proto2.loadTileImage = function loadTileImage(tileImage, url) {\n    var crossOrigin = this.layer.options['crossOrigin'];\n\n    if (!isNil(crossOrigin)) {\n      tileImage.crossOrigin = crossOrigin;\n    }\n\n    return loadImage(tileImage, [url]);\n  };\n\n  _proto2.abortTileLoading = function abortTileLoading(tileImage) {\n    if (!tileImage) return;\n    tileImage.onload = falseFn;\n    tileImage.onerror = falseFn;\n    tileImage.src = emptyImageUrl;\n  };\n\n  _proto2.onTileLoad = function onTileLoad(tileImage, tileInfo) {\n    if (!this.layer) {\n      return;\n    }\n\n    var id = tileInfo['id'];\n\n    if (!this.tilesInView) {\n      return;\n    }\n\n    var e = {\n      tile: tileInfo,\n      tileImage: tileImage\n    };\n    this.layer.fire('tileload', e);\n    tileImage = e.tileImage;\n    tileImage.loadTime = now();\n    delete this.tilesLoading[id];\n\n    this._addTileToCache(tileInfo, tileImage);\n\n    this.setToRedraw();\n  };\n\n  _proto2.onTileError = function onTileError(tileImage, tileInfo) {\n    if (!this.layer) {\n      return;\n    }\n\n    tileImage.onerrorTick = tileImage.onerrorTick || 0;\n    var tileRetryCount = this.layer.options['tileRetryCount'];\n\n    if (tileRetryCount > tileImage.onerrorTick) {\n      tileImage.onerrorTick++;\n\n      this._fetchImage(tileImage, tileInfo);\n\n      return;\n    }\n\n    var errorUrl = this.layer.options['errorUrl'];\n\n    if (errorUrl) {\n      if (tileImage instanceof Image && tileImage.src !== errorUrl) {\n        tileImage.src = errorUrl;\n        return;\n      } else {\n        tileImage = new Image();\n        tileImage.src = errorUrl;\n      }\n    }\n\n    tileImage = tileImage instanceof Image ? tileImage : BLANK_IMAGE;\n    this.abortTileLoading(tileImage, tileInfo);\n    tileImage.loadTime = 0;\n    delete this.tilesLoading[tileInfo['id']];\n\n    this._addTileToCache(tileInfo, tileImage);\n\n    this.setToRedraw();\n    this.layer.fire('tileerror', {\n      tile: tileInfo\n    });\n  };\n\n  _proto2.drawTile = function drawTile(tileInfo, tileImage) {\n    if (!tileImage || !this.getMap()) {\n      return;\n    }\n\n    var extent2d = tileInfo.extent2d,\n        offset = tileInfo.offset;\n    var point = TILE_POINT.set(extent2d.xmin - offset[0], extent2d.ymax - offset[1]),\n        tileZoom = tileInfo.z,\n        tileId = tileInfo.id;\n\n    var map = this.getMap(),\n        zoom = map.getZoom(),\n        ctx = this.context,\n        cp = map._pointToContainerPoint(point, tileZoom, 0, TEMP_POINT$3),\n        bearing = map.getBearing(),\n        transformed = bearing || zoom !== tileZoom;\n\n    var opacity = this.getTileOpacity(tileImage);\n    var alpha = ctx.globalAlpha;\n\n    if (opacity < 1) {\n      ctx.globalAlpha = opacity;\n      this.setToRedraw();\n    }\n\n    if (!transformed) {\n      cp._round();\n    }\n\n    var x = cp.x,\n        y = cp.y;\n    var w = tileInfo.extent2d.xmax - tileInfo.extent2d.xmin;\n    var h = tileInfo.extent2d.ymax - tileInfo.extent2d.ymin;\n\n    if (transformed) {\n      ctx.save();\n      ctx.translate(x, y);\n\n      if (bearing) {\n        ctx.rotate(-bearing * Math.PI / 180);\n        w += 0.1;\n        h += 0.1;\n      }\n\n      if (zoom !== tileZoom) {\n        var scale = map._getResolution(tileZoom) / map._getResolution();\n\n        ctx.scale(scale, scale);\n      }\n\n      x = y = 0;\n    }\n\n    Canvas.image(ctx, tileImage, x, y, w, h);\n\n    if (this.layer.options['debug']) {\n      var color = this.layer.options['debugOutline'];\n      ctx.save();\n      ctx.strokeStyle = color;\n      ctx.fillStyle = color;\n      ctx.strokeWidth = 10;\n      ctx.font = '20px monospace';\n\n      var _point = new Point(x, y);\n\n      Canvas.rectangle(ctx, _point, {\n        width: w,\n        height: h\n      }, 1, 0);\n      Canvas.fillText(ctx, this.getDebugInfo(tileId), _point._add(10, 20), color);\n      Canvas.drawCross(ctx, x + w / 2, y + h / 2, 2, color);\n      ctx.restore();\n    }\n\n    if (transformed) {\n      ctx.restore();\n    }\n\n    if (ctx.globalAlpha !== alpha) {\n      ctx.globalAlpha = alpha;\n    }\n\n    this.setCanvasUpdated();\n  };\n\n  _proto2.getDebugInfo = function getDebugInfo(tileId) {\n    var xyz = tileId.split('_');\n    var length = xyz.length;\n    return 'x:' + xyz[length - 2] + ', y:' + xyz[length - 3] + ', z:' + xyz[length - 1];\n  };\n\n  _proto2._findChildTiles = function _findChildTiles(info) {\n    var layer = this._getLayerOfTile(info.layer);\n\n    if (!layer.options['background']) {\n      return [];\n    }\n\n    var map = this.getMap();\n    var children = [];\n    var sr = layer.getSpatialReference();\n    var res = sr.getResolution(info.z);\n\n    var min = info.extent2d.getMin(),\n        max = info.extent2d.getMax(),\n        pmin = layer._project(map._pointToPrjAtRes(min, res, TEMP_POINT1$2), TEMP_POINT1$2),\n        pmax = layer._project(map._pointToPrjAtRes(max, res, TEMP_POINT2$2), TEMP_POINT2$2);\n\n    var zoomDiff = 2;\n\n    for (var i = 1; i < zoomDiff; i++) {\n      this._findChildTilesAt(children, pmin, pmax, layer, info.z + i);\n    }\n\n    return children;\n  };\n\n  _proto2._findChildTilesAt = function _findChildTilesAt(children, pmin, pmax, layer, childZoom) {\n    var zoomOffset = layer.options['zoomOffset'];\n    var layerId = layer.getId(),\n        res = layer.getSpatialReference().getResolution(childZoom + zoomOffset);\n\n    if (!res) {\n      return;\n    }\n\n    var dmin = layer._getTileConfig().getTileIndex(pmin, res),\n        dmax = layer._getTileConfig().getTileIndex(pmax, res);\n\n    var sx = Math.min(dmin.idx, dmax.idx),\n        ex = Math.max(dmin.idx, dmax.idx);\n    var sy = Math.min(dmin.idy, dmax.idy),\n        ey = Math.max(dmin.idy, dmax.idy);\n    var id, tile;\n\n    for (var i = sx; i < ex; i++) {\n      for (var ii = sy; ii < ey; ii++) {\n        id = layer._getTileId(i, ii, childZoom + zoomOffset, layerId);\n\n        if (this.tileCache.has(id)) {\n          tile = this.tileCache.getAndRemove(id);\n          children.push(tile);\n          this.tileCache.add(id, tile);\n        }\n      }\n    }\n  };\n\n  _proto2._findParentTile = function _findParentTile(info) {\n    var map = this.getMap(),\n        layer = this._getLayerOfTile(info.layer);\n\n    if (!layer.options['background']) {\n      return null;\n    }\n\n    var sr = layer.getSpatialReference();\n    var d = sr.getZoomDirection(),\n        zoomOffset = layer.options['zoomOffset'],\n        zoomDiff = layer.options['backgroundZoomDiff'];\n    var res = sr.getResolution(info.z);\n\n    var center = info.extent2d.getCenter(),\n        prj = layer._project(map._pointToPrjAtRes(center, res));\n\n    for (var diff = 1; diff <= zoomDiff; diff++) {\n      var z = info.z - d * diff;\n\n      var _res = sr.getResolution(z + zoomOffset);\n\n      if (!_res) continue;\n\n      var tileIndex = layer._getTileConfig().getTileIndex(prj, _res);\n\n      var id = layer._getTileId(tileIndex.x, tileIndex.y, z + zoomOffset, info.layer);\n\n      if (this.tileCache.has(id)) {\n        var tile = this.tileCache.getAndRemove(id);\n        this.tileCache.add(id, tile);\n        return tile;\n      }\n    }\n\n    return null;\n  };\n\n  _proto2._getLayerOfTile = function _getLayerOfTile(layerId) {\n    return this.layer.getChildLayer ? this.layer.getChildLayer(layerId) : this.layer;\n  };\n\n  _proto2._getCachedTile = function _getCachedTile(tileId) {\n    var tilesInView = this.tilesInView;\n    var cached = this.tileCache.getAndRemove(tileId);\n\n    if (cached) {\n      tilesInView[tileId] = cached;\n      var tilesLoading = this.tilesLoading;\n\n      if (tilesLoading && tilesLoading[tileId]) {\n        tilesLoading[tileId].current = false;\n        var _tilesLoading$tileId = tilesLoading[tileId],\n            image = _tilesLoading$tileId.image,\n            info = _tilesLoading$tileId.info;\n        this.abortTileLoading(image, info);\n        delete tilesLoading[tileId];\n      }\n    } else {\n      cached = tilesInView[tileId];\n    }\n\n    return cached;\n  };\n\n  _proto2._addTileToCache = function _addTileToCache(tileInfo, tileImage) {\n    this.tilesInView[tileInfo.id] = {\n      image: tileImage,\n      current: true,\n      info: tileInfo\n    };\n  };\n\n  _proto2.getTileOpacity = function getTileOpacity(tileImage) {\n    if (!this.layer.options['fadeAnimation'] || !tileImage.loadTime) {\n      return 1;\n    }\n\n    return Math.min(1, (now() - tileImage.loadTime) / (1000 / 60 * 10));\n  };\n\n  _proto2.onRemove = function onRemove() {\n    this.clear();\n    delete this.tileCache;\n    delete this._tilePlaceHolder;\n\n    _CanvasRenderer.prototype.onRemove.call(this);\n  };\n\n  _proto2._markTiles = function _markTiles() {\n    var a = 0,\n        b = 0;\n\n    if (this.tilesLoading) {\n      for (var p in this.tilesLoading) {\n        this.tilesLoading[p].current = false;\n        a++;\n      }\n    }\n\n    if (this.tilesInView) {\n      for (var _p in this.tilesInView) {\n        this.tilesInView[_p].current = false;\n        b++;\n      }\n    }\n\n    return [a, b];\n  };\n\n  _proto2._retireTiles = function _retireTiles(force) {\n    for (var i in this.tilesLoading) {\n      var tile = this.tilesLoading[i];\n\n      if (force || !tile.current) {\n        if (tile.image) {\n          this.abortTileLoading(tile.image, tile.info);\n        }\n\n        this.deleteTile(tile);\n        delete this.tilesLoading[i];\n      }\n    }\n\n    for (var _i2 in this.tilesInView) {\n      var _tile = this.tilesInView[_i2];\n\n      if (!_tile.current) {\n        delete this.tilesInView[_i2];\n\n        if (!this.tileCache.has(_i2)) {\n          this.deleteTile(_tile);\n        }\n      }\n    }\n  };\n\n  _proto2.deleteTile = function deleteTile(tile) {\n    if (!tile || !tile.image) {\n      return;\n    }\n\n    if (tile.image.close) {\n      tile.image.close();\n    }\n\n    tile.image.onload = null;\n    tile.image.onerror = null;\n  };\n\n  _proto2._generatePlaceHolder = function _generatePlaceHolder(z) {\n    var map = this.getMap();\n    var placeholder = this.layer.options['placeholder'];\n\n    if (!placeholder || map.getPitch()) {\n      return null;\n    }\n\n    var tileSize = this.layer.getTileSize(),\n        scale = map._getResolution(z) / map._getResolution(),\n        canvas = this._tilePlaceHolder = this._tilePlaceHolder || Canvas.createCanvas(1, 1, map.CanvasClass);\n\n    canvas.width = tileSize.width * scale;\n    canvas.height = tileSize.height * scale;\n\n    if (isFunction(placeholder)) {\n      placeholder(canvas);\n    } else {\n      defaultPlaceholder(canvas);\n    }\n\n    return canvas;\n  };\n\n  return TileLayerCanvasRenderer;\n}(CanvasRenderer);\n\nTileLayer.registerRenderer('canvas', TileLayerCanvasRenderer);\n\nfunction falseFn() {\n  return false;\n}\n\nfunction defaultPlaceholder(canvas) {\n  var ctx = canvas.getContext('2d'),\n      cw = canvas.width,\n      ch = canvas.height,\n      w = cw / 16,\n      h = ch / 16;\n  ctx.beginPath();\n\n  for (var i = 0; i < 16; i++) {\n    ctx.moveTo(0, i * h);\n    ctx.lineTo(cw, i * h);\n    ctx.moveTo(i * w, 0);\n    ctx.lineTo(i * w, ch);\n  }\n\n  ctx.strokeStyle = 'rgba(180, 180, 180, 0.1)';\n  ctx.lineWidth = 1;\n  ctx.stroke();\n  ctx.beginPath();\n  var path = [[0, 0], [cw, 0], [0, ch], [cw, ch], [0, 0], [0, ch], [cw, 0], [cw, ch], [0, ch / 2], [cw, ch / 2], [cw / 2, 0], [cw / 2, ch]];\n\n  for (var _i3 = 1; _i3 < path.length; _i3 += 2) {\n    ctx.moveTo(path[_i3 - 1][0], path[_i3 - 1][1]);\n    ctx.lineTo(path[_i3][0], path[_i3][1]);\n  }\n\n  ctx.lineWidth = 1 * 4;\n  ctx.stroke();\n}\n\nvar TILE_POINT$1 = new Point(0, 0);\n\nvar TileLayerGLRenderer = function (_ImageGLRenderable) {\n  _inheritsLoose(TileLayerGLRenderer, _ImageGLRenderable);\n\n  function TileLayerGLRenderer() {\n    return _ImageGLRenderable.apply(this, arguments) || this;\n  }\n\n  var _proto = TileLayerGLRenderer.prototype;\n\n  _proto.isDrawable = function isDrawable() {\n    return true;\n  };\n\n  _proto.needToRedraw = function needToRedraw() {\n    var map = this.getMap();\n\n    if (this._gl() && !map.getPitch() && map.isZooming() && !map.isMoving() && !map.isRotating()) {\n      return true;\n    }\n\n    return _ImageGLRenderable.prototype.needToRedraw.call(this);\n  };\n\n  _proto.drawTile = function drawTile(tileInfo, tileImage) {\n    var map = this.getMap();\n\n    if (!tileInfo || !map || !tileImage) {\n      return;\n    }\n\n    var scale = tileInfo._glScale = tileInfo._glScale || map.getGLScale(tileInfo.z);\n    var w = tileInfo.extent2d.xmax - tileInfo.extent2d.xmin;\n    var h = tileInfo.extent2d.ymax - tileInfo.extent2d.ymin;\n\n    if (tileInfo.cache !== false) {\n      this._bindGLBuffer(tileImage, w, h);\n    }\n\n    if (!this._gl()) {\n      _ImageGLRenderable.prototype.drawTile.call(this, tileInfo, tileImage);\n\n      return;\n    }\n\n    var extent2d = tileInfo.extent2d,\n        offset = tileInfo.offset;\n    var point = TILE_POINT$1.set(extent2d.xmin - offset[0], tileInfo.extent2d.ymax - offset[1]);\n    var x = point.x * scale,\n        y = point.y * scale;\n    var opacity = this.getTileOpacity(tileImage);\n    var debugInfo = null;\n\n    if (this.layer.options['debug']) {\n      debugInfo = this.getDebugInfo(tileInfo.id);\n    }\n\n    this.drawGLImage(tileImage, x, y, w, h, scale, opacity, debugInfo);\n\n    if (opacity < 1) {\n      this.setToRedraw();\n    } else {\n      this.setCanvasUpdated();\n    }\n  };\n\n  _proto.writeZoomStencil = function writeZoomStencil() {\n    var gl = this.gl;\n    gl.stencilFunc(gl.ALWAYS, 1, 0xFF);\n    gl.stencilOp(gl.KEEP, gl.KEEP, gl.REPLACE);\n  };\n\n  _proto.startZoomStencilTest = function startZoomStencilTest() {\n    var gl = this.gl;\n    gl.stencilOp(gl.KEEP, gl.KEEP, gl.KEEP);\n    gl.stencilFunc(gl.EQUAL, 0, 0xFF);\n  };\n\n  _proto.endZoomStencilTest = function endZoomStencilTest() {\n    this.pauseZoomStencilTest();\n  };\n\n  _proto.pauseZoomStencilTest = function pauseZoomStencilTest() {\n    var gl = this.gl;\n    gl.stencilFunc(gl.ALWAYS, 1, 0xFF);\n  };\n\n  _proto.resumeZoomStencilTest = function resumeZoomStencilTest() {\n    var gl = this.gl;\n    gl.stencilFunc(gl.EQUAL, 0, 0xFF);\n  };\n\n  _proto._bindGLBuffer = function _bindGLBuffer(image, w, h) {\n    if (!image.glBuffer) {\n      image.glBuffer = this.bufferTileData(0, 0, w, h);\n    }\n  };\n\n  _proto.loadTileImage = function loadTileImage(tileImage, url) {\n    var crossOrigin = this.layer.options['crossOrigin'];\n    tileImage.crossOrigin = crossOrigin !== null ? crossOrigin : '';\n    tileImage.src = url;\n    return;\n  };\n\n  _proto.onCanvasCreate = function onCanvasCreate() {\n    if (!this.canvas.gl || !this.canvas.gl.wrap) {\n      this.createCanvas2();\n    }\n  };\n\n  _proto.createContext = function createContext() {\n    _ImageGLRenderable.prototype.createContext.call(this);\n\n    this.createGLContext();\n  };\n\n  _proto.resizeCanvas = function resizeCanvas(canvasSize) {\n    if (!this.canvas) {\n      return;\n    }\n\n    _ImageGLRenderable.prototype.resizeCanvas.call(this, canvasSize);\n\n    this.resizeGLCanvas();\n  };\n\n  _proto.clearCanvas = function clearCanvas() {\n    if (!this.canvas) {\n      return;\n    }\n\n    _ImageGLRenderable.prototype.clearCanvas.call(this);\n\n    this.clearGLCanvas();\n  };\n\n  _proto.getCanvasImage = function getCanvasImage() {\n    if (!this._gl() || !this.canvas2) {\n      return _ImageGLRenderable.prototype.getCanvasImage.call(this);\n    }\n\n    var img = _ImageGLRenderable.prototype.getCanvasImage.call(this);\n\n    if (img) {\n      img.image = this.canvas2;\n    }\n\n    return img;\n  };\n\n  _proto._gl = function _gl() {\n    if (this.canvas.gl && this.canvas.gl.wrap) {\n      return true;\n    }\n\n    var map = this.getMap();\n    return map && (map.getPitch() || map.getBearing()) || this.layer && !!this.layer.options['fragmentShader'];\n  };\n\n  _proto.deleteTile = function deleteTile(tile) {\n    _ImageGLRenderable.prototype.deleteTile.call(this, tile);\n\n    if (tile && tile.image) {\n      this.disposeImage(tile.image);\n    }\n\n    delete tile.image;\n  };\n\n  _proto.onRemove = function onRemove() {\n    _ImageGLRenderable.prototype.onRemove.call(this);\n\n    this.removeGLCanvas();\n  };\n\n  return TileLayerGLRenderer;\n}(ImageGLRenderable(TileLayerCanvasRenderer));\n\nTileLayer.registerRenderer('gl', TileLayerGLRenderer);\n\nfunction _loadTile(tile) {\n  var tileSize = this.layer.getTileSize(),\n      canvasClass = this.canvas.constructor,\n      map = this.getMap();\n  var r = map.getDevicePixelRatio();\n  var tileCanvas = Canvas.createCanvas(tileSize['width'] * r, tileSize['height'] * r, canvasClass);\n  tileCanvas['layer'] = this.layer;\n  var me = this;\n  var point = new Point(tile['extent2d'].xmin, tile['extent2d'].ymax);\n  var extent = new Extent(map.pointToCoordinate(point), map.pointToCoordinate(point.add(tileSize.width, tileSize.height)), map.getProjection());\n  this.layer.drawTile(tileCanvas, {\n    'url': tile['url'],\n    'point': point,\n    'center': map.pointToCoordinate(point.add(tileSize['width'] / 2, tileSize['height'] / 2)),\n    'extent': extent,\n    'z': tile['z'],\n    'x': tile['x'],\n    'y': tile['y']\n  }, function (error) {\n    if (error) {\n      me.onTileError(tileCanvas, tile);\n      return;\n    }\n\n    me.onTileLoad(tileCanvas, tile);\n  });\n  return tileCanvas;\n}\n\nvar CanvasRenderer$1 = function (_TileLayerCanvasRende) {\n  _inheritsLoose(CanvasRenderer, _TileLayerCanvasRende);\n\n  function CanvasRenderer() {\n    return _TileLayerCanvasRende.apply(this, arguments) || this;\n  }\n\n  var _proto = CanvasRenderer.prototype;\n\n  _proto.loadTile = function loadTile() {\n    return _loadTile.apply(this, arguments);\n  };\n\n  return CanvasRenderer;\n}(TileLayerCanvasRenderer);\n\nvar GLRenderer = function (_TileLayerGLRenderer) {\n  _inheritsLoose(GLRenderer, _TileLayerGLRenderer);\n\n  function GLRenderer() {\n    return _TileLayerGLRenderer.apply(this, arguments) || this;\n  }\n\n  var _proto2 = GLRenderer.prototype;\n\n  _proto2.loadTile = function loadTile() {\n    return _loadTile.apply(this, arguments);\n  };\n\n  return GLRenderer;\n}(TileLayerGLRenderer);\n\nCanvasTileLayer.registerRenderer('canvas', CanvasRenderer$1);\nCanvasTileLayer.registerRenderer('gl', GLRenderer);\n\nvar quadVertices = typeof Int8Array !== 'undefined' ? new Int8Array([-1, 1, 0, -1, -1, 0, 1, 1, 0, 1, -1, 0]) : [];\nvar vert = \"\\n    attribute vec3 a_position;\\n    uniform mat4 transform;\\n\\n    void main()\\n    {\\n        gl_Position = transform * vec4(a_position, 1.0);\\n    }\\n\";\nvar frag = \"\\n    precision mediump float;\\n    uniform vec3 color;\\n    void main()\\n    {\\n        gl_FragColor = vec4(color, 1.0);\\n    }\\n\";\n\nvar QuadStencil = function () {\n  function QuadStencil(gl, vertices, debug) {\n    this.gl = gl;\n    this.quadVertices = vertices || quadVertices;\n    this.attributes = ['a_position', 3, getType(vertices)];\n    this.debug = debug;\n  }\n\n  var _proto = QuadStencil.prototype;\n\n  _proto.start = function start() {\n    var gl = this.gl;\n    gl.enable(gl.STENCIL_TEST);\n    gl.stencilMask(0xFF);\n    gl.stencilOp(gl.KEEP, gl.REPLACE, gl.REPLACE);\n    gl.depthMask(false);\n\n    this._save();\n\n    if (!this.buffer) {\n      this._createBuffer();\n\n      this._createProgram();\n    }\n\n    gl.useProgram(this.program);\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.buffer);\n    enableVertexAttrib(gl, this.program, this.attributes);\n\n    if (!this.transformLoc) {\n      this.transformLoc = gl.getUniformLocation(this.program, 'transform');\n    }\n\n    if (!this.colorLoc) {\n      this.colorLoc = gl.getUniformLocation(this.program, 'color');\n    }\n\n    if (this.debug) {\n      return;\n    }\n\n    gl.colorMask(false, false, false, false);\n  };\n\n  _proto.end = function end() {\n    var gl = this.gl;\n    gl.depthMask(true);\n\n    this._restore();\n\n    if (this.debug) {\n      return;\n    }\n\n    gl.colorMask(true, true, true, true);\n  };\n\n  _proto.draw = function draw(transform) {\n    var gl = this.gl;\n    gl.uniformMatrix4fv(this.transformLoc, false, transform);\n    gl.uniform3fv(this.colorLoc, [Math.random(), Math.random(), Math.random()]);\n    gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n  };\n\n  _proto.remove = function remove() {\n    var gl = this.gl;\n\n    if (this.buffer) {\n      gl.deleteBuffer(this.buffer);\n    }\n\n    if (this.program) {\n      gl.deleteShader(this.program.fragmentShader);\n      gl.deleteShader(this.program.vertexShader);\n      gl.deleteProgram(this.program);\n    }\n\n    delete this.transformLoc;\n    delete this.gl;\n    return this;\n  };\n\n  _proto.stencilMask = function stencilMask(mask) {\n    this.gl.stencilMask(mask);\n    return this;\n  };\n\n  _proto.stencilFunc = function stencilFunc(func, ref, mask) {\n    this.ref = ref;\n    this.gl.stencilFunc(func, ref, mask);\n    return this;\n  };\n\n  _proto.stencilOp = function stencilOp(fail, zfail, zpass) {\n    this.gl.stencilOp(fail, zfail, zpass);\n    return this;\n  };\n\n  _proto.resetFunc = function resetFunc() {\n    this.ref = 1;\n    this.gl.stencilFunc(this.gl.ALWAYS, 1, 0xFF);\n    return this;\n  };\n\n  _proto._save = function _save() {\n    var gl = this.gl;\n    this._savedProgram = gl.program;\n  };\n\n  _proto._restore = function _restore() {\n    var gl = this.gl;\n    gl.program = this._savedProgram;\n\n    if (gl.program) {\n      gl.useProgram(gl.program);\n    }\n  };\n\n  _proto._createBuffer = function _createBuffer() {\n    var gl = this.gl;\n    this.buffer = gl.createBuffer();\n\n    if (!this.buffer) {\n      throw new Error('Failed to create the buffer object');\n    }\n\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.buffer);\n    gl.bufferData(gl.ARRAY_BUFFER, this.quadVertices, gl.STATIC_DRAW);\n  };\n\n  _proto._createProgram = function _createProgram() {\n    var _createProgram2 = createProgram(this.gl, vert, frag),\n        program = _createProgram2.program,\n        vertexShader = _createProgram2.vertexShader,\n        fragmentShader = _createProgram2.fragmentShader;\n\n    program.vertexShader = vertexShader;\n    program.fragmentShader = fragmentShader;\n    this.program = program;\n  };\n\n  return QuadStencil;\n}();\n\nfunction getType(arr) {\n  if (arr instanceof Float32Array) {\n    return 'FLOAT';\n  } else if (arr instanceof Int16Array) {\n    return 'SHORT';\n  } else if (arr instanceof Uint16Array) {\n    return 'UNSIGNED_SHORT';\n  } else if (arr instanceof Int8Array) {\n    return 'BYTE';\n  } else if (arr instanceof Uint8Array || arr instanceof Uint8ClampedArray) {\n    return 'UNSIGNED_BYTE';\n  }\n\n  return 'FLOAT';\n}\n\nvar OverlayLayerRenderer = function (_CanvasRenderer) {\n  _inheritsLoose(OverlayLayerRenderer, _CanvasRenderer);\n\n  function OverlayLayerRenderer() {\n    return _CanvasRenderer.apply(this, arguments) || this;\n  }\n\n  var _proto = OverlayLayerRenderer.prototype;\n\n  _proto.checkResources = function checkResources() {\n    var geometries = this._geosToCheck;\n\n    if (!this._resourceChecked && !geometries) {\n      geometries = this.layer._geoList;\n    }\n\n    if (!isArrayHasData(geometries)) {\n      return [];\n    }\n\n    var resources = [];\n    var cache = {};\n\n    for (var i = geometries.length - 1; i >= 0; i--) {\n      var geo = geometries[i];\n\n      var res = geo._getExternalResources();\n\n      if (!res.length) {\n        continue;\n      }\n\n      if (!this.resources) {\n        resources.push.apply(resources, res);\n      } else {\n        for (var _i = 0; _i < res.length; _i++) {\n          var url = res[_i][0];\n\n          if (!this.resources.isResourceLoaded(res[_i]) && !cache[url]) {\n            resources.push(res[_i]);\n            cache[url] = 1;\n          }\n        }\n      }\n    }\n\n    this._resourceChecked = true;\n    delete this._geosToCheck;\n    return resources;\n  };\n\n  _proto.render = function render() {\n    this.layer._sortGeometries();\n\n    return _CanvasRenderer.prototype.render.apply(this, arguments);\n  };\n\n  _proto._addGeoToCheckRes = function _addGeoToCheckRes(res) {\n    if (!res) {\n      return;\n    }\n\n    if (!Array.isArray(res)) {\n      res = [res];\n    }\n\n    if (!this._geosToCheck) {\n      this._geosToCheck = [];\n    }\n\n    pushIn(this._geosToCheck, res);\n  };\n\n  _proto.onGeometryAdd = function onGeometryAdd(geometries) {\n    this._addGeoToCheckRes(geometries);\n\n    redraw(this);\n  };\n\n  _proto.onGeometryRemove = function onGeometryRemove() {\n    redraw(this);\n  };\n\n  _proto.onGeometrySymbolChange = function onGeometrySymbolChange(e) {\n    this._addGeoToCheckRes(e.target);\n\n    redraw(this);\n  };\n\n  _proto.onGeometryShapeChange = function onGeometryShapeChange() {\n    redraw(this);\n  };\n\n  _proto.onGeometryPositionChange = function onGeometryPositionChange() {\n    redraw(this);\n  };\n\n  _proto.onGeometryZIndexChange = function onGeometryZIndexChange() {\n    redraw(this);\n  };\n\n  _proto.onGeometryShow = function onGeometryShow() {\n    redraw(this);\n  };\n\n  _proto.onGeometryHide = function onGeometryHide() {\n    redraw(this);\n  };\n\n  _proto.onGeometryPropertiesChange = function onGeometryPropertiesChange() {\n    redraw(this);\n  };\n\n  return OverlayLayerRenderer;\n}(CanvasRenderer);\n\nfunction redraw(renderer) {\n  if (renderer.layer.options['drawImmediate']) {\n    renderer.render();\n  }\n\n  renderer.setToRedraw();\n}\n\nvar TEMP_EXTENT$6 = new PointExtent();\nvar TEMP_VEC3 = [];\nvar TEMP_FIXEDEXTENT = new PointExtent();\nvar PLACEMENT_CENTER = 'center';\n\nvar VectorLayerRenderer = function (_OverlayLayerCanvasRe) {\n  _inheritsLoose(VectorLayerRenderer, _OverlayLayerCanvasRe);\n\n  function VectorLayerRenderer() {\n    return _OverlayLayerCanvasRe.apply(this, arguments) || this;\n  }\n\n  var _proto = VectorLayerRenderer.prototype;\n\n  _proto.getImageData = function getImageData() {\n    if (!this.layer.options['geometryEvents'] || !this._lastRenderTime || now() - this._lastRenderTime < 32) {\n      return null;\n    }\n\n    if (!this._imageData) {\n      var _this$context$canvas = this.context.canvas,\n          width = _this$context$canvas.width,\n          height = _this$context$canvas.height;\n\n      try {\n        this._imageData = this.context.getImageData(0, 0, width, height);\n      } catch (error) {\n        console.warn('hit detect failed with tainted canvas, some geometries have external resources in another domain:\\n', error);\n      }\n    }\n\n    return this._imageData;\n  };\n\n  _proto.clearImageData = function clearImageData() {\n    this._imageData = null;\n    delete this._imageData;\n    this._lastRenderTime = now();\n  };\n\n  _proto.checkResources = function checkResources() {\n    var _this = this;\n\n    var resources = _OverlayLayerCanvasRe.prototype.checkResources.apply(this, arguments);\n\n    var style = this.layer.getStyle();\n\n    if (style) {\n      if (!Array.isArray(style)) {\n        style = [style];\n      }\n\n      style.forEach(function (s) {\n        var res = getExternalResources(s['symbol'], true);\n\n        for (var i = 0, l = res.length; i < l; i++) {\n          if (!_this.resources.isResourceLoaded(res[i])) {\n            resources.push(res[i]);\n          }\n        }\n      });\n    }\n\n    return resources;\n  };\n\n  _proto.needToRedraw = function needToRedraw() {\n    var map = this.getMap();\n\n    if (map.isInteracting() && this.layer.options['enableAltitude']) {\n      return true;\n    }\n\n    if (map.isZooming() && !map.isRotating() && !map.getPitch() && !this._hasPoint && this.layer.constructor === VectorLayer) {\n      return false;\n    }\n\n    return _OverlayLayerCanvasRe.prototype.needToRedraw.call(this);\n  };\n\n  _proto.draw = function draw() {\n    if (!this.getMap()) {\n      return;\n    }\n\n    if (!this.layer.isVisible() || this.layer.isEmpty()) {\n      this.clearCanvas();\n      this.completeRender();\n      return;\n    }\n\n    this.prepareCanvas();\n    this.drawGeos();\n    this.completeRender();\n  };\n\n  _proto.isBlank = function isBlank() {\n    if (!this.context) {\n      return false;\n    }\n\n    return !this.context.canvas._drawn;\n  };\n\n  _proto.drawOnInteracting = function drawOnInteracting() {\n    if (!this._geosToDraw) {\n      return;\n    }\n\n    this._updateMapStateCache();\n\n    this._updateDisplayExtent();\n\n    var map = this.getMap();\n    var count = this.layer.getCount();\n    var res = this.mapStateCache.resolution;\n\n    if (map.isZooming() && map.options['seamlessZoom'] && this._drawnRes !== undefined && res > this._drawnRes * 1.5 && this._geosToDraw.length < count || map.isMoving() || map.isInteracting()) {\n      this.prepareToDraw();\n\n      this._batchConversionMarkers(this.mapStateCache.glRes);\n\n      if (!this._onlyHasPoint) {\n        this.forEachGeo(this.checkGeo, this);\n      }\n\n      this._drawnRes = res;\n    }\n\n    this._sortByDistanceToCamera(map.cameraPosition);\n\n    for (var i = 0, l = this._geosToDraw.length; i < l; i++) {\n      var geo = this._geosToDraw[i];\n\n      if (!geo._isCheck) {\n        if (!geo.isVisible()) {\n          delete geo._cPoint;\n          delete geo._inCurrentView;\n          continue;\n        }\n      }\n\n      geo._paint(this._displayExtent);\n\n      this._geosToDraw[i]._cPoint = undefined;\n      this._geosToDraw[i]._inCurrentView = undefined;\n    }\n\n    this.clearImageData();\n  };\n\n  _proto.show = function show() {\n    this.layer.forEach(function (geo) {\n      geo._repaint();\n    });\n\n    _OverlayLayerCanvasRe.prototype.show.apply(this, arguments);\n  };\n\n  _proto.forEachGeo = function forEachGeo(fn, context) {\n    this.layer.forEach(fn, context);\n  };\n\n  _proto.drawGeos = function drawGeos() {\n    this._updateMapStateCache();\n\n    this._drawnRes = this.mapStateCache.resolution;\n\n    this._updateDisplayExtent();\n\n    this.prepareToDraw();\n\n    this._batchConversionMarkers(this.mapStateCache.glRes);\n\n    if (!this._onlyHasPoint) {\n      this.forEachGeo(this.checkGeo, this);\n    }\n\n    this._sortByDistanceToCamera(this.getMap().cameraPosition);\n\n    for (var i = 0, len = this._geosToDraw.length; i < len; i++) {\n      this._geosToDraw[i]._paint();\n\n      this._geosToDraw[i]._cPoint = undefined;\n      this._geosToDraw[i]._inCurrentView = undefined;\n    }\n\n    this.clearImageData();\n  };\n\n  _proto.prepareToDraw = function prepareToDraw() {\n    this._hasPoint = false;\n    this._geosToDraw = [];\n  };\n\n  _proto.checkGeo = function checkGeo(geo) {\n    if (geo.type === 'Point' && this._onlyHasPoint !== undefined) {\n      if (geo._inCurrentView) {\n        this._hasPoint = true;\n        geo._isCheck = true;\n\n        this._geosToDraw.push(geo);\n      }\n\n      return;\n    }\n\n    geo._isCheck = false;\n\n    if (!geo || !geo.isVisible() || !geo.getMap() || !geo.getLayer() || !geo.getLayer().isCanvasRender()) {\n      return;\n    }\n\n    var painter = geo._getPainter();\n\n    var inCurrentView = true;\n\n    if (geo._inCurrentView) {\n      inCurrentView = true;\n    } else if (geo._inCurrentView === false) {\n      inCurrentView = false;\n    } else {\n      var extent2D = painter.get2DExtent(this.resources, TEMP_EXTENT$6);\n\n      if (!extent2D || !extent2D.intersects(this._displayExtent)) {\n        inCurrentView = false;\n      }\n    }\n\n    if (!inCurrentView) {\n      return;\n    }\n\n    if (painter.hasPoint()) {\n      this._hasPoint = true;\n    }\n\n    geo._isCheck = true;\n\n    this._geosToDraw.push(geo);\n  };\n\n  _proto.onZoomEnd = function onZoomEnd() {\n    delete this.canvasExtent2D;\n\n    _OverlayLayerCanvasRe.prototype.onZoomEnd.apply(this, arguments);\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.forEachGeo(function (g) {\n      g.onHide();\n    });\n    delete this._geosToDraw;\n  };\n\n  _proto.onGeometryPropertiesChange = function onGeometryPropertiesChange(param) {\n    if (param) {\n      this.layer._styleGeometry(param['target']);\n    }\n\n    _OverlayLayerCanvasRe.prototype.onGeometryPropertiesChange.call(this, param);\n  };\n\n  _proto._updateDisplayExtent = function _updateDisplayExtent() {\n    var extent2D = this.canvasExtent2D;\n\n    if (this._maskExtent) {\n      if (!this._maskExtent.intersects(extent2D)) {\n        this.completeRender();\n        return;\n      }\n\n      extent2D = extent2D.intersection(this._maskExtent);\n    }\n\n    this._displayExtent = extent2D;\n  };\n\n  _proto.identifyAtPoint = function identifyAtPoint(point, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var geometries = this._geosToDraw;\n\n    if (!geometries) {\n      return [];\n    }\n\n    return this.layer._hitGeos(geometries, point, options);\n  };\n\n  _proto._updateMapStateCache = function _updateMapStateCache() {\n    var map = this.getMap();\n\n    var offset = map._pointToContainerPoint(this.southWest)._add(0, -map.height);\n\n    var resolution = map.getResolution();\n    var pitch = map.getPitch();\n    var bearing = map.getBearing();\n    var glScale = map.getGLScale();\n    var glRes = map.getGLRes();\n    var containerExtent = map.getContainerExtent();\n\n    var _2DExtent = map._get2DExtent();\n\n    var glExtent = map._get2DExtentAtRes(glRes);\n\n    this.mapStateCache = {\n      resolution: resolution,\n      pitch: pitch,\n      bearing: bearing,\n      glScale: glScale,\n      glRes: glRes,\n      _2DExtent: _2DExtent,\n      glExtent: glExtent,\n      containerExtent: containerExtent,\n      offset: offset\n    };\n    return this;\n  };\n\n  _proto._batchConversionMarkers = function _batchConversionMarkers(glRes) {\n    this._onlyHasPoint = undefined;\n\n    if (!this._constructorIsThis()) {\n      return [];\n    }\n\n    var cPoints = [];\n    var markers = [];\n    var altitudes = [];\n    var altitudeCache = {};\n    var layer = this.layer;\n    var layerOpts = layer.options;\n    var layerAltitude = layer.getAltitude ? layer.getAltitude() : 0;\n    var isCanvasRender = layer.isCanvasRender();\n    this._onlyHasPoint = true;\n    var idx = 0;\n\n    for (var i = 0, len = this.layer._geoList.length; i < len; i++) {\n      var geo = this.layer._geoList[i];\n      var type = geo.getType();\n\n      if (type === 'Point') {\n        var painter = geo._painter;\n\n        if (!painter) {\n          painter = geo._getPainter();\n        }\n\n        var point = painter.getRenderPoints(PLACEMENT_CENTER)[0][0];\n        var altitude = layerOpts['enableAltitude'] ? geo.getAltitude() : layerAltitude;\n\n        if (altitudeCache[altitude] === undefined) {\n          altitudeCache[altitude] = painter.getAltitude();\n        }\n\n        cPoints[idx] = point;\n        altitudes[idx] = altitudeCache[altitude];\n        markers[idx] = geo;\n        idx++;\n      } else {\n        this._onlyHasPoint = false;\n      }\n    }\n\n    if (idx === 0) {\n      return [];\n    }\n\n    var map = this.getMap();\n    var pts = getPointsResultPts(cPoints, '_pt');\n    pts = map._pointsAtResToContainerPoints(cPoints, glRes, altitudes, pts);\n    var containerExtent = map.getContainerExtent();\n    var xmax = containerExtent.xmax,\n        ymax = containerExtent.ymax,\n        xmin = containerExtent.xmin,\n        ymin = containerExtent.ymin;\n    var extentCache = {};\n\n    for (var _i = 0, _len = markers.length; _i < _len; _i++) {\n      var _geo = markers[_i];\n      _geo._cPoint = pts[_i];\n\n      if (!_geo._cPoint) {\n        _geo._inCurrentView = false;\n        continue;\n      }\n\n      var _pts$_i = pts[_i],\n          x = _pts$_i.x,\n          y = _pts$_i.y;\n      _geo._inCurrentView = x >= xmin && y >= ymin && x <= xmax && y <= ymax;\n\n      if (!_geo._inCurrentView) {\n        var symbolkey = _geo.getSymbolHash();\n\n        var fixedExtent = void 0;\n\n        if (symbolkey) {\n          fixedExtent = extentCache[symbolkey] = extentCache[symbolkey] || _geo._painter.getFixedExtent();\n        } else {\n          fixedExtent = _geo._painter.getFixedExtent();\n        }\n\n        TEMP_FIXEDEXTENT.set(fixedExtent.xmin, fixedExtent.ymin, fixedExtent.xmax, fixedExtent.ymax);\n\n        TEMP_FIXEDEXTENT._add(pts[_i]);\n\n        _geo._inCurrentView = TEMP_FIXEDEXTENT.intersects(containerExtent);\n      }\n\n      if (_geo._inCurrentView) {\n        if (!_geo.isVisible() || !isCanvasRender) {\n          _geo._inCurrentView = false;\n        }\n\n        if (this._onlyHasPoint && _geo._inCurrentView) {\n          this._hasPoint = true;\n          _geo._isCheck = true;\n\n          this._geosToDraw.push(_geo);\n        }\n      }\n    }\n\n    return pts;\n  };\n\n  _proto._sortByDistanceToCamera = function _sortByDistanceToCamera(cameraPosition) {\n    if (!this.layer.options['sortByDistanceToCamera']) {\n      return;\n    }\n\n    if (!this._geosToDraw.length) {\n      return;\n    }\n\n    var map = this.getMap();\n    var p = map.distanceToPoint(1000, 0, map.getGLScale()).x;\n    var meterScale = p / 1000;\n    var placement = 'center';\n\n    this._geosToDraw.sort(function (a, b) {\n      var type0 = a.getType();\n      var type1 = b.getType();\n\n      if (type0 !== 'Point' || type1 !== 'Point') {\n        return 0;\n      }\n\n      var painter0 = a._painter;\n      var painter1 = b._painter;\n\n      if (!painter0 || !painter1) {\n        return 0;\n      }\n\n      var point0 = painter0.getRenderPoints(placement)[0][0];\n      var point1 = painter1.getRenderPoints(placement)[0][0];\n      var alt0 = painter0.getAltitude() * meterScale;\n      var alt1 = painter1.getAltitude() * meterScale;\n      set$2(TEMP_VEC3, point0.x, point0.y, alt0);\n      var dist0 = distance(TEMP_VEC3, cameraPosition);\n      set$2(TEMP_VEC3, point1.x, point1.y, alt1);\n      var dist1 = distance(TEMP_VEC3, cameraPosition);\n      return dist1 - dist0;\n    });\n  };\n\n  _proto._constructorIsThis = function _constructorIsThis() {\n    return this.constructor === VectorLayerRenderer;\n  };\n\n  return VectorLayerRenderer;\n}(OverlayLayerRenderer);\n\nVectorLayer.registerRenderer('canvas', VectorLayerRenderer);\n\nvar MapRenderer = function (_Class) {\n  _inheritsLoose(MapRenderer, _Class);\n\n  function MapRenderer(map) {\n    var _this;\n\n    _this = _Class.call(this) || this;\n    _this.map = map;\n    _this._handlerQueue = [];\n    return _this;\n  }\n\n  var _proto = MapRenderer.prototype;\n\n  _proto.callInNextFrame = function callInNextFrame(fn) {\n    this._handlerQueue.push(fn);\n  };\n\n  _proto.executeFrameCallbacks = function executeFrameCallbacks() {\n    var running = this._handlerQueue;\n    this._handlerQueue = [];\n\n    for (var i = 0, l = running.length; i < l; i++) {\n      running[i]();\n    }\n  };\n\n  _proto.offsetPlatform = function offsetPlatform(offset, force) {\n    if (!this.map._panels.front) {\n      return this;\n    }\n\n    if (!force && offset.x === 0 && offset.y === 0) {\n      return this;\n    }\n\n    var panels = this.map._panels;\n    var hasFront = this._frontCount = panels.back.layerDOM.childElementCount;\n    var hasBack = this._backCount = panels.front.layerDOM.childElementCount;\n    var hasUI = this._uiCount = panels.front.uiDOM.childElementCount;\n\n    if (hasFront || hasBack || hasUI) {\n      var pos = this.map.offsetPlatform();\n\n      if (offset) {\n        pos = pos.add(offset)._round();\n      } else {\n        pos = pos.round();\n      }\n\n      if (hasBack) {\n        offsetDom(panels.back, pos);\n      }\n\n      if (hasFront || hasUI) {\n        offsetDom(panels.front, pos);\n      }\n    }\n\n    return this;\n  };\n\n  _proto.domChanged = function domChanged() {\n    var panels = this.map._panels;\n\n    if (!panels.front) {\n      return false;\n    }\n\n    var frontCount = panels.back.layerDOM.childElementCount;\n\n    if (this._frontCount === undefined || this._frontCount !== frontCount) {\n      return true;\n    }\n\n    var backCount = panels.front.layerDOM.childElementCount;\n\n    if (this._backCount === undefined || this._backCount !== backCount) {\n      return true;\n    }\n\n    var uiCount = panels.front.uiDOM.childElementCount;\n\n    if (this._uiCount === undefined || this._uiCount !== uiCount) {\n      return true;\n    }\n\n    return false;\n  };\n\n  _proto.resetContainer = function resetContainer() {\n    if (!this.map) {\n      return;\n    }\n\n    this.map._resetMapViewPoint();\n\n    if (this.map._panels.front) {\n      var pos = new Point(0, 0);\n      offsetDom(this.map._panels.back, pos);\n      offsetDom(this.map._panels.front, pos);\n    }\n  };\n\n  _proto.onZoomEnd = function onZoomEnd() {\n    this.resetContainer();\n  };\n\n  _proto.onLoad = function onLoad() {\n    this._frameLoop();\n  };\n\n  return MapRenderer;\n}(Class);\n\nvar MapCanvasRenderer = function (_MapRenderer) {\n  _inheritsLoose(MapCanvasRenderer, _MapRenderer);\n\n  function MapCanvasRenderer(map) {\n    var _this;\n\n    _this = _MapRenderer.call(this, map) || this;\n    _this._containerIsCanvas = !!map._containerDOM.getContext;\n    _this._thisVisibilitychange = _this._onVisibilitychange.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n\n    _this._registerEvents();\n\n    _this._loopTime = 0;\n    return _this;\n  }\n\n  var _proto = MapCanvasRenderer.prototype;\n\n  _proto.load = function load() {\n    this.initContainer();\n  };\n\n  _proto.renderFrame = function renderFrame(framestamp) {\n    if (!this.map || !this.map.options['renderable']) {\n      return false;\n    }\n\n    this._updateDomPosition(framestamp);\n\n    delete this._isViewChanged;\n    var map = this.map;\n\n    map._fireEvent('framestart');\n\n    this.updateMapDOM();\n    map.clearCollisionIndex();\n\n    var layers = this._getAllLayerToRender();\n\n    this.drawLayers(layers, framestamp);\n    var updated = this.drawLayerCanvas(layers);\n\n    if (updated) {\n      this.drawTops();\n\n      this._drawCenterCross();\n    }\n\n    map._fireEvent('frameend');\n\n    this._recordView();\n\n    this._mapview = this._getMapView();\n    delete this._spatialRefChanged;\n\n    this._fireLayerLoadEvents();\n\n    this.executeFrameCallbacks();\n    this._canvasUpdated = false;\n    return true;\n  };\n\n  _proto.updateMapDOM = function updateMapDOM() {\n    var map = this.map;\n\n    if (map.isZooming()) {\n      return;\n    }\n\n    var offset = map._getViewPointFrameOffset();\n\n    if (offset) {\n      map.offsetPlatform(offset);\n    } else if (this.domChanged()) {\n      this.offsetPlatform(null, true);\n    }\n  };\n\n  _proto.drawLayers = function drawLayers(layers, framestamp) {\n    var map = this.map,\n        isInteracting = map.isInteracting(),\n        canvasIds = [],\n        updatedIds = [],\n        fps = map.options['fpsOnInteracting'] || 0,\n        timeLimit = fps === 0 ? 0 : 1000 / fps,\n        layerLimit = this.map.options['layerCanvasLimitOnInteracting'],\n        l = layers.length;\n    var baseLayer = map.getBaseLayer();\n    var t = 0;\n\n    for (var i = 0; i < l; i++) {\n      var layer = layers[i];\n\n      if (!layer.isVisible()) {\n        continue;\n      }\n\n      var isCanvas = layer.isCanvasRender();\n\n      if (isCanvas) {\n        canvasIds.push(layer.getId());\n      }\n\n      var renderer = layer._getRenderer();\n\n      if (!renderer) {\n        continue;\n      }\n\n      var needsRedraw = this._checkLayerRedraw(layer);\n\n      if (isCanvas && renderer.isCanvasUpdated()) {\n        if (!needsRedraw) {\n          updatedIds.push(layer.getId());\n        }\n\n        this.setLayerCanvasUpdated();\n      }\n\n      var transformMatrix = renderer.__zoomTransformMatrix;\n      delete renderer.__zoomTransformMatrix;\n\n      if (!needsRedraw) {\n        if (isCanvas && isInteracting) {\n          if (map.isZooming() && !map.getPitch()) {\n            renderer.prepareRender();\n            renderer.__zoomTransformMatrix = this._zoomMatrix;\n          } else if (map.getPitch() || map.isRotating()) {\n            renderer.clearCanvas();\n          }\n        }\n\n        continue;\n      }\n\n      if (isInteracting && isCanvas) {\n        if (layerLimit > 0 && l - 1 - i > layerLimit && layer !== baseLayer) {\n          layer._getRenderer().clearCanvas();\n\n          continue;\n        }\n\n        t += this._drawCanvasLayerOnInteracting(layer, t, timeLimit, framestamp);\n      } else if (isInteracting && renderer.drawOnInteracting) {\n        if (renderer.prepareRender) {\n          renderer.prepareRender();\n        }\n\n        if (renderer.checkAndDraw) {\n          renderer.checkAndDraw(renderer.drawOnInteracting, this._eventParam, framestamp);\n        } else {\n          renderer.drawOnInteracting(this._eventParam, framestamp);\n        }\n      } else {\n        renderer.render(framestamp);\n\n        if (isCanvas && transformMatrix && renderer.isLoadingResource()) {\n          renderer.__zoomTransformMatrix = transformMatrix;\n        }\n      }\n\n      if (isCanvas) {\n        updatedIds.push(layer.getId());\n        this.setLayerCanvasUpdated();\n      }\n    }\n\n    var preCanvasIds = this._canvasIds || [];\n    var preUpdatedIds = this._updatedIds || [];\n    this._canvasIds = canvasIds;\n    this._updatedIds = updatedIds;\n\n    if (!this.isLayerCanvasUpdated()) {\n      var sep = '---';\n\n      if (preCanvasIds.join(sep) !== canvasIds.join(sep) || preUpdatedIds.join(sep) !== updatedIds.join(sep)) {\n        this.setLayerCanvasUpdated();\n      }\n    }\n  };\n\n  _proto._checkLayerRedraw = function _checkLayerRedraw(layer) {\n    if (this.isSpatialReferenceChanged()) {\n      return true;\n    }\n\n    var map = this.map;\n\n    var renderer = layer._getRenderer();\n\n    if (layer.isCanvasRender()) {\n      return renderer.testIfNeedRedraw();\n    } else {\n      if (renderer.needToRedraw && renderer.needToRedraw()) {\n        return true;\n      }\n\n      return map.isInteracting() || this.isViewChanged();\n    }\n  };\n\n  _proto._drawCanvasLayerOnInteracting = function _drawCanvasLayerOnInteracting(layer, t, timeLimit, framestamp) {\n    var map = this.map,\n        renderer = layer._getRenderer(),\n        drawTime = renderer.getDrawTime(),\n        inTime = timeLimit === 0 || timeLimit > 0 && t + drawTime <= timeLimit;\n\n    if (renderer.mustRenderOnInteracting && renderer.mustRenderOnInteracting()) {\n      renderer.render(framestamp);\n    } else if (renderer.drawOnInteracting && (layer === map.getBaseLayer() || inTime || map.isZooming() && layer.options['forceRenderOnZooming'] || map.isMoving() && layer.options['forceRenderOnMoving'] || map.isRotating() && layer.options['forceRenderOnRotating'])) {\n      renderer.prepareRender();\n      renderer.prepareCanvas();\n\n      if (renderer.checkAndDraw) {\n        renderer.checkAndDraw(renderer.drawOnInteracting, this._eventParam, framestamp);\n      } else {\n        renderer.drawOnInteracting(this._eventParam, framestamp);\n      }\n\n      return drawTime;\n    } else if (map.isZooming() && !map.getPitch() && !map.isRotating()) {\n      renderer.prepareRender();\n      renderer.__zoomTransformMatrix = this._zoomMatrix;\n    } else if (map.getPitch() || map.isRotating()) {\n      renderer.clearCanvas();\n    }\n\n    if (renderer.drawOnInteracting && !inTime) {\n      renderer.onSkipDrawOnInteracting(this._eventParam, framestamp);\n    }\n\n    return 0;\n  };\n\n  _proto._fireLayerLoadEvents = function _fireLayerLoadEvents() {\n    if (this._updatedIds && this._updatedIds.length > 0) {\n      var map = this.map;\n\n      this._updatedIds.reverse().forEach(function (id) {\n        var layer = map.getLayer(id);\n\n        if (!layer) {\n          return;\n        }\n\n        var renderer = layer._getRenderer();\n\n        if (!renderer || !renderer.isRenderComplete()) {\n          return;\n        }\n\n        layer.fire('layerload');\n      });\n    }\n  };\n\n  _proto.isLayerCanvasUpdated = function isLayerCanvasUpdated() {\n    return this._canvasUpdated;\n  };\n\n  _proto.setLayerCanvasUpdated = function setLayerCanvasUpdated() {\n    this._canvasUpdated = true;\n  };\n\n  _proto.drawLayerCanvas = function drawLayerCanvas(layers) {\n    var map = this.map;\n\n    if (!map) {\n      return false;\n    }\n\n    if (!this.isLayerCanvasUpdated() && !this.isViewChanged()) {\n      return false;\n    }\n\n    if (!this.canvas) {\n      this.createCanvas();\n    }\n\n    map._fireEvent('renderstart', {\n      'context': this.context\n    });\n\n    if (!this._updateCanvasSize()) {\n      this.clearCanvas();\n    }\n\n    var interacting = map.isInteracting(),\n        limit = map.options['layerCanvasLimitOnInteracting'];\n    var len = layers.length;\n    var baseLayerImage;\n    var images = [];\n\n    for (var i = 0; i < len; i++) {\n      if (!layers[i].isVisible() || !layers[i].isCanvasRender()) {\n        continue;\n      }\n\n      var renderer = layers[i]._getRenderer();\n\n      if (!renderer) {\n        continue;\n      }\n\n      var layerImage = this._getLayerImage(layers[i]);\n\n      if (layerImage && layerImage['image']) {\n        if (layers[i] === map.getBaseLayer()) {\n          baseLayerImage = [layers[i], layerImage];\n        } else {\n          images.push([layers[i], layerImage]);\n        }\n      }\n    }\n\n    var targetWidth = this.canvas.width;\n    var targetHeight = this.canvas.height;\n\n    if (baseLayerImage) {\n      this._drawLayerCanvasImage(baseLayerImage[0], baseLayerImage[1], targetWidth, targetHeight);\n\n      this._drawFog();\n    }\n\n    len = images.length;\n    var start = interacting && limit >= 0 && len > limit ? len - limit : 0;\n\n    for (var _i = start; _i < len; _i++) {\n      this._drawLayerCanvasImage(images[_i][0], images[_i][1], targetWidth, targetHeight);\n    }\n\n    map._fireEvent('renderend', {\n      'context': this.context\n    });\n\n    return true;\n  };\n\n  _proto.setToRedraw = function setToRedraw() {\n    var layers = this._getAllLayerToRender();\n\n    for (var i = 0, l = layers.length; i < l; i++) {\n      var renderer = layers[i].getRenderer();\n\n      if (renderer && renderer.canvas && renderer.setToRedraw) {\n        renderer.setToRedraw();\n      }\n    }\n  };\n\n  _proto.updateMapSize = function updateMapSize(size) {\n    if (!size || this._containerIsCanvas) {\n      return;\n    }\n\n    var width = size['width'] + 'px',\n        height = size['height'] + 'px';\n    var panels = this.map._panels;\n    panels.mapWrapper.style.width = width;\n    panels.mapWrapper.style.height = height;\n\n    this._updateCanvasSize();\n  };\n\n  _proto.getMainPanel = function getMainPanel() {\n    if (!this.map) {\n      return null;\n    }\n\n    if (this._containerIsCanvas) {\n      return this.map._containerDOM;\n    }\n\n    if (this.map._panels) {\n      return this.map._panels.mapWrapper;\n    }\n\n    return null;\n  };\n\n  _proto.toDataURL = function toDataURL(mimeType, quality) {\n    if (!this.canvas) {\n      return null;\n    }\n\n    return this.canvas.toDataURL(mimeType, quality);\n  };\n\n  _proto.remove = function remove() {\n    if (Browser$1.webgl && typeof document !== 'undefined') {\n      removeDomEvent(document, 'visibilitychange', this._thisVisibilitychange, this);\n    }\n\n    if (this._resizeInterval) {\n      clearInterval(this._resizeInterval);\n    }\n\n    delete this.context;\n    delete this.canvas;\n    delete this.map;\n    delete this._spatialRefChanged;\n\n    this._cancelFrameLoop();\n  };\n\n  _proto.hitDetect = function hitDetect(point) {\n    var map = this.map;\n\n    if (!map || !map.options['hitDetect'] || map.isInteracting()) {\n      return;\n    }\n\n    var layers = map._getLayers();\n\n    var cursor = 'default';\n    var limit = map.options['hitDetectLimit'] || 0;\n    var counter = 0;\n\n    for (var i = layers.length - 1; i >= 0; i--) {\n      var layer = layers[i];\n\n      if (!layer.options['hitDetect'] || layer.isEmpty && layer.isEmpty()) {\n        continue;\n      }\n\n      var renderer = layer._getRenderer();\n\n      if (!renderer || !renderer.hitDetect) {\n        continue;\n      }\n\n      if (renderer.isBlank && renderer.isBlank()) {\n        continue;\n      }\n\n      if (layer.options['cursor'] !== 'default' && renderer.hitDetect(point)) {\n        cursor = layer.options['cursor'] || 'pointer';\n        break;\n      }\n\n      counter++;\n\n      if (limit > 0 && counter > limit) {\n        break;\n      }\n    }\n\n    map._trySetCursor(cursor);\n  };\n\n  _proto._getLayerImage = function _getLayerImage(layer) {\n    var renderer = layer._getRenderer();\n\n    if (renderer.getCanvasImage) {\n      return renderer.getCanvasImage();\n    }\n\n    return null;\n  };\n\n  _proto.initContainer = function initContainer() {\n    var panels = this.map._panels;\n\n    function createContainer(name, className, cssText, enableSelect) {\n      var c = createEl('div', className);\n\n      if (cssText) {\n        c.style.cssText = cssText;\n      }\n\n      panels[name] = c;\n\n      if (!enableSelect) {\n        preventSelection(c);\n      }\n\n      return c;\n    }\n\n    var containerDOM = this.map._containerDOM;\n\n    if (this._containerIsCanvas) {\n      return;\n    }\n\n    containerDOM.innerHTML = '';\n    var POSITION0 = 'position:absolute;top:0px;left:0px;';\n    var mapWrapper = createContainer('mapWrapper', 'maptalks-wrapper', 'position:absolute;overflow:hidden;', true),\n        mapAllLayers = createContainer('allLayers', 'maptalks-all-layers', POSITION0 + 'padding:0px;margin:0px;z-index:0;overflow:visible;', true),\n        backStatic = createContainer('backStatic', 'maptalks-back-static', POSITION0 + 'z-index:0;', true),\n        back = createContainer('back', 'maptalks-back', POSITION0 + 'z-index:1;'),\n        backLayer = createContainer('backLayer', 'maptalks-back-layer', POSITION0),\n        canvasContainer = createContainer('canvasContainer', 'maptalks-canvas-layer', POSITION0 + 'border:none;z-index:2;'),\n        frontStatic = createContainer('frontStatic', 'maptalks-front-static', POSITION0 + 'z-index:3;', true),\n        front = createContainer('front', 'maptalks-front', POSITION0 + 'z-index:4;', true),\n        frontLayer = createContainer('frontLayer', 'maptalks-front-layer', POSITION0 + 'z-index:0;'),\n        ui = createContainer('ui', 'maptalks-ui', POSITION0 + 'border:none;z-index:1;', true),\n        control = createContainer('control', 'maptalks-control', 'z-index:1', true);\n    containerDOM.appendChild(mapWrapper);\n    mapAllLayers.appendChild(backStatic);\n    back.appendChild(backLayer);\n    back.layerDOM = backLayer;\n    mapAllLayers.appendChild(back);\n    mapAllLayers.appendChild(canvasContainer);\n    front.appendChild(frontLayer);\n    front.layerDOM = frontLayer;\n    front.uiDOM = ui;\n    mapAllLayers.appendChild(frontStatic);\n    mapAllLayers.appendChild(front);\n    front.appendChild(ui);\n    mapWrapper.appendChild(mapAllLayers);\n    mapWrapper.appendChild(control);\n    this.createCanvas();\n    this.resetContainer();\n\n    var mapSize = this.map._getContainerDomSize();\n\n    this.updateMapSize(mapSize);\n  };\n\n  _proto.isViewChanged = function isViewChanged() {\n    if (this._isViewChanged !== undefined) {\n      return this._isViewChanged;\n    }\n\n    var previous = this._mapview;\n\n    var view = this._getMapView();\n\n    this._isViewChanged = !previous || !equalMapView(previous, view);\n    return this._isViewChanged;\n  };\n\n  _proto._recordView = function _recordView() {\n    var map = this.map;\n\n    if (!map._onViewChange || map.isInteracting() || map.isAnimating()) {\n      return;\n    }\n\n    if (!equalMapView(map.getView(), map._getCurrentView())) {\n      map._onViewChange(map.getView());\n    }\n  };\n\n  _proto.isSpatialReferenceChanged = function isSpatialReferenceChanged() {\n    return this._spatialRefChanged;\n  };\n\n  _proto._getMapView = function _getMapView() {\n    var map = this.map;\n\n    var center = map._getPrjCenter();\n\n    return {\n      x: center.x,\n      y: center.y,\n      zoom: map.getZoom(),\n      pitch: map.getPitch(),\n      bearing: map.getBearing(),\n      width: map.width,\n      height: map.height\n    };\n  };\n\n  _proto._frameLoop = function _frameLoop(framestamp) {\n    var _this2 = this;\n\n    if (!this.map) {\n      this._cancelFrameLoop();\n\n      return;\n    }\n\n    framestamp = framestamp || 0;\n    this._frameTimestamp = framestamp;\n    this._resizeCount = 0;\n    this.renderFrame(framestamp);\n    getGlobalWorkerPool().commit();\n    this._animationFrame = requestAnimFrame(function (framestamp) {\n      _this2._frameLoop(framestamp);\n    });\n  };\n\n  _proto._cancelFrameLoop = function _cancelFrameLoop() {\n    if (this._animationFrame) {\n      cancelAnimFrame(this._animationFrame);\n    }\n  };\n\n  _proto._drawLayerCanvasImage = function _drawLayerCanvasImage(layer, layerImage, targetWidth, targetHeight) {\n    var ctx = this.context;\n    var point = layerImage['point'].round();\n    var dpr = this.map.getDevicePixelRatio();\n\n    if (dpr !== 1) {\n      point._multi(dpr);\n    }\n\n    var canvasImage = layerImage['image'];\n    var width = canvasImage.width,\n        height = canvasImage.height;\n\n    if (point.x + width <= 0 || point.y + height <= 0) {\n      return;\n    }\n\n    var op = layer.options['opacity'];\n\n    if (!isNumber(op)) {\n      op = 1;\n    }\n\n    if (op <= 0) {\n      return;\n    }\n\n    var imgOp = layerImage['opacity'];\n\n    if (!isNumber(imgOp)) {\n      imgOp = 1;\n    }\n\n    if (imgOp <= 0) {\n      return;\n    }\n\n    var alpha = ctx.globalAlpha;\n\n    if (op < 1) {\n      ctx.globalAlpha *= op;\n    }\n\n    if (imgOp < 1) {\n      ctx.globalAlpha *= imgOp;\n    }\n\n    if (layer.options['cssFilter']) {\n      ctx.filter = layer.options['cssFilter'];\n    }\n\n    var renderer = layer.getRenderer();\n    var matrix = renderer.__zoomTransformMatrix;\n    var clipped = renderer.clipCanvas(this.context);\n\n    if (matrix) {\n      ctx.save();\n      ctx.setTransform.apply(ctx, matrix);\n    }\n\n    ctx.drawImage(canvasImage, 0, 0, width, height, point.x, point.y, targetWidth, targetHeight);\n\n    if (matrix) {\n      ctx.restore();\n    }\n\n    if (clipped) {\n      ctx.restore();\n    }\n\n    if (ctx.filter !== 'none') {\n      ctx.filter = 'none';\n    }\n\n    ctx.globalAlpha = alpha;\n  };\n\n  _proto._drawCenterCross = function _drawCenterCross() {\n    var cross = this.map.options['centerCross'];\n\n    if (cross) {\n      var ctx = this.context;\n      var p = new Point(this.canvas.width / 2, this.canvas.height / 2);\n\n      if (isFunction(cross)) {\n        cross(ctx, p);\n      } else {\n        Canvas.drawCross(this.context, p.x, p.y, 2, '#f00');\n      }\n    }\n  };\n\n  _proto._drawContainerExtent = function _drawContainerExtent() {\n    var cascadePitches = this.map.options.cascadePitches;\n\n    var h30 = this.map.height - this.map._getVisualHeight(cascadePitches[0]);\n\n    var h60 = this.map.height - this.map._getVisualHeight(cascadePitches[1]);\n\n    var extent = this.map.getContainerExtent();\n    var ctx = this.context;\n    ctx.beginPath();\n    ctx.moveTo(0, extent.ymin);\n    ctx.lineTo(extent.xmax, extent.ymin);\n    ctx.stroke();\n    ctx.beginPath();\n    ctx.moveTo(0, h30);\n    ctx.lineTo(extent.xmax, h30);\n    ctx.stroke();\n    ctx.beginPath();\n    ctx.moveTo(0, h60);\n    ctx.lineTo(extent.xmax, h60);\n    ctx.stroke();\n  };\n\n  _proto._drawFog = function _drawFog() {\n    var map = this.map;\n\n    if (map.getPitch() <= map.options['maxVisualPitch'] || !map.options['fog']) {\n      return;\n    }\n\n    var fogThickness = 30;\n    var r = map.getDevicePixelRatio();\n    var ctx = this.context,\n        clipExtent = map.getContainerExtent();\n    var top = (map.height - map._getVisualHeight(75)) * r;\n    if (top < 0) top = 0;\n    var bottom = clipExtent.ymin * r,\n        h = Math.ceil(bottom - top),\n        color = map.options['fogColor'].join();\n    var gradient = ctx.createLinearGradient(0, top, 0, bottom + fogThickness);\n    var landscape = 1 - fogThickness / (h + fogThickness);\n    gradient.addColorStop(0, \"rgba(\" + color + \", 0)\");\n    gradient.addColorStop(0.3, \"rgba(\" + color + \", 0.3)\");\n    gradient.addColorStop(landscape, \"rgba(\" + color + \", 1)\");\n    gradient.addColorStop(1, \"rgba(\" + color + \", 0)\");\n    ctx.beginPath();\n    ctx.fillStyle = gradient;\n    ctx.fillRect(0, top, Math.ceil(clipExtent.getWidth()) * r, Math.ceil(h + fogThickness));\n  };\n\n  _proto._getAllLayerToRender = function _getAllLayerToRender() {\n    return this.map._getLayers();\n  };\n\n  _proto.clearCanvas = function clearCanvas() {\n    if (!this.canvas) {\n      return;\n    }\n\n    Canvas.clearRect(this.context, 0, 0, this.canvas.width, this.canvas.height);\n  };\n\n  _proto._updateCanvasSize = function _updateCanvasSize() {\n    if (!this.canvas || this._containerIsCanvas) {\n      return false;\n    }\n\n    var map = this.map,\n        mapSize = map.getSize(),\n        canvas = this.canvas,\n        r = map.getDevicePixelRatio();\n\n    var _calCanvasSize = calCanvasSize(mapSize, r),\n        width = _calCanvasSize.width,\n        height = _calCanvasSize.height,\n        cssWidth = _calCanvasSize.cssWidth,\n        cssHeight = _calCanvasSize.cssHeight;\n\n    if (canvas.style && (canvas.style.width !== cssWidth || canvas.style.height !== cssHeight)) {\n      canvas.style.width = cssWidth;\n      canvas.style.height = cssHeight;\n    }\n\n    if (width === canvas.width && height === canvas.height) {\n      return false;\n    }\n\n    canvas.height = height;\n    canvas.width = width;\n    this.topLayer.width = canvas.width;\n    this.topLayer.height = canvas.height;\n    return true;\n  };\n\n  _proto.createCanvas = function createCanvas() {\n    this.topLayer = createEl('canvas');\n    this.topCtx = this.topLayer.getContext('2d');\n\n    if (this._containerIsCanvas) {\n      this.canvas = this.map._containerDOM;\n    } else {\n      this.canvas = createEl('canvas');\n\n      this._updateCanvasSize();\n\n      this.map._panels.canvasContainer.appendChild(this.canvas);\n    }\n\n    this.context = this.canvas.getContext('2d');\n  };\n\n  _proto._updateDomPosition = function _updateDomPosition(framestamp) {\n    if (this._checkPositionTime === undefined) {\n      this._checkPositionTime = -Infinity;\n    }\n\n    var dTime = Math.abs(framestamp - this._checkPositionTime);\n\n    if (dTime >= 500) {\n      computeDomPosition(this.map._containerDOM);\n      this._checkPositionTime = Math.min(framestamp, this._checkPositionTime);\n    }\n\n    return this;\n  };\n\n  _proto._checkSize = function _checkSize() {\n    if (!this.map) {\n      return;\n    }\n\n    this.map.checkSize();\n  };\n\n  _proto._setCheckSizeInterval = function _setCheckSizeInterval(interval) {\n    var _this3 = this;\n\n    if (Browser$1.resizeObserver) {\n      if (this._resizeObserver) {\n        this._resizeObserver.disconnect();\n      }\n\n      if (this.map) {\n        this._resizeObserver = new ResizeObserver(function (entries) {\n          if (!_this3.map || _this3.map.isRemoved()) {\n            _this3._resizeObserver.disconnect();\n          } else if (entries.length) {\n            _this3.map._containerDomContentRect = entries[0].contentRect;\n\n            _this3._checkSize(entries[0].contentRect);\n\n            _this3._resizeCount = _this3._resizeCount || 0;\n\n            _this3.renderFrame((_this3._frameTimestamp || 0) + ++_this3._resizeCount / 100);\n          }\n        });\n\n        this._resizeObserver.observe(this.map._containerDOM);\n      }\n    } else {\n      clearInterval(this._resizeInterval);\n      this._checkSizeInterval = interval;\n      this._resizeInterval = setInterval(function () {\n        if (!_this3.map || _this3.map.isRemoved()) {\n          clearInterval(_this3._resizeInterval);\n        } else {\n          _this3._checkSize();\n        }\n      }, this._checkSizeInterval);\n    }\n  };\n\n  _proto._registerEvents = function _registerEvents() {\n    var _this4 = this;\n\n    var map = this.map;\n\n    if (map.options['checkSize'] && !IS_NODE && typeof window !== 'undefined') {\n      this._setCheckSizeInterval(map.options['checkSizeInterval']);\n    }\n\n    if (!Browser$1.mobile) {\n      map.on('_mousemove', this._onMapMouseMove, this);\n    }\n\n    map.on('_dragrotatestart _dragrotating _dragrotateend _movestart _moving _moveend _zoomstart', function (param) {\n      _this4._eventParam = param;\n    });\n    map.on('_zooming', function (param) {\n      if (!map.getPitch()) {\n        _this4._zoomMatrix = param['matrix']['container'];\n      }\n\n      _this4._eventParam = param;\n    });\n    map.on('_zoomend', function (param) {\n      _this4._eventParam = param;\n      delete _this4._zoomMatrix;\n    });\n    map.on('_spatialreferencechange', function () {\n      _this4._spatialRefChanged = true;\n    });\n\n    if (Browser$1.webgl && typeof document !== 'undefined') {\n      addDomEvent(document, 'visibilitychange', this._thisVisibilitychange, this);\n    }\n\n    if (Browser$1.addDPRListening) {\n      Browser$1.addDPRListening(this.map);\n    }\n  };\n\n  _proto._onMapMouseMove = function _onMapMouseMove(param) {\n    var _this5 = this;\n\n    var map = this.map;\n\n    if (map.isInteracting() || !map.options['hitDetect']) {\n      return;\n    }\n\n    if (this._hitDetectFrame) {\n      cancelAnimFrame(this._hitDetectFrame);\n    }\n\n    this._hitDetectFrame = requestAnimFrame(function () {\n      _this5.hitDetect(param['containerPoint']);\n    });\n  };\n\n  _proto._getCanvasLayers = function _getCanvasLayers() {\n    return this.map._getLayers(function (layer) {\n      return layer.isCanvasRender();\n    });\n  };\n\n  _proto._onVisibilitychange = function _onVisibilitychange() {\n    if (document.visibilityState !== 'visible') {\n      return;\n    }\n\n    this.setToRedraw();\n  };\n\n  _proto.addTopElement = function addTopElement(e) {\n    if (!this._tops) {\n      this._tops = [];\n    }\n\n    this._tops.push(e);\n  };\n\n  _proto.removeTopElement = function removeTopElement(e) {\n    if (!this._tops) {\n      return;\n    }\n\n    var idx = this._tops.indexOf(e);\n\n    if (idx >= 0) {\n      this._tops.splice(idx, 1);\n    }\n  };\n\n  _proto.getTopElements = function getTopElements() {\n    return this._tops || [];\n  };\n\n  _proto.drawTops = function drawTops() {\n    this.topCtx.clearRect(0, 0, this.topLayer.width, this.topLayer.height);\n    this.map.fire('drawtopstart');\n    this.map.fire('drawtops');\n    var tops = this.getTopElements();\n    var updated = false;\n\n    for (var i = 0; i < tops.length; i++) {\n      if (tops[i].render(this.topCtx)) {\n        updated = true;\n      }\n    }\n\n    if (updated) {\n      this.context.drawImage(this.topLayer, 0, 0);\n    }\n\n    this.map.fire('drawtopsend');\n  };\n\n  return MapCanvasRenderer;\n}(MapRenderer);\n\nMap$1.registerRenderer('canvas', MapCanvasRenderer);\nMap$1.mergeOptions({\n  'fog': false,\n  'fogColor': [233, 233, 233]\n});\n\n\n\nvar index$6 = /*#__PURE__*/Object.freeze({\n  ResourceCache: ResourceCache,\n  CanvasRenderer: CanvasRenderer,\n  ImageGLRenderable: ImageGLRenderable,\n  MapRenderer: MapRenderer,\n  MapCanvasRenderer: MapCanvasRenderer,\n  Renderable: Renderable,\n  ImageLayerCanvasRenderer: ImageLayerCanvasRenderer,\n  ImageLayerGLRenderer: ImageLayerGLRenderer,\n  TileLayerCanvasRenderer: TileLayerCanvasRenderer,\n  TileLayerGLRenderer: TileLayerGLRenderer,\n  CanvasTileLayerCanvasRenderer: CanvasRenderer$1,\n  CanvasTileLayerGLRenderer: GLRenderer,\n  QuadStencil: QuadStencil,\n  OverlayLayerCanvasRenderer: OverlayLayerRenderer,\n  VectorLayerCanvasRenderer: VectorLayerRenderer,\n  CanvasLayerRenderer: CanvasLayerRenderer\n});\n\nvar CenterPointRenderer = {\n  _getRenderPoints: function _getRenderPoints() {\n    return [[this._getCenter2DPoint(this.getMap().getGLRes())], null];\n  }\n};\nMarker.include(CenterPointRenderer);\nEllipse.include(CenterPointRenderer);\nCircle.include(CenterPointRenderer);\nSector.include(CenterPointRenderer);\nRectangle.include({\n  _getRenderPoints: function _getRenderPoints(placement) {\n    var map = this.getMap();\n    var glRes = map.getGLRes();\n\n    if (placement === 'vertex') {\n      var shell = this._trimRing(this.getShell());\n\n      var points = [];\n\n      for (var i = 0, len = shell.length; i < len; i++) {\n        points.push(map.coordToPointAtRes(shell[i], glRes));\n      }\n\n      return [points, null];\n    } else {\n      var c = map.coordToPointAtRes(this.getCenter(), glRes);\n      return [[c], null];\n    }\n  }\n});\nvar PolyRenderer = {\n  _getRenderPoints: function _getRenderPoints(placement) {\n    var map = this.getMap();\n    var glRes = map.getGLRes();\n    var points,\n        rotations = null;\n\n    if (placement === 'point') {\n      points = this._getPath2DPoints(this._getPrjCoordinates(), false, glRes);\n\n      if (points && points.length > 0 && Array.isArray(points[0])) {\n        points = points[0].concat(points[1]);\n      }\n    } else if (placement === 'vertex') {\n      points = this._getPath2DPoints(this._getPrjCoordinates(), false, glRes);\n      rotations = [];\n\n      if (points && points.length > 0 && Array.isArray(points[0])) {\n        for (var i = 0, l = points.length; i < l; i++) {\n          for (var ii = 0, ll = points[i].length; ii < ll; ii++) {\n            if (ii === 0) {\n              rotations.push([points[i][ii], points[i][ii + 1]]);\n            } else {\n              rotations.push([points[i][ii - 1], points[i][ii]]);\n            }\n          }\n        }\n\n        points = points[0].concat(points[1]);\n      } else {\n        for (var _i = 0, _l = points.length; _i < _l; _i++) {\n          if (_i === 0) {\n            rotations.push([points[_i], points[_i + 1]]);\n          } else {\n            rotations.push([points[_i - 1], points[_i]]);\n          }\n        }\n      }\n    } else if (placement === 'line') {\n      points = [];\n      rotations = [];\n\n      var vertice = this._getPath2DPoints(this._getPrjCoordinates(), false, glRes),\n          isSplitted = vertice.length > 0 && Array.isArray(vertice[0]);\n\n      if (isSplitted) {\n        var ring;\n\n        for (var _i2 = 1, _l2 = vertice.length; _i2 < _l2; _i2++) {\n          ring = vertice[_i2];\n\n          if (this instanceof Polygon && ring.length > 0 && !ring[0].equals(ring[ring.length - 1])) {\n            ring.push(ring[0]);\n          }\n\n          for (var _ii = 1, _ll = ring.length; _ii < _ll; _ii++) {\n            points.push(ring[_ii].add(ring[_ii - 1])._multi(0.5));\n            rotations.push([ring[_ii - 1], ring[_ii]]);\n          }\n        }\n      } else {\n        if (this instanceof Polygon && vertice.length > 0 && !vertice[0].equals(vertice[vertice.length - 1])) {\n          vertice.push(vertice[0]);\n        }\n\n        for (var _i3 = 1, _l3 = vertice.length; _i3 < _l3; _i3++) {\n          points.push(vertice[_i3].add(vertice[_i3 - 1])._multi(0.5));\n          rotations.push([vertice[_i3 - 1], vertice[_i3]]);\n        }\n      }\n    } else if (placement === 'vertex-first') {\n      var coords = this._getPrjCoordinates();\n\n      var _l4 = coords.length;\n      var point0 = _l4 ? map._prjToPointAtRes(coords[0], glRes) : null;\n      points = _l4 ? [point0] : [];\n      rotations = _l4 ? [[point0, coords[1] ? map._prjToPointAtRes(coords[1], glRes) : point0]] : [];\n    } else if (placement === 'vertex-last') {\n      var _coords = this._getPrjCoordinates();\n\n      var _l5 = _coords.length;\n      var curretPoint = _l5 ? map._prjToPointAtRes(_coords[_l5 - 1], glRes) : null;\n      points = _l5 ? [curretPoint] : [];\n      var previous = _l5 > 1 ? _l5 - 2 : _l5 - 1;\n      rotations = _l5 ? [[_coords[previous] ? map._prjToPointAtRes(_coords[previous], glRes) : curretPoint, curretPoint]] : [];\n    } else {\n      var pcenter = this._getProjection().project(this.getCenter());\n\n      points = [map._prjToPointAtRes(pcenter, glRes)];\n    }\n\n    return [points, rotations];\n  }\n};\nLineString.include(PolyRenderer);\nPolygon.include(PolyRenderer);\n\nvar TEMP_WITHIN = {\n  within: false,\n  center: [0, 0]\n};\n\nfunction isWithinPixel(painter) {\n  if (!painter || !painter._containerBbox) {\n    TEMP_WITHIN.within = false;\n  } else {\n    TEMP_WITHIN.within = false;\n    var _painter$_containerBb = painter._containerBbox,\n        minx = _painter$_containerBb.minx,\n        miny = _painter$_containerBb.miny,\n        maxx = _painter$_containerBb.maxx,\n        maxy = _painter$_containerBb.maxy;\n    var offsetx = Math.abs(maxx - minx);\n    var offsety = Math.abs(maxy - miny);\n\n    if (offsetx <= 1 && offsety <= 1) {\n      TEMP_WITHIN.within = true;\n      TEMP_WITHIN.center[0] = (minx + maxx) / 2;\n      TEMP_WITHIN.center[1] = (miny + maxy) / 2;\n    }\n\n    delete painter._containerBbox;\n  }\n\n  return TEMP_WITHIN;\n}\n\nGeometry.include({\n  _redrawWhenPitch: function _redrawWhenPitch() {\n    return false;\n  },\n  _redrawWhenRotate: function _redrawWhenRotate() {\n    return false;\n  }\n});\nvar el = {\n  _redrawWhenPitch: function _redrawWhenPitch() {\n    return true;\n  },\n  _redrawWhenRotate: function _redrawWhenRotate() {\n    return this instanceof Ellipse || this instanceof Sector;\n  },\n  _paintAsPath: function _paintAsPath() {\n    var map = this.getMap();\n    var altitude = this.getAltitude();\n    return altitude > 0 || map.getPitch() || this instanceof Ellipse && map.getBearing();\n  },\n  _getPaintParams: function _getPaintParams() {\n    var map = this.getMap();\n\n    if (this._paintAsPath()) {\n      return Polygon.prototype._getPaintParams.call(this, true);\n    }\n\n    var pcenter = this._getPrjCoordinates();\n\n    var pt = map._prjToPointAtRes(pcenter, map.getGLRes());\n\n    var size = this._getRenderSize(pt);\n\n    return [pt].concat(size);\n  },\n  _paintOn: function _paintOn() {\n    if (this._paintAsPath()) {\n      return Canvas.polygon.apply(Canvas, arguments);\n    } else {\n      return Canvas.ellipse.apply(Canvas, arguments);\n    }\n  },\n  _getRenderSize: function _getRenderSize(pt) {\n    var map = this.getMap(),\n        glRes = map.getGLRes();\n\n    var prjExtent = this._getPrjExtent();\n\n    var pmin = map._prjToPointAtRes(prjExtent.getMin(), glRes),\n        pmax = map._prjToPointAtRes(prjExtent.getMax(), glRes);\n\n    return [Math.abs(pmax.x - pmin.x) / 2, Math.abs(pmax.y - pt.y), Math.abs(pt.y - pmin.y)];\n  }\n};\nEllipse.include(el);\nCircle.include(el);\nRectangle.include({\n  _getPaintParams: function _getPaintParams() {\n    var map = this.getMap();\n\n    var shell = this._getPrjShell();\n\n    var points = this._getPath2DPoints(shell, false, map.getGLRes());\n\n    return [points];\n  },\n  _paintOn: Canvas.polygon\n});\nSector.include(el, {\n  _redrawWhenPitch: function _redrawWhenPitch() {\n    return true;\n  },\n  _getPaintParams: function _getPaintParams() {\n    if (this._paintAsPath()) {\n      return Polygon.prototype._getPaintParams.call(this, true);\n    }\n\n    var map = this.getMap();\n\n    var pt = map._prjToPointAtRes(this._getPrjCoordinates(), map.getGLRes());\n\n    var size = this._getRenderSize(pt);\n\n    return [pt, size[0], [this.getStartAngle(), this.getEndAngle()]];\n  },\n  _paintOn: function _paintOn() {\n    if (this._paintAsPath()) {\n      return Canvas.polygon.apply(Canvas, arguments);\n    } else {\n      var r = this.getMap().getBearing();\n      var args = arguments;\n\n      if (r) {\n        args[3] = args[3].slice(0);\n        args[3][0] += r;\n        args[3][1] += r;\n      }\n\n      return Canvas.sector.apply(Canvas, args);\n    }\n  }\n});\nPath.include({\n  _paintAsPath: function _paintAsPath() {\n    return true;\n  }\n});\nLineString.include({\n  arrowStyles: {\n    'classic': [3, 4]\n  },\n  _getArrowShape: function _getArrowShape(prePoint, point, lineWidth, arrowStyle, tolerance) {\n    if (!prePoint || !point || prePoint.equals(point)) {\n      return null;\n    }\n\n    if (!tolerance) {\n      tolerance = 0;\n    }\n\n    var width = lineWidth * arrowStyle[0],\n        height = lineWidth * arrowStyle[1] + tolerance,\n        hw = width / 2 + tolerance;\n    var normal;\n\n    if (point.nextCtrlPoint || point.prevCtrlPoint) {\n      if (point.prevCtrlPoint) {\n        normal = point.sub(new Point(point.prevCtrlPoint));\n      } else {\n        normal = point.sub(new Point(point.nextCtrlPoint));\n      }\n    } else {\n      normal = point.sub(prePoint);\n    }\n\n    normal._unit();\n\n    var p1 = point.sub(normal.multi(height));\n\n    normal._perp();\n\n    var p0 = p1.add(normal.multi(hw));\n\n    normal._multi(-1);\n\n    var p2 = p1.add(normal.multi(hw));\n    return [p0, point, p2, p0];\n  },\n  _getPaintParams: function _getPaintParams() {\n    var prjVertexes = this._getPrjCoordinates();\n\n    var points = this._getPath2DPoints(prjVertexes, false, this.getMap().getGLRes());\n\n    return [points];\n  },\n  _paintOn: function _paintOn(ctx, points, lineOpacity, fillOpacity, dasharray) {\n    var r = isWithinPixel(this._painter);\n\n    if (r.within) {\n      Canvas.pixelRect(ctx, r.center, lineOpacity, fillOpacity);\n    } else if (this.options['smoothness']) {\n      Canvas.paintSmoothLine(ctx, points, lineOpacity, this.options['smoothness'], false, this._animIdx, this._animTailRatio);\n    } else {\n      Canvas.path(ctx, points, lineOpacity, null, dasharray);\n    }\n\n    this._paintArrow(ctx, points, lineOpacity);\n  },\n  _getArrowPlacement: function _getArrowPlacement() {\n    return this.options['arrowPlacement'];\n  },\n  _getArrowStyle: function _getArrowStyle() {\n    var arrowStyle = this.options['arrowStyle'];\n\n    if (arrowStyle) {\n      return Array.isArray(arrowStyle) ? arrowStyle : this.arrowStyles[arrowStyle];\n    }\n\n    return null;\n  },\n  _getArrows: function _getArrows(points, lineWidth, tolerance) {\n    var arrowStyle = this._getArrowStyle();\n\n    if (!arrowStyle || points.length < 2) {\n      return [];\n    }\n\n    var isSplitted = points.length > 0 && Array.isArray(points[0]);\n    var segments = isSplitted ? points : [points];\n\n    var placement = this._getArrowPlacement();\n\n    var arrows = [];\n    var map = this.getMap(),\n        first = map.coordToContainerPoint(this.getFirstCoordinate()),\n        last = map.coordToContainerPoint(this.getLastCoordinate());\n\n    for (var i = segments.length - 1; i >= 0; i--) {\n      if (placement === 'vertex-first' || placement === 'vertex-firstlast' && segments[i][0].closeTo(first, 0.01)) {\n        var arrow = this._getArrowShape(segments[i][1], segments[i][0], lineWidth, arrowStyle, tolerance);\n\n        if (arrow) {\n          arrows.push(arrow);\n        }\n      }\n\n      if (placement === 'vertex-last' || placement === 'vertex-firstlast' && segments[i][segments[i].length - 1].closeTo(last, 0.01)) {\n        var _arrow = this._getArrowShape(segments[i][segments[i].length - 2], segments[i][segments[i].length - 1], lineWidth, arrowStyle, tolerance);\n\n        if (_arrow) {\n          arrows.push(_arrow);\n        }\n      } else if (placement === 'point') {\n        this._getArrowPoints(arrows, segments[i], lineWidth, arrowStyle, tolerance);\n      }\n    }\n\n    return arrows;\n  },\n  _getArrowPoints: function _getArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance) {\n    for (var ii = 0, ll = segments.length - 1; ii < ll; ii++) {\n      var arrow = this._getArrowShape(segments[ii], segments[ii + 1], lineWidth, arrowStyle, tolerance);\n\n      if (arrow) {\n        arrows.push(arrow);\n      }\n    }\n  },\n  _paintArrow: function _paintArrow(ctx, points, lineOpacity) {\n    var lineWidth = this._getInternalSymbol()['lineWidth'];\n\n    if (!isNumber(lineWidth) || lineWidth < 3) {\n      lineWidth = 3;\n    }\n\n    var arrows = this._getArrows(points, lineWidth);\n\n    if (!arrows.length) {\n      return;\n    }\n\n    if (ctx.setLineDash) {\n      ctx.setLineDash([]);\n    }\n\n    for (var i = arrows.length - 1; i >= 0; i--) {\n      ctx.fillStyle = ctx.strokeStyle;\n      Canvas.polygon(ctx, arrows[i], lineOpacity, lineOpacity);\n    }\n  }\n});\nPolygon.include({\n  _getPaintParams: function _getPaintParams(disableSimplify) {\n    var glRes = this.getMap().getGLRes();\n\n    var prjVertexes = this._getPrjShell();\n\n    var points = this._getPath2DPoints(prjVertexes, disableSimplify, glRes);\n\n    var isSplitted = points.length > 0 && Array.isArray(points[0]);\n\n    if (isSplitted) {\n      points = [[points[0]], [points[1]]];\n    }\n\n    var prjHoles = this._getPrjHoles();\n\n    var holePoints = [];\n\n    if (prjHoles && prjHoles.length > 0) {\n      var simplified = this._simplified;\n\n      for (var i = 0; i < prjHoles.length; i++) {\n        var hole = this._getPath2DPoints(prjHoles[i], disableSimplify, glRes);\n\n        if (Array.isArray(hole) && isSplitted) {\n          if (Array.isArray(hole[0])) {\n            points[0].push(hole[0]);\n            points[1].push(hole[1]);\n          } else {\n            points[0].push(hole);\n          }\n        } else {\n          holePoints.push(hole);\n        }\n      }\n\n      if (simplified) {\n        this._simplified = simplified;\n      }\n    }\n\n    if (!isSplitted) {\n      points = [points];\n      pushIn(points, holePoints);\n    }\n\n    return [points];\n  },\n  _paintOn: function _paintOn(ctx, points, lineOpacity, fillOpacity, dasharray) {\n    var r = isWithinPixel(this._painter);\n\n    if (r.within) {\n      Canvas.pixelRect(ctx, r.center, lineOpacity, fillOpacity);\n    } else {\n      Canvas.polygon(ctx, points, lineOpacity, fillOpacity, dasharray, this.options['smoothness']);\n    }\n  }\n});\n\nMap$1.VERSION = version;\nvar worker = {\n  Actor: Actor\n};\n\nexport { index$1 as Util, dom as DomUtil, strings as StringUtil, index as MapboxUtil, Map$1 as Map, index$4 as ui, index$5 as control, index$6 as renderer, index$3 as symbolizer, Animation$1 as animation, worker, Browser$1 as Browser, LRUCache, Ajax, Canvas, Promise$1 as Promise, Class, Eventable, JSONAble, CollisionIndex, Handlerable, Handler$1 as Handler, DragHandler, MapTool, DrawTool, AreaTool, DistanceTool, SpatialReference, registerWorkerAdapter, INTERNAL_LAYER_PREFIX, GEOMETRY_COLLECTION_TYPES, GEOJSON_TYPES, RESOURCE_PROPERTIES, RESOURCE_SIZE_PROPERTIES, NUMERICAL_PROPERTIES, COLOR_PROPERTIES, DEFAULT_TEXT_SIZE, projections as projection, index$2 as measurer, Coordinate, CRS, Extent, Point, PointExtent, Size, Transformation, Layer, TileLayer, GroupTileLayer, WMSTileLayer, CanvasTileLayer, ImageLayer, OverlayLayer, VectorLayer, CanvasLayer, ParticleLayer, TileSystem, TileConfig, ArcCurve, Circle, ConnectorLine, ArcConnectorLine, CubicBezierCurve, Curve, Ellipse, GeoJSON, Geometry, GeometryCollection, Label, LineString, Marker, MultiLineString, MultiPoint, MultiPolygon, Polygon, QuadBezierCurve, Rectangle, Sector, TextBox, TextMarker };\n","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  Object.defineProperty(subClass, \"prototype\", {\n    writable: false\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}","export default function _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}","export default function _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}","export default function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}","export default function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}","import _typeof from \"./typeof.js\";\nimport assertThisInitialized from \"./assertThisInitialized.js\";\nexport default function _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n\n  return assertThisInitialized(self);\n}","import getPrototypeOf from \"./getPrototypeOf.js\";\nimport isNativeReflectConstruct from \"./isNativeReflectConstruct.js\";\nimport possibleConstructorReturn from \"./possibleConstructorReturn.js\";\nexport default function _createSuper(Derived) {\n  var hasNativeReflectConstruct = isNativeReflectConstruct();\n  return function _createSuperInternal() {\n    var Super = getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = getPrototypeOf(this).constructor;\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return possibleConstructorReturn(this, result);\n  };\n}","var $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar toObject = require('../internals/to-object');\nvar nativeGetPrototypeOf = require('../internals/object-get-prototype-of');\nvar CORRECT_PROTOTYPE_GETTER = require('../internals/correct-prototype-getter');\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeGetPrototypeOf(1); });\n\n// `Object.getPrototypeOf` method\n// https://tc39.es/ecma262/#sec-object.getprototypeof\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES, sham: !CORRECT_PROTOTYPE_GETTER }, {\n  getPrototypeOf: function getPrototypeOf(it) {\n    return nativeGetPrototypeOf(toObject(it));\n  }\n});\n\n","exports.nextTick = function nextTick(fn) {\n    var args = Array.prototype.slice.call(arguments);\n    args.shift();\n    setTimeout(function () {\n        fn.apply(null, args);\n    }, 0);\n};\n\nexports.platform = exports.arch = \nexports.execPath = exports.title = 'browser';\nexports.pid = 1;\nexports.browser = true;\nexports.env = {};\nexports.argv = [];\n\nexports.binding = function (name) {\n\tthrow new Error('No such module. (Possibly not yet loaded)')\n};\n\n(function () {\n    var cwd = '/';\n    var path;\n    exports.cwd = function () { return cwd };\n    exports.chdir = function (dir) {\n        if (!path) path = require('path');\n        cwd = path.resolve(dir, cwd);\n    };\n})();\n\nexports.exit = exports.kill = \nexports.umask = exports.dlopen = \nexports.uptime = exports.memoryUsage = \nexports.uvCounters = function() {};\nexports.features = {};\n","var $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar apply = require('../internals/function-apply');\nvar bind = require('../internals/function-bind');\nvar aConstructor = require('../internals/a-constructor');\nvar anObject = require('../internals/an-object');\nvar isObject = require('../internals/is-object');\nvar create = require('../internals/object-create');\nvar fails = require('../internals/fails');\n\nvar nativeConstruct = getBuiltIn('Reflect', 'construct');\nvar ObjectPrototype = Object.prototype;\nvar push = [].push;\n\n// `Reflect.construct` method\n// https://tc39.es/ecma262/#sec-reflect.construct\n// MS Edge supports only 2 arguments and argumentsList argument is optional\n// FF Nightly sets third argument as `new.target`, but does not create `this` from it\nvar NEW_TARGET_BUG = fails(function () {\n  function F() { /* empty */ }\n  return !(nativeConstruct(function () { /* empty */ }, [], F) instanceof F);\n});\n\nvar ARGS_BUG = !fails(function () {\n  nativeConstruct(function () { /* empty */ });\n});\n\nvar FORCED = NEW_TARGET_BUG || ARGS_BUG;\n\n$({ target: 'Reflect', stat: true, forced: FORCED, sham: FORCED }, {\n  construct: function construct(Target, args /* , newTarget */) {\n    aConstructor(Target);\n    anObject(args);\n    var newTarget = arguments.length < 3 ? Target : aConstructor(arguments[2]);\n    if (ARGS_BUG && !NEW_TARGET_BUG) return nativeConstruct(Target, args, newTarget);\n    if (Target == newTarget) {\n      // w/o altered newTarget, optimization for 0-4 arguments\n      switch (args.length) {\n        case 0: return new Target();\n        case 1: return new Target(args[0]);\n        case 2: return new Target(args[0], args[1]);\n        case 3: return new Target(args[0], args[1], args[2]);\n        case 4: return new Target(args[0], args[1], args[2], args[3]);\n      }\n      // w/o altered newTarget, lot of arguments case\n      var $args = [null];\n      apply(push, $args, args);\n      return new (apply(bind, Target, $args))();\n    }\n    // with altered newTarget, not support built-in constructors\n    var proto = newTarget.prototype;\n    var instance = create(isObject(proto) ? proto : ObjectPrototype);\n    var result = apply(Target, instance, args);\n    return isObject(result) ? result : instance;\n  }\n});\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./city-shanghai.vue?vue&type=style&index=1&lang=scss&\"","/*\n (c) 2017, Vladimir Agafonkin\n Simplify.js, a high-performance JS polyline simplification library\n mourner.github.io/simplify-js\n*/\n\n(function () { 'use strict';\n\n// to suit your point format, run search/replace for '.x' and '.y';\n// for 3D version, see 3d branch (configurability would draw significant performance overhead)\n\n// square distance between 2 points\nfunction getSqDist(p1, p2) {\n\n    var dx = p1.x - p2.x,\n        dy = p1.y - p2.y;\n\n    return dx * dx + dy * dy;\n}\n\n// square distance from a point to a segment\nfunction getSqSegDist(p, p1, p2) {\n\n    var x = p1.x,\n        y = p1.y,\n        dx = p2.x - x,\n        dy = p2.y - y;\n\n    if (dx !== 0 || dy !== 0) {\n\n        var t = ((p.x - x) * dx + (p.y - y) * dy) / (dx * dx + dy * dy);\n\n        if (t > 1) {\n            x = p2.x;\n            y = p2.y;\n\n        } else if (t > 0) {\n            x += dx * t;\n            y += dy * t;\n        }\n    }\n\n    dx = p.x - x;\n    dy = p.y - y;\n\n    return dx * dx + dy * dy;\n}\n// rest of the code doesn't care about point format\n\n// basic distance-based simplification\nfunction simplifyRadialDist(points, sqTolerance) {\n\n    var prevPoint = points[0],\n        newPoints = [prevPoint],\n        point;\n\n    for (var i = 1, len = points.length; i < len; i++) {\n        point = points[i];\n\n        if (getSqDist(point, prevPoint) > sqTolerance) {\n            newPoints.push(point);\n            prevPoint = point;\n        }\n    }\n\n    if (prevPoint !== point) newPoints.push(point);\n\n    return newPoints;\n}\n\nfunction simplifyDPStep(points, first, last, sqTolerance, simplified) {\n    var maxSqDist = sqTolerance,\n        index;\n\n    for (var i = first + 1; i < last; i++) {\n        var sqDist = getSqSegDist(points[i], points[first], points[last]);\n\n        if (sqDist > maxSqDist) {\n            index = i;\n            maxSqDist = sqDist;\n        }\n    }\n\n    if (maxSqDist > sqTolerance) {\n        if (index - first > 1) simplifyDPStep(points, first, index, sqTolerance, simplified);\n        simplified.push(points[index]);\n        if (last - index > 1) simplifyDPStep(points, index, last, sqTolerance, simplified);\n    }\n}\n\n// simplification using Ramer-Douglas-Peucker algorithm\nfunction simplifyDouglasPeucker(points, sqTolerance) {\n    var last = points.length - 1;\n\n    var simplified = [points[0]];\n    simplifyDPStep(points, 0, last, sqTolerance, simplified);\n    simplified.push(points[last]);\n\n    return simplified;\n}\n\n// both algorithms combined for awesome performance\nfunction simplify(points, tolerance, highestQuality) {\n\n    if (points.length <= 2) return points;\n\n    var sqTolerance = tolerance !== undefined ? tolerance * tolerance : 1;\n\n    points = highestQuality ? points : simplifyRadialDist(points, sqTolerance);\n    points = simplifyDouglasPeucker(points, sqTolerance);\n\n    return points;\n}\n\n// export as AMD module / Node module / browser or worker variable\nif (typeof define === 'function' && define.amd) define(function() { return simplify; });\nelse if (typeof module !== 'undefined') {\n    module.exports = simplify;\n    module.exports.default = simplify;\n} else if (typeof self !== 'undefined') self.simplify = simplify;\nelse window.simplify = simplify;\n\n})();\n","'use strict';\n\nmodule.exports = earcut;\nmodule.exports.default = earcut;\n\nfunction earcut(data, holeIndices, dim) {\n\n    dim = dim || 2;\n\n    var hasHoles = holeIndices && holeIndices.length,\n        outerLen = hasHoles ? holeIndices[0] * dim : data.length,\n        outerNode = linkedList(data, 0, outerLen, dim, true),\n        triangles = [];\n\n    if (!outerNode || outerNode.next === outerNode.prev) return triangles;\n\n    var minX, minY, maxX, maxY, x, y, invSize;\n\n    if (hasHoles) outerNode = eliminateHoles(data, holeIndices, outerNode, dim);\n\n    // if the shape is not too simple, we'll use z-order curve hash later; calculate polygon bbox\n    if (data.length > 80 * dim) {\n        minX = maxX = data[0];\n        minY = maxY = data[1];\n\n        for (var i = dim; i < outerLen; i += dim) {\n            x = data[i];\n            y = data[i + 1];\n            if (x < minX) minX = x;\n            if (y < minY) minY = y;\n            if (x > maxX) maxX = x;\n            if (y > maxY) maxY = y;\n        }\n\n        // minX, minY and invSize are later used to transform coords into integers for z-order calculation\n        invSize = Math.max(maxX - minX, maxY - minY);\n        invSize = invSize !== 0 ? 1 / invSize : 0;\n    }\n\n    earcutLinked(outerNode, triangles, dim, minX, minY, invSize);\n\n    return triangles;\n}\n\n// create a circular doubly linked list from polygon points in the specified winding order\nfunction linkedList(data, start, end, dim, clockwise) {\n    var i, last;\n\n    if (clockwise === (signedArea(data, start, end, dim) > 0)) {\n        for (i = start; i < end; i += dim) last = insertNode(i, data[i], data[i + 1], last);\n    } else {\n        for (i = end - dim; i >= start; i -= dim) last = insertNode(i, data[i], data[i + 1], last);\n    }\n\n    if (last && equals(last, last.next)) {\n        removeNode(last);\n        last = last.next;\n    }\n\n    return last;\n}\n\n// eliminate colinear or duplicate points\nfunction filterPoints(start, end) {\n    if (!start) return start;\n    if (!end) end = start;\n\n    var p = start,\n        again;\n    do {\n        again = false;\n\n        if (!p.steiner && (equals(p, p.next) || area(p.prev, p, p.next) === 0)) {\n            removeNode(p);\n            p = end = p.prev;\n            if (p === p.next) break;\n            again = true;\n\n        } else {\n            p = p.next;\n        }\n    } while (again || p !== end);\n\n    return end;\n}\n\n// main ear slicing loop which triangulates a polygon (given as a linked list)\nfunction earcutLinked(ear, triangles, dim, minX, minY, invSize, pass) {\n    if (!ear) return;\n\n    // interlink polygon nodes in z-order\n    if (!pass && invSize) indexCurve(ear, minX, minY, invSize);\n\n    var stop = ear,\n        prev, next;\n\n    // iterate through ears, slicing them one by one\n    while (ear.prev !== ear.next) {\n        prev = ear.prev;\n        next = ear.next;\n\n        if (invSize ? isEarHashed(ear, minX, minY, invSize) : isEar(ear)) {\n            // cut off the triangle\n            triangles.push(prev.i / dim);\n            triangles.push(ear.i / dim);\n            triangles.push(next.i / dim);\n\n            removeNode(ear);\n\n            // skipping the next vertex leads to less sliver triangles\n            ear = next.next;\n            stop = next.next;\n\n            continue;\n        }\n\n        ear = next;\n\n        // if we looped through the whole remaining polygon and can't find any more ears\n        if (ear === stop) {\n            // try filtering points and slicing again\n            if (!pass) {\n                earcutLinked(filterPoints(ear), triangles, dim, minX, minY, invSize, 1);\n\n            // if this didn't work, try curing all small self-intersections locally\n            } else if (pass === 1) {\n                ear = cureLocalIntersections(filterPoints(ear), triangles, dim);\n                earcutLinked(ear, triangles, dim, minX, minY, invSize, 2);\n\n            // as a last resort, try splitting the remaining polygon into two\n            } else if (pass === 2) {\n                splitEarcut(ear, triangles, dim, minX, minY, invSize);\n            }\n\n            break;\n        }\n    }\n}\n\n// check whether a polygon node forms a valid ear with adjacent nodes\nfunction isEar(ear) {\n    var a = ear.prev,\n        b = ear,\n        c = ear.next;\n\n    if (area(a, b, c) >= 0) return false; // reflex, can't be an ear\n\n    // now make sure we don't have other points inside the potential ear\n    var p = ear.next.next;\n\n    while (p !== ear.prev) {\n        if (pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&\n            area(p.prev, p, p.next) >= 0) return false;\n        p = p.next;\n    }\n\n    return true;\n}\n\nfunction isEarHashed(ear, minX, minY, invSize) {\n    var a = ear.prev,\n        b = ear,\n        c = ear.next;\n\n    if (area(a, b, c) >= 0) return false; // reflex, can't be an ear\n\n    // triangle bbox; min & max are calculated like this for speed\n    var minTX = a.x < b.x ? (a.x < c.x ? a.x : c.x) : (b.x < c.x ? b.x : c.x),\n        minTY = a.y < b.y ? (a.y < c.y ? a.y : c.y) : (b.y < c.y ? b.y : c.y),\n        maxTX = a.x > b.x ? (a.x > c.x ? a.x : c.x) : (b.x > c.x ? b.x : c.x),\n        maxTY = a.y > b.y ? (a.y > c.y ? a.y : c.y) : (b.y > c.y ? b.y : c.y);\n\n    // z-order range for the current triangle bbox;\n    var minZ = zOrder(minTX, minTY, minX, minY, invSize),\n        maxZ = zOrder(maxTX, maxTY, minX, minY, invSize);\n\n    var p = ear.prevZ,\n        n = ear.nextZ;\n\n    // look for points inside the triangle in both directions\n    while (p && p.z >= minZ && n && n.z <= maxZ) {\n        if (p !== ear.prev && p !== ear.next &&\n            pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&\n            area(p.prev, p, p.next) >= 0) return false;\n        p = p.prevZ;\n\n        if (n !== ear.prev && n !== ear.next &&\n            pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, n.x, n.y) &&\n            area(n.prev, n, n.next) >= 0) return false;\n        n = n.nextZ;\n    }\n\n    // look for remaining points in decreasing z-order\n    while (p && p.z >= minZ) {\n        if (p !== ear.prev && p !== ear.next &&\n            pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&\n            area(p.prev, p, p.next) >= 0) return false;\n        p = p.prevZ;\n    }\n\n    // look for remaining points in increasing z-order\n    while (n && n.z <= maxZ) {\n        if (n !== ear.prev && n !== ear.next &&\n            pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, n.x, n.y) &&\n            area(n.prev, n, n.next) >= 0) return false;\n        n = n.nextZ;\n    }\n\n    return true;\n}\n\n// go through all polygon nodes and cure small local self-intersections\nfunction cureLocalIntersections(start, triangles, dim) {\n    var p = start;\n    do {\n        var a = p.prev,\n            b = p.next.next;\n\n        if (!equals(a, b) && intersects(a, p, p.next, b) && locallyInside(a, b) && locallyInside(b, a)) {\n\n            triangles.push(a.i / dim);\n            triangles.push(p.i / dim);\n            triangles.push(b.i / dim);\n\n            // remove two nodes involved\n            removeNode(p);\n            removeNode(p.next);\n\n            p = start = b;\n        }\n        p = p.next;\n    } while (p !== start);\n\n    return filterPoints(p);\n}\n\n// try splitting polygon into two and triangulate them independently\nfunction splitEarcut(start, triangles, dim, minX, minY, invSize) {\n    // look for a valid diagonal that divides the polygon into two\n    var a = start;\n    do {\n        var b = a.next.next;\n        while (b !== a.prev) {\n            if (a.i !== b.i && isValidDiagonal(a, b)) {\n                // split the polygon in two by the diagonal\n                var c = splitPolygon(a, b);\n\n                // filter colinear points around the cuts\n                a = filterPoints(a, a.next);\n                c = filterPoints(c, c.next);\n\n                // run earcut on each half\n                earcutLinked(a, triangles, dim, minX, minY, invSize);\n                earcutLinked(c, triangles, dim, minX, minY, invSize);\n                return;\n            }\n            b = b.next;\n        }\n        a = a.next;\n    } while (a !== start);\n}\n\n// link every hole into the outer loop, producing a single-ring polygon without holes\nfunction eliminateHoles(data, holeIndices, outerNode, dim) {\n    var queue = [],\n        i, len, start, end, list;\n\n    for (i = 0, len = holeIndices.length; i < len; i++) {\n        start = holeIndices[i] * dim;\n        end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;\n        list = linkedList(data, start, end, dim, false);\n        if (list === list.next) list.steiner = true;\n        queue.push(getLeftmost(list));\n    }\n\n    queue.sort(compareX);\n\n    // process holes from left to right\n    for (i = 0; i < queue.length; i++) {\n        outerNode = eliminateHole(queue[i], outerNode);\n        outerNode = filterPoints(outerNode, outerNode.next);\n    }\n\n    return outerNode;\n}\n\nfunction compareX(a, b) {\n    return a.x - b.x;\n}\n\n// find a bridge between vertices that connects hole with an outer ring and and link it\nfunction eliminateHole(hole, outerNode) {\n    var bridge = findHoleBridge(hole, outerNode);\n    if (!bridge) {\n        return outerNode;\n    }\n\n    var bridgeReverse = splitPolygon(bridge, hole);\n\n    // filter collinear points around the cuts\n    var filteredBridge = filterPoints(bridge, bridge.next);\n    filterPoints(bridgeReverse, bridgeReverse.next);\n\n    // Check if input node was removed by the filtering\n    return outerNode === bridge ? filteredBridge : outerNode;\n}\n\n// David Eberly's algorithm for finding a bridge between hole and outer polygon\nfunction findHoleBridge(hole, outerNode) {\n    var p = outerNode,\n        hx = hole.x,\n        hy = hole.y,\n        qx = -Infinity,\n        m;\n\n    // find a segment intersected by a ray from the hole's leftmost point to the left;\n    // segment's endpoint with lesser x will be potential connection point\n    do {\n        if (hy <= p.y && hy >= p.next.y && p.next.y !== p.y) {\n            var x = p.x + (hy - p.y) * (p.next.x - p.x) / (p.next.y - p.y);\n            if (x <= hx && x > qx) {\n                qx = x;\n                if (x === hx) {\n                    if (hy === p.y) return p;\n                    if (hy === p.next.y) return p.next;\n                }\n                m = p.x < p.next.x ? p : p.next;\n            }\n        }\n        p = p.next;\n    } while (p !== outerNode);\n\n    if (!m) return null;\n\n    if (hx === qx) return m; // hole touches outer segment; pick leftmost endpoint\n\n    // look for points inside the triangle of hole point, segment intersection and endpoint;\n    // if there are no points found, we have a valid connection;\n    // otherwise choose the point of the minimum angle with the ray as connection point\n\n    var stop = m,\n        mx = m.x,\n        my = m.y,\n        tanMin = Infinity,\n        tan;\n\n    p = m;\n\n    do {\n        if (hx >= p.x && p.x >= mx && hx !== p.x &&\n                pointInTriangle(hy < my ? hx : qx, hy, mx, my, hy < my ? qx : hx, hy, p.x, p.y)) {\n\n            tan = Math.abs(hy - p.y) / (hx - p.x); // tangential\n\n            if (locallyInside(p, hole) &&\n                (tan < tanMin || (tan === tanMin && (p.x > m.x || (p.x === m.x && sectorContainsSector(m, p)))))) {\n                m = p;\n                tanMin = tan;\n            }\n        }\n\n        p = p.next;\n    } while (p !== stop);\n\n    return m;\n}\n\n// whether sector in vertex m contains sector in vertex p in the same coordinates\nfunction sectorContainsSector(m, p) {\n    return area(m.prev, m, p.prev) < 0 && area(p.next, m, m.next) < 0;\n}\n\n// interlink polygon nodes in z-order\nfunction indexCurve(start, minX, minY, invSize) {\n    var p = start;\n    do {\n        if (p.z === null) p.z = zOrder(p.x, p.y, minX, minY, invSize);\n        p.prevZ = p.prev;\n        p.nextZ = p.next;\n        p = p.next;\n    } while (p !== start);\n\n    p.prevZ.nextZ = null;\n    p.prevZ = null;\n\n    sortLinked(p);\n}\n\n// Simon Tatham's linked list merge sort algorithm\n// http://www.chiark.greenend.org.uk/~sgtatham/algorithms/listsort.html\nfunction sortLinked(list) {\n    var i, p, q, e, tail, numMerges, pSize, qSize,\n        inSize = 1;\n\n    do {\n        p = list;\n        list = null;\n        tail = null;\n        numMerges = 0;\n\n        while (p) {\n            numMerges++;\n            q = p;\n            pSize = 0;\n            for (i = 0; i < inSize; i++) {\n                pSize++;\n                q = q.nextZ;\n                if (!q) break;\n            }\n            qSize = inSize;\n\n            while (pSize > 0 || (qSize > 0 && q)) {\n\n                if (pSize !== 0 && (qSize === 0 || !q || p.z <= q.z)) {\n                    e = p;\n                    p = p.nextZ;\n                    pSize--;\n                } else {\n                    e = q;\n                    q = q.nextZ;\n                    qSize--;\n                }\n\n                if (tail) tail.nextZ = e;\n                else list = e;\n\n                e.prevZ = tail;\n                tail = e;\n            }\n\n            p = q;\n        }\n\n        tail.nextZ = null;\n        inSize *= 2;\n\n    } while (numMerges > 1);\n\n    return list;\n}\n\n// z-order of a point given coords and inverse of the longer side of data bbox\nfunction zOrder(x, y, minX, minY, invSize) {\n    // coords are transformed into non-negative 15-bit integer range\n    x = 32767 * (x - minX) * invSize;\n    y = 32767 * (y - minY) * invSize;\n\n    x = (x | (x << 8)) & 0x00FF00FF;\n    x = (x | (x << 4)) & 0x0F0F0F0F;\n    x = (x | (x << 2)) & 0x33333333;\n    x = (x | (x << 1)) & 0x55555555;\n\n    y = (y | (y << 8)) & 0x00FF00FF;\n    y = (y | (y << 4)) & 0x0F0F0F0F;\n    y = (y | (y << 2)) & 0x33333333;\n    y = (y | (y << 1)) & 0x55555555;\n\n    return x | (y << 1);\n}\n\n// find the leftmost node of a polygon ring\nfunction getLeftmost(start) {\n    var p = start,\n        leftmost = start;\n    do {\n        if (p.x < leftmost.x || (p.x === leftmost.x && p.y < leftmost.y)) leftmost = p;\n        p = p.next;\n    } while (p !== start);\n\n    return leftmost;\n}\n\n// check if a point lies within a convex triangle\nfunction pointInTriangle(ax, ay, bx, by, cx, cy, px, py) {\n    return (cx - px) * (ay - py) - (ax - px) * (cy - py) >= 0 &&\n           (ax - px) * (by - py) - (bx - px) * (ay - py) >= 0 &&\n           (bx - px) * (cy - py) - (cx - px) * (by - py) >= 0;\n}\n\n// check if a diagonal between two polygon nodes is valid (lies in polygon interior)\nfunction isValidDiagonal(a, b) {\n    return a.next.i !== b.i && a.prev.i !== b.i && !intersectsPolygon(a, b) && // dones't intersect other edges\n           (locallyInside(a, b) && locallyInside(b, a) && middleInside(a, b) && // locally visible\n            (area(a.prev, a, b.prev) || area(a, b.prev, b)) || // does not create opposite-facing sectors\n            equals(a, b) && area(a.prev, a, a.next) > 0 && area(b.prev, b, b.next) > 0); // special zero-length case\n}\n\n// signed area of a triangle\nfunction area(p, q, r) {\n    return (q.y - p.y) * (r.x - q.x) - (q.x - p.x) * (r.y - q.y);\n}\n\n// check if two points are equal\nfunction equals(p1, p2) {\n    return p1.x === p2.x && p1.y === p2.y;\n}\n\n// check if two segments intersect\nfunction intersects(p1, q1, p2, q2) {\n    var o1 = sign(area(p1, q1, p2));\n    var o2 = sign(area(p1, q1, q2));\n    var o3 = sign(area(p2, q2, p1));\n    var o4 = sign(area(p2, q2, q1));\n\n    if (o1 !== o2 && o3 !== o4) return true; // general case\n\n    if (o1 === 0 && onSegment(p1, p2, q1)) return true; // p1, q1 and p2 are collinear and p2 lies on p1q1\n    if (o2 === 0 && onSegment(p1, q2, q1)) return true; // p1, q1 and q2 are collinear and q2 lies on p1q1\n    if (o3 === 0 && onSegment(p2, p1, q2)) return true; // p2, q2 and p1 are collinear and p1 lies on p2q2\n    if (o4 === 0 && onSegment(p2, q1, q2)) return true; // p2, q2 and q1 are collinear and q1 lies on p2q2\n\n    return false;\n}\n\n// for collinear points p, q, r, check if point q lies on segment pr\nfunction onSegment(p, q, r) {\n    return q.x <= Math.max(p.x, r.x) && q.x >= Math.min(p.x, r.x) && q.y <= Math.max(p.y, r.y) && q.y >= Math.min(p.y, r.y);\n}\n\nfunction sign(num) {\n    return num > 0 ? 1 : num < 0 ? -1 : 0;\n}\n\n// check if a polygon diagonal intersects any polygon segments\nfunction intersectsPolygon(a, b) {\n    var p = a;\n    do {\n        if (p.i !== a.i && p.next.i !== a.i && p.i !== b.i && p.next.i !== b.i &&\n                intersects(p, p.next, a, b)) return true;\n        p = p.next;\n    } while (p !== a);\n\n    return false;\n}\n\n// check if a polygon diagonal is locally inside the polygon\nfunction locallyInside(a, b) {\n    return area(a.prev, a, a.next) < 0 ?\n        area(a, b, a.next) >= 0 && area(a, a.prev, b) >= 0 :\n        area(a, b, a.prev) < 0 || area(a, a.next, b) < 0;\n}\n\n// check if the middle point of a polygon diagonal is inside the polygon\nfunction middleInside(a, b) {\n    var p = a,\n        inside = false,\n        px = (a.x + b.x) / 2,\n        py = (a.y + b.y) / 2;\n    do {\n        if (((p.y > py) !== (p.next.y > py)) && p.next.y !== p.y &&\n                (px < (p.next.x - p.x) * (py - p.y) / (p.next.y - p.y) + p.x))\n            inside = !inside;\n        p = p.next;\n    } while (p !== a);\n\n    return inside;\n}\n\n// link two polygon vertices with a bridge; if the vertices belong to the same ring, it splits polygon into two;\n// if one belongs to the outer ring and another to a hole, it merges it into a single ring\nfunction splitPolygon(a, b) {\n    var a2 = new Node(a.i, a.x, a.y),\n        b2 = new Node(b.i, b.x, b.y),\n        an = a.next,\n        bp = b.prev;\n\n    a.next = b;\n    b.prev = a;\n\n    a2.next = an;\n    an.prev = a2;\n\n    b2.next = a2;\n    a2.prev = b2;\n\n    bp.next = b2;\n    b2.prev = bp;\n\n    return b2;\n}\n\n// create a node and optionally link it with previous one (in a circular doubly linked list)\nfunction insertNode(i, x, y, last) {\n    var p = new Node(i, x, y);\n\n    if (!last) {\n        p.prev = p;\n        p.next = p;\n\n    } else {\n        p.next = last.next;\n        p.prev = last;\n        last.next.prev = p;\n        last.next = p;\n    }\n    return p;\n}\n\nfunction removeNode(p) {\n    p.next.prev = p.prev;\n    p.prev.next = p.next;\n\n    if (p.prevZ) p.prevZ.nextZ = p.nextZ;\n    if (p.nextZ) p.nextZ.prevZ = p.prevZ;\n}\n\nfunction Node(i, x, y) {\n    // vertex index in coordinates array\n    this.i = i;\n\n    // vertex coordinates\n    this.x = x;\n    this.y = y;\n\n    // previous and next vertex nodes in a polygon ring\n    this.prev = null;\n    this.next = null;\n\n    // z-order curve value\n    this.z = null;\n\n    // previous and next nodes in z-order\n    this.prevZ = null;\n    this.nextZ = null;\n\n    // indicates whether this is a steiner point\n    this.steiner = false;\n}\n\n// return a percentage difference between the polygon area and its triangulation area;\n// used to verify correctness of triangulation\nearcut.deviation = function (data, holeIndices, dim, triangles) {\n    var hasHoles = holeIndices && holeIndices.length;\n    var outerLen = hasHoles ? holeIndices[0] * dim : data.length;\n\n    var polygonArea = Math.abs(signedArea(data, 0, outerLen, dim));\n    if (hasHoles) {\n        for (var i = 0, len = holeIndices.length; i < len; i++) {\n            var start = holeIndices[i] * dim;\n            var end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;\n            polygonArea -= Math.abs(signedArea(data, start, end, dim));\n        }\n    }\n\n    var trianglesArea = 0;\n    for (i = 0; i < triangles.length; i += 3) {\n        var a = triangles[i] * dim;\n        var b = triangles[i + 1] * dim;\n        var c = triangles[i + 2] * dim;\n        trianglesArea += Math.abs(\n            (data[a] - data[c]) * (data[b + 1] - data[a + 1]) -\n            (data[a] - data[b]) * (data[c + 1] - data[a + 1]));\n    }\n\n    return polygonArea === 0 && trianglesArea === 0 ? 0 :\n        Math.abs((trianglesArea - polygonArea) / polygonArea);\n};\n\nfunction signedArea(data, start, end, dim) {\n    var sum = 0;\n    for (var i = start, j = end - dim; i < end; i += dim) {\n        sum += (data[j] - data[i]) * (data[i + 1] + data[j + 1]);\n        j = i;\n    }\n    return sum;\n}\n\n// turn a polygon in a multi-dimensional array form (e.g. as in GeoJSON) into a form Earcut accepts\nearcut.flatten = function (data) {\n    var dim = data[0][0].length,\n        result = {vertices: [], holes: [], dimensions: dim},\n        holeIndex = 0;\n\n    for (var i = 0; i < data.length; i++) {\n        for (var j = 0; j < data[i].length; j++) {\n            for (var d = 0; d < dim; d++) result.vertices.push(data[i][j][d]);\n        }\n        if (i > 0) {\n            holeIndex += data[i - 1].length;\n            result.holes.push(holeIndex);\n        }\n    }\n    return result;\n};\n","import * as THREE from 'three';\r\n/**\r\n * three api adapt\r\n */\r\nconst REVISION = parseInt(THREE.REVISION.replace('dev', ''));\r\n//Three does not print version information now. Output the version of three to find compatibility problems\r\nconsole.log(`maptalks.three log: current three.js version is %c${REVISION}`, 'color:red;font-size: 16px;font-weight: bold;');\r\n/**\r\n *\r\n * @param {THREE.BufferGeometry} bufferGeomertry\r\n * @param {String} key\r\n * @param {*} value\r\n */\r\nexport function addAttribute(bufferGeomertry, key, value) {\r\n    if (REVISION > 109) {\r\n        bufferGeomertry.setAttribute(key, value);\r\n    }\r\n    else {\r\n        bufferGeomertry.addAttribute(key, value);\r\n    }\r\n    return bufferGeomertry;\r\n}\r\nexport function setRaycasterLinePrecision(raycaster, linePrecision) {\r\n    if (REVISION > 113) {\r\n        raycaster.params.Line.threshold = linePrecision;\r\n    }\r\n    else {\r\n        raycaster.linePrecision = linePrecision;\r\n    }\r\n}\r\nexport function getVertexColors() {\r\n    if (THREE.VertexColors) {\r\n        return THREE.VertexColors;\r\n    }\r\n    return true;\r\n}\r\n//# sourceMappingURL=ThreeAdaptUtil.js.map","/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n *\r\n */\r\nimport * as THREE from 'three';\r\nimport { addAttribute } from '../ThreeAdaptUtil';\r\nclass LineSegmentsGeometry extends THREE.InstancedBufferGeometry {\r\n    constructor() {\r\n        super();\r\n        this.isLineSegmentsGeometry = true;\r\n        this.type = 'LineSegmentsGeometry';\r\n        var positions = [-1, 2, 0, 1, 2, 0, -1, 1, 0, 1, 1, 0, -1, 0, 0, 1, 0, 0, -1, -1, 0, 1, -1, 0];\r\n        var uvs = [-1, 2, 1, 2, -1, 1, 1, 1, -1, -1, 1, -1, -1, -2, 1, -2];\r\n        var index = [0, 2, 1, 2, 3, 1, 2, 4, 3, 4, 5, 3, 4, 6, 5, 6, 7, 5];\r\n        this.setIndex(index);\r\n        addAttribute(this, 'position', new THREE.Float32BufferAttribute(positions, 3));\r\n        addAttribute(this, 'uv', new THREE.Float32BufferAttribute(uvs, 2));\r\n    }\r\n    // THREE.InstancedBufferGeometry.call(this);\r\n    // var plane = new THREE.BufferGeometry();\r\n    // this.addAttribute('position', new THREE.Float32BufferAttribute(positions, 3));\r\n    // this.addAttribute('uv', new THREE.Float32BufferAttribute(uvs, 2));\r\n    applyMatrix(matrix) {\r\n        var start = this.attributes.instanceStart;\r\n        var end = this.attributes.instanceEnd;\r\n        if (start !== undefined) {\r\n            matrix.applyToBufferAttribute(start);\r\n            matrix.applyToBufferAttribute(end);\r\n            start.data.needsUpdate = true;\r\n        }\r\n        if (this.boundingBox !== null) {\r\n            this.computeBoundingBox();\r\n        }\r\n        if (this.boundingSphere !== null) {\r\n            this.computeBoundingSphere();\r\n        }\r\n        return this;\r\n    }\r\n    setPositions(array) {\r\n        var lineSegments;\r\n        if (array instanceof Float32Array) {\r\n            lineSegments = array;\r\n        }\r\n        else if (Array.isArray(array)) {\r\n            lineSegments = new Float32Array(array);\r\n        }\r\n        var instanceBuffer = new THREE.InstancedInterleavedBuffer(lineSegments, 6, 1); // xyz, xyz\r\n        addAttribute(this, 'instanceStart', new THREE.InterleavedBufferAttribute(instanceBuffer, 3, 0));\r\n        addAttribute(this, 'instanceEnd', new THREE.InterleavedBufferAttribute(instanceBuffer, 3, 3));\r\n        // this.addAttribute('instanceStart', new THREE.InterleavedBufferAttribute(instanceBuffer, 3, 0)); // xyz\r\n        // this.addAttribute('instanceEnd', new THREE.InterleavedBufferAttribute(instanceBuffer, 3, 3)); // xyz\r\n        //\r\n        this.computeBoundingBox();\r\n        this.computeBoundingSphere();\r\n        return this;\r\n    }\r\n    setColors(array) {\r\n        var colors;\r\n        if (array instanceof Float32Array) {\r\n            colors = array;\r\n        }\r\n        else if (Array.isArray(array)) {\r\n            colors = new Float32Array(array);\r\n        }\r\n        var instanceColorBuffer = new THREE.InstancedInterleavedBuffer(colors, 6, 1); // rgb, rgb\r\n        addAttribute(this, 'instanceColorStart', new THREE.InterleavedBufferAttribute(instanceColorBuffer, 3, 0));\r\n        addAttribute(this, 'instanceColorEnd', new THREE.InterleavedBufferAttribute(instanceColorBuffer, 3, 3));\r\n        // this.addAttribute('instanceColorStart', new THREE.InterleavedBufferAttribute(instanceColorBuffer, 3, 0)); // rgb\r\n        // this.addAttribute('instanceColorEnd', new THREE.InterleavedBufferAttribute(instanceColorBuffer, 3, 3)); // rgb\r\n        return this;\r\n    }\r\n    fromWireframeGeometry(geometry) {\r\n        this.setPositions(geometry.attributes.position.array);\r\n        return this;\r\n    }\r\n    fromEdgesGeometry(geometry) {\r\n        this.setPositions(geometry.attributes.position.array);\r\n        return this;\r\n    }\r\n    fromMesh(mesh) {\r\n        this.fromWireframeGeometry(new THREE.WireframeGeometry(mesh.geometry));\r\n        // set colors, maybe\r\n        return this;\r\n    }\r\n    fromLineSegements(lineSegments) {\r\n        var geometry = lineSegments.geometry;\r\n        if (geometry.isGeometry) {\r\n            this.setPositions(geometry.vertices);\r\n        }\r\n        else if (geometry.isBufferGeometry) {\r\n            this.setPositions(geometry.position.array); // assumes non-indexed\r\n        }\r\n        // set colors, maybe\r\n        return this;\r\n    }\r\n    computeBoundingBox() {\r\n        var box = new THREE.Box3();\r\n        if (this.boundingBox === null) {\r\n            this.boundingBox = new THREE.Box3();\r\n        }\r\n        var start = this.attributes.instanceStart;\r\n        var end = this.attributes.instanceEnd;\r\n        if (start !== undefined && end !== undefined) {\r\n            this.boundingBox.setFromBufferAttribute(start);\r\n            box.setFromBufferAttribute(end);\r\n            this.boundingBox.union(box);\r\n        }\r\n    }\r\n    computeBoundingSphere() {\r\n        var vector = new THREE.Vector3();\r\n        if (this.boundingSphere === null) {\r\n            this.boundingSphere = new THREE.Sphere();\r\n        }\r\n        if (this.boundingBox === null) {\r\n            this.computeBoundingBox();\r\n        }\r\n        var start = this.attributes.instanceStart;\r\n        var end = this.attributes.instanceEnd;\r\n        if (start !== undefined && end !== undefined) {\r\n            var center = this.boundingSphere.center;\r\n            this.boundingBox.getCenter(center);\r\n            var maxRadiusSq = 0;\r\n            for (var i = 0, il = start.count; i < il; i++) {\r\n                vector.fromBufferAttribute(start, i);\r\n                maxRadiusSq = Math.max(maxRadiusSq, center.distanceToSquared(vector));\r\n                vector.fromBufferAttribute(end, i);\r\n                maxRadiusSq = Math.max(maxRadiusSq, center.distanceToSquared(vector));\r\n            }\r\n            this.boundingSphere.radius = Math.sqrt(maxRadiusSq);\r\n            if (isNaN(this.boundingSphere.radius)) {\r\n                console.error('THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.', this);\r\n            }\r\n        }\r\n    }\r\n    toJSON() {\r\n        // todo\r\n    }\r\n    // clone: function () {\r\n    //     // todo\r\n    // },\r\n    // eslint-disable-next-line no-unused-vars\r\n    copy(source) {\r\n        // todo\r\n        return this;\r\n    }\r\n}\r\n;\r\nexport default LineSegmentsGeometry;\r\n//# sourceMappingURL=LineSegmentsGeometry.js.map","/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  linewidth: <float>,\r\n *  dashed: <boolean>,\r\n *  dashScale: <float>,\r\n *  dashSize: <float>,\r\n *  gapSize: <float>,\r\n *  resolution: <Vector2>, // to be set by renderer\r\n * }\r\n */\r\nimport * as THREE from 'three';\r\nconst UniformsLib = {}, ShaderLib = {};\r\nUniformsLib.line = {\r\n    linewidth: { value: 1 },\r\n    resolution: { value: new THREE.Vector2(1, 1) },\r\n    dashScale: { value: 1 },\r\n    dashSize: { value: 1 },\r\n    gapSize: { value: 1 } // todo FIX - maybe change to totalSize\r\n};\r\nShaderLib['line'] = {\r\n    uniforms: THREE.UniformsUtils.merge([\r\n        THREE.UniformsLib.common,\r\n        THREE.UniformsLib.fog,\r\n        UniformsLib.line\r\n    ]),\r\n    vertexShader: `\r\n\t\t#include <common>\r\n\t\t#include <color_pars_vertex>\r\n\t\t#include <fog_pars_vertex>\r\n\t\t#include <logdepthbuf_pars_vertex>\r\n\t\t#include <clipping_planes_pars_vertex>\r\n\r\n\t\tuniform float linewidth;\r\n\t\tuniform vec2 resolution;\r\n\r\n\t\tattribute vec3 instanceStart;\r\n\t\tattribute vec3 instanceEnd;\r\n\r\n\t\tattribute vec3 instanceColorStart;\r\n\t\tattribute vec3 instanceColorEnd;\r\n\r\n\t\tvarying vec2 vUv;\r\n\r\n\t\t#ifdef USE_DASH\r\n\r\n\t\t\tuniform float dashScale;\r\n\t\t\tattribute float instanceDistanceStart;\r\n\t\t\tattribute float instanceDistanceEnd;\r\n\t\t\tvarying float vLineDistance;\r\n\r\n\t\t#endif\r\n\r\n\t\tvoid trimSegment( const in vec4 start, inout vec4 end ) {\r\n\r\n\t\t\t// trim end segment so it terminates between the camera plane and the near plane\r\n\r\n\t\t\t// conservative estimate of the near plane\r\n\t\t\tfloat a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\r\n\t\t\tfloat b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\r\n\t\t\tfloat nearEstimate = - 0.5 * b / a;\r\n\r\n\t\t\tfloat alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\r\n\r\n\t\t\tend.xyz = mix( start.xyz, end.xyz, alpha );\r\n\r\n\t\t}\r\n\r\n\t\tvoid main() {\r\n\r\n\t\t\t#ifdef USE_COLOR\r\n\r\n\t\t\t\tvColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\r\n\r\n\t\t\t#endif\r\n\r\n\t\t\t#ifdef USE_DASH\r\n\r\n\t\t\t\tvLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\r\n\r\n\t\t\t#endif\r\n\r\n\t\t\tfloat aspect = resolution.x / resolution.y;\r\n\r\n\t\t\tvUv = uv;\r\n\r\n\t\t\t// camera space\r\n\t\t\tvec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\r\n\t\t\tvec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\r\n\r\n\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\r\n\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\r\n\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\r\n\t\t\t// perhaps there is a more elegant solution -- WestLangley\r\n\r\n\t\t\tbool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\r\n\r\n\t\t\tif ( perspective ) {\r\n\r\n\t\t\t\tif ( start.z < 0.0 && end.z >= 0.0 ) {\r\n\r\n\t\t\t\t\ttrimSegment( start, end );\r\n\r\n\t\t\t\t} else if ( end.z < 0.0 && start.z >= 0.0 ) {\r\n\r\n\t\t\t\t\ttrimSegment( end, start );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// clip space\r\n\t\t\tvec4 clipStart = projectionMatrix * start;\r\n\t\t\tvec4 clipEnd = projectionMatrix * end;\r\n\r\n\t\t\t// ndc space\r\n\t\t\tvec2 ndcStart = clipStart.xy / clipStart.w;\r\n\t\t\tvec2 ndcEnd = clipEnd.xy / clipEnd.w;\r\n\r\n\t\t\t// direction\r\n\t\t\tvec2 dir = ndcEnd - ndcStart;\r\n\r\n\t\t\t// account for clip-space aspect ratio\r\n\t\t\tdir.x *= aspect;\r\n\t\t\tdir = normalize( dir );\r\n\r\n\t\t\t// perpendicular to dir\r\n\t\t\tvec2 offset = vec2( dir.y, - dir.x );\r\n\r\n\t\t\t// undo aspect ratio adjustment\r\n\t\t\tdir.x /= aspect;\r\n\t\t\toffset.x /= aspect;\r\n\r\n\t\t\t// sign flip\r\n\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\r\n\r\n\t\t\t// endcaps\r\n\t\t\tif ( position.y < 0.0 ) {\r\n\r\n\t\t\t\toffset += - dir;\r\n\r\n\t\t\t} else if ( position.y > 1.0 ) {\r\n\r\n\t\t\t\toffset += dir;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// adjust for linewidth\r\n\t\t\toffset *= linewidth;\r\n\r\n\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\r\n\t\t\toffset /= resolution.y;\r\n\r\n\t\t\t// select end\r\n\t\t\tvec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\r\n\r\n\t\t\t// back to clip space\r\n\t\t\toffset *= clip.w;\r\n\r\n\t\t\tclip.xy += offset;\r\n\r\n\t\t\tgl_Position = clip;\r\n\r\n\t\t\tvec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\r\n\r\n\t\t\t#include <logdepthbuf_vertex>\r\n\t\t\t#include <clipping_planes_vertex>\r\n\t\t\t#include <fog_vertex>\r\n\r\n\t\t}\r\n\t\t`,\r\n    fragmentShader: `\r\n\t\tuniform vec3 diffuse;\r\n\t\tuniform float opacity;\r\n\r\n\t\t#ifdef USE_DASH\r\n\r\n\t\t\tuniform float dashSize;\r\n\t\t\tuniform float gapSize;\r\n\r\n\t\t#endif\r\n\r\n\t\tvarying float vLineDistance;\r\n\r\n\t\t#include <common>\r\n\t\t#include <color_pars_fragment>\r\n\t\t#include <fog_pars_fragment>\r\n\t\t#include <logdepthbuf_pars_fragment>\r\n\t\t#include <clipping_planes_pars_fragment>\r\n\r\n\t\tvarying vec2 vUv;\r\n\r\n\t\tvoid main() {\r\n\r\n\t\t\t#include <clipping_planes_fragment>\r\n\r\n\t\t\t#ifdef USE_DASH\r\n\r\n\t\t\t\tif ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\r\n\r\n\t\t\t\tif ( mod( vLineDistance, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\r\n\r\n\t\t\t#endif\r\n\r\n\t\t\tif ( abs( vUv.y ) > 1.0 ) {\r\n\r\n\t\t\t\tfloat a = vUv.x;\r\n\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\r\n\t\t\t\tfloat len2 = a * a + b * b;\r\n\r\n\t\t\t\tif ( len2 > 1.0 ) discard;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvec4 diffuseColor = vec4( diffuse, opacity );\r\n\r\n\t\t\t#include <logdepthbuf_fragment>\r\n\t\t\t#include <color_fragment>\r\n\r\n\t\t\tgl_FragColor = vec4( diffuseColor.rgb, diffuseColor.a );\r\n\r\n\t\t\t#include <premultiplied_alpha_fragment>\r\n\t\t\t#include <tonemapping_fragment>\r\n\t\t\t#include <encodings_fragment>\r\n\t\t\t#include <fog_fragment>\r\n\r\n\t\t}\r\n\t\t`\r\n};\r\nclass LineMaterial extends THREE.ShaderMaterial {\r\n    constructor(parameters) {\r\n        super({\r\n            uniforms: THREE.UniformsUtils.clone(ShaderLib['line'].uniforms),\r\n            vertexShader: ShaderLib['line'].vertexShader,\r\n            fragmentShader: ShaderLib['line'].fragmentShader\r\n        });\r\n        this.dashed = true;\r\n        this.isLineMaterial = true;\r\n        this.type = 'LineMaterial';\r\n        Object.defineProperties(this, {\r\n            color: {\r\n                enumerable: true,\r\n                get: function () {\r\n                    return this.uniforms.diffuse.value;\r\n                },\r\n                set: function (value) {\r\n                    this.uniforms.diffuse.value = value;\r\n                }\r\n            },\r\n            linewidth: {\r\n                enumerable: true,\r\n                get: function () {\r\n                    return this.uniforms.linewidth.value;\r\n                },\r\n                set: function (value) {\r\n                    this.uniforms.linewidth.value = value;\r\n                }\r\n            },\r\n            dashScale: {\r\n                enumerable: true,\r\n                get: function () {\r\n                    return this.uniforms.dashScale.value;\r\n                },\r\n                set: function (value) {\r\n                    this.uniforms.dashScale.value = value;\r\n                }\r\n            },\r\n            dashSize: {\r\n                enumerable: true,\r\n                get: function () {\r\n                    return this.uniforms.dashSize.value;\r\n                },\r\n                set: function (value) {\r\n                    this.uniforms.dashSize.value = value;\r\n                }\r\n            },\r\n            gapSize: {\r\n                enumerable: true,\r\n                get: function () {\r\n                    return this.uniforms.gapSize.value;\r\n                },\r\n                set: function (value) {\r\n                    this.uniforms.gapSize.value = value;\r\n                }\r\n            },\r\n            resolution: {\r\n                enumerable: true,\r\n                get: function () {\r\n                    return this.uniforms.resolution.value;\r\n                },\r\n                set: function (value) {\r\n                    this.uniforms.resolution.value.copy(value);\r\n                }\r\n            }\r\n        });\r\n        this.setValues(parameters);\r\n    }\r\n}\r\n;\r\n// LineMaterial.prototype = Object.create(THREE.ShaderMaterial.prototype);\r\n// LineMaterial.prototype.constructor = LineMaterial;\r\n// LineMaterial.prototype.isLineMaterial = true;\r\n// LineMaterial.prototype.copy = function (source) {\r\n// \t// THREE.ShaderMaterial.prototype.copy.call(this, source);\r\n// \tthis.color.copy(source.color);\r\n// \tthis.linewidth = source.linewidth;\r\n// \tthis.resolution = source.resolution;\r\n// \t// todo\r\n// \treturn this;\r\n// };\r\nexport default LineMaterial;\r\n//# sourceMappingURL=LineMaterial.js.map","/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n *\r\n */\r\nimport * as THREE from 'three';\r\nimport LineSegmentsGeometry from './LineSegmentsGeometry';\r\nimport { addAttribute } from '../ThreeAdaptUtil';\r\nimport LineMaterial from './LineMaterial';\r\nclass LineSegments2 extends THREE.Mesh {\r\n    constructor(geometry, material) {\r\n        super(geometry, material);\r\n        this.isLineSegments2 = true;\r\n        this.type = 'LineSegments2';\r\n        this.geometry = geometry !== undefined ? geometry : new LineSegmentsGeometry();\r\n        this.material = material !== undefined ? material : new LineMaterial({ color: Math.random() * 0xffffff });\r\n    }\r\n    computeLineDistances() {\r\n        var start = new THREE.Vector3();\r\n        var end = new THREE.Vector3();\r\n        var geometry = this.geometry;\r\n        var instanceStart = geometry.attributes.instanceStart;\r\n        var instanceEnd = geometry.attributes.instanceEnd;\r\n        if (!instanceStart || !instanceEnd) {\r\n            return this;\r\n        }\r\n        var lineDistances = new Float32Array(2 * instanceStart.data.count);\r\n        for (var i = 0, j = 0, l = instanceStart.data.count; i < l; i++, j += 2) {\r\n            start.fromBufferAttribute(instanceStart, i);\r\n            end.fromBufferAttribute(instanceEnd, i);\r\n            lineDistances[j] = (j === 0) ? 0 : lineDistances[j - 1];\r\n            lineDistances[j + 1] = lineDistances[j] + start.distanceTo(end);\r\n        }\r\n        var instanceDistanceBuffer = new THREE.InstancedInterleavedBuffer(lineDistances, 2, 1); // d0, d1\r\n        addAttribute(geometry, 'instanceDistanceStart', new THREE.InterleavedBufferAttribute(instanceDistanceBuffer, 1, 0));\r\n        addAttribute(geometry, 'instanceDistanceEnd', new THREE.InterleavedBufferAttribute(instanceDistanceBuffer, 1, 1));\r\n        // geometry.addAttribute('instanceDistanceStart', new THREE.InterleavedBufferAttribute(instanceDistanceBuffer, 1, 0)); // d0\r\n        // geometry.addAttribute('instanceDistanceEnd', new THREE.InterleavedBufferAttribute(instanceDistanceBuffer, 1, 1)); // d1\r\n        return this;\r\n    }\r\n}\r\n;\r\nexport default LineSegments2;\r\n//# sourceMappingURL=LineSegments2.js.map","/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n *\r\n */\r\n// import * as THREE from 'three';\r\nimport LineSegmentsGeometry from './LineSegmentsGeometry';\r\nclass LineGeometry extends LineSegmentsGeometry {\r\n    constructor() {\r\n        super();\r\n        this.isLineGeometry = true;\r\n        this.type = 'LineGeometry';\r\n    }\r\n    fromLine(line) {\r\n        var geometry = line.geometry;\r\n        if (geometry.isGeometry) {\r\n            this.setPositions(geometry.vertices);\r\n        }\r\n        else if (geometry.isBufferGeometry) {\r\n            this.setPositions(geometry.position.array); // assumes non-indexed\r\n        }\r\n        return this;\r\n    }\r\n}\r\n;\r\nexport default LineGeometry;\r\n//# sourceMappingURL=LineGeometry.js.map","/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n *\r\n */\r\n// import * as THREE from 'three';\r\nimport LineSegments2 from './LineSegments2';\r\nimport LineGeometry from './LineGeometry';\r\nimport LineMaterial from './LineMaterial';\r\nclass Line2 extends LineSegments2 {\r\n    constructor(geometry, material) {\r\n        super(geometry, material);\r\n        this.isLine2 = true;\r\n        this.type = 'Line2';\r\n        this.geometry = geometry !== undefined ? geometry : new LineGeometry();\r\n        this.material = material !== undefined ? material : new LineMaterial({ color: Math.random() * 0xffffff });\r\n    }\r\n    copy(source) {\r\n        return this;\r\n    }\r\n}\r\n;\r\nexport default Line2;\r\n//# sourceMappingURL=Line2.js.map","\"use strict\";\r\nimport * as maptalks from 'maptalks';\r\nimport * as THREE from 'three';\r\nimport Line2 from './util/fatline/Line2';\r\nimport { addAttribute } from './util/ThreeAdaptUtil';\r\nconst OPTIONS = {\r\n    interactive: true,\r\n    altitude: 0,\r\n    minZoom: 0,\r\n    maxZoom: 30,\r\n    asynchronous: false\r\n};\r\n/**\r\n * a Class for Eventable\r\n */\r\nfunction Base() {\r\n}\r\n// class Base {\r\n//     constructor() {\r\n//     }\r\n// }\r\n/**\r\n * EVENTS=[\r\n *  'add',\r\n *  'remove',\r\n    'mousemove',\r\n    'click',\r\n    'mousedown',\r\n    'mouseup',\r\n    'dblclick',\r\n    'contextmenu',\r\n    'touchstart',\r\n    'touchmove',\r\n    'touchend',\r\n    'mouseover',\r\n    'mouseout',\r\n    'idchange',\r\n    'propertieschange',\r\n    'show',\r\n    'hide',\r\n    'symbolchange'\r\n     empty\r\n];\r\n * This is the base class for all 3D objects\r\n *\r\n *\r\n * Its function and maptalks.geometry are as similar as possible\r\n *\r\n * maptalks.Eventable(Base) return a Class  https://github.com/maptalks/maptalks.js/blob/master/src/core/Eventable.js\r\n *\r\n */\r\nclass BaseObject extends maptalks.Eventable(Base) {\r\n    constructor(id) {\r\n        super();\r\n        this.isAdd = false;\r\n        this._mouseover = false;\r\n        this._visible = true;\r\n        this._zoomVisible = true;\r\n        this.picked = false;\r\n        this.isBaseObject = true;\r\n        if (id === undefined) {\r\n            id = maptalks.Util.GUID();\r\n        }\r\n        this.id = id;\r\n    }\r\n    addTo(layer) {\r\n        if (layer && layer.type === 'ThreeLayer') {\r\n            layer.addMesh([this]);\r\n        }\r\n        else {\r\n            console.error('layer only support maptalks.ThreeLayer');\r\n        }\r\n        return this;\r\n    }\r\n    remove() {\r\n        const layer = this.getLayer();\r\n        if (layer) {\r\n            layer.removeMesh([this]);\r\n        }\r\n        return this;\r\n    }\r\n    getObject3d() {\r\n        return this.object3d;\r\n    }\r\n    getId() {\r\n        return this.id;\r\n    }\r\n    setId(id) {\r\n        const oldId = this.getId();\r\n        this.id = id;\r\n        this._fire('idchange', {\r\n            'old': oldId,\r\n            'new': id,\r\n            'target': this\r\n        });\r\n        return this;\r\n    }\r\n    getType() {\r\n        return this.type;\r\n    }\r\n    getOptions() {\r\n        return this.options;\r\n    }\r\n    getProperties() {\r\n        return (this.options || {}).properties;\r\n    }\r\n    setProperties(property) {\r\n        const old = Object.assign({}, this.getProperties());\r\n        this.options.properties = property;\r\n        this._fire('propertieschange', {\r\n            'old': old,\r\n            'new': property,\r\n            'target': this\r\n        });\r\n        return this;\r\n    }\r\n    getLayer() {\r\n        return this.options.layer;\r\n    }\r\n    // eslint-disable-next-line consistent-return\r\n    getMap() {\r\n        const layer = this.getLayer();\r\n        if (layer) {\r\n            return layer.getMap();\r\n        }\r\n    }\r\n    // eslint-disable-next-line consistent-return\r\n    getCenter() {\r\n        const options = this.getOptions();\r\n        const { coordinate, lineString, polygon } = options;\r\n        if (coordinate) {\r\n            return coordinate instanceof maptalks.Coordinate ? coordinate : new maptalks.Coordinate(coordinate);\r\n        }\r\n        else {\r\n            const geometry = polygon || lineString;\r\n            if (geometry && geometry.getCenter) {\r\n                return geometry.getCenter();\r\n            }\r\n        }\r\n    }\r\n    getAltitude() {\r\n        return this.getOptions().altitude;\r\n    }\r\n    /**\r\n     * Different objects need to implement their own methods\r\n     * @param {*} altitude\r\n     */\r\n    setAltitude(altitude) {\r\n        if (maptalks.Util.isNumber(altitude)) {\r\n            const z = this.getLayer().distanceToVector3(altitude, altitude).x;\r\n            this.getObject3d().position.z = z;\r\n            this.options.altitude = altitude;\r\n            if (this.pickObject3d) {\r\n                this.pickObject3d.position.z = z;\r\n            }\r\n            //fix merged mesh\r\n            if (this._baseObjects && Array.isArray(this._baseObjects)) {\r\n                for (let i = 0, len = this._baseObjects.length; i < len; i++) {\r\n                    if (this._baseObjects[i]) {\r\n                        this._baseObjects[i].getObject3d().position.z = z;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n    supportHeight() {\r\n        return this.getOptions().heightEnable;\r\n    }\r\n    getHeight() {\r\n        const { height } = this.getOptions();\r\n        return maptalks.Util.isNumber(height) ? height : 0;\r\n    }\r\n    setHeight(height) {\r\n        if (!maptalks.Util.isNumber(height) || this._baseObjects || !this.supportHeight()) {\r\n            return this;\r\n        }\r\n        const layer = this.getLayer();\r\n        if (!layer) {\r\n            return this;\r\n        }\r\n        const { geometry } = this.getObject3d();\r\n        if (geometry instanceof THREE.BufferGeometry) {\r\n            const { position } = geometry.attributes || {};\r\n            if (!position) {\r\n                return this;\r\n            }\r\n            const array = position.array;\r\n            let min = Infinity, max = -Infinity;\r\n            for (let i = 0, len = array.length; i < len; i += 3) {\r\n                const z = array[i + 2];\r\n                min = Math.min(z, min);\r\n                max = Math.max(z, max);\r\n            }\r\n            const middle = (min + max) / 2;\r\n            const z = layer.distanceToVector3(height, height).x;\r\n            for (let i = 0, len = array.length; i < len; i += 3) {\r\n                if (array[i + 2] > middle) {\r\n                    array[i + 2] = z;\r\n                }\r\n            }\r\n            geometry.attributes.position.needsUpdate = true;\r\n            geometry.computeBoundingBox();\r\n            geometry.computeBoundingSphere();\r\n            this.getOptions().height = height;\r\n        }\r\n        return this;\r\n    }\r\n    show() {\r\n        //  in zoom range\r\n        if (this._zoomVisible) {\r\n            this.getObject3d().visible = true;\r\n            this._fire('show');\r\n        }\r\n        this._visible = true;\r\n        return this;\r\n    }\r\n    hide() {\r\n        this.getObject3d().visible = false;\r\n        this._fire('hide');\r\n        this._visible = false;\r\n        return this;\r\n    }\r\n    isVisible() {\r\n        return (!!this.getObject3d().visible);\r\n    }\r\n    /**\r\n     *  Different objects need to implement their own methods\r\n     */\r\n    getSymbol() {\r\n        return this.getObject3d().material;\r\n    }\r\n    /**\r\n     *  Different objects need to implement their own methods\r\n     * @param {*} material\r\n     */\r\n    setSymbol(material) {\r\n        if (material && material instanceof THREE.Material) {\r\n            material.needsUpdate = true;\r\n            material.vertexColors = this.getObject3d().material.vertexColors;\r\n            const old = this.getObject3d().material.clone();\r\n            this.getObject3d().material = material;\r\n            this._fire('symbolchange', {\r\n                'old': old,\r\n                'new': material,\r\n                'target': this\r\n            });\r\n        }\r\n        return this;\r\n    }\r\n    setInfoWindow(options) {\r\n        this.removeInfoWindow();\r\n        this.infoWindow = new maptalks.ui.InfoWindow(options);\r\n        this.infoWindow.addTo(this);\r\n        return this;\r\n    }\r\n    getInfoWindow() {\r\n        return this.infoWindow;\r\n    }\r\n    openInfoWindow(coordinate) {\r\n        coordinate = coordinate || this.getCenter();\r\n        if (!(coordinate instanceof maptalks.Coordinate)) {\r\n            coordinate = new maptalks.Coordinate(coordinate);\r\n        }\r\n        // eslint-disable-next-line no-unused-expressions\r\n        (coordinate && this.infoWindow && this.infoWindow.show(coordinate));\r\n        return this;\r\n    }\r\n    closeInfoWindow() {\r\n        // eslint-disable-next-line no-unused-expressions\r\n        (this.infoWindow && this.infoWindow.hide());\r\n        return this;\r\n    }\r\n    removeInfoWindow() {\r\n        // eslint-disable-next-line no-unused-expressions\r\n        if (this.infoWindow) {\r\n            this.infoWindow.remove();\r\n            delete this.infoWindow;\r\n        }\r\n        return this;\r\n    }\r\n    setToolTip(content, options) {\r\n        this.removeToolTip();\r\n        this.toolTip = new maptalks.ui.ToolTip(content, options);\r\n        this.toolTip.addTo(this);\r\n        return this;\r\n    }\r\n    getToolTip() {\r\n        return this.toolTip;\r\n    }\r\n    openToolTip(coordinate) {\r\n        coordinate = coordinate || this.getCenter();\r\n        if (!(coordinate instanceof maptalks.Coordinate)) {\r\n            coordinate = new maptalks.Coordinate(coordinate);\r\n        }\r\n        // eslint-disable-next-line no-unused-expressions\r\n        (coordinate && this.toolTip && this.toolTip.show(coordinate));\r\n        return this;\r\n    }\r\n    closeToolTip() {\r\n        // eslint-disable-next-line no-unused-expressions\r\n        (this.toolTip && this.toolTip.hide());\r\n        return this;\r\n    }\r\n    removeToolTip() {\r\n        // eslint-disable-next-line no-unused-expressions\r\n        if (this.toolTip) {\r\n            this.toolTip.remove();\r\n            delete this.toolTip;\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * different components should implement their own animation methods\r\n     * @param {*} options\r\n     * @param {*} cb\r\n     */\r\n    // eslint-disable-next-line no-unused-vars\r\n    animateShow(options = {}, cb) {\r\n        if (this._showPlayer) {\r\n            this._showPlayer.cancel();\r\n        }\r\n        if (maptalks.Util.isFunction(options)) {\r\n            options = {};\r\n            cb = options;\r\n        }\r\n        const duration = options['duration'] || 1000, easing = options['easing'] || 'out';\r\n        const player = this._showPlayer = maptalks.animation.Animation.animate({\r\n            'scale': 1\r\n        }, {\r\n            'duration': duration,\r\n            'easing': easing\r\n        }, frame => {\r\n            const scale = frame.styles.scale;\r\n            if (scale > 0) {\r\n                this.getObject3d().scale.z = scale;\r\n            }\r\n            if (cb) {\r\n                cb(frame, scale);\r\n            }\r\n        });\r\n        player.play();\r\n        return player;\r\n    }\r\n    getMinZoom() {\r\n        return this.getOptions().minZoom;\r\n    }\r\n    getMaxZoom() {\r\n        return this.getOptions().maxZoom;\r\n    }\r\n    isAsynchronous() {\r\n        return this.getOptions().asynchronous;\r\n    }\r\n    fire(eventType, param) {\r\n        this._fire(eventType, param);\r\n        if (this._vt && this._vt.onSelectMesh) {\r\n            this._vt.onSelectMesh(eventType, param);\r\n        }\r\n        return this;\r\n    }\r\n    config() {\r\n        return this;\r\n    }\r\n    setPickObject3d(object3d) {\r\n        this.pickObject3d = object3d;\r\n        this.pickObject3d['__parent'] = this;\r\n        return this;\r\n    }\r\n    /**\r\n     * more method support\r\n     * @param {*} options\r\n     */\r\n    /**\r\n     *\r\n     * @param {*} options\r\n     */\r\n    _initOptions(options) {\r\n        this.options = maptalks.Util.extend({}, OPTIONS, options);\r\n        return this;\r\n    }\r\n    _createMesh(geometry, material) {\r\n        this.object3d = new THREE.Mesh(geometry, material);\r\n        this.object3d['__parent'] = this;\r\n        return this;\r\n    }\r\n    _createGroup() {\r\n        this.object3d = new THREE.Group();\r\n        this.object3d['__parent'] = this;\r\n        return this;\r\n    }\r\n    _createLine(geometry, material) {\r\n        this.object3d = new THREE.Line(geometry, material);\r\n        // (this.object3d as THREE.Line).computeLineDistances();\r\n        this._computeLineDistances(geometry);\r\n        this.object3d['__parent'] = this;\r\n        return this;\r\n    }\r\n    _createLine2(geometry, material) {\r\n        this.object3d = new Line2(geometry, material);\r\n        this.object3d.computeLineDistances();\r\n        this.object3d['__parent'] = this;\r\n        return this;\r\n    }\r\n    // eslint-disable-next-line no-unused-vars\r\n    _createPoints(geometry, material) {\r\n        //Serving for particles\r\n        this.object3d = new THREE.Points(geometry, material);\r\n        this.object3d['__parent'] = this;\r\n        return this;\r\n    }\r\n    _createLineSegments(geometry, material) {\r\n        this.object3d = new THREE.LineSegments(geometry, material);\r\n        // (this.object3d as THREE.LineSegments).computeLineDistances();\r\n        this._computeLineDistances(geometry);\r\n        this.object3d['__parent'] = this;\r\n        return this;\r\n    }\r\n    /**\r\n     * rewrite three.js computeLineDistances ,1.7 speed\r\n     * @param geometry\r\n     */\r\n    _computeLineDistances(geometry) {\r\n        const position = geometry.attributes.position.array;\r\n        const count = geometry.attributes.position.count;\r\n        const lineDistances = new Float32Array(count);\r\n        lineDistances[0] = 0;\r\n        const start = new THREE.Vector3(0, 0, 0), end = new THREE.Vector3(0, 0, 0);\r\n        for (let i = 1; i < count; i++) {\r\n            const idx = (i - 1) * 3;\r\n            start.x = position[idx];\r\n            start.y = position[idx + 1];\r\n            start.z = position[idx + 2];\r\n            const idx1 = i * 3;\r\n            end.x = position[idx1];\r\n            end.y = position[idx1 + 1];\r\n            end.z = position[idx1 + 2];\r\n            const distance = end.distanceTo(start);\r\n            lineDistances[i] = lineDistances[i - 1] + distance;\r\n        }\r\n        addAttribute(geometry, 'lineDistance', new THREE.BufferAttribute(lineDistances, 1));\r\n    }\r\n}\r\nexport default BaseObject;\r\n//# sourceMappingURL=BaseObject.js.map","import * as THREE from 'three';\r\nimport { addAttribute } from './ThreeAdaptUtil';\r\nexport function mergeBufferGeometries(geometries) {\r\n    const { position, normal, uv, indices } = mergeBufferGeometriesAttribute(geometries);\r\n    const bufferGeomertry = new THREE.BufferGeometry();\r\n    const color = new Float32Array(position.length);\r\n    color.fill(1, 0, position.length);\r\n    addAttribute(bufferGeomertry, 'color', new THREE.BufferAttribute(color, 3));\r\n    addAttribute(bufferGeomertry, 'normal', new THREE.BufferAttribute(normal, 3));\r\n    addAttribute(bufferGeomertry, 'position', new THREE.BufferAttribute(position, 3));\r\n    if (uv && uv.length) {\r\n        addAttribute(bufferGeomertry, 'uv', new THREE.BufferAttribute(uv, 2));\r\n    }\r\n    bufferGeomertry.setIndex(new THREE.BufferAttribute(indices, 1));\r\n    return bufferGeomertry;\r\n}\r\nexport function mergeBufferGeometriesAttribute(geometries) {\r\n    const attributes = {}, attributesLen = {};\r\n    for (let i = 0; i < geometries.length; ++i) {\r\n        const geometry = geometries[i];\r\n        for (const name in geometry) {\r\n            if (attributes[name] === undefined) {\r\n                attributes[name] = [];\r\n                attributesLen[name] = 0;\r\n            }\r\n            attributes[name].push(geometry[name]);\r\n            attributesLen[name] += geometry[name].length;\r\n        }\r\n    }\r\n    // merge attributes\r\n    const mergedGeometry = {};\r\n    let indexOffset = 0;\r\n    const mergedIndex = new Uint32Array(attributesLen['indices']);\r\n    for (const name in attributes) {\r\n        if (name === 'indices') {\r\n            const indices = attributes[name];\r\n            let iIndex = 0;\r\n            for (let i = 0, len = indices.length; i < len; i++) {\r\n                const index = indices[i];\r\n                for (let j = 0, len1 = index.length; j < len1; j++) {\r\n                    mergedIndex[iIndex] = index[j] + indexOffset;\r\n                    iIndex++;\r\n                    // mergedIndex.push(index[j] + indexOffset);\r\n                }\r\n                indexOffset += attributes['position'][i].length / 3;\r\n            }\r\n        }\r\n        else {\r\n            const mergedAttribute = mergeBufferAttributes(attributes[name], attributesLen[name]);\r\n            if (!mergedAttribute)\r\n                return null;\r\n            mergedGeometry[name] = mergedAttribute;\r\n        }\r\n    }\r\n    mergedGeometry['indices'] = mergedIndex;\r\n    return mergedGeometry;\r\n}\r\nfunction mergeBufferAttributes(attributes, arrayLength) {\r\n    const array = new Float32Array(arrayLength);\r\n    let offset = 0;\r\n    for (let i = 0; i < attributes.length; ++i) {\r\n        array.set(attributes[i], offset);\r\n        offset += attributes[i].length;\r\n    }\r\n    return array;\r\n}\r\nexport function generateBufferGeometry(data) {\r\n    //arraybuffer data\r\n    const { position, normal, uv, indices } = data;\r\n    // const color = new Float32Array(position.length);\r\n    // color.fill(1, 0, position.length);\r\n    const bufferGeomertry = new THREE.BufferGeometry();\r\n    // addAttribute(bufferGeomertry, 'color', new THREE.BufferAttribute(color, 3));\r\n    addAttribute(bufferGeomertry, 'normal', new THREE.BufferAttribute(new Float32Array(normal), 3));\r\n    addAttribute(bufferGeomertry, 'position', new THREE.BufferAttribute(new Float32Array(position), 3));\r\n    addAttribute(bufferGeomertry, 'uv', new THREE.BufferAttribute(new Float32Array(uv), 2));\r\n    bufferGeomertry.setIndex(new THREE.BufferAttribute(new Uint32Array(indices), 1));\r\n    return bufferGeomertry;\r\n}\r\nexport function generatePickBufferGeometry(geometry) {\r\n    const bufferGeomertry = new THREE.BufferGeometry();\r\n    addAttribute(bufferGeomertry, 'normal', geometry.getAttribute('normal'));\r\n    addAttribute(bufferGeomertry, 'position', geometry.getAttribute('position').clone());\r\n    bufferGeomertry.setIndex(geometry.getIndex());\r\n    return bufferGeomertry;\r\n}\r\nlet defaultBufferGeometry;\r\nexport function getDefaultBufferGeometry() {\r\n    if (!defaultBufferGeometry) {\r\n        const SIZE = 0.000001;\r\n        defaultBufferGeometry = new THREE.BoxBufferGeometry(SIZE, SIZE, SIZE);\r\n    }\r\n    return defaultBufferGeometry;\r\n}\r\ngetDefaultBufferGeometry();\r\n//# sourceMappingURL=MergeGeometryUtil.js.map","import * as THREE from 'three';\r\nimport { mergeBufferGeometries } from './MergeGeometryUtil';\r\nimport { addAttribute } from './ThreeAdaptUtil';\r\nconst barGeometryCache = {};\r\nconst defaultBoxGeometry = new THREE.BoxBufferGeometry(1, 1, 1);\r\ndefaultBoxGeometry.translate(0, 0, 0.5);\r\nconst topColor = new THREE.Color('#fff'), bottomColor = new THREE.Color('#fff');\r\nfunction getDefaultCylinderBufferGeometry(radialSegments = 6) {\r\n    if (!barGeometryCache[radialSegments]) {\r\n        const geometry = new THREE.CylinderBufferGeometry(1, 1, 1, radialSegments, 1);\r\n        geometry.rotateX(Math.PI / 2);\r\n        geometry.translate(0, 0, 0.5);\r\n        geometry.rotateZ(Math.PI / 6);\r\n        barGeometryCache[radialSegments] = geometry;\r\n    }\r\n    return barGeometryCache[radialSegments];\r\n}\r\n/**\r\n * Reuse Geometry   , Meter as unit\r\n * @param {*} property\r\n */\r\n// eslint-disable-next-line no-unused-vars\r\nexport function getGeometry(property) {\r\n    const { height, radialSegments, radius } = property;\r\n    const geometry = getDefaultCylinderBufferGeometry(radialSegments).clone();\r\n    geometry.scale(radius, radius, height);\r\n    return geometry;\r\n}\r\n/**\r\n * init Colors\r\n * @param {*} geometry\r\n * @param {*} color\r\n * @param {*} _topColor\r\n */\r\nexport function initVertexColors(geometry, color, _topColor, key = 'y', v = 0) {\r\n    let offset = 0;\r\n    if (key === 'y') {\r\n        offset = 1;\r\n    }\r\n    else if (key === 'z') {\r\n        offset = 2;\r\n    }\r\n    const position = geometry.attributes.position.array;\r\n    const len = position.length;\r\n    bottomColor.setStyle(color);\r\n    topColor.setStyle(_topColor);\r\n    const colors = new Float32Array(len);\r\n    for (let i = 0; i < len; i += 3) {\r\n        const y = position[i + offset];\r\n        if (y > v) {\r\n            colors[i] = topColor.r;\r\n            colors[i + 1] = topColor.g;\r\n            colors[i + 2] = topColor.b;\r\n            // colors.push(topColor.r, topColor.g, topColor.b);\r\n        }\r\n        else {\r\n            colors[i] = bottomColor.r;\r\n            colors[i + 1] = bottomColor.g;\r\n            colors[i + 2] = bottomColor.b;\r\n            // colors.push(bottomColor.r, bottomColor.g, bottomColor.b);\r\n        }\r\n    }\r\n    addAttribute(geometry, 'color', new THREE.BufferAttribute(colors, 3, true));\r\n    return colors;\r\n}\r\nexport function mergeBarGeometry(geometries) {\r\n    const attributes = [];\r\n    const len = geometries.length;\r\n    let colorLen = 0;\r\n    for (let i = 0; i < len; i++) {\r\n        const { color } = geometries[i].attributes;\r\n        if (color) {\r\n            colorLen += color.array.length;\r\n        }\r\n    }\r\n    const colors = new Float32Array(colorLen);\r\n    let offset = 0;\r\n    for (let i = 0, len = geometries.length; i < len; i++) {\r\n        const { color, normal, position, uv } = geometries[i].attributes;\r\n        const index = geometries[i].index;\r\n        if (color) {\r\n            colors.set(color.array, offset);\r\n            offset += color.array.length;\r\n            // for (let j = 0, len1 = color.array.length; j < len1; j++) {\r\n            //     colors.push(color.array[j]);\r\n            // }\r\n        }\r\n        attributes.push({\r\n            // color: color.array,\r\n            normal: normal.array,\r\n            uv: uv.array,\r\n            position: position.array,\r\n            indices: index.array\r\n        });\r\n    }\r\n    const bufferGeometry = mergeBufferGeometries(attributes);\r\n    if (colors.length) {\r\n        addAttribute(bufferGeometry, 'color', new THREE.BufferAttribute(colors, 3, true));\r\n        // for (let i = 0, len = colors.length; i < len; i++) {\r\n        //     bufferGeometry.attributes.color.array[i] = colors[i];\r\n        // }\r\n    }\r\n    for (let i = 0, len = geometries.length; i < len; i++) {\r\n        geometries[i].dispose();\r\n    }\r\n    return bufferGeometry;\r\n}\r\nexport function getDefaultBoxGeometry() {\r\n    return defaultBoxGeometry;\r\n}\r\n//# sourceMappingURL=BarUtil.js.map","import * as maptalks from 'maptalks';\r\nimport BaseObject from './BaseObject';\r\nimport { getGeometry, initVertexColors } from './util/BarUtil';\r\nimport { getVertexColors } from './util/ThreeAdaptUtil';\r\nconst OPTIONS = {\r\n    radius: 10,\r\n    height: 100,\r\n    radialSegments: 6,\r\n    altitude: 0,\r\n    topColor: '',\r\n    bottomColor: '#2d2f61',\r\n    heightEnable: true\r\n};\r\n/**\r\n *\r\n */\r\nclass Bar extends BaseObject {\r\n    constructor(coordinate, options, material, layer) {\r\n        options = maptalks.Util.extend({}, OPTIONS, options, { layer, coordinate });\r\n        super();\r\n        this._initOptions(options);\r\n        const { height, radius, topColor, bottomColor, altitude } = options;\r\n        options.height = layer.distanceToVector3(height, height).x;\r\n        options.radius = layer.distanceToVector3(radius, radius).x;\r\n        // Meter as unit\r\n        options['_radius'] = this.options['radius'];\r\n        options['_height'] = this.options['height'];\r\n        const geometry = getGeometry(options);\r\n        if (topColor) {\r\n            initVertexColors(geometry, bottomColor, topColor, 'z', options.height / 2);\r\n            material.vertexColors = getVertexColors();\r\n        }\r\n        this._createMesh(geometry, material);\r\n        const z = layer.distanceToVector3(altitude, altitude).x;\r\n        const position = layer.coordinateToVector3(coordinate, z);\r\n        this.getObject3d().position.copy(position);\r\n        this.type = 'Bar';\r\n    }\r\n}\r\nexport default Bar;\r\n//# sourceMappingURL=Bar.js.map","/* eslint-disable indent */\r\nimport * as maptalks from 'maptalks';\r\nconst TYPES = ['Point', 'MultiPoint', 'LineString', 'MultiLineString', 'Polygon', 'MultiPolygon'];\r\nfunction getGeoJSONType(feature) {\r\n    return feature.geometry ? feature.geometry.type : null;\r\n}\r\nexport function isGeoJSON(feature) {\r\n    const type = getGeoJSONType(feature);\r\n    if (type) {\r\n        for (let i = 0, len = TYPES.length; i < len; i++) {\r\n            if (TYPES[i] === type) {\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n    return false;\r\n}\r\nexport function isGeoJSONPolygon(feature) {\r\n    const type = getGeoJSONType(feature);\r\n    if (type && (type === TYPES[4] || type === TYPES[5])) {\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\nexport function isGeoJSONLine(feature) {\r\n    const type = getGeoJSONType(feature);\r\n    if (type && (type === TYPES[2] || type === TYPES[3])) {\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\nexport function isGeoJSONPoint(feature) {\r\n    const type = getGeoJSONType(feature);\r\n    if (type && (type === TYPES[0] || type === TYPES[1])) {\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\nexport function isGeoJSONMulti(feature) {\r\n    const type = getGeoJSONType(feature);\r\n    if (type) {\r\n        if (type.indexOf('Multi') > -1) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\nexport function getGeoJSONCoordinates(feature) {\r\n    return feature.geometry ? feature.geometry.coordinates : [];\r\n}\r\nexport function getGeoJSONCenter(feature, out) {\r\n    const type = getGeoJSONType(feature);\r\n    if (!type || !feature.geometry) {\r\n        return null;\r\n    }\r\n    const geometry = feature.geometry;\r\n    const coordinates = geometry.coordinates;\r\n    if (!coordinates) {\r\n        return null;\r\n    }\r\n    // const coords: Array<Array<number>> = [];\r\n    let sumX = 0, sumY = 0, coordLen = 0;\r\n    switch (type) {\r\n        case 'Point': {\r\n            sumX = coordinates[0];\r\n            sumY = coordinates[1];\r\n            // coords.push(coordinates as Array<number>);\r\n            coordLen++;\r\n            break;\r\n        }\r\n        case 'MultiPoint':\r\n        case 'LineString': {\r\n            for (let i = 0, len = coordinates.length; i < len; i++) {\r\n                sumX += coordinates[i][0];\r\n                sumY += coordinates[i][1];\r\n                coordLen++;\r\n                // coords.push(coordinates[i] as Array<number>);\r\n            }\r\n            break;\r\n        }\r\n        case 'MultiLineString':\r\n        case 'Polygon': {\r\n            for (let i = 0, len = coordinates.length; i < len; i++) {\r\n                for (let j = 0, len1 = coordinates[i].length; j < len1; j++) {\r\n                    // coords.push((coordinates[i] as Array<Array<number>>)[j]);\r\n                    sumX += coordinates[i][j][0];\r\n                    sumY += coordinates[i][j][1];\r\n                    coordLen++;\r\n                }\r\n            }\r\n            break;\r\n        }\r\n        case 'MultiPolygon': {\r\n            for (let i = 0, len = coordinates.length; i < len; i++) {\r\n                for (let j = 0, len1 = coordinates[i].length; j < len1; j++) {\r\n                    for (let m = 0, len2 = coordinates[i][j].length; m < len2; m++) {\r\n                        // coords.push(((coordinates[i] as Array<Array<Array<number>>>)[j])[m]);\r\n                        sumX += coordinates[i][j][m][0];\r\n                        sumY += coordinates[i][j][m][1];\r\n                        coordLen++;\r\n                    }\r\n                }\r\n            }\r\n            break;\r\n        }\r\n    }\r\n    const x = sumX / coordLen, y = sumY / coordLen;\r\n    if (out) {\r\n        out.x = x;\r\n        out.y = y;\r\n        return out;\r\n    }\r\n    return new maptalks.Coordinate(x, y);\r\n}\r\nexport function spliteGeoJSONMulti(feature) {\r\n    const type = getGeoJSONType(feature);\r\n    if (!type || !feature.geometry) {\r\n        return null;\r\n    }\r\n    const geometry = feature.geometry;\r\n    const properties = feature.properties || {};\r\n    const coordinates = geometry.coordinates;\r\n    if (!coordinates) {\r\n        return null;\r\n    }\r\n    const features = [];\r\n    let fType;\r\n    switch (type) {\r\n        case 'MultiPoint': {\r\n            fType = 'Point';\r\n            break;\r\n        }\r\n        case 'MultiLineString': {\r\n            fType = 'LineString';\r\n            break;\r\n        }\r\n        case 'MultiPolygon': {\r\n            fType = 'Polygon';\r\n            break;\r\n        }\r\n    }\r\n    if (fType) {\r\n        for (let i = 0, len = coordinates.length; i < len; i++) {\r\n            features.push({\r\n                type: 'Feature',\r\n                geometry: {\r\n                    type: fType,\r\n                    coordinates: coordinates[i]\r\n                },\r\n                properties\r\n            });\r\n        }\r\n    }\r\n    else {\r\n        features.push(feature);\r\n    }\r\n    return features;\r\n}\r\n//# sourceMappingURL=GeoJSONUtil.js.map","/*\r\n (c) 2017, Vladimir Agafonkin\r\n Simplify.js, a high-performance JS polyline simplification library\r\n mourner.github.io/simplify-js\r\n*/\r\n\r\n// to suit your point format, run search/replace for '.x' and '.y';\r\n// for 3D version, see 3d branch (configurability would draw significant performance overhead)\r\n\r\n// square distance between 2 points\r\nfunction getSqDist(p1, p2) {\r\n\r\n    var dx = p1[0] - p2[0],\r\n        dy = p1[1] - p2[1];\r\n\r\n    return dx * dx + dy * dy;\r\n}\r\n\r\n// square distance from a point to a segment\r\nfunction getSqSegDist(p, p1, p2) {\r\n\r\n    var x = p1[0],\r\n        y = p1[1],\r\n        dx = p2[0] - x,\r\n        dy = p2[1] - y;\r\n\r\n    if (dx !== 0 || dy !== 0) {\r\n\r\n        var t = ((p[0] - x) * dx + (p[1] - y) * dy) / (dx * dx + dy * dy);\r\n\r\n        if (t > 1) {\r\n            x = p2[0];\r\n            y = p2[1];\r\n\r\n        } else if (t > 0) {\r\n            x += dx * t;\r\n            y += dy * t;\r\n        }\r\n    }\r\n\r\n    dx = p[0] - x;\r\n    dy = p[1] - y;\r\n\r\n    return dx * dx + dy * dy;\r\n}\r\n// rest of the code doesn't care about point format\r\n\r\n// basic distance-based simplification\r\nfunction simplifyRadialDist(points, sqTolerance) {\r\n\r\n    var prevPoint = points[0],\r\n        newPoints = [prevPoint],\r\n        point;\r\n\r\n    for (var i = 1, len = points.length; i < len; i++) {\r\n        point = points[i];\r\n\r\n        if (getSqDist(point, prevPoint) > sqTolerance) {\r\n            newPoints.push(point);\r\n            prevPoint = point;\r\n        }\r\n    }\r\n\r\n    if (prevPoint !== point) newPoints.push(point);\r\n\r\n    return newPoints;\r\n}\r\n\r\nfunction simplifyDPStep(points, first, last, sqTolerance, simplified) {\r\n    var maxSqDist = sqTolerance,\r\n        index;\r\n\r\n    for (var i = first + 1; i < last; i++) {\r\n        var sqDist = getSqSegDist(points[i], points[first], points[last]);\r\n\r\n        if (sqDist > maxSqDist) {\r\n            index = i;\r\n            maxSqDist = sqDist;\r\n        }\r\n    }\r\n\r\n    if (maxSqDist > sqTolerance) {\r\n        if (index - first > 1) simplifyDPStep(points, first, index, sqTolerance, simplified);\r\n        simplified.push(points[index]);\r\n        if (last - index > 1) simplifyDPStep(points, index, last, sqTolerance, simplified);\r\n    }\r\n}\r\n\r\n// simplification using Ramer-Douglas-Peucker algorithm\r\nfunction simplifyDouglasPeucker(points, sqTolerance) {\r\n    var last = points.length - 1;\r\n\r\n    var simplified = [points[0]];\r\n    simplifyDPStep(points, 0, last, sqTolerance, simplified);\r\n    simplified.push(points[last]);\r\n\r\n    return simplified;\r\n}\r\n\r\n// both algorithms combined for awesome performance\r\nfunction simplify(points, tolerance, highestQuality) {\r\n\r\n    if (points.length <= 2) return points;\r\n\r\n    var sqTolerance = tolerance !== undefined ? tolerance * tolerance : 1;\r\n\r\n    points = highestQuality ? points : simplifyRadialDist(points, sqTolerance);\r\n    points = simplifyDouglasPeucker(points, sqTolerance);\r\n\r\n    return points;\r\n}\r\nexport default simplify;","export function dot(v1, v2) {\r\n    return v1[0] * v2[0] + v1[1] * v2[1] + v1[2] * v2[2];\r\n}\r\nexport function v2Dot(v1, v2) {\r\n    return v1[0] * v2[0] + v1[1] * v2[1];\r\n}\r\n\r\nexport function normalize(out, v) {\r\n    const x = v[0];\r\n    const y = v[1];\r\n    const z = v[2];\r\n    const d = Math.sqrt(x * x + y * y + z * z);\r\n    out[0] = x / d;\r\n    out[1] = y / d;\r\n    out[2] = z / d;\r\n    return out;\r\n}\r\n\r\nexport function v2Normalize(out, v) {\r\n    const x = v[0];\r\n    const y = v[1];\r\n    const d = Math.sqrt(x * x + y * y);\r\n    out[0] = x / d;\r\n    out[1] = y / d;\r\n    return out;\r\n}\r\n\r\nexport function scale(out, v, s) {\r\n    out[0] = v[0] * s;\r\n    out[1] = v[1] * s;\r\n    out[2] = v[2] * s;\r\n    return out;\r\n}\r\n\r\nexport function mul(out, v1, v2) {\r\n    out[0] = v1[0] * v2[0];\r\n    out[1] = v1[1] * v2[1];\r\n    out[2] = v1[2] * v2[2];\r\n    return out;\r\n}\r\n\r\nexport function scaleAndAdd(out, v1, v2, s) {\r\n    out[0] = v1[0] + v2[0] * s;\r\n    out[1] = v1[1] + v2[1] * s;\r\n    out[2] = v1[2] + v2[2] * s;\r\n    return out;\r\n}\r\n\r\nexport function add(out, v1, v2) {\r\n    out[0] = v1[0] + v2[0];\r\n    out[1] = v1[1] + v2[1];\r\n    out[2] = v1[2] + v2[2];\r\n    return out;\r\n}\r\n\r\nexport function v2Add(out, v1, v2) {\r\n    out[0] = v1[0] + v2[0];\r\n    out[1] = v1[1] + v2[1];\r\n    return out;\r\n}\r\n\r\nexport function sub(out, v1, v2) {\r\n    out[0] = v1[0] - v2[0];\r\n    out[1] = v1[1] - v2[1];\r\n    out[2] = v1[2] - v2[2];\r\n    return out;\r\n}\r\n\r\nexport function v2Sub(out, v1, v2) {\r\n    out[0] = v1[0] - v2[0];\r\n    out[1] = v1[1] - v2[1];\r\n    return out;\r\n}\r\n\r\nexport function v3Sub(out, v1, v2) {\r\n    out[0] = v1[0] - v2[0];\r\n    out[1] = v1[1] - v2[1];\r\n    out[2] = v1[2] - v2[2];\r\n    return out;\r\n}\r\n\r\nexport function v3Normalize(out, v) {\r\n    const x = v[0];\r\n    const y = v[1];\r\n    const z = v[2];\r\n    const d = Math.sqrt(x * x + y * y + z * z);\r\n    out[0] = x / d;\r\n    out[1] = y / d;\r\n    out[2] = z / d;\r\n    return out;\r\n}\r\n\r\nexport function v3Cross(out, v1, v2) {\r\n    var ax = v1[0], ay = v1[1], az = v1[2],\r\n        bx = v2[0], by = v2[1], bz = v2[2];\r\n\r\n    out[0] = ay * bz - az * by;\r\n    out[1] = az * bx - ax * bz;\r\n    out[2] = ax * by - ay * bx;\r\n    return out;\r\n}\r\n\r\nconst rel = [];\r\n// start and end must be normalized\r\nexport function slerp(out, start, end, t) {\r\n    // https://keithmaggio.wordpress.com/2011/02/15/math-magician-lerp-slerp-and-nlerp/\r\n    const cosT = dot(start, end);\r\n    const theta = Math.acos(cosT) * t;\r\n\r\n    scaleAndAdd(rel, end, start, -cosT);\r\n    normalize(rel, rel);// start and rel Orthonormal basis\r\n\r\n    scale(out, start, Math.cos(theta));\r\n    scaleAndAdd(out, out, rel, Math.sin(theta));\r\n\r\n    return out;\r\n}\r\n\r\nexport function lineIntersection(x1, y1, x2, y2, x3, y3, x4, y4, out, writeOffset) {\r\n    const dx1 = x2 - x1;\r\n    const dx2 = x4 - x3;\r\n    const dy1 = y2 - y1;\r\n    const dy2 = y4 - y3;\r\n\r\n    const cross = dy2 * dx1 - dx2 * dy1;\r\n    const tmp1 = y1 - y3;\r\n    const tmp2 = x1 - x3;\r\n    const t1 = (dx2 * tmp1 - dy2 * tmp2) / cross;\r\n    // const t2 = (dx1 * tmp1 - dy1 * tmp2) / cross;\r\n\r\n    if (out) {\r\n        writeOffset = writeOffset || 0;\r\n        out[writeOffset] = x1 + t1 * (x2 - x1);\r\n        out[writeOffset + 1] = y1 + t1 * (y2 - y1);\r\n    }\r\n\r\n    return t1;\r\n}\r\n\r\nexport function area(points, start, end) {\r\n    // Signed polygon area\r\n    const n = end - start;\r\n    if (n < 3) {\r\n        return 0;\r\n    }\r\n    let area = 0;\r\n    for (let i = (end - 1) * 2, j = start * 2; j < end * 2;) {\r\n        const x0 = points[i];\r\n        const y0 = points[i + 1];\r\n        const x1 = points[j];\r\n        const y1 = points[j + 1];\r\n        i = j;\r\n        j += 2;\r\n        area += x0 * y1 - x1 * y0;\r\n    }\r\n\r\n    return area;\r\n}\r\n\r\n\r\nexport function triangleArea(x0, y0, x1, y1, x2, y2) {\r\n    return (x1 - x0) * (y2 - y1) - (y1 - y0) * (x2 - x1);\r\n}","// TODO fitRect x, y are negative?\r\n// TODO Extrude dimensions\r\n// TODO bevel=\"top\"|\"bottom\"\r\n// TODO Not add top and bottom vertices if area is 0\r\n\r\nimport earcut from 'earcut';\r\nimport doSimplify from './simplify';\r\nimport {\r\n    slerp, v2Normalize, v2Dot, v2Add, area,\r\n    v3Normalize, v3Sub, v3Cross, lineIntersection\r\n} from './math';\r\n\r\nexport function triangulate(vertices, holes, dimensions = 2) {\r\n    return earcut(vertices, holes, dimensions);\r\n};\r\n\r\nexport function flatten(data) {\r\n    return earcut.flatten(data);\r\n}\r\n\r\nconst v1 = [];\r\nconst v2 = [];\r\nconst v = [];\r\n\r\nfunction innerOffsetPolygon(\r\n    vertices, out, start, end, outStart, offset, miterLimit, close,\r\n    removeIntersections,\r\n    // offsetLines\r\n) {\r\n    const checkMiterLimit = miterLimit != null;\r\n    let cursor = outStart;\r\n    let indicesMap = null;\r\n    if (checkMiterLimit) {\r\n        indicesMap = new Uint32Array(end - start);\r\n    }\r\n    let prevOffsetX;\r\n    let prevOffsetY;\r\n    let prevCursor;\r\n    let tmpIntersection = [];\r\n\r\n    for (let i = start; i < end; i++) {\r\n        const nextIdx = i === end - 1 ? start : i + 1;\r\n        const prevIdx = i === start ? end - 1 : i - 1;\r\n        const x1 = vertices[prevIdx * 2];\r\n        const y1 = vertices[prevIdx * 2 + 1];\r\n        const x2 = vertices[i * 2];\r\n        const y2 = vertices[i * 2 + 1];\r\n        const x3 = vertices[nextIdx * 2];\r\n        const y3 = vertices[nextIdx * 2 + 1];\r\n\r\n        v1[0] = x2 - x1;\r\n        v1[1] = y2 - y1;\r\n        v2[0] = x3 - x2;\r\n        v2[1] = y3 - y2;\r\n\r\n        v2Normalize(v1, v1);\r\n        v2Normalize(v2, v2);\r\n\r\n        checkMiterLimit && (indicesMap[i] = cursor);\r\n\r\n        let needCheckIntersection = false;\r\n        let offsetX;\r\n        let offsetY;\r\n        if (!close && i === start) {\r\n            v[0] = v2[1];\r\n            v[1] = -v2[0];\r\n            v2Normalize(v, v);\r\n            prevOffsetX = out[cursor * 2] = x2 + v[0] * offset;\r\n            prevOffsetY = out[cursor * 2 + 1] = y2 + v[1] * offset;\r\n            prevCursor = cursor;\r\n\r\n            // offsetLines && offsetLines.push([x2, y2, prevOffsetX, prevOffsetY, cursor])\r\n            cursor++;\r\n        }\r\n        else if (!close && i === end - 1) {\r\n            v[0] = v1[1];\r\n            v[1] = -v1[0];\r\n            v2Normalize(v, v);\r\n\r\n            offsetX = x2 + v[0] * offset;\r\n            offsetY = y2 + v[1] * offset;\r\n\r\n            needCheckIntersection = true;\r\n        }\r\n        else {\r\n            // PENDING Why using sub will lost the direction info.\r\n            v2Add(v, v2, v1);\r\n            const tmp = v[1];\r\n            v[1] = -v[0];\r\n            v[0] = tmp;\r\n\r\n            v2Normalize(v, v);\r\n\r\n            const cosA = v2Dot(v, v2);\r\n            const sinA = Math.sqrt(1 - cosA * cosA);\r\n            // PENDING\r\n            // Make sure it's offset lines instead of vertices.\r\n            const miter = offset * Math.min(10, 1 / sinA);\r\n\r\n            const isCovex = offset * cosA < 0;\r\n\r\n            if (checkMiterLimit && (1 / sinA) > miterLimit && isCovex) {\r\n                // No need to check line intersection on the outline.\r\n                const mx = x2 + v[0] * offset;\r\n                const my = y2 + v[1] * offset;\r\n                const halfA = Math.acos(sinA) / 2;\r\n                const dist = Math.tan(halfA) * Math.abs(offset);\r\n                out[cursor * 2] = mx + v[1] * dist;\r\n                out[cursor * 2 + 1] = my - v[0] * dist;\r\n                cursor++;\r\n                out[cursor * 2] = mx - v[1] * dist;\r\n                out[cursor * 2 + 1] = my + v[0] * dist;\r\n                cursor++;\r\n            }\r\n            else {\r\n                offsetX = x2 + v[0] * miter;\r\n                offsetY = y2 + v[1] * miter;\r\n                needCheckIntersection = true;\r\n            }\r\n\r\n            if (needCheckIntersection) {\r\n                // TODO Handle with whole.\r\n                if (removeIntersections && prevOffsetX != null) {\r\n                    // Greedy, only check with previous offset line\r\n                    // PENDING: Is it necessary to check with other lines?\r\n                    const t = lineIntersection(\r\n                        x1, y1, prevOffsetX, prevOffsetY,\r\n                        x2, y2, offsetX, offsetY, tmpIntersection, 0\r\n                    );\r\n                    // Use a eplison\r\n                    if (t >= -1e-2 && t <= 1 + 1e-2) {\r\n                        // Update previous offset points.\r\n                        out[prevCursor * 2] = offsetX = tmpIntersection[0];\r\n                        out[prevCursor * 2 + 1] = offsetY = tmpIntersection[1];\r\n                    }\r\n                }\r\n\r\n                prevOffsetX = out[cursor * 2] = offsetX;\r\n                prevOffsetY = out[cursor * 2 + 1] = offsetY;\r\n                prevCursor = cursor;\r\n\r\n                // offsetLines && offsetLines.push([x2, y2, offsetX, offsetY, cursor])\r\n\r\n                cursor++;\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    return indicesMap;\r\n}\r\n\r\n\r\n\r\nfunction innerOffsetPolyline(\r\n    vertices, out, start, end, outStart, offset, miterLimit, close\r\n) {\r\n    const checkMiterLimit = miterLimit != null;\r\n    let outOff = outStart;\r\n    let indicesMap = null;\r\n    if (checkMiterLimit) {\r\n        indicesMap = new Uint32Array(end - start);\r\n    }\r\n    for (let i = start; i < end; i++) {\r\n        const nextIdx = i === end - 1 ? start : i + 1;\r\n        const prevIdx = i === start ? end - 1 : i - 1;\r\n        const x1 = vertices[prevIdx * 2];\r\n        const y1 = vertices[prevIdx * 2 + 1];\r\n        const x2 = vertices[i * 2];\r\n        const y2 = vertices[i * 2 + 1];\r\n        const x3 = vertices[nextIdx * 2];\r\n        const y3 = vertices[nextIdx * 2 + 1];\r\n\r\n        v1[0] = x2 - x1;\r\n        v1[1] = y2 - y1;\r\n        v2[0] = x3 - x2;\r\n        v2[1] = y3 - y2;\r\n\r\n        v2Normalize(v1, v1);\r\n        v2Normalize(v2, v2);\r\n\r\n        checkMiterLimit && (indicesMap[i] = outOff);\r\n        if (!close && i === start) {\r\n            v[0] = v2[1];\r\n            v[1] = -v2[0];\r\n            v2Normalize(v, v);\r\n            out[outOff * 2] = x2 + v[0] * offset;\r\n            out[outOff * 2 + 1] = y2 + v[1] * offset;\r\n            outOff++;\r\n        }\r\n        else if (!close && i === end - 1) {\r\n            v[0] = v1[1];\r\n            v[1] = -v1[0];\r\n            v2Normalize(v, v);\r\n            out[outOff * 2] = x2 + v[0] * offset;\r\n            out[outOff * 2 + 1] = y2 + v[1] * offset;\r\n            outOff++;\r\n        }\r\n        else {\r\n            // PENDING Why using sub will lost the direction info.\r\n            v2Add(v, v2, v1);\r\n            const tmp = v[1];\r\n            v[1] = -v[0];\r\n            v[0] = tmp;\r\n\r\n            v2Normalize(v, v);\r\n\r\n            const cosA = v2Dot(v, v2);\r\n            const sinA = Math.sqrt(1 - cosA * cosA);\r\n            // PENDING\r\n            const miter = offset * Math.min(10, 1 / sinA);\r\n\r\n            const isCovex = offset * cosA < 0;\r\n\r\n            if (checkMiterLimit && (1 / sinA) > miterLimit && isCovex) {\r\n                const mx = x2 + v[0] * offset;\r\n                const my = y2 + v[1] * offset;\r\n                const halfA = Math.acos(sinA) / 2;\r\n                const dist = Math.tan(halfA) * Math.abs(offset);\r\n                out[outOff * 2] = mx + v[1] * dist;\r\n                out[outOff * 2 + 1] = my - v[0] * dist;\r\n                outOff++;\r\n                out[outOff * 2] = mx - v[1] * dist;\r\n                out[outOff * 2 + 1] = my + v[0] * dist;\r\n                outOff++;\r\n            }\r\n            else {\r\n                out[outOff * 2] = x2 + v[0] * miter;\r\n                out[outOff * 2 + 1] = y2 + v[1] * miter;\r\n                outOff++;\r\n            }\r\n        }\r\n    }\r\n\r\n    return indicesMap;\r\n}\r\n\r\nexport function offsetPolygon(vertices, holes, offset, miterLimit, close) {\r\n    const offsetVertices = miterLimit != null ? [] : new Float32Array(vertices.length);\r\n    const exteriorSize = (holes && holes.length) ? holes[0] : vertices.length / 2;\r\n\r\n    const offsetLines = [];\r\n\r\n    innerOffsetPolygon(\r\n        vertices, offsetVertices, 0, exteriorSize, 0, offset, miterLimit, close, true\r\n    );\r\n\r\n    if (holes) {\r\n        for (let i = 0; i < holes.length; i++) {\r\n            const start = holes[i];\r\n            const end = holes[i + 1] || vertices.length / 2;\r\n            innerOffsetPolygon(\r\n                vertices, offsetVertices, start, end,\r\n                miterLimit != null ? offsetVertices.length / 2 : start,\r\n                offset, miterLimit, close, false\r\n            );\r\n        }\r\n    }\r\n\r\n    // TODO holes\r\n    // Remove intersections of offseted polygon\r\n    // let len = offsetLines.length;\r\n    // let tmpIntersection = [];\r\n    // for (let i = 0; i < len; i++) {\r\n    //     const line1 = offsetLines[i];\r\n    //     for (let k = i + 1; k < len; k++) {\r\n    //         const line2 = offsetLines[k];\r\n\r\n    //         const t = lineIntersection(\r\n    //             line1[0], line1[1], line1[2], line1[3],\r\n    //             line2[0], line2[1], line2[2], line2[3], tmpIntersection, 0\r\n    //         );\r\n    //         // Use a eplison\r\n    //         if (t >= -1e-2 && t <= 1 + 1e-2) {\r\n    //             const cursor1 = line1[4] * 2;\r\n    //             const cursor2 = line2[4] * 2;\r\n    //             // Update\r\n    //             offsetVertices[cursor1] = offsetVertices[cursor2] = line1[2] = line2[2] = tmpIntersection[0];\r\n    //             offsetVertices[cursor1 + 1] = offsetVertices[cursor2 + 1] = line1[3] = line2[3]= tmpIntersection[1];\r\n    //         }\r\n    //     }\r\n    // }\r\n    return offsetVertices;\r\n}\r\n\r\nfunction reversePoints(points, stride, start, end) {\r\n    for (let i = 0; i < Math.floor((end - start) / 2); i++) {\r\n        for (let j = 0; j < stride; j++) {\r\n            const a = (i + start) * stride + j;\r\n            const b = (end - i - 1) * stride + j;\r\n            const tmp = points[a];\r\n            points[a] = points[b];\r\n            points[b] = tmp;\r\n        }\r\n    }\r\n\r\n    return points;\r\n}\r\n\r\nfunction convertToClockwise(vertices, holes) {\r\n    let polygonVertexCount = vertices.length / 2;\r\n    let start = 0;\r\n    let end = holes && holes.length ? holes[0] : polygonVertexCount;\r\n    if (area(vertices, start, end) > 0) {\r\n        reversePoints(vertices, 2, start, end);\r\n    }\r\n    for (let h = 1; h < (holes ? holes.length : 0) + 1; h++) {\r\n        start = holes[h - 1];\r\n        end = holes[h] || polygonVertexCount;\r\n        if (area(vertices, start, end) < 0) {\r\n            reversePoints(vertices, 2, start, end);\r\n        }\r\n    }\r\n}\r\n\r\nfunction normalizeOpts(opts) {\r\n\r\n    opts.depth = opts.depth || 1;\r\n    opts.bevelSize = opts.bevelSize || 0;\r\n    opts.bevelSegments = opts.bevelSegments == null ? 2 : opts.bevelSegments;\r\n    opts.smoothBevel = opts.smoothBevel || false;\r\n    opts.simplify = opts.simplify || 0;\r\n\r\n    if (opts.smoothSide == null) {\r\n        opts.smoothSide = 'auto'\r\n    }\r\n    if (opts.smoothSideThreshold == null) {\r\n        opts.smoothSideThreshold = 0.9\r\n    }\r\n\r\n    // Normalize bevel options.\r\n    if (typeof opts.depth === 'number') {\r\n        opts.bevelSize = Math.min(!(opts.bevelSegments > 0) ? 0 : opts.bevelSize, opts.depth / 2);\r\n    }\r\n    if (!(opts.bevelSize > 0)) {\r\n        opts.bevelSegments = 0;\r\n    }\r\n    opts.bevelSegments = Math.round(opts.bevelSegments);\r\n\r\n    const boundingRect = opts.boundingRect;\r\n    opts.translate = opts.translate || [0, 0];\r\n    opts.scale = opts.scale || [1, 1];\r\n    if (opts.fitRect) {\r\n        let targetX = opts.fitRect.x == null\r\n            ? (boundingRect.x || 0)\r\n            : opts.fitRect.x;\r\n        let targetY = opts.fitRect.y == null\r\n            ? (boundingRect.y || 0)\r\n            : opts.fitRect.y;\r\n        let targetWidth = opts.fitRect.width;\r\n        let targetHeight = opts.fitRect.height;\r\n        if (targetWidth == null) {\r\n            if (targetHeight != null) {\r\n                targetWidth = targetHeight / boundingRect.height * boundingRect.width;\r\n            }\r\n            else {\r\n                targetWidth = boundingRect.width;\r\n                targetHeight = boundingRect.height;\r\n            }\r\n        }\r\n        else if (targetHeight == null) {\r\n            targetHeight = targetWidth / boundingRect.width * boundingRect.height;\r\n        }\r\n        opts.scale = [\r\n            targetWidth / boundingRect.width,\r\n            targetHeight / boundingRect.height\r\n        ];\r\n        opts.translate = [\r\n            (targetX - boundingRect.x) * opts.scale[0],\r\n            (targetY - boundingRect.y) * opts.scale[1]\r\n        ];\r\n    }\r\n}\r\n\r\nfunction generateNormal(indices, position) {\r\n\r\n    function v3Set(p, a, b, c) {\r\n        p[0] = a; p[1] = b; p[2] = c;\r\n    }\r\n\r\n    const p1 = [];\r\n    const p2 = [];\r\n    const p3 = [];\r\n\r\n    const v21 = [];\r\n    const v32 = [];\r\n\r\n    const n = [];\r\n\r\n    const len = indices.length;\r\n    const normals = new Float32Array(position.length);\r\n\r\n    for (let f = 0; f < len;) {\r\n        const i1 = indices[f++] * 3;\r\n        const i2 = indices[f++] * 3;\r\n        const i3 = indices[f++] * 3;\r\n\r\n        v3Set(p1, position[i1], position[i1 + 1], position[i1 + 2]);\r\n        v3Set(p2, position[i2], position[i2 + 1], position[i2 + 2]);\r\n        v3Set(p3, position[i3], position[i3 + 1], position[i3 + 2]);\r\n\r\n        v3Sub(v21, p1, p2);\r\n        v3Sub(v32, p2, p3);\r\n        v3Cross(n, v21, v32);\r\n        // Already be weighted by the triangle area\r\n        for (let i = 0; i < 3; i++) {\r\n            normals[i1 + i] = normals[i1 + i] + n[i];\r\n            normals[i2 + i] = normals[i2 + i] + n[i];\r\n            normals[i3 + i] = normals[i3 + i] + n[i];\r\n        }\r\n    }\r\n\r\n    for (var i = 0; i < normals.length;) {\r\n        v3Set(n, normals[i], normals[i + 1], normals[i + 2]);\r\n        v3Normalize(n, n);\r\n        normals[i++] = n[0];\r\n        normals[i++] = n[1];\r\n        normals[i++] = n[2];\r\n\r\n    }\r\n\r\n    return normals;\r\n}\r\n// 0,0----1,0\r\n// 0,1----1,1\r\nconst quadToTriangle = [\r\n    [0, 0], [1, 0], [1, 1],\r\n    [0, 0], [1, 1], [0, 1]\r\n];\r\n\r\nfunction ringDistance(vertices, start, end) {\r\n    let distance = 0;\r\n    let preX = vertices[start], preY = vertices[start + 1];\r\n    const firstX = preX, firstY = preY;\r\n    for (let i = start + 2; i < end; i += 2) {\r\n        const x = vertices[i], y = vertices[i + 1];\r\n        distance += Math.sqrt((x - preX) * (x - preX) + (y - preY) * (y - preY));\r\n        preX = x;\r\n        preY = y;\r\n    }\r\n    distance += Math.sqrt((preX - firstX) * (preX - firstX) + (preY - firstY) * (preY - firstY));\r\n    return distance;\r\n}\r\n\r\n// Add side vertices and indices. Include bevel.\r\nfunction addExtrudeSide(\r\n    out, { vertices, topVertices, splittedMap, depth, rect }, start, end,\r\n    cursors, opts\r\n) {\r\n    const ringVertexCount = end - start;\r\n\r\n    const splitBevel = opts.smoothBevel ? 1 : 2;\r\n    const bevelSize = Math.min(depth / 2, opts.bevelSize);\r\n    const bevelSegments = opts.bevelSegments;\r\n    const vertexOffset = cursors.vertex;\r\n    const ringPerimeter = cursors.ringPerimeter;\r\n    const size = Math.max(rect.width, rect.height, depth, ringPerimeter);\r\n\r\n    function isDuplicateVertex(idx) {\r\n        const nextIdx = (idx + 1) % ringVertexCount;\r\n        const x0 = vertices[idx * 2];\r\n        const y0 = vertices[idx * 2 + 1];\r\n        const x1 = vertices[nextIdx * 2];\r\n        const y1 = vertices[nextIdx * 2 + 1];\r\n        return x0 === x1 && y0 === y1;\r\n    }\r\n\r\n    // Side vertices\r\n    if (bevelSize > 0) {\r\n        const v0 = [0, 0, 1];\r\n        const v1 = [];\r\n        const v2 = [0, 0, -1];\r\n        const v = [];\r\n\r\n        let ringCount = 0;\r\n        let vLen = new Float32Array(ringVertexCount);\r\n        for (let k = 0; k < 2; k++) {\r\n            const z = (k === 0 ? (depth - bevelSize) : bevelSize);\r\n            for (let s = 0; s <= bevelSegments * splitBevel; s++) {\r\n                let uLen = 0;\r\n                let prevX;\r\n                let prevY;\r\n                for (let i = 0; i < ringVertexCount; i++) {\r\n                    const idx = (i % ringVertexCount + start) * 2;\r\n                    const rawIdx = splittedMap ? splittedMap[idx / 2] * 2 : idx;\r\n                    v1[0] = vertices[idx] - topVertices[rawIdx];\r\n                    v1[1] = vertices[idx + 1] - topVertices[rawIdx + 1];\r\n                    v1[2] = 0;\r\n                    const l = Math.sqrt(v1[0] * v1[0] + v1[1] * v1[1]);\r\n                    v1[0] /= l;\r\n                    v1[1] /= l;\r\n\r\n                    const t = (Math.floor(s / splitBevel) + (s % splitBevel)) / bevelSegments;\r\n                    k === 0 ? slerp(v, v0, v1, t)\r\n                        : slerp(v, v1, v2, t);\r\n\r\n                    const t2 = k === 0 ? t : 1 - t;\r\n                    const a = bevelSize * Math.sin(t2 * Math.PI / 2);\r\n                    const b = l * Math.cos(t2 * Math.PI / 2);\r\n\r\n                    // ellipse radius\r\n                    const r = bevelSize * l / Math.sqrt(a * a + b * b);\r\n\r\n                    const x = v[0] * r + topVertices[rawIdx];\r\n                    const y = v[1] * r + topVertices[rawIdx + 1];\r\n                    const zz = v[2] * r + z;\r\n                    out.position[cursors.vertex * 3] = x;\r\n                    out.position[cursors.vertex * 3 + 1] = y;\r\n                    out.position[cursors.vertex * 3 + 2] = zz;\r\n\r\n                    // TODO Cache and optimize\r\n                    if (i > 0) {\r\n                        uLen += Math.sqrt((prevX - x) * (prevX - x) + (prevY - y) * (prevY - y));\r\n                    }\r\n                    if (s > 0 || k > 0) {\r\n                        let tmp = (cursors.vertex - ringVertexCount) * 3;\r\n                        let prevX2 = out.position[tmp];\r\n                        let prevY2 = out.position[tmp + 1];\r\n                        let prevZ2 = out.position[tmp + 2];\r\n\r\n                        vLen[i] += Math.sqrt(\r\n                            (prevX2 - x) * (prevX2 - x)\r\n                            + (prevY2 - y) * (prevY2 - y)\r\n                            + (prevZ2 - zz) * (prevZ2 - zz)\r\n                        );\r\n                    }\r\n                    out.uv[cursors.vertex * 2] = uLen / size;\r\n                    out.uv[cursors.vertex * 2 + 1] = vLen[i] / size;\r\n\r\n                    prevX = x;\r\n                    prevY = y;\r\n                    cursors.vertex++;\r\n\r\n                    // Just ignore this face if vertex are duplicted in `splitVertices`\r\n                    if (isDuplicateVertex(i)) {\r\n                        continue;\r\n                    }\r\n                    if ((splitBevel > 1 && (s % splitBevel)) || (splitBevel === 1 && s >= 1)) {\r\n                        for (let f = 0; f < 6; f++) {\r\n                            const m = (quadToTriangle[f][0] + i) % ringVertexCount;\r\n                            const n = quadToTriangle[f][1] + ringCount;\r\n                            out.indices[cursors.index++] = (n - 1) * ringVertexCount + m + vertexOffset;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                ringCount++;\r\n            }\r\n        }\r\n    }\r\n    else {\r\n        for (let k = 0; k < 2; k++) {\r\n            const z = k === 0 ? depth - bevelSize : bevelSize;\r\n            let uLen = 0;\r\n            let prevX;\r\n            let prevY;\r\n            for (let i = 0; i < ringVertexCount; i++) {\r\n                const idx = (i % ringVertexCount + start) * 2;\r\n                const x = vertices[idx];\r\n                const y = vertices[idx + 1];\r\n                out.position[cursors.vertex * 3] = x;\r\n                out.position[cursors.vertex * 3 + 1] = y;\r\n                out.position[cursors.vertex * 3 + 2] = z;\r\n                if (i > 0) {\r\n                    uLen += Math.sqrt((prevX - x) * (prevX - x) + (prevY - y) * (prevY - y));\r\n                }\r\n                out.uv[cursors.vertex * 2] = uLen / size;\r\n                out.uv[cursors.vertex * 2 + 1] = z / size;\r\n                prevX = x;\r\n                prevY = y;\r\n\r\n                cursors.vertex++;\r\n            }\r\n        }\r\n    }\r\n    // Connect the side\r\n    const sideStartRingN = bevelSize > 0 ? (bevelSegments * splitBevel + 1) : 1;\r\n    for (let i = 0; i < ringVertexCount; i++) {\r\n        // Just ignore this face if vertex are duplicted in `splitVertices`\r\n        if (isDuplicateVertex(i)) {\r\n            continue;\r\n        }\r\n        for (let f = 0; f < 6; f++) {\r\n            const m = (quadToTriangle[f][0] + i) % ringVertexCount;\r\n            const n = quadToTriangle[f][1] + sideStartRingN;\r\n            out.indices[cursors.index++] = (n - 1) * ringVertexCount + m + vertexOffset;\r\n        }\r\n    }\r\n}\r\n\r\nfunction addTopAndBottom({ indices, topVertices, rect, depth }, out, cursors, opts) {\r\n    if (topVertices.length <= 4) {\r\n        return;\r\n    }\r\n\r\n    const vertexOffset = cursors.vertex;\r\n    // Top indices\r\n    const indicesLen = indices.length;\r\n    for (let i = 0; i < indicesLen; i++) {\r\n        out.indices[cursors.index++] = vertexOffset + indices[i];\r\n    }\r\n    const size = Math.max(rect.width, rect.height);\r\n    // Top and bottom vertices\r\n    for (let k = 0; k < (opts.excludeBottom ? 1 : 2); k++) {\r\n        for (let i = 0; i < topVertices.length; i += 2) {\r\n            const x = topVertices[i];\r\n            const y = topVertices[i + 1];\r\n            out.position[cursors.vertex * 3] = x;\r\n            out.position[cursors.vertex * 3 + 1] = y;\r\n            out.position[cursors.vertex * 3 + 2] = (1 - k) * depth;\r\n\r\n            out.uv[cursors.vertex * 2] = (x - rect.x) / size;\r\n            out.uv[cursors.vertex * 2 + 1] = (y - rect.y) / size;\r\n            cursors.vertex++;\r\n        }\r\n    }\r\n    // Bottom indices\r\n    if (!opts.excludeBottom) {\r\n        const vertexCount = topVertices.length / 2;\r\n        for (let i = 0; i < indicesLen; i += 3) {\r\n            for (let k = 0; k < 3; k++) {\r\n                out.indices[cursors.index++] = vertexOffset + vertexCount + indices[i + 2 - k];\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * Split vertices for sharp side.\r\n */\r\nfunction splitVertices(vertices, holes, smoothSide, smoothSideThreshold) {\r\n    const isAutoSmooth = smoothSide == null || smoothSide === 'auto';\r\n    if (smoothSide === true) {\r\n        return { vertices, holes };\r\n    }\r\n    const newVertices = [];\r\n    const newHoles = holes && [];\r\n    const count = vertices.length / 2;\r\n    const v1 = [];\r\n    const v2 = [];\r\n\r\n    // Map of splitted index to raw index\r\n    const splittedMap = [];\r\n\r\n    let start = 0;\r\n    let end = 0;\r\n\r\n    const polysCount = (holes ? holes.length : 0) + 1;\r\n    for (let h = 0; h < polysCount; h++) {\r\n        if (h === 0) {\r\n            end = holes && holes.length ? holes[0] : count;\r\n        }\r\n        else {\r\n            start = holes[h - 1];\r\n            end = holes[h] || count;\r\n        }\r\n\r\n        for (let i = start; i < end; i++) {\r\n            const x2 = vertices[i * 2];\r\n            const y2 = vertices[i * 2 + 1];\r\n            const nextIdx = i === end - 1 ? start : i + 1;\r\n            const x3 = vertices[nextIdx * 2];\r\n            const y3 = vertices[nextIdx * 2 + 1];\r\n\r\n            if (isAutoSmooth) {\r\n                const prevIdx = i === start ? end - 1 : i - 1;\r\n                const x1 = vertices[prevIdx * 2];\r\n                const y1 = vertices[prevIdx * 2 + 1];\r\n\r\n                v1[0] = x1 - x2;\r\n                v1[1] = y1 - y2;\r\n                v2[0] = x3 - x2;\r\n                v2[1] = y3 - y2;\r\n\r\n                v2Normalize(v1, v1);\r\n                v2Normalize(v2, v2);\r\n\r\n                const angleCos = v2Dot(v1, v2) * 0.5 + 0.5;\r\n\r\n                if ((1 - angleCos) > smoothSideThreshold) {\r\n                    newVertices.push(x2, y2);\r\n                    splittedMap.push(i);\r\n                }\r\n                else {\r\n                    newVertices.push(x2, y2, x2, y2);\r\n                    splittedMap.push(i, i);\r\n                }\r\n            }\r\n            else {\r\n                newVertices.push(x2, y2, x2, y2);\r\n                splittedMap.push(i, i);\r\n            }\r\n        }\r\n\r\n        if (h < polysCount - 1 && newHoles) {\r\n            newHoles.push(newVertices.length / 2);\r\n        }\r\n    }\r\n\r\n    return {\r\n        vertices: new Float32Array(newVertices),\r\n        splittedMap,\r\n        holes: newHoles\r\n    };\r\n}\r\n\r\nfunction innerExtrudeTriangulatedPolygon(preparedData, opts) {\r\n    let indexCount = 0;\r\n    let vertexCount = 0;\r\n\r\n    for (let p = 0; p < preparedData.length; p++) {\r\n        const { indices, vertices, splittedMap, topVertices, depth } = preparedData[p];\r\n        const bevelSize = Math.min(depth / 2, opts.bevelSize);\r\n        const bevelSegments = !(bevelSize > 0) ? 0 : opts.bevelSegments;\r\n\r\n        const holes = preparedData[p].holes || [];\r\n\r\n        indexCount += indices.length * (opts.excludeBottom ? 1 : 2);\r\n        vertexCount += topVertices.length / 2 * (opts.excludeBottom ? 1 : 2);\r\n        const ringCount = 2 + bevelSegments * 2;\r\n\r\n        let start = 0;\r\n        let end = 0;\r\n        for (let h = 0; h < holes.length + 1; h++) {\r\n            if (h === 0) {\r\n                end = holes.length ? holes[0] : vertices.length / 2;\r\n            }\r\n            else {\r\n                start = holes[h - 1];\r\n                end = holes[h] || vertices.length / 2;\r\n            }\r\n\r\n            const faceEnd = splittedMap ? splittedMap[end - 1] + 1 : end;\r\n            const faceStart = splittedMap ? splittedMap[start] : start;\r\n            indexCount += (faceEnd - faceStart) * 6 * (ringCount - 1);\r\n\r\n            const sideRingVertexCount = end - start;\r\n            vertexCount += sideRingVertexCount * ringCount\r\n                // Double the bevel vertex number if not smooth\r\n                + (!opts.smoothBevel ? bevelSegments * sideRingVertexCount * 2 : 0);\r\n        }\r\n    }\r\n\r\n    const data = {\r\n        position: new Float32Array(vertexCount * 3),\r\n        indices: new (vertexCount > 0xffff ? Uint32Array : Uint16Array)(indexCount),\r\n        uv: new Float32Array(vertexCount * 2)\r\n    };\r\n\r\n    const cursors = {\r\n        vertex: 0, index: 0, ringPerimeter: 0\r\n    };\r\n\r\n    for (let d = 0; d < preparedData.length; d++) {\r\n        addTopAndBottom(preparedData[d], data, cursors, opts);\r\n    }\r\n\r\n    for (let d = 0; d < preparedData.length; d++) {\r\n        const { holes, vertices } = preparedData[d];\r\n        const vertexCount = vertices.length / 2;\r\n\r\n        let start = 0;\r\n        let end = (holes && holes.length) ? holes[0] : vertexCount;\r\n        cursors.ringPerimeter = ringDistance(preparedData[d].topVertices, start, end);\r\n        // Add exterior\r\n        addExtrudeSide(data, preparedData[d], start, end, cursors, opts);\r\n        // Add holes\r\n        if (holes) {\r\n            for (let h = 0; h < holes.length; h++) {\r\n                start = holes[h];\r\n                end = holes[h + 1] || vertexCount;\r\n                cursors.ringPerimeter = ringDistance(preparedData[d].topVertices, start, end);\r\n                addExtrudeSide(data, preparedData[d], start, end, cursors, opts);\r\n            }\r\n        }\r\n    }\r\n\r\n    // Wrap uv\r\n    for (let i = 0; i < data.uv.length; i++) {\r\n        const val = data.uv[i];\r\n        if (val > 0 && Math.round(val) === val) {\r\n            data.uv[i] = 1;\r\n        }\r\n        else {\r\n            data.uv[i] = val % 1;\r\n        }\r\n    }\r\n\r\n    data.normal = generateNormal(data.indices, data.position);\r\n    // PENDING\r\n    data.boundingRect = preparedData[0] && preparedData[0].rect;\r\n\r\n    return data;\r\n}\r\n\r\nfunction convertPolylineToTriangulatedPolygon(polyline, polylineIdx, opts) {\r\n    const lineWidth = opts.lineWidth;\r\n    const pointCount = polyline.length;\r\n    const points = new Float32Array(pointCount * 2);\r\n    const translate = opts.translate || [0, 0];\r\n    const scale = opts.scale || [1, 1];\r\n    for (let i = 0, k = 0; i < pointCount; i++) {\r\n        points[k++] = polyline[i][0] * scale[0] + translate[0];\r\n        points[k++] = polyline[i][1] * scale[1] + translate[1];\r\n    }\r\n\r\n    if (area(points, 0, pointCount) < 0) {\r\n        reversePoints(points, 2, 0, pointCount);\r\n    }\r\n\r\n    const insidePoints = [];\r\n    const outsidePoints = [];\r\n    const miterLimit = opts.miterLimit;\r\n    const outsideIndicesMap = innerOffsetPolyline(\r\n        points, outsidePoints, 0, pointCount, 0, -lineWidth / 2, miterLimit, false, true\r\n    );\r\n    reversePoints(points, 2, 0, pointCount);\r\n    const insideIndicesMap = innerOffsetPolyline(\r\n        points, insidePoints, 0, pointCount, 0, -lineWidth / 2, miterLimit, false, true\r\n    );\r\n\r\n    const polygonVertexCount = (insidePoints.length + outsidePoints.length) / 2;\r\n    const polygonVertices = new Float32Array(polygonVertexCount * 2);\r\n\r\n    let offset = 0;\r\n    const outsidePointCount = outsidePoints.length / 2;\r\n    for (let i = 0; i < outsidePoints.length; i++) {\r\n        polygonVertices[offset++] = outsidePoints[i];\r\n    }\r\n    for (let i = 0; i < insidePoints.length; i++) {\r\n        polygonVertices[offset++] = insidePoints[i];\r\n    }\r\n\r\n    // Built indices\r\n    const indices = new (polygonVertexCount > 0xffff ? Uint32Array : Uint16Array)(\r\n        ((pointCount - 1) * 2 + (polygonVertexCount - pointCount * 2)) * 3\r\n    );\r\n    let off = 0;\r\n    for (let i = 0; i < pointCount - 1; i++) {\r\n        const i2 = i + 1;\r\n        indices[off++] = outsidePointCount - 1 - outsideIndicesMap[i];\r\n        indices[off++] = outsidePointCount - 1 - outsideIndicesMap[i] - 1;\r\n        indices[off++] = insideIndicesMap[i] + 1 + outsidePointCount;\r\n\r\n        indices[off++] = outsidePointCount - 1 - outsideIndicesMap[i];\r\n        indices[off++] = insideIndicesMap[i] + 1 + outsidePointCount;\r\n        indices[off++] = insideIndicesMap[i] + outsidePointCount;\r\n\r\n        if (insideIndicesMap[i2] - insideIndicesMap[i] === 2) {\r\n            indices[off++] = insideIndicesMap[i] + 2 + outsidePointCount;\r\n            indices[off++] = insideIndicesMap[i] + 1 + outsidePointCount;\r\n            indices[off++] = outsidePointCount - outsideIndicesMap[i2] - 1;\r\n        }\r\n        else if (outsideIndicesMap[i2] - outsideIndicesMap[i] === 2) {\r\n            indices[off++] = insideIndicesMap[i2] + outsidePointCount;\r\n            indices[off++] = outsidePointCount - 1 - (outsideIndicesMap[i] + 1);\r\n            indices[off++] = outsidePointCount - 1 - (outsideIndicesMap[i] + 2);\r\n        }\r\n    }\r\n\r\n    const topVertices = opts.bevelSize > 0\r\n        ? offsetPolygon(polygonVertices, [], opts.bevelSize, null, true) : polygonVertices;\r\n    const boundingRect = opts.boundingRect;\r\n\r\n    const res = splitVertices(polygonVertices, null, opts.smoothSide, opts.smoothSideThreshold);\r\n    return {\r\n        vertices: res.vertices,\r\n        rawVertices: topVertices,\r\n        splittedMap: res.splittedMap,\r\n        indices,\r\n        topVertices,\r\n        rect: {\r\n            x: boundingRect.x * scale[0] + translate[0],\r\n            y: boundingRect.y * scale[1] + translate[1],\r\n            width: boundingRect.width * scale[0],\r\n            height: boundingRect.height * scale[1],\r\n        },\r\n        depth: typeof opts.depth === 'function' ? opts.depth(polylineIdx) : opts.depth,\r\n        holes: []\r\n    };\r\n}\r\n\r\nfunction removeClosePointsOfPolygon(polygon, epsilon) {\r\n    const newPolygon = [];\r\n    for (let k = 0; k < polygon.length; k++) {\r\n        const points = polygon[k];\r\n        const newPoints = [];\r\n        const len = points.length;\r\n        let x1 = points[len - 1][0];\r\n        let y1 = points[len - 1][1];\r\n        let dist = 0;\r\n        for (let i = 0; i < len; i++) {\r\n            let x2 = points[i][0];\r\n            let y2 = points[i][1];\r\n            const dx = x2 - x1;\r\n            const dy = y2 - y1;\r\n            dist += Math.sqrt(dx * dx + dy * dy);\r\n            if (dist > epsilon) {\r\n                newPoints.push(points[i]);\r\n                dist = 0;\r\n            }\r\n            x1 = x2;\r\n            y1 = y2;\r\n        }\r\n        if (newPoints.length >= 3) {\r\n            newPolygon.push(newPoints);\r\n        }\r\n    }\r\n    return newPolygon.length > 0 ? newPolygon : null;\r\n}\r\n\r\nfunction simplifyPolygon(polygon, tolerance) {\r\n    const newPolygon = [];\r\n    for (let k = 0; k < polygon.length; k++) {\r\n        let points = polygon[k];\r\n        points = doSimplify(points, tolerance, true);\r\n        if (points.length >= 3) {\r\n            newPolygon.push(points);\r\n        }\r\n    }\r\n    return newPolygon.length > 0 ? newPolygon : null;\r\n}\r\n/**\r\n *\r\n * @param {Array} polygons Polygons array that match GeoJSON MultiPolygon geometry.\r\n * @param {Object} [opts]\r\n * @param {number|Function} [opts.depth]\r\n * @param {number} [opts.bevelSize = 0]\r\n * @param {number} [opts.bevelSegments = 2]\r\n * @param {number} [opts.simplify = 0]\r\n * @param {boolean} [opts.smoothSide = 'auto']\r\n * @param {boolean} [opts.smoothSideThreshold = 0.9]    // Will not smooth sharp side.\r\n * @param {boolean} [opts.smoothBevel = false]\r\n * @param {boolean} [opts.excludeBottom = false]\r\n * @param {Object} [opts.fitRect] translate and scale will be ignored if fitRect is set\r\n * @param {Array} [opts.translate]\r\n * @param {Array} [opts.scale]\r\n *\r\n * @return {Object} {indices, position, uv, normal, boundingRect}\r\n */\r\nexport function extrudePolygon(polygons, opts) {\r\n\r\n    opts = Object.assign({}, opts);\r\n\r\n    const min = [Infinity, Infinity];\r\n    const max = [-Infinity, -Infinity];\r\n    for (let i = 0; i < polygons.length; i++) {\r\n        updateBoundingRect(polygons[i][0], min, max);\r\n    }\r\n    opts.boundingRect = opts.boundingRect || {\r\n        x: min[0], y: min[1], width: max[0] - min[0], height: max[1] - min[1]\r\n    };\r\n\r\n    normalizeOpts(opts);\r\n\r\n    const preparedData = [];\r\n    const translate = opts.translate || [0, 0];\r\n    const scale = opts.scale || [1, 1];\r\n    const boundingRect = opts.boundingRect;\r\n    const transformdRect = {\r\n        x: boundingRect.x * scale[0] + translate[0],\r\n        y: boundingRect.y * scale[1] + translate[1],\r\n        width: boundingRect.width * scale[0],\r\n        height: boundingRect.height * scale[1],\r\n    };\r\n\r\n    const epsilon = Math.min(\r\n        boundingRect.width, boundingRect.height\r\n    ) / 1e5;\r\n    for (let i = 0; i < polygons.length; i++) {\r\n        let newPolygon = removeClosePointsOfPolygon(polygons[i], epsilon);\r\n        if (!newPolygon) {\r\n            continue;\r\n        }\r\n        const simplifyTolerance = opts.simplify / Math.max(scale[0], scale[1]);\r\n        if (simplifyTolerance > 0) {\r\n            newPolygon = simplifyPolygon(newPolygon, simplifyTolerance);\r\n        }\r\n        if (!newPolygon) {\r\n            continue;\r\n        }\r\n\r\n        const { vertices, holes, dimensions } = earcut.flatten(newPolygon);\r\n\r\n        for (let k = 0; k < vertices.length;) {\r\n            vertices[k] = vertices[k++] * scale[0] + translate[0];\r\n            vertices[k] = vertices[k++] * scale[1] + translate[1];\r\n        }\r\n\r\n        convertToClockwise(vertices, holes);\r\n\r\n        if (dimensions !== 2) {\r\n            throw new Error('Only 2D polygon points are supported');\r\n        }\r\n        const topVertices = opts.bevelSize > 0\r\n            ? offsetPolygon(vertices, holes, opts.bevelSize, null, true) : vertices;\r\n        const indices = triangulate(topVertices, holes, dimensions);\r\n        const res = splitVertices(vertices, holes, opts.smoothSide, opts.smoothSideThreshold)\r\n\r\n        preparedData.push({\r\n            indices,\r\n            vertices: res.vertices,\r\n            rawVertices: vertices,\r\n            topVertices,\r\n            holes: res.holes,\r\n            splittedMap: res.splittedMap,\r\n            rect: transformdRect,\r\n            depth: typeof opts.depth === 'function' ? opts.depth(i) : opts.depth\r\n        });\r\n    }\r\n    return innerExtrudeTriangulatedPolygon(preparedData, opts);\r\n};\r\n\r\n/**\r\n *\r\n * @param {Array} polylines Polylines array that match GeoJSON MultiLineString geometry.\r\n * @param {Object} [opts]\r\n * @param {number} [opts.depth]\r\n * @param {number} [opts.bevelSize = 0]\r\n * @param {number} [opts.bevelSegments = 2]\r\n * @param {number} [opts.simplify = 0]\r\n * @param {boolean} [opts.smoothSide = 'auto']\r\n * @param {boolean} [opts.smoothSideThreshold = 0.9]    // Will not smooth sharp side.\r\n * @param {boolean} [opts.smoothBevel = false]\r\n * @param {boolean} [opts.excludeBottom = false]\r\n * @param {boolean} [opts.lineWidth = 1]\r\n * @param {boolean} [opts.miterLimit = 2]\r\n * @param {Object} [opts.fitRect] translate and scale will be ignored if fitRect is set\r\n * @param {Array} [opts.translate]\r\n * @param {Array} [opts.scale]\r\n * @param {Object} [opts.boundingRect]\r\n * @return {Object} {indices, position, uv, normal, boundingRect}\r\n */\r\nexport function extrudePolyline(polylines, opts) {\r\n\r\n    opts = Object.assign({}, opts);\r\n\r\n    const min = [Infinity, Infinity];\r\n    const max = [-Infinity, -Infinity];\r\n    for (let i = 0; i < polylines.length; i++) {\r\n        updateBoundingRect(polylines[i], min, max);\r\n    }\r\n    opts.boundingRect = opts.boundingRect || {\r\n        x: min[0], y: min[1], width: max[0] - min[0], height: max[1] - min[1]\r\n    };\r\n\r\n    normalizeOpts(opts);\r\n    const scale = opts.scale || [1, 1];\r\n\r\n    if (opts.lineWidth == null) {\r\n        opts.lineWidth = 1;\r\n    }\r\n    if (opts.miterLimit == null) {\r\n        opts.miterLimit = 2;\r\n    }\r\n    const preparedData = [];\r\n    // Extrude polyline to polygon\r\n    for (let i = 0; i < polylines.length; i++) {\r\n        let newPolyline = polylines[i];\r\n        const simplifyTolerance = opts.simplify / Math.max(scale[0], scale[1]);\r\n        if (simplifyTolerance > 0) {\r\n            newPolyline = doSimplify(newPolyline, simplifyTolerance, true);\r\n        }\r\n        preparedData.push(convertPolylineToTriangulatedPolygon(newPolyline, i, opts));\r\n    }\r\n\r\n    return innerExtrudeTriangulatedPolygon(preparedData, opts);\r\n}\r\n\r\nfunction updateBoundingRect(points, min, max) {\r\n    for (let i = 0; i < points.length; i++) {\r\n        min[0] = Math.min(points[i][0], min[0]);\r\n        min[1] = Math.min(points[i][1], min[1]);\r\n        max[0] = Math.max(points[i][0], max[0]);\r\n        max[1] = Math.max(points[i][1], max[1]);\r\n    }\r\n}\r\n\r\n/**\r\n *\r\n * @param {Object} geojson\r\n * @param {Object} [opts]\r\n * @param {number} [opts.depth]\r\n * @param {number} [opts.bevelSize = 0]\r\n * @param {number} [opts.bevelSegments = 2]\r\n * @param {number} [opts.simplify = 0]\r\n * @param {boolean} [opts.smoothSide = 'auto']\r\n * @param {boolean} [opts.smoothSideThreshold = 0.9]    // Will not smooth sharp side.\r\n * @param {boolean} [opts.smoothBevel = false]\r\n * @param {boolean} [opts.excludeBottom = false]\r\n * @param {boolean} [opts.lineWidth = 1]\r\n * @param {boolean} [opts.miterLimit = 2]\r\n * @param {Object} [opts.fitRect] translate and scale will be ignored if fitRect is set\r\n * @param {Array} [opts.translate]\r\n * @param {Array} [opts.scale]\r\n * @param {Object} [opts.boundingRect]\r\n * @return {Object} {polyline: {indices, position, uv, normal}, polygon: {indices, position, uv, normal}}\r\n */\r\n\r\n// TODO Not merge feature\r\nexport function extrudeGeoJSON(geojson, opts) {\r\n\r\n    opts = Object.assign({}, opts);\r\n\r\n    const polylines = [];\r\n    const polygons = [];\r\n\r\n    const polylineFeatureIndices = [];\r\n    const polygonFeatureIndices = [];\r\n\r\n    const min = [Infinity, Infinity];\r\n    const max = [-Infinity, -Infinity];\r\n\r\n    for (let i = 0; i < geojson.features.length; i++) {\r\n        const feature = geojson.features[i];\r\n        const geometry = feature.geometry;\r\n        if (geometry && geometry.coordinates) {\r\n            switch (geometry.type) {\r\n                case 'LineString':\r\n                    polylines.push(geometry.coordinates);\r\n                    polylineFeatureIndices.push(i);\r\n                    updateBoundingRect(geometry.coordinates, min, max);\r\n                    break;\r\n                case 'MultiLineString':\r\n                    for (let k = 0; k < geometry.coordinates.length; k++) {\r\n                        polylines.push(geometry.coordinates[k]);\r\n                        polylineFeatureIndices.push(i);\r\n                        updateBoundingRect(geometry.coordinates[k], min, max);\r\n                    }\r\n                    break;\r\n                case 'Polygon':\r\n                    polygons.push(geometry.coordinates);\r\n                    polygonFeatureIndices.push(i);\r\n                    updateBoundingRect(geometry.coordinates[0], min, max);\r\n                    break;\r\n                case 'MultiPolygon':\r\n                    for (let k = 0; k < geometry.coordinates.length; k++) {\r\n                        polygons.push(geometry.coordinates[k]);\r\n                        polygonFeatureIndices.push(i);\r\n                        updateBoundingRect(geometry.coordinates[k][0], min, max);\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n\r\n    opts.boundingRect = opts.boundingRect || {\r\n        x: min[0], y: min[1], width: max[0] - min[0], height: max[1] - min[1]\r\n    };\r\n\r\n    const originalDepth = opts.depth;\r\n    return {\r\n        polyline: extrudePolyline(polylines, Object.assign(opts, {\r\n            depth: function (idx) {\r\n                if (typeof originalDepth === 'function') {\r\n                    return originalDepth(\r\n                        geojson.features[polylineFeatureIndices[idx]]\r\n                    );\r\n                }\r\n                return originalDepth;\r\n            }\r\n        })),\r\n        polygon: extrudePolygon(polygons, Object.assign(opts, {\r\n            depth: function (idx) {\r\n                if (typeof originalDepth === 'function') {\r\n                    return originalDepth(\r\n                        geojson.features[polygonFeatureIndices[idx]]\r\n                    );\r\n                }\r\n                return originalDepth;\r\n            }\r\n        }))\r\n    };\r\n}","import * as maptalks from 'maptalks';\r\nimport * as THREE from 'three';\r\n//Using cache to reduce computation\r\nexport function distanceToVector3(distance, layer, cache = {}) {\r\n    if (cache[distance] === undefined) {\r\n        cache[distance] = layer.distanceToVector3(distance, distance).x;\r\n    }\r\n    return cache[distance];\r\n}\r\n/**\r\n *Get the center point of the point set\r\n * @param {*} coordinates\r\n */\r\nexport function getCenterOfPoints(coordinates = []) {\r\n    let sumX = 0, sumY = 0;\r\n    const len = coordinates.length;\r\n    for (let i = 0; i < len; i++) {\r\n        const { coordinate, lnglat, lnglats, xy, xys } = coordinates[i];\r\n        const c = coordinate || lnglat || lnglats || xy || xys || coordinates[i];\r\n        let x, y;\r\n        if (Array.isArray(c)) {\r\n            x = c[0];\r\n            y = c[1];\r\n        }\r\n        else if (c instanceof maptalks.Coordinate) {\r\n            x = c.x;\r\n            y = c.y;\r\n        }\r\n        sumX += x;\r\n        sumY += y;\r\n    }\r\n    return new maptalks.Coordinate(sumX / len, sumY / len);\r\n}\r\nexport function setBottomHeight(geometry, bottomHeight, layer, cache) {\r\n    if (bottomHeight === undefined || typeof bottomHeight !== 'number' || bottomHeight === 0) {\r\n        return 0;\r\n    }\r\n    let position;\r\n    if (geometry instanceof THREE.BufferGeometry) {\r\n        position = geometry.attributes.position.array;\r\n    }\r\n    else if (Array.isArray(geometry) || geometry instanceof Float32Array) {\r\n        position = geometry;\r\n    }\r\n    else {\r\n        position = geometry.position;\r\n    }\r\n    let h = 0;\r\n    if (position) {\r\n        if (cache) {\r\n            if (cache[bottomHeight] === undefined) {\r\n                cache[bottomHeight] = layer.distanceToVector3(bottomHeight, bottomHeight).x;\r\n            }\r\n            h = cache[bottomHeight];\r\n        }\r\n        else {\r\n            h = layer.distanceToVector3(bottomHeight, bottomHeight).x;\r\n        }\r\n        const len = position.length;\r\n        if (position[0] instanceof THREE.Vector3) {\r\n            for (let i = 0; i < len; i++) {\r\n                position[i].z += h;\r\n            }\r\n        }\r\n        else {\r\n            for (let i = 0; i < len; i += 3) {\r\n                position[i + 2] += h;\r\n            }\r\n        }\r\n    }\r\n    return h;\r\n}\r\nexport function getGeometriesColorArray(geometriesAttributes) {\r\n    const len = geometriesAttributes.length;\r\n    let colorsLen = 0;\r\n    for (let i = 0; i < len; i++) {\r\n        const { count } = geometriesAttributes[i].position;\r\n        colorsLen += count;\r\n    }\r\n    return new Float32Array(colorsLen * 3);\r\n}\r\nexport function coordiantesToArrayBuffer(coordiantes = []) {\r\n    const len = coordiantes.length;\r\n    const array = new Float64Array(len * 2);\r\n    for (let i = 0; i < len; i++) {\r\n        let x, y;\r\n        const c = coordiantes[i];\r\n        if (c.x) {\r\n            x = c.x;\r\n            y = c.y;\r\n        }\r\n        else {\r\n            x = c[0];\r\n            y = c[1];\r\n        }\r\n        array[i * 2] = x;\r\n        array[i * 2 + 1] = y;\r\n    }\r\n    return array.buffer;\r\n}\r\n//# sourceMappingURL=index.js.map","import * as THREE from 'three';\r\nimport * as maptalks from 'maptalks';\r\nimport { isGeoJSONPolygon, spliteGeoJSONMulti, getGeoJSONCenter, isGeoJSONMulti, getGeoJSONCoordinates } from './GeoJSONUtil';\r\nimport { extrudePolygon } from 'deyihu-geometry-extrude';\r\nimport { addAttribute } from './ThreeAdaptUtil';\r\nimport { coordiantesToArrayBuffer } from '.';\r\nconst topColor = new THREE.Color('#fff'), bottomColor = new THREE.Color('#fff');\r\n/**\r\n * this is for ExtrudeMesh util\r\n */\r\n/**\r\n * Fix the bug in the center of multipoygon\r\n * @param {maptalks.Polygon} polygon\r\n * @param {*} layer\r\n */\r\n// export function toShape(datas = []) {\r\n//     const shapes = [];\r\n//     for (let i = 0, len = datas.length; i < len; i++) {\r\n//         const { outer, holes } = datas[i];\r\n//         const shape = [outer];\r\n//         if (holes && holes.length) {\r\n//             for (let j = 0, len1 = holes.length; j < len1; j++) {\r\n//                 shape.push(holes[j]);\r\n//             }\r\n//         }\r\n//         shapes.push(shape);\r\n//     }\r\n//     return shapes;\r\n// }\r\n/**\r\n *  Support custom center point\r\n * @param {maptalks.Polygon|maptalks.MultiPolygon} polygon\r\n * @param {*} height\r\n * @param {*} layer\r\n */\r\nexport function getExtrudeGeometry(polygon, height, layer, center) {\r\n    const { position, normal, uv, indices } = getExtrudeGeometryParams(polygon, height, layer, center);\r\n    const color = new Float32Array(position.length);\r\n    color.fill(1, 0, position.length);\r\n    const bufferGeomertry = new THREE.BufferGeometry();\r\n    addAttribute(bufferGeomertry, 'color', new THREE.BufferAttribute(color, 3));\r\n    addAttribute(bufferGeomertry, 'normal', new THREE.BufferAttribute(normal, 3));\r\n    addAttribute(bufferGeomertry, 'position', new THREE.BufferAttribute(position, 3));\r\n    addAttribute(bufferGeomertry, 'uv', new THREE.BufferAttribute(uv, 2));\r\n    bufferGeomertry.setIndex(new THREE.Uint32BufferAttribute(indices, 1));\r\n    return bufferGeomertry;\r\n}\r\nexport function getExtrudeGeometryParams(polygon, height, layer, center, centerPt, altCache) {\r\n    const datas = getPolygonPositions(polygon, layer, center, centerPt, false);\r\n    const shapes = datas;\r\n    //Possible later use of geojson\r\n    if (!shapes)\r\n        return null;\r\n    //Reduce height and repeat calculation\r\n    if (altCache) {\r\n        if (altCache[height] == null) {\r\n            altCache[height] = layer.distanceToVector3(height, height).x;\r\n        }\r\n        height = altCache[height];\r\n    }\r\n    else {\r\n        height = layer.distanceToVector3(height, height).x;\r\n    }\r\n    const { position, normal, uv, indices } = extrudePolygon(shapes, {\r\n        depth: height\r\n    });\r\n    return {\r\n        position, normal, uv, indices\r\n    };\r\n}\r\n/**\r\n *\r\n * @param {*} geometry\r\n * @param {*} color\r\n * @param {*} _topColor\r\n */\r\nexport function initVertexColors(geometry, color, _topColor, minZ) {\r\n    if (minZ === undefined) {\r\n        minZ = 0;\r\n    }\r\n    const position = geometry.attributes.position.array;\r\n    const len = position.length;\r\n    bottomColor.setStyle(color);\r\n    topColor.setStyle(_topColor);\r\n    let colors;\r\n    if (Array.isArray(minZ)) {\r\n        let colorLen = 0;\r\n        for (let i = 0, len = minZ.length; i < len; i++) {\r\n            const { count } = minZ[i].position;\r\n            colorLen += count * 3;\r\n        }\r\n        colors = new Float32Array(colorLen);\r\n    }\r\n    else {\r\n        colors = new Float32Array(position.length);\r\n    }\r\n    if (Array.isArray(minZ)) {\r\n        for (let i = 0, len = minZ.length; i < len; i++) {\r\n            const { middleZ, start, end } = minZ[i].position;\r\n            for (let j = start; j < end; j += 3) {\r\n                const z = position[j + 2];\r\n                if (z > middleZ) {\r\n                    colors[j] = topColor.r;\r\n                    colors[j + 1] = topColor.g;\r\n                    colors[j + 2] = topColor.b;\r\n                }\r\n                else {\r\n                    colors[j] = bottomColor.r;\r\n                    colors[j + 1] = bottomColor.g;\r\n                    colors[j + 2] = bottomColor.b;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    else {\r\n        for (let i = 0; i < len; i += 3) {\r\n            const z = position[i + 2];\r\n            if (z > minZ) {\r\n                colors[i] = topColor.r;\r\n                colors[i + 1] = topColor.g;\r\n                colors[i + 2] = topColor.b;\r\n            }\r\n            else {\r\n                colors[i] = bottomColor.r;\r\n                colors[i + 1] = bottomColor.g;\r\n                colors[i + 2] = bottomColor.b;\r\n            }\r\n        }\r\n    }\r\n    addAttribute(geometry, 'color', new THREE.BufferAttribute(colors, 3, true));\r\n    return colors;\r\n}\r\n/**\r\n *\r\n * @param {*} polygon\r\n * @param {*} layer\r\n * @param {*} center\r\n */\r\nexport function getPolygonPositions(polygon, layer, center, centerPt, isArrayBuff = false) {\r\n    if (!polygon) {\r\n        return null;\r\n    }\r\n    let datas = [];\r\n    if (polygon instanceof maptalks.MultiPolygon) {\r\n        datas = polygon.getGeometries().map(p => {\r\n            return getSinglePolygonPositions(p, layer, center || polygon.getCenter(), centerPt, isArrayBuff);\r\n        });\r\n    }\r\n    else if (polygon instanceof maptalks.Polygon) {\r\n        const data = getSinglePolygonPositions(polygon, layer, center || polygon.getCenter(), centerPt, isArrayBuff);\r\n        datas.push(data);\r\n    }\r\n    else if (isGeoJSONPolygon(polygon)) {\r\n        // const cent = getGeoJSONCenter(polygon);\r\n        if (!isGeoJSONMulti(polygon)) {\r\n            const data = getSinglePolygonPositions(polygon, layer, center || getGeoJSONCenter(polygon), centerPt, isArrayBuff);\r\n            datas.push(data);\r\n        }\r\n        else {\r\n            const fs = spliteGeoJSONMulti(polygon);\r\n            for (let i = 0, len = fs.length; i < len; i++) {\r\n                datas.push(getSinglePolygonPositions(fs[i], layer, center || getGeoJSONCenter(polygon), centerPt, isArrayBuff));\r\n            }\r\n        }\r\n    }\r\n    return datas;\r\n}\r\nexport function getSinglePolygonPositions(polygon, layer, center, centerPt, isArrayBuff = false) {\r\n    let shell, holes;\r\n    //it is pre for geojson,Possible later use of geojson\r\n    if (isGeoJSONPolygon(polygon)) {\r\n        const coordinates = getGeoJSONCoordinates(polygon);\r\n        shell = coordinates[0];\r\n        holes = coordinates.slice(1, coordinates.length);\r\n        center = center || getGeoJSONCenter(polygon);\r\n    }\r\n    else if (polygon instanceof maptalks.Polygon) {\r\n        shell = polygon.getShell();\r\n        holes = polygon.getHoles();\r\n        center = center || polygon.getCenter();\r\n    }\r\n    centerPt = centerPt || layer.coordinateToVector3(center);\r\n    let outer;\r\n    if (isArrayBuff) {\r\n        outer = layer.coordinatiesToGLFloatArray(shell, centerPt).positons2d;\r\n    }\r\n    else {\r\n        outer = layer.coordinatiesToGLArray(shell, centerPt);\r\n    }\r\n    const data = [(isArrayBuff ? outer.buffer : outer)];\r\n    if (holes && holes.length > 0) {\r\n        for (let i = 0, len = holes.length; i < len; i++) {\r\n            let pts;\r\n            if (isArrayBuff) {\r\n                pts = layer.coordinatiesToGLFloatArray(holes[i], centerPt).positons2d;\r\n            }\r\n            else {\r\n                pts = layer.coordinatiesToGLArray(holes[i], centerPt);\r\n            }\r\n            data.push((isArrayBuff ? pts.buffer : pts));\r\n        }\r\n    }\r\n    return data;\r\n}\r\nexport function getPolygonArrayBuffer(polygon) {\r\n    if (!polygon) {\r\n        return null;\r\n    }\r\n    let datas = [];\r\n    if (polygon instanceof maptalks.MultiPolygon) {\r\n        datas = polygon.getGeometries().map(p => {\r\n            return getSinglePolygonArrayBuffer(p, false);\r\n        });\r\n    }\r\n    else if (polygon instanceof maptalks.Polygon) {\r\n        const data = getSinglePolygonArrayBuffer(polygon, false);\r\n        datas.push(data);\r\n    }\r\n    else if (isGeoJSONPolygon(polygon)) {\r\n        // const cent = getGeoJSONCenter(polygon);\r\n        if (!isGeoJSONMulti(polygon)) {\r\n            const data = getSinglePolygonArrayBuffer(polygon, true);\r\n            datas.push(data);\r\n        }\r\n        else {\r\n            const fs = spliteGeoJSONMulti(polygon);\r\n            for (let i = 0, len = fs.length; i < len; i++) {\r\n                datas.push(getSinglePolygonArrayBuffer(fs[i], true));\r\n            }\r\n        }\r\n    }\r\n    return datas;\r\n}\r\nexport function getSinglePolygonArrayBuffer(polygon, isGeoJSON) {\r\n    let shell, holes;\r\n    //it is pre for geojson,Possible later use of geojson\r\n    if (isGeoJSON) {\r\n        const coordinates = getGeoJSONCoordinates(polygon);\r\n        shell = coordinates[0];\r\n        holes = coordinates.slice(1, coordinates.length);\r\n    }\r\n    else if (polygon instanceof maptalks.Polygon) {\r\n        shell = polygon.getShell();\r\n        holes = polygon.getHoles();\r\n    }\r\n    const outer = coordiantesToArrayBuffer(shell);\r\n    const data = [outer];\r\n    if (holes && holes.length > 0) {\r\n        for (let i = 0, len = holes.length; i < len; i++) {\r\n            const pts = coordiantesToArrayBuffer(holes[i]);\r\n            data.push(pts);\r\n        }\r\n    }\r\n    return data;\r\n}\r\n//# sourceMappingURL=ExtrudeUtil.js.map","import * as THREE from 'three';\r\nimport * as maptalks from 'maptalks';\r\nimport { extrudePolyline } from 'deyihu-geometry-extrude';\r\nimport { isGeoJSON, getGeoJSONCoordinates, getGeoJSONCenter, isGeoJSONMulti, spliteGeoJSONMulti, isGeoJSONLine } from './GeoJSONUtil';\r\nimport { addAttribute } from './ThreeAdaptUtil';\r\nimport { coordiantesToArrayBuffer } from '.';\r\nconst COMMA = ',';\r\n/**\r\n *\r\n * @param {maptalks.LineString} lineString\r\n * @param {ThreeLayer} layer\r\n */\r\nexport function getLinePosition(lineString, layer, center, hasVectorArray = true) {\r\n    const positionsV = [];\r\n    let positions, positions2d;\r\n    if (Array.isArray(lineString) && lineString[0] instanceof THREE.Vector3) {\r\n        for (let i = 0, len = lineString.length; i < len; i++) {\r\n            const v = lineString[i];\r\n            positionsV.push(v);\r\n        }\r\n    }\r\n    else {\r\n        if (Array.isArray(lineString)) {\r\n            lineString = new maptalks.LineString(lineString);\r\n        }\r\n        const z = 0;\r\n        //support geojson\r\n        let coordinates, cent;\r\n        if (isGeoJSON(lineString)) {\r\n            coordinates = getGeoJSONCoordinates(lineString);\r\n            if (!center) {\r\n                cent = getGeoJSONCenter(lineString);\r\n            }\r\n        }\r\n        else if (lineString instanceof maptalks.LineString) {\r\n            coordinates = lineString.getCoordinates();\r\n            if (!center) {\r\n                cent = lineString.getCenter();\r\n            }\r\n        }\r\n        const centerPt = layer.coordinateToVector3(center || cent);\r\n        if (hasVectorArray) {\r\n            for (let i = 0, len = coordinates.length; i < len; i++) {\r\n                const coordinate = coordinates[i];\r\n                const v = layer.coordinateToVector3(coordinate, z).sub(centerPt);\r\n                // positions.push(v.x, v.y, v.z);\r\n                positionsV.push(v);\r\n            }\r\n        }\r\n        else {\r\n            const result = layer.coordinatiesToGLFloatArray(coordinates, centerPt);\r\n            positions = result.positions;\r\n            positions2d = result.positons2d;\r\n        }\r\n    }\r\n    if (!hasVectorArray) {\r\n        return {\r\n            positions,\r\n            positionsV,\r\n            positions2d,\r\n            arrayBuffer: positions2d.buffer\r\n        };\r\n    }\r\n    positions2d = new Float32Array(positionsV.length * 2);\r\n    positions = new Float32Array(positionsV.length * 3);\r\n    for (let i = 0, len = positionsV.length; i < len; i++) {\r\n        const idx = i * 3;\r\n        const v = positionsV[i];\r\n        positions[idx] = v.x;\r\n        positions[idx + 1] = v.y;\r\n        positions[idx + 2] = v.z;\r\n        const idx1 = i * 2;\r\n        positions2d[idx1] = v.x;\r\n        positions2d[idx1 + 1] = v.y;\r\n    }\r\n    return {\r\n        positions,\r\n        positionsV,\r\n        positions2d,\r\n        arrayBuffer: positions2d.buffer\r\n    };\r\n}\r\n/**\r\n *\r\n * @param {maptalks.LineString} lineString\r\n * @param {Number} lineWidth\r\n * @param {Number} depth\r\n * @param {ThreeLayer} layer\r\n */\r\nexport function getExtrudeLineGeometry(lineString, lineWidth = 1, depth = 1, layer, center) {\r\n    const { indices, position, normal, uv } = getExtrudeLineParams(lineString, lineWidth, depth, layer, center);\r\n    const geometry = new THREE.BufferGeometry();\r\n    addAttribute(geometry, 'position', new THREE.BufferAttribute(position, 3));\r\n    addAttribute(geometry, 'normal', new THREE.BufferAttribute(normal, 3));\r\n    addAttribute(geometry, 'uv', new THREE.BufferAttribute(uv, 2));\r\n    geometry.setIndex(new THREE.BufferAttribute(indices, 1));\r\n    return geometry;\r\n}\r\n/**\r\n *\r\n * @param {Array[Array]} chunkLines\r\n * @param {*} layer\r\n */\r\nexport function getChunkLinesPosition(chunkLines, layer, positionMap, centerPt) {\r\n    const positions = [], positionsV = [], lnglats = [];\r\n    for (let i = 0, len = chunkLines.length; i < len; i++) {\r\n        const line = chunkLines[i];\r\n        for (let j = 0, len1 = line.length; j < len1; j++) {\r\n            const lnglat = line[j];\r\n            if (lnglats.length > 0) {\r\n                const key = lnglat.join(COMMA).toString();\r\n                const key1 = lnglats[lnglats.length - 1].join(COMMA).toString();\r\n                if (key !== key1) {\r\n                    lnglats.push(lnglat);\r\n                }\r\n            }\r\n            else {\r\n                lnglats.push(lnglat);\r\n            }\r\n        }\r\n    }\r\n    const z = 0;\r\n    for (let i = 0, len = lnglats.length; i < len; i++) {\r\n        const lnglat = lnglats[i];\r\n        let v;\r\n        const key = lnglat.join(COMMA).toString();\r\n        if (positionMap && positionMap[key]) {\r\n            v = positionMap[key];\r\n        }\r\n        else {\r\n            v = layer.coordinateToVector3(lnglat, z).sub(centerPt);\r\n        }\r\n        positionsV.push(v);\r\n        positions.push(v.x, v.y, v.z);\r\n    }\r\n    return {\r\n        positions: positions,\r\n        positionsV: positionsV,\r\n        lnglats: lnglats\r\n    };\r\n}\r\n/**\r\n *\r\n * @param {*} lineString\r\n * @param {*} lineWidth\r\n * @param {*} depth\r\n * @param {*} layer\r\n */\r\nexport function getExtrudeLineParams(lineString, lineWidth = 1, depth = 1, layer, center) {\r\n    const positions = getLinePosition(lineString, layer, center).positionsV;\r\n    const ps = [];\r\n    for (let i = 0, len = positions.length; i < len; i++) {\r\n        const p = positions[i];\r\n        ps.push([p.x, p.y]);\r\n    }\r\n    const { indices, position, normal, uv } = extrudePolyline([ps], {\r\n        lineWidth: lineWidth,\r\n        depth: depth\r\n    });\r\n    return {\r\n        position: position,\r\n        normal: normal,\r\n        indices: indices,\r\n        uv\r\n    };\r\n}\r\nexport function LineStringSplit(lineString) {\r\n    let lineStrings = [], center;\r\n    if (lineString instanceof maptalks.MultiLineString) {\r\n        lineStrings = lineString.getGeometries();\r\n        center = lineString.getCenter();\r\n    }\r\n    else if (lineString instanceof maptalks.LineString) {\r\n        lineStrings.push(lineString);\r\n        center = lineString.getCenter();\r\n    }\r\n    else if (isGeoJSON(lineString)) {\r\n        center = getGeoJSONCenter(lineString);\r\n        if (isGeoJSONMulti(lineString)) {\r\n            lineStrings = spliteGeoJSONMulti(lineString);\r\n        }\r\n        else {\r\n            lineStrings.push(lineString);\r\n        }\r\n    }\r\n    return {\r\n        lineStrings,\r\n        center\r\n    };\r\n}\r\nexport function setLineSegmentPosition(position, positionsV) {\r\n    for (let i = 0, len = positionsV.length; i < len; i++) {\r\n        const v = positionsV[i];\r\n        if (i > 0 && i < len - 1) {\r\n            position.push(v.x, v.y, v.z);\r\n        }\r\n        position.push(v.x, v.y, v.z);\r\n    }\r\n}\r\nexport function getLineSegmentPosition(ps) {\r\n    const position = new Float32Array(ps.length * 2 - 6);\r\n    let j = 0;\r\n    for (let i = 0, len = ps.length / 3; i < len; i++) {\r\n        const x = ps[i * 3], y = ps[i * 3 + 1], z = ps[i * 3 + 2];\r\n        if (i > 0 && i < len - 1) {\r\n            const idx = j * 3;\r\n            position[idx] = x;\r\n            position[idx + 1] = y;\r\n            position[idx + 2] = z;\r\n            j++;\r\n        }\r\n        const idx = j * 3;\r\n        position[idx] = x;\r\n        position[idx + 1] = y;\r\n        position[idx + 2] = z;\r\n        j++;\r\n    }\r\n    return position;\r\n}\r\nexport function mergeLinePositions(positionsList) {\r\n    let len = 0;\r\n    const l = positionsList.length;\r\n    if (l === 1) {\r\n        return positionsList[0];\r\n    }\r\n    for (let i = 0; i < l; i++) {\r\n        len += positionsList[i].length;\r\n    }\r\n    const position = new Float32Array(len);\r\n    let offset = 0;\r\n    for (let i = 0; i < l; i++) {\r\n        position.set(positionsList[i], offset);\r\n        offset += positionsList[i].length;\r\n    }\r\n    return position;\r\n}\r\nexport function getLineArrayBuffer(lineString) {\r\n    if (lineString instanceof maptalks.LineString) {\r\n        return coordiantesToArrayBuffer(lineString.getCoordinates());\r\n    }\r\n    else if (isGeoJSONLine(lineString)) {\r\n        return coordiantesToArrayBuffer(lineString.geometry.coordinates);\r\n    }\r\n}\r\nlet defaultGeometry;\r\nexport function getDefaultLineGeometry() {\r\n    if (!defaultGeometry) {\r\n        defaultGeometry = new THREE.BufferGeometry();\r\n        addAttribute(defaultGeometry, 'position', new THREE.BufferAttribute(new Float32Array(3), 3));\r\n    }\r\n    return defaultGeometry;\r\n}\r\n//# sourceMappingURL=LineUtil.js.map","// eslint-disable-next-line quotes\r\nconst workerCode = `{code}`;\r\nconst workerName = '__maptalks.three__';\r\nexport function getWorkerName() {\r\n    return workerName;\r\n}\r\nexport function getWorkerCode() {\r\n    return workerCode;\r\n}\r\n//# sourceMappingURL=worker.js.map","import * as maptalks from 'maptalks';\r\nimport { isGeoJSONLine, isGeoJSONPolygon } from '../util/GeoJSONUtil';\r\nimport { getPolygonArrayBuffer, getPolygonPositions } from '../util/ExtrudeUtil';\r\n// import pkg from './../../package.json';\r\nimport { getLineArrayBuffer, getLinePosition } from '../util/LineUtil';\r\nimport { getWorkerName } from './worker';\r\nlet MeshActor;\r\nif (maptalks.worker) {\r\n    MeshActor = class extends maptalks.worker.Actor {\r\n        test(info, cb) {\r\n            //send data to worker thread\r\n            this.send(info, null, cb);\r\n        }\r\n        pushQueue(q = {}) {\r\n            const { type, data, callback, layer, key, center, lineStrings, options, id } = q;\r\n            let params;\r\n            if (type.indexOf('ExtrudePolygon') > -1) {\r\n                params = gengerateExtrudePolygons(data, center, layer, options);\r\n            }\r\n            else if (type === 'ExtrudeLines') {\r\n                params = gengerateExtrudeLines(data, center, layer, lineStrings);\r\n            }\r\n            else if (type === 'Point') {\r\n                //todo points\r\n            }\r\n            else if (type === 'Line' || type === 'FatLine') {\r\n                params = gengerateLines(data, center, layer, lineStrings, options);\r\n            }\r\n            else if (type === 'Lines' || type === 'FatLines') {\r\n                params = gengerateLines(data, center, layer, lineStrings);\r\n            }\r\n            else if (type === 'ExtrudeLine') {\r\n                params = gengerateExtrudeLines(data, center, layer, lineStrings, options);\r\n            }\r\n            if (!params) {\r\n                console.error(`not support '${type}' worker`);\r\n                return;\r\n            }\r\n            this.send({ type, datas: params.datas, glRes: params.glRes, matrix: params.matrix, center: params.center }, params.transfer, function (err, message) {\r\n                if (err) {\r\n                    console.error(err);\r\n                }\r\n                message.key = key;\r\n                message.id = id;\r\n                callback(message);\r\n            });\r\n        }\r\n    };\r\n}\r\nvar actor;\r\nexport function getActor() {\r\n    if (!maptalks.worker) {\r\n        console.error('maptalks.worker is not defined,You can\\'t use ThreeVectorTileLayer');\r\n    }\r\n    if (!actor && MeshActor) {\r\n        actor = new MeshActor(getWorkerName());\r\n    }\r\n    return actor;\r\n}\r\n/**\r\n *\r\n * @param distance\r\n * @param layer\r\n * @param altCache\r\n * @returns\r\n */\r\nfunction getDistance(distance, layer, altCache = {}) {\r\n    if (distance !== undefined && typeof distance === 'number' && distance !== 0) {\r\n        if (altCache[distance] === undefined) {\r\n            altCache[distance] = layer.distanceToVector3(distance, distance).x;\r\n        }\r\n        return altCache[distance];\r\n    }\r\n    return 0;\r\n}\r\n/**\r\n * generate extrudepolygons data for worker\r\n * @param {*} polygons\r\n * @param {*} layer\r\n */\r\nfunction gengerateExtrudePolygons(polygons = [], center, layer, options = []) {\r\n    const isMercator = layer.isMercator();\r\n    let glRes, matrix;\r\n    if (isMercator) {\r\n        const map = layer.getMap();\r\n        glRes = map.getGLRes();\r\n        matrix = map.getSpatialReference().getTransformation().matrix;\r\n    }\r\n    let centerPt;\r\n    if (center) {\r\n        centerPt = layer.coordinateToVector3(center);\r\n    }\r\n    const len = polygons.length;\r\n    const datas = [], transfer = [], altCache = {};\r\n    for (let i = 0; i < len; i++) {\r\n        const polygon = polygons[i];\r\n        const p = polygon;\r\n        const properties = options[i] ? options[i] : (isGeoJSONPolygon(p) ? p['properties'] : p.getProperties() || {});\r\n        if (!center) {\r\n            centerPt = layer.coordinateToVector3(properties.center);\r\n        }\r\n        let data;\r\n        if (isMercator) {\r\n            data = getPolygonArrayBuffer(polygon);\r\n        }\r\n        else {\r\n            data = getPolygonPositions(polygon, layer, properties.center || center, centerPt, true);\r\n        }\r\n        for (let j = 0, len1 = data.length; j < len1; j++) {\r\n            const d = data[j];\r\n            for (let m = 0, len2 = d.length; m < len2; m++) {\r\n                //ring\r\n                transfer.push(d[m]);\r\n            }\r\n        }\r\n        let height = properties.height || 1;\r\n        let bottomHeight = properties.bottomHeight || 0;\r\n        height = getDistance(height, layer, altCache);\r\n        bottomHeight = getDistance(bottomHeight, layer, altCache);\r\n        const d = {\r\n            id: properties.id,\r\n            data,\r\n            height,\r\n            bottomHeight\r\n        };\r\n        if (isMercator) {\r\n            d.center = [centerPt.x, centerPt.y];\r\n        }\r\n        datas.push(d);\r\n        //delete Internal properties\r\n        if (p._properties) {\r\n            delete p._properties;\r\n        }\r\n    }\r\n    return {\r\n        datas,\r\n        transfer,\r\n        glRes,\r\n        matrix,\r\n        center: isMercator ? [centerPt.x, centerPt.y] : null\r\n    };\r\n}\r\n/**\r\n * generate ExtrudeLines data for worker\r\n * @param {*} lineStringList\r\n * @param {*} center\r\n * @param {*} layer\r\n */\r\nfunction gengerateExtrudeLines(lineStringList, center, layer, lineStrings, options = []) {\r\n    const isMercator = layer.isMercator();\r\n    let glRes, matrix;\r\n    if (isMercator) {\r\n        const map = layer.getMap();\r\n        glRes = map.getGLRes();\r\n        matrix = map.getSpatialReference().getTransformation().matrix;\r\n    }\r\n    let centerPt;\r\n    if (center) {\r\n        centerPt = layer.coordinateToVector3(center);\r\n    }\r\n    const datas = [], transfer = [], altCache = {};\r\n    const len = lineStringList.length;\r\n    for (let i = 0; i < len; i++) {\r\n        const multiLineString = lineStringList[i];\r\n        const properties = options[i] ? options[i] : (isGeoJSONLine(lineStrings[i]) ? lineStrings[i]['properties'] : lineStrings[i].getProperties() || {});\r\n        if (!center) {\r\n            centerPt = layer.coordinateToVector3(properties.center);\r\n        }\r\n        let width = properties.width || 1;\r\n        let height = properties.height || 1;\r\n        let bottomHeight = properties.bottomHeight || 0;\r\n        width = getDistance(width, layer, altCache);\r\n        height = getDistance(height, layer, altCache);\r\n        bottomHeight = getDistance(bottomHeight, layer, altCache);\r\n        const data = [];\r\n        for (let j = 0, len1 = multiLineString.length; j < len1; j++) {\r\n            const lineString = multiLineString[j];\r\n            let arrayBuffer;\r\n            if (isMercator) {\r\n                arrayBuffer = getLineArrayBuffer(lineString);\r\n            }\r\n            else {\r\n                arrayBuffer = getLinePosition(lineString, layer, center, false).arrayBuffer;\r\n            }\r\n            transfer.push(arrayBuffer);\r\n            data.push(arrayBuffer);\r\n        }\r\n        const d = {\r\n            id: properties.id,\r\n            data,\r\n            height,\r\n            width,\r\n            bottomHeight\r\n        };\r\n        if (isMercator) {\r\n            d.center = [centerPt.x, centerPt.y];\r\n        }\r\n        datas.push(d);\r\n    }\r\n    return {\r\n        datas,\r\n        transfer,\r\n        glRes,\r\n        matrix,\r\n        center: isMercator ? [centerPt.x, centerPt.y] : null\r\n    };\r\n}\r\n/**\r\n * generate Lines data for worker\r\n * @param lineStringList\r\n * @param center\r\n * @param layer\r\n * @param lineStrings\r\n * @param options\r\n * @returns\r\n */\r\nfunction gengerateLines(lineStringList, center, layer, lineStrings, options = []) {\r\n    const isMercator = layer.isMercator();\r\n    let glRes, matrix;\r\n    if (isMercator) {\r\n        const map = layer.getMap();\r\n        glRes = map.getGLRes();\r\n        matrix = map.getSpatialReference().getTransformation().matrix;\r\n    }\r\n    let centerPt;\r\n    if (center) {\r\n        centerPt = layer.coordinateToVector3(center);\r\n    }\r\n    const datas = [], transfer = [], altCache = {};\r\n    const len = lineStringList.length;\r\n    for (let i = 0; i < len; i++) {\r\n        const multiLineString = lineStringList[i];\r\n        const properties = options[i] ? options[i] : (isGeoJSONLine(lineStrings[i]) ? lineStrings[i]['properties'] : lineStrings[i].getProperties() || {});\r\n        if (!center) {\r\n            centerPt = layer.coordinateToVector3(properties.center);\r\n        }\r\n        let bottomHeight = properties.bottomHeight || 0;\r\n        bottomHeight = getDistance(bottomHeight, layer, altCache);\r\n        const data = [];\r\n        for (let j = 0, len1 = multiLineString.length; j < len1; j++) {\r\n            const lineString = multiLineString[j];\r\n            if (isMercator) {\r\n                const arrayBuffer = getLineArrayBuffer(lineString);\r\n                data.push(arrayBuffer);\r\n                data.push(arrayBuffer);\r\n            }\r\n            else {\r\n                const arrayBuffer = getLinePosition(lineString, layer, center, false).arrayBuffer;\r\n                transfer.push(arrayBuffer);\r\n                data.push(arrayBuffer);\r\n            }\r\n        }\r\n        const d = {\r\n            id: properties.id,\r\n            data,\r\n            bottomHeight\r\n        };\r\n        if (isMercator) {\r\n            d.center = [centerPt.x, centerPt.y];\r\n        }\r\n        datas.push(d);\r\n    }\r\n    return {\r\n        datas,\r\n        transfer,\r\n        glRes,\r\n        matrix,\r\n        center: isMercator ? [centerPt.x, centerPt.y] : null\r\n    };\r\n}\r\n//# sourceMappingURL=MeshActor.js.map","import * as maptalks from 'maptalks';\r\nimport { getActor } from './worker/MeshActor';\r\nfunction getDatas(queues) {\r\n    return queues.map(q => {\r\n        return q.data;\r\n    });\r\n}\r\nfunction getOptions(queues) {\r\n    return queues.map(q => {\r\n        return q.baseObject.getOptions();\r\n    });\r\n}\r\nclass BaseObjectTask {\r\n    constructor() {\r\n        this.queueMap = {};\r\n        this.tempQueue = [];\r\n        this.time = this.getCurrentTime();\r\n        this.deQueueCount = 5;\r\n        this.resultQueue = [];\r\n    }\r\n    getCurrentTime() {\r\n        return maptalks.Util.now();\r\n    }\r\n    loop() {\r\n        this.deQueue();\r\n    }\r\n    push(data) {\r\n        this.tempQueue.push(data);\r\n        if (data.id) {\r\n            this.queueMap[data.id] = data;\r\n        }\r\n        return this;\r\n    }\r\n    reset() {\r\n        this.time = this.getCurrentTime();\r\n        this.tempQueue = [];\r\n        return this;\r\n    }\r\n    pushResult(result) {\r\n        if (!result) {\r\n            return;\r\n        }\r\n        if (!Array.isArray(result)) {\r\n            result = [result];\r\n        }\r\n        result.forEach(d => {\r\n            this.resultQueue.push(d);\r\n        });\r\n        return this;\r\n    }\r\n    deQueue() {\r\n        if (!this.resultQueue.length) {\r\n            return this;\r\n        }\r\n        const count = this.deQueueCount;\r\n        const resultList = this.resultQueue.slice(0, count) || [];\r\n        resultList.forEach(result => {\r\n            const { id } = result;\r\n            if (this.queueMap[id]) {\r\n                const { baseObject } = this.queueMap[id];\r\n                if (baseObject && baseObject._workerLoad) {\r\n                    baseObject._workerLoad(result);\r\n                }\r\n                delete this.queueMap[id];\r\n            }\r\n        });\r\n        this.resultQueue.splice(0, count);\r\n        return this;\r\n    }\r\n}\r\nclass ExtrudePolygonTask extends BaseObjectTask {\r\n    constructor() {\r\n        super();\r\n        this.deQueueCount = 100;\r\n    }\r\n    loop() {\r\n        const t = this.getCurrentTime();\r\n        if ((t - this.time >= 32 || this.tempQueue.length >= 1000) && this.tempQueue.length) {\r\n            const actor = getActor();\r\n            actor.pushQueue({\r\n                type: 'ExtrudePolygon',\r\n                layer: this.tempQueue[0].layer,\r\n                data: getDatas(this.tempQueue),\r\n                options: getOptions(this.tempQueue),\r\n                callback: (result) => {\r\n                    this.pushResult(result);\r\n                }\r\n            });\r\n            this.reset();\r\n        }\r\n        super.loop();\r\n    }\r\n}\r\nclass ExtrudePolygonsTask extends BaseObjectTask {\r\n    loop() {\r\n        if (this.tempQueue.length) {\r\n            const actor = getActor();\r\n            this.tempQueue.forEach(queue => {\r\n                actor.pushQueue({\r\n                    id: queue.id,\r\n                    type: 'ExtrudePolygons',\r\n                    layer: queue.layer,\r\n                    data: queue.data,\r\n                    key: queue.key,\r\n                    center: queue.center,\r\n                    callback: (result) => {\r\n                        this.pushResult(result);\r\n                    }\r\n                });\r\n            });\r\n            this.reset();\r\n        }\r\n        super.loop();\r\n    }\r\n}\r\nclass ExtrudeLineTask extends BaseObjectTask {\r\n    constructor() {\r\n        super();\r\n        this.deQueueCount = 100;\r\n    }\r\n    loop() {\r\n        const t = this.getCurrentTime();\r\n        if ((t - this.time >= 32 || this.tempQueue.length >= 1000) && this.tempQueue.length) {\r\n            const actor = getActor();\r\n            actor.pushQueue({\r\n                type: 'ExtrudeLine',\r\n                layer: this.tempQueue[0].layer,\r\n                data: getDatas(this.tempQueue),\r\n                options: getOptions(this.tempQueue),\r\n                lineStrings: this.tempQueue.map(q => {\r\n                    return q.lineString;\r\n                }),\r\n                callback: (result) => {\r\n                    this.pushResult(result);\r\n                }\r\n            });\r\n            this.reset();\r\n        }\r\n        super.loop();\r\n    }\r\n}\r\nclass ExtrudeLinesTask extends BaseObjectTask {\r\n    loop() {\r\n        if (this.tempQueue.length) {\r\n            const actor = getActor();\r\n            this.tempQueue.forEach(queue => {\r\n                actor.pushQueue({\r\n                    id: queue.id,\r\n                    type: 'ExtrudeLines',\r\n                    layer: queue.layer,\r\n                    data: queue.data,\r\n                    key: queue.key,\r\n                    lineStrings: queue.lineStrings,\r\n                    center: queue.center,\r\n                    callback: (result) => {\r\n                        this.pushResult(result);\r\n                    }\r\n                });\r\n            });\r\n            this.reset();\r\n        }\r\n        super.loop();\r\n    }\r\n}\r\nclass LineTask extends BaseObjectTask {\r\n    constructor() {\r\n        super();\r\n        this.deQueueCount = 200;\r\n    }\r\n    loop() {\r\n        const t = this.getCurrentTime();\r\n        if ((t - this.time >= 32 || this.tempQueue.length >= 1000) && this.tempQueue.length) {\r\n            const actor = getActor();\r\n            actor.pushQueue({\r\n                type: 'Line',\r\n                layer: this.tempQueue[0].layer,\r\n                data: getDatas(this.tempQueue),\r\n                options: getOptions(this.tempQueue),\r\n                lineStrings: this.tempQueue.map(q => {\r\n                    return q.lineString;\r\n                }),\r\n                callback: (result) => {\r\n                    this.pushResult(result);\r\n                }\r\n            });\r\n            this.reset();\r\n        }\r\n        super.loop();\r\n    }\r\n}\r\nclass LinesTask extends BaseObjectTask {\r\n    loop() {\r\n        if (this.tempQueue.length) {\r\n            const actor = getActor();\r\n            this.tempQueue.forEach(queue => {\r\n                actor.pushQueue({\r\n                    id: queue.id,\r\n                    type: 'Lines',\r\n                    layer: queue.layer,\r\n                    data: queue.data,\r\n                    key: queue.key,\r\n                    lineStrings: queue.lineStrings,\r\n                    center: queue.center,\r\n                    callback: (result) => {\r\n                        this.pushResult(result);\r\n                    }\r\n                });\r\n            });\r\n            this.reset();\r\n        }\r\n        super.loop();\r\n    }\r\n}\r\nclass FatLineTask extends BaseObjectTask {\r\n    constructor() {\r\n        super();\r\n        this.deQueueCount = 100;\r\n    }\r\n    loop() {\r\n        const t = this.getCurrentTime();\r\n        if ((t - this.time >= 32 || this.tempQueue.length >= 1000) && this.tempQueue.length) {\r\n            const actor = getActor();\r\n            actor.pushQueue({\r\n                type: 'FatLine',\r\n                layer: this.tempQueue[0].layer,\r\n                data: getDatas(this.tempQueue),\r\n                options: getOptions(this.tempQueue),\r\n                lineStrings: this.tempQueue.map(q => {\r\n                    return q.lineString;\r\n                }),\r\n                callback: (result) => {\r\n                    this.pushResult(result);\r\n                }\r\n            });\r\n            this.reset();\r\n        }\r\n        super.loop();\r\n    }\r\n}\r\nclass FatLinesTask extends BaseObjectTask {\r\n    loop() {\r\n        if (this.tempQueue.length) {\r\n            const actor = getActor();\r\n            this.tempQueue.forEach(queue => {\r\n                actor.pushQueue({\r\n                    id: queue.id,\r\n                    type: 'FatLines',\r\n                    layer: queue.layer,\r\n                    data: queue.data,\r\n                    key: queue.key,\r\n                    lineStrings: queue.lineStrings,\r\n                    center: queue.center,\r\n                    callback: (result) => {\r\n                        this.pushResult(result);\r\n                    }\r\n                });\r\n            });\r\n            this.reset();\r\n        }\r\n        super.loop();\r\n    }\r\n}\r\nexport const ExtrudePolygonTaskIns = new ExtrudePolygonTask();\r\nexport const ExtrudePolygonsTaskIns = new ExtrudePolygonsTask();\r\nexport const ExtrudeLineTaskIns = new ExtrudeLineTask();\r\nexport const ExtrudeLinesTaskIns = new ExtrudeLinesTask();\r\nexport const LineTaskIns = new LineTask();\r\nexport const LinesTaskIns = new LinesTask();\r\nexport const FatLineTaskIns = new FatLineTask();\r\nexport const FatLinesTaskIns = new FatLinesTask();\r\nexport const BaseObjectTaskManager = {\r\n    isRunning: false,\r\n    loop() {\r\n        ExtrudePolygonTaskIns.loop();\r\n        ExtrudePolygonsTaskIns.loop();\r\n        ExtrudeLineTaskIns.loop();\r\n        ExtrudeLinesTaskIns.loop();\r\n        LineTaskIns.loop();\r\n        LinesTaskIns.loop();\r\n        FatLineTaskIns.loop();\r\n        FatLinesTaskIns.loop();\r\n        maptalks.Util.requestAnimFrame(BaseObjectTaskManager.loop);\r\n    },\r\n    star() {\r\n        if (!BaseObjectTaskManager.isRunning) {\r\n            BaseObjectTaskManager.isRunning = true;\r\n            BaseObjectTaskManager.loop();\r\n        }\r\n    }\r\n};\r\n//# sourceMappingURL=BaseObjectTaskManager.js.map","import * as maptalks from 'maptalks';\r\nimport * as THREE from 'three';\r\nimport BaseObject from './BaseObject';\r\nimport { LineTaskIns } from './BaseObjectTaskManager';\r\nimport { setBottomHeight } from './util';\r\nimport { getDefaultLineGeometry, getLinePosition, getLineSegmentPosition, LineStringSplit, mergeLinePositions } from './util/LineUtil';\r\nimport { addAttribute, getVertexColors } from './util/ThreeAdaptUtil';\r\nfunction initColors(cs) {\r\n    const colors = [];\r\n    if (cs && cs.length) {\r\n        cs.forEach(color => {\r\n            color = (color instanceof THREE.Color ? color : new THREE.Color(color));\r\n            colors.push(color.r, color.g, color.b);\r\n        });\r\n    }\r\n    return colors;\r\n}\r\nconst OPTIONS = {\r\n    altitude: 0,\r\n    bottomHeight: 0,\r\n    colors: null\r\n};\r\n/**\r\n *\r\n */\r\nclass Line extends BaseObject {\r\n    constructor(lineString, options, material, layer) {\r\n        options = maptalks.Util.extend({}, OPTIONS, options, { layer, lineString });\r\n        super();\r\n        this._initOptions(options);\r\n        const { lineStrings, center } = LineStringSplit(lineString);\r\n        const { asynchronous } = options;\r\n        let geometry;\r\n        if (asynchronous) {\r\n            geometry = getDefaultLineGeometry();\r\n            const id = maptalks.Util.GUID();\r\n            this.getOptions().id = id;\r\n            this.getOptions().center = center;\r\n            LineTaskIns.push({\r\n                id,\r\n                data: lineStrings,\r\n                layer,\r\n                key: options.key,\r\n                lineString,\r\n                baseObject: this\r\n            });\r\n        }\r\n        else {\r\n            const positionList = [];\r\n            for (let i = 0, len = lineStrings.length; i < len; i++) {\r\n                const lineString = lineStrings[i];\r\n                const { positions } = getLinePosition(lineString, layer, center, false);\r\n                positionList.push(getLineSegmentPosition(positions));\r\n            }\r\n            const position = mergeLinePositions(positionList);\r\n            geometry = new THREE.BufferGeometry();\r\n            addAttribute(geometry, 'position', new THREE.BufferAttribute(position, 3));\r\n            setBottomHeight(geometry, options.bottomHeight, layer);\r\n            const colors = initColors(options.colors);\r\n            if (colors && colors.length) {\r\n                addAttribute(geometry, 'color', new THREE.Float32BufferAttribute(colors, 3));\r\n                material.vertexColors = getVertexColors();\r\n            }\r\n        }\r\n        this._createLineSegments(geometry, material);\r\n        const { altitude } = options;\r\n        const z = layer.distanceToVector3(altitude, altitude).x;\r\n        const v = layer.coordinateToVector3(center, z);\r\n        this.getObject3d().position.copy(v);\r\n        this.type = 'Line';\r\n    }\r\n    _workerLoad(result) {\r\n        const geometry = new THREE.BufferGeometry();\r\n        addAttribute(geometry, 'position', new THREE.BufferAttribute(new Float32Array(result.position), 3));\r\n        const colors = initColors(this.getOptions().colors);\r\n        const object3d = this.getObject3d();\r\n        const material = object3d.material;\r\n        if (colors && colors.length) {\r\n            addAttribute(geometry, 'color', new THREE.Float32BufferAttribute(colors, 3));\r\n            material.vertexColors = getVertexColors();\r\n        }\r\n        this._computeLineDistances(geometry);\r\n        object3d.geometry = geometry;\r\n        object3d.material.needsUpdate = true;\r\n        this._fire('workerload', { target: this });\r\n    }\r\n}\r\nexport default Line;\r\n//# sourceMappingURL=Line.js.map","import * as maptalks from 'maptalks';\r\nimport BaseObject from './BaseObject';\r\nimport { ExtrudeLineTaskIns } from './BaseObjectTaskManager';\r\nimport { setBottomHeight } from './util';\r\nimport { initVertexColors } from './util/ExtrudeUtil';\r\nimport { LineStringSplit, getExtrudeLineParams } from './util/LineUtil';\r\nimport { generateBufferGeometry, getDefaultBufferGeometry, mergeBufferGeometries } from './util/MergeGeometryUtil';\r\nimport { getVertexColors } from './util/ThreeAdaptUtil';\r\nconst OPTIONS = {\r\n    bottomHeight: 0,\r\n    width: 3,\r\n    height: 1,\r\n    altitude: 0,\r\n    topColor: null,\r\n    bottomColor: '#2d2f61',\r\n    heightEnable: true\r\n};\r\n/**\r\n *\r\n */\r\nclass ExtrudeLine extends BaseObject {\r\n    constructor(lineString, options, material, layer) {\r\n        options = maptalks.Util.extend({}, OPTIONS, options, { layer, lineString });\r\n        super();\r\n        this._initOptions(options);\r\n        const { height, width, bottomColor, topColor, bottomHeight, altitude, asynchronous } = options;\r\n        const h = layer.distanceToVector3(height, height).x;\r\n        const w = layer.distanceToVector3(width, width).x;\r\n        const { lineStrings, center } = LineStringSplit(lineString);\r\n        let geometry;\r\n        if (asynchronous) {\r\n            geometry = getDefaultBufferGeometry();\r\n            const id = maptalks.Util.GUID();\r\n            this.getOptions().id = id;\r\n            this.getOptions().center = center;\r\n            ExtrudeLineTaskIns.push({\r\n                id,\r\n                data: lineStrings,\r\n                layer,\r\n                center,\r\n                lineString,\r\n                baseObject: this\r\n            });\r\n        }\r\n        else {\r\n            const extrudeParams = [];\r\n            let minZ = 0;\r\n            const cache = {};\r\n            for (let i = 0, len = lineStrings.length; i < len; i++) {\r\n                const attribute = getExtrudeLineParams(lineStrings[i], w, h, layer, center);\r\n                minZ = setBottomHeight(attribute, bottomHeight, layer, cache);\r\n                extrudeParams.push(attribute);\r\n            }\r\n            geometry = mergeBufferGeometries(extrudeParams);\r\n            if (topColor) {\r\n                initVertexColors(geometry, bottomColor, topColor, minZ + h / 2);\r\n                material.vertexColors = getVertexColors();\r\n            }\r\n        }\r\n        this._createMesh(geometry, material);\r\n        // const center = (isGeoJSON(lineString) ? getGeoJSONCenter(lineString) : lineString.getCenter());\r\n        const z = layer.distanceToVector3(altitude, altitude).x;\r\n        const v = layer.coordinateToVector3(center, z);\r\n        this.getObject3d().position.copy(v);\r\n        this.type = 'ExtrudeLine';\r\n    }\r\n    _workerLoad(result) {\r\n        const bufferGeometry = generateBufferGeometry(result);\r\n        const { topColor, bottomColor, bottomHeight, height } = this.getOptions();\r\n        const object3d = this.getObject3d();\r\n        const material = object3d.material;\r\n        if (topColor) {\r\n            const layer = this.getLayer();\r\n            const h = layer.distanceToVector3(bottomHeight, bottomHeight).x;\r\n            const extrudeH = layer.distanceToVector3(height, height).x;\r\n            initVertexColors(bufferGeometry, bottomColor, topColor, h + extrudeH / 2);\r\n            material.vertexColors = getVertexColors();\r\n        }\r\n        object3d.geometry = bufferGeometry;\r\n        object3d.material.needsUpdate = true;\r\n        this._fire('workerload', { target: this });\r\n    }\r\n}\r\nexport default ExtrudeLine;\r\n//# sourceMappingURL=ExtrudeLine.js.map","import * as maptalks from 'maptalks';\r\nimport BaseObject from './BaseObject';\r\nimport { ExtrudePolygonTaskIns } from './BaseObjectTaskManager';\r\nimport { setBottomHeight } from './util';\r\nimport { getExtrudeGeometry, initVertexColors } from './util/ExtrudeUtil';\r\nimport { getGeoJSONCenter, isGeoJSONPolygon } from './util/GeoJSONUtil';\r\nimport { generateBufferGeometry, getDefaultBufferGeometry } from './util/MergeGeometryUtil';\r\nimport { getVertexColors } from './util/ThreeAdaptUtil';\r\nconst OPTIONS = {\r\n    altitude: 0,\r\n    height: 1,\r\n    bottomHeight: 0,\r\n    topColor: null,\r\n    bottomColor: '#2d2f61',\r\n    heightEnable: true\r\n};\r\n/**\r\n *\r\n */\r\nclass ExtrudePolygon extends BaseObject {\r\n    constructor(polygon, options, material, layer) {\r\n        options = maptalks.Util.extend({}, OPTIONS, options, { layer, polygon });\r\n        super();\r\n        this._initOptions(options);\r\n        const { height, topColor, bottomColor, altitude, bottomHeight, asynchronous } = options;\r\n        let geometry;\r\n        const center = (isGeoJSONPolygon(polygon) ? getGeoJSONCenter(polygon) : polygon.getCenter());\r\n        if (asynchronous) {\r\n            geometry = getDefaultBufferGeometry();\r\n            const id = maptalks.Util.GUID();\r\n            this.getOptions().id = id;\r\n            this.getOptions().center = center;\r\n            ExtrudePolygonTaskIns.push({\r\n                data: polygon,\r\n                layer,\r\n                id,\r\n                baseObject: this\r\n            });\r\n        }\r\n        else {\r\n            geometry = getExtrudeGeometry(polygon, height, layer);\r\n            const h = setBottomHeight(geometry, bottomHeight, layer);\r\n            if (topColor) {\r\n                const extrudeH = layer.distanceToVector3(height, height).x;\r\n                initVertexColors(geometry, bottomColor, topColor, h + extrudeH / 2);\r\n                material.vertexColors = getVertexColors();\r\n            }\r\n        }\r\n        this._createMesh(geometry, material);\r\n        const z = layer.distanceToVector3(altitude, altitude).x;\r\n        const v = layer.coordinateToVector3(center, z);\r\n        this.getObject3d().position.copy(v);\r\n        this.type = 'ExtrudePolygon';\r\n    }\r\n    _workerLoad(data) {\r\n        const bufferGeometry = generateBufferGeometry(data);\r\n        const { topColor, bottomColor, bottomHeight, height } = this.getOptions();\r\n        const object3d = this.getObject3d();\r\n        const material = object3d.material;\r\n        if (topColor) {\r\n            const layer = this.getLayer();\r\n            const h = layer.distanceToVector3(bottomHeight, bottomHeight).x;\r\n            const extrudeH = layer.distanceToVector3(height, height).x;\r\n            initVertexColors(bufferGeometry, bottomColor, topColor, h + extrudeH / 2);\r\n            material.vertexColors = getVertexColors();\r\n        }\r\n        object3d.geometry = bufferGeometry;\r\n        object3d.material.needsUpdate = true;\r\n        this._fire('workerload', { target: this });\r\n    }\r\n}\r\nexport default ExtrudePolygon;\r\n//# sourceMappingURL=ExtrudePolygon.js.map","import * as maptalks from 'maptalks';\r\nimport BaseObject from './BaseObject';\r\nconst OPTIONS = {\r\n    altitude: 0,\r\n    coordinate: null\r\n};\r\n/**\r\n * Model container\r\n */\r\nclass Model extends BaseObject {\r\n    constructor(model, options = {}, layer) {\r\n        if (!options.coordinate) {\r\n            console.warn('coordinate is null,it is important to locate the model');\r\n            options.coordinate = layer.getMap().getCenter();\r\n        }\r\n        options = maptalks.Util.extend({}, OPTIONS, options, { layer, model });\r\n        super();\r\n        this._initOptions(options);\r\n        this._createGroup();\r\n        this.getObject3d().add(model);\r\n        const { altitude, coordinate } = options;\r\n        const z = layer.distanceToVector3(altitude, altitude).x;\r\n        const position = layer.coordinateToVector3(coordinate, z);\r\n        this.getObject3d().position.copy(position);\r\n        this.type = 'Model';\r\n    }\r\n}\r\nexport default Model;\r\n//# sourceMappingURL=Model.js.map","const PI = Math.PI / 180;\r\nconst R = 6378137;\r\nconst MINLENGTH = 1;\r\nfunction formatLineArray(polyline) {\r\n    const lnglats = polyline.getCoordinates();\r\n    return lnglats.map(lnglat => {\r\n        return lnglat.toArray();\r\n    });\r\n}\r\nfunction degreesToRadians(d) {\r\n    return d * PI;\r\n}\r\nexport function distance(c1, c2) {\r\n    if (!c1 || !c2) {\r\n        return 0;\r\n    }\r\n    if (!Array.isArray(c1)) {\r\n        c1 = c1.toArray();\r\n    }\r\n    if (!Array.isArray(c2)) {\r\n        c2 = c2.toArray();\r\n    }\r\n    let b = degreesToRadians(c1[1]);\r\n    const d = degreesToRadians(c2[1]), e = b - d, f = degreesToRadians(c1[0]) - degreesToRadians(c2[0]);\r\n    b = 2 * Math.asin(Math.sqrt(Math.pow(Math.sin(e / 2), 2) + Math.cos(b) * Math.cos(d) * Math.pow(Math.sin(f / 2), 2)));\r\n    b *= R;\r\n    return Math.round(b * 1E5) / 1E5;\r\n}\r\nexport function lineLength(polyline) {\r\n    let lnglatArray = polyline;\r\n    if (!Array.isArray(polyline)) {\r\n        lnglatArray = formatLineArray(polyline);\r\n    }\r\n    let l = 0;\r\n    for (let i = 0, len = lnglatArray.length; i < len - 1; i++) {\r\n        l += distance(lnglatArray[i], lnglatArray[i + 1]);\r\n    }\r\n    return l;\r\n}\r\nfunction getPercentLngLat(l, length) {\r\n    const { len, c1, c2 } = l;\r\n    const dx = c2[0] - c1[0], dy = c2[1] - c1[1];\r\n    const percent = length / len;\r\n    const lng = c1[0] + percent * dx;\r\n    const lat = c1[1] + percent * dy;\r\n    return [lng, lat];\r\n}\r\n/**\r\n * This is not an accurate line segment cutting method, but rough, in order to speed up the calculation,\r\n * the correct cutting algorithm can be referred to. http://turfjs.org/docs/#lineChunk\r\n * @param {*} cs\r\n * @param {*} lineChunkLength\r\n */\r\nexport function lineSlice(cs, lineChunkLength = 10) {\r\n    lineChunkLength = Math.max(lineChunkLength, MINLENGTH);\r\n    if (!Array.isArray(cs)) {\r\n        cs = formatLineArray(cs);\r\n    }\r\n    const LEN = cs.length;\r\n    let list = [];\r\n    let totalLen = 0;\r\n    for (let i = 0; i < LEN - 1; i++) {\r\n        const len = distance(cs[i], cs[i + 1]);\r\n        const floorlen = Math.floor(len);\r\n        list.push({\r\n            c1: cs[i],\r\n            len: floorlen,\r\n            c2: cs[i + 1]\r\n        });\r\n        totalLen += floorlen;\r\n    }\r\n    if (totalLen <= lineChunkLength) {\r\n        const lnglats = list.map(d => {\r\n            return [d.c1, d.c2];\r\n        });\r\n        return lnglats;\r\n    }\r\n    if (list.length === 1) {\r\n        if (list[0].len <= lineChunkLength) {\r\n            return [\r\n                [list[0].c1, list[0].c2]\r\n            ];\r\n        }\r\n    }\r\n    const LNGLATSLEN = list.length;\r\n    const first = list[0];\r\n    let idx = 0;\r\n    let currentLngLat;\r\n    let currentLen = 0;\r\n    const lines = [];\r\n    let lls = [first.c1];\r\n    while (idx < LNGLATSLEN) {\r\n        const { len, c2 } = list[idx];\r\n        currentLen += len;\r\n        if (currentLen < lineChunkLength) {\r\n            lls.push(c2);\r\n            if (idx === LNGLATSLEN - 1) {\r\n                lines.push(lls);\r\n            }\r\n            idx++;\r\n        }\r\n        if (currentLen === lineChunkLength) {\r\n            lls.push(c2);\r\n            currentLen = 0;\r\n            lines.push(lls);\r\n            //next\r\n            lls = [c2];\r\n            idx++;\r\n        }\r\n        if (currentLen > lineChunkLength) {\r\n            const offsetLen = (len - currentLen + lineChunkLength);\r\n            currentLngLat = getPercentLngLat(list[idx], offsetLen);\r\n            lls.push(currentLngLat);\r\n            lines.push(lls);\r\n            currentLen = 0;\r\n            list[idx].c1 = currentLngLat;\r\n            list[idx].len = len - offsetLen;\r\n            //next\r\n            lls = [];\r\n            lls.push(currentLngLat);\r\n        }\r\n    }\r\n    return lines;\r\n}\r\n//# sourceMappingURL=GeoUtil.js.map","import * as maptalks from 'maptalks';\r\nimport * as THREE from 'three';\r\nimport BaseObject from './BaseObject';\r\nimport { lineSlice } from './util/GeoUtil';\r\nimport { getExtrudeLineParams, getChunkLinesPosition } from './util/LineUtil';\r\nimport { isGeoJSON, getGeoJSONCenter, getGeoJSONCoordinates } from './util/GeoJSONUtil';\r\nimport { addAttribute } from './util/ThreeAdaptUtil';\r\nconst MAX_POINTS = 1000;\r\n/**\r\n *\r\n * @param {THREE.BufferGeometry} geometry\r\n * @param {*} ps\r\n * @param {*} norls\r\n * @param {*} indices\r\n */\r\nfunction setExtrudeLineGeometryAttribute(geometry, ps, norls, indices) {\r\n    const len = ps.length;\r\n    geometry.attributes.normal.count = len;\r\n    geometry.attributes.position.count = len;\r\n    const positions = geometry.attributes.position.array;\r\n    const normals = geometry.attributes.normal.array;\r\n    for (let i = 0; i < len; i++) {\r\n        positions[i] = ps[i];\r\n        normals[i] = norls[i];\r\n    }\r\n    // geometry.index.array = new Uint16Array(indices.length);\r\n    geometry.index.count = indices.length;\r\n    // geometry.index.needsUpdate = true;\r\n    for (let i = 0, len1 = indices.length; i < len1; i++) {\r\n        geometry.index.array[i] = indices[i];\r\n    }\r\n    // geometry.setIndex(new THREE.Uint32BufferAttribute(indices, 1));\r\n    // geometry.setDrawRange(0, len / 3);\r\n}\r\nconst OPTIONS = {\r\n    trail: 5,\r\n    chunkLength: 50,\r\n    width: 2,\r\n    height: 1,\r\n    speed: 1,\r\n    altitude: 0,\r\n    interactive: false,\r\n    heightEnable: true\r\n};\r\n/**\r\n *\r\n */\r\nclass ExtrudeLineTrail extends BaseObject {\r\n    constructor(lineString, options, material, layer) {\r\n        options = maptalks.Util.extend({}, OPTIONS, options, { layer, lineString });\r\n        super();\r\n        this._initOptions(options);\r\n        const { width, height, altitude, speed, chunkLength, trail } = options;\r\n        let center, coordinates;\r\n        if (isGeoJSON(lineString)) {\r\n            center = getGeoJSONCenter(lineString);\r\n            coordinates = getGeoJSONCoordinates(lineString);\r\n        }\r\n        else {\r\n            center = lineString.getCenter();\r\n            coordinates = lineString;\r\n        }\r\n        const chunkLines = lineSlice(coordinates, chunkLength);\r\n        const centerPt = layer.coordinateToVector3(center);\r\n        //cache position for  faster computing,reduce double counting\r\n        const positionMap = {};\r\n        for (let i = 0, len = chunkLines.length; i < len; i++) {\r\n            const chunkLine = chunkLines[i];\r\n            for (let j = 0, len1 = chunkLine.length; j < len1; j++) {\r\n                const lnglat = chunkLine[j];\r\n                const key = lnglat.join(',').toString();\r\n                if (!positionMap[key]) {\r\n                    positionMap[key] = layer.coordinateToVector3(lnglat).sub(centerPt);\r\n                }\r\n            }\r\n        }\r\n        const positions = getChunkLinesPosition(chunkLines.slice(0, 1), layer, positionMap, centerPt).positionsV;\r\n        //generate geometry\r\n        const geometry = new THREE.BufferGeometry();\r\n        const ps = new Float32Array(MAX_POINTS * 3); // 3 vertices per point\r\n        const norls = new Float32Array(MAX_POINTS * 3); // 3 vertices per point\r\n        const inds = new Uint16Array(MAX_POINTS);\r\n        addAttribute(geometry, 'position', (new THREE.BufferAttribute(ps, 3)));\r\n        addAttribute(geometry, 'normal', (new THREE.BufferAttribute(norls, 3)));\r\n        geometry.setIndex(new THREE.BufferAttribute(inds, 1));\r\n        const lineWidth = layer.distanceToVector3(width, width).x;\r\n        const depth = layer.distanceToVector3(height, height).x;\r\n        const params = getExtrudeLineParams(positions, lineWidth, depth, layer);\r\n        setExtrudeLineGeometryAttribute(geometry, params.position, params.normal, params.indices);\r\n        this._createMesh(geometry, material);\r\n        const z = layer.distanceToVector3(altitude, altitude).x;\r\n        const v = layer.coordinateToVector3(center, z);\r\n        this.getObject3d().position.copy(v);\r\n        this._params = {\r\n            index: 0,\r\n            chunkLines,\r\n            geometries: [],\r\n            layer,\r\n            trail: Math.max(1, trail),\r\n            lineWidth,\r\n            depth,\r\n            speed: Math.min(1, speed),\r\n            idx: 0,\r\n            loaded: false,\r\n            positionMap,\r\n            centerPt\r\n        };\r\n        this._init(this._params);\r\n        this.type = 'ExtrudeLineTrail';\r\n    }\r\n    /**\r\n     * Follow-up support for adding webworker\r\n     * @param {*} params\r\n     */\r\n    _init(params) {\r\n        const { layer, trail, lineWidth, depth, chunkLines, positionMap, centerPt } = params;\r\n        const len = chunkLines.length, geometries = [];\r\n        for (let i = 0; i < len; i++) {\r\n            const lines = chunkLines.slice(i, i + trail);\r\n            const ps = getChunkLinesPosition(lines, layer, positionMap, centerPt).positionsV;\r\n            geometries.push(getExtrudeLineParams(ps, lineWidth, depth, layer));\r\n        }\r\n        this._params.geometries = geometries;\r\n        this._params.loaded = true;\r\n    }\r\n    _animation() {\r\n        const { index, geometries, speed, idx, chunkLines, trail, lineWidth, depth, loaded, layer, positionMap, centerPt } = this._params;\r\n        if (!loaded)\r\n            return;\r\n        const i = Math.round(index);\r\n        if (i > idx) {\r\n            this._params.idx++;\r\n            let p = geometries[i];\r\n            //if not init, this is will running\r\n            if (!p) {\r\n                const lines = chunkLines.slice(i, i + trail);\r\n                const ps = getChunkLinesPosition(lines, layer, positionMap, centerPt).positionsV;\r\n                p = getExtrudeLineParams(ps, lineWidth, depth, layer);\r\n                geometries[i] = p;\r\n            }\r\n            const object3d = this.getObject3d();\r\n            setExtrudeLineGeometryAttribute(object3d.geometry, p.position, p.normal, p.indices);\r\n            object3d.geometry.attributes.position.needsUpdate = true;\r\n            object3d.geometry.attributes.normal.needsUpdate = true;\r\n            object3d.geometry.index.needsUpdate = true;\r\n        }\r\n        if (index >= chunkLines.length - 1) {\r\n            this._params.index = -1;\r\n            this._params.idx = -1;\r\n        }\r\n        this._params.index += speed;\r\n    }\r\n}\r\nexport default ExtrudeLineTrail;\r\n//# sourceMappingURL=ExtrudeLineTrail.js.map","import * as THREE from 'three';\r\nimport { getGeometriesColorArray } from './util';\r\nimport { addAttribute, getVertexColors } from './util/ThreeAdaptUtil';\r\nconst EVENTS = ['click', 'mousemove', 'mousedown', 'mouseup', 'dblclick', 'contextmenu'].join(' ').toString();\r\nconst defaultMaterial = new THREE.MeshBasicMaterial();\r\ndefaultMaterial.vertexColors = getVertexColors();\r\n/**\r\n * This is for the merger, MergedExtrudeMesh,Points ...\r\n * @param {*} Base\r\n */\r\nconst MergedMixin = (Base) => {\r\n    return class extends Base {\r\n        // this._faceMap=[];\r\n        // this._baseObjects = [];\r\n        // this._datas = [];\r\n        // this.faceIndex = null;\r\n        // this.index=null;\r\n        // this._geometriesAttributes = [];\r\n        // this._geometryCache = geometry.clone();\r\n        // this.isHide = false;\r\n        /**\r\n         *\r\n         * @param {*} baseObjects\r\n         */\r\n        _initBaseObjectsEvent(baseObjects) {\r\n            if (baseObjects && Array.isArray(baseObjects) && baseObjects.length) {\r\n                for (let i = 0, len = baseObjects.length; i < len; i++) {\r\n                    const baseObject = baseObjects[i];\r\n                    this._proxyEvent(baseObject);\r\n                }\r\n            }\r\n            return this;\r\n        }\r\n        /**\r\n         *Events representing the merge\r\n         * @param {*} baseObject\r\n         */\r\n        _proxyEvent(baseObject) {\r\n            baseObject.on('add', (e) => {\r\n                this._showGeometry(e.target, true);\r\n            });\r\n            baseObject.on('remove', (e) => {\r\n                this._showGeometry(e.target, false);\r\n            });\r\n            baseObject.on('mouseout', (e) => {\r\n                this._mouseover = false;\r\n                this.fire('mouseout', Object.assign({}, e, { target: this, selectMesh: (this.getSelectMesh ? this.getSelectMesh() : null) }));\r\n                // this._showGeometry(e.target, false);\r\n            });\r\n            baseObject.on(EVENTS, (e) => {\r\n                this.fire(e.type, Object.assign({}, e, { target: this, selectMesh: (this.getSelectMesh ? this.getSelectMesh() : null) }));\r\n            });\r\n        }\r\n        /**\r\n         * Get the index of the monomer to be hidden\r\n         * @param {*} attribute\r\n         */\r\n        _getHideGeometryIndex(attribute) {\r\n            const indexs = [];\r\n            let count = 0;\r\n            for (let i = 0, len = this._geometriesAttributes.length; i < len; i++) {\r\n                if (this._geometriesAttributes[i].hide === true) {\r\n                    indexs.push(i);\r\n                    count += this._geometriesAttributes[i][attribute].count;\r\n                }\r\n            }\r\n            return {\r\n                indexs,\r\n                count\r\n            };\r\n        }\r\n        /**\r\n         * update geometry attributes\r\n         * @param {*} bufferAttribute\r\n         * @param {*} attribute\r\n         */\r\n        _updateAttribute(bufferAttribute, attribute) {\r\n            const { indexs } = this._getHideGeometryIndex(attribute);\r\n            const array = this._geometryCache.attributes[attribute].array;\r\n            const len = array.length;\r\n            for (let i = 0; i < len; i++) {\r\n                bufferAttribute.array[i] = array[i];\r\n            }\r\n            let value = NaN;\r\n            if (this.getObject3d() instanceof THREE.LineSegments) {\r\n                value = 0;\r\n            }\r\n            for (let j = 0; j < indexs.length; j++) {\r\n                const index = indexs[j];\r\n                const { start, end } = this._geometriesAttributes[index][attribute];\r\n                for (let i = start; i < end; i++) {\r\n                    bufferAttribute.array[i] = value;\r\n                }\r\n            }\r\n            return this;\r\n        }\r\n        /**\r\n         * show or hide monomer\r\n         * @param {*} baseObject\r\n         * @param {*} isHide\r\n         */\r\n        _showGeometry(baseObject, isHide) {\r\n            let index;\r\n            if (baseObject) {\r\n                index = baseObject.getOptions().index;\r\n            }\r\n            if (index != null) {\r\n                const geometryAttributes = this._geometriesAttributes[index];\r\n                const { hide } = geometryAttributes;\r\n                if (hide === isHide) {\r\n                    return this;\r\n                }\r\n                geometryAttributes.hide = isHide;\r\n                const buffGeom = this.getObject3d().geometry;\r\n                this._updateAttribute(buffGeom.attributes.position, 'position');\r\n                // this._updateAttribute(buffGeom.attributes.normal, 'normal', 3);\r\n                // this._updateAttribute(buffGeom.attributes.color, 'color', 3);\r\n                // this._updateAttribute(buffGeom.attributes.uv, 'uv', 2);\r\n                buffGeom.attributes.position.needsUpdate = true;\r\n                // buffGeom.attributes.color.needsUpdate = true;\r\n                // buffGeom.attributes.normal.needsUpdate = true;\r\n                // buffGeom.attributes.uv.needsUpdate = true;\r\n                this.isHide = isHide;\r\n            }\r\n            return this;\r\n        }\r\n        /**\r\n         * Get selected monomer\r\n         */\r\n        // eslint-disable-next-line consistent-return\r\n        getSelectMesh() {\r\n            const index = this._getIndex();\r\n            if (index != null) {\r\n                return {\r\n                    data: this._datas[index],\r\n                    baseObject: this._baseObjects[index]\r\n                };\r\n            }\r\n        }\r\n        _getIndex(faceIndex) {\r\n            if (faceIndex == null) {\r\n                faceIndex = this.faceIndex || this.index;\r\n            }\r\n            return faceIndex;\r\n        }\r\n        _init() {\r\n            const pick = this.getLayer().getPick();\r\n            this.on('add', () => {\r\n                pick.add(this.pickObject3d);\r\n            });\r\n            this.on('remove', () => {\r\n                pick.remove(this.pickObject3d);\r\n            });\r\n        }\r\n        //Different objects need to implement their own methods\r\n        _setPickObject3d() {\r\n            if (!this._colorMap) {\r\n                return;\r\n            }\r\n            // multiplexing geometry\r\n            const geometry = this._geometryCache || this.getObject3d().geometry.clone();\r\n            const pick = this.getLayer().getPick();\r\n            const { _geometriesAttributes } = this;\r\n            const len = _geometriesAttributes.length;\r\n            const colors = getGeometriesColorArray(_geometriesAttributes);\r\n            let cIndex = 0;\r\n            for (let i = 0; i < len; i++) {\r\n                const color = pick.getColor();\r\n                const colorIndex = color.getHex();\r\n                this._colorMap[colorIndex] = i;\r\n                const { count } = _geometriesAttributes[i].position;\r\n                this._datas[i].colorIndex = colorIndex;\r\n                for (let j = 0; j < count; j++) {\r\n                    colors[cIndex] = color.r;\r\n                    colors[cIndex + 1] = color.g;\r\n                    colors[cIndex + 2] = color.b;\r\n                    cIndex += 3;\r\n                }\r\n            }\r\n            addAttribute(geometry, 'color', new THREE.BufferAttribute(colors, 3, true));\r\n            // const material = new THREE.MeshBasicMaterial();\r\n            // material.vertexColors = THREE.VertexColors;\r\n            const color = pick.getColor();\r\n            const colorIndex = color.getHex();\r\n            const mesh = new THREE.Mesh(geometry, defaultMaterial);\r\n            mesh.position.copy(this.getObject3d().position);\r\n            mesh['_colorIndex'] = colorIndex;\r\n            this.setPickObject3d(mesh);\r\n        }\r\n    };\r\n};\r\nexport default MergedMixin;\r\n//# sourceMappingURL=MergedMixin.js.map","import * as maptalks from 'maptalks';\r\nimport BaseObject from './BaseObject';\r\nimport { initVertexColors, getExtrudeGeometryParams } from './util/ExtrudeUtil';\r\nimport ExtrudePolygon from './ExtrudePolygon';\r\nimport MergedMixin from './MergedMixin';\r\nimport { getGeoJSONCenter, isGeoJSONPolygon } from './util/GeoJSONUtil';\r\nimport { generateBufferGeometry, generatePickBufferGeometry, getDefaultBufferGeometry, mergeBufferGeometries } from './util/MergeGeometryUtil';\r\nimport { getVertexColors } from './util/ThreeAdaptUtil';\r\nimport { setBottomHeight } from './util';\r\nimport { ExtrudePolygonsTaskIns } from './BaseObjectTaskManager';\r\nconst OPTIONS = {\r\n    altitude: 0,\r\n    height: 1,\r\n    bottomHeight: 0,\r\n    topColor: null,\r\n    bottomColor: '#2d2f61',\r\n};\r\nconst TEMP_COORD = new maptalks.Coordinate(0, 0);\r\nclass ExtrudePolygons extends MergedMixin(BaseObject) {\r\n    constructor(polygons, options, material, layer) {\r\n        if (!Array.isArray(polygons)) {\r\n            polygons = [polygons];\r\n        }\r\n        const len = polygons.length;\r\n        if (len === 0) {\r\n            console.error('polygons is empty');\r\n        }\r\n        // const centers = [];\r\n        let minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;\r\n        for (let i = 0; i < len; i++) {\r\n            const polygon = polygons[i];\r\n            const center = (polygon.getCenter ? polygon.getCenter() : getGeoJSONCenter(polygon, TEMP_COORD));\r\n            let x, y;\r\n            if (Array.isArray(center)) {\r\n                x = center[0];\r\n                y = center[1];\r\n            }\r\n            else if (center instanceof maptalks.Coordinate) {\r\n                x = center.x;\r\n                y = center.y;\r\n            }\r\n            minX = Math.min(minX, x);\r\n            minY = Math.min(minY, y);\r\n            maxX = Math.max(maxX, x);\r\n            maxY = Math.max(maxY, y);\r\n        }\r\n        // Get the center point of the point set\r\n        const center = new maptalks.Coordinate((minX + maxX) / 2, (minY + maxY) / 2);\r\n        options = maptalks.Util.extend({}, OPTIONS, options, { layer, polygons, coordinate: center });\r\n        const { topColor, bottomColor, altitude, asynchronous } = options;\r\n        let bufferGeometry;\r\n        const extrudePolygons = [], faceMap = [], geometriesAttributes = [];\r\n        super();\r\n        if (asynchronous) {\r\n            bufferGeometry = getDefaultBufferGeometry();\r\n            ExtrudePolygonsTaskIns.push({\r\n                id: maptalks.Util.GUID(),\r\n                layer,\r\n                key: options.key,\r\n                center,\r\n                data: polygons,\r\n                baseObject: this\r\n            });\r\n        }\r\n        else {\r\n            const centerPt = layer.coordinateToVector3(center);\r\n            const geometries = [];\r\n            let faceIndex = 0, psIndex = 0, normalIndex = 0, uvIndex = 0;\r\n            const altCache = {};\r\n            for (let i = 0; i < len; i++) {\r\n                const polygon = polygons[i];\r\n                const properties = (isGeoJSONPolygon(polygon) ? polygon['properties'] : polygon.getProperties() || {});\r\n                const height = properties.height || 1;\r\n                const bottomHeight = properties.bottomHeight || 0;\r\n                const buffGeom = getExtrudeGeometryParams(polygon, height, layer, center, centerPt, altCache);\r\n                geometries.push(buffGeom);\r\n                const minZ = setBottomHeight(buffGeom, bottomHeight, layer, altCache);\r\n                // const extrudePolygon = new ExtrudePolygon(polygon, Object.assign({}, options, { height, index: i }), material, layer);\r\n                // extrudePolygons.push(extrudePolygon);\r\n                const { position, normal, uv, indices } = buffGeom;\r\n                const faceLen = indices.length / 3;\r\n                // faceMap[i] = [faceIndex + 1, faceIndex + faceLen];\r\n                faceIndex += faceLen;\r\n                const psCount = position.length / 3, \r\n                //  colorCount = buffGeom.attributes.color.count,\r\n                normalCount = normal.length / 3, uvCount = uv.length / 2;\r\n                geometriesAttributes[i] = {\r\n                    position: {\r\n                        middleZ: minZ + altCache[height] / 2,\r\n                        count: psCount,\r\n                        start: psIndex,\r\n                        end: psIndex + psCount * 3,\r\n                    },\r\n                    // normal: {\r\n                    //     count: normalCount,\r\n                    //     start: normalIndex,\r\n                    //     end: normalIndex + normalCount * 3,\r\n                    // },\r\n                    // // color: {\r\n                    // //     count: colorCount,\r\n                    // //     start: colorIndex,\r\n                    // //     end: colorIndex + colorCount * 3,\r\n                    // // },\r\n                    // uv: {\r\n                    //     count: uvCount,\r\n                    //     start: uvIndex,\r\n                    //     end: uvIndex + uvCount * 2,\r\n                    // },\r\n                    hide: false\r\n                };\r\n                psIndex += psCount * 3;\r\n                normalIndex += normalCount * 3;\r\n                // colorIndex += colorCount * 3;\r\n                uvIndex += uvCount * 2;\r\n            }\r\n            bufferGeometry = mergeBufferGeometries(geometries);\r\n            if (topColor) {\r\n                initVertexColors(bufferGeometry, bottomColor, topColor, geometriesAttributes);\r\n                material.vertexColors = getVertexColors();\r\n            }\r\n        }\r\n        this._initOptions(options);\r\n        this._createMesh(bufferGeometry, material);\r\n        const z = layer.distanceToVector3(altitude, altitude).x;\r\n        const v = layer.coordinateToVector3(center, z);\r\n        this.getObject3d().position.copy(v);\r\n        //Face corresponding to monomer\r\n        // this._faceMap = faceMap;\r\n        this._baseObjects = extrudePolygons;\r\n        this._datas = polygons;\r\n        this._geometriesAttributes = geometriesAttributes;\r\n        this.faceIndex = null;\r\n        this._geometryCache = generatePickBufferGeometry(bufferGeometry);\r\n        this.isHide = false;\r\n        this._colorMap = {};\r\n        this._initBaseObjectsEvent(extrudePolygons);\r\n        if (!asynchronous) {\r\n            this._setPickObject3d();\r\n            this._init();\r\n        }\r\n        this.type = 'ExtrudePolygons';\r\n    }\r\n    // eslint-disable-next-line consistent-return\r\n    getSelectMesh() {\r\n        const index = this._getIndex();\r\n        if (index != null) {\r\n            if (!this._baseObjects[index]) {\r\n                const polygon = this._datas[index];\r\n                const opts = Object.assign({}, this.options, isGeoJSONPolygon(polygon) ? polygon.properties : polygon.getProperties(), { index });\r\n                this._baseObjects[index] = new ExtrudePolygon(polygon, opts, this.getObject3d().material, this.getLayer());\r\n                this._proxyEvent(this._baseObjects[index]);\r\n            }\r\n            return {\r\n                data: this._datas[index],\r\n                baseObject: this._baseObjects[index]\r\n            };\r\n        }\r\n    }\r\n    // eslint-disable-next-line no-unused-vars\r\n    identify(coordinate) {\r\n        return this.picked;\r\n    }\r\n    _workerLoad(result) {\r\n        const { geometriesAttributes } = result;\r\n        // this._faceMap = faceMap;\r\n        this._geometriesAttributes = geometriesAttributes;\r\n        const bufferGeometry = generateBufferGeometry(result);\r\n        this._geometryCache = generatePickBufferGeometry(bufferGeometry);\r\n        const { topColor, bottomColor } = this.getOptions();\r\n        const object3d = this.getObject3d();\r\n        const material = object3d.material;\r\n        if (topColor) {\r\n            initVertexColors(bufferGeometry, bottomColor, topColor, geometriesAttributes);\r\n            material.vertexColors = getVertexColors();\r\n        }\r\n        object3d.geometry = bufferGeometry;\r\n        object3d.material.needsUpdate = true;\r\n        this._setPickObject3d();\r\n        this._init();\r\n        if (this.isAdd) {\r\n            const pick = this.getLayer().getPick();\r\n            pick.add(this.pickObject3d);\r\n        }\r\n        this._fire('workerload', { target: this });\r\n    }\r\n}\r\nexport default ExtrudePolygons;\r\n//# sourceMappingURL=ExtrudePolygons.js.map","import * as THREE from 'three';\r\nimport { distanceToVector3 } from './index';\r\nfunction positionsConvert(worldPoints, altitude = 0, layer) {\r\n    const vectors = [], cache = {};\r\n    for (let i = 0, len = worldPoints.length; i < len; i += 3) {\r\n        let x = worldPoints[i], y = worldPoints[i + 1], z = worldPoints[i + 2];\r\n        if (altitude > 0) {\r\n            z += distanceToVector3(altitude, layer, cache);\r\n        }\r\n        vectors.push(new THREE.Vector3(x, y, z));\r\n    }\r\n    return vectors;\r\n}\r\nexport function vectors2Pixel(worldPoints, size, camera, altitude = 0, layer) {\r\n    if (!(worldPoints[0] instanceof THREE.Vector3)) {\r\n        worldPoints = positionsConvert(worldPoints, altitude, layer);\r\n    }\r\n    const pixels = worldPoints.map(worldPoint => {\r\n        return vector2Pixel(worldPoint, size, camera);\r\n    });\r\n    return pixels;\r\n}\r\n// eslint-disable-next-line camelcase\r\nexport function vector2Pixel(world_vector, size, camera) {\r\n    // eslint-disable-next-line camelcase\r\n    const vector = world_vector.project(camera);\r\n    const halfWidth = size.width / 2;\r\n    const halfHeight = size.height / 2;\r\n    const result = {\r\n        x: Math.round(vector.x * halfWidth + halfWidth),\r\n        y: Math.round(-vector.y * halfHeight + halfHeight)\r\n    };\r\n    return result;\r\n}\r\n//# sourceMappingURL=IdentifyUtil.js.map","import * as maptalks from 'maptalks';\r\nimport * as THREE from 'three';\r\nimport BaseObject from './BaseObject';\r\nimport { vector2Pixel } from './util/IdentifyUtil';\r\nimport { addAttribute } from './util/ThreeAdaptUtil';\r\nconst OPTIONS = {\r\n    altitude: 0,\r\n    height: 0,\r\n    color: null\r\n};\r\nconst vector = new THREE.Vector3();\r\nclass Point extends BaseObject {\r\n    constructor(coordinate, options, material, layer) {\r\n        options = maptalks.Util.extend({}, OPTIONS, options, { layer, coordinate });\r\n        super();\r\n        let { height, altitude, color, size } = options;\r\n        const vs = [], colors = [];\r\n        if (color) {\r\n            color = (color instanceof THREE.Color ? color : new THREE.Color(color));\r\n            colors.push(color.r, color.g, color.b);\r\n        }\r\n        const z = layer.distanceToVector3(height, height).x;\r\n        const v = layer.coordinateToVector3(coordinate, z);\r\n        vs.push(0, 0, v.z);\r\n        const geometry = new THREE.BufferGeometry();\r\n        addAttribute(geometry, 'position', new THREE.Float32BufferAttribute(vs, 3, true));\r\n        if (colors.length) {\r\n            addAttribute(geometry, 'color', new THREE.Float32BufferAttribute(colors, 3, true));\r\n        }\r\n        if (size !== undefined) {\r\n            addAttribute(geometry, 'size', new THREE.Float32BufferAttribute([size], 1, true));\r\n        }\r\n        options.positions = v;\r\n        this._initOptions(options);\r\n        this._createPoints(geometry, material);\r\n        const z1 = layer.distanceToVector3(altitude, altitude).x;\r\n        const v1 = new THREE.Vector3(v.x, v.y, z1);\r\n        this.getObject3d().position.copy(v1);\r\n        this.type = 'Point';\r\n    }\r\n    /**\r\n     *\r\n     * @param {maptalks.Coordinate} coordinate\r\n     */\r\n    identify(coordinate) {\r\n        const layer = this.getLayer(), size = this.getMap().getSize(), camera = this.getLayer().getCamera(), positions = this.getOptions().positions, altitude = this.getOptions().altitude;\r\n        //Size of points\r\n        let pointSize = this.getObject3d().material.size;\r\n        if (pointSize === undefined) {\r\n            pointSize = this.options.size || 1;\r\n        }\r\n        const pixel = this.getMap().coordToContainerPoint(coordinate);\r\n        const z = layer.distanceToVector3(altitude, altitude).x;\r\n        vector.x = positions.x;\r\n        vector.y = positions.y;\r\n        vector.z = positions.z + z;\r\n        //3D vector to screen coordinates\r\n        const p = vector2Pixel(vector, size, camera);\r\n        //Distance between two points\r\n        const distance = Math.sqrt(Math.pow(pixel.x - p.x, 2) + Math.pow(pixel.y - p.y, 2));\r\n        return (distance <= pointSize / 2);\r\n    }\r\n}\r\nexport default Point;\r\n//# sourceMappingURL=Point.js.map","import * as maptalks from 'maptalks';\r\nconst ROW = 30, COL = 30;\r\nfunction contains(b, p) {\r\n    const { minx, miny, maxx, maxy } = b;\r\n    const [x, y] = p;\r\n    if (minx <= x && x <= maxx && miny <= y && y <= maxy) {\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\nclass BBox {\r\n    constructor(minlng, minlat, maxlng, maxlat) {\r\n        this.minlng = minlng;\r\n        this.minlat = minlat;\r\n        this.maxlng = maxlng;\r\n        this.maxlat = maxlat;\r\n        this.minx = Infinity;\r\n        this.miny = Infinity;\r\n        this.maxx = -Infinity;\r\n        this.maxy = -Infinity;\r\n        this.coordinates = [];\r\n        this.positions = [];\r\n        this.indexs = [];\r\n        this.key = null;\r\n    }\r\n    /**\r\n     *\r\n     * @param {*} map\r\n     */\r\n    updateBBoxPixel(map) {\r\n        let minx = Infinity, miny = Infinity, maxx = -Infinity, maxy = -Infinity;\r\n        const { minlng, minlat, maxlng, maxlat } = this;\r\n        [\r\n            [minlng, minlat],\r\n            [minlng, maxlat],\r\n            [maxlng, minlat],\r\n            [maxlng, maxlat]\r\n        ].map(lnglat => {\r\n            return new maptalks.Coordinate(lnglat);\r\n        }).map(coordinate => {\r\n            return map.coordToContainerPoint(coordinate);\r\n        }).forEach(pixel => {\r\n            minx = Math.min(minx, pixel.x);\r\n            miny = Math.min(miny, pixel.y);\r\n            maxx = Math.max(maxx, pixel.x);\r\n            maxy = Math.max(maxy, pixel.y);\r\n        });\r\n        this.minx = minx;\r\n        this.miny = miny;\r\n        this.maxx = maxx;\r\n        this.maxy = maxy;\r\n        return this;\r\n    }\r\n    /**\r\n     *Determine whether a point is included\r\n     * @param {*} c\r\n     */\r\n    containsCoordinate(c) {\r\n        let lng, lat;\r\n        if (Array.isArray(c)) {\r\n            lng = c[0];\r\n            lat = c[1];\r\n        }\r\n        else if (c instanceof maptalks.Coordinate) {\r\n            lng = c.x;\r\n            lat = c.y;\r\n        }\r\n        const { minlng, minlat, maxlng, maxlat } = this;\r\n        return (minlng <= lng && lng <= maxlng && minlat <= lat && lat <= maxlat);\r\n    }\r\n    /**\r\n     *Judge rectangle intersection\r\n     * @param {*} pixel\r\n     * @param {*} size\r\n     */\r\n    isRecCross(pixel, size) {\r\n        const { x, y } = pixel;\r\n        const rec = {\r\n            minx: x - size / 2,\r\n            miny: y - size / 2,\r\n            maxx: x + size / 2,\r\n            maxy: y + size / 2\r\n        };\r\n        const { minx, miny, maxx, maxy } = rec;\r\n        if (contains(this, [minx, miny]) ||\r\n            contains(this, [minx, maxy]) ||\r\n            contains(this, [maxx, miny]) ||\r\n            contains(this, [maxx, maxy]) ||\r\n            contains(rec, [this.minx, this.miny]) ||\r\n            contains(rec, [this.minx, this.maxy]) ||\r\n            contains(rec, [this.maxx, this.miny]) ||\r\n            contains(rec, [this.maxx, this.maxy])) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    /**\r\n     *generate grids\r\n     * @param {*} minlng\r\n     * @param {*} minlat\r\n     * @param {*} maxlng\r\n     * @param {*} maxlat\r\n     */\r\n    static initGrids(minlng, minlat, maxlng, maxlat) {\r\n        const grids = [], offsetX = maxlng - minlng, offsetY = maxlat - minlat;\r\n        const averageX = offsetX / COL, averageY = offsetY / ROW;\r\n        let x = minlng, y = minlat;\r\n        for (let i = 0; i < COL; i++) {\r\n            x = minlng + i * averageX;\r\n            for (let j = 0; j < ROW; j++) {\r\n                y = minlat + j * averageY;\r\n                const bounds = new BBox(x, y, x + averageX, y + averageY);\r\n                bounds.key = j + '-' + i;\r\n                grids.push(bounds);\r\n            }\r\n        }\r\n        return { grids, averageX, averageY, ROWS: ROW, COLS: COL };\r\n    }\r\n}\r\nexport default BBox;\r\n//# sourceMappingURL=BBox.js.map","import * as maptalks from 'maptalks';\r\nimport * as THREE from 'three';\r\nimport BaseObject from './BaseObject';\r\nimport Point from './Point';\r\nimport { vector2Pixel } from './util/IdentifyUtil';\r\nimport MergedMixin from './MergedMixin';\r\nimport BBox from './util/BBox';\r\nimport { addAttribute } from './util/ThreeAdaptUtil';\r\nimport { distanceToVector3 } from './util';\r\nconst OPTIONS = {\r\n    altitude: 0\r\n};\r\nconst vector = new THREE.Vector3();\r\nfunction roundFun(value, n) {\r\n    const tempValue = Math.pow(10, n);\r\n    return Math.round(value * tempValue) / tempValue;\r\n}\r\n/**\r\n *points\r\n */\r\nclass Points extends MergedMixin(BaseObject) {\r\n    constructor(points, options, material, layer) {\r\n        if (!Array.isArray(points)) {\r\n            points = [points];\r\n        }\r\n        options = maptalks.Util.extend({}, OPTIONS, options, { layer, points });\r\n        let minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;\r\n        for (let i = 0, len = points.length; i < len; i++) {\r\n            const { coordinate } = points[i];\r\n            let x, y;\r\n            if (Array.isArray(coordinate)) {\r\n                x = coordinate[0];\r\n                y = coordinate[1];\r\n            }\r\n            else if (coordinate instanceof maptalks.Coordinate) {\r\n                x = coordinate.x;\r\n                y = coordinate.y;\r\n            }\r\n            points[i].coords = [x, y];\r\n            minX = Math.min(minX, x);\r\n            minY = Math.min(minY, y);\r\n            maxX = Math.max(maxX, x);\r\n            maxY = Math.max(maxY, y);\r\n        }\r\n        const centerPt = layer.coordinateToVector3([(minX + maxX) / 2, (minY + maxY) / 2]);\r\n        const { grids, averageX, averageY, ROWS, COLS } = BBox.initGrids(minX, minY, maxX, maxY);\r\n        const gridslen = grids.length;\r\n        const vs = new Float32Array(points.length * 3), vectors = [], colors = new Float32Array(points.length * 3), sizes = new Float32Array(points.length), pointMeshes = [], geometriesAttributes = [];\r\n        const cache = {};\r\n        let maxSize = 0;\r\n        let hasColor = false, hasSize = false;\r\n        const TEMP_VECTOR = new THREE.Vector3(0, 0, 0);\r\n        for (let i = 0, len = points.length; i < len; i++) {\r\n            let { coordinate, height, color, size, coords } = points[i];\r\n            const idx = i * 3;\r\n            if (color) {\r\n                hasColor = true;\r\n                color = (color instanceof THREE.Color ? color : new THREE.Color(color));\r\n                colors[idx] = color.r;\r\n                colors[idx + 1] = color.g;\r\n                colors[idx + 2] = color.b;\r\n            }\r\n            if (size) {\r\n                hasSize = true;\r\n                sizes[i] = size;\r\n                maxSize = Math.max(maxSize, size);\r\n            }\r\n            const z = distanceToVector3(height, layer, cache);\r\n            const v = layer.coordinateToVector3(coordinate, z);\r\n            TEMP_VECTOR.x = v.x;\r\n            TEMP_VECTOR.y = v.y;\r\n            TEMP_VECTOR.z = v.z;\r\n            TEMP_VECTOR.sub(centerPt);\r\n            // const v1 = v.clone().sub(centerPt);\r\n            vs[idx] = TEMP_VECTOR.x;\r\n            vs[idx + 1] = TEMP_VECTOR.y;\r\n            vs[idx + 2] = TEMP_VECTOR.z;\r\n            vectors.push(v);\r\n            geometriesAttributes[i] = {\r\n                position: {\r\n                    count: 1,\r\n                    start: i * 3,\r\n                    end: i * 3 + 3\r\n                },\r\n                hide: false\r\n            };\r\n            let row = roundFun(((coords[1] - minY) / averageY), 4);\r\n            let col = roundFun(((coords[0] - minX) / averageX), 4);\r\n            row -= 1;\r\n            col -= 1;\r\n            row = Math.max(0, row);\r\n            col = Math.max(0, col);\r\n            row = Math.ceil(row);\r\n            col = Math.ceil(col);\r\n            const gridIndex = col * ROWS + row;\r\n            if (grids[gridIndex]) {\r\n                grids[gridIndex].positions.push(v);\r\n                grids[gridIndex].indexs.push(i);\r\n            }\r\n            // for (let j = 0; j < gridslen; j++) {\r\n            //     if (grids[j].containsCoordinate(coordinate)) {\r\n            //         // grids[j].coordinates.push(coordinate);\r\n            //         grids[j].positions.push(v);\r\n            //         grids[j].indexs.push(i);\r\n            //         console.log(j, gridIndex);\r\n            //         break;\r\n            //     }\r\n            // }\r\n        }\r\n        const geometry = new THREE.BufferGeometry();\r\n        addAttribute(geometry, 'position', new THREE.BufferAttribute(vs, 3, true));\r\n        if (hasColor) {\r\n            addAttribute(geometry, 'color', new THREE.BufferAttribute(colors, 3, true));\r\n        }\r\n        if (hasSize) {\r\n            addAttribute(geometry, 'size', new THREE.BufferAttribute(sizes, 1, true));\r\n        }\r\n        //for identify\r\n        options.positions = vectors;\r\n        super();\r\n        this._initOptions(options);\r\n        this._createPoints(geometry, material);\r\n        const altitude = options.altitude;\r\n        const z = layer.distanceToVector3(altitude, altitude).x;\r\n        const v = centerPt.clone();\r\n        v.z = z;\r\n        this.getObject3d().position.copy(v);\r\n        this._baseObjects = pointMeshes;\r\n        this._datas = points;\r\n        this.faceIndex = null;\r\n        this._geometriesAttributes = geometriesAttributes;\r\n        this._geometryCache = geometry.clone();\r\n        this.isHide = false;\r\n        this._initBaseObjectsEvent(pointMeshes);\r\n        this._grids = grids;\r\n        this._bindMapEvents();\r\n        this.type = 'Points';\r\n        this.maxSize = maxSize;\r\n    }\r\n    _bindMapEvents() {\r\n        const map = this.getMap();\r\n        const events = 'zoomstart zooming zoomend movestart moving moveend pitch rotate';\r\n        this.on('add', () => {\r\n            this._updateGrids();\r\n            map.on(events, this._updateGrids, this);\r\n        });\r\n        this.on('remove', () => {\r\n            map.off(events, this._updateGrids, this);\r\n        });\r\n    }\r\n    _updateGrids() {\r\n        const map = this.getMap();\r\n        this._grids.forEach(b => {\r\n            if (b.indexs.length) {\r\n                b.updateBBoxPixel(map);\r\n            }\r\n        });\r\n    }\r\n    // eslint-disable-next-line consistent-return\r\n    getSelectMesh() {\r\n        const index = this.faceIndex;\r\n        if (index != null) {\r\n            if (!this._baseObjects[index]) {\r\n                const data = this._datas[index];\r\n                const { coordinate, height, color, size } = data;\r\n                this._baseObjects[index] = new Point(coordinate, { height, index, color, size }, this.getObject3d().material, this.getLayer());\r\n                this._proxyEvent(this._baseObjects[index]);\r\n            }\r\n            return {\r\n                data: this._datas[index],\r\n                baseObject: this._baseObjects[index]\r\n            };\r\n        }\r\n    }\r\n    /**\r\n   *\r\n   * @param {maptalks.Coordinate} coordinate\r\n   */\r\n    identify(coordinate) {\r\n        const layer = this.getLayer(), size = this.getMap().getSize(), camera = this.getLayer().getCamera(), altitude = this.getOptions().altitude, map = this.getMap();\r\n        const z = layer.distanceToVector3(altitude, altitude).x;\r\n        let pointSize = this.getObject3d().material.size;\r\n        const isDynamicSize = pointSize === undefined;\r\n        const pixel = map.coordToContainerPoint(coordinate);\r\n        const bs = [];\r\n        this._grids.forEach(b => {\r\n            if (b.indexs.length) {\r\n                if (b.isRecCross(pixel, isDynamicSize ? this.maxSize : pointSize)) {\r\n                    bs.push(b);\r\n                }\r\n            }\r\n        });\r\n        if (bs.length < 1) {\r\n            return false;\r\n        }\r\n        for (let i = 0, len = bs.length; i < len; i++) {\r\n            for (let len1 = bs[i].positions.length, j = len1 - 1; j >= 0; j--) {\r\n                if (isDynamicSize) {\r\n                    pointSize = this._datas[bs[i].indexs[j]].size || 1;\r\n                }\r\n                const v = bs[i].positions[j];\r\n                vector.x = v.x;\r\n                vector.y = v.y;\r\n                vector.z = v.z + z;\r\n                const p = vector2Pixel(vector, size, camera);\r\n                const distance = Math.sqrt(Math.pow(pixel.x - p.x, 2) + Math.pow(pixel.y - p.y, 2));\r\n                if (distance <= pointSize / 2) {\r\n                    this.faceIndex = bs[i].indexs[j];\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n}\r\nexport default Points;\r\n//# sourceMappingURL=Points.js.map","import * as maptalks from 'maptalks';\r\nimport BaseObject from './BaseObject';\r\nimport { getGeometry, initVertexColors, mergeBarGeometry } from './util/BarUtil';\r\nimport Bar from './Bar';\r\nimport MergedMixin from './MergedMixin';\r\nimport { distanceToVector3, getCenterOfPoints } from './util/index';\r\nimport { getVertexColors } from './util/ThreeAdaptUtil';\r\nimport { generatePickBufferGeometry } from './util/MergeGeometryUtil';\r\nconst OPTIONS = {\r\n    coordinate: '',\r\n    radius: 10,\r\n    height: 100,\r\n    radialSegments: 6,\r\n    altitude: 0,\r\n    topColor: '',\r\n    bottomColor: '#2d2f61',\r\n};\r\n/**\r\n * merged bars\r\n */\r\nclass Bars extends MergedMixin(BaseObject) {\r\n    constructor(points, options, material, layer) {\r\n        if (!Array.isArray(points)) {\r\n            points = [points];\r\n        }\r\n        const len = points.length;\r\n        const center = getCenterOfPoints(points);\r\n        const centerPt = layer.coordinateToVector3(center);\r\n        const geometries = [], bars = [], geometriesAttributes = [], faceMap = [];\r\n        let faceIndex = 0, psIndex = 0, normalIndex = 0, uvIndex = 0;\r\n        const cache = {};\r\n        for (let i = 0; i < len; i++) {\r\n            const opts = maptalks.Util.extend({ index: i }, OPTIONS, points[i]);\r\n            const { radius, radialSegments, altitude, topColor, bottomColor, height, coordinate } = opts;\r\n            const r = distanceToVector3(radius, layer, cache);\r\n            const h = distanceToVector3(height, layer, cache);\r\n            const alt = distanceToVector3(altitude, layer, cache);\r\n            const buffGeom = getGeometry({ radius: r, height: h, radialSegments });\r\n            if (topColor) {\r\n                initVertexColors(buffGeom, bottomColor, topColor, 'z', h / 2);\r\n                material.vertexColors = getVertexColors();\r\n            }\r\n            // buffGeom.rotateX(Math.PI / 2);\r\n            const v = layer.coordinateToVector3(coordinate).sub(centerPt);\r\n            const parray = buffGeom.attributes.position.array;\r\n            for (let j = 0, len1 = parray.length; j < len1; j += 3) {\r\n                parray[j + 2] += alt;\r\n                parray[j] += v.x;\r\n                parray[j + 1] += v.y;\r\n                parray[j + 2] += v.z;\r\n            }\r\n            geometries.push(buffGeom);\r\n            const bar = new Bar(coordinate, opts, material, layer);\r\n            bars.push(bar);\r\n            const faceLen = buffGeom.index.count / 3;\r\n            // faceMap[i] = [faceIndex + 1, faceIndex + faceLen];\r\n            faceIndex += faceLen;\r\n            const psCount = buffGeom.attributes.position.count, \r\n            //  colorCount = buffGeom.attributes.color.count,\r\n            normalCount = buffGeom.attributes.normal.count, uvCount = buffGeom.attributes.uv.count;\r\n            geometriesAttributes[i] = {\r\n                position: {\r\n                    count: psCount,\r\n                    start: psIndex,\r\n                    end: psIndex + psCount * 3,\r\n                },\r\n                // normal: {\r\n                //     count: normalCount,\r\n                //     start: normalIndex,\r\n                //     end: normalIndex + normalCount * 3,\r\n                // },\r\n                // // color: {\r\n                // //     count: colorCount,\r\n                // //     start: colorIndex,\r\n                // //     end: colorIndex + colorCount * 3,\r\n                // // },\r\n                // uv: {\r\n                //     count: uvCount,\r\n                //     start: uvIndex,\r\n                //     end: uvIndex + uvCount * 2,\r\n                // },\r\n                hide: false\r\n            };\r\n            psIndex += psCount * 3;\r\n            normalIndex += normalCount * 3;\r\n            // colorIndex += colorCount * 3;\r\n            uvIndex += uvCount * 2;\r\n        }\r\n        super();\r\n        options = maptalks.Util.extend({}, { altitude: 0, layer, points }, options);\r\n        this._initOptions(options);\r\n        const geometry = mergeBarGeometry(geometries);\r\n        this._createMesh(geometry, material);\r\n        const altitude = options.altitude;\r\n        const z = layer.distanceToVector3(altitude, altitude).x;\r\n        const v = centerPt.clone();\r\n        v.z = z;\r\n        this.getObject3d().position.copy(v);\r\n        // this._faceMap = faceMap;\r\n        this._baseObjects = bars;\r\n        this._datas = points;\r\n        this._geometriesAttributes = geometriesAttributes;\r\n        this.faceIndex = null;\r\n        this._geometryCache = generatePickBufferGeometry(geometry);\r\n        this.isHide = false;\r\n        this._colorMap = {};\r\n        this._initBaseObjectsEvent(bars);\r\n        this._setPickObject3d();\r\n        this._init();\r\n        this.type = 'Bars';\r\n    }\r\n    // eslint-disable-next-line no-unused-vars\r\n    identify() {\r\n        return this.picked;\r\n    }\r\n}\r\nexport default Bars;\r\n//# sourceMappingURL=Bars.js.map","import * as maptalks from 'maptalks';\r\nimport MergedMixin from './MergedMixin';\r\nimport BaseObject from './BaseObject';\r\nimport { initVertexColors } from './util/ExtrudeUtil';\r\nimport { getExtrudeLineParams, LineStringSplit } from './util/LineUtil';\r\nimport ExtrudeLine from './ExtrudeLine';\r\nimport { isGeoJSON, isGeoJSONLine } from './util/GeoJSONUtil';\r\nimport { generateBufferGeometry, generatePickBufferGeometry, getDefaultBufferGeometry, mergeBufferGeometries, mergeBufferGeometriesAttribute } from './util/MergeGeometryUtil';\r\nimport { distanceToVector3, getCenterOfPoints, setBottomHeight } from './util/index';\r\nimport { getVertexColors } from './util/ThreeAdaptUtil';\r\nimport { ExtrudeLinesTaskIns } from './BaseObjectTaskManager';\r\nconst OPTIONS = {\r\n    width: 3,\r\n    height: 1,\r\n    altitude: 0,\r\n    topColor: null,\r\n    bottomColor: '#2d2f61'\r\n};\r\nclass ExtrudeLines extends MergedMixin(BaseObject) {\r\n    constructor(lineStrings, options, material, layer) {\r\n        if (!Array.isArray(lineStrings)) {\r\n            lineStrings = [lineStrings];\r\n        }\r\n        const centers = [], lineStringList = [];\r\n        const len = lineStrings.length;\r\n        for (let i = 0; i < len; i++) {\r\n            const lineString = lineStrings[i];\r\n            const result = LineStringSplit(lineString);\r\n            centers.push(result.center);\r\n            lineStringList.push(result.lineStrings);\r\n        }\r\n        // Get the center point of the point set\r\n        const center = getCenterOfPoints(centers);\r\n        options = maptalks.Util.extend({}, OPTIONS, options, { layer, lineStrings, coordinate: center });\r\n        const { altitude, topColor, bottomColor, asynchronous } = options;\r\n        let bufferGeometry;\r\n        const faceMap = [], extrudeLines = [], geometriesAttributes = [];\r\n        super();\r\n        if (asynchronous) {\r\n            bufferGeometry = getDefaultBufferGeometry();\r\n            ExtrudeLinesTaskIns.push({\r\n                id: maptalks.Util.GUID(),\r\n                layer,\r\n                key: options.key,\r\n                center,\r\n                data: lineStringList,\r\n                lineStrings,\r\n                baseObject: this\r\n            });\r\n        }\r\n        else {\r\n            const geometries = [];\r\n            let faceIndex = 0, faceMap = [], psIndex = 0, normalIndex = 0;\r\n            const cache = {};\r\n            for (let i = 0; i < len; i++) {\r\n                const lineString = lineStrings[i];\r\n                const opts = maptalks.Util.extend({}, OPTIONS, isGeoJSON(lineString) ? lineString['properties'] : lineString.getProperties(), { index: i });\r\n                const { height, width, bottomHeight } = opts;\r\n                const w = distanceToVector3(width, layer, cache);\r\n                const h = distanceToVector3(height, layer, cache);\r\n                const lls = lineStringList[i];\r\n                const extrudeParams = [];\r\n                let minZ = 0;\r\n                for (let m = 0, le = lls.length; m < le; m++) {\r\n                    const attribute = getExtrudeLineParams(lls[m], w, h, layer, center);\r\n                    minZ = setBottomHeight(attribute, bottomHeight, layer, cache);\r\n                    extrudeParams.push(attribute);\r\n                }\r\n                const buffGeom = mergeBufferGeometriesAttribute(extrudeParams);\r\n                geometries.push(buffGeom);\r\n                // const extrudeLine = new ExtrudeLine(lineString, opts, material, layer);\r\n                // extrudeLines.push(extrudeLine);\r\n                const { position, normal, indices } = buffGeom;\r\n                const faceLen = indices.length / 3;\r\n                // faceMap[i] = [faceIndex + 1, faceIndex + faceLen];\r\n                faceIndex += faceLen;\r\n                const psCount = position.length / 3, \r\n                //  colorCount = buffGeom.attributes.color.count,\r\n                normalCount = normal.length / 3;\r\n                geometriesAttributes[i] = {\r\n                    position: {\r\n                        middleZ: minZ + h / 2,\r\n                        count: psCount,\r\n                        start: psIndex,\r\n                        end: psIndex + psCount * 3,\r\n                    },\r\n                    // normal: {\r\n                    //     count: normalCount,\r\n                    //     start: normalIndex,\r\n                    //     end: normalIndex + normalCount * 3,\r\n                    // },\r\n                    // color: {\r\n                    //     count: colorCount,\r\n                    //     start: colorIndex,\r\n                    //     end: colorIndex + colorCount * 3,\r\n                    // },\r\n                    // uv: {\r\n                    //     count: uvCount,\r\n                    //     start: uvIndex,\r\n                    //     end: uvIndex + uvCount * 2,\r\n                    // },\r\n                    hide: false\r\n                };\r\n                psIndex += psCount * 3;\r\n                normalIndex += normalCount * 3;\r\n                // colorIndex += colorCount * 3;\r\n                // uvIndex += uvCount * 2;\r\n            }\r\n            bufferGeometry = mergeBufferGeometries(geometries);\r\n            if (topColor) {\r\n                initVertexColors(bufferGeometry, bottomColor, topColor, geometriesAttributes);\r\n                material.vertexColors = getVertexColors();\r\n            }\r\n        }\r\n        this._initOptions(options);\r\n        this._createMesh(bufferGeometry, material);\r\n        const z = layer.distanceToVector3(altitude, altitude).x;\r\n        const v = layer.coordinateToVector3(center, z);\r\n        this.getObject3d().position.copy(v);\r\n        //Face corresponding to monomer\r\n        // this._faceMap = faceMap;\r\n        this._baseObjects = extrudeLines;\r\n        this._datas = lineStrings;\r\n        this._geometriesAttributes = geometriesAttributes;\r\n        this.faceIndex = null;\r\n        this._geometryCache = generatePickBufferGeometry(bufferGeometry);\r\n        this.isHide = false;\r\n        this._colorMap = {};\r\n        this._initBaseObjectsEvent(extrudeLines);\r\n        if (!asynchronous) {\r\n            this._setPickObject3d();\r\n            this._init();\r\n        }\r\n        this.type = 'ExtrudeLines';\r\n    }\r\n    // eslint-disable-next-line consistent-return\r\n    getSelectMesh() {\r\n        const index = this._getIndex();\r\n        if (index != null) {\r\n            if (!this._baseObjects[index]) {\r\n                const lineString = this._datas[index];\r\n                const opts = Object.assign({}, this.options, isGeoJSONLine(lineString) ? lineString.properties : lineString.getProperties(), { index });\r\n                this._baseObjects[index] = new ExtrudeLine(lineString, opts, this.getObject3d().material, this.getLayer());\r\n                this._proxyEvent(this._baseObjects[index]);\r\n            }\r\n            return {\r\n                data: this._datas[index],\r\n                baseObject: this._baseObjects[index]\r\n            };\r\n        }\r\n    }\r\n    // eslint-disable-next-line no-unused-vars\r\n    identify(coordinate) {\r\n        return this.picked;\r\n    }\r\n    _workerLoad(result) {\r\n        const { geometriesAttributes } = result;\r\n        // this._faceMap = faceMap;\r\n        this._geometriesAttributes = geometriesAttributes;\r\n        const bufferGeometry = generateBufferGeometry(result);\r\n        this._geometryCache = generatePickBufferGeometry(bufferGeometry);\r\n        const { topColor, bottomColor, bottomHeight, height } = this.getOptions();\r\n        const object3d = this.getObject3d();\r\n        const material = object3d.material;\r\n        if (topColor) {\r\n            initVertexColors(bufferGeometry, bottomColor, topColor, geometriesAttributes);\r\n            material.vertexColors = getVertexColors();\r\n        }\r\n        this.getObject3d().geometry = bufferGeometry;\r\n        this.getObject3d().material.needsUpdate = true;\r\n        this._setPickObject3d();\r\n        this._init();\r\n        if (this.isAdd) {\r\n            const pick = this.getLayer().getPick();\r\n            pick.add(this.pickObject3d);\r\n        }\r\n        this._fire('workerload', { target: this });\r\n    }\r\n}\r\nexport default ExtrudeLines;\r\n//# sourceMappingURL=ExtrudeLines.js.map","import * as maptalks from 'maptalks';\r\nimport * as THREE from 'three';\r\nimport BaseObject from './BaseObject';\r\nimport { getDefaultLineGeometry, getLinePosition, getLineSegmentPosition, LineStringSplit, mergeLinePositions } from './util/LineUtil';\r\nimport MergedMixin from './MergedMixin';\r\nimport Line from './Line';\r\nimport { isGeoJSONLine } from './util/GeoJSONUtil';\r\nimport { addAttribute, getVertexColors } from './util/ThreeAdaptUtil';\r\nimport { getCenterOfPoints, getGeometriesColorArray, setBottomHeight } from './util/index';\r\nimport { LinesTaskIns } from './BaseObjectTaskManager';\r\nconst OPTIONS = {\r\n    altitude: 0,\r\n    colors: null\r\n};\r\n/**\r\n *\r\n */\r\nclass Lines extends MergedMixin(BaseObject) {\r\n    constructor(lineStrings, options, material, layer) {\r\n        if (!Array.isArray(lineStrings)) {\r\n            lineStrings = [lineStrings];\r\n        }\r\n        const centers = [], lineStringList = [];\r\n        const len = lineStrings.length;\r\n        for (let i = 0; i < len; i++) {\r\n            const lineString = lineStrings[i];\r\n            const result = LineStringSplit(lineString);\r\n            centers.push(result.center);\r\n            lineStringList.push(result.lineStrings);\r\n        }\r\n        // Get the center point of the point set\r\n        const center = getCenterOfPoints(centers);\r\n        options = maptalks.Util.extend({}, OPTIONS, options, { layer, lineStrings, coordinate: center });\r\n        super();\r\n        this._initOptions(options);\r\n        const { asynchronous } = options;\r\n        let geometry;\r\n        const lines = [], cache = {};\r\n        let faceIndex = 0, faceMap = [], geometriesAttributes = [], psIndex = 0, positionList = [];\r\n        if (asynchronous) {\r\n            geometry = getDefaultLineGeometry();\r\n            LinesTaskIns.push({\r\n                id: maptalks.Util.GUID(),\r\n                layer,\r\n                key: options.key,\r\n                center,\r\n                data: lineStringList,\r\n                lineStrings,\r\n                baseObject: this\r\n            });\r\n        }\r\n        else {\r\n            for (let i = 0; i < len; i++) {\r\n                const lls = lineStringList[i];\r\n                let psCount = 0;\r\n                for (let m = 0, le = lls.length; m < le; m++) {\r\n                    const properties = (isGeoJSONLine(lls[m]) ? lls[m]['properties'] : lls[m].getProperties() || {});\r\n                    const { positions } = getLinePosition(lls[m], layer, center, false);\r\n                    setBottomHeight(positions, properties.bottomHeight, layer, cache);\r\n                    psCount += (positions.length / 3 * 2 - 2);\r\n                    positionList.push(getLineSegmentPosition(positions));\r\n                }\r\n                // const line = new Line(lineString, opts, material, layer);\r\n                // lines.push(line);\r\n                // const psCount = positionsV.length + positionsV.length - 2;\r\n                const faceLen = psCount;\r\n                // faceMap[i] = [faceIndex, faceIndex + faceLen];\r\n                faceIndex += faceLen;\r\n                geometriesAttributes[i] = {\r\n                    position: {\r\n                        count: psCount,\r\n                        start: psIndex,\r\n                        end: psIndex + psCount * 3,\r\n                    },\r\n                    hide: false\r\n                };\r\n                psIndex += psCount * 3;\r\n            }\r\n            const position = mergeLinePositions(positionList);\r\n            geometry = new THREE.BufferGeometry();\r\n            addAttribute(geometry, 'position', new THREE.BufferAttribute(position, 3));\r\n        }\r\n        this._createLineSegments(geometry, material);\r\n        const { altitude } = options;\r\n        const z = layer.distanceToVector3(altitude, altitude).x;\r\n        const v = layer.coordinateToVector3(center, z);\r\n        this.getObject3d().position.copy(v);\r\n        // this._faceMap = faceMap;\r\n        this._baseObjects = lines;\r\n        this._datas = lineStrings;\r\n        this._geometriesAttributes = geometriesAttributes;\r\n        this.faceIndex = null;\r\n        this.index = null;\r\n        this._geometryCache = geometry.clone();\r\n        this.isHide = false;\r\n        this._colorMap = {};\r\n        this._initBaseObjectsEvent(lines);\r\n        if (!asynchronous) {\r\n            this._setPickObject3d();\r\n            this._init();\r\n        }\r\n        this.type = 'Lines';\r\n    }\r\n    // eslint-disable-next-line consistent-return\r\n    getSelectMesh() {\r\n        const index = this._getIndex();\r\n        if (index != null) {\r\n            if (!this._baseObjects[index]) {\r\n                const lineString = this._datas[index];\r\n                const opts = maptalks.Util.extend({}, this.getOptions(), { index }, isGeoJSONLine(lineString) ? lineString.properties : lineString.getProperties());\r\n                this._baseObjects[index] = new Line(lineString, opts, this.getObject3d().material, this.getLayer());\r\n                this._proxyEvent(this._baseObjects[index]);\r\n            }\r\n            return {\r\n                data: this._datas[index],\r\n                baseObject: this._baseObjects[index]\r\n            };\r\n        }\r\n    }\r\n    _setPickObject3d() {\r\n        if (!this._colorMap) {\r\n            return;\r\n        }\r\n        const geometry = this._geometryCache || this.getObject3d().geometry.clone();\r\n        const pick = this.getLayer().getPick();\r\n        const { _geometriesAttributes } = this;\r\n        const len = _geometriesAttributes.length;\r\n        const colors = getGeometriesColorArray(_geometriesAttributes);\r\n        let cIndex = 0;\r\n        for (let i = 0; i < len; i++) {\r\n            const color = pick.getColor();\r\n            const colorIndex = color.getHex();\r\n            this._colorMap[colorIndex] = i;\r\n            const { count } = _geometriesAttributes[i].position;\r\n            this._datas[i].colorIndex = colorIndex;\r\n            for (let j = 0; j < count; j++) {\r\n                colors[cIndex] = color.r;\r\n                colors[cIndex + 1] = color.g;\r\n                colors[cIndex + 2] = color.b;\r\n                cIndex += 3;\r\n            }\r\n        }\r\n        addAttribute(geometry, 'color', new THREE.BufferAttribute(colors, 3, true));\r\n        const material = this.getObject3d().material.clone();\r\n        material.color.set('#fff');\r\n        material.vertexColors = getVertexColors();\r\n        const color = pick.getColor();\r\n        const colorIndex = color.getHex();\r\n        const mesh = new THREE.LineSegments(geometry, material);\r\n        mesh.position.copy(this.getObject3d().position);\r\n        mesh['_colorIndex'] = colorIndex;\r\n        this.setPickObject3d(mesh);\r\n    }\r\n    // eslint-disable-next-line no-unused-vars\r\n    identify(coordinate) {\r\n        return this.picked;\r\n    }\r\n    _workerLoad(result) {\r\n        const { position, geometriesAttributes } = result;\r\n        // this._faceMap = faceMap;\r\n        this._geometriesAttributes = geometriesAttributes;\r\n        const geometry = new THREE.BufferGeometry();\r\n        addAttribute(geometry, 'position', new THREE.BufferAttribute(new Float32Array(position), 3));\r\n        this._computeLineDistances(geometry);\r\n        this._geometryCache = geometry.clone();\r\n        this.getObject3d().geometry = geometry;\r\n        this.getObject3d().material.needsUpdate = true;\r\n        this._setPickObject3d();\r\n        this._init();\r\n        if (this.isAdd) {\r\n            const pick = this.getLayer().getPick();\r\n            pick.add(this.pickObject3d);\r\n        }\r\n        this._fire('workerload', { target: this });\r\n    }\r\n}\r\nexport default Lines;\r\n//# sourceMappingURL=Lines.js.map","/*\r\n\r\nGlobal sharing\r\n\r\n*/\r\n//Maximum concurrent\r\nconst MAX = 10;\r\nconst waitingQueue = [];\r\nconst currentQueue = [];\r\nexport function getQueues() {\r\n    return {\r\n        waitingQueue,\r\n        currentQueue\r\n    };\r\n}\r\n/**\r\n *\r\n * @param {*} key\r\n * @param {*} url\r\n * @param {*} callback\r\n * @param {*} img\r\n * @param {*} vt\r\n */\r\nexport function pushQueue(key, url, callback, img, vt) {\r\n    // url += `?key=${key}`;\r\n    const q = {\r\n        key,\r\n        url,\r\n        callback,\r\n        img,\r\n        vt\r\n    };\r\n    if (currentQueue.length < MAX) {\r\n        currentQueue.push(q);\r\n        vt.loopMessage(q);\r\n    }\r\n    else {\r\n        waitingQueue.push(q);\r\n    }\r\n}\r\n/**\r\n *\r\n * @param {*} index\r\n */\r\nexport function outQueue(index) {\r\n    const callback = deleteQueueItem(waitingQueue, index);\r\n    if (callback) {\r\n        callback(index);\r\n    }\r\n}\r\n/**\r\n *\r\n * @param {*} queArray\r\n * @param {*} index\r\n */\r\nexport function deleteQueueItem(queArray, index) {\r\n    for (let i = 0, len = queArray.length; i < len; i++) {\r\n        const q = queArray[i];\r\n        if (q) {\r\n            const { key, callback } = q;\r\n            if (index === key) {\r\n                queArray.splice(i, 1);\r\n                return callback;\r\n            }\r\n        }\r\n    }\r\n    return null;\r\n}\r\n/**\r\n *\r\n * @param {*} key\r\n * @param {*} vt\r\n */\r\nexport function nextLoop(key, vt) {\r\n    deleteQueueItem(currentQueue, key);\r\n    if (waitingQueue.length) {\r\n        currentQueue.push(waitingQueue[0]);\r\n        waitingQueue.splice(0, 1);\r\n        const last = currentQueue[currentQueue.length - 1];\r\n        vt.loopMessage(last);\r\n    }\r\n}\r\n//# sourceMappingURL=TileDataQueue.js.map","const canvas = document.createElement('canvas');\r\nconst SIZE = 256;\r\ncanvas.width = canvas.height = SIZE;\r\nlet DEFAULT_IMAGE;\r\nexport function generateImage(key, debug = false) {\r\n    if (DEFAULT_IMAGE) {\r\n        return DEFAULT_IMAGE;\r\n    }\r\n    const ctx = canvas.getContext('2d');\r\n    ctx.clearRect(0, 0, SIZE, SIZE);\r\n    ctx.save();\r\n    DEFAULT_IMAGE = canvas.toDataURL();\r\n    return DEFAULT_IMAGE;\r\n}\r\nexport function createCanvas(width = 1, height = 1) {\r\n    let canvas;\r\n    if (typeof document === 'undefined') {\r\n        // var Canvas = require('canvas');\r\n        // canvas = new Canvas(width, height);\r\n    }\r\n    else {\r\n        canvas = document.createElement('canvas');\r\n        if (width) {\r\n            canvas.width = width;\r\n        }\r\n        if (height) {\r\n            canvas.height = height;\r\n        }\r\n    }\r\n    return canvas;\r\n}\r\n//# sourceMappingURL=CanvasUtil.js.map","import * as maptalks from 'maptalks';\r\nimport { generateImage } from './util/CanvasUtil';\r\n/**\r\n *\r\n */\r\nclass BaseVectorTileLayer extends maptalks.TileLayer {\r\n    constructor(url, options = {}) {\r\n        super(maptalks.Util.GUID(), maptalks.Util.extend({ urlTemplate: url }, options));\r\n        this._opts = null;\r\n        this._layer = null;\r\n        this.material = null;\r\n        this.getMaterial = null;\r\n        this._baseObjectKeys = {};\r\n        this._loadTiles = {};\r\n        this._add = null;\r\n        this._layerLaodTime = new Date().getTime();\r\n    }\r\n    isAsynchronous() {\r\n        return this._opts.worker;\r\n    }\r\n    /**\r\n     *get current all baseobject\r\n     */\r\n    getBaseObjects() {\r\n        const loadTiles = this._loadTiles;\r\n        const baseos = [];\r\n        for (let key in loadTiles) {\r\n            const baseobjects = this._baseObjectKeys[key];\r\n            if (baseobjects && Array.isArray(baseobjects) && baseobjects.length) {\r\n                for (let i = 0, len = baseobjects.length; i < len; i++) {\r\n                    baseos.push(baseobjects[i]);\r\n                }\r\n            }\r\n        }\r\n        return baseos;\r\n    }\r\n    /**\r\n   * This method should be overridden for event handling\r\n   * @param {*} type\r\n   * @param {*} e\r\n   */\r\n    // eslint-disable-next-line no-unused-vars\r\n    onSelectMesh(type, e) {\r\n    }\r\n    /**\r\n   * this is can override\r\n   * @param {*} index\r\n   * @param {*} json\r\n   */\r\n    // eslint-disable-next-line no-unused-vars\r\n    formatBaseObjects(index, json) {\r\n        return [];\r\n    }\r\n    //queue loop\r\n    // eslint-disable-next-line no-unused-vars\r\n    loopMessage(q) {\r\n    }\r\n    /**\r\n    *\r\n    * @param {*} q\r\n    */\r\n    getTileData(q) {\r\n        const { key, url, callback, img } = q;\r\n        maptalks.Ajax.getJSON(url, {}, function (error, res) {\r\n            if (error) {\r\n                console.error(error);\r\n                callback(key, null, img);\r\n            }\r\n            else {\r\n                callback(key, res, img);\r\n            }\r\n        });\r\n    }\r\n    _getCurentTileKeys() {\r\n        const tileGrids = this.getTiles().tileGrids || [];\r\n        const keys = [], keysMap = {};\r\n        for (let i = 0, len = tileGrids.length; i < len; i++) {\r\n            const d = tileGrids[i];\r\n            const tiles = d.tiles || [];\r\n            for (let j = 0, len1 = tiles.length; j < len1; j++) {\r\n                const { id } = tiles[j];\r\n                keys.push(id);\r\n                keysMap[id] = true;\r\n            }\r\n        }\r\n        return { keys, keysMap };\r\n    }\r\n    _isLoad() {\r\n        const { keys } = this._getCurentTileKeys();\r\n        const keys1 = Object.keys(this._renderer.tilesInView);\r\n        if (keys.length === keys1.length) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    _layerOnLoad() {\r\n        // This event will be triggered multiple times per unit time\r\n        const time = new Date().getTime();\r\n        const offsetTime = time - this._layerLaodTime;\r\n        if (offsetTime < 20) {\r\n            return;\r\n        }\r\n        this._layerLaodTime = time;\r\n        const tilesInView = this._renderer.tilesInView, loadTiles = this._loadTiles, threeLayer = this._layer, keys = this._baseObjectKeys;\r\n        const tilesInViewLen = Object.keys(tilesInView).length, loadTilesLen = Object.keys(loadTiles).length;\r\n        const needsRemoveBaseObjects = [];\r\n        if (tilesInViewLen && loadTilesLen) {\r\n            for (let index in loadTiles) {\r\n                if (!tilesInView[index]) {\r\n                    if (keys[index]) {\r\n                        (keys[index] || []).forEach(baseobject => {\r\n                            needsRemoveBaseObjects.push(baseobject);\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (needsRemoveBaseObjects.length) {\r\n            threeLayer.removeMesh(needsRemoveBaseObjects, false);\r\n        }\r\n        if (tilesInViewLen && loadTilesLen) {\r\n            for (let index in tilesInView) {\r\n                if (!loadTiles[index]) {\r\n                    if (keys[index]) {\r\n                        const baseobject = keys[index];\r\n                        threeLayer.addMesh(baseobject);\r\n                    }\r\n                    else {\r\n                        const { x, y, z } = this._getXYZOfIndex(index);\r\n                        this.getTileUrl(x, y, z);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        this._loadTiles = Object.assign({}, tilesInView);\r\n        this._diffCache();\r\n    }\r\n    _init() {\r\n    }\r\n    _workerLoad(e) {\r\n        const baseobject = e.target;\r\n        const img = baseobject._img;\r\n        img.currentCount++;\r\n        if (img.currentCount === img.needCount) {\r\n            img.src = generateImage(img._key, this._opts.debug);\r\n        }\r\n    }\r\n    _generateBaseObjects(index, res, img) {\r\n        if (res && img) {\r\n            const { keysMap } = this._getCurentTileKeys();\r\n            //not in current ,ignore\r\n            if (!keysMap[index]) {\r\n                img.src = generateImage(index, this._opts.debug);\r\n                return;\r\n            }\r\n            const baseobjects = this.formatBaseObjects(index, res);\r\n            if (baseobjects.length) {\r\n                img.needCount = baseobjects.length;\r\n                img.currentCount = 0;\r\n                for (let i = 0, len = baseobjects.length; i < len; i++) {\r\n                    const baseobject = baseobjects[i];\r\n                    baseobject._img = img;\r\n                    baseobject._vt = this;\r\n                    if (!this.isVisible()) {\r\n                        baseobject.hide();\r\n                    }\r\n                    this._cachetile(index, baseobject);\r\n                    if (!baseobject.isAsynchronous()) {\r\n                        img.currentCount++;\r\n                    }\r\n                }\r\n                this._layer.addMesh(baseobjects, false);\r\n                if (img.needCount === img.currentCount) {\r\n                    img.src = generateImage(index, this._opts.debug);\r\n                }\r\n                if (this.isAsynchronous()) {\r\n                    baseobjects.filter(baseobject => {\r\n                        return baseobject.isAsynchronous();\r\n                    }).forEach(baseobject => {\r\n                        baseobject.on('workerload', this._workerLoad, this);\r\n                    });\r\n                }\r\n                else {\r\n                    img.src = generateImage(index, this._opts.debug);\r\n                }\r\n            }\r\n            else {\r\n                img.src = generateImage(index, this._opts.debug);\r\n            }\r\n            this._loadTiles[index] = true;\r\n        }\r\n        else if (img) {\r\n            img.src = generateImage(index, this._opts.debug);\r\n        }\r\n    }\r\n    _diffCache() {\r\n        // if (this._layer.getMap().isInteracting()) {\r\n        //     return;\r\n        // }\r\n        if (Object.keys(this._baseObjectKeys).length > this._renderer.tileCache.max) {\r\n            const tileCache = this._renderer.tileCache.data;\r\n            const tilesInView = this._renderer.tilesInView;\r\n            const needsRemoveBaseObjects = [];\r\n            for (let index in this._baseObjectKeys) {\r\n                if (!tileCache[index] && !tilesInView[index]) {\r\n                    (this._baseObjectKeys[index] || []).forEach(baseobject => {\r\n                        if (baseobject.isAdd) {\r\n                            needsRemoveBaseObjects.push(baseobject);\r\n                        }\r\n                    });\r\n                    this._diposeBaseObject(index);\r\n                    delete this._baseObjectKeys[index];\r\n                }\r\n            }\r\n            // Batch deletion can have better performance\r\n            if (needsRemoveBaseObjects.length) {\r\n                this._layer.removeMesh(needsRemoveBaseObjects, false);\r\n            }\r\n        }\r\n    }\r\n    _diposeBaseObject(index) {\r\n        const baseobjects = this._baseObjectKeys[index];\r\n        if (baseobjects && baseobjects.length) {\r\n            baseobjects.forEach(baseobject => {\r\n                baseobject.getObject3d().geometry.dispose();\r\n                if (baseobject._geometryCache) {\r\n                    baseobject._geometryCache.dispose();\r\n                }\r\n                const bos = baseobject._baseObjects;\r\n                if (bos && bos.length) {\r\n                    bos.forEach(bo => {\r\n                        bo.getObject3d().geometry.dispose();\r\n                        bo = null;\r\n                    });\r\n                }\r\n                baseobject._datas = null;\r\n                baseobject._geometriesAttributes = null;\r\n                baseobject._faceMap = null;\r\n                baseobject._colorMap = null;\r\n                if (baseobject.pickObject3d) {\r\n                    baseobject.pickObject3d.geometry.dispose();\r\n                    // baseobject.pickObject3d.material.dispose();\r\n                }\r\n                baseobject = null;\r\n            });\r\n        }\r\n    }\r\n    _cachetile(index, baseobject) {\r\n        if (!this._baseObjectKeys[index]) {\r\n            this._baseObjectKeys[index] = [];\r\n        }\r\n        this._baseObjectKeys[index].push(baseobject);\r\n    }\r\n    _getXYZOfIndex(index) {\r\n        const splitstr = index.indexOf('_') > -1 ? '_' : '-';\r\n        let [y, x, z] = index.split(splitstr).slice(1, 4);\r\n        const x1 = parseInt(x);\r\n        const y1 = parseInt(y);\r\n        const z1 = parseInt(z);\r\n        return { x: x1, y: y1, z: z1 };\r\n    }\r\n    _getTileExtent(x, y, z) {\r\n        const map = this.getMap(), res = map._getResolution(z), tileConfig = this._getTileConfig(), tileExtent = tileConfig.getTilePrjExtent(x, y, res);\r\n        return tileExtent;\r\n    }\r\n    /**\r\n     *\r\n     * @param {} x\r\n     * @param {*} y\r\n     * @param {*} z\r\n     */\r\n    _getTileLngLatExtent(x, y, z) {\r\n        const tileExtent = this._getTileExtent(x, y, z);\r\n        let max = tileExtent.getMax(), min = tileExtent.getMin();\r\n        const map = this.getMap();\r\n        const projection = map.getProjection();\r\n        min = projection.unproject(min);\r\n        max = projection.unproject(max);\r\n        return new maptalks.Extent(min, max);\r\n    }\r\n}\r\nexport default BaseVectorTileLayer;\r\n//# sourceMappingURL=BaseVectorTileLayer.js.map","import * as maptalks from 'maptalks';\r\nimport * as THREE from 'three';\r\nimport { pushQueue, outQueue, getQueues, nextLoop } from './queue/TileDataQueue';\r\nimport { isGeoJSONPolygon, isGeoJSONLine, spliteGeoJSONMulti, isGeoJSONPoint, getGeoJSONCoordinates } from './util/GeoJSONUtil';\r\nimport BaseVectorTileLayer from './BaseVectorTileLayer';\r\nconst OPTIONS = {\r\n    worker: false\r\n};\r\n/**\r\n *Provide a simple data loading layer with large amount of data\r\n */\r\nclass ThreeVectorTileLayer extends BaseVectorTileLayer {\r\n    constructor(url, options = {}, getMaterial, layer) {\r\n        super(maptalks.Util.GUID(), maptalks.Util.extend({ urlTemplate: url }, OPTIONS, options));\r\n        this._opts = options;\r\n        this._layer = layer;\r\n        this.getMaterial = getMaterial;\r\n        this._baseObjectKeys = {};\r\n        this._loadTiles = {};\r\n        this._add = null;\r\n        this._layerLaodTime = new Date().getTime();\r\n        this._init();\r\n    }\r\n    /**\r\n     * this is can override\r\n     * @param {*} index\r\n     * @param {*} json\r\n     */\r\n    formatBaseObjects(index, json) {\r\n        const opts = this._opts, baseobjects = [];\r\n        const asynchronous = this.isAsynchronous();\r\n        for (let layerName in json) {\r\n            const geojson = json[layerName] || {};\r\n            let features;\r\n            if (Array.isArray(geojson)) {\r\n                features = geojson;\r\n            }\r\n            else if (geojson.type === 'FeatureCollection') {\r\n                features = geojson.features;\r\n            }\r\n            if (features && features.length) {\r\n                const polygons = [], lineStrings = [], points = [];\r\n                for (let i = 0, len = features.length; i < len; i++) {\r\n                    const feature = features[i];\r\n                    if (isGeoJSONPolygon(feature)) {\r\n                        polygons.push(feature);\r\n                    }\r\n                    else if (isGeoJSONLine(feature)) {\r\n                        const fs = spliteGeoJSONMulti(feature);\r\n                        for (let j = 0, len1 = fs.length; j < len1; j++) {\r\n                            lineStrings.push(fs[j]);\r\n                        }\r\n                    }\r\n                    else if (isGeoJSONPoint(feature)) {\r\n                        const fs = spliteGeoJSONMulti(feature);\r\n                        for (let j = 0, len1 = fs.length; j < len1; j++) {\r\n                            points.push(maptalks.Util.extend({}, fs[j].properties, fs[j], { coordinate: getGeoJSONCoordinates(fs[j]) }));\r\n                        }\r\n                    }\r\n                }\r\n                if (polygons.length) {\r\n                    const material = this._getMaterial(layerName, polygons, index, geojson);\r\n                    if (material) {\r\n                        const extrudepolygons = this._layer.toExtrudePolygons(polygons, maptalks.Util.extend({}, { topColor: '#fff', layerName, asynchronous, key: index }, opts), material);\r\n                        baseobjects.push(extrudepolygons);\r\n                    }\r\n                }\r\n                if (lineStrings.length) {\r\n                    const material = this._getMaterial(layerName, lineStrings, index, geojson);\r\n                    if (material && (material instanceof THREE.LineBasicMaterial || material instanceof THREE.LineDashedMaterial)) {\r\n                        const lines = this._layer.toLines(lineStrings, maptalks.Util.extend({}, { layerName, asynchronous }, opts), material);\r\n                        baseobjects.push(lines);\r\n                    }\r\n                }\r\n                if (points.length) {\r\n                    const material = this._getMaterial(layerName, points, index, geojson);\r\n                    if (material && material instanceof THREE.PointsMaterial) {\r\n                        const ps = this._layer.toPoints(points, maptalks.Util.extend({}, { layerName, asynchronous }, opts), material);\r\n                        baseobjects.push(ps);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return baseobjects;\r\n    }\r\n    //queue loop\r\n    loopMessage(q) {\r\n        const { currentQueue } = getQueues();\r\n        if (currentQueue.length > 0) {\r\n            this.getTileData(q);\r\n        }\r\n    }\r\n    _init() {\r\n        this.on('layerload', this._layerOnLoad);\r\n        this.on('add', () => {\r\n            if (this._add === false) {\r\n                const baseobjects = this.getBaseObjects();\r\n                this._layer.addMesh(baseobjects);\r\n            }\r\n            this._add = true;\r\n            /**\r\n             * layerload have a bug ,Sometimes it doesn't trigger,I don't know why\r\n             * Add heartbeat detection mechanism\r\n             */\r\n            this.intervalId = setInterval(() => {\r\n                if (this._isLoad() && (!this._layer.getMap().isInteracting())) {\r\n                    this.fire('layerload');\r\n                }\r\n            }, 1000);\r\n        });\r\n        this.on('remove', () => {\r\n            this._add = false;\r\n            const baseobjects = this.getBaseObjects();\r\n            this._layer.removeMesh(baseobjects);\r\n            clearInterval(this.intervalId);\r\n        });\r\n        this.on('show', () => {\r\n            const baseobjects = this.getBaseObjects();\r\n            baseobjects.forEach(baseobject => {\r\n                baseobject.show();\r\n            });\r\n            for (let key in this._baseObjectKeys) {\r\n                const baseobjects = this._baseObjectKeys[key] || [];\r\n                baseobjects.forEach(baseobject => {\r\n                    baseobject.show();\r\n                });\r\n            }\r\n        });\r\n        this.on('hide', () => {\r\n            const baseobjects = this.getBaseObjects();\r\n            baseobjects.forEach(baseobject => {\r\n                baseobject.hide();\r\n            });\r\n            for (let key in this._baseObjectKeys) {\r\n                const baseobjects = this._baseObjectKeys[key] || [];\r\n                baseobjects.forEach(baseobject => {\r\n                    baseobject.hide();\r\n                });\r\n            }\r\n        });\r\n        this.on('renderercreate', (e) => {\r\n            e.renderer.loadTile = function loadTile(tile) {\r\n                var tileSize = this.layer.getTileSize();\r\n                var tileImage = new Image();\r\n                tileImage.width = tileSize['width'];\r\n                tileImage.height = tileSize['height'];\r\n                tileImage.onload = this.onTileLoad.bind(this, tileImage, tile);\r\n                tileImage.onerror = this.onTileError.bind(this, tileImage, tile);\r\n                this.loadTileImage(tileImage, tile['url'], tile.id);\r\n                return tileImage;\r\n            };\r\n            e.renderer.deleteTile = function (tile) {\r\n                if (!tile || !tile.image) {\r\n                    return;\r\n                }\r\n                tile.image.onload = null;\r\n                tile.image.onerror = null;\r\n                const tileinfo = tile.info || {};\r\n                outQueue(tileinfo.id);\r\n            };\r\n            e.renderer.loadTileImage = (img, url, key) => {\r\n                img._key = key;\r\n                pushQueue(key, url, (index, json, image) => {\r\n                    // img.src = generateImage(key, this._opts.debug);\r\n                    this._generateBaseObjects(index, json, image);\r\n                    nextLoop(index, this);\r\n                }, img, this);\r\n            };\r\n        });\r\n    }\r\n    _getMaterial(layerName, data, index, geojson) {\r\n        if (this.getMaterial && maptalks.Util.isFunction(this.getMaterial)) {\r\n            return this.getMaterial(layerName, data, index, geojson);\r\n        }\r\n        return null;\r\n    }\r\n}\r\nexport default ThreeVectorTileLayer;\r\n//# sourceMappingURL=ThreeVectorTileLayer.js.map","import * as THREE from 'three';\r\nimport { addAttribute } from './ThreeAdaptUtil';\r\nexport function getPlaneGeometryAttribute(width, height, devideW, devideH) {\r\n    const dx = width / devideW, dy = height / devideH;\r\n    const minX = -width / 2, maxY = height / 2, minY = -height / 2;\r\n    const len = (devideW + 1) * (devideH + 1);\r\n    const position = new Float32Array(len * 3), uv = new Float32Array(len * 2), normal = new Float32Array(len * 3), tempIndex = new Uint32Array(len * 10);\r\n    let index = 0, uIndex = 0, iIndex = 0;\r\n    for (let j = 0; j <= devideH; j++) {\r\n        for (let i = 0; i <= devideW; i++) {\r\n            const x = minX + dx * i;\r\n            const y = maxY - dy * j;\r\n            position[index] = x;\r\n            position[index + 1] = y;\r\n            position[index + 2] = 0;\r\n            normal[index] = 0;\r\n            normal[index + 1] = 0;\r\n            normal[index + 2] = 1;\r\n            const uvx = (x - minX) / width, uvy = (y - minY) / height;\r\n            uv[uIndex] = uvx;\r\n            uv[uIndex + 1] = uvy;\r\n            index += 3;\r\n            uIndex += 2;\r\n            if (i < devideW && j < devideH) {\r\n                const a = j * (devideW + 1) + i, b = a + 1, c = (devideW + 1) * (j + 1) + i, d = c + 1;\r\n                tempIndex[iIndex] = a;\r\n                tempIndex[iIndex + 1] = c;\r\n                tempIndex[iIndex + 2] = b;\r\n                tempIndex[iIndex + 3] = c;\r\n                tempIndex[iIndex + 4] = d;\r\n                tempIndex[iIndex + 5] = b;\r\n                iIndex += 6;\r\n            }\r\n        }\r\n    }\r\n    const indexArray = new Uint32Array(iIndex);\r\n    for (let i = 0, len = indexArray.length; i < len; i++) {\r\n        indexArray[i] = tempIndex[i];\r\n    }\r\n    return {\r\n        position,\r\n        uv,\r\n        normal,\r\n        indexs: indexArray\r\n    };\r\n}\r\nexport function getPlaneGeometry(width, height, devideW, devideH) {\r\n    const { position, uv, normal, indexs } = getPlaneGeometryAttribute(width, height, devideW, devideH);\r\n    const geometry = new THREE.BufferGeometry();\r\n    addAttribute(geometry, 'position', new THREE.BufferAttribute(position, 3));\r\n    addAttribute(geometry, 'normal', new THREE.BufferAttribute(normal, 3));\r\n    addAttribute(geometry, 'uv', new THREE.BufferAttribute(uv, 2));\r\n    geometry.setIndex(new THREE.BufferAttribute(indexs, 1));\r\n    return geometry;\r\n}\r\n//# sourceMappingURL=GeometryUtil.js.map","import * as maptalks from 'maptalks';\r\nimport * as THREE from 'three';\r\nimport BaseObject from './BaseObject';\r\nimport { distanceToVector3 } from './util';\r\nimport { getPlaneGeometry } from './util/GeometryUtil';\r\n// import { addAttribute } from './util/ThreeAdaptUtil';\r\nconst textureLoader = new THREE.TextureLoader();\r\nconst canvas = document.createElement('canvas'), tileSize = 256;\r\nfunction getRGBData(image, width = tileSize, height = tileSize) {\r\n    canvas.width = width;\r\n    canvas.height = height;\r\n    const ctx = canvas.getContext('2d');\r\n    ctx.drawImage(image, 0, 0, width, height);\r\n    return ctx.getImageData(0, 0, width, height).data;\r\n}\r\nfunction generateImage(image) {\r\n    if (!image) {\r\n        return null;\r\n    }\r\n    let img;\r\n    if (typeof image === 'string') {\r\n        img = new Image();\r\n        img.src = image;\r\n    }\r\n    else if (image instanceof HTMLCanvasElement) {\r\n        img = new Image();\r\n        img.src = image.toDataURL();\r\n    }\r\n    else if (image instanceof Image) {\r\n        img = new Image();\r\n        img.src = image.src;\r\n        img.crossOrigin = image.crossOrigin;\r\n    }\r\n    if (img && !img.crossOrigin) {\r\n        img.crossOrigin = 'Anonymous';\r\n    }\r\n    return img;\r\n}\r\nconst OPTIONS = {\r\n    interactive: false,\r\n    altitude: 0,\r\n    image: null,\r\n    imageWidth: 256,\r\n    imageHeight: 256,\r\n    texture: null\r\n};\r\n/**\r\n *\r\n */\r\nclass Terrain extends BaseObject {\r\n    constructor(extent, options, material, layer) {\r\n        options = maptalks.Util.extend({}, OPTIONS, options, { layer, extent });\r\n        const { texture, image, altitude, imageHeight, imageWidth } = options;\r\n        if (!image) {\r\n            console.error('not find image');\r\n        }\r\n        if (!(extent instanceof maptalks.Extent)) {\r\n            extent = new maptalks.Extent(extent);\r\n        }\r\n        const { xmin, ymin, xmax, ymax } = extent;\r\n        const coords = [\r\n            [xmin, ymin],\r\n            [xmin, ymax],\r\n            [xmax, ymax],\r\n            [xmax, ymin]\r\n        ];\r\n        let vxmin = Infinity, vymin = Infinity, vxmax = -Infinity, vymax = -Infinity;\r\n        coords.forEach(coord => {\r\n            const v = layer.coordinateToVector3(coord);\r\n            const { x, y } = v;\r\n            vxmin = Math.min(x, vxmin);\r\n            vymin = Math.min(y, vymin);\r\n            vxmax = Math.max(x, vxmax);\r\n            vymax = Math.max(y, vymax);\r\n        });\r\n        const w = Math.abs(vxmax - vxmin), h = Math.abs(vymax - vymin);\r\n        const rgbImg = generateImage(image), img = generateImage(texture);\r\n        // const geometry = new THREE.PlaneBufferGeometry(w, h, imageWidth - 1, imageHeight - 1);\r\n        const geometry = getPlaneGeometry(w, h, imageWidth - 1, imageHeight - 1);\r\n        super();\r\n        this._initOptions(options);\r\n        this._createMesh(geometry, material);\r\n        const z = layer.distanceToVector3(altitude, altitude).x;\r\n        const v = layer.coordinateToVector3(extent.getCenter(), z);\r\n        this.getObject3d().position.copy(v);\r\n        material.transparent = true;\r\n        if (rgbImg) {\r\n            material.opacity = 0;\r\n            rgbImg.onload = () => {\r\n                const width = imageWidth, height = imageHeight;\r\n                const imgdata = getRGBData(rgbImg, width, height);\r\n                let idx = 0;\r\n                const cache = {};\r\n                //rgb to height  https://docs.mapbox.com/help/troubleshooting/access-elevation-data/\r\n                for (let i = 0, len = imgdata.length; i < len; i += 4) {\r\n                    const R = imgdata[i], G = imgdata[i + 1], B = imgdata[i + 2];\r\n                    const height = -10000 + ((R * 256 * 256 + G * 256 + B) * 0.1);\r\n                    const z = distanceToVector3(height, layer, cache);\r\n                    geometry.attributes.position.array[idx * 3 + 2] = z;\r\n                    idx++;\r\n                }\r\n                geometry.attributes.position.needsUpdate = true;\r\n                if (img) {\r\n                    textureLoader.load(img.src, (texture) => {\r\n                        material.map = texture;\r\n                        material.opacity = 1;\r\n                        material.needsUpdate = true;\r\n                    });\r\n                }\r\n                else {\r\n                    material.opacity = 1;\r\n                }\r\n            };\r\n            rgbImg.onerror = function () {\r\n                console.error(`not load ${rgbImg.src}`);\r\n            };\r\n        }\r\n        this.type = 'Terrain';\r\n    }\r\n}\r\nexport default Terrain;\r\n//# sourceMappingURL=Terrain.js.map","import * as maptalks from 'maptalks';\r\nimport Terrain from './Terrain';\r\nimport BaseVectorTileLayer from './BaseVectorTileLayer';\r\nconst OPTIONS = {\r\n    // worker: false\r\n    scale: 1,\r\n    tileDivisor: 4\r\n};\r\n/**\r\n *\r\n */\r\nclass TerrainVectorTileLayer extends BaseVectorTileLayer {\r\n    constructor(url, options = {}, material, layer) {\r\n        super(maptalks.Util.GUID(), maptalks.Util.extend({ urlTemplate: url }, OPTIONS, options));\r\n        this._opts = options;\r\n        this._layer = layer;\r\n        this.material = material;\r\n        this._baseObjectKeys = {};\r\n        this._loadTiles = {};\r\n        this._add = null;\r\n        this._imgQueue = {};\r\n        this._layerLaodTime = new Date().getTime();\r\n        this._init();\r\n    }\r\n    isAsynchronous() {\r\n        return false;\r\n    }\r\n    /**\r\n     * this is can override\r\n     * @param {*} index\r\n     * @param {*} json\r\n     */\r\n    formatBaseObjects(index, image) {\r\n        const opts = this.options, baseobjects = [];\r\n        const { scale, tileDivisor } = opts;\r\n        const { x, y, z } = this._getXYZOfIndex(index);\r\n        const zoom = this.getMap().getZoom();\r\n        const texture = this.getTileUrl(x, y, z);\r\n        const [imageWidth, imageHeight] = this.options.tileSize;\r\n        const extent = this._getTileLngLatExtent(x, y, z);\r\n        const material = this.material.clone();\r\n        if ((z + 1) >= Math.round(zoom)) {\r\n            const terrain = new Terrain(extent, {\r\n                image,\r\n                imageWidth: imageWidth / tileDivisor,\r\n                imageHeight: imageHeight / tileDivisor,\r\n                texture\r\n            }, material, this._layer);\r\n            terrain.getObject3d().scale.set(scale, scale, 1);\r\n            baseobjects.push(terrain);\r\n        }\r\n        return baseobjects;\r\n    }\r\n    //queue loop\r\n    loopMessage(q) {\r\n        this.getTileData(q);\r\n    }\r\n    _init() {\r\n        this.on('layerload', this._layerOnLoad);\r\n        this.on('add', () => {\r\n            if (this._add === false) {\r\n                const baseobjects = this.getBaseObjects();\r\n                this._layer.addMesh(baseobjects);\r\n            }\r\n            this._add = true;\r\n            /**\r\n             * layerload have a bug ,Sometimes it doesn't trigger,I don't know why\r\n             * Add heartbeat detection mechanism\r\n             */\r\n            this.intervalId = setInterval(() => {\r\n                if (this._isLoad() && (!this._layer.getMap().isInteracting())) {\r\n                    this.fire('layerload');\r\n                }\r\n            }, 1000);\r\n        });\r\n        this.on('remove', () => {\r\n            this._add = false;\r\n            const baseobjects = this.getBaseObjects();\r\n            this._layer.removeMesh(baseobjects);\r\n            clearInterval(this.intervalId);\r\n        });\r\n        this.on('show', () => {\r\n            const baseobjects = this.getBaseObjects();\r\n            baseobjects.forEach(baseobject => {\r\n                baseobject.show();\r\n            });\r\n            for (let key in this._baseObjectKeys) {\r\n                const baseobjects = this._baseObjectKeys[key] || [];\r\n                baseobjects.forEach(baseobject => {\r\n                    baseobject.show();\r\n                });\r\n            }\r\n        });\r\n        this.on('hide', () => {\r\n            const baseobjects = this.getBaseObjects();\r\n            baseobjects.forEach(baseobject => {\r\n                baseobject.hide();\r\n            });\r\n            for (let key in this._baseObjectKeys) {\r\n                const baseobjects = this._baseObjectKeys[key] || [];\r\n                baseobjects.forEach(baseobject => {\r\n                    baseobject.hide();\r\n                });\r\n            }\r\n        });\r\n        this.on('renderercreate', (e) => {\r\n            e.renderer.loadTile = function loadTile(tile) {\r\n                var tileSize = this.layer.getTileSize();\r\n                var tileImage = new Image();\r\n                tileImage.width = tileSize['width'];\r\n                tileImage.height = tileSize['height'];\r\n                tileImage.onload = this.onTileLoad.bind(this, tileImage, tile);\r\n                tileImage.onerror = this.onTileError.bind(this, tileImage, tile);\r\n                this.loadTileImage(tileImage, tile['url'], tile.id);\r\n                return tileImage;\r\n            };\r\n            e.renderer.deleteTile = (tile) => {\r\n                if (!tile || !tile.image) {\r\n                    return;\r\n                }\r\n                tile.image.onload = null;\r\n                tile.image.onerror = null;\r\n                const tileinfo = tile.info || {};\r\n                const rgbImage = this._imgQueue[tileinfo.id];\r\n                if (rgbImage) {\r\n                    rgbImage.src = '';\r\n                    rgbImage.onload = null;\r\n                    rgbImage.onerror = null;\r\n                    delete this._imgQueue[tileinfo.id];\r\n                }\r\n            };\r\n            e.renderer.loadTileImage = (img, url, key) => {\r\n                img._key = key;\r\n                const rgbImage = new Image();\r\n                this._imgQueue[key] = rgbImage;\r\n                const q = {\r\n                    key,\r\n                    url,\r\n                    rgbImage,\r\n                    callback: (index, rgbImage, image) => {\r\n                        this._generateBaseObjects(index, rgbImage, image);\r\n                    },\r\n                    img,\r\n                    vt: this\r\n                };\r\n                this.loopMessage(q);\r\n            };\r\n        });\r\n    }\r\n}\r\nexport default TerrainVectorTileLayer;\r\n//# sourceMappingURL=TerrainVectorTileLayer.js.map","/*!\r\n * Code from baidu mapv\r\n * License: BSD-3\r\n * https://github.com/huiyan-fe/mapv\r\n *\r\n */\r\n/* eslint-disable no-trailing-spaces */\r\n/**\r\n * https://github.com/huiyan-fe/mapv/blob/master/src/utils/data-range/Intensity.js\r\n * @author kyle / http://nikai.us/\r\n */\r\nimport { createCanvas } from './../CanvasUtil';\r\n/**\r\n * Category\r\n * @param {Object} [options]   Available options:\r\n *                             {Object} gradient: { 0.25: \"rgb(0,0,255)\", 0.55: \"rgb(0,255,0)\", 0.85: \"yellow\", 1.0: \"rgb(255,0,0)\"}\r\n */\r\nfunction Intensity(options) {\r\n    options = options || {};\r\n    this.gradient = options.gradient || {\r\n        0.25: 'rgba(0, 0, 255, 1)',\r\n        0.55: 'rgba(0, 255, 0, 1)',\r\n        0.85: 'rgba(255, 255, 0, 1)',\r\n        1.0: 'rgba(255, 0, 0, 1)'\r\n    };\r\n    this.maxSize = options.maxSize || 35;\r\n    this.minSize = options.minSize || 0;\r\n    this.max = options.max || 100;\r\n    this.min = options.min || 0;\r\n    this.initPalette();\r\n}\r\nIntensity.prototype.setMax = function (value) {\r\n    this.max = value || 100;\r\n};\r\nIntensity.prototype.setMin = function (value) {\r\n    this.min = value || 0;\r\n};\r\nIntensity.prototype.setMaxSize = function (maxSize) {\r\n    this.maxSize = maxSize || 35;\r\n};\r\nIntensity.prototype.setMinSize = function (minSize) {\r\n    this.minSize = minSize || 0;\r\n};\r\nIntensity.prototype.initPalette = function () {\r\n    var gradient = this.gradient;\r\n    var canvas = createCanvas(256, 1);\r\n    var paletteCtx = this.paletteCtx = canvas.getContext('2d');\r\n    var lineGradient = paletteCtx.createLinearGradient(0, 0, 256, 1);\r\n    for (var key in gradient) {\r\n        lineGradient.addColorStop(parseFloat(key), gradient[key]);\r\n    }\r\n    paletteCtx.fillStyle = lineGradient;\r\n    paletteCtx.fillRect(0, 0, 256, 1);\r\n};\r\nIntensity.prototype.getColor = function (value) {\r\n    var imageData = this.getImageData(value);\r\n    return 'rgba(' + imageData[0] + ', ' + imageData[1] + ', ' + imageData[2] + ', ' + imageData[3] / 256 + ')';\r\n};\r\nIntensity.prototype.getImageData = function (value) {\r\n    var imageData = this.paletteCtx.getImageData(0, 0, 256, 1).data;\r\n    if (value === undefined) {\r\n        return imageData;\r\n    }\r\n    var max = this.max;\r\n    var min = this.min;\r\n    if (value > max) {\r\n        value = max;\r\n    }\r\n    if (value < min) {\r\n        value = min;\r\n    }\r\n    var index = Math.floor((value - min) / (max - min) * (256 - 1)) * 4;\r\n    return [imageData[index], imageData[index + 1], imageData[index + 2], imageData[index + 3]];\r\n};\r\n/**\r\n * @param Number value\r\n * @param Number max of value\r\n * @param Number max of size\r\n * @param Object other options\r\n */\r\nIntensity.prototype.getSize = function (value) {\r\n    var size = 0;\r\n    var max = this.max;\r\n    var min = this.min;\r\n    var maxSize = this.maxSize;\r\n    var minSize = this.minSize;\r\n    if (value > max) {\r\n        value = max;\r\n    }\r\n    if (value < min) {\r\n        value = min;\r\n    }\r\n    if (max > min) {\r\n        size = minSize + (value - min) / (max - min) * (maxSize - minSize);\r\n    }\r\n    else {\r\n        return maxSize;\r\n    }\r\n    return size;\r\n};\r\nIntensity.prototype.getLegend = function (options) {\r\n    var gradient = this.gradient;\r\n    var width = options.width || 20;\r\n    var height = options.height || 180;\r\n    var canvas = createCanvas(width, height);\r\n    var paletteCtx = canvas.getContext('2d');\r\n    var lineGradient = paletteCtx.createLinearGradient(0, height, 0, 0);\r\n    for (var key in gradient) {\r\n        lineGradient.addColorStop(parseFloat(key), gradient[key]);\r\n    }\r\n    paletteCtx.fillStyle = lineGradient;\r\n    paletteCtx.fillRect(0, 0, width, height);\r\n    return canvas;\r\n};\r\nexport default Intensity;\r\n//# sourceMappingURL=Intensity.js.map","/*!\r\n * Code from baidu mapv\r\n * License: BSD-3\r\n * https://github.com/huiyan-fe/mapv\r\n *\r\n */\r\n/**\r\n * https://github.com/huiyan-fe/mapv/blob/master/src/canvas/draw/heatmap.js\r\n */\r\nimport { createCanvas } from './../CanvasUtil';\r\nimport Intensity from './Intensity';\r\nfunction createCircle(size) {\r\n    var shadowBlur = size / 2;\r\n    var r2 = size + shadowBlur;\r\n    var offsetDistance = 10000;\r\n    var circle = createCanvas(r2 * 2, r2 * 2);\r\n    var context = circle.getContext('2d');\r\n    context.shadowBlur = shadowBlur;\r\n    context.shadowColor = 'black';\r\n    context.shadowOffsetX = context.shadowOffsetY = offsetDistance;\r\n    context.beginPath();\r\n    context.arc(r2 - offsetDistance, r2 - offsetDistance, size, 0, Math.PI * 2, true);\r\n    context.closePath();\r\n    context.fill();\r\n    return circle;\r\n}\r\nfunction colorize(pixels, gradient, options) {\r\n    var max = getMax(options);\r\n    var min = getMin(options);\r\n    var diff = max - min;\r\n    var range = options.range || null;\r\n    var jMin = 0;\r\n    var jMax = 1024;\r\n    if (range && range.length === 2) {\r\n        jMin = (range[0] - min) / diff * 1024;\r\n    }\r\n    if (range && range.length === 2) {\r\n        jMax = (range[1] - min) / diff * 1024;\r\n    }\r\n    var maxOpacity = options.maxOpacity || 0.8;\r\n    var minOpacity = options.minOpacity || 0;\r\n    // var range = options.range;\r\n    for (var i = 3, len = pixels.length, j; i < len; i += 4) {\r\n        j = pixels[i] * 4; // get gradient color from opacity value\r\n        if (pixels[i] / 256 > maxOpacity) {\r\n            pixels[i] = 256 * maxOpacity;\r\n        }\r\n        if (pixels[i] / 256 < minOpacity) {\r\n            pixels[i] = 256 * minOpacity;\r\n        }\r\n        if (j && j >= jMin && j <= jMax) {\r\n            pixels[i - 3] = gradient[j];\r\n            pixels[i - 2] = gradient[j + 1];\r\n            pixels[i - 1] = gradient[j + 2];\r\n        }\r\n        else {\r\n            pixels[i] = 0;\r\n        }\r\n    }\r\n}\r\nfunction getMax(options) {\r\n    var max = options.max || 100;\r\n    return max;\r\n}\r\nfunction getMin(options) {\r\n    var min = options.min || 0;\r\n    return min;\r\n}\r\nfunction drawGray(context, dataSet, options) {\r\n    var max = getMax(options);\r\n    // var min = getMin(options);\r\n    // console.log(max)\r\n    var size = options._size || options.size || 13;\r\n    var circle = createCircle(size);\r\n    var circleHalfWidth = circle.width / 2;\r\n    var circleHalfHeight = circle.height / 2;\r\n    var data = dataSet;\r\n    var dataOrderByAlpha = {};\r\n    data.forEach(function (item) {\r\n        var count = item.count === undefined ? 1 : item.count;\r\n        var alpha = Math.min(1, count / max).toFixed(2);\r\n        dataOrderByAlpha[alpha] = dataOrderByAlpha[alpha] || [];\r\n        dataOrderByAlpha[alpha].push(item);\r\n    });\r\n    for (var i in dataOrderByAlpha) {\r\n        if (isNaN(i))\r\n            continue;\r\n        var _data = dataOrderByAlpha[i];\r\n        context.beginPath();\r\n        if (!options.withoutAlpha) {\r\n            context.globalAlpha = i;\r\n        }\r\n        // context.strokeStyle = intensity.getColor(i * max);\r\n        _data.forEach(function (item) {\r\n            var coordinates = item.coordinate;\r\n            var count = item.count === undefined ? 1 : item.count;\r\n            context.globalAlpha = count / max;\r\n            context.drawImage(circle, coordinates[0] - circleHalfWidth, coordinates[1] - circleHalfHeight);\r\n        });\r\n    }\r\n}\r\nfunction draw(context, data, options) {\r\n    if (context.canvas.width <= 0 || context.canvas.height <= 0) {\r\n        return;\r\n    }\r\n    var strength = options.strength || 0.3;\r\n    context.strokeStyle = 'rgba(0,0,0,' + strength + ')';\r\n    // var shadowCanvas = new Canvas(context.canvas.width, context.canvas.height);\r\n    var shadowCanvas = createCanvas(context.canvas.width, context.canvas.height);\r\n    var shadowContext = shadowCanvas.getContext('2d');\r\n    shadowContext.scale(devicePixelRatio, devicePixelRatio);\r\n    options = options || {};\r\n    // var data = dataSet instanceof DataSet ? dataSet.get() : dataSet;\r\n    context.save();\r\n    var intensity = new Intensity({\r\n        gradient: options.gradient\r\n    });\r\n    drawGray(shadowContext, data, options);\r\n    // return false;\r\n    if (!options.absolute) {\r\n        var colored = shadowContext.getImageData(0, 0, context.canvas.width, context.canvas.height);\r\n        colorize(colored.data, intensity.getImageData(), options);\r\n        context.putImageData(colored, 0, 0);\r\n        context.restore();\r\n    }\r\n    intensity = null;\r\n    shadowCanvas = null;\r\n}\r\nexport default {\r\n    draw,\r\n    drawGray,\r\n    colorize\r\n};\r\n//# sourceMappingURL=HeatMapUtil.js.map","import * as maptalks from 'maptalks';\r\nimport * as THREE from 'three';\r\nimport BaseObject from './BaseObject';\r\nimport HeatMapUitl from './util/heatmap/HeatMapUtil';\r\nimport { createCanvas } from './util/CanvasUtil';\r\nimport Intensity from './util/heatmap/Intensity';\r\nimport { addAttribute, getVertexColors } from './util/ThreeAdaptUtil';\r\nimport { getPlaneGeometry } from './util/GeometryUtil';\r\nconst OPTIONS = {\r\n    altitude: 0,\r\n    interactive: false,\r\n    min: 0,\r\n    max: 100,\r\n    size: 13,\r\n    gradient: { 0.25: 'rgb(0,0,255)', 0.55: 'rgb(0,255,0)', 0.85: 'yellow', 1.0: 'rgb(255,0,0)' },\r\n    gridScale: 0.5\r\n};\r\nconst CANVAS_MAX_SIZE = 2048;\r\n/**\r\n *\r\n */\r\nclass HeatMap extends BaseObject {\r\n    constructor(data, options, material, layer) {\r\n        if (!Array.isArray(data)) {\r\n            data = [data];\r\n        }\r\n        let minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;\r\n        const vs = [];\r\n        //Calculate bbox\r\n        for (let i = 0, len = data.length; i < len; i++) {\r\n            const { coordinate, lnglat, xy } = data[i];\r\n            const coord = coordinate || lnglat || xy;\r\n            if (!coord) {\r\n                console.warn('not find coordinate');\r\n                continue;\r\n            }\r\n            const v = layer.coordinateToVector3(coord);\r\n            vs.push(v);\r\n            const { x, y } = v;\r\n            minX = Math.min(minX, x);\r\n            minY = Math.min(minY, y);\r\n            maxX = Math.max(maxX, x);\r\n            maxY = Math.max(maxY, y);\r\n        }\r\n        options = maptalks.Util.extend({}, OPTIONS, options, { layer, points: data });\r\n        // Calculate canvas width and height\r\n        let { gridScale, altitude } = options;\r\n        const offsetX = Math.abs(maxX - minX), offsetY = Math.abs(maxY - minY);\r\n        const maxOffset = Math.max((offsetX * gridScale), (offsetY * gridScale));\r\n        if (maxOffset > CANVAS_MAX_SIZE) {\r\n            console.warn(`gridScale: ${gridScale} it's too big. I hope it's a smaller value,canvas max size is ${CANVAS_MAX_SIZE}* ${CANVAS_MAX_SIZE}`);\r\n            const offset = maxOffset / gridScale;\r\n            gridScale = CANVAS_MAX_SIZE / offset;\r\n        }\r\n        const canvasWidth = Math.ceil(offsetX * gridScale), canvasHeight = Math.ceil(offsetY * gridScale);\r\n        const scaleX = canvasWidth / offsetX, scaleY = canvasHeight / offsetY;\r\n        const pixels = [];\r\n        for (let i = 0, len = vs.length; i < len; i++) {\r\n            const v = vs[i];\r\n            v.x -= minX;\r\n            v.y -= minY;\r\n            v.x *= scaleX;\r\n            v.y *= scaleY;\r\n            v.y = canvasHeight - v.y;\r\n            //for heat draw data\r\n            pixels.push({\r\n                coordinate: [v.x, v.y],\r\n                count: data[i].count\r\n            });\r\n        }\r\n        let shadowCanvas = createCanvas(canvasWidth, canvasHeight);\r\n        let shadowContext = shadowCanvas.getContext('2d');\r\n        // shadowContext.scale(devicePixelRatio, devicePixelRatio);\r\n        HeatMapUitl.drawGray(shadowContext, pixels, options);\r\n        const colored = shadowContext.getImageData(0, 0, shadowContext.canvas.width, shadowContext.canvas.height);\r\n        let maxAlpha = -Infinity;\r\n        const blackps = new Float32Array(colored.data.length / 4), alphas = new Float32Array(colored.data.length / 4);\r\n        for (let i = 3, len = colored.data.length, j = 0; i < len; i += 4) {\r\n            const alpha = colored.data[i];\r\n            maxAlpha = Math.max(maxAlpha, alpha);\r\n            alphas[j] = alpha;\r\n            //Points that do not need to be drawn\r\n            if (alpha <= 0) {\r\n                blackps[j] = 1;\r\n            }\r\n            j++;\r\n        }\r\n        const intensity = new Intensity({\r\n            gradient: options.gradient\r\n        });\r\n        HeatMapUitl.colorize(colored.data, intensity.getImageData(), options);\r\n        shadowCanvas = null;\r\n        shadowContext = null;\r\n        // const geometry = new THREE.PlaneBufferGeometry(offsetX, offsetY, canvasWidth - 1, canvasHeight - 1);\r\n        const geometry = getPlaneGeometry(offsetX, offsetY, canvasWidth - 1, canvasHeight - 1);\r\n        const index = geometry.getIndex().array;\r\n        const position = geometry.attributes.position.array;\r\n        // Index of the points that really need to be drawn\r\n        const colors = new Float32Array(position.length);\r\n        const tempIndex = new Uint32Array(position.length * 6);\r\n        const color = new THREE.Color();\r\n        let iIndex = 0;\r\n        for (let i = 0, len = position.length, j = 0, len1 = index.length, m = 0, len2 = colored.data.length, n = 0; i < Math.max(len, len1, len2); i += 3) {\r\n            if (i < len) {\r\n                const alpha = alphas[n];\r\n                if (alpha > 0) {\r\n                    position[i + 2] = alpha / maxAlpha;\r\n                }\r\n            }\r\n            if (j < len1) {\r\n                const a = index[j], b = index[j + 1], c = index[j + 2];\r\n                if ((!blackps[a]) || (!blackps[b]) || (!blackps[c])) {\r\n                    tempIndex[iIndex] = a;\r\n                    tempIndex[iIndex + 1] = b;\r\n                    tempIndex[iIndex + 2] = c;\r\n                    iIndex += 3;\r\n                }\r\n            }\r\n            if (m < len2) {\r\n                const r = colored.data[m], g = colored.data[m + 1], b = colored.data[m + 2]; // a = colored.data[i + 3];\r\n                const rgb = `rgb(${r},${g},${b})`;\r\n                color.setStyle(rgb);\r\n                colors[j] = color.r;\r\n                colors[j + 1] = color.g;\r\n                colors[j + 2] = color.b;\r\n            }\r\n            j += 3;\r\n            m += 4;\r\n            n++;\r\n        }\r\n        const filterIndex = new Uint32Array(iIndex);\r\n        for (let i = 0; i < iIndex; i++) {\r\n            filterIndex[i] = tempIndex[i];\r\n        }\r\n        geometry.setIndex(new THREE.BufferAttribute(filterIndex, 1));\r\n        addAttribute(geometry, 'color', new THREE.BufferAttribute(colors, 3, true));\r\n        material.vertexColors = getVertexColors();\r\n        super();\r\n        this._initOptions(options);\r\n        this._createMesh(geometry, material);\r\n        const z = layer.distanceToVector3(altitude, altitude).x;\r\n        this.getObject3d().position.copy(new THREE.Vector3((minX + maxX) / 2, (minY + maxY) / 2, z));\r\n        this.type = 'HeatMap';\r\n    }\r\n}\r\nexport default HeatMap;\r\n//# sourceMappingURL=HeatMap.js.map","import * as THREE from 'three';\r\nconst color = new THREE.Color();\r\nlet colorIndex = 1;\r\n/**\r\n *https://github.com/mrdoob/three.js/blob/master/examples/webgl_interactive_cubes_gpu.html\r\n */\r\nclass GPUPick {\r\n    constructor(layer) {\r\n        this.object3ds = [];\r\n        this.layer = layer;\r\n        this.camera = layer.getCamera();\r\n        this.renderer = layer.getThreeRenderer();\r\n        this.pickingTexture = new THREE.WebGLRenderTarget(1, 1);\r\n        this.pickingScene = new THREE.Scene();\r\n    }\r\n    getColor() {\r\n        color.setHex(colorIndex);\r\n        colorIndex++;\r\n        return color;\r\n    }\r\n    add(object3d) {\r\n        if (object3d) {\r\n            const colorIndex = object3d['_colorIndex'];\r\n            if (colorIndex) {\r\n                this.object3ds[colorIndex] = object3d;\r\n                this.pickingScene.add(object3d);\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n    remove(object3d) {\r\n        if (object3d) {\r\n            const colorIndex = object3d['_colorIndex'];\r\n            if (colorIndex) {\r\n                this.object3ds[colorIndex] = null;\r\n                this.pickingScene.remove(object3d);\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n    isEmpty() {\r\n        if (this.pickingScene.children.length === 0) {\r\n            return true;\r\n        }\r\n        for (let i = 0, len = this.pickingScene.children.length; i < len; i++) {\r\n            const mesh = this.pickingScene.children[i];\r\n            if (mesh) {\r\n                const object3d = mesh['__parent'];\r\n                if (object3d && object3d.getOptions().interactive === true) {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n    pick(pixel) {\r\n        if (!pixel) {\r\n            return;\r\n        }\r\n        if (this.isEmpty()) {\r\n            return;\r\n        }\r\n        const { camera, renderer, pickingTexture, pickingScene, object3ds, layer } = this;\r\n        const len = this.pickingScene.children.length;\r\n        // reset all object3d picked\r\n        for (let i = 0; i < len; i++) {\r\n            const object3d = this.pickingScene.children[i];\r\n            if (object3d && object3d['__parent']) {\r\n                object3d['__parent'].picked = false;\r\n            }\r\n        }\r\n        //resize size\r\n        const { width, height } = layer._getRenderer().canvas;\r\n        const pw = pickingTexture.width, ph = pickingTexture.height;\r\n        if (width !== pw || height !== ph) {\r\n            pickingTexture.setSize(width, height);\r\n        }\r\n        //render the picking scene off-screen\r\n        // set the view offset to represent just a single pixel under the mouse\r\n        // camera.setViewOffset(width, height, mouse.x, mouse.y, 1, 1);\r\n        // render the scene\r\n        renderer.setRenderTarget(pickingTexture);\r\n        renderer.clear();\r\n        renderer.render(pickingScene, camera);\r\n        // clear the view offset so rendering returns to normal\r\n        // camera.clearViewOffset();\r\n        //create buffer for reading single pixel\r\n        const pixelBuffer = new Uint8Array(4);\r\n        //read the pixel\r\n        const { x, y } = pixel;\r\n        const devicePixelRatio = window.devicePixelRatio;\r\n        const offsetX = (x * devicePixelRatio), offsetY = (pickingTexture.height - y * devicePixelRatio);\r\n        renderer.readRenderTargetPixels(pickingTexture, Math.round(offsetX), Math.round(offsetY), 1, 1, pixelBuffer);\r\n        //interpret the pixel as an ID\r\n        const id = (pixelBuffer[0] << 16) | (pixelBuffer[1] << 8) | (pixelBuffer[2]);\r\n        const object3d = object3ds[id];\r\n        if (object3d) {\r\n            if (object3d['__parent']) {\r\n                object3ds[id]['__parent'].picked = true;\r\n            }\r\n        }\r\n        else {\r\n            //for merged mesh\r\n            for (let i = 0; i < len; i++) {\r\n                const object3d = this.pickingScene.children[i];\r\n                if (object3d && object3d['__parent']) {\r\n                    const parent = object3d['__parent'];\r\n                    if (parent._colorMap && parent._colorMap[id] != null) {\r\n                        parent.picked = true;\r\n                        parent.index = parent._colorMap[id];\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        renderer.setRenderTarget(null);\r\n    }\r\n}\r\nexport default GPUPick;\r\n//# sourceMappingURL=GPUPick.js.map","import * as maptalks from 'maptalks';\r\nimport * as THREE from 'three';\r\nimport BaseObject from './BaseObject';\r\nimport { getLinePosition, getLineSegmentPosition, LineStringSplit, mergeLinePositions } from './util/LineUtil';\r\nimport LineGeometry from './util/fatline/LineGeometry';\r\nimport Line2 from './util/fatline/Line2';\r\nimport LineMaterial from './util/fatline/LineMaterial';\r\nimport { getVertexColors } from './util/ThreeAdaptUtil';\r\nimport { setBottomHeight } from './util';\r\nimport { FatLineTaskIns } from './BaseObjectTaskManager';\r\nconst OPTIONS = {\r\n    bottomHeight: 0,\r\n    altitude: 0\r\n};\r\nclass FatLine extends BaseObject {\r\n    constructor(lineString, options, material, layer) {\r\n        options = maptalks.Util.extend({}, OPTIONS, options, { layer, lineString });\r\n        super();\r\n        this._initOptions(options);\r\n        const { asynchronous } = options;\r\n        const { lineStrings, center } = LineStringSplit(lineString);\r\n        const geometry = new LineGeometry();\r\n        let position;\r\n        if (asynchronous) {\r\n            const id = maptalks.Util.GUID();\r\n            this.getOptions().id = id;\r\n            this.getOptions().center = center;\r\n            FatLineTaskIns.push({\r\n                id,\r\n                data: lineStrings,\r\n                lineString,\r\n                center,\r\n                layer,\r\n                baseObject: this\r\n            });\r\n        }\r\n        else {\r\n            const positionList = [], cache = {};\r\n            for (let m = 0, le = lineStrings.length; m < le; m++) {\r\n                const positions = getLinePosition(lineStrings[m], layer, center, false).positions;\r\n                setBottomHeight(positions, options.bottomHeight, layer, cache);\r\n                positionList.push(getLineSegmentPosition(positions));\r\n            }\r\n            position = mergeLinePositions(positionList);\r\n            geometry.setPositions(position);\r\n        }\r\n        this._setMaterialRes(layer, material);\r\n        this._createLine2(geometry, material);\r\n        const { altitude } = options;\r\n        const z = layer.distanceToVector3(altitude, altitude).x;\r\n        const v = layer.coordinateToVector3(center, z);\r\n        this.getObject3d().position.copy(v);\r\n        if (!asynchronous) {\r\n            this._setPickObject3d(position, material.linewidth);\r\n            this._init();\r\n        }\r\n        this.type = 'FatLine';\r\n    }\r\n    _init() {\r\n        const pick = this.getLayer().getPick();\r\n        this.on('add', () => {\r\n            pick.add(this.pickObject3d);\r\n        });\r\n        this.on('remove', () => {\r\n            pick.remove(this.pickObject3d);\r\n        });\r\n    }\r\n    _setMaterialRes(layer, material) {\r\n        const map = layer.getMap();\r\n        const size = map.getSize();\r\n        const width = size.width, height = size.height;\r\n        material.resolution.set(width, height);\r\n    }\r\n    _setPickObject3d(ps, linewidth) {\r\n        // if (!this._colorMap) {\r\n        //     return;\r\n        // }\r\n        const geometry = new LineGeometry();\r\n        geometry.setPositions(ps);\r\n        const pick = this.getLayer().getPick();\r\n        const color = pick.getColor();\r\n        const colors = [];\r\n        for (let i = 0, len = ps.length / 3; i < len; i++) {\r\n            colors.push(color.r, color.g, color.b);\r\n        }\r\n        geometry.setColors(colors);\r\n        const material = new LineMaterial({\r\n            color: '#fff',\r\n            // side: THREE.BackSide,\r\n            linewidth,\r\n            vertexColors: getVertexColors()\r\n        });\r\n        this._setMaterialRes(this.getLayer(), material);\r\n        const colorIndex = color.getHex();\r\n        const mesh = new Line2(geometry, material);\r\n        mesh.position.copy(this.getObject3d().position);\r\n        mesh._colorIndex = colorIndex;\r\n        this.setPickObject3d(mesh);\r\n    }\r\n    // eslint-disable-next-line no-unused-vars\r\n    identify(coordinate) {\r\n        return this.picked;\r\n    }\r\n    setSymbol(material) {\r\n        if (material && material instanceof THREE.Material) {\r\n            material.needsUpdate = true;\r\n            const size = this.getMap().getSize();\r\n            const width = size.width, height = size.height;\r\n            material.resolution.set(width, height);\r\n            this.getObject3d().material = material;\r\n        }\r\n        return this;\r\n    }\r\n    _workerLoad(result) {\r\n        const position = new Float32Array(result.position);\r\n        const object3d = this.getObject3d();\r\n        object3d.geometry.setPositions(position);\r\n        object3d.computeLineDistances();\r\n        this._setPickObject3d(position, object3d.material.linewidth);\r\n        this._init();\r\n        if (this.isAdd) {\r\n            const pick = this.getLayer().getPick();\r\n            pick.add(this.pickObject3d);\r\n        }\r\n        this._fire('workerload', { target: this });\r\n    }\r\n}\r\nexport default FatLine;\r\n//# sourceMappingURL=FatLine.js.map","import * as maptalks from 'maptalks';\r\nimport * as THREE from 'three';\r\nimport BaseObject from './BaseObject';\r\nimport { getLinePosition, getLineSegmentPosition, LineStringSplit, mergeLinePositions } from './util/LineUtil';\r\nimport MergedMixin from './MergedMixin';\r\nimport FatLine from './FatLine';\r\nimport { isGeoJSONLine } from './util/GeoJSONUtil';\r\nimport LineGeometry from './util/fatline/LineGeometry';\r\nimport Line2 from './util/fatline/Line2';\r\nimport LineMaterial from './util/fatline/LineMaterial';\r\nimport { getCenterOfPoints, getGeometriesColorArray, setBottomHeight } from './util';\r\nimport { getVertexColors } from './util/ThreeAdaptUtil';\r\nimport { FatLinesTaskIns } from './BaseObjectTaskManager';\r\nconst OPTIONS = {\r\n    altitude: 0,\r\n    colors: null\r\n};\r\n/**\r\n *\r\n */\r\nclass FatLines extends MergedMixin(BaseObject) {\r\n    constructor(lineStrings, options, material, layer) {\r\n        if (!Array.isArray(lineStrings)) {\r\n            lineStrings = [lineStrings];\r\n        }\r\n        const centers = [], lineStringList = [];\r\n        const len = lineStrings.length;\r\n        for (let i = 0; i < len; i++) {\r\n            const lineString = lineStrings[i];\r\n            const result = LineStringSplit(lineString);\r\n            centers.push(result.center);\r\n            lineStringList.push(result.lineStrings);\r\n        }\r\n        // Get the center point of the point set\r\n        const center = getCenterOfPoints(centers);\r\n        options = maptalks.Util.extend({}, OPTIONS, options, { layer, lineStrings, coordinate: center });\r\n        super();\r\n        this._initOptions(options);\r\n        const { asynchronous } = options;\r\n        const geometry = new LineGeometry();\r\n        const lines = [], cache = {};\r\n        let faceIndex = 0, faceMap = [], geometriesAttributes = [], psIndex = 0, positionList = [];\r\n        let position;\r\n        let newPosition;\r\n        if (asynchronous) {\r\n            FatLinesTaskIns.push({\r\n                id: maptalks.Util.GUID(),\r\n                data: lineStringList,\r\n                key: options.key,\r\n                center,\r\n                layer,\r\n                baseObject: this,\r\n                lineStrings\r\n            });\r\n        }\r\n        else {\r\n            //LineSegmentsGeometry\r\n            for (let i = 0; i < len; i++) {\r\n                const lls = lineStringList[i];\r\n                let psCount = 0;\r\n                for (let m = 0, le = lls.length; m < le; m++) {\r\n                    const properties = (isGeoJSONLine(lls[m]) ? lls[m]['properties'] : lls[m].getProperties() || {});\r\n                    const { positions } = getLinePosition(lls[m], layer, center, false);\r\n                    setBottomHeight(positions, properties.bottomHeight, layer, cache);\r\n                    psCount += (positions.length / 3 * 2 - 2);\r\n                    positionList.push(getLineSegmentPosition(positions));\r\n                }\r\n                // const psCount = positionsV.length + positionsV.length - 2;\r\n                const faceLen = psCount;\r\n                // faceMap[i] = [faceIndex, faceIndex + faceLen];\r\n                faceIndex += faceLen;\r\n                geometriesAttributes[i] = {\r\n                    position: {\r\n                        count: psCount,\r\n                        start: psIndex,\r\n                        end: psIndex + psCount * 3,\r\n                    },\r\n                    instanceStart: {\r\n                        count: psCount,\r\n                        start: psIndex,\r\n                        end: psIndex + psCount * 3,\r\n                    },\r\n                    instanceEnd: {\r\n                        count: psCount,\r\n                        start: psIndex,\r\n                        end: psIndex + psCount * 3,\r\n                    },\r\n                    hide: false\r\n                };\r\n                psIndex += psCount * 3;\r\n            }\r\n            position = mergeLinePositions(positionList);\r\n            geometry.setPositions(position);\r\n        }\r\n        this._setMaterialRes(layer, material);\r\n        this._createLine2(geometry, material);\r\n        const { altitude } = options;\r\n        const z = layer.distanceToVector3(altitude, altitude).x;\r\n        const v = layer.coordinateToVector3(center, z);\r\n        this.getObject3d().position.copy(v);\r\n        // this._faceMap = faceMap;\r\n        this._baseObjects = lines;\r\n        this._datas = lineStrings;\r\n        this._geometriesAttributes = geometriesAttributes;\r\n        this.faceIndex = null;\r\n        this.index = null;\r\n        this._geometryCache = new LineGeometry();\r\n        if (!asynchronous) {\r\n            newPosition = new Float32Array(position);\r\n            this._geometryCache.setPositions(newPosition);\r\n        }\r\n        this._colorMap = {};\r\n        this.isHide = false;\r\n        this._initBaseObjectsEvent(lines);\r\n        if (!asynchronous) {\r\n            this._setPickObject3d(newPosition, material.linewidth);\r\n            this._init();\r\n        }\r\n        this.type = 'FatLines';\r\n    }\r\n    _setMaterialRes(layer, material) {\r\n        const map = layer.getMap();\r\n        const size = map.getSize();\r\n        const width = size.width, height = size.height;\r\n        material.resolution.set(width, height);\r\n    }\r\n    _setPickObject3d(ps, linewidth) {\r\n        if (!this._colorMap) {\r\n            return;\r\n        }\r\n        const geometry = this._geometryCache || new LineGeometry();\r\n        geometry.setPositions(ps);\r\n        const pick = this.getLayer().getPick();\r\n        const { _geometriesAttributes } = this;\r\n        const colors = getGeometriesColorArray(_geometriesAttributes);\r\n        let cIndex = 0;\r\n        for (let i = 0, len = _geometriesAttributes.length; i < len; i++) {\r\n            const color = pick.getColor();\r\n            const colorIndex = color.getHex();\r\n            this._colorMap[colorIndex] = i;\r\n            const { count } = _geometriesAttributes[i].position;\r\n            this._datas[i].colorIndex = colorIndex;\r\n            for (let j = 0; j < count; j++) {\r\n                colors[cIndex] = color.r;\r\n                colors[cIndex + 1] = color.g;\r\n                colors[cIndex + 2] = color.b;\r\n                cIndex += 3;\r\n            }\r\n        }\r\n        geometry.setColors(colors);\r\n        const material = new LineMaterial({\r\n            // color: color.getStyle(),\r\n            // side: THREE.BackSide,\r\n            color: '#fff',\r\n            linewidth,\r\n            vertexColors: getVertexColors()\r\n            // dashed: false\r\n        });\r\n        this._setMaterialRes(this.getLayer(), material);\r\n        const color = pick.getColor();\r\n        const colorIndex = color.getHex();\r\n        const mesh = new Line2(geometry, material);\r\n        mesh.position.copy(this.getObject3d().position);\r\n        mesh._colorIndex = colorIndex;\r\n        this.setPickObject3d(mesh);\r\n    }\r\n    // eslint-disable-next-line no-unused-vars\r\n    identify(coordinate) {\r\n        return this.picked;\r\n    }\r\n    setSymbol(material) {\r\n        if (material && material instanceof THREE.Material) {\r\n            material.needsUpdate = true;\r\n            const size = this.getMap().getSize();\r\n            const width = size.width, height = size.height;\r\n            material.resolution.set(width, height);\r\n            this.getObject3d().material = material;\r\n        }\r\n        return this;\r\n    }\r\n    // eslint-disable-next-line consistent-return\r\n    getSelectMesh() {\r\n        const index = this._getIndex();\r\n        if (index != null) {\r\n            if (!this._baseObjects[index]) {\r\n                const lineString = this._datas[index];\r\n                const opts = maptalks.Util.extend({}, this.getOptions(), { index }, isGeoJSONLine(lineString) ? lineString.properties : lineString.getProperties());\r\n                this._baseObjects[index] = new FatLine(lineString, opts, this.getObject3d().material, this.getLayer());\r\n                this._proxyEvent(this._baseObjects[index]);\r\n            }\r\n            return {\r\n                data: this._datas[index],\r\n                baseObject: this._baseObjects[index]\r\n            };\r\n        }\r\n    }\r\n    /**\r\n       * update geometry attributes\r\n       * @param {*} bufferAttribute\r\n       * @param {*} attribute\r\n       */\r\n    _updateAttribute(bufferAttribute, attribute) {\r\n        const { indexs } = this._getHideGeometryIndex(attribute);\r\n        const array = this._geometryCache.attributes[attribute].array;\r\n        const len = array.length;\r\n        for (let i = 0; i < len; i++) {\r\n            bufferAttribute.array[i] = array[i];\r\n        }\r\n        let value = -100000;\r\n        for (let j = 0; j < indexs.length; j++) {\r\n            const index = indexs[j];\r\n            const { start, end } = this._geometriesAttributes[index][attribute];\r\n            for (let i = start; i < end; i++) {\r\n                bufferAttribute.array[i] = value;\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n    _showGeometry(baseObject, isHide) {\r\n        let index;\r\n        if (baseObject) {\r\n            index = baseObject.getOptions().index;\r\n        }\r\n        if (index != null) {\r\n            const geometryAttributes = this._geometriesAttributes[index];\r\n            const { hide } = geometryAttributes;\r\n            if (hide === isHide) {\r\n                return this;\r\n            }\r\n            geometryAttributes.hide = isHide;\r\n            const buffGeom = this.getObject3d().geometry;\r\n            this._updateAttribute(buffGeom.attributes.instanceStart, 'instanceStart');\r\n            this._updateAttribute(buffGeom.attributes.instanceEnd, 'instanceEnd');\r\n            // this._updateAttribute(buffGeom.attributes.instanceDistanceStart, 'instanceDistanceStart');\r\n            // this._updateAttribute(buffGeom.attributes.instanceDistanceEnd, 'instanceDistanceEnd');\r\n            buffGeom.attributes.instanceStart.data.needsUpdate = true;\r\n            buffGeom.attributes.instanceEnd.data.needsUpdate = true;\r\n            // buffGeom.attributes.instanceDistanceStart.data.needsUpdate = true;\r\n            // buffGeom.attributes.instanceDistanceEnd.data.needsUpdate = true;\r\n            this.isHide = isHide;\r\n        }\r\n        return this;\r\n    }\r\n    _workerLoad(result) {\r\n        const { geometriesAttributes } = result;\r\n        // this._faceMap = faceMap;\r\n        this._geometriesAttributes = geometriesAttributes;\r\n        const object3d = this.getObject3d();\r\n        const position = new Float32Array(result.position);\r\n        const newPosition = new Float32Array(position);\r\n        object3d.geometry.setPositions(new Float32Array(position));\r\n        this._geometryCache.setPositions(newPosition);\r\n        this._setPickObject3d(newPosition, object3d.material.linewidth);\r\n        this._init();\r\n        if (this.isAdd) {\r\n            const pick = this.getLayer().getPick();\r\n            pick.add(this.pickObject3d);\r\n        }\r\n        this._fire('workerload', { target: this });\r\n    }\r\n}\r\nexport default FatLines;\r\n//# sourceMappingURL=FatLines.js.map","import * as maptalks from 'maptalks';\r\nimport BaseObject from './BaseObject';\r\nimport { getDefaultBoxGeometry, initVertexColors } from './util/BarUtil';\r\nimport { getVertexColors } from './util/ThreeAdaptUtil';\r\nconst OPTIONS = {\r\n    radius: 10,\r\n    height: 100,\r\n    altitude: 0,\r\n    topColor: '',\r\n    bottomColor: '#2d2f61',\r\n    heightEnable: true\r\n};\r\nclass Box extends BaseObject {\r\n    constructor(coordinate, options, material, layer) {\r\n        options = maptalks.Util.extend({}, OPTIONS, options, { layer, coordinate });\r\n        super();\r\n        this._initOptions(options);\r\n        const { height, radius, topColor, bottomColor, altitude } = options;\r\n        const h = layer.distanceToVector3(height, height).x;\r\n        const r = layer.distanceToVector3(radius, radius).x;\r\n        const geometry = getDefaultBoxGeometry().clone();\r\n        geometry.scale(r * 2, r * 2, h);\r\n        if (topColor) {\r\n            initVertexColors(geometry, bottomColor, topColor, 'z', h / 2);\r\n            material.vertexColors = getVertexColors();\r\n        }\r\n        this._createMesh(geometry, material);\r\n        const z = layer.distanceToVector3(altitude, altitude).x;\r\n        const position = layer.coordinateToVector3(coordinate, z);\r\n        this.getObject3d().position.copy(position);\r\n        this.type = 'Box';\r\n    }\r\n}\r\nexport default Box;\r\n//# sourceMappingURL=Box.js.map","import * as maptalks from 'maptalks';\r\nimport BaseObject from './BaseObject';\r\nimport Box from './Box';\r\nimport MergedMixin from './MergedMixin';\r\nimport { distanceToVector3, getCenterOfPoints } from './util/index';\r\nimport { getDefaultBoxGeometry, initVertexColors, mergeBarGeometry } from './util/BarUtil';\r\nimport { getVertexColors } from './util/ThreeAdaptUtil';\r\nimport { generatePickBufferGeometry } from './util/MergeGeometryUtil';\r\nconst OPTIONS = {\r\n    radius: 10,\r\n    height: 100,\r\n    altitude: 0,\r\n    topColor: null,\r\n    bottomColor: '#2d2f61',\r\n};\r\nclass Boxs extends MergedMixin(BaseObject) {\r\n    constructor(points, options, material, layer) {\r\n        if (!Array.isArray(points)) {\r\n            points = [points];\r\n        }\r\n        const len = points.length;\r\n        const center = getCenterOfPoints(points);\r\n        const centerPt = layer.coordinateToVector3(center);\r\n        const geometries = [], bars = [], geometriesAttributes = [], faceMap = [];\r\n        let faceIndex = 0, psIndex = 0, normalIndex = 0, uvIndex = 0;\r\n        const cache = {};\r\n        for (let i = 0; i < len; i++) {\r\n            const opts = maptalks.Util.extend({ index: i }, OPTIONS, points[i]);\r\n            const { radius, altitude, topColor, bottomColor, height, coordinate } = opts;\r\n            const r = distanceToVector3(radius, layer, cache);\r\n            const h = distanceToVector3(height, layer, cache);\r\n            const alt = distanceToVector3(altitude, layer, cache);\r\n            const buffGeom = getDefaultBoxGeometry().clone();\r\n            buffGeom.scale(r * 2, r * 2, h);\r\n            if (topColor) {\r\n                initVertexColors(buffGeom, bottomColor, topColor, 'z', h / 2);\r\n                material.vertexColors = getVertexColors();\r\n            }\r\n            const v = layer.coordinateToVector3(coordinate).sub(centerPt);\r\n            const parray = buffGeom.attributes.position.array;\r\n            for (let j = 0, len1 = parray.length; j < len1; j += 3) {\r\n                parray[j + 2] += alt;\r\n                parray[j] += v.x;\r\n                parray[j + 1] += v.y;\r\n                parray[j + 2] += v.z;\r\n            }\r\n            geometries.push(buffGeom);\r\n            const bar = new Box(coordinate, opts, material, layer);\r\n            bars.push(bar);\r\n            const faceLen = buffGeom.index.count / 3;\r\n            // faceMap[i] = [faceIndex + 1, faceIndex + faceLen];\r\n            faceIndex += faceLen;\r\n            const psCount = buffGeom.attributes.position.count, \r\n            //  colorCount = buffGeom.attributes.color.count,\r\n            normalCount = buffGeom.attributes.normal.count, uvCount = buffGeom.attributes.uv.count;\r\n            geometriesAttributes[i] = {\r\n                position: {\r\n                    count: psCount,\r\n                    start: psIndex,\r\n                    end: psIndex + psCount * 3,\r\n                },\r\n                // normal: {\r\n                //     count: normalCount,\r\n                //     start: normalIndex,\r\n                //     end: normalIndex + normalCount * 3,\r\n                // },\r\n                // // color: {\r\n                // //     count: colorCount,\r\n                // //     start: colorIndex,\r\n                // //     end: colorIndex + colorCount * 3,\r\n                // // },\r\n                // uv: {\r\n                //     count: uvCount,\r\n                //     start: uvIndex,\r\n                //     end: uvIndex + uvCount * 2,\r\n                // },\r\n                hide: false\r\n            };\r\n            psIndex += psCount * 3;\r\n            normalIndex += normalCount * 3;\r\n            // colorIndex += colorCount * 3;\r\n            uvIndex += uvCount * 2;\r\n        }\r\n        super();\r\n        options = maptalks.Util.extend({}, { altitude: 0, layer, points }, options);\r\n        this._initOptions(options);\r\n        const geometry = mergeBarGeometry(geometries);\r\n        this._createMesh(geometry, material);\r\n        const altitude = options.altitude;\r\n        const z = layer.distanceToVector3(altitude, altitude).x;\r\n        const v = centerPt.clone();\r\n        v.z = z;\r\n        this.getObject3d().position.copy(v);\r\n        // this._faceMap = faceMap;\r\n        this._baseObjects = bars;\r\n        this._datas = points;\r\n        this._geometriesAttributes = geometriesAttributes;\r\n        this.faceIndex = null;\r\n        this._geometryCache = generatePickBufferGeometry(geometry);\r\n        this.isHide = false;\r\n        this._colorMap = {};\r\n        this._initBaseObjectsEvent(bars);\r\n        this._setPickObject3d();\r\n        this._init();\r\n        this.type = 'Boxs';\r\n    }\r\n    // eslint-disable-next-line no-unused-vars\r\n    identify(coordinate) {\r\n        return this.picked;\r\n    }\r\n}\r\nexport default Boxs;\r\n//# sourceMappingURL=Boxs.js.map","// eslint-disable-next-line quotes\r\nconst workerCode = `(function(e){\"use strict\";var t={exports:{}};function r(e,t,r){r=r||2;var o,v,h,u,s,x,p,d=t&&t.length,g=d?t[0]*r:e.length,y=n(e,0,g,r,!0),m=[];if(!y||y.next===y.prev)return m;if(d&&(y=function(e,t,r,a){var o,v,h,u=[];for(o=0,v=t.length;o<v;o++)(h=n(e,t[o]*a,o<v-1?t[o+1]*a:e.length,a,!1))===h.next&&(h.steiner=!0),u.push(c(h));for(u.sort(l),o=0;o<u.length;o++)f(u[o],r),r=i(r,r.next);return r}(e,t,y,r)),e.length>80*r){o=h=e[0],v=u=e[1];for(var M=r;M<g;M+=r)(s=e[M])<o&&(o=s),(x=e[M+1])<v&&(v=x),s>h&&(h=s),x>u&&(u=x);p=0!==(p=Math.max(h-o,u-v))?1/p:0}return a(y,m,r,o,v,p),m}function n(e,t,r,n,i){var a,o;if(i===F(e,t,r,n)>0)for(a=t;a<r;a+=n)o=Z(a,e[a],e[a+1],o);else for(a=r-n;a>=t;a-=n)o=Z(a,e[a],e[a+1],o);return o&&y(o,o.next)&&(A(o),o=o.next),o}function i(e,t){if(!e)return e;t||(t=e);var r,n=e;do{if(r=!1,n.steiner||!y(n,n.next)&&0!==g(n.prev,n,n.next))n=n.next;else{if(A(n),(n=t=n.prev)===n.next)break;r=!0}}while(r||n!==t);return t}function a(e,t,r,n,l,f,s){if(e){!s&&f&&function(e,t,r,n){var i=e;do{null===i.z&&(i.z=x(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,r,n,i,a,o,v,h,u=1;do{for(r=e,e=null,a=null,o=0;r;){for(o++,n=r,v=0,t=0;t<u&&(v++,n=n.nextZ);t++);for(h=u;v>0||h>0&&n;)0!==v&&(0===h||!n||r.z<=n.z)?(i=r,r=r.nextZ,v--):(i=n,n=n.nextZ,h--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;r=n}a.nextZ=null,u*=2}while(o>1)}(i)}(e,n,l,f);for(var c,p,d=e;e.prev!==e.next;)if(c=e.prev,p=e.next,f?v(e,n,l,f):o(e))t.push(c.i/r),t.push(e.i/r),t.push(p.i/r),A(e),e=p.next,d=p.next;else if((e=p)===d){s?1===s?a(e=h(i(e),t,r),t,r,n,l,f,2):2===s&&u(e,t,r,n,l,f):a(i(e),t,r,n,l,f,1);break}}}function o(e){var t=e.prev,r=e,n=e.next;if(g(t,r,n)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(p(t.x,t.y,r.x,r.y,n.x,n.y,i.x,i.y)&&g(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function v(e,t,r,n){var i=e.prev,a=e,o=e.next;if(g(i,a,o)>=0)return!1;for(var v=i.x<a.x?i.x<o.x?i.x:o.x:a.x<o.x?a.x:o.x,h=i.y<a.y?i.y<o.y?i.y:o.y:a.y<o.y?a.y:o.y,u=i.x>a.x?i.x>o.x?i.x:o.x:a.x>o.x?a.x:o.x,l=i.y>a.y?i.y>o.y?i.y:o.y:a.y>o.y?a.y:o.y,f=x(v,h,t,r,n),s=x(u,l,t,r,n),c=e.prevZ,d=e.nextZ;c&&c.z>=f&&d&&d.z<=s;){if(c!==e.prev&&c!==e.next&&p(i.x,i.y,a.x,a.y,o.x,o.y,c.x,c.y)&&g(c.prev,c,c.next)>=0)return!1;if(c=c.prevZ,d!==e.prev&&d!==e.next&&p(i.x,i.y,a.x,a.y,o.x,o.y,d.x,d.y)&&g(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;c&&c.z>=f;){if(c!==e.prev&&c!==e.next&&p(i.x,i.y,a.x,a.y,o.x,o.y,c.x,c.y)&&g(c.prev,c,c.next)>=0)return!1;c=c.prevZ}for(;d&&d.z<=s;){if(d!==e.prev&&d!==e.next&&p(i.x,i.y,a.x,a.y,o.x,o.y,d.x,d.y)&&g(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function h(e,t,r){var n=e;do{var a=n.prev,o=n.next.next;!y(a,o)&&m(a,n,n.next,o)&&w(a,o)&&w(o,a)&&(t.push(a.i/r),t.push(n.i/r),t.push(o.i/r),A(n),A(n.next),n=e=o),n=n.next}while(n!==e);return i(n)}function u(e,t,r,n,o,v){var h=e;do{for(var u=h.next.next;u!==h.prev;){if(h.i!==u.i&&d(h,u)){var l=S(h,u);return h=i(h,h.next),l=i(l,l.next),a(h,t,r,n,o,v),void a(l,t,r,n,o,v)}u=u.next}h=h.next}while(h!==e)}function l(e,t){return e.x-t.x}function f(e,t){if(t=function(e,t){var r,n=t,i=e.x,a=e.y,o=-1/0;do{if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){var v=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(v<=i&&v>o){if(o=v,v===i){if(a===n.y)return n;if(a===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(i===o)return r;var h,u=r,l=r.x,f=r.y,x=1/0;n=r;do{i>=n.x&&n.x>=l&&i!==n.x&&p(a<f?i:o,a,l,f,a<f?o:i,a,n.x,n.y)&&(h=Math.abs(a-n.y)/(i-n.x),w(n,e)&&(h<x||h===x&&(n.x>r.x||n.x===r.x&&s(r,n)))&&(r=n,x=h)),n=n.next}while(n!==u);return r}(e,t)){var r=S(t,e);i(t,t.next),i(r,r.next)}}function s(e,t){return g(e.prev,e,t.prev)<0&&g(t.next,e,e.next)<0}function x(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function c(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function p(e,t,r,n,i,a,o,v){return(i-o)*(t-v)-(e-o)*(a-v)>=0&&(e-o)*(n-v)-(r-o)*(t-v)>=0&&(r-o)*(a-v)-(i-o)*(n-v)>=0}function d(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&m(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(w(e,t)&&w(t,e)&&function(e,t){var r=e,n=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)&&(g(e.prev,e,t.prev)||g(e,t.prev,t))||y(e,t)&&g(e.prev,e,e.next)>0&&g(t.prev,t,t.next)>0)}function g(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function y(e,t){return e.x===t.x&&e.y===t.y}function m(e,t,r,n){var i=b(g(e,t,r)),a=b(g(e,t,n)),o=b(g(r,n,e)),v=b(g(r,n,t));return i!==a&&o!==v||(!(0!==i||!M(e,r,t))||(!(0!==a||!M(e,n,t))||(!(0!==o||!M(r,e,n))||!(0!==v||!M(r,t,n)))))}function M(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function b(e){return e>0?1:e<0?-1:0}function w(e,t){return g(e.prev,e,e.next)<0?g(e,t,e.next)>=0&&g(e,e.prev,t)>=0:g(e,t,e.prev)<0||g(e,e.next,t)<0}function S(e,t){var r=new z(e.i,e.x,e.y),n=new z(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,a.next=n,n.prev=a,n}function Z(e,t,r,n){var i=new z(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function A(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function z(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function F(e,t,r,n){for(var i=0,a=t,o=r-n;a<r;a+=n)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}t.exports=r,t.exports.default=r,r.deviation=function(e,t,r,n){var i=t&&t.length,a=i?t[0]*r:e.length,o=Math.abs(F(e,0,a,r));if(i)for(var v=0,h=t.length;v<h;v++){var u=t[v]*r,l=v<h-1?t[v+1]*r:e.length;o-=Math.abs(F(e,u,l,r))}var f=0;for(v=0;v<n.length;v+=3){var s=n[v]*r,x=n[v+1]*r,c=n[v+2]*r;f+=Math.abs((e[s]-e[c])*(e[x+1]-e[s+1])-(e[s]-e[x])*(e[c+1]-e[s+1]))}return 0===o&&0===f?0:Math.abs((f-o)/o)},r.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,i=0;i<e.length;i++){for(var a=0;a<e[i].length;a++)for(var o=0;o<t;o++)r.vertices.push(e[i][a][o]);i>0&&(n+=e[i-1].length,r.holes.push(n))}return r};var R=t.exports;function q(e,t,r){var n=t[0],i=t[1],a=r[0]-n,o=r[1]-i;if(0!==a||0!==o){var v=((e[0]-n)*a+(e[1]-i)*o)/(a*a+o*o);v>1?(n=r[0],i=r[1]):v>0&&(n+=a*v,i+=o*v)}return(a=e[0]-n)*a+(o=e[1]-i)*o}function P(e,t,r,n,i){for(var a,o=n,v=t+1;v<r;v++){var h=q(e[v],e[t],e[r]);h>o&&(a=v,o=h)}o>n&&(a-t>1&&P(e,t,a,n,i),i.push(e[a]),r-a>1&&P(e,a,r,n,i))}function L(e,t){var r=e.length-1,n=[e[0]];return P(e,0,r,t,n),n.push(e[r]),n}function V(e,t,r){if(e.length<=2)return e;var n=void 0!==t?t*t:1;return e=L(e=r?e:function(e,t){for(var r,n,i,a,o,v=e[0],h=[v],u=1,l=e.length;u<l;u++)r=e[u],i=v,a=void 0,o=void 0,a=(n=r)[0]-i[0],o=n[1]-i[1],a*a+o*o>t&&(h.push(r),v=r);return v!==r&&h.push(r),h}(e,n),n)}function B(e,t){return e[0]*t[0]+e[1]*t[1]}function E(e,t){var r=t[0],n=t[1],i=Math.sqrt(r*r+n*n);return e[0]=r/i,e[1]=n/i,e}function U(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e}function H(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function I(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function O(e,t){var r=t[0],n=t[1],i=t[2],a=Math.sqrt(r*r+n*n+i*i);return e[0]=r/a,e[1]=n/a,e[2]=i/a,e}function T(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],v=r[1],h=r[2];return e[0]=i*h-a*v,e[1]=a*o-n*h,e[2]=n*v-i*o,e}var W=[];function j(e,t,r,n){var i=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}(t,r),a=Math.acos(i)*n;return U(W,r,t,-i),function(e,t){var r=t[0],n=t[1],i=t[2],a=Math.sqrt(r*r+n*n+i*i);e[0]=r/a,e[1]=n/a,e[2]=i/a}(W,W),function(e,t,r){e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r}(e,t,Math.cos(a)),U(e,e,W,Math.sin(a)),e}function k(e,t,r,n,i,a,o,v,h,u){var l=o-i,f=v-a,s=(l*(t-a)-f*(e-i))/(f*(r-e)-l*(n-t));return h&&(h[u=u||0]=e+s*(r-e),h[u+1]=t+s*(n-t)),s}function _(e,t,r){if(r-t<3)return 0;for(var n=0,i=2*(r-1),a=2*t;a<2*r;){var o=e[i],v=e[i+1],h=e[a],u=e[a+1];i=a,a+=2,n+=o*u-h*v}return n}function D(e,t,r){return void 0===r&&(r=2),R(e,t,r)}var C=[],G=[],J=[];function K(e,t,r,n,i,a,o,v,h){var u,l,f,s=null!=o,x=i,c=null;s&&(c=new Uint32Array(n-r));for(var p=[],d=r;d<n;d++){var g=d===n-1?r:d+1,y=d===r?n-1:d-1,m=e[2*y],M=e[2*y+1],b=e[2*d],w=e[2*d+1],S=e[2*g],Z=e[2*g+1];C[0]=b-m,C[1]=w-M,G[0]=S-b,G[1]=Z-w,E(C,C),E(G,G),s&&(c[d]=x);var A=!1,z=void 0,F=void 0;if(v||d!==r)if(v||d!==n-1){H(J,G,C);var R=J[1];J[1]=-J[0],J[0]=R,E(J,J);var q=B(J,G),P=Math.sqrt(1-q*q),L=a*Math.min(10,1/P);if(s&&1/P>o&&a*q<0){var V=b+J[0]*a,U=w+J[1]*a,I=Math.acos(P)/2,O=Math.tan(I)*Math.abs(a);t[2*x]=V+J[1]*O,t[2*x+1]=U-J[0]*O,t[2*++x]=V-J[1]*O,t[2*x+1]=U+J[0]*O,x++}else z=b+J[0]*L,F=w+J[1]*L,A=!0;if(A){if(h&&null!=u){var T=k(m,M,u,l,b,w,z,F,p,0);T>=-.01&&T<=1.01&&(t[2*f]=z=p[0],t[2*f+1]=F=p[1])}u=t[2*x]=z,l=t[2*x+1]=F,f=x,x++}}else J[0]=C[1],J[1]=-C[0],E(J,J),z=b+J[0]*a,F=w+J[1]*a,A=!0;else J[0]=G[1],J[1]=-G[0],E(J,J),u=t[2*x]=b+J[0]*a,l=t[2*x+1]=w+J[1]*a,f=x,x++}return c}function N(e,t,r,n,i,a,o,v){var h=null!=o,u=i,l=null;h&&(l=new Uint32Array(n-r));for(var f=r;f<n;f++){var s=f===n-1?r:f+1,x=f===r?n-1:f-1,c=e[2*x],p=e[2*x+1],d=e[2*f],g=e[2*f+1],y=e[2*s],m=e[2*s+1];if(C[0]=d-c,C[1]=g-p,G[0]=y-d,G[1]=m-g,E(C,C),E(G,G),h&&(l[f]=u),v||f!==r)if(v||f!==n-1){H(J,G,C);var M=J[1];J[1]=-J[0],J[0]=M,E(J,J);var b=B(J,G),w=Math.sqrt(1-b*b),S=a*Math.min(10,1/w);if(h&&1/w>o&&a*b<0){var Z=d+J[0]*a,A=g+J[1]*a,z=Math.acos(w)/2,F=Math.tan(z)*Math.abs(a);t[2*u]=Z+J[1]*F,t[2*u+1]=A-J[0]*F,t[2*++u]=Z-J[1]*F,t[2*u+1]=A+J[0]*F,u++}else t[2*u]=d+J[0]*S,t[2*u+1]=g+J[1]*S,u++}else J[0]=C[1],J[1]=-C[0],E(J,J),t[2*u]=d+J[0]*a,t[2*u+1]=g+J[1]*a,u++;else J[0]=G[1],J[1]=-G[0],E(J,J),t[2*u]=d+J[0]*a,t[2*u+1]=g+J[1]*a,u++}return l}function Q(e,t,r,n,i){var a=null!=n?[]:new Float32Array(e.length);if(K(e,a,0,t&&t.length?t[0]:e.length/2,0,r,n,i,!0),t)for(var o=0;o<t.length;o++){var v=t[o];K(e,a,v,t[o+1]||e.length/2,null!=n?a.length/2:v,r,n,i,!1)}return a}function X(e,t,r,n){for(var i=0;i<Math.floor((n-r)/2);i++)for(var a=0;a<t;a++){var o=(i+r)*t+a,v=(n-i-1)*t+a,h=e[o];e[o]=e[v],e[v]=h}return e}function Y(e,t){var r=e.length/2,n=0,i=t&&t.length?t[0]:r;_(e,n,i)>0&&X(e,2,n,i);for(var a=1;a<(t?t.length:0)+1;a++)_(e,n=t[a-1],i=t[a]||r)<0&&X(e,2,n,i)}function $(e){e.depth=e.depth||1,e.bevelSize=e.bevelSize||0,e.bevelSegments=null==e.bevelSegments?2:e.bevelSegments,e.smoothBevel=e.smoothBevel||!1,e.simplify=e.simplify||0,null==e.smoothSide&&(e.smoothSide=\"auto\"),null==e.smoothSideThreshold&&(e.smoothSideThreshold=.9),\"number\"==typeof e.depth&&(e.bevelSize=Math.min(e.bevelSegments>0?e.bevelSize:0,e.depth/2)),e.bevelSize>0||(e.bevelSegments=0),e.bevelSegments=Math.round(e.bevelSegments);var t=e.boundingRect;if(e.translate=e.translate||[0,0],e.scale=e.scale||[1,1],e.fitRect){var r=null==e.fitRect.x?t.x||0:e.fitRect.x,n=null==e.fitRect.y?t.y||0:e.fitRect.y,i=e.fitRect.width,a=e.fitRect.height;null==i?null!=a?i=a/t.height*t.width:(i=t.width,a=t.height):null==a&&(a=i/t.width*t.height),e.scale=[i/t.width,a/t.height],e.translate=[(r-t.x)*e.scale[0],(n-t.y)*e.scale[1]]}}var ee=[[0,0],[1,0],[1,1],[0,0],[1,1],[0,1]];function te(e,t,r){for(var n=0,i=e[t],a=e[t+1],o=i,v=a,h=t+2;h<r;h+=2){var u=e[h],l=e[h+1];n+=Math.sqrt((u-i)*(u-i)+(l-a)*(l-a)),i=u,a=l}return n+=Math.sqrt((i-o)*(i-o)+(a-v)*(a-v))}function re(e,t,r,n,i,a){var o=t.vertices,v=t.topVertices,h=t.splittedMap,u=t.depth,l=t.rect,f=n-r,s=a.smoothBevel?1:2,x=Math.min(u/2,a.bevelSize),c=a.bevelSegments,p=i.vertex,d=i.ringPerimeter,g=Math.max(l.width,l.height,u,d);function y(e){var t=(e+1)%f,r=o[2*e],n=o[2*e+1],i=o[2*t],a=o[2*t+1];return r===i&&n===a}if(x>0)for(var m=[0,0,1],M=[],b=[0,0,-1],w=[],S=0,Z=new Float32Array(f),A=0;A<2;A++)for(var z=0===A?u-x:x,F=0;F<=c*s;F++){for(var R=0,q=void 0,P=void 0,L=0;L<f;L++){var V=2*(L%f+r),B=h?2*h[V/2]:V;M[0]=o[V]-v[B],M[1]=o[V+1]-v[B+1],M[2]=0;var E=Math.sqrt(M[0]*M[0]+M[1]*M[1]);M[0]/=E,M[1]/=E;var U=(Math.floor(F/s)+F%s)/c;0===A?j(w,m,M,U):j(w,M,b,U);var H=0===A?U:1-U,I=x*Math.sin(H*Math.PI/2),O=E*Math.cos(H*Math.PI/2),T=x*E/Math.sqrt(I*I+O*O),W=w[0]*T+v[B],k=w[1]*T+v[B+1],_=w[2]*T+z;if(e.position[3*i.vertex]=W,e.position[3*i.vertex+1]=k,e.position[3*i.vertex+2]=_,L>0&&(R+=Math.sqrt((q-W)*(q-W)+(P-k)*(P-k))),F>0||A>0){var D=3*(i.vertex-f),C=e.position[D],G=e.position[D+1],J=e.position[D+2];Z[L]+=Math.sqrt((C-W)*(C-W)+(G-k)*(G-k)+(J-_)*(J-_))}if(e.uv[2*i.vertex]=R/g,e.uv[2*i.vertex+1]=Z[L]/g,q=W,P=k,i.vertex++,!y(L)&&(s>1&&F%s||1===s&&F>=1))for(var K=0;K<6;K++){var N=(ee[K][0]+L)%f,Q=ee[K][1]+S;e.indices[i.index++]=(Q-1)*f+N+p}}S++}else for(var X=0;X<2;X++)for(var Y=0===X?u-x:x,$=0,te=void 0,re=void 0,ne=0;ne<f;ne++){var ie=2*(ne%f+r),ae=o[ie],oe=o[ie+1];e.position[3*i.vertex]=ae,e.position[3*i.vertex+1]=oe,e.position[3*i.vertex+2]=Y,ne>0&&($+=Math.sqrt((te-ae)*(te-ae)+(re-oe)*(re-oe))),e.uv[2*i.vertex]=$/g,e.uv[2*i.vertex+1]=Y/g,te=ae,re=oe,i.vertex++}for(var ve=x>0?c*s+1:1,he=0;he<f;he++)if(!y(he))for(var ue=0;ue<6;ue++){var le=(ee[ue][0]+he)%f,fe=ee[ue][1]+ve;e.indices[i.index++]=(fe-1)*f+le+p}}function ne(e,t,r,n){var i=e.indices,a=e.topVertices,o=e.rect,v=e.depth;if(!(a.length<=4)){for(var h=r.vertex,u=i.length,l=0;l<u;l++)t.indices[r.index++]=h+i[l];for(var f=Math.max(o.width,o.height),s=0;s<(n.excludeBottom?1:2);s++)for(var x=0;x<a.length;x+=2){var c=a[x],p=a[x+1];t.position[3*r.vertex]=c,t.position[3*r.vertex+1]=p,t.position[3*r.vertex+2]=(1-s)*v,t.uv[2*r.vertex]=(c-o.x)/f,t.uv[2*r.vertex+1]=(p-o.y)/f,r.vertex++}if(!n.excludeBottom)for(var d=a.length/2,g=0;g<u;g+=3)for(var y=0;y<3;y++)t.indices[r.index++]=h+d+i[g+2-y]}}function ie(e,t,r,n){var i=null==r||\"auto\"===r;if(!0===r)return{vertices:e,holes:t};for(var a=[],o=t&&[],v=e.length/2,h=[],u=[],l=[],f=0,s=0,x=(t?t.length:0)+1,c=0;c<x;c++){0===c?s=t&&t.length?t[0]:v:(f=t[c-1],s=t[c]||v);for(var p=f;p<s;p++){var d=e[2*p],g=e[2*p+1],y=p===s-1?f:p+1,m=e[2*y],M=e[2*y+1];if(i){var b=p===f?s-1:p-1,w=e[2*b],S=e[2*b+1];h[0]=w-d,h[1]=S-g,u[0]=m-d,u[1]=M-g,E(h,h),E(u,u),1-(.5*B(h,u)+.5)>n?(a.push(d,g),l.push(p)):(a.push(d,g,d,g),l.push(p,p))}else a.push(d,g,d,g),l.push(p,p)}c<x-1&&o&&o.push(a.length/2)}return{vertices:new Float32Array(a),splittedMap:l,holes:o}}function ae(e,t){for(var r=0,n=0,i=0;i<e.length;i++){var a=e[i],o=a.indices,v=a.vertices,h=a.splittedMap,u=a.topVertices,l=a.depth,f=Math.min(l/2,t.bevelSize)>0?t.bevelSegments:0,s=e[i].holes||[];r+=o.length*(t.excludeBottom?1:2),n+=u.length/2*(t.excludeBottom?1:2);for(var x=2+2*f,c=0,p=0,d=0;d<s.length+1;d++){0===d?p=s.length?s[0]:v.length/2:(c=s[d-1],p=s[d]||v.length/2),r+=6*((h?h[p-1]+1:p)-(h?h[c]:c))*(x-1);var g=p-c;n+=g*x+(t.smoothBevel?0:f*g*2)}}for(var y={position:new Float32Array(3*n),indices:new(n>65535?Uint32Array:Uint16Array)(r),uv:new Float32Array(2*n)},m={vertex:0,index:0,ringPerimeter:0},M=0;M<e.length;M++)ne(e[M],y,m,t);for(var b=0;b<e.length;b++){var w=e[b],S=w.holes,Z=w.vertices.length/2,A=0,z=S&&S.length?S[0]:Z;if(m.ringPerimeter=te(e[b].topVertices,A,z),re(y,e[b],A,z,m,t),S)for(var F=0;F<S.length;F++)A=S[F],z=S[F+1]||Z,m.ringPerimeter=te(e[b].topVertices,A,z),re(y,e[b],A,z,m,t)}for(var R=0;R<y.uv.length;R++){var q=y.uv[R];q>0&&Math.round(q)===q?y.uv[R]=1:y.uv[R]=q%1}return y.normal=function(e,t){function r(e,t,r,n){e[0]=t,e[1]=r,e[2]=n}for(var n=[],i=[],a=[],o=[],v=[],h=[],u=e.length,l=new Float32Array(t.length),f=0;f<u;){var s=3*e[f++],x=3*e[f++],c=3*e[f++];r(n,t[s],t[s+1],t[s+2]),r(i,t[x],t[x+1],t[x+2]),r(a,t[c],t[c+1],t[c+2]),I(o,n,i),I(v,i,a),T(h,o,v);for(var p=0;p<3;p++)l[s+p]=l[s+p]+h[p],l[x+p]=l[x+p]+h[p],l[c+p]=l[c+p]+h[p]}for(var d=0;d<l.length;)r(h,l[d],l[d+1],l[d+2]),O(h,h),l[d++]=h[0],l[d++]=h[1],l[d++]=h[2];return l}(y.indices,y.position),y.boundingRect=e[0]&&e[0].rect,y}function oe(e,t,r){for(var n=r.lineWidth,i=e.length,a=new Float32Array(2*i),o=r.translate||[0,0],v=r.scale||[1,1],h=0,u=0;h<i;h++)a[u++]=e[h][0]*v[0]+o[0],a[u++]=e[h][1]*v[1]+o[1];_(a,0,i)<0&&X(a,2,0,i);var l=[],f=[],s=r.miterLimit,x=N(a,f,0,i,0,-n/2,s,!1);X(a,2,0,i);for(var c=N(a,l,0,i,0,-n/2,s,!1),p=(l.length+f.length)/2,d=new Float32Array(2*p),g=0,y=f.length/2,m=0;m<f.length;m++)d[g++]=f[m];for(var M=0;M<l.length;M++)d[g++]=l[M];for(var b=new(p>65535?Uint32Array:Uint16Array)(3*(2*(i-1)+(p-2*i))),w=0,S=0;S<i-1;S++){var Z=S+1;b[w++]=y-1-x[S],b[w++]=y-1-x[S]-1,b[w++]=c[S]+1+y,b[w++]=y-1-x[S],b[w++]=c[S]+1+y,b[w++]=c[S]+y,c[Z]-c[S]==2?(b[w++]=c[S]+2+y,b[w++]=c[S]+1+y,b[w++]=y-x[Z]-1):x[Z]-x[S]==2&&(b[w++]=c[Z]+y,b[w++]=y-1-(x[S]+1),b[w++]=y-1-(x[S]+2))}var A=r.bevelSize>0?Q(d,[],r.bevelSize,null,!0):d,z=r.boundingRect,F=ie(d,null,r.smoothSide,r.smoothSideThreshold);return{vertices:F.vertices,rawVertices:A,splittedMap:F.splittedMap,indices:b,topVertices:A,rect:{x:z.x*v[0]+o[0],y:z.y*v[1]+o[1],width:z.width*v[0],height:z.height*v[1]},depth:\"function\"==typeof r.depth?r.depth(t):r.depth,holes:[]}}function ve(e,t){for(var r=[],n=0;n<e.length;n++){for(var i=e[n],a=[],o=i.length,v=i[o-1][0],h=i[o-1][1],u=0,l=0;l<o;l++){var f=i[l][0],s=i[l][1],x=f-v,c=s-h;(u+=Math.sqrt(x*x+c*c))>t&&(a.push(i[l]),u=0),v=f,h=s}a.length>=3&&r.push(a)}return r.length>0?r:null}function he(e,t){for(var r=[],n=0;n<e.length;n++){var i=e[n];(i=V(i,t,!0)).length>=3&&r.push(i)}return r.length>0?r:null}function ue(e,t,r){for(var n=0;n<e.length;n++)t[0]=Math.min(e[n][0],t[0]),t[1]=Math.min(e[n][1],t[1]),r[0]=Math.max(e[n][0],r[0]),r[1]=Math.max(e[n][1],r[1])}var le={x:0,y:0},fe={x:0,y:0};function se(e,t,r,n){for(var i=e.length,a=0;a<i;a++){var o=e[a].data;t=e[a].center||t;for(var v=0,h=o.length;v<h;v++)for(var u=o[v],l=0,f=u.length;l<f;l++)e[a].data[v][l]=xe(u[l],t,r,n)}}function xe(e,t,r,n){for(var i,a=[],o=0,v=(i=r?new Float64Array(e):new Float32Array(e)).length;o<v;o+=2){var h=i[o],u=i[o+1];if(t&&r&&n){le.x=h,le.y=u;var l=be(le,fe);le.x=l.x,le.y=l.y,h=(l=we(n,le,r,fe)).x,u=l.y,h-=t[0],u-=t[1]}a.push([h,u])}return a}function ce(e,t){void 0===t&&(t=!1);for(var r=e.length,n=[],i=[],a=0,o=0;o<r;o++){var v=t?de(e[o]):pe(e[o]),h=e[o].bottomHeight||0,u=v.position;i.push(v);var l=u.length/3;n[o]={position:{middleZ:h+(e[o].height||0)/2,count:l,start:a,end:a+3*l},hide:!1},a+=3*l}var f=function(e){for(var t={},r={},n=0;n<e.length;++n){var i=e[n];for(var a in i)void 0===t[a]&&(t[a]=[],r[a]=0),t[a].push(i[a]),r[a]+=i[a].length}var o={},v=0,h=[];for(var u in t)if(\"indices\"===u)for(var l=t[u],f=0,s=l.length;f<s;f++){for(var x=l[f],c=0,p=x.length;c<p;c++)h.push(x[c]+v);v+=t.position[f].length/3}else{var d=ge(t[u],r[u]);if(!d)return null;o[u]=d}return o.indices=new Uint32Array(h),o}(i),s=f.position,x=f.normal,c=f.uv,p=f.indices;return{position:s.buffer,normal:x.buffer,uv:c.buffer,indices:p.buffer,geometriesAttributes:n}}function pe(e){var t=e.data,r=e.height,n=e.bottomHeight,i=function(e,t){t=Object.assign({},t);for(var r=[1/0,1/0],n=[-1/0,-1/0],i=0;i<e.length;i++)ue(e[i][0],r,n);t.boundingRect=t.boundingRect||{x:r[0],y:r[1],width:n[0]-r[0],height:n[1]-r[1]},$(t);for(var a=[],o=t.translate||[0,0],v=t.scale||[1,1],h=t.boundingRect,u={x:h.x*v[0]+o[0],y:h.y*v[1]+o[1],width:h.width*v[0],height:h.height*v[1]},l=Math.min(h.width,h.height)/1e5,f=0;f<e.length;f++){var s=ve(e[f],l);if(s){var x=t.simplify/Math.max(v[0],v[1]);if(x>0&&(s=he(s,x)),s){for(var c=R.flatten(s),p=c.vertices,d=c.holes,g=c.dimensions,y=0;y<p.length;)p[y]=p[y++]*v[0]+o[0],p[y]=p[y++]*v[1]+o[1];if(Y(p,d),2!==g)throw new Error(\"Only 2D polygon points are supported\");var m=t.bevelSize>0?Q(p,d,t.bevelSize,null,!0):p,M=D(m,d,g),b=ie(p,d,t.smoothSide,t.smoothSideThreshold);a.push({indices:M,vertices:b.vertices,rawVertices:p,topVertices:m,holes:b.holes,splittedMap:b.splittedMap,rect:u,depth:\"function\"==typeof t.depth?t.depth(f):t.depth})}}}return ae(a,t)}(t,{depth:r}),a=i.position,o=i.normal,v=i.uv,h=i.indices;return ye(a,n),{position:a,normal:o,uv:v,indices:h}}function de(e){var t=e.data,r=e.height,n=e.width,i=e.bottomHeight,a=function(e,t){t=Object.assign({},t);for(var r=[1/0,1/0],n=[-1/0,-1/0],i=0;i<e.length;i++)ue(e[i],r,n);t.boundingRect=t.boundingRect||{x:r[0],y:r[1],width:n[0]-r[0],height:n[1]-r[1]},$(t);var a=t.scale||[1,1];null==t.lineWidth&&(t.lineWidth=1),null==t.miterLimit&&(t.miterLimit=2);for(var o=[],v=0;v<e.length;v++){var h=e[v],u=t.simplify/Math.max(a[0],a[1]);u>0&&(h=V(h,u,!0)),o.push(oe(h,v,t))}return ae(o,t)}(t,{lineWidth:n,depth:r}),o=a.position,v=a.normal,h=a.uv,u=a.indices;return ye(o,i),{position:o,normal:v,uv:h,indices:u}}function ge(e,t){for(var r=new Float32Array(t),n=0,i=0;i<e.length;++i)r.set(e[i],n),n+=e[i].length;return r}function ye(e,t){if(void 0!==t&&\"number\"==typeof t&&0!==t)for(var r=0,n=e.length;r<n;r+=3)e[r+2]+=t}var me=Math.PI/180,Me=6378137*Math.PI/180;function be(e,t){var r,n=85.0511287798,i=e.x,a=Math.max(Math.min(n,e.y),-n);r=0===a?0:Math.log(Math.tan((90+a)*me/2))/me;var o=i*Me,v=r*Me;return t?(t.x=o,t.y=v,t):{x:o,y:v}}function we(e,t,r,n){var i=e[0]*(t.x-e[2])/r,a=-e[1]*(t.y-e[3])/r;return n?(n.x=i,n.y=a,n):{x:i,y:a}}function Se(e){void 0===e&&(e=[]);for(var t=e.length,r=new Float32Array(3*t),n=0;n<t;n++){var i=e[n],a=3*n;r[a]=i[0],r[a+1]=i[1]}return r}function Ze(e){for(var t=new Float32Array(2*e.length-6),r=0,n=0,i=e.length/3;n<i;n++){var a=e[3*n],o=e[3*n+1],v=e[3*n+2];if(n>0&&n<i-1){var h=3*r;t[h]=a,t[h+1]=o,t[h+2]=v,r++}var u=3*r;t[u]=a,t[u+1]=o,t[u+2]=v,r++}return t}function Ae(e){var t=0,r=e.length;if(1===r)return e[0];for(var n=0;n<r;n++)t+=e[n].length;for(var i=new Float32Array(t),a=0,o=0;o<r;o++)i.set(e[o],a),a+=e[o].length;return i}e.initialize=function(){},e.onmessage=function(e,t){var r=e.data,n=r.type,i=r.datas,a=r.glRes,o=r.matrix,v=r.center;if(\"ExtrudePolygons\"===n){se(i,v,a,o);var h=ce(i);t(null,h,[h.position,h.normal,h.uv,h.indices])}else if(\"ExtrudeLines\"===n){for(var u=0,l=i.length;u<l;u++)for(var f=0,s=i[u].data.length;f<s;f++)i[u].data[f]=xe(i[u].data[f],i[u].center||v,a,o);var x=ce(i,!0);t(null,x,[x.position,x.normal,x.uv,x.indices])}else if(\"ExtrudePolygon\"===n){var c=[],p=[];i.forEach((function(e){var t=[e];se(t,v,a,o);var r=ce(t),n=r.position,i=r.normal,h=r.uv,u=r.indices;c.push({id:e.id,position:n,normal:i,uv:h,indices:u}),p.push(n,i,h,u)})),t(null,c,p)}else if(\"Line\"===n||\"FatLine\"===n){for(var d=[],g=[],y=0,m=i.length;y<m;y++){for(var M=[],b=0,w=i[y].data.length;b<w;b++){i[y].data[b]=xe(i[y].data[b],i[y].center||v,a,o);var S=Se(i[y].data[b]);M.push(Ze(S))}var Z=Ae(M);ye(Z,i[y].bottomHeight),d.push({id:i[y].id,position:Z.buffer}),g.push(Z.buffer)}t(null,d,g)}else if(\"Lines\"===n||\"FatLines\"===n){for(var A=0,z=[],F=[],R=0,q=[],P=0,L=i.length;P<L;P++){for(var V=0,B=0,E=i[P].data.length;B<E;B++){i[P].data[B]=xe(i[P].data[B],i[P].center||v,a,o);var U=Se(i[P].data[B]);ye(U,i[P].bottomHeight),V+=U.length/3*2-2,q.push(Ze(U))}var H=V;z[P]=[A,A+H],A+=H,F[P]={position:{count:V,start:R,end:R+3*V},hide:!1},\"FatLines\"===n&&(F[P].instanceStart={count:V,start:R,end:R+3*V},F[P].instanceEnd={count:V,start:R,end:R+3*V}),R+=3*V}var I=Ae(q);t(null,{id:i.id,position:I.buffer,geometriesAttributes:F,faceMap:z},[I.buffer])}else if(\"ExtrudeLine\"===n){for(var O=0,T=i.length;O<T;O++)for(var W=0,j=i[O].data.length;W<j;W++)i[O].data[W]=xe(i[O].data[W],i[O].center||v,a,o);var k=[],_=[];i.forEach((function(e){var t=ce([e],!0),r=t.position,n=t.normal,i=t.uv,a=t.indices;k.push({id:e.id,position:r,normal:n,uv:i,indices:a}),_.push(r,n,i,a)})),t(null,k,_)}},Object.defineProperty(e,\"__esModule\",{value:!0})})`;\r\nconst workerName = '__maptalks.three__';\r\nexport function getWorkerName() {\r\n    return workerName;\r\n}\r\nexport function getWorkerCode() {\r\n    return workerCode;\r\n}\r\n//# sourceMappingURL=getworker.js.map","import * as maptalks from 'maptalks';\r\nexport const fetchDataWorkerKey = '__maptalks.three.fetchdata__';\r\nexport function fetchDataWorkerCode(exports) {\r\n    const tasks = [], taskings = [], concurrentCount = 5;\r\n    exports.initialize = function () {\r\n    };\r\n    exports.onmessage = function (message, postResponse) {\r\n        const data = message.data;\r\n        const task = {\r\n            url: data,\r\n            postResponse,\r\n            abort: false\r\n        };\r\n        loopTask(task);\r\n    };\r\n    function loopTask(task) {\r\n        if (task.abort) {\r\n            taskings.splice(taskings.indexOf(task), 1);\r\n            if (tasks.length) {\r\n                taskings.push(tasks[0]);\r\n                tasks.splice(0, 1);\r\n                fetchData(taskings[taskings.length - 1]);\r\n            }\r\n        }\r\n        else if (taskings.length < concurrentCount) {\r\n            taskings.push(task);\r\n            fetchData(task);\r\n        }\r\n        else {\r\n            tasks.push(task);\r\n        }\r\n    }\r\n    function fetchData(task) {\r\n        fetch(task.url).then(res => res.text()).then((json) => {\r\n            const blob = new Blob([json], { type: 'application/json' });\r\n            blob.arrayBuffer().then(arrayBuffer => {\r\n                task.postResponse(null, arrayBuffer, [arrayBuffer]);\r\n            });\r\n        }).catch(error => {\r\n            console.error(error);\r\n        }).finally(() => {\r\n            task.abort = true;\r\n            loopTask(task);\r\n        });\r\n    }\r\n}\r\nvar actor;\r\nexport function getFetchDataActor() {\r\n    if (!maptalks.worker) {\r\n        console.error('maptalks.worker is not defined,You can\\'t use');\r\n    }\r\n    if (!actor) {\r\n        actor = new maptalks.worker.Actor(fetchDataWorkerKey);\r\n    }\r\n    return actor;\r\n}\r\n//# sourceMappingURL=fetchdataworker.js.map","import * as maptalks from 'maptalks';\r\nimport * as THREE from 'three';\r\nimport BaseObject from './BaseObject';\r\nimport Bar from './Bar';\r\nimport Line from './Line';\r\nimport ExtrudeLine from './ExtrudeLine';\r\nimport ExtrudePolygon from './ExtrudePolygon';\r\nimport Model from './Model';\r\nimport ExtrudeLineTrail from './ExtrudeLineTrail';\r\nimport ExtrudePolygons from './ExtrudePolygons';\r\nimport Point from './Point';\r\nimport Points from './Points';\r\nimport Bars from './Bars';\r\nimport ExtrudeLines from './ExtrudeLines';\r\nimport Lines from './Lines';\r\nimport ThreeVectorTileLayer from './ThreeVectorTileLayer';\r\nimport Terrain from './Terrain';\r\nimport TerrainVectorTileLayer from './TerrainVectorTileLayer';\r\nimport HeatMap from './HeatMap';\r\nimport { setRaycasterLinePrecision } from './util/ThreeAdaptUtil';\r\nimport GPUPick from './GPUPick';\r\nimport FatLine from './FatLine';\r\nimport FatLines from './FatLines';\r\nimport Box from './Box';\r\nimport Boxs from './Boxs';\r\nimport MergedMixin from './MergedMixin';\r\nimport * as GeoJSONUtil from './util/GeoJSONUtil';\r\nimport * as GeoUtil from './util/GeoUtil';\r\nimport * as MergeGeometryUtil from './util/MergeGeometryUtil';\r\nimport * as ExtrudeUtil from './util/ExtrudeUtil';\r\nimport * as LineUtil from './util/LineUtil';\r\nimport * as IdentifyUtil from './util/IdentifyUtil';\r\nimport * as geometryExtrude from 'deyihu-geometry-extrude';\r\nimport LineMaterial from './util/fatline/LineMaterial';\r\nimport { getWorkerCode, getWorkerName } from './worker/getworker';\r\nimport { BaseObjectTaskManager } from './BaseObjectTaskManager';\r\nimport { fetchDataWorkerKey, fetchDataWorkerCode, getFetchDataActor } from './worker/fetchdataworker';\r\nconst options = {\r\n    'renderer': 'gl',\r\n    'doubleBuffer': false,\r\n    'glOptions': null,\r\n    'geometryEvents': true,\r\n    'identifyCountOnEvent': 0,\r\n    'forceRenderOnZooming': true,\r\n    'loopRenderCount': 50\r\n};\r\nconst RADIAN = Math.PI / 180;\r\nconst LINEPRECISIONS = [\r\n    [4000, 220],\r\n    [2000, 100],\r\n    [1000, 30],\r\n    [500, 15],\r\n    [100, 5],\r\n    [50, 2],\r\n    [10, 1],\r\n    [5, 0.7],\r\n    [2, 0.1],\r\n    [1, 0.05],\r\n    [0.5, 0.02],\r\n    [0.4, 0.01],\r\n    [0.1, 0.005],\r\n    [0.05, 0.002],\r\n    [0.01, 0.001]\r\n];\r\nconst EVENTS = [\r\n    'mousemove',\r\n    'click',\r\n    'mousedown',\r\n    'mouseup',\r\n    'dblclick',\r\n    'contextmenu',\r\n    'touchstart',\r\n    'touchmove',\r\n    'touchend'\r\n];\r\nconst TEMP_COORD = new maptalks.Coordinate(0, 0);\r\nconst TEMP_POINT = new maptalks.Point(0, 0);\r\nconst KEY_FBO = '__webglFramebuffer';\r\n// const MATRIX4 = new THREE.Matrix4();\r\n/**\r\n * A Layer to render with THREE.JS (http://threejs.org), the most popular library for WebGL. <br>\r\n *\r\n * @classdesc\r\n * A layer to render with THREE.JS\r\n * @example\r\n *  var layer = new maptalks.ThreeLayer('three');\r\n *\r\n *  layer.prepareToDraw = function (gl, scene, camera) {\r\n *      var size = map.getSize();\r\n *      return [size.width, size.height]\r\n *  };\r\n *\r\n *  layer.draw = function (gl, view, scene, camera, width,height) {\r\n *      //...\r\n *  };\r\n *  layer.addTo(map);\r\n * @class\r\n * @category layer\r\n * @extends {maptalks.CanvasLayer}\r\n * @param {String|Number} id - layer's id\r\n * @param {Object} options - options defined in [options]{@link maptalks.ThreeLayer#options}\r\n */\r\nclass ThreeLayer extends maptalks.CanvasLayer {\r\n    constructor(id, options) {\r\n        super(id, options);\r\n        this._animationBaseObjectMap = {};\r\n        this._needsUpdate = true;\r\n        this._mousemoveTimeOut = 0;\r\n        this._baseObjects = [];\r\n        this._delayMeshes = [];\r\n        this.type = 'ThreeLayer';\r\n    }\r\n    isMercator() {\r\n        const map = this.getMap();\r\n        if (!map) {\r\n            return false;\r\n        }\r\n        const sp = map.getSpatialReference();\r\n        const prj = sp._projection, res = sp._resolutions;\r\n        if (prj && prj.code === 'EPSG:3857' && res && res.length && Math.floor(res[0]) === 156543 && map.getGLRes) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    isRendering() {\r\n        const map = this.getMap();\r\n        if (!map) {\r\n            return false;\r\n        }\r\n        return map.isInteracting() || map.isAnimating();\r\n    }\r\n    prepareToDraw(...args) {\r\n    }\r\n    /**\r\n     * Draw method of ThreeLayer\r\n     * In default, it calls renderScene, refresh the camera and the scene\r\n     */\r\n    draw(gl, view, scene, camera, timeStamp, context) {\r\n        this.renderScene(context, this);\r\n    }\r\n    /**\r\n     * Draw method of ThreeLayer when map is interacting\r\n     * In default, it calls renderScene, refresh the camera and the scene\r\n     */\r\n    drawOnInteracting(gl, view, scene, camera, event, timeStamp, context) {\r\n        this.renderScene(context, this);\r\n    }\r\n    /**\r\n     * Convert a geographic coordinate to THREE Vector3\r\n     * @param  {maptalks.Coordinate} coordinate - coordinate\r\n     * @param {Number} [z=0] z value\r\n     * @return {THREE.Vector3}\r\n     */\r\n    coordinateToVector3(coordinate, z = 0) {\r\n        const map = this.getMap();\r\n        if (!map) {\r\n            return null;\r\n        }\r\n        const isArray = Array.isArray(coordinate);\r\n        if (isArray) {\r\n            TEMP_COORD.x = coordinate[0];\r\n            TEMP_COORD.y = coordinate[1];\r\n        }\r\n        else if (!(coordinate instanceof maptalks.Coordinate)) {\r\n            coordinate = new maptalks.Coordinate(coordinate);\r\n        }\r\n        const res = getGLRes(map);\r\n        const p = coordinateToPoint(map, isArray ? TEMP_COORD : coordinate, res, TEMP_POINT);\r\n        return new THREE.Vector3(p.x, p.y, z);\r\n    }\r\n    coordinatiesToGLFloatArray(coordinaties, centerPt) {\r\n        const map = this.getMap();\r\n        if (!map) {\r\n            return null;\r\n        }\r\n        const res = getGLRes(map);\r\n        const len = coordinaties.length;\r\n        const array = new Float32Array(len * 2);\r\n        const array3d = new Float32Array(len * 3);\r\n        for (let i = 0; i < len; i++) {\r\n            let coordinate = coordinaties[i];\r\n            const isArray = Array.isArray(coordinate);\r\n            if (isArray) {\r\n                TEMP_COORD.x = coordinate[0];\r\n                TEMP_COORD.y = coordinate[1];\r\n            }\r\n            else if (!(coordinate instanceof maptalks.Coordinate)) {\r\n                coordinate = new maptalks.Coordinate(coordinate);\r\n            }\r\n            const p = coordinateToPoint(map, isArray ? TEMP_COORD : coordinate, res, TEMP_POINT);\r\n            p.x -= centerPt.x;\r\n            p.y -= centerPt.y;\r\n            const idx = i * 2;\r\n            array[idx] = p.x;\r\n            array[idx + 1] = p.y;\r\n            const idx1 = i * 3;\r\n            array3d[idx1] = p.x;\r\n            array3d[idx1 + 1] = p.y;\r\n            array3d[idx1 + 2] = 0;\r\n        }\r\n        return {\r\n            positions: array3d,\r\n            positons2d: array\r\n        };\r\n    }\r\n    coordinatiesToGLArray(coordinaties, centerPt) {\r\n        const map = this.getMap();\r\n        if (!map) {\r\n            return null;\r\n        }\r\n        const res = getGLRes(map);\r\n        const len = coordinaties.length;\r\n        const array = new Array(len);\r\n        for (let i = 0; i < len; i++) {\r\n            let coordinate = coordinaties[i];\r\n            const isArray = Array.isArray(coordinate);\r\n            if (isArray) {\r\n                TEMP_COORD.x = coordinate[0];\r\n                TEMP_COORD.y = coordinate[1];\r\n            }\r\n            else if (!(coordinate instanceof maptalks.Coordinate)) {\r\n                coordinate = new maptalks.Coordinate(coordinate);\r\n            }\r\n            const p = coordinateToPoint(map, isArray ? TEMP_COORD : coordinate, res, TEMP_POINT);\r\n            p.x -= centerPt.x;\r\n            p.y -= centerPt.y;\r\n            array[i] = [p.x, p.y];\r\n        }\r\n        return array;\r\n    }\r\n    /**\r\n     * Convert geographic distance to THREE Vector3\r\n     * @param  {Number} w - width\r\n     * @param  {Number} h - height\r\n     * @return {THREE.Vector3}\r\n     */\r\n    distanceToVector3(w, h, coord) {\r\n        if ((w === 0 && h === 0) || (!maptalks.Util.isNumber(w) || !maptalks.Util.isNumber(h))) {\r\n            return new THREE.Vector3(0, 0, 0);\r\n        }\r\n        const map = this.getMap();\r\n        const res = getGLRes(map);\r\n        let center = coord || map.getCenter();\r\n        if (!(center instanceof maptalks.Coordinate)) {\r\n            center = new maptalks.Coordinate(center);\r\n        }\r\n        const target = map.locate(center, w, h);\r\n        const p0 = coordinateToPoint(map, center, res), p1 = coordinateToPoint(map, target, res);\r\n        const x = Math.abs(p1.x - p0.x) * maptalks.Util.sign(w);\r\n        const y = Math.abs(p1.y - p0.y) * maptalks.Util.sign(h);\r\n        return new THREE.Vector3(x, y, 0);\r\n    }\r\n    /**\r\n     * Convert a Polygon or a MultiPolygon to THREE shape\r\n     * @param  {maptalks.Polygon|maptalks.MultiPolygon} polygon - polygon or multipolygon\r\n     * @return {THREE.Shape}\r\n     */\r\n    toShape(polygon) {\r\n        if (!polygon) {\r\n            return null;\r\n        }\r\n        if (polygon instanceof maptalks.MultiPolygon) {\r\n            return polygon.getGeometries().map(c => this.toShape(c));\r\n        }\r\n        const center = polygon.getCenter();\r\n        const centerPt = this.coordinateToVector3(center);\r\n        const shell = polygon.getShell();\r\n        const outer = shell.map(c => {\r\n            const vector = this.coordinateToVector3(c).sub(centerPt);\r\n            return new THREE.Vector2(vector.x, vector.y);\r\n        });\r\n        const shape = new THREE.Shape(outer);\r\n        const holes = polygon.getHoles();\r\n        if (holes && holes.length > 0) {\r\n            shape.holes = holes.map(item => {\r\n                const pts = item.map(c => {\r\n                    const vector = this.coordinateToVector3(c).sub(centerPt);\r\n                    return new THREE.Vector2(vector.x, vector.y);\r\n                });\r\n                return new THREE.Shape(pts);\r\n            });\r\n        }\r\n        return shape;\r\n    }\r\n    /**\r\n     * todo   This should also be extracted as a component\r\n     * @param {*} polygon\r\n     * @param {*} altitude\r\n     * @param {*} material\r\n     * @param {*} height\r\n     */\r\n    toExtrudeMesh(polygon, altitude, material, height) {\r\n        if (!polygon) {\r\n            return null;\r\n        }\r\n        if (polygon instanceof maptalks.MultiPolygon) {\r\n            return polygon.getGeometries().map(c => this.toExtrudeMesh(c, altitude, material, height));\r\n        }\r\n        const rings = polygon.getCoordinates();\r\n        rings.forEach(ring => {\r\n            const length = ring.length;\r\n            for (let i = length - 1; i >= 1; i--) {\r\n                if (ring[i].equals(ring[i - 1])) {\r\n                    ring.splice(i, 1);\r\n                }\r\n            }\r\n        });\r\n        polygon.setCoordinates(rings);\r\n        const shape = this.toShape(polygon);\r\n        const center = this.coordinateToVector3(polygon.getCenter());\r\n        height = maptalks.Util.isNumber(height) ? height : altitude;\r\n        height = this.distanceToVector3(height, height).x;\r\n        const amount = this.distanceToVector3(altitude, altitude).x;\r\n        //{ amount: extrudeH, bevelEnabled: true, bevelSegments: 2, steps: 2, bevelSize: 1, bevelThickness: 1 };\r\n        const config = { 'bevelEnabled': false, 'bevelSize': 1 };\r\n        const name = parseInt(THREE.REVISION) >= 93 ? 'depth' : 'amount';\r\n        config[name] = height;\r\n        const geom = new THREE.ExtrudeGeometry(shape, config);\r\n        let buffGeom = geom;\r\n        if (THREE.BufferGeometry.prototype.fromGeometry) {\r\n            buffGeom = new THREE.BufferGeometry();\r\n            buffGeom.fromGeometry(geom);\r\n        }\r\n        const mesh = new THREE.Mesh(buffGeom, material);\r\n        mesh.position.set(center.x, center.y, amount - height);\r\n        return mesh;\r\n    }\r\n    /**\r\n     *\r\n     * @param {maptalks.Polygon|maptalks.MultiPolygon} polygon\r\n     * @param {Object} options\r\n     * @param {THREE.Material} material\r\n     */\r\n    toExtrudePolygon(polygon, options, material) {\r\n        return new ExtrudePolygon(polygon, options, material, this);\r\n    }\r\n    /**\r\n     *\r\n     * @param {maptalks.Coordinate} coordinate\r\n     * @param {Object} options\r\n     * @param {THREE.Material} material\r\n     */\r\n    toBar(coordinate, options, material) {\r\n        return new Bar(coordinate, options, material, this);\r\n    }\r\n    /**\r\n    *\r\n    * @param {maptalks.LineString} lineString\r\n    * @param {Object} options\r\n    * @param {THREE.LineMaterial} material\r\n    */\r\n    toLine(lineString, options, material) {\r\n        return new Line(lineString, options, material, this);\r\n    }\r\n    /**\r\n     *\r\n     * @param {maptalks.LineString} lineString\r\n     * @param {Object} options\r\n     * @param {THREE.Material} material\r\n     */\r\n    toExtrudeLine(lineString, options, material) {\r\n        return new ExtrudeLine(lineString, options, material, this);\r\n    }\r\n    /**\r\n     *\r\n     * @param {THREE.Mesh|THREE.Group} model\r\n     * @param {Object} options\r\n     */\r\n    toModel(model, options) {\r\n        return new Model(model, options, this);\r\n    }\r\n    /**\r\n     *\r\n     * @param {maptalks.LineString} lineString\r\n     * @param {*} options\r\n     * @param {THREE.Material} material\r\n     */\r\n    toExtrudeLineTrail(lineString, options, material) {\r\n        return new ExtrudeLineTrail(lineString, options, material, this);\r\n    }\r\n    /**\r\n     *\r\n     * @param {*} polygons\r\n     * @param {*} options\r\n     * @param {*} material\r\n     */\r\n    toExtrudePolygons(polygons, options, material) {\r\n        return new ExtrudePolygons(polygons, options, material, this);\r\n    }\r\n    /**\r\n     *\r\n     * @param {maptalks.Coordinate} coordinate\r\n     * @param {*} options\r\n     * @param {*} material\r\n     */\r\n    toPoint(coordinate, options, material) {\r\n        return new Point(coordinate, options, material, this);\r\n    }\r\n    /**\r\n     *\r\n     * @param {Array} points\r\n     * @param {*} options\r\n     * @param {*} material\r\n     */\r\n    toPoints(points, options, material) {\r\n        return new Points(points, options, material, this);\r\n    }\r\n    /**\r\n     *\r\n     * @param {Array} points\r\n     * @param {*} options\r\n     * @param {*} material\r\n     */\r\n    toBars(points, options, material) {\r\n        return new Bars(points, options, material, this);\r\n    }\r\n    /**\r\n     *\r\n     * @param {Array[maptalks.LineString]} lineStrings\r\n     * @param {*} options\r\n     * @param {*} material\r\n     */\r\n    toExtrudeLines(lineStrings, options, material) {\r\n        return new ExtrudeLines(lineStrings, options, material, this);\r\n    }\r\n    /**\r\n     *\r\n     * @param {Array[maptalks.LineString]} lineStrings\r\n     * @param {*} options\r\n     * @param {*} material\r\n     */\r\n    toLines(lineStrings, options, material) {\r\n        return new Lines(lineStrings, options, material, this);\r\n    }\r\n    /**\r\n     *\r\n     * @param {*} url\r\n     * @param {*} options\r\n     * @param {*} getMaterial\r\n     * @param {*} worker\r\n     */\r\n    toThreeVectorTileLayer(url, options, getMaterial) {\r\n        return new ThreeVectorTileLayer(url, options, getMaterial, this);\r\n    }\r\n    /**\r\n     *\r\n     * @param {*} extent\r\n     * @param {*} options\r\n     * @param {*} material\r\n     */\r\n    toTerrain(extent, options, material) {\r\n        return new Terrain(extent, options, material, this);\r\n    }\r\n    /**\r\n     *\r\n     * @param {*} url\r\n     * @param {*} options\r\n     * @param {*} material\r\n     */\r\n    toTerrainVectorTileLayer(url, options, material) {\r\n        return new TerrainVectorTileLayer(url, options, material, this);\r\n    }\r\n    /**\r\n     *\r\n     * @param {*} data\r\n     * @param {*} options\r\n     * @param {*} material\r\n     */\r\n    toHeatMap(data, options, material) {\r\n        return new HeatMap(data, options, material, this);\r\n    }\r\n    /**\r\n     *\r\n     * @param {*} lineString\r\n     * @param {*} options\r\n     * @param {*} material\r\n     */\r\n    toFatLine(lineString, options, material) {\r\n        return new FatLine(lineString, options, material, this);\r\n    }\r\n    /**\r\n     *\r\n     * @param {*} lineStrings\r\n     * @param {*} options\r\n     * @param {*} material\r\n     */\r\n    toFatLines(lineStrings, options, material) {\r\n        return new FatLines(lineStrings, options, material, this);\r\n    }\r\n    /**\r\n     *\r\n     * @param {*} coorindate\r\n     * @param {*} options\r\n     * @param {*} material\r\n     */\r\n    toBox(coorindate, options, material) {\r\n        return new Box(coorindate, options, material, this);\r\n    }\r\n    /**\r\n     *\r\n     * @param {*} points\r\n     * @param {*} options\r\n     * @param {*} material\r\n     */\r\n    toBoxs(points, options, material) {\r\n        return new Boxs(points, options, material, this);\r\n    }\r\n    getBaseObjects() {\r\n        return this.getMeshes().filter((mesh => {\r\n            return mesh instanceof BaseObject;\r\n        }));\r\n    }\r\n    getMeshes() {\r\n        const scene = this.getScene();\r\n        if (!scene) {\r\n            return [];\r\n        }\r\n        const meshes = [];\r\n        for (let i = 0, len = scene.children.length; i < len; i++) {\r\n            const child = scene.children[i];\r\n            if (child instanceof THREE.Object3D && !(child instanceof THREE.Camera)) {\r\n                meshes.push(child['__parent'] || child);\r\n            }\r\n        }\r\n        return meshes;\r\n    }\r\n    clear() {\r\n        return this.clearMesh();\r\n    }\r\n    clearMesh() {\r\n        const scene = this.getScene();\r\n        if (!scene) {\r\n            return this;\r\n        }\r\n        for (let i = scene.children.length - 1; i >= 0; i--) {\r\n            const child = scene.children[i];\r\n            if (child instanceof THREE.Object3D && !(child instanceof THREE.Camera)) {\r\n                scene.remove(child);\r\n                const parent = child['__parent'];\r\n                if (parent && parent instanceof BaseObject) {\r\n                    parent.isAdd = false;\r\n                    parent._fire('remove', { target: parent });\r\n                    delete this._animationBaseObjectMap[child.uuid];\r\n                }\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n    lookAt(vector) {\r\n        const renderer = this._getRenderer();\r\n        if (renderer) {\r\n            renderer.context.lookAt(vector);\r\n        }\r\n        return this;\r\n    }\r\n    getCamera() {\r\n        const renderer = this._getRenderer();\r\n        if (renderer) {\r\n            return renderer.camera;\r\n        }\r\n        return null;\r\n    }\r\n    getScene() {\r\n        const renderer = this._getRenderer();\r\n        if (renderer) {\r\n            return renderer.scene;\r\n        }\r\n        return null;\r\n    }\r\n    renderScene(context, layer) {\r\n        const renderer = this._getRenderer();\r\n        if (renderer) {\r\n            renderer.clearCanvas();\r\n            renderer.renderScene(context);\r\n            //外部调用时，直接redraw\r\n            if (!layer) {\r\n                renderer.setToRedraw();\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n    loop(render = false) {\r\n        const delayMeshes = this._delayMeshes;\r\n        if (!delayMeshes.length) {\r\n            return;\r\n        }\r\n        const map = this.getMap();\r\n        if (!map || map.isAnimating() || map.isInteracting()) {\r\n            return;\r\n        }\r\n        const loopRenderCount = this.options.loopRenderCount || 50;\r\n        const meshes = delayMeshes.slice(0, loopRenderCount);\r\n        if (meshes) {\r\n            this.addMesh(meshes, render);\r\n        }\r\n        delayMeshes.splice(0, loopRenderCount);\r\n    }\r\n    renderPickScene() {\r\n        const renderer = this._getRenderer();\r\n        if (renderer) {\r\n            const pick = renderer.pick;\r\n            if (pick) {\r\n                pick.pick(this._containerPoint);\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n    getThreeRenderer() {\r\n        const renderer = this._getRenderer();\r\n        if (renderer) {\r\n            return renderer.context;\r\n        }\r\n        return null;\r\n    }\r\n    getPick() {\r\n        const renderer = this._getRenderer();\r\n        if (renderer) {\r\n            return renderer.pick;\r\n        }\r\n        return null;\r\n    }\r\n    delayAddMesh(meshes) {\r\n        if (!meshes)\r\n            return this;\r\n        if (!Array.isArray(meshes)) {\r\n            meshes = [meshes];\r\n        }\r\n        for (let i = 0, len = meshes.length; i < len; i++) {\r\n            this._delayMeshes.push(meshes[i]);\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * add object3ds\r\n     * @param {BaseObject} meshes\r\n     */\r\n    addMesh(meshes, render = true) {\r\n        if (!meshes)\r\n            return this;\r\n        if (!Array.isArray(meshes)) {\r\n            meshes = [meshes];\r\n        }\r\n        const scene = this.getScene();\r\n        meshes.forEach(mesh => {\r\n            if (mesh instanceof BaseObject) {\r\n                scene.add(mesh.getObject3d());\r\n                if (!mesh.isAdd) {\r\n                    mesh.isAdd = true;\r\n                    mesh._fire('add', { target: mesh });\r\n                }\r\n                if (mesh._animation && maptalks.Util.isFunction(mesh._animation)) {\r\n                    this._animationBaseObjectMap[mesh.getObject3d().uuid] = mesh;\r\n                }\r\n            }\r\n            else if (mesh instanceof THREE.Object3D) {\r\n                scene.add(mesh);\r\n            }\r\n        });\r\n        this._zoomend();\r\n        if (render) {\r\n            const renderer = this._getRenderer();\r\n            if (renderer) {\r\n                renderer.setToRedraw();\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * remove object3ds\r\n     * @param {BaseObject} meshes\r\n     */\r\n    removeMesh(meshes, render = true) {\r\n        if (!meshes)\r\n            return this;\r\n        if (!Array.isArray(meshes)) {\r\n            meshes = [meshes];\r\n        }\r\n        const scene = this.getScene();\r\n        meshes.forEach(mesh => {\r\n            if (mesh instanceof BaseObject) {\r\n                scene.remove(mesh.getObject3d());\r\n                if (mesh.isAdd) {\r\n                    mesh.isAdd = false;\r\n                    mesh._fire('remove', { target: mesh });\r\n                }\r\n                if (mesh._animation && maptalks.Util.isFunction(mesh._animation)) {\r\n                    delete this._animationBaseObjectMap[mesh.getObject3d().uuid];\r\n                }\r\n                const delayMeshes = this._delayMeshes;\r\n                if (delayMeshes.length) {\r\n                    for (let i = 0, len = delayMeshes.length; i < len; i++) {\r\n                        if (delayMeshes[i] === mesh) {\r\n                            delayMeshes.splice(i, 1);\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            else if (mesh instanceof THREE.Object3D) {\r\n                scene.remove(mesh);\r\n            }\r\n        });\r\n        if (render) {\r\n            const renderer = this._getRenderer();\r\n            if (renderer) {\r\n                renderer.setToRedraw();\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n    _initRaycaster() {\r\n        if (!this._raycaster) {\r\n            this._raycaster = new THREE.Raycaster();\r\n            this._mouse = new THREE.Vector2();\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     *\r\n     * @param {Coordinate} coordinate\r\n     * @param {Object} options\r\n     * @return {Array}\r\n     */\r\n    identify(coordinate, options) {\r\n        if (!coordinate) {\r\n            console.error('coordinate is null,it should be Coordinate');\r\n            return [];\r\n        }\r\n        if (Array.isArray(coordinate)) {\r\n            coordinate = new maptalks.Coordinate(coordinate);\r\n        }\r\n        if (!(coordinate instanceof maptalks.Coordinate)) {\r\n            console.error('coordinate type is error,it should be Coordinate');\r\n            return [];\r\n        }\r\n        const p = this.getMap().coordToContainerPoint(coordinate);\r\n        this._containerPoint = p;\r\n        const { x, y } = p;\r\n        this._initRaycaster();\r\n        const raycaster = this._raycaster, mouse = this._mouse, camera = this.getCamera(), scene = this.getScene(), size = this.getMap().getSize();\r\n        //fix Errors will be reported when the layer is not initialized\r\n        if (!scene) {\r\n            return [];\r\n        }\r\n        const width = size.width, height = size.height;\r\n        mouse.x = (x / width) * 2 - 1;\r\n        mouse.y = -(y / height) * 2 + 1;\r\n        raycaster.setFromCamera(mouse, camera);\r\n        //set linePrecision for THREE.Line\r\n        setRaycasterLinePrecision(raycaster, this._getLinePrecision(this.getMap().getResolution()));\r\n        const children = [], hasidentifyChildren = [];\r\n        scene.children.forEach(mesh => {\r\n            const parent = mesh['__parent'];\r\n            if (parent && parent.getOptions) {\r\n                const baseObject = parent;\r\n                const interactive = baseObject.getOptions().interactive;\r\n                if (interactive && baseObject.isVisible()) {\r\n                    //If baseobject has its own hit detection\r\n                    if (baseObject.identify && maptalks.Util.isFunction(baseObject.identify)) {\r\n                        hasidentifyChildren.push(baseObject);\r\n                    }\r\n                    else {\r\n                        children.push(mesh);\r\n                    }\r\n                }\r\n            }\r\n            else if (mesh instanceof THREE.Mesh || mesh instanceof THREE.Group) {\r\n                children.push(mesh);\r\n            }\r\n        });\r\n        let baseObjects = [];\r\n        const intersects = raycaster.intersectObjects(children, true);\r\n        if (intersects && Array.isArray(intersects) && intersects.length) {\r\n            baseObjects = intersects.map(intersect => {\r\n                let object = intersect.object;\r\n                object = this._recursionMesh(object) || {};\r\n                const baseObject = object['__parent'] || object;\r\n                baseObject.faceIndex = intersect.faceIndex;\r\n                baseObject.index = intersect.index;\r\n                return baseObject;\r\n            });\r\n        }\r\n        this.renderPickScene();\r\n        if (hasidentifyChildren.length) {\r\n            hasidentifyChildren.forEach(baseObject => {\r\n                // baseObject identify\r\n                if (baseObject.identify(coordinate)) {\r\n                    baseObjects.push(baseObject);\r\n                }\r\n            });\r\n        }\r\n        const len = baseObjects.length;\r\n        for (let i = 0; i < len; i++) {\r\n            if (baseObjects[i]) {\r\n                for (let j = i + 1; j < len; j++) {\r\n                    if (baseObjects[i] === baseObjects[j]) {\r\n                        baseObjects.splice(j, 1);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        options = maptalks.Util.extend({}, options);\r\n        const count = options['count'];\r\n        return (maptalks.Util.isNumber(count) && count > 0 ? baseObjects.slice(0, count) : baseObjects);\r\n    }\r\n    /**\r\n    * Recursively finding the root node of mesh,Until it is scene node\r\n    * @param {*} mesh\r\n    */\r\n    _recursionMesh(mesh) {\r\n        while (mesh && ((mesh.parent !== this.getScene()))) {\r\n            mesh = mesh.parent;\r\n        }\r\n        return mesh;\r\n    }\r\n    //get Line Precision by Resolution\r\n    _getLinePrecision(res = 10) {\r\n        for (let i = 0, len = LINEPRECISIONS.length; i < len; i++) {\r\n            const [resLevel, precision] = LINEPRECISIONS[i];\r\n            if (res > resLevel) {\r\n                return precision;\r\n            }\r\n        }\r\n        return 0.01;\r\n    }\r\n    /**\r\n     * fire baseObject events\r\n     * @param {*} e\r\n     */\r\n    _identifyBaseObjectEvents(e) {\r\n        if (!this.options.geometryEvents) {\r\n            return this;\r\n        }\r\n        const map = this.map || this.getMap();\r\n        //When map interaction, do not carry out mouse movement detection, which can have better performance\r\n        if (map.isInteracting() || !map.options.geometryEvents) {\r\n            return this;\r\n        }\r\n        const { type, coordinate } = e;\r\n        const now = maptalks.Util.now();\r\n        if (this._mousemoveTimeOut && type === 'mousemove') {\r\n            if (now - this._mousemoveTimeOut < 64) {\r\n                return this;\r\n            }\r\n        }\r\n        this._mousemoveTimeOut = now;\r\n        // map.resetCursor('default');\r\n        const identifyCountOnEvent = this.options['identifyCountOnEvent'];\r\n        let count = Math.max(0, maptalks.Util.isNumber(identifyCountOnEvent) ? identifyCountOnEvent : 0);\r\n        if (count === 0) {\r\n            count = Infinity;\r\n        }\r\n        const baseObjects = this.identify(coordinate, { count });\r\n        const scene = this.getScene();\r\n        if (baseObjects.length === 0 && scene) {\r\n            for (let i = 0, len = scene.children.length; i < len; i++) {\r\n                const child = scene.children[i] || {};\r\n                const parent = child['__parent'];\r\n                if (parent) {\r\n                    parent.fire('empty', Object.assign({}, e, { target: parent }));\r\n                }\r\n            }\r\n        }\r\n        if (type === 'mousemove') {\r\n            // if (baseObjects.length) {\r\n            //     map.setCursor('pointer');\r\n            // }\r\n            // mouseout objects\r\n            const outBaseObjects = [];\r\n            if (this._baseObjects) {\r\n                this._baseObjects.forEach(baseObject => {\r\n                    let isOut = true;\r\n                    baseObjects.forEach(baseO => {\r\n                        if (baseObject === baseO) {\r\n                            isOut = false;\r\n                        }\r\n                    });\r\n                    if (isOut) {\r\n                        outBaseObjects.push(baseObject);\r\n                    }\r\n                });\r\n            }\r\n            outBaseObjects.forEach(baseObject => {\r\n                if (baseObject && baseObject instanceof BaseObject) {\r\n                    // reset _mouseover status\r\n                    // Deal with the mergedmesh\r\n                    if (baseObject.getSelectMesh) {\r\n                        if (!baseObject.isHide) {\r\n                            baseObject._mouseover = false;\r\n                            baseObject.fire('mouseout', Object.assign({}, e, { target: baseObject, type: 'mouseout', selectMesh: null }));\r\n                            baseObject.closeToolTip();\r\n                        }\r\n                    }\r\n                    else {\r\n                        baseObject._mouseover = false;\r\n                        baseObject.fire('mouseout', Object.assign({}, e, { target: baseObject, type: 'mouseout' }));\r\n                        baseObject.closeToolTip();\r\n                    }\r\n                }\r\n            });\r\n            baseObjects.forEach(baseObject => {\r\n                if (baseObject instanceof BaseObject) {\r\n                    if (!baseObject._mouseover) {\r\n                        baseObject.fire('mouseover', Object.assign({}, e, { target: baseObject, type: 'mouseover', selectMesh: (baseObject.getSelectMesh ? baseObject.getSelectMesh() : null) }));\r\n                        baseObject._mouseover = true;\r\n                    }\r\n                    baseObject.fire(type, Object.assign({}, e, { target: baseObject, selectMesh: (baseObject.getSelectMesh ? baseObject.getSelectMesh() : null) }));\r\n                    // tooltip\r\n                    const tooltip = baseObject.getToolTip();\r\n                    if (tooltip && (!tooltip._owner)) {\r\n                        tooltip.addTo(baseObject);\r\n                    }\r\n                    baseObject.openToolTip(coordinate);\r\n                }\r\n            });\r\n            this._baseObjects = baseObjects;\r\n        }\r\n        else {\r\n            baseObjects.forEach(baseObject => {\r\n                if (baseObject instanceof BaseObject) {\r\n                    baseObject.fire(type, Object.assign({}, e, { target: baseObject, selectMesh: (baseObject.getSelectMesh ? baseObject.getSelectMesh() : null) }));\r\n                    if (type === 'click') {\r\n                        const infoWindow = baseObject.getInfoWindow();\r\n                        if (infoWindow && (!infoWindow._owner)) {\r\n                            infoWindow.addTo(baseObject);\r\n                        }\r\n                        baseObject.openInfoWindow(coordinate);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     *map zoom event\r\n     */\r\n    _zoomend() {\r\n        const scene = this.getScene();\r\n        if (!scene) {\r\n            return;\r\n        }\r\n        const zoom = this.getMap().getZoom();\r\n        scene.children.forEach(mesh => {\r\n            const parent = mesh['__parent'];\r\n            if (parent && parent.getOptions) {\r\n                const baseObject = parent;\r\n                if (baseObject.zoomChange && maptalks.Util.isFunction(baseObject.zoomChange)) {\r\n                    baseObject.zoomChange(zoom);\r\n                }\r\n                const minZoom = baseObject.getMinZoom(), maxZoom = baseObject.getMaxZoom();\r\n                if (zoom < minZoom || zoom > maxZoom) {\r\n                    if (baseObject.isVisible()) {\r\n                        baseObject.getObject3d().visible = false;\r\n                    }\r\n                    baseObject._zoomVisible = false;\r\n                }\r\n                else if (minZoom <= zoom && zoom <= maxZoom) {\r\n                    if (baseObject._visible) {\r\n                        baseObject.getObject3d().visible = true;\r\n                    }\r\n                    baseObject._zoomVisible = true;\r\n                }\r\n            }\r\n        });\r\n    }\r\n    onAdd() {\r\n        super.onAdd();\r\n        const map = this.map || this.getMap();\r\n        if (!map)\r\n            return this;\r\n        EVENTS.forEach(event => {\r\n            map.on(event, this._identifyBaseObjectEvents, this);\r\n        });\r\n        this._needsUpdate = true;\r\n        if (!this._animationBaseObjectMap) {\r\n            this._animationBaseObjectMap = {};\r\n        }\r\n        map.on('zooming zoomend', this._zoomend, this);\r\n        return this;\r\n    }\r\n    onRemove() {\r\n        super.onRemove();\r\n        const map = this.map || this.getMap();\r\n        if (!map)\r\n            return this;\r\n        EVENTS.forEach(event => {\r\n            map.off(event, this._identifyBaseObjectEvents, this);\r\n        });\r\n        map.off('zooming zoomend', this._zoomend, this);\r\n        return this;\r\n    }\r\n    _callbackBaseObjectAnimation() {\r\n        const layer = this;\r\n        if (layer._animationBaseObjectMap) {\r\n            for (const uuid in layer._animationBaseObjectMap) {\r\n                const baseObject = layer._animationBaseObjectMap[uuid];\r\n                baseObject._animation();\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * To make map's 2d point's 1 pixel euqal with 1 pixel on XY plane in THREE's scene:\r\n     * 1. fov is 90 and camera's z is height / 2 * scale,\r\n     * 2. if fov is not 90, a ratio is caculated to transfer z to the equivalent when fov is 90\r\n     * @return {Number} fov ratio on z axis\r\n     */\r\n    _getFovRatio() {\r\n        const map = this.getMap();\r\n        const fov = map.getFov();\r\n        return Math.tan(fov / 2 * RADIAN);\r\n    }\r\n}\r\nThreeLayer.mergeOptions(options);\r\nclass ThreeRenderer extends maptalks.renderer.CanvasLayerRenderer {\r\n    constructor() {\r\n        super(...arguments);\r\n        this._renderTime = 0;\r\n        this._renderTarget = null;\r\n    }\r\n    getPrepareParams() {\r\n        return [this.scene, this.camera];\r\n    }\r\n    getDrawParams() {\r\n        return [this.scene, this.camera];\r\n    }\r\n    _drawLayer() {\r\n        super._drawLayer.apply(this, arguments);\r\n        // this.renderScene();\r\n    }\r\n    hitDetect() {\r\n        return false;\r\n    }\r\n    createCanvas() {\r\n        super.createCanvas();\r\n        this.createContext();\r\n    }\r\n    createContext() {\r\n        if (this.canvas.gl && this.canvas.gl.wrap) {\r\n            this.gl = this.canvas.gl.wrap();\r\n        }\r\n        else {\r\n            const layer = this.layer;\r\n            const attributes = layer.options.glOptions || {\r\n                alpha: true,\r\n                depth: true,\r\n                antialias: true,\r\n                stencil: true,\r\n                preserveDrawingBuffer: false\r\n            };\r\n            attributes.preserveDrawingBuffer = true;\r\n            this.gl = this.gl || this._createGLContext(this.canvas, attributes);\r\n        }\r\n        this._initThreeRenderer();\r\n        this.layer.onCanvasCreate(this.context, this.scene, this.camera);\r\n    }\r\n    _initThreeRenderer() {\r\n        this.matrix4 = new THREE.Matrix4();\r\n        const renderer = new THREE.WebGLRenderer({ 'context': this.gl, alpha: true });\r\n        renderer.autoClear = false;\r\n        renderer.setClearColor(new THREE.Color(1, 1, 1), 0);\r\n        renderer.setSize(this.canvas.width, this.canvas.height);\r\n        renderer.clear();\r\n        // renderer.canvas = this.canvas;\r\n        this.context = renderer;\r\n        const scene = this.scene = new THREE.Scene();\r\n        const map = this.layer.getMap();\r\n        const fov = map.getFov() * Math.PI / 180;\r\n        const camera = this.camera = new THREE.PerspectiveCamera(fov, map.width / map.height, map.cameraNear, map.cameraFar);\r\n        camera.matrixAutoUpdate = false;\r\n        this._syncCamera();\r\n        scene.add(camera);\r\n        this.pick = new GPUPick(this.layer);\r\n        BaseObjectTaskManager.star();\r\n    }\r\n    onCanvasCreate() {\r\n        super.onCanvasCreate();\r\n    }\r\n    resizeCanvas(canvasSize) {\r\n        if (!this.canvas) {\r\n            return;\r\n        }\r\n        let size, map = this.getMap();\r\n        if (!canvasSize) {\r\n            size = map.getSize();\r\n        }\r\n        else {\r\n            size = canvasSize;\r\n        }\r\n        // const r = maptalks.Browser.retina ? 2 : 1;\r\n        const r = map.getDevicePixelRatio ? map.getDevicePixelRatio() : (maptalks.Browser.retina ? 2 : 1);\r\n        const canvas = this.canvas;\r\n        //retina support\r\n        canvas.height = r * size['height'];\r\n        canvas.width = r * size['width'];\r\n        if (this.layer._canvas && canvas.style) {\r\n            canvas.style.width = size.width + 'px';\r\n            canvas.style.height = size.height + 'px';\r\n        }\r\n        this.context.setSize(canvas.width, canvas.height);\r\n    }\r\n    clearCanvas() {\r\n        if (!this.canvas) {\r\n            return;\r\n        }\r\n        this.context.clear();\r\n    }\r\n    prepareCanvas() {\r\n        if (!this.canvas) {\r\n            this.createCanvas();\r\n        }\r\n        else {\r\n            this.clearCanvas();\r\n        }\r\n        this.layer.fire('renderstart', { 'context': this.context });\r\n        return null;\r\n    }\r\n    renderScene(context) {\r\n        const time = maptalks.Util.now();\r\n        // Make sure to execute only once in a frame\r\n        if (time - this._renderTime >= 16) {\r\n            this.layer._callbackBaseObjectAnimation();\r\n            this._renderTime = time;\r\n        }\r\n        this._syncCamera();\r\n        // 把 WebglRenderTarget 中的 framebuffer 替换为 GroupGLLayer 中的 fbo\r\n        // 参考: https://stackoverflow.com/questions/55082573/use-webgl-texture-as-a-three-js-texture-map\r\n        // 实现有点 hacky，需要留意 three 版本变动 对它的影响\r\n        if (context && context.renderTarget) {\r\n            const { width, height } = context.renderTarget.fbo;\r\n            if (!this._renderTarget) {\r\n                this._renderTarget = new THREE.WebGLRenderTarget(width, height, {\r\n                    // depthTexture: new THREE.DepthTexture(width, height, THREE.UnsignedInt248Type)\r\n                    depthBuffer: false\r\n                });\r\n                // 绘制一次以后，才会生成 framebuffer 对象\r\n                this.context.setRenderTarget(this._renderTarget);\r\n                this.context.render(this.scene, this.camera);\r\n            }\r\n            else {\r\n                // 这里不能setSize，因为setSize中会把原有的fbo dipose掉\r\n                // this._renderTarget.setSize(width, height);\r\n                this._renderTarget.viewport.set(0, 0, width, height);\r\n                this._renderTarget.scissor.set(0, 0, width, height);\r\n            }\r\n            const renderTargetProps = this.context.properties.get(this._renderTarget);\r\n            const threeCreatedFBO = renderTargetProps[KEY_FBO];\r\n            // 用GroupGLLayer的webgl fbo对象替换WebglRenderTarget的fbo对象\r\n            renderTargetProps[KEY_FBO] = context.renderTarget.getFramebuffer(context.renderTarget.fbo);\r\n            this.context.setRenderTarget(this._renderTarget);\r\n            this.context.render(this.scene, this.camera);\r\n            renderTargetProps[KEY_FBO] = threeCreatedFBO;\r\n        }\r\n        else {\r\n            this.context.render(this.scene, this.camera);\r\n        }\r\n        this.context.setRenderTarget(null);\r\n        this.completeRender();\r\n    }\r\n    remove() {\r\n        delete this._drawContext;\r\n        if (this._renderTarget) {\r\n            this._renderTarget.dispose();\r\n            delete this._renderTarget;\r\n        }\r\n        super.remove();\r\n    }\r\n    _syncCamera() {\r\n        const map = this.getMap();\r\n        const camera = this.camera;\r\n        camera.matrix.elements = map.cameraWorldMatrix;\r\n        camera.projectionMatrix.elements = map.projMatrix;\r\n        //https://github.com/mrdoob/three.js/commit/d52afdd2ceafd690ac9e20917d0c968ff2fa7661\r\n        if (this.matrix4.invert) {\r\n            camera.projectionMatrixInverse.elements = this.matrix4.copy(camera.projectionMatrix).invert().elements;\r\n        }\r\n        else {\r\n            camera.projectionMatrixInverse.elements = this.matrix4.getInverse(camera.projectionMatrix).elements;\r\n        }\r\n    }\r\n    _createGLContext(canvas, options) {\r\n        const names = ['webgl2', 'webgl', 'experimental-webgl'];\r\n        let context = null;\r\n        /* eslint-disable no-empty */\r\n        for (let i = 0; i < names.length; ++i) {\r\n            try {\r\n                context = canvas.getContext(names[i], options);\r\n            }\r\n            catch (e) { }\r\n            if (context) {\r\n                break;\r\n            }\r\n        }\r\n        return context;\r\n        /* eslint-enable no-empty */\r\n    }\r\n}\r\nThreeLayer.registerRenderer('gl', ThreeRenderer);\r\nfunction getGLRes(map) {\r\n    return map.getGLRes ? map.getGLRes() : map.getGLZoom();\r\n}\r\nfunction coordinateToPoint(map, coordinate, res, out) {\r\n    if (map.coordToPointAtRes) {\r\n        return map.coordToPointAtRes(coordinate, res, out);\r\n    }\r\n    return map.coordinateToPoint(coordinate, res, out);\r\n}\r\nexport { ThreeLayer, ThreeRenderer, BaseObject, MergedMixin, GeoJSONUtil, MergeGeometryUtil, GeoUtil, ExtrudeUtil, LineUtil, IdentifyUtil, geometryExtrude, LineMaterial, getFetchDataActor };\r\nif (maptalks.registerWorkerAdapter) {\r\n    maptalks.registerWorkerAdapter(getWorkerName(), getWorkerCode());\r\n    maptalks.registerWorkerAdapter(fetchDataWorkerKey, fetchDataWorkerCode);\r\n}\r\n//# sourceMappingURL=index.js.map","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.quickselect = factory());\n}(this, (function () { 'use strict';\n\nfunction quickselect(arr, k, left, right, compare) {\n    quickselectStep(arr, k, left || 0, right || (arr.length - 1), compare || defaultCompare);\n}\n\nfunction quickselectStep(arr, k, left, right, compare) {\n\n    while (right > left) {\n        if (right - left > 600) {\n            var n = right - left + 1;\n            var m = k - left + 1;\n            var z = Math.log(n);\n            var s = 0.5 * Math.exp(2 * z / 3);\n            var sd = 0.5 * Math.sqrt(z * s * (n - s) / n) * (m - n / 2 < 0 ? -1 : 1);\n            var newLeft = Math.max(left, Math.floor(k - m * s / n + sd));\n            var newRight = Math.min(right, Math.floor(k + (n - m) * s / n + sd));\n            quickselectStep(arr, k, newLeft, newRight, compare);\n        }\n\n        var t = arr[k];\n        var i = left;\n        var j = right;\n\n        swap(arr, left, k);\n        if (compare(arr[right], t) > 0) swap(arr, left, right);\n\n        while (i < j) {\n            swap(arr, i, j);\n            i++;\n            j--;\n            while (compare(arr[i], t) < 0) i++;\n            while (compare(arr[j], t) > 0) j--;\n        }\n\n        if (compare(arr[left], t) === 0) swap(arr, left, j);\n        else {\n            j++;\n            swap(arr, j, right);\n        }\n\n        if (j <= k) left = j + 1;\n        if (k <= j) right = j - 1;\n    }\n}\n\nfunction swap(arr, i, j) {\n    var tmp = arr[i];\n    arr[i] = arr[j];\n    arr[j] = tmp;\n}\n\nfunction defaultCompare(a, b) {\n    return a < b ? -1 : a > b ? 1 : 0;\n}\n\nreturn quickselect;\n\n})));\n","import {\r\n    AdditiveBlending,\r\n    Color,\r\n    LinearFilter,\r\n    MeshBasicMaterial,\r\n    RGBAFormat,\r\n    ShaderMaterial,\r\n    UniformsUtils,\r\n    Vector2,\r\n    Vector3,\r\n    WebGLRenderTarget\r\n} from \"three\";\r\nimport { Pass, FullScreenQuad} from \"three/examples/jsm/postprocessing/Pass.js\";\r\nimport { CopyShader } from \"three/examples/jsm/shaders/CopyShader.js\";\r\nimport { LuminosityHighPassShader } from \"three/examples/jsm/shaders/LuminosityHighPassShader.js\";\r\n\r\nclass UnrealBloomPass extends Pass {\r\n\r\n\tconstructor( resolution, strength, radius, threshold ) {\r\n\r\n\t\tsuper();\r\n\r\n\t\tthis.strength = ( strength !== undefined ) ? strength : 1;\r\n\t\tthis.radius = radius;\r\n\t\tthis.threshold = threshold;\r\n\t\tthis.resolution = ( resolution !== undefined ) ? new Vector2( resolution.x, resolution.y ) : new Vector2( 256, 256 );\r\n\r\n\t\t// create color only once here, reuse it later inside the render function\r\n\t\tthis.clearColor = new Color( 0, 0, 0 );\r\n\r\n\t\t// render targets\r\n\t\tconst pars = { minFilter: LinearFilter, magFilter: LinearFilter, format: RGBAFormat };\r\n\t\tthis.renderTargetsHorizontal = [];\r\n\t\tthis.renderTargetsVertical = [];\r\n\t\tthis.nMips = 5;\r\n\t\tlet resx = Math.round( this.resolution.x / 2 );\r\n\t\tlet resy = Math.round( this.resolution.y / 2 );\r\n\r\n\t\tthis.renderTargetBright = new WebGLRenderTarget( resx, resy, pars );\r\n\t\tthis.renderTargetBright.texture.name = 'UnrealBloomPass.bright';\r\n\t\tthis.renderTargetBright.texture.generateMipmaps = false;\r\n\r\n\t\tfor ( let i = 0; i < this.nMips; i ++ ) {\r\n\r\n\t\t\tconst renderTargetHorizonal = new WebGLRenderTarget( resx, resy, pars );\r\n\r\n\t\t\trenderTargetHorizonal.texture.name = 'UnrealBloomPass.h' + i;\r\n\t\t\trenderTargetHorizonal.texture.generateMipmaps = false;\r\n\r\n\t\t\tthis.renderTargetsHorizontal.push( renderTargetHorizonal );\r\n\r\n\t\t\tconst renderTargetVertical = new WebGLRenderTarget( resx, resy, pars );\r\n\r\n\t\t\trenderTargetVertical.texture.name = 'UnrealBloomPass.v' + i;\r\n\t\t\trenderTargetVertical.texture.generateMipmaps = false;\r\n\r\n\t\t\tthis.renderTargetsVertical.push( renderTargetVertical );\r\n\r\n\t\t\tresx = Math.round( resx / 2 );\r\n\r\n\t\t\tresy = Math.round( resy / 2 );\r\n\r\n\t\t}\r\n\r\n\t\t// luminosity high pass material\r\n\r\n\t\tif ( LuminosityHighPassShader === undefined )\r\n\t\t\tconsole.error( 'THREE.UnrealBloomPass relies on LuminosityHighPassShader' );\r\n\r\n\t\tconst highPassShader = LuminosityHighPassShader;\r\n\t\tthis.highPassUniforms = UniformsUtils.clone( highPassShader.uniforms );\r\n\r\n\t\tthis.highPassUniforms[ 'luminosityThreshold' ].value = threshold;\r\n\t\tthis.highPassUniforms[ 'smoothWidth' ].value = 0.01;\r\n\r\n\t\tthis.materialHighPassFilter = new ShaderMaterial( {\r\n\t\t\tuniforms: this.highPassUniforms,\r\n\t\t\tvertexShader: highPassShader.vertexShader,\r\n\t\t\tfragmentShader: highPassShader.fragmentShader,\r\n\t\t\tdefines: {}\r\n\t\t} );\r\n\r\n\t\t// Gaussian Blur Materials\r\n\t\tthis.separableBlurMaterials = [];\r\n\t\tconst kernelSizeArray = [ 3, 5, 7, 9, 11 ];\r\n\t\tresx = Math.round( this.resolution.x / 2 );\r\n\t\tresy = Math.round( this.resolution.y / 2 );\r\n\r\n\t\tfor ( let i = 0; i < this.nMips; i ++ ) {\r\n\r\n\t\t\tthis.separableBlurMaterials.push( this.getSeperableBlurMaterial( kernelSizeArray[ i ] ) );\r\n\r\n\t\t\tthis.separableBlurMaterials[ i ].uniforms[ 'texSize' ].value = new Vector2( resx, resy );\r\n\r\n\t\t\tresx = Math.round( resx / 2 );\r\n\r\n\t\t\tresy = Math.round( resy / 2 );\r\n\r\n\t\t}\r\n\r\n\t\t// Composite material\r\n\t\tthis.compositeMaterial = this.getCompositeMaterial( this.nMips );\r\n\t\tthis.compositeMaterial.uniforms[ 'blurTexture1' ].value = this.renderTargetsVertical[ 0 ].texture;\r\n\t\tthis.compositeMaterial.uniforms[ 'blurTexture2' ].value = this.renderTargetsVertical[ 1 ].texture;\r\n\t\tthis.compositeMaterial.uniforms[ 'blurTexture3' ].value = this.renderTargetsVertical[ 2 ].texture;\r\n\t\tthis.compositeMaterial.uniforms[ 'blurTexture4' ].value = this.renderTargetsVertical[ 3 ].texture;\r\n\t\tthis.compositeMaterial.uniforms[ 'blurTexture5' ].value = this.renderTargetsVertical[ 4 ].texture;\r\n\t\tthis.compositeMaterial.uniforms[ 'bloomStrength' ].value = strength;\r\n\t\tthis.compositeMaterial.uniforms[ 'bloomRadius' ].value = 0.1;\r\n\t\tthis.compositeMaterial.needsUpdate = true;\r\n\r\n\t\tconst bloomFactors = [ 1.0, 0.8, 0.6, 0.4, 0.2 ];\r\n\t\tthis.compositeMaterial.uniforms[ 'bloomFactors' ].value = bloomFactors;\r\n\t\tthis.bloomTintColors = [ new Vector3( 1, 1, 1 ), new Vector3( 1, 1, 1 ), new Vector3( 1, 1, 1 ), new Vector3( 1, 1, 1 ), new Vector3( 1, 1, 1 ) ];\r\n\t\tthis.compositeMaterial.uniforms[ 'bloomTintColors' ].value = this.bloomTintColors;\r\n\r\n\t\t// copy material\r\n\t\tif ( CopyShader === undefined ) {\r\n\r\n\t\t\tconsole.error( 'THREE.UnrealBloomPass relies on CopyShader' );\r\n\r\n\t\t}\r\n\r\n\t\tconst copyShader = CopyShader;\r\n\r\n\t\tthis.copyUniforms = UniformsUtils.clone( copyShader.uniforms );\r\n\t\tthis.copyUniforms[ 'opacity' ].value = 1.0;\r\n\r\n\t\tthis.materialCopy = new ShaderMaterial( {\r\n\t\t\tuniforms: this.copyUniforms,\r\n\t\t\tvertexShader: copyShader.vertexShader,\r\n\t\t\tfragmentShader: copyShader.fragmentShader,\r\n\t\t\tblending: AdditiveBlending,\r\n\t\t\tdepthTest: false,\r\n\t\t\tdepthWrite: false,\r\n\t\t\ttransparent: true\r\n\t\t} );\r\n\r\n\t\tthis.enabled = true;\r\n\t\tthis.needsSwap = false;\r\n\r\n\t\tthis._oldClearColor = new Color();\r\n\t\tthis.oldClearAlpha = 1;\r\n\r\n\t\tthis.basic = new MeshBasicMaterial();\r\n\r\n\t\tthis.fsQuad = new FullScreenQuad( null );\r\n\r\n\t}\r\n\r\n\tdispose() {\r\n\r\n\t\tfor ( let i = 0; i < this.renderTargetsHorizontal.length; i ++ ) {\r\n\r\n\t\t\tthis.renderTargetsHorizontal[ i ].dispose();\r\n\r\n\t\t}\r\n\r\n\t\tfor ( let i = 0; i < this.renderTargetsVertical.length; i ++ ) {\r\n\r\n\t\t\tthis.renderTargetsVertical[ i ].dispose();\r\n\r\n\t\t}\r\n\r\n\t\tthis.renderTargetBright.dispose();\r\n\r\n\t}\r\n\r\n\tsetSize( width, height ) {\r\n\r\n\t\tlet resx = Math.round( width / 2 );\r\n\t\tlet resy = Math.round( height / 2 );\r\n\r\n\t\tthis.renderTargetBright.setSize( resx, resy );\r\n\r\n\t\tfor ( let i = 0; i < this.nMips; i ++ ) {\r\n\r\n\t\t\tthis.renderTargetsHorizontal[ i ].setSize( resx, resy );\r\n\t\t\tthis.renderTargetsVertical[ i ].setSize( resx, resy );\r\n\r\n\t\t\tthis.separableBlurMaterials[ i ].uniforms[ 'texSize' ].value = new Vector2( resx, resy );\r\n\r\n\t\t\tresx = Math.round( resx / 2 );\r\n\t\t\tresy = Math.round( resy / 2 );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\trender( renderer, writeBuffer, readBuffer, deltaTime, maskActive ) {\r\n\r\n\t\trenderer.getClearColor( this._oldClearColor );\r\n\t\tthis.oldClearAlpha = renderer.getClearAlpha();\r\n\t\tconst oldAutoClear = renderer.autoClear;\r\n\t\trenderer.autoClear = false;\r\n\r\n\t\trenderer.setClearColor( this.clearColor, 0 );\r\n\r\n\t\tif ( maskActive ) renderer.state.buffers.stencil.setTest( false );\r\n\r\n\t\t// Render input to screen\r\n\r\n\t\tif ( this.renderToScreen ) {\r\n\r\n\t\t\tthis.fsQuad.material = this.basic;\r\n\t\t\tthis.basic.map = readBuffer.texture;\r\n\r\n\t\t\trenderer.setRenderTarget( null );\r\n\t\t\trenderer.clear();\r\n\t\t\tthis.fsQuad.render( renderer );\r\n\r\n\t\t}\r\n\r\n\t\t// 1. Extract Bright Areas\r\n\r\n\t\tthis.highPassUniforms[ 'tDiffuse' ].value = readBuffer.texture;\r\n\t\tthis.highPassUniforms[ 'luminosityThreshold' ].value = this.threshold;\r\n\t\tthis.fsQuad.material = this.materialHighPassFilter;\r\n\r\n\t\trenderer.setRenderTarget( this.renderTargetBright );\r\n\t\trenderer.clear();\r\n\t\tthis.fsQuad.render( renderer );\r\n\r\n\t\t// 2. Blur All the mips progressively\r\n\r\n\t\tlet inputRenderTarget = this.renderTargetBright;\r\n\r\n\t\tfor ( let i = 0; i < this.nMips; i ++ ) {\r\n\r\n\t\t\tthis.fsQuad.material = this.separableBlurMaterials[ i ];\r\n\r\n\t\t\tthis.separableBlurMaterials[ i ].uniforms[ 'colorTexture' ].value = inputRenderTarget.texture;\r\n\t\t\tthis.separableBlurMaterials[ i ].uniforms[ 'direction' ].value = UnrealBloomPass.BlurDirectionX;\r\n\t\t\trenderer.setRenderTarget( this.renderTargetsHorizontal[ i ] );\r\n\t\t\trenderer.clear();\r\n\t\t\tthis.fsQuad.render( renderer );\r\n\r\n\t\t\tthis.separableBlurMaterials[ i ].uniforms[ 'colorTexture' ].value = this.renderTargetsHorizontal[ i ].texture;\r\n\t\t\tthis.separableBlurMaterials[ i ].uniforms[ 'direction' ].value = UnrealBloomPass.BlurDirectionY;\r\n\t\t\trenderer.setRenderTarget( this.renderTargetsVertical[ i ] );\r\n\t\t\trenderer.clear();\r\n\t\t\tthis.fsQuad.render( renderer );\r\n\r\n\t\t\tinputRenderTarget = this.renderTargetsVertical[ i ];\r\n\r\n\t\t}\r\n\r\n\t\t// Composite All the mips\r\n\r\n\t\tthis.fsQuad.material = this.compositeMaterial;\r\n\t\tthis.compositeMaterial.uniforms[ 'bloomStrength' ].value = this.strength;\r\n\t\tthis.compositeMaterial.uniforms[ 'bloomRadius' ].value = this.radius;\r\n\t\tthis.compositeMaterial.uniforms[ 'bloomTintColors' ].value = this.bloomTintColors;\r\n\r\n\t\trenderer.setRenderTarget( this.renderTargetsHorizontal[ 0 ] );\r\n\t\trenderer.clear();\r\n\t\tthis.fsQuad.render( renderer );\r\n\r\n\t\t// Blend it additively over the input texture\r\n\r\n\t\tthis.fsQuad.material = this.materialCopy;\r\n\t\tthis.copyUniforms[ 'tDiffuse' ].value = this.renderTargetsHorizontal[ 0 ].texture;\r\n\r\n\t\tif ( maskActive ) renderer.state.buffers.stencil.setTest( true );\r\n\r\n\t\tif ( this.renderToScreen ) {\r\n\r\n\t\t\trenderer.setRenderTarget( null );\r\n\t\t\tthis.fsQuad.render( renderer );\r\n\r\n\t\t} else {\r\n\r\n\t\t\trenderer.setRenderTarget( readBuffer );\r\n\t\t\tthis.fsQuad.render( renderer );\r\n\r\n\t\t}\r\n\r\n\t\t// Restore renderer settings\r\n\r\n\t\trenderer.setClearColor( this._oldClearColor, this.oldClearAlpha );\r\n\t\trenderer.autoClear = oldAutoClear;\r\n\r\n\t}\r\n\r\n\tgetSeperableBlurMaterial( kernelRadius ) {\r\n\r\n\t\treturn new ShaderMaterial( {\r\n\r\n\t\t\tdefines: {\r\n\t\t\t\t'KERNEL_RADIUS': kernelRadius,\r\n\t\t\t\t'SIGMA': kernelRadius\r\n\t\t\t},\r\n\r\n\t\t\tuniforms: {\r\n\t\t\t\t'colorTexture': { value: null },\r\n\t\t\t\t'texSize': { value: new Vector2( 0.5, 0.5 ) },\r\n\t\t\t\t'direction': { value: new Vector2( 0.5, 0.5 ) }\r\n\t\t\t},\r\n\r\n\t\t\tvertexShader:\r\n\t\t\t\t`varying vec2 vUv;\r\n\t\t\t\tvoid main() {\r\n\t\t\t\t\tvUv = uv;\r\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\r\n\t\t\t\t}`,\r\n\r\n\t\t\tfragmentShader:\r\n\t\t\t\t`#include <common>\r\n\t\t\t\tvarying vec2 vUv;\r\n\t\t\t\tuniform sampler2D colorTexture;\r\n\t\t\t\tuniform vec2 texSize;\r\n\t\t\t\tuniform vec2 direction;\r\n\r\n\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\r\n\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\r\n\t\t\t\t}\r\n\t\t\t\tvoid main() {\r\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\r\n\t\t\t\t\tfloat fSigma = float(SIGMA);\r\n\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\r\n\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\r\n\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\r\n\t\t\t\t\t\tfloat x = float(i);\r\n\t\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\r\n\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\r\n\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\r\n\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\r\n\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\r\n\t\t\t\t\t\tweightSum += 2.0 * w;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 0.25);\r\n\t\t\t\t}`\r\n\t\t} );\r\n\r\n\t}\r\n\r\n\tgetCompositeMaterial( nMips ) {\r\n\r\n\t\treturn new ShaderMaterial( {\r\n\r\n\t\t\tdefines: {\r\n\t\t\t\t'NUM_MIPS': nMips\r\n\t\t\t},\r\n\r\n\t\t\tuniforms: {\r\n\t\t\t\t'blurTexture1': { value: null },\r\n\t\t\t\t'blurTexture2': { value: null },\r\n\t\t\t\t'blurTexture3': { value: null },\r\n\t\t\t\t'blurTexture4': { value: null },\r\n\t\t\t\t'blurTexture5': { value: null },\r\n\t\t\t\t'dirtTexture': { value: null },\r\n\t\t\t\t'bloomStrength': { value: 1.0 },\r\n\t\t\t\t'bloomFactors': { value: null },\r\n\t\t\t\t'bloomTintColors': { value: null },\r\n\t\t\t\t'bloomRadius': { value: 0.0 }\r\n\t\t\t},\r\n\r\n\t\t\tvertexShader:\r\n\t\t\t\t`varying vec2 vUv;\r\n\t\t\t\tvoid main() {\r\n\t\t\t\t\tvUv = uv;\r\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\r\n\t\t\t\t}`,\r\n\r\n\t\t\tfragmentShader:\r\n\t\t\t\t`varying vec2 vUv;\r\n\t\t\t\tuniform sampler2D blurTexture1;\r\n\t\t\t\tuniform sampler2D blurTexture2;\r\n\t\t\t\tuniform sampler2D blurTexture3;\r\n\t\t\t\tuniform sampler2D blurTexture4;\r\n\t\t\t\tuniform sampler2D blurTexture5;\r\n\t\t\t\tuniform sampler2D dirtTexture;\r\n\t\t\t\tuniform float bloomStrength;\r\n\t\t\t\tuniform float bloomRadius;\r\n\t\t\t\tuniform float bloomFactors[NUM_MIPS];\r\n\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\r\n\r\n\t\t\t\tfloat lerpBloomFactor(const in float factor) {\r\n\t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\r\n\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvoid main() {\r\n\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 0.25) * texture2D(blurTexture1, vUv) +\r\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 0.25) * texture2D(blurTexture2, vUv) +\r\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 0.25) * texture2D(blurTexture3, vUv) +\r\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 0.25) * texture2D(blurTexture4, vUv) +\r\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 0.25) * texture2D(blurTexture5, vUv) );\r\n\t\t\t\t}`\r\n\t\t} );\r\n\r\n\t}\r\n\r\n}\r\n\r\nUnrealBloomPass.BlurDirectionX = new Vector2( 1.0, 0.0 );\r\nUnrealBloomPass.BlurDirectionY = new Vector2( 0.0, 1.0 );\r\n\r\nexport { UnrealBloomPass };\r\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./city-shanghai.vue?vue&type=style&index=0&id=62324ff4&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"home\"},[_c('div',{ref:\"views\",attrs:{\"id\":\"home-view\"}}),_c('div',{staticClass:\"back\"},[_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\"},on:{\"click\":function($event){return _vm.$router.go(-1)}}},[_vm._v(\"返 回\")])],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"home\">\r\n    <div id=\"home-view\" ref=\"views\"></div>\r\n    <div class=\"back\">\r\n        <el-button @click=\"$router.go(-1)\" type=\"primary\" size=\"small\">返 回</el-button>\r\n    </div>\r\n    <!-- <ul class=\"road-line\">\r\n      <li v-for=\"(val, i) in roadLine\" :key=\"i\" @click=\"bySubway(val)\">{{val.name}}</li>\r\n    </ul> -->\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport * as THREE from 'three'\r\nimport * as maptalks from 'maptalks'\r\nimport 'maptalks/dist/maptalks.css'\r\nimport { ThreeLayer } from 'maptalks.three'\r\nimport { CSS3DRenderer, CSS3DObject } from 'three/examples/jsm/renderers/CSS3DRenderer.js'\r\nimport { EffectComposer } from 'three/examples/jsm/postprocessing/EffectComposer' \r\nimport { RenderPass } from 'three/examples/jsm/postprocessing/RenderPass' \r\nimport { SMAAPass } from 'three/examples/jsm/postprocessing/SMAAPass' \r\nimport { SMAAEdgesShader, SMAAWeightsShader, SMAABlendShader } from 'three/examples/jsm/shaders/SMAAShader' \r\nimport { UnrealBloomPass } from '@/utils/UnrealBloomPass' \r\nimport TWEEN from 'tween'\r\nimport Effect from '@/utils/effect.js'\r\nconst vertexShader = `\r\n    varying vec3 vPosition;\r\n    varying vec2 vUv;\r\n    void main() { \r\n        vUv = uv; \r\n        vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\r\n        gl_Position = projectionMatrix * mvPosition;\r\n        vPosition = position;\r\n    }\r\n`;\r\nlet map, threeLayer, mixer;\r\nlet render1, clock = new THREE.Clock();\r\nvar effectList = [], object3DEvent = null;\r\nexport default {\r\n  data() {\r\n    return {\r\n      ruleForm: {},\r\n      views: null,\r\n      animateId: null,\r\n      roadLine: [],\r\n      loading: true,\r\n      lineList: [\r\n        {start: {x: 121.5414432810934, y: 31.27838908582774}, end: {x: 121.50087945105042, y: 31.240537712123086}},\r\n        {start: {x: 121.50087945105042, y: 31.240537712123086}, end: {x: 121.50087945105042, y: 31.240537712123086}},\r\n        {start: {x: 121.50434911762284, y: 31.291928574330626}, end: {x: 121.50087945105042, y: 31.240537712123086}},\r\n        {start: {x: 121.46161539785044, y: 31.269156597845182}, end: {x: 121.50087945105042, y: 31.240537712123086}},\r\n        {start: {x: 121.45048670550227, y: 31.228392479481982}, end: {x: 121.50087945105042, y: 31.240537712123086}},\r\n        {start: {x: 121.45533823285712, y: 31.207898344241556}, end: {x: 121.50087945105042, y: 31.240537712123086}},\r\n        {start: {x: 121.4865315689824, y: 31.18404201214159}, end: {x: 121.50087945105042, y: 31.240537712123086}},\r\n        {start: {x: 121.52718338240993, y: 31.19980991953949}, end: {x: 121.50087945105042, y: 31.240537712123086}}\r\n      ]\r\n    }\r\n  },\r\n  methods: {\r\n    createGeometry({geometry, position,rotation, effect, color, color1, wireframe}) {\r\n        position = threeLayer.coordinateToVector3(position) || new THREE.Vector3(0,0,0)\r\n        rotation = rotation || new THREE.Vector3(-Math.PI/2,0,0)\r\n        let material = null\r\n        if(!!effect) {\r\n          material = new THREE.ShaderMaterial({\r\n                uniforms: {\r\n                    iTime: {\r\n                        value: 0\r\n                    },\r\n                    time: {\r\n                      value: 0\r\n                    },\r\n                    color: { value: color || new THREE.Color(0xff0000) },\r\n                    color1: { value: color1 || new THREE.Color(0x00ffff) },\r\n                    iResolution: {\r\n                        value: new THREE.Vector2(800, 800)\r\n                    },\r\n                    map: {\r\n                      value: new THREE.ImageUtils.loadTexture('./images/smokeparticle.png')\r\n                    }\r\n                },\r\n                side: 2,\r\n                depthWrite: true,\r\n                transparent: true,\r\n                depthTest: false,\r\n                wireframe: wireframe || false,\r\n                blending: THREE.AdditiveBlending,\r\n                vertexShader: vertexShader,\r\n                fragmentShader: effect()\r\n          })\r\n        }else{\r\n           position.z = 5\r\n           material = new THREE.MeshPhongMaterial({\r\n                color: color || new THREE.Color(0x00ffff),\r\n                side: 2,\r\n                transparent: true,\r\n                depthWrite: true,\r\n                depthTest: false,\r\n                wireframe: wireframe || false,\r\n                blending: THREE.AdditiveBlending,\r\n          })\r\n        }\r\n        let mesh = new THREE.Mesh(geometry, material);\r\n        mesh.position.copy(position);\r\n        mesh.rotation.set(rotation.x, rotation.y, rotation.z)\r\n        threeLayer.addMesh(mesh)\r\n        return mesh\r\n    },\r\n    createEffect() {\r\n      const circle1 = this.createGeometry({\r\n        geometry: new THREE.CircleGeometry(10, 32, 32),\r\n        effect: Effect.effect44,\r\n        color: new THREE.Color(0xff0000),\r\n        position: {x: 121.5414432810934, y: 31.27838908582774},\r\n        rotation: {x: 0, y: 0, z: 0 }\r\n      })\r\n\r\n      const circle2 = this.createGeometry({\r\n        geometry: new THREE.CircleGeometry(10, 32, 32),\r\n        effect: Effect.effect35,\r\n        color: new THREE.Color(0xff0000),\r\n        position: {x: 121.50087945105042, y: 31.240537712123086},\r\n        rotation: {x: 0, y: 0, z: 0 },\r\n        wireframe: false\r\n      })\r\n\r\n      const circle3 = this.createGeometry({\r\n        geometry: new THREE.CircleGeometry(10, 32, 32),\r\n        effect: Effect.effect1,\r\n        color: new THREE.Color(0xff00ff),\r\n        position: {x: 121.52718338240993, y: 31.19980991953949},\r\n        rotation: {x: 0, y: 0, z: 0 },\r\n        wireframe: false\r\n      })\r\n\r\n      const circle4 = this.createGeometry({\r\n        geometry: new THREE.CircleGeometry(10, 32, 32),\r\n        effect: Effect.effect10,\r\n        color: new THREE.Color(0xff00ff),\r\n        position: {x: 121.45533823285712, y: 31.207898344241556},\r\n        rotation: {x: 0, y: 0, z: 0 },\r\n        wireframe: false\r\n      })\r\n\r\n      const circle5 = this.createGeometry({\r\n        geometry: new THREE.CircleGeometry(20, 32, 32),\r\n        effect: Effect.effect12,\r\n        color: new THREE.Color(0xff00ff),\r\n        position: {x: 121.4865315689824, y: 31.18404201214159},\r\n        rotation: {x: 0, y: 0, z: 0 },\r\n        wireframe: false\r\n      })\r\n\r\n      const sphere = this.createGeometry({\r\n        geometry: new THREE.SphereGeometry(10, 32, 32, 0, Math.PI*2, 0, Math.PI/2),\r\n        effect: Effect.effect39,\r\n        color: new THREE.Color(0x00ffff),\r\n        position: {x: 121.45048670550227, y: 31.228392479481982},\r\n        rotation: {x: Math.PI/2, y: 0, z: 0 }\r\n      })\r\n      \r\n      const Cylinder = this.createGeometry({\r\n        geometry: new THREE.CylinderBufferGeometry( 10, 10, 15, 32 , 32, true),\r\n        effect: Effect.effect42,\r\n        color: new THREE.Color(0xffff00),\r\n        position: {x: 121.46161539785044, y: 31.269156597845182},\r\n        rotation: {x: Math.PI/2, y: 0, z: 0 }\r\n      })\r\n      effectList = [circle1,circle2,circle3,circle4,circle5, sphere,Cylinder]\r\n      let tweenA = new TWEEN.Tween(Cylinder.scale).to({x: 2, y: 1, z: 2}, 2000)\r\n      tweenA.start()\r\n      tweenA.onComplete(() => {\r\n        Cylinder.scale.set(0.1, 0.1, 0.1)\r\n        tweenA.start()\r\n      })\r\n    },\r\n    createPointGeo() {\r\n        const geometryList = [\r\n          { \r\n            geometry: new THREE.ConeGeometry( 2, 4, 4, 1, true),\r\n            color: new THREE.Color(0xffff00),\r\n            coordinate: {x: 121.5414432810934, y: 31.27838908582774},\r\n            time: 1000,\r\n            text: 'xxxx'\r\n          },\r\n          { \r\n            geometry: new THREE.ConeGeometry( 2, 4, 4, 1, true),\r\n            color: new THREE.Color(0xff0000),\r\n            coordinate: {x: 121.50087945105042, y: 31.240537712123086},\r\n            time: 1500,\r\n            text: '欢迎来到上海'\r\n          },\r\n          { \r\n            geometry: new THREE.ConeGeometry( 2, 4, 4, 1, true),\r\n            color: new THREE.Color(0xff00ff),\r\n            coordinate: {x: 121.46161539785044, y: 31.269156597845182},\r\n            time: 1200,\r\n            text: 'xxxx'\r\n          },\r\n          { \r\n            geometry: new THREE.ConeGeometry( 2, 4, 4, 1, true),\r\n            color: new THREE.Color(0xddff00),\r\n            coordinate: {x: 121.45048670550227, y: 31.228392479481982},\r\n            time: 1000,\r\n            text: 'xxxx'\r\n          },\r\n          { \r\n            geometry: new THREE.ConeGeometry( 2, 4, 4, 1, true),\r\n            color: new THREE.Color(0x00ff00),\r\n            coordinate: {x: 121.45533823285712, y: 31.207898344241556},\r\n            time: 800,\r\n            text: 'xxxx'\r\n          }\r\n        ]\r\n        geometryList.forEach(item => {\r\n          const { geometry, color, coordinate, time, wireframe, rotation, text} = item\r\n          // 八面体\r\n          const eightGeo = this.createGeometry({\r\n            geometry,\r\n            color,\r\n            position: coordinate,\r\n            wireframe,\r\n            rotation\r\n          })\r\n          this.createText(text, coordinate)\r\n          let T1 = new TWEEN.Tween(eightGeo.position).to({ z: 6 }, time)\r\n          let T2 = new TWEEN.Tween(eightGeo.position).to({ z: 5 }, time)\r\n          T1.start()\r\n          T1.chain(T2)\r\n          T2.chain(T1)\r\n          \r\n          let T3 = new TWEEN.Tween(eightGeo.rotation).to({ y: Math.PI*2 }, time*5)\r\n          let T4 = new TWEEN.Tween(eightGeo.rotation).to({ y: 0 }, time*5)\r\n          T3.start()\r\n          T3.chain(T4)\r\n          T4.chain(T3)\r\n        })\r\n    },\r\n    // 文本\r\n    createText(text, position) {\r\n        position = threeLayer.coordinateToVector3(position)\r\n        let element = document.createElement('div')\r\n        element.className = 'info-wrap'\r\n        element.innerText = text\r\n        let obj = new CSS3DObject(element)\r\n        position.z = 10\r\n        obj.position.copy(position);\r\n        obj.rotateX(Math.PI/2)\r\n        obj.scale.set(0.1, 0.1, 0.1)\r\n        threeLayer.addMesh(obj)\r\n    },\r\n    createLineFly() {\r\n      // 飞线\r\n      this.lineList.forEach( (val, index) => {\r\n        let start = threeLayer.coordinateToVector3(val.start)\r\n        let end = threeLayer.coordinateToVector3(val.end)\r\n        start = new THREE.Vector3(start.x, start.y, start.z )\r\n        end = new THREE.Vector3(end.x, end.y, end.z )\r\n        const { curve, mesh } = this.addLines(start, end)\r\n        this.flyLine(curve) \r\n        // threeLayer.addMesh(mesh)\r\n      })\r\n    },\r\n    // 曲线\r\n    addLines( v0, v3 ) {\r\n        var path = new THREE.LineCurve3(v0, v3)\r\n        var p = path.getPoints(120)\r\n        var d = v0.distanceTo( v3 )/3\r\n        var v1 = new THREE.Vector3( p[40].x, p[40].y, p[40].z  + d)\r\n        var v2 = new THREE.Vector3( p[80].x, p[80].y, p[80].z  + d)\r\n\r\n        // 绘制三维三次贝赛尔曲线\r\n        var curve = new THREE.CubicBezierCurve3( v0, v1, v2, v3 );\r\n        var geometry = new THREE.BufferGeometry();\r\n        var points = curve.getPoints( 150 );\r\n        var positions = [];\r\n        var colors = [], index = [];\r\n        var color = new THREE.Color();\r\n        /**\r\n         * HSL中使用渐变\r\n         * h — hue value between 0.0 and 1.0\r\n         * s — 饱和度 between 0.0 and 1.0\r\n         * l — 亮度 between 0.0 and 1.0\r\n         */\r\n        for (var j = 0; j < points.length; j ++) {\r\n            // color.setHSL( .31666+j*0.005,0.7, 0.7); //绿色\r\n            color.setHSL( .81666+j*0.0025, 0.88, 0.88); //粉色\r\n            colors.push( color.r, color.g, color.b );\r\n            positions.push( points[j].x, points[j].y, points[j].z );\r\n            index.push(j/(points.length - 1))\r\n        }\r\n        geometry.setAttribute('position', new THREE.Float32BufferAttribute(positions, 3))\r\n        geometry.setAttribute('color', new THREE.Float32BufferAttribute(colors, 3))\r\n        geometry.setAttribute('index', new THREE.Float32BufferAttribute(index, 1))\r\n        var matLine = new THREE.LineBasicMaterial( {\r\n            vertexColors: true,\r\n            transparent: true,\r\n            dashed: false\r\n        } );\r\n        return {\r\n          curve,\r\n          mesh: new THREE.Line( geometry, matLine )\r\n        }\r\n    },\r\n    // 路径飞线\r\n    flyLine(curve) {\r\n      var positions = [], index = [], current = [];\r\n      let points = curve.getPoints(5000)\r\n      const geometry = new THREE.BufferGeometry().setFromPoints(points)\r\n\r\n      for (var j = 0; j < points.length; j++) {\r\n          positions.push( points[j].x, points[j].y, points[j].z );\r\n          index.push(j/(points.length - 1))\r\n          current.push(j)\r\n      }\r\n      geometry.setAttribute('position', new THREE.Float32BufferAttribute(positions, 3))\r\n      geometry.setAttribute('index', new THREE.Float32BufferAttribute(index, 1))\r\n      geometry.setAttribute('current', new THREE.Float32BufferAttribute(current, 1))\r\n      const material = new THREE.ShaderMaterial({\r\n        uniforms: {\r\n          iTime: { value: 0 },\r\n          size: { value: 200 },\r\n          uRange: { value: 400 },\r\n          uTotal: { value: points.length},\r\n          uColor: { value: new THREE.Color(0x00ffff) },\r\n          uColor1: { value: new THREE.Color(0xff0000) }\r\n        },\r\n        transparent: true,\r\n        depthTest: true,\r\n        side: 2,\r\n        vertexShader: `\r\n        attribute float index;\r\n        attribute float current;\r\n        uniform float size;\r\n        uniform vec3 uColor;\r\n        uniform vec3 uColor1;\r\n        uniform float uRange;\r\n        uniform float uTotal;\r\n        uniform float iTime;\r\n        varying vec3 vColor;\r\n        varying float vOpacity;\r\n        void main() {\r\n           // 需要当前显示的索引  \r\n            float showNumber = uTotal * mod(iTime/2.0, 1.0);\r\n            float s = size;\r\n            if (showNumber > current && showNumber < current + uRange) {\r\n                vOpacity = 1.0;\r\n                s *= (current + uRange - showNumber) / uRange;\r\n            } else {\r\n                vOpacity = 0.0;\r\n                s = 0.0;\r\n            }\r\n            // 顶点着色器计算后的Position\r\n            // mix 混淆颜色\r\n            vColor = mix(uColor, uColor1, index);\r\n            vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\r\n            gl_Position = projectionMatrix * mvPosition; \r\n            // 大小\r\n            gl_PointSize = s* 5.0 / (-mvPosition.z);\r\n        }`,\r\n        fragmentShader: `\r\n        uniform vec3 uColor;\r\n        uniform vec3 uColor1;\r\n        varying vec3 vColor; \r\n        varying float vOpacity; \r\n        void main() {\r\n            gl_FragColor = vec4(vColor, vOpacity);\r\n        }`\r\n      })\r\n      const mesh = new THREE.Points(geometry, material)\r\n      effectList.push(mesh)\r\n      threeLayer.addMesh(mesh)\r\n    },\r\n    // 地铁线\r\n    cityRoadLine() {\r\n      fetch('./geojson/shanghai_dt.json').then(res => {\r\n        return res.json()\r\n      }).then( geojson => {\r\n        const textList = []\r\n        this.roadLine = []\r\n        geojson.l.forEach((item, i) => {\r\n          let temp = [], list = []\r\n          item.st.forEach(val => {\r\n            let location = val.sl.split(',')\r\n            let p = threeLayer.coordinateToVector3({x: Number(location[0]), y: Number(location[1])})\r\n            temp.push([Number(location[0]),Number(location[1])])\r\n            list.push(p)\r\n            var text = new maptalks.Marker(location,\r\n            {\r\n                'properties' : {\r\n                  'name' : val.n\r\n                },\r\n                'symbol' : {\r\n                  'textName' : '{name}',  \r\n                  'textSize': 8,\r\n                  'textFill': '#ffffff',\r\n                  'textHaloFill': '#000000',\r\n                  'textHaloRadius': 1,\r\n                }\r\n            })\r\n            textList.push(text)\r\n          })\r\n          this.roadLine.push({ name: item.kn, line: temp })\r\n            this.threeLine(list, '#' + item.cl)\r\n        })\r\n        let layer = new maptalks.VectorLayer('地铁').addTo(map);\r\n        layer.setZIndex(-1)\r\n      })\r\n    },\r\n    threeLine(list, color) {\r\n      const curve3 = new THREE.CatmullRomCurve3(list)\r\n      var geometry = new THREE.TubeGeometry( curve3, 256, 0.1, 4, false );\r\n      var material = new THREE.ShaderMaterial({\r\n            uniforms: {\r\n                iTime: {\r\n                    value: 0\r\n                },\r\n                color: { value: new THREE.Color(color) },\r\n                iResolution: {\r\n                    value: new THREE.Vector2(800, 800)\r\n                }\r\n            },\r\n            side: 2,\r\n            depthWrite: true,\r\n            transparent: true,\r\n            depthTest: true,\r\n            blending: THREE.AdditiveBlending,\r\n            vertexShader: vertexShader,\r\n            fragmentShader: `\r\n            uniform float iTime;\r\n            uniform vec3 color;\r\n            varying vec2 vUv;\r\n            void main() {\r\n                \r\n                float d = mod(vUv.x * 2.0 - iTime/2.0, 1.0);\r\n\r\n                d = pow(d, 10.0);\r\n\r\n                vec4 lightColor = vec4(mix(color*d, color, 0.2), 1.0);\r\n\r\n                gl_FragColor = lightColor;\r\n            }`\r\n      })\r\n      var mesh = new THREE.Mesh( geometry, material );\r\n      threeLayer.addMesh( mesh );\r\n      effectList.push(mesh)\r\n    },\r\n    // 加载地图\r\n    loadMap() {\r\n        this.views = this.$refs.views\r\n        map = new maptalks.Map(this.views, {\r\n            center : [121.50087945105042, 31.240537712123086],\r\n            zoom : 15,\r\n            pitch: 90,\r\n            minZoom: 12,\r\n            maxZoom: 18,\r\n            // bearing: 180,\r\n            centerCross: false,\r\n            doubleClickZoom: false,\r\n            attribution: false,\r\n            layerSwitcherControl: {\r\n              'position'  : 'top-right',\r\n              'baseTitle' : '主题样式',\r\n              'overlayTitle' : '',\r\n              'excludeLayers' : ['模型', '地铁'],\r\n              'containerClass' : 'maptalks-layer-switcher'\r\n            },\r\n            baseLayer: new maptalks.GroupTileLayer('tile', [\r\n              new maptalks.TileLayer('白底地图',{\r\n                'visible' : false,\r\n                'urlTemplate': 'https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png',\r\n                'subdomains'  : ['a','b','c','d'],\r\n              }),\r\n              new maptalks.TileLayer('黑底地图',{\r\n                'urlTemplate': 'https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png',\r\n                'subdomains'  : ['a','b','c','d']\r\n              }),\r\n              new maptalks.TileLayer('卫星地图',{\r\n                'visible' : false,\r\n                'urlTemplate': 'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}.jpg',\r\n                'subdomains'  : ['a','b','c','d']\r\n              })\r\n            ])\r\n        }) \r\n\r\n        threeLayer = new ThreeLayer('模型', {\r\n            forceRenderOnMoving: true,\r\n            forceRenderOnRotating: true,\r\n            animation: true\r\n        });\r\n        threeLayer.prepareToDraw = this.initScene\r\n        map.on('click', (params) => {\r\n          let point = threeLayer.coordinateToVector3(params.coordinate)\r\n          map.animateTo({\r\n            center: params.coordinate,\r\n            zoom: 16,\r\n            pitch: 60\r\n          }, {\r\n            duration: 3000\r\n          });\r\n        })\r\n\r\n        render1 = new CSS3DRenderer({alpha: true}) //antialias: true, \r\n        render1.setSize(this.views.clientWidth, this.views.clientHeight)\r\n        this.views.appendChild(render1.domElement)\r\n        render1.domElement.style.position = 'absolute'\r\n        render1.domElement.style.top = 0\r\n        render1.domElement.style.zIndex = 2\r\n        render1.domElement.style.pointerEvents = 'none'\r\n\r\n        // 动画循环\r\n        ThreeLayer.prototype.setRendererRenderScene = function () {\r\n            this.getRenderer().renderScene = function () {\r\n                const layer = this.layer;\r\n                layer._callbackBaseObjectAnimation();\r\n                this._syncCamera();\r\n\r\n                const renderer = this.context, camera = this.camera, scene = this.scene;\r\n                TWEEN.update()\r\n                const elapsedTime = clock.getElapsedTime()\r\n                if(mixer){\r\n                  mixer.update(elapsedTime)\r\n                }\r\n                // Update passes\r\n                effectList.forEach(object => {\r\n                    if(object.material && object.material.uniforms){\r\n                        object.material.uniforms.iTime.value = elapsedTime\r\n                    }\r\n                })\r\n                if(layer.bloomEnable && layer.composer && layer.composer.passes.length > 1) {\r\n                  this.layer.composer.render(0)\r\n                  renderer.clearDepth()\r\n                  camera.layers.set(0)\r\n                  renderer.render(scene, camera);\r\n                }\r\n                render1.render(scene, camera)\r\n                this.completeRender();\r\n            }\r\n        }\r\n        this.cityRoadLine()\r\n        threeLayer.addTo(map);\r\n        threeLayer.setRendererRenderScene()\r\n    },\r\n    initScene(gl, scene, camera) {\r\n        let AmbientLight = new THREE.AmbientLight( 0x404040);\r\n        scene.add( AmbientLight );\r\n        var DirectionalLight = new THREE.DirectionalLight( 0xffffff, 2);\r\n        DirectionalLight.position.set(0, -20, 50).normalize();\r\n        scene.add( DirectionalLight );\r\n        this.initComposer()\r\n        this.createPointGeo()\r\n        this.createEffect()\r\n        this.getGeoJson()\r\n        this.createLineFly()\r\n    },\r\n    initComposer() {\r\n      const renderer = threeLayer.getThreeRenderer()\r\n      threeLayer.composer = new EffectComposer(renderer)\r\n      let size = threeLayer.getMap().getSize()\r\n      threeLayer.composer.setSize(size.width, size.height)\r\n\r\n      const scene = threeLayer.getScene()\r\n      const camera = threeLayer.getCamera()\r\n      threeLayer.renderPass = new RenderPass(scene, camera)\r\n      threeLayer.composer.addPass(threeLayer.renderPass)\r\n      // 抗锯齿\r\n      const smaaPass = new SMAAPass(SMAAEdgesShader)\r\n      threeLayer.composer.addPass(smaaPass)\r\n      //辉光\r\n      const bloomPass = threeLayer.bloomPass = new UnrealBloomPass(new THREE.Vector2(size.width, size.height))\r\n      threeLayer.composer.addPass(bloomPass)\r\n      threeLayer.bloomEnable = true\r\n      bloomPass.renderToScreen = true\r\n      bloomPass.exposure = 1\r\n      bloomPass.strength = 0.8\r\n      bloomPass.radius = 0.5\r\n      bloomPass.threshold = 0.1\r\n\r\n    },\r\n    getGeoJson() {\r\n        const xhr = new XMLHttpRequest()\r\n        xhr.open('get', './geojson/sh_city.json', true)\r\n        xhr.onload = () => {\r\n            if(xhr.status === 200) {\r\n                const features = JSON.parse(xhr.response).features\r\n                const material = new THREE.ShaderMaterial({\r\n                uniforms: {\r\n                    iTime: { value: 0 },\r\n                    time: { value: 0 },\r\n                    color: { value: new THREE.Color(0xffffff) },\r\n                    color1: { value: new THREE.Color(0x1b2060) }\r\n                },\r\n                side: 2,\r\n                depthWrite: true,\r\n                transparent: false,\r\n                depthTest: true,\r\n                vertexShader: vertexShader,\r\n                fragmentShader: `\r\n                    uniform float iTime;\r\n                    uniform vec3 color;\r\n                    uniform vec3 color1;\r\n                    varying vec3 vPosition;\r\n                    varying vec2 vUv;\r\n                    void main() {\r\n\r\n                        float indexMix = vPosition.z / 4.0;\r\n                        \r\n                        vec3 lightColor = vec3(0.0, 1.0, 1.0);\r\n\r\n                        float t = fract(iTime*0.2);\r\n\r\n                        if(indexMix < (t + 0.3)) {\r\n                            lightColor = mix(color1, color, indexMix);\r\n                        }\r\n\r\n                        if(indexMix > (t + 0.34)) {\r\n                            lightColor = mix(color1, color, indexMix);\r\n                        }\r\n\r\n                        gl_FragColor = vec4(lightColor, 1.0);\r\n                }`\r\n                })\r\n                var heightPerLevel = 1.5;\r\n                var polygons = features.map(f => {\r\n                    const polygon = maptalks.GeoJSON.toGeometry(f);\r\n                    var levels = f.properties.height || 1;\r\n                    polygon.setProperties({\r\n                        height: heightPerLevel * levels,\r\n                    });\r\n                    return polygon;\r\n                });\r\n                const extrudePolygons = threeLayer.toExtrudePolygons(polygons, { topColor: '#fff', interactive: true }, material);\r\n                effectList.push(extrudePolygons.object3d)\r\n                threeLayer.addMesh(extrudePolygons)\r\n            \r\n                extrudePolygons.object3d.scale.set(1, 1, 0.2)\r\n\r\n\r\n                let scaleTrack = new THREE.KeyframeTrack(\r\n                  'extrudePolygons.object3d.scale',\r\n                  [0, 500], \r\n                  [1, 1, 0.2, 1, 1, 1],\r\n                  THREE.WrapAroundEnding,\r\n                  )\r\n                let clip = new THREE.AnimationClip('default', 500, [scaleTrack])\r\n\r\n                mixer = new THREE.AnimationMixer(extrudePolygons.object3d)\r\n                let actions = mixer.clipAction(clip)\r\n                actions.loop = THREE.LoopOnce;\r\n                actions.clampWhenFinished = true;\r\n                setTimeout(() => {\r\n                  actions.play()\r\n                }, 1000)\r\n                this.loading = false\r\n            }\r\n        }\r\n        xhr.send()\r\n    },\r\n    // 乘坐地铁\r\n    bySubway(way) {\r\n      let count = way.line.length-1\r\n       this.replay(way, count)\r\n    },\r\n    replay(way, count) {\r\n      let _this = this\r\n      map.animateTo({\r\n        zoom: 15,\r\n        center: way.line[count],\r\n        pitch: 0\r\n      }, {\r\n        duration: 2000,\r\n\r\n      }, function(frame) {\r\n          if (frame.state.playState === 'finished' && count > 0) {\r\n            count--\r\n            _this.replay(way, count)\r\n          }\r\n      })\r\n    }\r\n  },\r\n  mounted() {\r\n    this.loadMap()\r\n    map.on('resize', () => {\r\n      render1.setSize(this.views.clientWidth, this.views.clientHeight)\r\n    })\r\n  },\r\n  destroyed() {\r\n    effectList = []\r\n    map = null\r\n    threeLayer.getScene().clear()\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.home {\r\n  width: 100vw;\r\n  height: 100vh;\r\n} \r\n#home-view {\r\n  width: 100%;\r\n  height: 100%;\r\n  position: relative;\r\n  background: url('~@/assets/img/sky.jpg') no-repeat;\r\n}\r\n.effect-list {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  color: #fff;\r\n  overflow: auto;\r\n  height: 100vh;\r\n}\r\nli > button {\r\n  padding: 2px 5px;\r\n  font-size: 14px;\r\n  margin-bottom: 2px;\r\n}\r\n.back {\r\n  position: absolute;\r\n  top: 10px;\r\n  left: 10px;\r\n  z-index: 99;\r\n  display: flex;\r\n}\r\n.road-line {\r\n  position: absolute;\r\n  bottom: 10px;\r\n  left: 50%;\r\n  z-index: 99;\r\n  display: flex;\r\n  transform: translateX(-50%);\r\n  li {\r\n    color: #fff;\r\n    border: 1px solid #ccc;\r\n    padding: 10px;\r\n    cursor: pointer;\r\n    &:hover {\r\n      background-color: cyan;\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n<style lang=\"scss\">\r\n.maptalks-layer-switcher {\r\n  .panel {\r\n    padding: 20px 20px 0 0 !important;\r\n  }\r\n}\r\n.info-wrap {\r\n  color:#fff;\r\n  font-size: 12px;\r\n  padding: 5px 10px;\r\n  text-align: center;\r\n  text-shadow: 0 0 2px #11e1f0;\r\n  font-family: 'kaiti';\r\n  border: 1px solid #fff;\r\n  background-image: linear-gradient(to bottom,  rgba(5, 102, 248, 0.6), rgba(5, 37, 75, 0.527));\r\n}\r\n.mask {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100vh;\r\n  z-index: 99;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  background: rgba(0,0,0,1);\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./city-shanghai.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./city-shanghai.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./city-shanghai.vue?vue&type=template&id=62324ff4&scoped=true&\"\nimport script from \"./city-shanghai.vue?vue&type=script&lang=js&\"\nexport * from \"./city-shanghai.vue?vue&type=script&lang=js&\"\nimport style0 from \"./city-shanghai.vue?vue&type=style&index=0&id=62324ff4&lang=scss&scoped=true&\"\nimport style1 from \"./city-shanghai.vue?vue&type=style&index=1&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"62324ff4\",\n  null\n  \n)\n\nexport default component.exports","import {\n\tColor\n} from 'three';\n\n/**\n * Luminosity\n * http://en.wikipedia.org/wiki/Luminosity\n */\n\nconst LuminosityHighPassShader = {\n\n\tshaderID: 'luminosityHighPass',\n\n\tuniforms: {\n\n\t\t'tDiffuse': { value: null },\n\t\t'luminosityThreshold': { value: 1.0 },\n\t\t'smoothWidth': { value: 1.0 },\n\t\t'defaultColor': { value: new Color( 0x000000 ) },\n\t\t'defaultOpacity': { value: 0.0 }\n\n\t},\n\n\tvertexShader: /* glsl */`\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}`,\n\n\tfragmentShader: /* glsl */`\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform vec3 defaultColor;\n\t\tuniform float defaultOpacity;\n\t\tuniform float luminosityThreshold;\n\t\tuniform float smoothWidth;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\n\t\t\tvec3 luma = vec3( 0.299, 0.587, 0.114 );\n\n\t\t\tfloat v = dot( texel.xyz, luma );\n\n\t\t\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );\n\n\t\t\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );\n\n\t\t\tgl_FragColor = mix( outputColor, texel, alpha );\n\n\t\t}`\n\n};\n\nexport { LuminosityHighPassShader };\n","/**\n * @author sole / http://soledadpenades.com\n * @author mrdoob / http://mrdoob.com\n * @author Robert Eisele / http://www.xarg.org\n * @author Philippe / http://philippe.elsass.me\n * @author Robert Penner / http://www.robertpenner.com/easing_terms_of_use.html\n * @author Paul Lewis / http://www.aerotwist.com/\n * @author lechecacharro\n * @author Josh Faul / http://jocafa.com/\n * @author egraether / http://egraether.com/\n */\n\nif ( Date.now === undefined ) {\n\n  Date.now = function () {\n\n    return new Date().valueOf();\n\n  }\n\n}\n\nvar TWEEN = TWEEN || ( function () {\n\n  var _tweens = [];\n\n  return {\n\n    REVISION: '8',\n\n    getAll: function () {\n\n      return _tweens;\n\n    },\n\n    removeAll: function () {\n\n      _tweens = [];\n\n    },\n\n    add: function ( tween ) {\n\n      _tweens.push( tween );\n\n    },\n\n    remove: function ( tween ) {\n\n      var i = _tweens.indexOf( tween );\n\n      if ( i !== -1 ) {\n\n        _tweens.splice( i, 1 );\n\n      }\n\n    },\n\n    update: function ( time ) {\n\n      if ( _tweens.length === 0 ) return false;\n\n      var i = 0, numTweens = _tweens.length;\n\n      time = time !== undefined ? time : Date.now();\n\n      while ( i < numTweens ) {\n\n        if ( _tweens[ i ].update( time ) ) {\n\n          i ++;\n\n        } else {\n\n          _tweens.splice( i, 1 );\n\n          numTweens --;\n\n        }\n\n      }\n\n      return true;\n\n    }\n\n  };\n\n} )();\n\nTWEEN.Tween = function ( object ) {\n\n  var _object = object;\n  var _valuesStart = {};\n  var _valuesEnd = {};\n  var _duration = 1000;\n  var _delayTime = 0;\n  var _startTime = null;\n  var _easingFunction = TWEEN.Easing.Linear.None;\n  var _interpolationFunction = TWEEN.Interpolation.Linear;\n  var _chainedTweens = [];\n  var _onStartCallback = null;\n  var _onStartCallbackFired = false;\n  var _onUpdateCallback = null;\n  var _onCompleteCallback = null;\n\n  this.to = function ( properties, duration ) {\n\n    if ( duration !== undefined ) {\n\n      _duration = duration;\n\n    }\n\n    _valuesEnd = properties;\n\n    return this;\n\n  };\n\n  this.start = function ( time ) {\n\n    TWEEN.add( this );\n\n    _onStartCallbackFired = false;\n\n    _startTime = time !== undefined ? time : Date.now();\n    _startTime += _delayTime;\n\n    for ( var property in _valuesEnd ) {\n\n      // This prevents the interpolation of null values or of non-existing properties\n      if( _object[ property ] === null || !(property in _object) ) {\n\n        continue;\n\n      }\n\n      // check if an Array was provided as property value\n      if ( _valuesEnd[ property ] instanceof Array ) {\n\n        if ( _valuesEnd[ property ].length === 0 ) {\n\n          continue;\n\n        }\n\n        // create a local copy of the Array with the start value at the front\n        _valuesEnd[ property ] = [ _object[ property ] ].concat( _valuesEnd[ property ] );\n\n      }\n\n      _valuesStart[ property ] = _object[ property ];\n\n    }\n\n    return this;\n\n  };\n\n  this.stop = function () {\n\n    TWEEN.remove( this );\n    return this;\n\n  };\n\n  this.delay = function ( amount ) {\n\n    _delayTime = amount;\n    return this;\n\n  };\n\n  this.easing = function ( easing ) {\n\n    _easingFunction = easing;\n    return this;\n\n  };\n\n  this.interpolation = function ( interpolation ) {\n\n    _interpolationFunction = interpolation;\n    return this;\n\n  };\n\n  this.chain = function () {\n\n    _chainedTweens = arguments;\n    return this;\n\n  };\n\n  this.onStart = function ( callback ) {\n\n    _onStartCallback = callback;\n    return this;\n\n  };\n\n  this.onUpdate = function ( callback ) {\n\n    _onUpdateCallback = callback;\n    return this;\n\n  };\n\n  this.onComplete = function ( callback ) {\n\n    _onCompleteCallback = callback;\n    return this;\n\n  };\n\n  this.update = function ( time ) {\n\n    if ( time < _startTime ) {\n\n      return true;\n\n    }\n\n    if ( _onStartCallbackFired === false ) {\n\n      if ( _onStartCallback !== null ) {\n\n        _onStartCallback.call( _object );\n\n      }\n\n      _onStartCallbackFired = true;\n\n    }\n\n    var elapsed = ( time - _startTime ) / _duration;\n    elapsed = elapsed > 1 ? 1 : elapsed;\n\n    var value = _easingFunction( elapsed );\n\n    for ( var property in _valuesStart ) {\n\n      var start = _valuesStart[ property ];\n      var end = _valuesEnd[ property ];\n\n      if ( end instanceof Array ) {\n\n        _object[ property ] = _interpolationFunction( end, value );\n\n      } else {\n\n        _object[ property ] = start + ( end - start ) * value;\n\n      }\n\n    }\n\n    if ( _onUpdateCallback !== null ) {\n\n      _onUpdateCallback.call( _object, value );\n\n    }\n\n    if ( elapsed == 1 ) {\n\n      if ( _onCompleteCallback !== null ) {\n\n        _onCompleteCallback.call( _object );\n\n      }\n\n      for ( var i = 0, numChainedTweens = _chainedTweens.length; i < numChainedTweens; i ++ ) {\n\n        _chainedTweens[ i ].start( time );\n\n      }\n\n      return false;\n\n    }\n\n    return true;\n\n  };\n\n};\n\nTWEEN.Easing = {\n\n  Linear: {\n\n    None: function ( k ) {\n\n      return k;\n\n    }\n\n  },\n\n  Quadratic: {\n\n    In: function ( k ) {\n\n      return k * k;\n\n    },\n\n    Out: function ( k ) {\n\n      return k * ( 2 - k );\n\n    },\n\n    InOut: function ( k ) {\n\n      if ( ( k *= 2 ) < 1 ) return 0.5 * k * k;\n      return - 0.5 * ( --k * ( k - 2 ) - 1 );\n\n    }\n\n  },\n\n  Cubic: {\n\n    In: function ( k ) {\n\n      return k * k * k;\n\n    },\n\n    Out: function ( k ) {\n\n      return --k * k * k + 1;\n\n    },\n\n    InOut: function ( k ) {\n\n      if ( ( k *= 2 ) < 1 ) return 0.5 * k * k * k;\n      return 0.5 * ( ( k -= 2 ) * k * k + 2 );\n\n    }\n\n  },\n\n  Quartic: {\n\n    In: function ( k ) {\n\n      return k * k * k * k;\n\n    },\n\n    Out: function ( k ) {\n\n      return 1 - ( --k * k * k * k );\n\n    },\n\n    InOut: function ( k ) {\n\n      if ( ( k *= 2 ) < 1) return 0.5 * k * k * k * k;\n      return - 0.5 * ( ( k -= 2 ) * k * k * k - 2 );\n\n    }\n\n  },\n\n  Quintic: {\n\n    In: function ( k ) {\n\n      return k * k * k * k * k;\n\n    },\n\n    Out: function ( k ) {\n\n      return --k * k * k * k * k + 1;\n\n    },\n\n    InOut: function ( k ) {\n\n      if ( ( k *= 2 ) < 1 ) return 0.5 * k * k * k * k * k;\n      return 0.5 * ( ( k -= 2 ) * k * k * k * k + 2 );\n\n    }\n\n  },\n\n  Sinusoidal: {\n\n    In: function ( k ) {\n\n      return 1 - Math.cos( k * Math.PI / 2 );\n\n    },\n\n    Out: function ( k ) {\n\n      return Math.sin( k * Math.PI / 2 );\n\n    },\n\n    InOut: function ( k ) {\n\n      return 0.5 * ( 1 - Math.cos( Math.PI * k ) );\n\n    }\n\n  },\n\n  Exponential: {\n\n    In: function ( k ) {\n\n      return k === 0 ? 0 : Math.pow( 1024, k - 1 );\n\n    },\n\n    Out: function ( k ) {\n\n      return k === 1 ? 1 : 1 - Math.pow( 2, - 10 * k );\n\n    },\n\n    InOut: function ( k ) {\n\n      if ( k === 0 ) return 0;\n      if ( k === 1 ) return 1;\n      if ( ( k *= 2 ) < 1 ) return 0.5 * Math.pow( 1024, k - 1 );\n      return 0.5 * ( - Math.pow( 2, - 10 * ( k - 1 ) ) + 2 );\n\n    }\n\n  },\n\n  Circular: {\n\n    In: function ( k ) {\n\n      return 1 - Math.sqrt( 1 - k * k );\n\n    },\n\n    Out: function ( k ) {\n\n      return Math.sqrt( 1 - ( --k * k ) );\n\n    },\n\n    InOut: function ( k ) {\n\n      if ( ( k *= 2 ) < 1) return - 0.5 * ( Math.sqrt( 1 - k * k) - 1);\n      return 0.5 * ( Math.sqrt( 1 - ( k -= 2) * k) + 1);\n\n    }\n\n  },\n\n  Elastic: {\n\n    In: function ( k ) {\n\n      var s, a = 0.1, p = 0.4;\n      if ( k === 0 ) return 0;\n      if ( k === 1 ) return 1;\n      if ( !a || a < 1 ) { a = 1; s = p / 4; }\n      else s = p * Math.asin( 1 / a ) / ( 2 * Math.PI );\n      return - ( a * Math.pow( 2, 10 * ( k -= 1 ) ) * Math.sin( ( k - s ) * ( 2 * Math.PI ) / p ) );\n\n    },\n\n    Out: function ( k ) {\n\n      var s, a = 0.1, p = 0.4;\n      if ( k === 0 ) return 0;\n      if ( k === 1 ) return 1;\n      if ( !a || a < 1 ) { a = 1; s = p / 4; }\n      else s = p * Math.asin( 1 / a ) / ( 2 * Math.PI );\n      return ( a * Math.pow( 2, - 10 * k) * Math.sin( ( k - s ) * ( 2 * Math.PI ) / p ) + 1 );\n\n    },\n\n    InOut: function ( k ) {\n\n      var s, a = 0.1, p = 0.4;\n      if ( k === 0 ) return 0;\n      if ( k === 1 ) return 1;\n      if ( !a || a < 1 ) { a = 1; s = p / 4; }\n      else s = p * Math.asin( 1 / a ) / ( 2 * Math.PI );\n      if ( ( k *= 2 ) < 1 ) return - 0.5 * ( a * Math.pow( 2, 10 * ( k -= 1 ) ) * Math.sin( ( k - s ) * ( 2 * Math.PI ) / p ) );\n      return a * Math.pow( 2, -10 * ( k -= 1 ) ) * Math.sin( ( k - s ) * ( 2 * Math.PI ) / p ) * 0.5 + 1;\n\n    }\n\n  },\n\n  Back: {\n\n    In: function ( k ) {\n\n      var s = 1.70158;\n      return k * k * ( ( s + 1 ) * k - s );\n\n    },\n\n    Out: function ( k ) {\n\n      var s = 1.70158;\n      return --k * k * ( ( s + 1 ) * k + s ) + 1;\n\n    },\n\n    InOut: function ( k ) {\n\n      var s = 1.70158 * 1.525;\n      if ( ( k *= 2 ) < 1 ) return 0.5 * ( k * k * ( ( s + 1 ) * k - s ) );\n      return 0.5 * ( ( k -= 2 ) * k * ( ( s + 1 ) * k + s ) + 2 );\n\n    }\n\n  },\n\n  Bounce: {\n\n    In: function ( k ) {\n\n      return 1 - TWEEN.Easing.Bounce.Out( 1 - k );\n\n    },\n\n    Out: function ( k ) {\n\n      if ( k < ( 1 / 2.75 ) ) {\n\n        return 7.5625 * k * k;\n\n      } else if ( k < ( 2 / 2.75 ) ) {\n\n        return 7.5625 * ( k -= ( 1.5 / 2.75 ) ) * k + 0.75;\n\n      } else if ( k < ( 2.5 / 2.75 ) ) {\n\n        return 7.5625 * ( k -= ( 2.25 / 2.75 ) ) * k + 0.9375;\n\n      } else {\n\n        return 7.5625 * ( k -= ( 2.625 / 2.75 ) ) * k + 0.984375;\n\n      }\n\n    },\n\n    InOut: function ( k ) {\n\n      if ( k < 0.5 ) return TWEEN.Easing.Bounce.In( k * 2 ) * 0.5;\n      return TWEEN.Easing.Bounce.Out( k * 2 - 1 ) * 0.5 + 0.5;\n\n    }\n\n  }\n\n};\n\nTWEEN.Interpolation = {\n\n  Linear: function ( v, k ) {\n\n    var m = v.length - 1, f = m * k, i = Math.floor( f ), fn = TWEEN.Interpolation.Utils.Linear;\n\n    if ( k < 0 ) return fn( v[ 0 ], v[ 1 ], f );\n    if ( k > 1 ) return fn( v[ m ], v[ m - 1 ], m - f );\n\n    return fn( v[ i ], v[ i + 1 > m ? m : i + 1 ], f - i );\n\n  },\n\n  Bezier: function ( v, k ) {\n\n    var b = 0, n = v.length - 1, pw = Math.pow, bn = TWEEN.Interpolation.Utils.Bernstein, i;\n\n    for ( i = 0; i <= n; i++ ) {\n      b += pw( 1 - k, n - i ) * pw( k, i ) * v[ i ] * bn( n, i );\n    }\n\n    return b;\n\n  },\n\n  CatmullRom: function ( v, k ) {\n\n    var m = v.length - 1, f = m * k, i = Math.floor( f ), fn = TWEEN.Interpolation.Utils.CatmullRom;\n\n    if ( v[ 0 ] === v[ m ] ) {\n\n      if ( k < 0 ) i = Math.floor( f = m * ( 1 + k ) );\n\n      return fn( v[ ( i - 1 + m ) % m ], v[ i ], v[ ( i + 1 ) % m ], v[ ( i + 2 ) % m ], f - i );\n\n    } else {\n\n      if ( k < 0 ) return v[ 0 ] - ( fn( v[ 0 ], v[ 0 ], v[ 1 ], v[ 1 ], -f ) - v[ 0 ] );\n      if ( k > 1 ) return v[ m ] - ( fn( v[ m ], v[ m ], v[ m - 1 ], v[ m - 1 ], f - m ) - v[ m ] );\n\n      return fn( v[ i ? i - 1 : 0 ], v[ i ], v[ m < i + 1 ? m : i + 1 ], v[ m < i + 2 ? m : i + 2 ], f - i );\n\n    }\n\n  },\n\n  Utils: {\n\n    Linear: function ( p0, p1, t ) {\n\n      return ( p1 - p0 ) * t + p0;\n\n    },\n\n    Bernstein: function ( n , i ) {\n\n      var fc = TWEEN.Interpolation.Utils.Factorial;\n      return fc( n ) / fc( i ) / fc( n - i );\n\n    },\n\n    Factorial: ( function () {\n\n      var a = [ 1 ];\n\n      return function ( n ) {\n\n        var s = 1, i;\n        if ( a[ n ] ) return a[ n ];\n        for ( i = n; i > 1; i-- ) s *= i;\n        return a[ n ] = s;\n\n      };\n\n    } )(),\n\n    CatmullRom: function ( p0, p1, p2, p3, t ) {\n\n      var v0 = ( p2 - p0 ) * 0.5, v1 = ( p3 - p1 ) * 0.5, t2 = t * t, t3 = t * t2;\n      return ( 2 * p1 - 2 * p2 + v0 + v1 ) * t3 + ( - 3 * p1 + 3 * p2 - 2 * v0 - v1 ) * t2 + v0 * t + p1;\n\n    }\n\n  }\n\n};\n\nmodule.exports = TWEEN;","// .dirname, .basename, and .extname methods are extracted from Node.js v8.11.1,\n// backported and transplited with Babel, with backwards-compat fixes\n\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// resolves . and .. elements in a path array with directory names there\n// must be no slashes, empty elements, or device names (c:\\) in the array\n// (so also no leading and trailing slashes - it does not distinguish\n// relative and absolute paths)\nfunction normalizeArray(parts, allowAboveRoot) {\n  // if the path tries to go above the root, `up` ends up > 0\n  var up = 0;\n  for (var i = parts.length - 1; i >= 0; i--) {\n    var last = parts[i];\n    if (last === '.') {\n      parts.splice(i, 1);\n    } else if (last === '..') {\n      parts.splice(i, 1);\n      up++;\n    } else if (up) {\n      parts.splice(i, 1);\n      up--;\n    }\n  }\n\n  // if the path is allowed to go above the root, restore leading ..s\n  if (allowAboveRoot) {\n    for (; up--; up) {\n      parts.unshift('..');\n    }\n  }\n\n  return parts;\n}\n\n// path.resolve([from ...], to)\n// posix version\nexports.resolve = function() {\n  var resolvedPath = '',\n      resolvedAbsolute = false;\n\n  for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n    var path = (i >= 0) ? arguments[i] : process.cwd();\n\n    // Skip empty and invalid entries\n    if (typeof path !== 'string') {\n      throw new TypeError('Arguments to path.resolve must be strings');\n    } else if (!path) {\n      continue;\n    }\n\n    resolvedPath = path + '/' + resolvedPath;\n    resolvedAbsolute = path.charAt(0) === '/';\n  }\n\n  // At this point the path should be resolved to a full absolute path, but\n  // handle relative paths to be safe (might happen when process.cwd() fails)\n\n  // Normalize the path\n  resolvedPath = normalizeArray(filter(resolvedPath.split('/'), function(p) {\n    return !!p;\n  }), !resolvedAbsolute).join('/');\n\n  return ((resolvedAbsolute ? '/' : '') + resolvedPath) || '.';\n};\n\n// path.normalize(path)\n// posix version\nexports.normalize = function(path) {\n  var isAbsolute = exports.isAbsolute(path),\n      trailingSlash = substr(path, -1) === '/';\n\n  // Normalize the path\n  path = normalizeArray(filter(path.split('/'), function(p) {\n    return !!p;\n  }), !isAbsolute).join('/');\n\n  if (!path && !isAbsolute) {\n    path = '.';\n  }\n  if (path && trailingSlash) {\n    path += '/';\n  }\n\n  return (isAbsolute ? '/' : '') + path;\n};\n\n// posix version\nexports.isAbsolute = function(path) {\n  return path.charAt(0) === '/';\n};\n\n// posix version\nexports.join = function() {\n  var paths = Array.prototype.slice.call(arguments, 0);\n  return exports.normalize(filter(paths, function(p, index) {\n    if (typeof p !== 'string') {\n      throw new TypeError('Arguments to path.join must be strings');\n    }\n    return p;\n  }).join('/'));\n};\n\n\n// path.relative(from, to)\n// posix version\nexports.relative = function(from, to) {\n  from = exports.resolve(from).substr(1);\n  to = exports.resolve(to).substr(1);\n\n  function trim(arr) {\n    var start = 0;\n    for (; start < arr.length; start++) {\n      if (arr[start] !== '') break;\n    }\n\n    var end = arr.length - 1;\n    for (; end >= 0; end--) {\n      if (arr[end] !== '') break;\n    }\n\n    if (start > end) return [];\n    return arr.slice(start, end - start + 1);\n  }\n\n  var fromParts = trim(from.split('/'));\n  var toParts = trim(to.split('/'));\n\n  var length = Math.min(fromParts.length, toParts.length);\n  var samePartsLength = length;\n  for (var i = 0; i < length; i++) {\n    if (fromParts[i] !== toParts[i]) {\n      samePartsLength = i;\n      break;\n    }\n  }\n\n  var outputParts = [];\n  for (var i = samePartsLength; i < fromParts.length; i++) {\n    outputParts.push('..');\n  }\n\n  outputParts = outputParts.concat(toParts.slice(samePartsLength));\n\n  return outputParts.join('/');\n};\n\nexports.sep = '/';\nexports.delimiter = ':';\n\nexports.dirname = function (path) {\n  if (typeof path !== 'string') path = path + '';\n  if (path.length === 0) return '.';\n  var code = path.charCodeAt(0);\n  var hasRoot = code === 47 /*/*/;\n  var end = -1;\n  var matchedSlash = true;\n  for (var i = path.length - 1; i >= 1; --i) {\n    code = path.charCodeAt(i);\n    if (code === 47 /*/*/) {\n        if (!matchedSlash) {\n          end = i;\n          break;\n        }\n      } else {\n      // We saw the first non-path separator\n      matchedSlash = false;\n    }\n  }\n\n  if (end === -1) return hasRoot ? '/' : '.';\n  if (hasRoot && end === 1) {\n    // return '//';\n    // Backwards-compat fix:\n    return '/';\n  }\n  return path.slice(0, end);\n};\n\nfunction basename(path) {\n  if (typeof path !== 'string') path = path + '';\n\n  var start = 0;\n  var end = -1;\n  var matchedSlash = true;\n  var i;\n\n  for (i = path.length - 1; i >= 0; --i) {\n    if (path.charCodeAt(i) === 47 /*/*/) {\n        // If we reached a path separator that was not part of a set of path\n        // separators at the end of the string, stop now\n        if (!matchedSlash) {\n          start = i + 1;\n          break;\n        }\n      } else if (end === -1) {\n      // We saw the first non-path separator, mark this as the end of our\n      // path component\n      matchedSlash = false;\n      end = i + 1;\n    }\n  }\n\n  if (end === -1) return '';\n  return path.slice(start, end);\n}\n\n// Uses a mixed approach for backwards-compatibility, as ext behavior changed\n// in new Node.js versions, so only basename() above is backported here\nexports.basename = function (path, ext) {\n  var f = basename(path);\n  if (ext && f.substr(-1 * ext.length) === ext) {\n    f = f.substr(0, f.length - ext.length);\n  }\n  return f;\n};\n\nexports.extname = function (path) {\n  if (typeof path !== 'string') path = path + '';\n  var startDot = -1;\n  var startPart = 0;\n  var end = -1;\n  var matchedSlash = true;\n  // Track the state of characters (if any) we see before our first dot and\n  // after any path separator we find\n  var preDotState = 0;\n  for (var i = path.length - 1; i >= 0; --i) {\n    var code = path.charCodeAt(i);\n    if (code === 47 /*/*/) {\n        // If we reached a path separator that was not part of a set of path\n        // separators at the end of the string, stop now\n        if (!matchedSlash) {\n          startPart = i + 1;\n          break;\n        }\n        continue;\n      }\n    if (end === -1) {\n      // We saw the first non-path separator, mark this as the end of our\n      // extension\n      matchedSlash = false;\n      end = i + 1;\n    }\n    if (code === 46 /*.*/) {\n        // If this is our first dot, mark it as the start of our extension\n        if (startDot === -1)\n          startDot = i;\n        else if (preDotState !== 1)\n          preDotState = 1;\n    } else if (startDot !== -1) {\n      // We saw a non-dot and non-path separator before our dot, so we should\n      // have a good chance at having a non-empty extension\n      preDotState = -1;\n    }\n  }\n\n  if (startDot === -1 || end === -1 ||\n      // We saw a non-dot character immediately before the dot\n      preDotState === 0 ||\n      // The (right-most) trimmed path component is exactly '..'\n      preDotState === 1 && startDot === end - 1 && startDot === startPart + 1) {\n    return '';\n  }\n  return path.slice(startDot, end);\n};\n\nfunction filter (xs, f) {\n    if (xs.filter) return xs.filter(f);\n    var res = [];\n    for (var i = 0; i < xs.length; i++) {\n        if (f(xs[i], i, xs)) res.push(xs[i]);\n    }\n    return res;\n}\n\n// String.prototype.substr - negative index don't work in IE8\nvar substr = 'ab'.substr(-1) === 'b'\n    ? function (str, start, len) { return str.substr(start, len) }\n    : function (str, start, len) {\n        if (start < 0) start = str.length + start;\n        return str.substr(start, len);\n    }\n;\n","var $ = require('../internals/export');\nvar global = require('../internals/global');\nvar setToStringTag = require('../internals/set-to-string-tag');\n\n$({ global: true }, { Reflect: {} });\n\n// Reflect[@@toStringTag] property\n// https://tc39.es/ecma262/#sec-reflect-@@tostringtag\nsetToStringTag(global.Reflect, 'Reflect', true);\n","/*!\r\n* Contains code from THREE.js\r\n* MIT License\r\n* https://github.com/mrdoob/three.js\r\n*/\r\n\r\nvar planes = [];\r\nfor (var i = 0; i < 6; i++) {\r\n    planes[i] = [];\r\n}\r\n\r\nexport function intersectsSphere(matrix, sphere, mask) {\r\n    setPlanes(matrix);\r\n    var center = sphere[0];\r\n    var negRadius = -sphere[1];\r\n    for (var i = 0; i < 6; i++) {\r\n        if (mask && mask.charAt(i) === '0') {\r\n            continue;\r\n        }\r\n        var distance = distanceToPoint(planes[i], center);\r\n        if (distance < negRadius) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\n\r\nvar p = [];\r\n\r\nexport function intersectsBox(matrix, box, mask) {\r\n    setPlanes(matrix);\r\n    for (var i = 0; i < 6; i++) {\r\n        if (mask && mask.charAt(i) === '0') {\r\n            continue;\r\n        }\r\n        var plane = planes[i];\r\n        // corner at max distance\r\n        p[0] = plane[0] > 0 ? box[1][0] : box[0][0];\r\n        p[1] = plane[1] > 0 ? box[1][1] : box[0][1];\r\n        p[2] = plane[2] > 0 ? box[1][2] : box[0][2];\r\n\r\n        if (distanceToPoint(plane, p) < 0) {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\nfunction setPlanes(m) {\r\n    var me = m;\r\n    var me0 = me[0], me1 = me[1], me2 = me[2], me3 = me[3];\r\n    var me4 = me[4], me5 = me[5], me6 = me[6], me7 = me[7];\r\n    var me8 = me[8], me9 = me[9], me10 = me[10], me11 = me[11];\r\n    var me12 = me[12], me13 = me[13], me14 = me[14], me15 = me[15];\r\n\r\n    //right\r\n    setComponents(planes[0], me3 - me0, me7 - me4, me11 - me8, me15 - me12);\r\n    //left\r\n    setComponents(planes[1], me3 + me0, me7 + me4, me11 + me8, me15 + me12);\r\n    //bottom\r\n    setComponents(planes[2], me3 + me1, me7 + me5, me11 + me9, me15 + me13);\r\n    //top\r\n    setComponents(planes[3], me3 - me1, me7 - me5, me11 - me9, me15 - me13);\r\n    //z-far\r\n    setComponents(planes[4], me3 - me2, me7 - me6, me11 - me10, me15 - me14);\r\n    //z-near\r\n    setComponents(planes[5], me3 + me2, me7 + me6, me11 + me10, me15 + me14);\r\n}\r\n\r\nvar normalLength = 1.0 / 6;\r\nfunction setComponents(out, x, y, z, w) {\r\n    out[0] = x * normalLength;\r\n    out[1] = y * normalLength;\r\n    out[2] = z * normalLength;\r\n    out[3] = w * normalLength;\r\n    return out;\r\n}\r\n\r\nfunction distanceToPoint(plane, p) {\r\n    return plane[0] * p[0] + plane[1] * p[1] + plane[2] * p[2] + plane[3];\r\n}\r\n","!function(i){\"use strict\";var c,s,u=\"fulfilled\",f=\"undefined\",a=function(){var e=[],n=0;function o(){for(;e.length-n;){try{e[n]()}catch(t){i.console&&i.console.error(t)}e[n++]=s,1024==n&&(e.splice(0,1024),n=0)}}var r=function(){if(typeof MutationObserver===f)return typeof process!==f&&\"function\"==typeof process.nextTick?function(){process.nextTick(o)}:typeof setImmediate!==f?function(){setImmediate(o)}:function(){setTimeout(o,0)};var t=document.createElement(\"div\");return new MutationObserver(o).observe(t,{attributes:!0}),function(){t.setAttribute(\"a\",0)}}();return function(t){e.push(t),e.length-n==1&&r()}}();function l(t){if(!(this instanceof l))throw new TypeError(\"Zousan must be created with the new keyword\");if(\"function\"==typeof t){var e=this;try{t(function(t){e.resolve(t)},function(t){e.reject(t)})}catch(t){e.reject(t)}}else if(0<arguments.length)throw new TypeError(\"Zousan resolver \"+t+\" is not a function\")}function h(e,t){if(\"function\"==typeof e.y)try{var n=e.y.call(s,t);e.p.resolve(n)}catch(t){e.p.reject(t)}else e.p.resolve(t)}function v(e,t){if(\"function\"==typeof e.n)try{var n=e.n.call(s,t);e.p.resolve(n)}catch(t){e.p.reject(t)}else e.p.reject(t)}l.prototype={resolve:function(n){if(this.state===c){if(n===this)return this.reject(new TypeError(\"Attempt to resolve promise with self\"));var o=this;if(n&&(\"function\"==typeof n||\"object\"==typeof n))try{var e=!0,t=n.then;if(\"function\"==typeof t)return void t.call(n,function(t){e&&(e=!1,o.resolve(t))},function(t){e&&(e=!1,o.reject(t))})}catch(t){return void(e&&this.reject(t))}this.state=u,this.v=n,o.c&&a(function(){for(var t=0,e=o.c.length;t<e;t++)h(o.c[t],n)})}},reject:function(n){if(this.state===c){var t=this;this.state=\"rejected\",this.v=n;var o=this.c;a(o?function(){for(var t=0,e=o.length;t<e;t++)v(o[t],n)}:function(){t.handled||!l.suppressUncaughtRejectionError&&i.console&&l.warn(\"You upset Zousan. Please catch rejections: \",n,n?n.stack:null)})}},then:function(t,e){var n=new l,o={y:t,n:e,p:n};if(this.state===c)this.c?this.c.push(o):this.c=[o];else{var r=this.state,i=this.v;this.handled=!0,a(function(){r===u?h(o,i):v(o,i)})}return n},catch:function(t){return this.then(null,t)},finally:function(t){return this.then(t,t)},timeout:function(t,o){o=o||\"Timeout\";var r=this;return new l(function(e,n){setTimeout(function(){n(Error(o))},t),r.then(function(t){e(t)},function(t){n(t)})})}},l.resolve=function(t){var e=new l;return e.resolve(t),e},l.reject=function(t){var e=new l;return e.c=[],e.reject(t),e},l.all=function(n){var o=[],r=0,i=new l;function t(t,e){t&&\"function\"==typeof t.then||(t=l.resolve(t)),t.then(function(t){o[e]=t,++r==n.length&&i.resolve(o)},function(t){i.reject(t)})}for(var e=0;e<n.length;e++)t(n[e],e);return n.length||i.resolve(o),i},l.warn=console.warn,typeof module!=f&&module.exports&&(module.exports=l),i.define&&i.define.amd&&i.define([],function(){return l}),(i.Zousan=l).soon=a}(\"undefined\"!=typeof global?global:this);"],"sourceRoot":""}